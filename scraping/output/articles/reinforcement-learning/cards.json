[
  {
    "id": "ai-reinforcement-learning-key-components-of-reinforcement-learning-1",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Basics of Reinforcement Learning",
    "title": "Key Components of Reinforcement Learning",
    "subtitle": "Basics of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>At the core of RL is the interaction between an <strong>agent</strong> and an <strong>environment</strong>, as shown in the diagram below <a href=\"https://www.youtube.com/watch?v=2MBJOuVq380\">(source)</a>:</li>\n</ul>\n<p><img src=\"/primers/ai/assets/rlhf/1.png\" alt=\"\"></p>\n<ul>\n  <li>\n    <p>In this interaction, the agent takes actions in the environment and receives feedback in the form of states and rewards. The goal is for the agent to learn a strategy, or <strong>policy</strong>, that maximizes the cumulative reward over time.</p>\n  </li>\n  <li>\n    <p>Here are the critical components of RL:</p>\n\n    <ol>\n      <li>\n        <p><strong>Agent/Learner</strong>: The agent is the learner or decision-maker. It is responsible for selecting actions based on the current state of the environment.</p>\n      </li>\n      <li>\n        <p><strong>Environment</strong>: Everything the agent interacts with. The environment defines the rules of the game, transitioning from one state to another based on the agent‚Äôs actions.</p>\n      </li>\n      <li>\n        <p><strong>State (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-6-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-19\" style=\"width: 0.519em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.552em, 1000.42em, 2.327em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-20\"><span class=\"mi\" id=\"MathJax-Span-21\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-6\">s</script>)</strong>: A representation of the environment at a particular point in time. States encapsulate all the information that the agent needs to know to make a decision. For example, in a video game, a state might be the current configuration of the game board.</p>\n      </li>\n      <li>\n        <p><strong>Action (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-7-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-22\" style=\"width: 0.571em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.552em, 1000.47em, 2.327em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-23\"><span class=\"mi\" id=\"MathJax-Span-24\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-7\">a</script>)</strong>: A decision taken by the agent in response to the current state. In each state, the agent must choose an action from a set of possible actions, which will affect the future state of the environment.</p>\n      </li>\n      <li>\n        <p><strong>Reward (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-8-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-25\" style=\"width: 0.467em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.364em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.552em, 1000.36em, 2.327em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-26\"><span class=\"mi\" id=\"MathJax-Span-27\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-8\">r</script>)</strong>: A scalar value that the agent receives from the environment after taking an action. The reward provides feedback on how good or bad an action was in that particular state. The agent‚Äôs objective is to maximize the cumulative reward over time, often referred to as the <strong>return</strong>.</p>\n      </li>\n      <li>\n        <p><strong>Policy (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-28\" style=\"width: 0.777em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.604em, 1000.62em, 2.327em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-29\"><span class=\"mi\" id=\"MathJax-Span-30\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.054em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-9\">\\pi</script>)</strong>: A policy is the strategy the agent uses to determine the actions to take based on the current state. It is implemented as a mapping from states to action probabilities. It can be tabular, i.e., a simple lookup table mapping states to actions, or it can be more complex, such as a neural network in the case of deep RL. The policy can be deterministic (always taking the same action for a given state) or stochastic (taking different actions with some probability).</p>\n      </li>\n      <li>\n        <p><strong>Value Function</strong>:  The value function estimates how good (i.e., how much <strong>total expected reward</strong>) it is to be in a particular state (in which case, it is called the <strong>state-value function</strong>) or to take a specific action in that state (in which case, it is called the <strong>action-value function</strong>). It does so by accounting for both the immediate reward and the expected future rewards from subsequent states, helping the agent understand long-term reward potential rather than focusing only on immediate rewards. While value functions are of two types (i.e., <strong>state-value function</strong> and <strong>action-value function</strong>), the <strong>state-value function</strong> is also commonly called the <strong>value function</strong>. The relationship between the two is given by: <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-10-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munder><mo>&amp;#x2211;</mo><mi>a</mi></munder><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-31\" style=\"width: 13.388em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 11.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1011.1em, 2.711em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-32\"><span class=\"msubsup\" id=\"MathJax-Span-33\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-34\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-35\"><span class=\"mrow\" id=\"MathJax-Span-36\"><span class=\"mi\" id=\"MathJax-Span-37\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-38\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-39\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-40\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-41\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-42\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-43\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.695em; left: 0.94em;\"><span class=\"mi\" id=\"MathJax-Span-44\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-45\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-46\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-47\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-48\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-49\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-50\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-51\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-52\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-53\"><span class=\"mrow\" id=\"MathJax-Span-54\"><span class=\"mi\" id=\"MathJax-Span-55\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-56\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-57\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-58\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-59\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-60\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munder><mo>‚àë</mo><mi>a</mi></munder><mi>œÄ</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-10\">V^{\\pi}(s) = \\sum_a \\pi(a \\mid s) Q^{\\pi}(s, a)</script>, which means the value of a state under policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-11-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-61\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-62\"><span class=\"mi\" id=\"MathJax-Span-63\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-11\">\\pi</script> is the expected action-value, averaged over all possible actions the policy might take in that state.</p>\n      </li>\n      <li>\n        <p><strong>State-Value Function (V-function)</strong>: Denoted as <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-12-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-64\" style=\"width: 2.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.19em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-65\"><span class=\"msubsup\" id=\"MathJax-Span-66\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-67\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-68\"><span class=\"mrow\" id=\"MathJax-Span-69\"><span class=\"mi\" id=\"MathJax-Span-70\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-71\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-72\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-73\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-12\">V^{\\pi}(s)</script>, the state-value function measures the expected return (total discounted reward) starting from state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-74\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-75\"><span class=\"mi\" id=\"MathJax-Span-76\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-13\">s</script> and then following policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-14-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-77\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-78\"><span class=\"mi\" id=\"MathJax-Span-79\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-14\">\\pi</script> thereafter. It is formally defined as <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-15-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-80\" style=\"width: 15.107em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.555em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.878em, 1012.4em, 3.44em, -999.997em); top: -2.914em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-81\"><span class=\"msubsup\" id=\"MathJax-Span-82\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-83\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-84\"><span class=\"mrow\" id=\"MathJax-Span-85\"><span class=\"mi\" id=\"MathJax-Span-86\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-87\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-88\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-89\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-90\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-91\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-92\"><span class=\"mrow\" id=\"MathJax-Span-93\"><span class=\"mi\" id=\"MathJax-Span-94\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-95\"><span class=\"mrow\" id=\"MathJax-Span-96\"><span class=\"mi\" id=\"MathJax-Span-97\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-98\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-99\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-100\"><span class=\"munderover\" id=\"MathJax-Span-101\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-102\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.73em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-103\"><span class=\"mrow\" id=\"MathJax-Span-104\"><span class=\"mi\" id=\"MathJax-Span-105\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àû</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.15em, 4.169em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-106\"><span class=\"mrow\" id=\"MathJax-Span-107\"><span class=\"mi\" id=\"MathJax-Span-108\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-109\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-110\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-111\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-112\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-113\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-114\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-115\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-116\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-117\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-118\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-119\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-120\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-121\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-122\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span></span><span class=\"mo\" id=\"MathJax-Span-123\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.919em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">‚àû</mi></mrow></munderover><msup><mi>Œ≥</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi></mrow><mo>]</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-15\">V^{\\pi}(s) = \\mathbb{E}_{\\pi}\\left[\\sum_{t=0}^{\\infty} \\gamma^t r_t \\mid s_0 = s\\right]</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-124\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-125\"><span class=\"mi\" id=\"MathJax-Span-126\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-16\">\\pi</script> is the policy, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi><mo>&amp;#x2208;</mo><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-127\" style=\"width: 4.69em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.909em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.86em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-128\"><span class=\"mi\" id=\"MathJax-Span-129\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-130\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àà</span><span class=\"mo\" id=\"MathJax-Span-131\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">[</span><span class=\"mn\" id=\"MathJax-Span-132\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-133\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-134\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-135\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi><mo>‚àà</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-17\">\\gamma \\in [0,1)</script> is the discount factor weighting future rewards, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-136\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-137\"><span class=\"msubsup\" id=\"MathJax-Span-138\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-139\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-140\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-18\">r_t</script> is the reward received at time step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-141\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-142\"><span class=\"mi\" id=\"MathJax-Span-143\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-19\">t</script>, and the expectation <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x22C5;</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-144\" style=\"width: 2.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1002.09em, 2.555em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-145\"><span class=\"msubsup\" id=\"MathJax-Span-146\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-147\"><span class=\"mrow\" id=\"MathJax-Span-148\"><span class=\"mi\" id=\"MathJax-Span-149\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-150\"><span class=\"mrow\" id=\"MathJax-Span-151\"><span class=\"mi\" id=\"MathJax-Span-152\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-153\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mo\" id=\"MathJax-Span-154\" style=\"font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-155\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msub><mo stretchy=\"false\">[</mo><mo>‚ãÖ</mo><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-20\">\\mathbb{E}_{\\pi}[\\cdot]</script> is taken over trajectories generated by following policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-156\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-157\"><span class=\"mi\" id=\"MathJax-Span-158\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-21\">\\pi</script>.</p>\n      </li>\n      <li>\n        <p><strong>Action-Value Function (Q-function)</strong>: Denoted as <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-159\" style=\"width: 3.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.66em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-160\"><span class=\"mi\" id=\"MathJax-Span-161\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-162\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-163\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-164\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-165\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-166\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-22\">Q(s, a)</script> (where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-23-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-167\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.73em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-168\"><span class=\"mi\" id=\"MathJax-Span-169\" style=\"font-family: STIXGeneral-Italic;\">Q</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-23\">Q</script> stands for ‚Äúquality‚Äù), the action-value function measures the expected return for taking action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-24-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-170\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-171\"><span class=\"mi\" id=\"MathJax-Span-172\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-24\">a</script> in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-25-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-173\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-174\"><span class=\"mi\" id=\"MathJax-Span-175\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-25\">s</script> and then following the policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-26-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-176\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-177\"><span class=\"mi\" id=\"MathJax-Span-178\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-26\">\\pi</script> thereafter. It plays a central role in algorithms like Q-learning and Deep Q-Networks (DQN). It is formally defined as <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-27-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><mi>a</mi></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-179\" style=\"width: 19.794em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.461em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.878em, 1016.3em, 3.44em, -999.997em); top: -2.914em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-180\"><span class=\"msubsup\" id=\"MathJax-Span-181\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-182\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-183\"><span class=\"mrow\" id=\"MathJax-Span-184\"><span class=\"mi\" id=\"MathJax-Span-185\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-186\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-187\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-188\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-189\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-190\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-191\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-192\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-193\"><span class=\"mrow\" id=\"MathJax-Span-194\"><span class=\"mi\" id=\"MathJax-Span-195\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-196\"><span class=\"mrow\" id=\"MathJax-Span-197\"><span class=\"mi\" id=\"MathJax-Span-198\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-199\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-200\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-201\"><span class=\"munderover\" id=\"MathJax-Span-202\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-203\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.73em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-204\"><span class=\"mrow\" id=\"MathJax-Span-205\"><span class=\"mi\" id=\"MathJax-Span-206\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àû</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.15em, 4.169em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-207\"><span class=\"mrow\" id=\"MathJax-Span-208\"><span class=\"mi\" id=\"MathJax-Span-209\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-210\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-211\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-212\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-213\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-214\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-215\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-216\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-217\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-218\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-219\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-220\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-221\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-222\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-223\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-224\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-225\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-226\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-227\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-228\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-229\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">a</span></span><span class=\"mo\" id=\"MathJax-Span-230\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.919em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">‚àû</mi></mrow></munderover><msup><mi>Œ≥</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><mi>a</mi></mrow><mo>]</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-27\">Q^{\\pi}(s, a) = \\mathbb{E}_{\\pi}\\left[\\sum_{t=0}^{\\infty} \\gamma^t r_t \\mid s_0 = s, a_0 = a\\right]</script>, where the terms have the same meanings as above, except that the expectation begins from both a given state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-231\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-232\"><span class=\"mi\" id=\"MathJax-Span-233\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-28\">s</script> and an initial action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-29-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-234\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-235\"><span class=\"mi\" id=\"MathJax-Span-236\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-29\">a</script>.</p>\n      </li>\n      <li>\n        <p><strong>Advantage Function (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-30-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-237\" style=\"width: 0.881em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.726em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.346em, 1000.67em, 2.327em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-238\"><span class=\"mi\" id=\"MathJax-Span-239\" style=\"font-family: STIXGeneral-Italic;\">A</span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>A</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-30\">A</script>)</strong>: The advantage function quantifies how much better taking a specific action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-31-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-240\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-241\"><span class=\"mi\" id=\"MathJax-Span-242\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-31\">a</script> in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-32-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-243\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-244\"><span class=\"mi\" id=\"MathJax-Span-245\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-32\">s</script> is compared to the average action according to the policy. Put simply, the advantage function measures how much better the actual return was from a particular state than what was expected from that state before acting. It is is commonly used in policy gradient methods such as Actor-Critic and Proximal Policy Optimization (PPO) to reduce variance in gradient estimates. It is defined as <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-33-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-246\" style=\"width: 11.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.482em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1009.43em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-247\"><span class=\"mi\" id=\"MathJax-Span-248\" style=\"font-family: STIXGeneral-Italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-249\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-250\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-251\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-252\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-253\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-254\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-255\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Q</span><span class=\"mo\" id=\"MathJax-Span-256\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-257\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-258\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-259\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-260\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-261\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-262\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-263\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-264\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-265\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>A</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mi>V</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-33\">A(s, a) = Q(s, a) - V(s)</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-34-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-266\" style=\"width: 3.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.66em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-267\"><span class=\"mi\" id=\"MathJax-Span-268\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-269\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-270\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-271\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-272\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-273\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-34\">Q(s, a)</script> is the <strong>action-value function</strong> (the expected return for taking action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-35-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-274\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-275\"><span class=\"mi\" id=\"MathJax-Span-276\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-35\">a</script> in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-36-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-277\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-278\"><span class=\"mi\" id=\"MathJax-Span-279\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-36\">s</script> and then following the policy), and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-37-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-280\" style=\"width: 2.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.77em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-281\"><span class=\"mi\" id=\"MathJax-Span-282\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-283\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-284\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-285\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-37\">V(s)</script> is the <strong>state-value function</strong> (the expected return from state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-38-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-286\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-287\"><span class=\"mi\" id=\"MathJax-Span-288\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-38\">s</script> when following the policy).</p>\n      </li>\n      <li>\n        <p><strong>Return (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-39-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-289\" style=\"width: 0.881em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.726em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.346em, 1000.73em, 2.327em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-290\"><span class=\"mi\" id=\"MathJax-Span-291\" style=\"font-family: STIXGeneral-Italic;\">G</span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>G</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-39\">G</script>)</strong>: The total accumulated reward from a given time step onward, often discounted to prioritize near-term rewards <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-40-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mi>k</mi></msup><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-292\" style=\"width: 9.326em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.763em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1007.76em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-293\"><span class=\"msubsup\" id=\"MathJax-Span-294\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-295\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-296\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-297\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-298\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-299\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.73em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-300\"><span class=\"mrow\" id=\"MathJax-Span-301\"><span class=\"mi\" id=\"MathJax-Span-302\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àû</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.25em, 4.169em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-303\"><span class=\"mrow\" id=\"MathJax-Span-304\"><span class=\"mi\" id=\"MathJax-Span-305\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-306\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-307\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-308\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-309\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-310\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-311\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-312\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-313\"><span class=\"mrow\" id=\"MathJax-Span-314\"><span class=\"mi\" id=\"MathJax-Span-315\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-316\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-317\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-318\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-319\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">‚àû</mi></mrow></munderover><msup><mi>Œ≥</mi><mi>k</mi></msup><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-40\">G_t = \\sum_{k=0}^{\\infty} \\gamma^k r_{t+k+1}</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-41-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-320\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.73em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-321\"><span class=\"mi\" id=\"MathJax-Span-322\" style=\"font-family: STIXGeneral-Italic;\">G</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>G</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-41\">G</script> stands for ‚Äúgain‚Äù and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-42-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-323\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-324\"><span class=\"mi\" id=\"MathJax-Span-325\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-42\">\\gamma</script> is the discount factor that determines how much future rewards are valued relative to immediate rewards.</p>\n      </li>\n      <li>\n        <p><strong>Discount Factor (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-43-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-326\" style=\"width: 0.726em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.571em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.604em, 1000.57em, 2.534em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-327\"><span class=\"mi\" id=\"MathJax-Span-328\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.054em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-43\">\\gamma</script>)</strong>: A scalar between 0 and 1 that controls the importance of future rewards. Smaller values make the agent myopic (focusing on immediate rewards), while larger values encourage long-term planning. Typically set closer to 1 to focus on long-term rewards rather than immediate ones.</p>\n      </li>\n      <li>\n        <p><strong>Exploration vs. Exploitation</strong>: The trade-off between exploring new actions to discover potentially better rewards and exploiting known actions that already yield high rewards. Balancing these two is crucial for effective learning.</p>\n      </li>\n      <li>\n        <p><strong>Trajectory/Episode/Rollout</strong>: A sequence of states, actions, rewards, and next states from the beginning of an episode to its termination, representing one complete interaction of the agent with the environment.</p>\n      </li>\n      <li>\n        <p><strong>Temporal-Difference (TD) Error</strong>: The difference between the predicted value of a state and the observed reward plus the estimated value of the next state. It is used to update value estimates dynamically in methods like TD-learning, where the TD error is given by <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-44-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B4;</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B3;</mi><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-329\" style=\"width: 12.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1010.37em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-330\"><span class=\"msubsup\" id=\"MathJax-Span-331\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-332\" style=\"font-family: STIXGeneral-Italic;\">Œ¥</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-333\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-334\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-335\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-336\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-337\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-338\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-339\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-340\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-341\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-342\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-343\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-344\"><span class=\"mrow\" id=\"MathJax-Span-345\"><span class=\"mi\" id=\"MathJax-Span-346\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-347\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-348\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-349\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-350\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-351\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-352\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-353\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-354\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-355\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-356\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>Œ¥</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>Œ≥</mi><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-44\">\\delta_t = r_t + \\gamma V(s_{t+1}) - V(s_t)</script>, with <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-45-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-357\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-358\"><span class=\"msubsup\" id=\"MathJax-Span-359\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-360\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-361\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-45\">r_t</script> as the immediate reward, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-46-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-362\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-363\"><span class=\"mi\" id=\"MathJax-Span-364\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-46\">\\gamma</script> the discount factor, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-47-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-365\" style=\"width: 2.607em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.09em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-366\"><span class=\"mi\" id=\"MathJax-Span-367\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-368\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-369\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-370\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-371\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-372\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-47\">V(s_t)</script> and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-48-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-373\" style=\"width: 3.596em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.971em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.92em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-374\"><span class=\"mi\" id=\"MathJax-Span-375\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-376\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-377\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-378\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-379\"><span class=\"mrow\" id=\"MathJax-Span-380\"><span class=\"mi\" id=\"MathJax-Span-381\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-382\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-383\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-384\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-48\">V(s_{t+1})</script> being the predicted values of the current and next states respectively.</p>\n      </li>\n      <li>\n        <p><strong>Replay Buffer (Experience Replay)</strong>: In Deep RL, a replay buffer stores past transitions (state, action, reward, next state) for sampling during training. This helps break correlation between consecutive samples‚Äîsince experiences are drawn randomly rather than sequentially‚Äîallowing the agent to learn from a more diverse and independent set of experiences, which improves data efficiency and stabilizes training.</p>\n      </li>\n      <li>\n        <p><strong>Actor-Critic Architecture</strong>: A hybrid approach combining a policy-based (actor) component that selects actions and a value-based (critic) component that evaluates them. The critic‚Äôs feedback stabilizes the actor‚Äôs learning.</p>\n      </li>\n    </ol>\n  </li>\n</ul>\n<p>In this interaction, the agent takes actions in the environment and receives feedback in the form of states and rewards. The goal is for the agent to learn a strategy, or <strong>policy</strong>, that maximizes the cumulative reward over time.</p>\n<p>Here are the critical components of RL:</p>\n<ol>\n      <li>\n        <p><strong>Agent/Learner</strong>: The agent is the learner or decision-maker. It is responsible for selecting actions based on the current state of the environment.</p>\n      </li>\n      <li>\n        <p><strong>Environment</strong>: Everything the agent interacts with. The environment defines the rules of the game, transitioning from one state to another based on the agent‚Äôs actions.</p>\n      </li>\n      <li>\n        <p><strong>State (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-6-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-19\" style=\"width: 0.519em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.552em, 1000.42em, 2.327em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-20\"><span class=\"mi\" id=\"MathJax-Span-21\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-6\">s</script>)</strong>: A representation of the environment at a particular point in time. States encapsulate all the information that the agent needs to know to make a decision. For example, in a video game, a state might be the current configuration of the game board.</p>\n      </li>\n      <li>\n        <p><strong>Action (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-7-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-22\" style=\"width: 0.571em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.552em, 1000.47em, 2.327em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-23\"><span class=\"mi\" id=\"MathJax-Span-24\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-7\">a</script>)</strong>: A decision taken by the agent in response to the current state. In each state, the agent must choose an action from a set of possible actions, which will affect the future state of the environment.</p>\n      </li>\n      <li>\n        <p><strong>Reward (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-8-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-25\" style=\"width: 0.467em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.364em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.552em, 1000.36em, 2.327em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-26\"><span class=\"mi\" id=\"MathJax-Span-27\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-8\">r</script>)</strong>: A scalar value that the agent receives from the environment after taking an action. The reward provides feedback on how good or bad an action was in that particular state. The agent‚Äôs objective is to maximize the cumulative reward over time, often referred to as the <strong>return</strong>.</p>\n      </li>\n      <li>\n        <p><strong>Policy (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-28\" style=\"width: 0.777em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.604em, 1000.62em, 2.327em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-29\"><span class=\"mi\" id=\"MathJax-Span-30\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.054em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-9\">\\pi</script>)</strong>: A policy is the strategy the agent uses to determine the actions to take based on the current state. It is implemented as a mapping from states to action probabilities. It can be tabular, i.e., a simple lookup table mapping states to actions, or it can be more complex, such as a neural network in the case of deep RL. The policy can be deterministic (always taking the same action for a given state) or stochastic (taking different actions with some probability).</p>\n      </li>\n      <li>\n        <p><strong>Value Function</strong>:  The value function estimates how good (i.e., how much <strong>total expected reward</strong>) it is to be in a particular state (in which case, it is called the <strong>state-value function</strong>) or to take a specific action in that state (in which case, it is called the <strong>action-value function</strong>). It does so by accounting for both the immediate reward and the expected future rewards from subsequent states, helping the agent understand long-term reward potential rather than focusing only on immediate rewards. While value functions are of two types (i.e., <strong>state-value function</strong> and <strong>action-value function</strong>), the <strong>state-value function</strong> is also commonly called the <strong>value function</strong>. The relationship between the two is given by: <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-10-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munder><mo>&amp;#x2211;</mo><mi>a</mi></munder><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-31\" style=\"width: 13.388em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 11.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1011.1em, 2.711em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-32\"><span class=\"msubsup\" id=\"MathJax-Span-33\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-34\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-35\"><span class=\"mrow\" id=\"MathJax-Span-36\"><span class=\"mi\" id=\"MathJax-Span-37\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-38\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-39\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-40\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-41\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-42\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-43\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.695em; left: 0.94em;\"><span class=\"mi\" id=\"MathJax-Span-44\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-45\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-46\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-47\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-48\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-49\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-50\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-51\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-52\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-53\"><span class=\"mrow\" id=\"MathJax-Span-54\"><span class=\"mi\" id=\"MathJax-Span-55\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-56\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-57\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-58\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-59\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-60\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munder><mo>‚àë</mo><mi>a</mi></munder><mi>œÄ</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-10\">V^{\\pi}(s) = \\sum_a \\pi(a \\mid s) Q^{\\pi}(s, a)</script>, which means the value of a state under policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-11-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-61\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-62\"><span class=\"mi\" id=\"MathJax-Span-63\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-11\">\\pi</script> is the expected action-value, averaged over all possible actions the policy might take in that state.</p>\n      </li>\n      <li>\n        <p><strong>State-Value Function (V-function)</strong>: Denoted as <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-12-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-64\" style=\"width: 2.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.19em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-65\"><span class=\"msubsup\" id=\"MathJax-Span-66\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-67\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-68\"><span class=\"mrow\" id=\"MathJax-Span-69\"><span class=\"mi\" id=\"MathJax-Span-70\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-71\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-72\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-73\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-12\">V^{\\pi}(s)</script>, the state-value function measures the expected return (total discounted reward) starting from state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-74\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-75\"><span class=\"mi\" id=\"MathJax-Span-76\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-13\">s</script> and then following policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-14-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-77\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-78\"><span class=\"mi\" id=\"MathJax-Span-79\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-14\">\\pi</script> thereafter. It is formally defined as <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-15-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-80\" style=\"width: 15.107em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.555em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.878em, 1012.4em, 3.44em, -999.997em); top: -2.914em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-81\"><span class=\"msubsup\" id=\"MathJax-Span-82\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-83\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-84\"><span class=\"mrow\" id=\"MathJax-Span-85\"><span class=\"mi\" id=\"MathJax-Span-86\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-87\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-88\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-89\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-90\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-91\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-92\"><span class=\"mrow\" id=\"MathJax-Span-93\"><span class=\"mi\" id=\"MathJax-Span-94\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-95\"><span class=\"mrow\" id=\"MathJax-Span-96\"><span class=\"mi\" id=\"MathJax-Span-97\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-98\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-99\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-100\"><span class=\"munderover\" id=\"MathJax-Span-101\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-102\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.73em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-103\"><span class=\"mrow\" id=\"MathJax-Span-104\"><span class=\"mi\" id=\"MathJax-Span-105\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àû</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.15em, 4.169em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-106\"><span class=\"mrow\" id=\"MathJax-Span-107\"><span class=\"mi\" id=\"MathJax-Span-108\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-109\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-110\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-111\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-112\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-113\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-114\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-115\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-116\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-117\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-118\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-119\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-120\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-121\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-122\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span></span><span class=\"mo\" id=\"MathJax-Span-123\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.919em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">‚àû</mi></mrow></munderover><msup><mi>Œ≥</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi></mrow><mo>]</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-15\">V^{\\pi}(s) = \\mathbb{E}_{\\pi}\\left[\\sum_{t=0}^{\\infty} \\gamma^t r_t \\mid s_0 = s\\right]</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-124\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-125\"><span class=\"mi\" id=\"MathJax-Span-126\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-16\">\\pi</script> is the policy, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi><mo>&amp;#x2208;</mo><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-127\" style=\"width: 4.69em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.909em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.86em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-128\"><span class=\"mi\" id=\"MathJax-Span-129\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-130\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àà</span><span class=\"mo\" id=\"MathJax-Span-131\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">[</span><span class=\"mn\" id=\"MathJax-Span-132\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-133\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-134\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-135\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi><mo>‚àà</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-17\">\\gamma \\in [0,1)</script> is the discount factor weighting future rewards, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-136\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-137\"><span class=\"msubsup\" id=\"MathJax-Span-138\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-139\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-140\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-18\">r_t</script> is the reward received at time step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-141\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-142\"><span class=\"mi\" id=\"MathJax-Span-143\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-19\">t</script>, and the expectation <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x22C5;</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-144\" style=\"width: 2.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1002.09em, 2.555em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-145\"><span class=\"msubsup\" id=\"MathJax-Span-146\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-147\"><span class=\"mrow\" id=\"MathJax-Span-148\"><span class=\"mi\" id=\"MathJax-Span-149\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-150\"><span class=\"mrow\" id=\"MathJax-Span-151\"><span class=\"mi\" id=\"MathJax-Span-152\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-153\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mo\" id=\"MathJax-Span-154\" style=\"font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-155\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msub><mo stretchy=\"false\">[</mo><mo>‚ãÖ</mo><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-20\">\\mathbb{E}_{\\pi}[\\cdot]</script> is taken over trajectories generated by following policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-156\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-157\"><span class=\"mi\" id=\"MathJax-Span-158\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-21\">\\pi</script>.</p>\n      </li>\n      <li>\n        <p><strong>Action-Value Function (Q-function)</strong>: Denoted as <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-159\" style=\"width: 3.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.66em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-160\"><span class=\"mi\" id=\"MathJax-Span-161\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-162\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-163\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-164\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-165\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-166\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-22\">Q(s, a)</script> (where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-23-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-167\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.73em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-168\"><span class=\"mi\" id=\"MathJax-Span-169\" style=\"font-family: STIXGeneral-Italic;\">Q</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-23\">Q</script> stands for ‚Äúquality‚Äù), the action-value function measures the expected return for taking action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-24-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-170\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-171\"><span class=\"mi\" id=\"MathJax-Span-172\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-24\">a</script> in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-25-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-173\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-174\"><span class=\"mi\" id=\"MathJax-Span-175\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-25\">s</script> and then following the policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-26-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-176\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-177\"><span class=\"mi\" id=\"MathJax-Span-178\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-26\">\\pi</script> thereafter. It plays a central role in algorithms like Q-learning and Deep Q-Networks (DQN). It is formally defined as <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-27-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><mi>a</mi></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-179\" style=\"width: 19.794em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.461em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.878em, 1016.3em, 3.44em, -999.997em); top: -2.914em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-180\"><span class=\"msubsup\" id=\"MathJax-Span-181\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-182\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-183\"><span class=\"mrow\" id=\"MathJax-Span-184\"><span class=\"mi\" id=\"MathJax-Span-185\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-186\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-187\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-188\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-189\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-190\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-191\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-192\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-193\"><span class=\"mrow\" id=\"MathJax-Span-194\"><span class=\"mi\" id=\"MathJax-Span-195\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-196\"><span class=\"mrow\" id=\"MathJax-Span-197\"><span class=\"mi\" id=\"MathJax-Span-198\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-199\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-200\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-201\"><span class=\"munderover\" id=\"MathJax-Span-202\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-203\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.73em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-204\"><span class=\"mrow\" id=\"MathJax-Span-205\"><span class=\"mi\" id=\"MathJax-Span-206\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àû</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.15em, 4.169em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-207\"><span class=\"mrow\" id=\"MathJax-Span-208\"><span class=\"mi\" id=\"MathJax-Span-209\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-210\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-211\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-212\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-213\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-214\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-215\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-216\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-217\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-218\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-219\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-220\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-221\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-222\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-223\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-224\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-225\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-226\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-227\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-228\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-229\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">a</span></span><span class=\"mo\" id=\"MathJax-Span-230\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.919em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">‚àû</mi></mrow></munderover><msup><mi>Œ≥</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><mi>a</mi></mrow><mo>]</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-27\">Q^{\\pi}(s, a) = \\mathbb{E}_{\\pi}\\left[\\sum_{t=0}^{\\infty} \\gamma^t r_t \\mid s_0 = s, a_0 = a\\right]</script>, where the terms have the same meanings as above, except that the expectation begins from both a given state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-231\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-232\"><span class=\"mi\" id=\"MathJax-Span-233\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-28\">s</script> and an initial action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-29-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-234\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-235\"><span class=\"mi\" id=\"MathJax-Span-236\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-29\">a</script>.</p>\n      </li>\n      <li>\n        <p><strong>Advantage Function (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-30-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-237\" style=\"width: 0.881em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.726em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.346em, 1000.67em, 2.327em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-238\"><span class=\"mi\" id=\"MathJax-Span-239\" style=\"font-family: STIXGeneral-Italic;\">A</span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>A</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-30\">A</script>)</strong>: The advantage function quantifies how much better taking a specific action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-31-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-240\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-241\"><span class=\"mi\" id=\"MathJax-Span-242\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-31\">a</script> in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-32-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-243\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-244\"><span class=\"mi\" id=\"MathJax-Span-245\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-32\">s</script> is compared to the average action according to the policy. Put simply, the advantage function measures how much better the actual return was from a particular state than what was expected from that state before acting. It is is commonly used in policy gradient methods such as Actor-Critic and Proximal Policy Optimization (PPO) to reduce variance in gradient estimates. It is defined as <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-33-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-246\" style=\"width: 11.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.482em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1009.43em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-247\"><span class=\"mi\" id=\"MathJax-Span-248\" style=\"font-family: STIXGeneral-Italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-249\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-250\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-251\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-252\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-253\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-254\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-255\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Q</span><span class=\"mo\" id=\"MathJax-Span-256\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-257\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-258\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-259\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-260\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-261\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-262\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-263\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-264\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-265\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>A</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mi>V</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-33\">A(s, a) = Q(s, a) - V(s)</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-34-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-266\" style=\"width: 3.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.66em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-267\"><span class=\"mi\" id=\"MathJax-Span-268\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-269\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-270\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-271\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-272\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-273\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-34\">Q(s, a)</script> is the <strong>action-value function</strong> (the expected return for taking action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-35-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-274\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-275\"><span class=\"mi\" id=\"MathJax-Span-276\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-35\">a</script> in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-36-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-277\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-278\"><span class=\"mi\" id=\"MathJax-Span-279\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-36\">s</script> and then following the policy), and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-37-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-280\" style=\"width: 2.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.77em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-281\"><span class=\"mi\" id=\"MathJax-Span-282\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-283\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-284\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-285\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-37\">V(s)</script> is the <strong>state-value function</strong> (the expected return from state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-38-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-286\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-287\"><span class=\"mi\" id=\"MathJax-Span-288\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-38\">s</script> when following the policy).</p>\n      </li>\n      <li>\n        <p><strong>Return (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-39-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-289\" style=\"width: 0.881em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.726em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.346em, 1000.73em, 2.327em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-290\"><span class=\"mi\" id=\"MathJax-Span-291\" style=\"font-family: STIXGeneral-Italic;\">G</span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>G</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-39\">G</script>)</strong>: The total accumulated reward from a given time step onward, often discounted to prioritize near-term rewards <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-40-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mi>k</mi></msup><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-292\" style=\"width: 9.326em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.763em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1007.76em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-293\"><span class=\"msubsup\" id=\"MathJax-Span-294\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-295\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-296\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-297\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-298\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-299\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.73em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-300\"><span class=\"mrow\" id=\"MathJax-Span-301\"><span class=\"mi\" id=\"MathJax-Span-302\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àû</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.25em, 4.169em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-303\"><span class=\"mrow\" id=\"MathJax-Span-304\"><span class=\"mi\" id=\"MathJax-Span-305\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-306\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-307\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-308\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-309\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-310\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-311\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-312\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-313\"><span class=\"mrow\" id=\"MathJax-Span-314\"><span class=\"mi\" id=\"MathJax-Span-315\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-316\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-317\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-318\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-319\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">‚àû</mi></mrow></munderover><msup><mi>Œ≥</mi><mi>k</mi></msup><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-40\">G_t = \\sum_{k=0}^{\\infty} \\gamma^k r_{t+k+1}</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-41-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-320\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.73em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-321\"><span class=\"mi\" id=\"MathJax-Span-322\" style=\"font-family: STIXGeneral-Italic;\">G</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>G</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-41\">G</script> stands for ‚Äúgain‚Äù and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-42-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-323\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-324\"><span class=\"mi\" id=\"MathJax-Span-325\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-42\">\\gamma</script> is the discount factor that determines how much future rewards are valued relative to immediate rewards.</p>\n      </li>\n      <li>\n        <p><strong>Discount Factor (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-43-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-326\" style=\"width: 0.726em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.571em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.604em, 1000.57em, 2.534em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-327\"><span class=\"mi\" id=\"MathJax-Span-328\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.054em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-43\">\\gamma</script>)</strong>: A scalar between 0 and 1 that controls the importance of future rewards. Smaller values make the agent myopic (focusing on immediate rewards), while larger values encourage long-term planning. Typically set closer to 1 to focus on long-term rewards rather than immediate ones.</p>\n      </li>\n      <li>\n        <p><strong>Exploration vs. Exploitation</strong>: The trade-off between exploring new actions to discover potentially better rewards and exploiting known actions that already yield high rewards. Balancing these two is crucial for effective learning.</p>\n      </li>\n      <li>\n        <p><strong>Trajectory/Episode/Rollout</strong>: A sequence of states, actions, rewards, and next states from the beginning of an episode to its termination, representing one complete interaction of the agent with the environment.</p>\n      </li>\n      <li>\n        <p><strong>Temporal-Difference (TD) Error</strong>: The difference between the predicted value of a state and the observed reward plus the estimated value of the next state. It is used to update value estimates dynamically in methods like TD-learning, where the TD error is given by <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-44-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B4;</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B3;</mi><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-329\" style=\"width: 12.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1010.37em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-330\"><span class=\"msubsup\" id=\"MathJax-Span-331\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-332\" style=\"font-family: STIXGeneral-Italic;\">Œ¥</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-333\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-334\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-335\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-336\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-337\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-338\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-339\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-340\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-341\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-342\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-343\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-344\"><span class=\"mrow\" id=\"MathJax-Span-345\"><span class=\"mi\" id=\"MathJax-Span-346\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-347\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-348\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-349\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-350\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-351\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-352\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-353\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-354\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-355\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-356\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>Œ¥</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>Œ≥</mi><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-44\">\\delta_t = r_t + \\gamma V(s_{t+1}) - V(s_t)</script>, with <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-45-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-357\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-358\"><span class=\"msubsup\" id=\"MathJax-Span-359\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-360\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-361\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-45\">r_t</script> as the immediate reward, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-46-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-362\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-363\"><span class=\"mi\" id=\"MathJax-Span-364\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-46\">\\gamma</script> the discount factor, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-47-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-365\" style=\"width: 2.607em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.09em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-366\"><span class=\"mi\" id=\"MathJax-Span-367\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-368\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-369\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-370\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-371\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-372\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-47\">V(s_t)</script> and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-48-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-373\" style=\"width: 3.596em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.971em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.92em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-374\"><span class=\"mi\" id=\"MathJax-Span-375\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-376\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-377\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-378\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-379\"><span class=\"mrow\" id=\"MathJax-Span-380\"><span class=\"mi\" id=\"MathJax-Span-381\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-382\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-383\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-384\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-48\">V(s_{t+1})</script> being the predicted values of the current and next states respectively.</p>\n      </li>\n      <li>\n        <p><strong>Replay Buffer (Experience Replay)</strong>: In Deep RL, a replay buffer stores past transitions (state, action, reward, next state) for sampling during training. This helps break correlation between consecutive samples‚Äîsince experiences are drawn randomly rather than sequentially‚Äîallowing the agent to learn from a more diverse and independent set of experiences, which improves data efficiency and stabilizes training.</p>\n      </li>\n      <li>\n        <p><strong>Actor-Critic Architecture</strong>: A hybrid approach combining a policy-based (actor) component that selects actions and a value-based (critic) component that evaluates them. The critic‚Äôs feedback stabilizes the actor‚Äôs learning.</p>\n      </li>\n    </ol>\n<p><strong>Agent/Learner</strong>: The agent is the learner or decision-maker. It is responsible for selecting actions based on the current state of the environment.</p>\n<p><strong>Environment</strong>: Everything the agent interacts with. The environment defines the rules of the game, transitioning from one state to another based on the agent‚Äôs actions.</p>\n<p><strong>State (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-6-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-19\" style=\"width: 0.519em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.552em, 1000.42em, 2.327em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-20\"><span class=\"mi\" id=\"MathJax-Span-21\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-6\">s</script>)</strong>: A representation of the environment at a particular point in time. States encapsulate all the information that the agent needs to know to make a decision. For example, in a video game, a state might be the current configuration of the game board.</p>\n<p><strong>Action (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-7-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-22\" style=\"width: 0.571em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.552em, 1000.47em, 2.327em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-23\"><span class=\"mi\" id=\"MathJax-Span-24\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-7\">a</script>)</strong>: A decision taken by the agent in response to the current state. In each state, the agent must choose an action from a set of possible actions, which will affect the future state of the environment.</p>\n<p><strong>Reward (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-8-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-25\" style=\"width: 0.467em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.364em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.552em, 1000.36em, 2.327em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-26\"><span class=\"mi\" id=\"MathJax-Span-27\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-8\">r</script>)</strong>: A scalar value that the agent receives from the environment after taking an action. The reward provides feedback on how good or bad an action was in that particular state. The agent‚Äôs objective is to maximize the cumulative reward over time, often referred to as the <strong>return</strong>.</p>\n<p><strong>Policy (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-28\" style=\"width: 0.777em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.604em, 1000.62em, 2.327em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-29\"><span class=\"mi\" id=\"MathJax-Span-30\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.054em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-9\">\\pi</script>)</strong>: A policy is the strategy the agent uses to determine the actions to take based on the current state. It is implemented as a mapping from states to action probabilities. It can be tabular, i.e., a simple lookup table mapping states to actions, or it can be more complex, such as a neural network in the case of deep RL. The policy can be deterministic (always taking the same action for a given state) or stochastic (taking different actions with some probability).</p>\n<p><strong>Value Function</strong>:  The value function estimates how good (i.e., how much <strong>total expected reward</strong>) it is to be in a particular state (in which case, it is called the <strong>state-value function</strong>) or to take a specific action in that state (in which case, it is called the <strong>action-value function</strong>). It does so by accounting for both the immediate reward and the expected future rewards from subsequent states, helping the agent understand long-term reward potential rather than focusing only on immediate rewards. While value functions are of two types (i.e., <strong>state-value function</strong> and <strong>action-value function</strong>), the <strong>state-value function</strong> is also commonly called the <strong>value function</strong>. The relationship between the two is given by: <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-10-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munder><mo>&amp;#x2211;</mo><mi>a</mi></munder><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-31\" style=\"width: 13.388em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 11.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1011.1em, 2.711em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-32\"><span class=\"msubsup\" id=\"MathJax-Span-33\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-34\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-35\"><span class=\"mrow\" id=\"MathJax-Span-36\"><span class=\"mi\" id=\"MathJax-Span-37\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-38\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-39\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-40\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-41\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-42\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-43\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.695em; left: 0.94em;\"><span class=\"mi\" id=\"MathJax-Span-44\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-45\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-46\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-47\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-48\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-49\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-50\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-51\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-52\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-53\"><span class=\"mrow\" id=\"MathJax-Span-54\"><span class=\"mi\" id=\"MathJax-Span-55\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-56\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-57\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-58\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-59\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-60\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munder><mo>‚àë</mo><mi>a</mi></munder><mi>œÄ</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-10\">V^{\\pi}(s) = \\sum_a \\pi(a \\mid s) Q^{\\pi}(s, a)</script>, which means the value of a state under policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-11-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-61\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-62\"><span class=\"mi\" id=\"MathJax-Span-63\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-11\">\\pi</script> is the expected action-value, averaged over all possible actions the policy might take in that state.</p>\n<p><strong>State-Value Function (V-function)</strong>: Denoted as <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-12-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-64\" style=\"width: 2.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.19em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-65\"><span class=\"msubsup\" id=\"MathJax-Span-66\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-67\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-68\"><span class=\"mrow\" id=\"MathJax-Span-69\"><span class=\"mi\" id=\"MathJax-Span-70\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-71\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-72\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-73\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-12\">V^{\\pi}(s)</script>, the state-value function measures the expected return (total discounted reward) starting from state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-74\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-75\"><span class=\"mi\" id=\"MathJax-Span-76\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-13\">s</script> and then following policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-14-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-77\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-78\"><span class=\"mi\" id=\"MathJax-Span-79\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-14\">\\pi</script> thereafter. It is formally defined as <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-15-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-80\" style=\"width: 15.107em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.555em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.878em, 1012.4em, 3.44em, -999.997em); top: -2.914em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-81\"><span class=\"msubsup\" id=\"MathJax-Span-82\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-83\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-84\"><span class=\"mrow\" id=\"MathJax-Span-85\"><span class=\"mi\" id=\"MathJax-Span-86\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-87\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-88\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-89\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-90\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-91\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-92\"><span class=\"mrow\" id=\"MathJax-Span-93\"><span class=\"mi\" id=\"MathJax-Span-94\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-95\"><span class=\"mrow\" id=\"MathJax-Span-96\"><span class=\"mi\" id=\"MathJax-Span-97\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-98\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-99\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-100\"><span class=\"munderover\" id=\"MathJax-Span-101\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-102\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.73em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-103\"><span class=\"mrow\" id=\"MathJax-Span-104\"><span class=\"mi\" id=\"MathJax-Span-105\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àû</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.15em, 4.169em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-106\"><span class=\"mrow\" id=\"MathJax-Span-107\"><span class=\"mi\" id=\"MathJax-Span-108\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-109\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-110\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-111\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-112\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-113\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-114\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-115\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-116\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-117\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-118\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-119\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-120\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-121\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-122\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span></span><span class=\"mo\" id=\"MathJax-Span-123\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.919em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">‚àû</mi></mrow></munderover><msup><mi>Œ≥</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi></mrow><mo>]</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-15\">V^{\\pi}(s) = \\mathbb{E}_{\\pi}\\left[\\sum_{t=0}^{\\infty} \\gamma^t r_t \\mid s_0 = s\\right]</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-124\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-125\"><span class=\"mi\" id=\"MathJax-Span-126\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-16\">\\pi</script> is the policy, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi><mo>&amp;#x2208;</mo><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-127\" style=\"width: 4.69em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.909em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.86em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-128\"><span class=\"mi\" id=\"MathJax-Span-129\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-130\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àà</span><span class=\"mo\" id=\"MathJax-Span-131\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">[</span><span class=\"mn\" id=\"MathJax-Span-132\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-133\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-134\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-135\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi><mo>‚àà</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-17\">\\gamma \\in [0,1)</script> is the discount factor weighting future rewards, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-136\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-137\"><span class=\"msubsup\" id=\"MathJax-Span-138\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-139\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-140\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-18\">r_t</script> is the reward received at time step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-141\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-142\"><span class=\"mi\" id=\"MathJax-Span-143\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-19\">t</script>, and the expectation <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mo>&amp;#x22C5;</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-144\" style=\"width: 2.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1002.09em, 2.555em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-145\"><span class=\"msubsup\" id=\"MathJax-Span-146\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-147\"><span class=\"mrow\" id=\"MathJax-Span-148\"><span class=\"mi\" id=\"MathJax-Span-149\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-150\"><span class=\"mrow\" id=\"MathJax-Span-151\"><span class=\"mi\" id=\"MathJax-Span-152\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-153\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mo\" id=\"MathJax-Span-154\" style=\"font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-155\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msub><mo stretchy=\"false\">[</mo><mo>‚ãÖ</mo><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-20\">\\mathbb{E}_{\\pi}[\\cdot]</script> is taken over trajectories generated by following policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-156\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-157\"><span class=\"mi\" id=\"MathJax-Span-158\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-21\">\\pi</script>.</p>\n<p><strong>Action-Value Function (Q-function)</strong>: Denoted as <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-159\" style=\"width: 3.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.66em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-160\"><span class=\"mi\" id=\"MathJax-Span-161\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-162\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-163\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-164\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-165\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-166\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-22\">Q(s, a)</script> (where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-23-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-167\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.73em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-168\"><span class=\"mi\" id=\"MathJax-Span-169\" style=\"font-family: STIXGeneral-Italic;\">Q</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-23\">Q</script> stands for ‚Äúquality‚Äù), the action-value function measures the expected return for taking action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-24-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-170\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-171\"><span class=\"mi\" id=\"MathJax-Span-172\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-24\">a</script> in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-25-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-173\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-174\"><span class=\"mi\" id=\"MathJax-Span-175\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-25\">s</script> and then following the policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-26-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-176\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-177\"><span class=\"mi\" id=\"MathJax-Span-178\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-26\">\\pi</script> thereafter. It plays a central role in algorithms like Q-learning and Deep Q-Networks (DQN). It is formally defined as <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-27-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><mi>a</mi></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-179\" style=\"width: 19.794em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.461em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.878em, 1016.3em, 3.44em, -999.997em); top: -2.914em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-180\"><span class=\"msubsup\" id=\"MathJax-Span-181\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-182\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-183\"><span class=\"mrow\" id=\"MathJax-Span-184\"><span class=\"mi\" id=\"MathJax-Span-185\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-186\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-187\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-188\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-189\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-190\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-191\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-192\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-193\"><span class=\"mrow\" id=\"MathJax-Span-194\"><span class=\"mi\" id=\"MathJax-Span-195\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-196\"><span class=\"mrow\" id=\"MathJax-Span-197\"><span class=\"mi\" id=\"MathJax-Span-198\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-199\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-200\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-201\"><span class=\"munderover\" id=\"MathJax-Span-202\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-203\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.73em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-204\"><span class=\"mrow\" id=\"MathJax-Span-205\"><span class=\"mi\" id=\"MathJax-Span-206\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àû</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.15em, 4.169em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-207\"><span class=\"mrow\" id=\"MathJax-Span-208\"><span class=\"mi\" id=\"MathJax-Span-209\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-210\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-211\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-212\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-213\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-214\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-215\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-216\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-217\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-218\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-219\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-220\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mn\" id=\"MathJax-Span-221\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-222\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-223\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-224\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-225\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-226\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-227\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-228\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-229\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">a</span></span><span class=\"mo\" id=\"MathJax-Span-230\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.919em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">‚àû</mi></mrow></munderover><msup><mi>Œ≥</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><mi>a</mi></mrow><mo>]</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-27\">Q^{\\pi}(s, a) = \\mathbb{E}_{\\pi}\\left[\\sum_{t=0}^{\\infty} \\gamma^t r_t \\mid s_0 = s, a_0 = a\\right]</script>, where the terms have the same meanings as above, except that the expectation begins from both a given state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-231\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-232\"><span class=\"mi\" id=\"MathJax-Span-233\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-28\">s</script> and an initial action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-29-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-234\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-235\"><span class=\"mi\" id=\"MathJax-Span-236\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-29\">a</script>.</p>\n<p><strong>Advantage Function (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-30-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-237\" style=\"width: 0.881em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.726em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.346em, 1000.67em, 2.327em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-238\"><span class=\"mi\" id=\"MathJax-Span-239\" style=\"font-family: STIXGeneral-Italic;\">A</span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>A</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-30\">A</script>)</strong>: The advantage function quantifies how much better taking a specific action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-31-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-240\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-241\"><span class=\"mi\" id=\"MathJax-Span-242\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-31\">a</script> in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-32-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-243\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-244\"><span class=\"mi\" id=\"MathJax-Span-245\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-32\">s</script> is compared to the average action according to the policy. Put simply, the advantage function measures how much better the actual return was from a particular state than what was expected from that state before acting. It is is commonly used in policy gradient methods such as Actor-Critic and Proximal Policy Optimization (PPO) to reduce variance in gradient estimates. It is defined as <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-33-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-246\" style=\"width: 11.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.482em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1009.43em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-247\"><span class=\"mi\" id=\"MathJax-Span-248\" style=\"font-family: STIXGeneral-Italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-249\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-250\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-251\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-252\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-253\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-254\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-255\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Q</span><span class=\"mo\" id=\"MathJax-Span-256\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-257\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-258\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-259\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-260\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-261\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-262\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-263\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-264\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-265\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>A</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mi>V</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-33\">A(s, a) = Q(s, a) - V(s)</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-34-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-266\" style=\"width: 3.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.66em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-267\"><span class=\"mi\" id=\"MathJax-Span-268\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-269\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-270\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-271\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-272\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-273\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-34\">Q(s, a)</script> is the <strong>action-value function</strong> (the expected return for taking action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-35-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-274\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-275\"><span class=\"mi\" id=\"MathJax-Span-276\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-35\">a</script> in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-36-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-277\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-278\"><span class=\"mi\" id=\"MathJax-Span-279\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-36\">s</script> and then following the policy), and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-37-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-280\" style=\"width: 2.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.77em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-281\"><span class=\"mi\" id=\"MathJax-Span-282\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-283\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-284\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-285\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-37\">V(s)</script> is the <strong>state-value function</strong> (the expected return from state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-38-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-286\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-287\"><span class=\"mi\" id=\"MathJax-Span-288\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-38\">s</script> when following the policy).</p>\n<p><strong>Return (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-39-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-289\" style=\"width: 0.881em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.726em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.346em, 1000.73em, 2.327em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-290\"><span class=\"mi\" id=\"MathJax-Span-291\" style=\"font-family: STIXGeneral-Italic;\">G</span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>G</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-39\">G</script>)</strong>: The total accumulated reward from a given time step onward, often discounted to prioritize near-term rewards <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-40-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mi>k</mi></msup><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-292\" style=\"width: 9.326em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.763em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1007.76em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-293\"><span class=\"msubsup\" id=\"MathJax-Span-294\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-295\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-296\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-297\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-298\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-299\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.73em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-300\"><span class=\"mrow\" id=\"MathJax-Span-301\"><span class=\"mi\" id=\"MathJax-Span-302\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àû</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.25em, 4.169em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-303\"><span class=\"mrow\" id=\"MathJax-Span-304\"><span class=\"mi\" id=\"MathJax-Span-305\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-306\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-307\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-308\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-309\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-310\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-311\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-312\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-313\"><span class=\"mrow\" id=\"MathJax-Span-314\"><span class=\"mi\" id=\"MathJax-Span-315\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-316\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-317\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-318\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-319\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">‚àû</mi></mrow></munderover><msup><mi>Œ≥</mi><mi>k</mi></msup><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-40\">G_t = \\sum_{k=0}^{\\infty} \\gamma^k r_{t+k+1}</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-41-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-320\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.73em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-321\"><span class=\"mi\" id=\"MathJax-Span-322\" style=\"font-family: STIXGeneral-Italic;\">G</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>G</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-41\">G</script> stands for ‚Äúgain‚Äù and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-42-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-323\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-324\"><span class=\"mi\" id=\"MathJax-Span-325\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-42\">\\gamma</script> is the discount factor that determines how much future rewards are valued relative to immediate rewards.</p>\n<p><strong>Discount Factor (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-43-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-326\" style=\"width: 0.726em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.571em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.604em, 1000.57em, 2.534em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-327\"><span class=\"mi\" id=\"MathJax-Span-328\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.054em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-43\">\\gamma</script>)</strong>: A scalar between 0 and 1 that controls the importance of future rewards. Smaller values make the agent myopic (focusing on immediate rewards), while larger values encourage long-term planning. Typically set closer to 1 to focus on long-term rewards rather than immediate ones.</p>\n<p><strong>Exploration vs. Exploitation</strong>: The trade-off between exploring new actions to discover potentially better rewards and exploiting known actions that already yield high rewards. Balancing these two is crucial for effective learning.</p>\n<p><strong>Trajectory/Episode/Rollout</strong>: A sequence of states, actions, rewards, and next states from the beginning of an episode to its termination, representing one complete interaction of the agent with the environment.</p>\n<p><strong>Temporal-Difference (TD) Error</strong>: The difference between the predicted value of a state and the observed reward plus the estimated value of the next state. It is used to update value estimates dynamically in methods like TD-learning, where the TD error is given by <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-44-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B4;</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B3;</mi><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-329\" style=\"width: 12.503em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1010.37em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-330\"><span class=\"msubsup\" id=\"MathJax-Span-331\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-332\" style=\"font-family: STIXGeneral-Italic;\">Œ¥</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-333\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-334\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-335\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-336\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-337\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-338\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-339\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-340\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-341\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-342\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-343\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-344\"><span class=\"mrow\" id=\"MathJax-Span-345\"><span class=\"mi\" id=\"MathJax-Span-346\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-347\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-348\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-349\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-350\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-351\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-352\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-353\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-354\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-355\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-356\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>Œ¥</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>Œ≥</mi><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-44\">\\delta_t = r_t + \\gamma V(s_{t+1}) - V(s_t)</script>, with <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-45-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-357\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-358\"><span class=\"msubsup\" id=\"MathJax-Span-359\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-360\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-361\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-45\">r_t</script> as the immediate reward, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-46-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-362\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-363\"><span class=\"mi\" id=\"MathJax-Span-364\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-46\">\\gamma</script> the discount factor, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-47-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-365\" style=\"width: 2.607em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.09em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-366\"><span class=\"mi\" id=\"MathJax-Span-367\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-368\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-369\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-370\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-371\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-372\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-47\">V(s_t)</script> and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-48-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-373\" style=\"width: 3.596em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.971em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.92em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-374\"><span class=\"mi\" id=\"MathJax-Span-375\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-376\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-377\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-378\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-379\"><span class=\"mrow\" id=\"MathJax-Span-380\"><span class=\"mi\" id=\"MathJax-Span-381\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-382\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-383\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-384\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-48\">V(s_{t+1})</script> being the predicted values of the current and next states respectively.</p>\n<p><strong>Replay Buffer (Experience Replay)</strong>: In Deep RL, a replay buffer stores past transitions (state, action, reward, next state) for sampling during training. This helps break correlation between consecutive samples‚Äîsince experiences are drawn randomly rather than sequentially‚Äîallowing the agent to learn from a more diverse and independent set of experiences, which improves data efficiency and stabilizes training.</p>\n<p><strong>Actor-Critic Architecture</strong>: A hybrid approach combining a policy-based (actor) component that selects actions and a value-based (critic) component that evaluates them. The critic‚Äôs feedback stabilizes the actor‚Äôs learning.</p>",
    "contentMarkdown": "*   At the core of RL is the interaction between an **agent** and an **environment**, as shown in the diagram below [(source)](https://www.youtube.com/watch?v=2MBJOuVq380):\n\n![](/primers/ai/assets/rlhf/1.png)\n\n*   In this interaction, the agent takes actions in the environment and receives feedback in the form of states and rewards. The goal is for the agent to learn a strategy, or **policy**, that maximizes the cumulative reward over time.\n    \n*   Here are the critical components of RL:\n    \n    1.  **Agent/Learner**: The agent is the learner or decision-maker. It is responsible for selecting actions based on the current state of the environment.\n        \n    2.  **Environment**: Everything the agent interacts with. The environment defines the rules of the game, transitioning from one state to another based on the agent‚Äôs actions.\n        \n    3.  **State (sss)**: A representation of the environment at a particular point in time. States encapsulate all the information that the agent needs to know to make a decision. For example, in a video game, a state might be the current configuration of the game board.\n        \n    4.  **Action (aaa)**: A decision taken by the agent in response to the current state. In each state, the agent must choose an action from a set of possible actions, which will affect the future state of the environment.\n        \n    5.  **Reward (rrr)**: A scalar value that the agent receives from the environment after taking an action. The reward provides feedback on how good or bad an action was in that particular state. The agent‚Äôs objective is to maximize the cumulative reward over time, often referred to as the **return**.\n        \n    6.  **Policy (œÄœÄ\\\\pi)**: A policy is the strategy the agent uses to determine the actions to take based on the current state. It is implemented as a mapping from states to action probabilities. It can be tabular, i.e., a simple lookup table mapping states to actions, or it can be more complex, such as a neural network in the case of deep RL. The policy can be deterministic (always taking the same action for a given state) or stochastic (taking different actions with some probability).\n        \n    7.  **Value Function**: The value function estimates how good (i.e., how much **total expected reward**) it is to be in a particular state (in which case, it is called the **state-value function**) or to take a specific action in that state (in which case, it is called the **action-value function**). It does so by accounting for both the immediate reward and the expected future rewards from subsequent states, helping the agent understand long-term reward potential rather than focusing only on immediate rewards. While value functions are of two types (i.e., **state-value function** and **action-value function**), the **state-value function** is also commonly called the **value function**. The relationship between the two is given by: VœÄ(s)\\=‚àëaœÄ(a‚à£s)QœÄ(s,a)VœÄ(s)\\=‚àëaœÄ(a‚à£s)QœÄ(s,a)V^{\\\\pi}(s) = \\\\sum\\_a \\\\pi(a \\\\mid s) Q^{\\\\pi}(s, a), which means the value of a state under policy œÄœÄ\\\\pi is the expected action-value, averaged over all possible actions the policy might take in that state.\n        \n    8.  **State-Value Function (V-function)**: Denoted as VœÄ(s)VœÄ(s)V^{\\\\pi}(s), the state-value function measures the expected return (total discounted reward) starting from state sss and then following policy œÄœÄ\\\\pi thereafter. It is formally defined as VœÄ(s)\\=ùîºœÄ\\[‚àë‚àût\\=0Œ≥trt‚à£s0\\=s\\]VœÄ(s)\\=EœÄ\\[‚àët\\=0‚àûŒ≥trt‚à£s0\\=s\\]V^{\\\\pi}(s) = \\\\mathbb{E}\\_{\\\\pi}\\\\left\\[\\\\sum\\_{t=0}^{\\\\infty} \\\\gamma^t r\\_t \\\\mid s\\_0 = s\\\\right\\], where œÄœÄ\\\\pi is the policy, Œ≥‚àà\\[0,1)Œ≥‚àà\\[0,1)\\\\gamma \\\\in \\[0,1) is the discount factor weighting future rewards, rtrtr\\_t is the reward received at time step ttt, and the expectation ùîºœÄ\\[‚ãÖ\\]EœÄ\\[‚ãÖ\\]\\\\mathbb{E}\\_{\\\\pi}\\[\\\\cdot\\] is taken over trajectories generated by following policy œÄœÄ\\\\pi.\n        \n    9.  **Action-Value Function (Q-function)**: Denoted as Q(s,a)Q(s,a)Q(s, a) (where QQQ stands for ‚Äúquality‚Äù), the action-value function measures the expected return for taking action aaa in state sss and then following the policy œÄœÄ\\\\pi thereafter. It plays a central role in algorithms like Q-learning and Deep Q-Networks (DQN). It is formally defined as QœÄ(s,a)\\=ùîºœÄ\\[‚àë‚àût\\=0Œ≥trt‚à£s0\\=s,a0\\=a\\]QœÄ(s,a)\\=EœÄ\\[‚àët\\=0‚àûŒ≥trt‚à£s0\\=s,a0\\=a\\]Q^{\\\\pi}(s, a) = \\\\mathbb{E}\\_{\\\\pi}\\\\left\\[\\\\sum\\_{t=0}^{\\\\infty} \\\\gamma^t r\\_t \\\\mid s\\_0 = s, a\\_0 = a\\\\right\\], where the terms have the same meanings as above, except that the expectation begins from both a given state sss and an initial action aaa.\n        \n    10.  **Advantage Function (AAA)**: The advantage function quantifies how much better taking a specific action aaa in state sss is compared to the average action according to the policy. Put simply, the advantage function measures how much better the actual return was from a particular state than what was expected from that state before acting. It is is commonly used in policy gradient methods such as Actor-Critic and Proximal Policy Optimization (PPO) to reduce variance in gradient estimates. It is defined as A(s,a)\\=Q(s,a)‚àíV(s)A(s,a)\\=Q(s,a)‚àíV(s)A(s, a) = Q(s, a) - V(s), where Q(s,a)Q(s,a)Q(s, a) is the **action-value function** (the expected return for taking action aaa in state sss and then following the policy), and V(s)V(s)V(s) is the **state-value function** (the expected return from state sss when following the policy).\n         \n    11.  **Return (GGG)**: The total accumulated reward from a given time step onward, often discounted to prioritize near-term rewards Gt\\=‚àë‚àûk\\=0Œ≥krt+k+1Gt\\=‚àëk\\=0‚àûŒ≥krt+k+1G\\_t = \\\\sum\\_{k=0}^{\\\\infty} \\\\gamma^k r\\_{t+k+1}, where GGG stands for ‚Äúgain‚Äù and Œ≥Œ≥\\\\gamma is the discount factor that determines how much future rewards are valued relative to immediate rewards.\n         \n    12.  **Discount Factor (Œ≥Œ≥\\\\gamma)**: A scalar between 0 and 1 that controls the importance of future rewards. Smaller values make the agent myopic (focusing on immediate rewards), while larger values encourage long-term planning. Typically set closer to 1 to focus on long-term rewards rather than immediate ones.\n         \n    13.  **Exploration vs. Exploitation**: The trade-off between exploring new actions to discover potentially better rewards and exploiting known actions that already yield high rewards. Balancing these two is crucial for effective learning.\n         \n    14.  **Trajectory/Episode/Rollout**: A sequence of states, actions, rewards, and next states from the beginning of an episode to its termination, representing one complete interaction of the agent with the environment.\n         \n    15.  **Temporal-Difference (TD) Error**: The difference between the predicted value of a state and the observed reward plus the estimated value of the next state. It is used to update value estimates dynamically in methods like TD-learning, where the TD error is given by Œ¥t\\=rt+Œ≥V(st+1)‚àíV(st)Œ¥t\\=rt+Œ≥V(st+1)‚àíV(st)\\\\delta\\_t = r\\_t + \\\\gamma V(s\\_{t+1}) - V(s\\_t), with rtrtr\\_t as the immediate reward, Œ≥Œ≥\\\\gamma the discount factor, and V(st)V(st)V(s\\_t) and V(st+1)V(st+1)V(s\\_{t+1}) being the predicted values of the current and next states respectively.\n         \n    16.  **Replay Buffer (Experience Replay)**: In Deep RL, a replay buffer stores past transitions (state, action, reward, next state) for sampling during training. This helps break correlation between consecutive samples‚Äîsince experiences are drawn randomly rather than sequentially‚Äîallowing the agent to learn from a more diverse and independent set of experiences, which improves data efficiency and stabilizes training.\n         \n    17.  **Actor-Critic Architecture**: A hybrid approach combining a policy-based (actor) component that selects actions and a value-based (critic) component that evaluates them. The critic‚Äôs feedback stabilizes the actor‚Äôs learning.\n         \n\nIn this interaction, the agent takes actions in the environment and receives feedback in the form of states and rewards. The goal is for the agent to learn a strategy, or **policy**, that maximizes the cumulative reward over time.\n\nHere are the critical components of RL:\n\n1.  **Agent/Learner**: The agent is the learner or decision-maker. It is responsible for selecting actions based on the current state of the environment.\n    \n2.  **Environment**: Everything the agent interacts with. The environment defines the rules of the game, transitioning from one state to another based on the agent‚Äôs actions.\n    \n3.  **State (sss)**: A representation of the environment at a particular point in time. States encapsulate all the information that the agent needs to know to make a decision. For example, in a video game, a state might be the current configuration of the game board.\n    \n4.  **Action (aaa)**: A decision taken by the agent in response to the current state. In each state, the agent must choose an action from a set of possible actions, which will affect the future state of the environment.\n    \n5.  **Reward (rrr)**: A scalar value that the agent receives from the environment after taking an action. The reward provides feedback on how good or bad an action was in that particular state. The agent‚Äôs objective is to maximize the cumulative reward over time, often referred to as the **return**.\n    \n6.  **Policy (œÄœÄ\\\\pi)**: A policy is the strategy the agent uses to determine the actions to take based on the current state. It is implemented as a mapping from states to action probabilities. It can be tabular, i.e., a simple lookup table mapping states to actions, or it can be more complex, such as a neural network in the case of deep RL. The policy can be deterministic (always taking the same action for a given state) or stochastic (taking different actions with some probability).\n    \n7.  **Value Function**: The value function estimates how good (i.e., how much **total expected reward**) it is to be in a particular state (in which case, it is called the **state-value function**) or to take a specific action in that state (in which case, it is called the **action-value function**). It does so by accounting for both the immediate reward and the expected future rewards from subsequent states, helping the agent understand long-term reward potential rather than focusing only on immediate rewards. While value functions are of two types (i.e., **state-value function** and **action-value function**), the **state-value function** is also commonly called the **value function**. The relationship between the two is given by: VœÄ(s)\\=‚àëaœÄ(a‚à£s)QœÄ(s,a)VœÄ(s)\\=‚àëaœÄ(a‚à£s)QœÄ(s,a)V^{\\\\pi}(s) = \\\\sum\\_a \\\\pi(a \\\\mid s) Q^{\\\\pi}(s, a), which means the value of a state under policy œÄœÄ\\\\pi is the expected action-value, averaged over all possible actions the policy might take in that state.\n    \n8.  **State-Value Function (V-function)**: Denoted as VœÄ(s)VœÄ(s)V^{\\\\pi}(s), the state-value function measures the expected return (total discounted reward) starting from state sss and then following policy œÄœÄ\\\\pi thereafter. It is formally defined as VœÄ(s)\\=ùîºœÄ\\[‚àë‚àût\\=0Œ≥trt‚à£s0\\=s\\]VœÄ(s)\\=EœÄ\\[‚àët\\=0‚àûŒ≥trt‚à£s0\\=s\\]V^{\\\\pi}(s) = \\\\mathbb{E}\\_{\\\\pi}\\\\left\\[\\\\sum\\_{t=0}^{\\\\infty} \\\\gamma^t r\\_t \\\\mid s\\_0 = s\\\\right\\], where œÄœÄ\\\\pi is the policy, Œ≥‚àà\\[0,1)Œ≥‚àà\\[0,1)\\\\gamma \\\\in \\[0,1) is the discount factor weighting future rewards, rtrtr\\_t is the reward received at time step ttt, and the expectation ùîºœÄ\\[‚ãÖ\\]EœÄ\\[‚ãÖ\\]\\\\mathbb{E}\\_{\\\\pi}\\[\\\\cdot\\] is taken over trajectories generated by following policy œÄœÄ\\\\pi.\n    \n9.  **Action-Value Function (Q-function)**: Denoted as Q(s,a)Q(s,a)Q(s, a) (where QQQ stands for ‚Äúquality‚Äù), the action-value function measures the expected return for taking action aaa in state sss and then following the policy œÄœÄ\\\\pi thereafter. It plays a central role in algorithms like Q-learning and Deep Q-Networks (DQN). It is formally defined as QœÄ(s,a)\\=ùîºœÄ\\[‚àë‚àût\\=0Œ≥trt‚à£s0\\=s,a0\\=a\\]QœÄ(s,a)\\=EœÄ\\[‚àët\\=0‚àûŒ≥trt‚à£s0\\=s,a0\\=a\\]Q^{\\\\pi}(s, a) = \\\\mathbb{E}\\_{\\\\pi}\\\\left\\[\\\\sum\\_{t=0}^{\\\\infty} \\\\gamma^t r\\_t \\\\mid s\\_0 = s, a\\_0 = a\\\\right\\], where the terms have the same meanings as above, except that the expectation begins from both a given state sss and an initial action aaa.\n    \n10.  **Advantage Function (AAA)**: The advantage function quantifies how much better taking a specific action aaa in state sss is compared to the average action according to the policy. Put simply, the advantage function measures how much better the actual return was from a particular state than what was expected from that state before acting. It is is commonly used in policy gradient methods such as Actor-Critic and Proximal Policy Optimization (PPO) to reduce variance in gradient estimates. It is defined as A(s,a)\\=Q(s,a)‚àíV(s)A(s,a)\\=Q(s,a)‚àíV(s)A(s, a) = Q(s, a) - V(s), where Q(s,a)Q(s,a)Q(s, a) is the **action-value function** (the expected return for taking action aaa in state sss and then following the policy), and V(s)V(s)V(s) is the **state-value function** (the expected return from state sss when following the policy).\n     \n11.  **Return (GGG)**: The total accumulated reward from a given time step onward, often discounted to prioritize near-term rewards Gt\\=‚àë‚àûk\\=0Œ≥krt+k+1Gt\\=‚àëk\\=0‚àûŒ≥krt+k+1G\\_t = \\\\sum\\_{k=0}^{\\\\infty} \\\\gamma^k r\\_{t+k+1}, where GGG stands for ‚Äúgain‚Äù and Œ≥Œ≥\\\\gamma is the discount factor that determines how much future rewards are valued relative to immediate rewards.\n     \n12.  **Discount Factor (Œ≥Œ≥\\\\gamma)**: A scalar between 0 and 1 that controls the importance of future rewards. Smaller values make the agent myopic (focusing on immediate rewards), while larger values encourage long-term planning. Typically set closer to 1 to focus on long-term rewards rather than immediate ones.\n     \n13.  **Exploration vs. Exploitation**: The trade-off between exploring new actions to discover potentially better rewards and exploiting known actions that already yield high rewards. Balancing these two is crucial for effective learning.\n     \n14.  **Trajectory/Episode/Rollout**: A sequence of states, actions, rewards, and next states from the beginning of an episode to its termination, representing one complete interaction of the agent with the environment.\n     \n15.  **Temporal-Difference (TD) Error**: The difference between the predicted value of a state and the observed reward plus the estimated value of the next state. It is used to update value estimates dynamically in methods like TD-learning, where the TD error is given by Œ¥t\\=rt+Œ≥V(st+1)‚àíV(st)Œ¥t\\=rt+Œ≥V(st+1)‚àíV(st)\\\\delta\\_t = r\\_t + \\\\gamma V(s\\_{t+1}) - V(s\\_t), with rtrtr\\_t as the immediate reward, Œ≥Œ≥\\\\gamma the discount factor, and V(st)V(st)V(s\\_t) and V(st+1)V(st+1)V(s\\_{t+1}) being the predicted values of the current and next states respectively.\n     \n16.  **Replay Buffer (Experience Replay)**: In Deep RL, a replay buffer stores past transitions (state, action, reward, next state) for sampling during training. This helps break correlation between consecutive samples‚Äîsince experiences are drawn randomly rather than sequentially‚Äîallowing the agent to learn from a more diverse and independent set of experiences, which improves data efficiency and stabilizes training.\n     \n17.  **Actor-Critic Architecture**: A hybrid approach combining a policy-based (actor) component that selects actions and a value-based (critic) component that evaluates them. The critic‚Äôs feedback stabilizes the actor‚Äôs learning.\n     \n\n**Agent/Learner**: The agent is the learner or decision-maker. It is responsible for selecting actions based on the current state of the environment.\n\n**Environment**: Everything the agent interacts with. The environment defines the rules of the game, transitioning from one state to another based on the agent‚Äôs actions.\n\n**State (sss)**: A representation of the environment at a particular point in time. States encapsulate all the information that the agent needs to know to make a decision. For example, in a video game, a state might be the current configuration of the game board.\n\n**Action (aaa)**: A decision taken by the agent in response to the current state. In each state, the agent must choose an action from a set of possible actions, which will affect the future state of the environment.\n\n**Reward (rrr)**: A scalar value that the agent receives from the environment after taking an action. The reward provides feedback on how good or bad an action was in that particular state. The agent‚Äôs objective is to maximize the cumulative reward over time, often referred to as the **return**.\n\n**Policy (œÄœÄ\\\\pi)**: A policy is the strategy the agent uses to determine the actions to take based on the current state. It is implemented as a mapping from states to action probabilities. It can be tabular, i.e., a simple lookup table mapping states to actions, or it can be more complex, such as a neural network in the case of deep RL. The policy can be deterministic (always taking the same action for a given state) or stochastic (taking different actions with some probability).\n\n**Value Function**: The value function estimates how good (i.e., how much **total expected reward**) it is to be in a particular state (in which case, it is called the **state-value function**) or to take a specific action in that state (in which case, it is called the **action-value function**). It does so by accounting for both the immediate reward and the expected future rewards from subsequent states, helping the agent understand long-term reward potential rather than focusing only on immediate rewards. While value functions are of two types (i.e., **state-value function** and **action-value function**), the **state-value function** is also commonly called the **value function**. The relationship between the two is given by: VœÄ(s)\\=‚àëaœÄ(a‚à£s)QœÄ(s,a)VœÄ(s)\\=‚àëaœÄ(a‚à£s)QœÄ(s,a)V^{\\\\pi}(s) = \\\\sum\\_a \\\\pi(a \\\\mid s) Q^{\\\\pi}(s, a), which means the value of a state under policy œÄœÄ\\\\pi is the expected action-value, averaged over all possible actions the policy might take in that state.\n\n**State-Value Function (V-function)**: Denoted as VœÄ(s)VœÄ(s)V^{\\\\pi}(s), the state-value function measures the expected return (total discounted reward) starting from state sss and then following policy œÄœÄ\\\\pi thereafter. It is formally defined as VœÄ(s)\\=ùîºœÄ\\[‚àë‚àût\\=0Œ≥trt‚à£s0\\=s\\]VœÄ(s)\\=EœÄ\\[‚àët\\=0‚àûŒ≥trt‚à£s0\\=s\\]V^{\\\\pi}(s) = \\\\mathbb{E}\\_{\\\\pi}\\\\left\\[\\\\sum\\_{t=0}^{\\\\infty} \\\\gamma^t r\\_t \\\\mid s\\_0 = s\\\\right\\], where œÄœÄ\\\\pi is the policy, Œ≥‚àà\\[0,1)Œ≥‚àà\\[0,1)\\\\gamma \\\\in \\[0,1) is the discount factor weighting future rewards, rtrtr\\_t is the reward received at time step ttt, and the expectation ùîºœÄ\\[‚ãÖ\\]EœÄ\\[‚ãÖ\\]\\\\mathbb{E}\\_{\\\\pi}\\[\\\\cdot\\] is taken over trajectories generated by following policy œÄœÄ\\\\pi.\n\n**Action-Value Function (Q-function)**: Denoted as Q(s,a)Q(s,a)Q(s, a) (where QQQ stands for ‚Äúquality‚Äù), the action-value function measures the expected return for taking action aaa in state sss and then following the policy œÄœÄ\\\\pi thereafter. It plays a central role in algorithms like Q-learning and Deep Q-Networks (DQN). It is formally defined as QœÄ(s,a)\\=ùîºœÄ\\[‚àë‚àût\\=0Œ≥trt‚à£s0\\=s,a0\\=a\\]QœÄ(s,a)\\=EœÄ\\[‚àët\\=0‚àûŒ≥trt‚à£s0\\=s,a0\\=a\\]Q^{\\\\pi}(s, a) = \\\\mathbb{E}\\_{\\\\pi}\\\\left\\[\\\\sum\\_{t=0}^{\\\\infty} \\\\gamma^t r\\_t \\\\mid s\\_0 = s, a\\_0 = a\\\\right\\], where the terms have the same meanings as above, except that the expectation begins from both a given state sss and an initial action aaa.\n\n**Advantage Function (AAA)**: The advantage function quantifies how much better taking a specific action aaa in state sss is compared to the average action according to the policy. Put simply, the advantage function measures how much better the actual return was from a particular state than what was expected from that state before acting. It is is commonly used in policy gradient methods such as Actor-Critic and Proximal Policy Optimization (PPO) to reduce variance in gradient estimates. It is defined as A(s,a)\\=Q(s,a)‚àíV(s)A(s,a)\\=Q(s,a)‚àíV(s)A(s, a) = Q(s, a) - V(s), where Q(s,a)Q(s,a)Q(s, a) is the **action-value function** (the expected return for taking action aaa in state sss and then following the policy), and V(s)V(s)V(s) is the **state-value function** (the expected return from state sss when following the policy).\n\n**Return (GGG)**: The total accumulated reward from a given time step onward, often discounted to prioritize near-term rewards Gt\\=‚àë‚àûk\\=0Œ≥krt+k+1Gt\\=‚àëk\\=0‚àûŒ≥krt+k+1G\\_t = \\\\sum\\_{k=0}^{\\\\infty} \\\\gamma^k r\\_{t+k+1}, where GGG stands for ‚Äúgain‚Äù and Œ≥Œ≥\\\\gamma is the discount factor that determines how much future rewards are valued relative to immediate rewards.\n\n**Discount Factor (Œ≥Œ≥\\\\gamma)**: A scalar between 0 and 1 that controls the importance of future rewards. Smaller values make the agent myopic (focusing on immediate rewards), while larger values encourage long-term planning. Typically set closer to 1 to focus on long-term rewards rather than immediate ones.\n\n**Exploration vs. Exploitation**: The trade-off between exploring new actions to discover potentially better rewards and exploiting known actions that already yield high rewards. Balancing these two is crucial for effective learning.\n\n**Trajectory/Episode/Rollout**: A sequence of states, actions, rewards, and next states from the beginning of an episode to its termination, representing one complete interaction of the agent with the environment.\n\n**Temporal-Difference (TD) Error**: The difference between the predicted value of a state and the observed reward plus the estimated value of the next state. It is used to update value estimates dynamically in methods like TD-learning, where the TD error is given by Œ¥t\\=rt+Œ≥V(st+1)‚àíV(st)Œ¥t\\=rt+Œ≥V(st+1)‚àíV(st)\\\\delta\\_t = r\\_t + \\\\gamma V(s\\_{t+1}) - V(s\\_t), with rtrtr\\_t as the immediate reward, Œ≥Œ≥\\\\gamma the discount factor, and V(st)V(st)V(s\\_t) and V(st+1)V(st+1)V(s\\_{t+1}) being the predicted values of the current and next states respectively.\n\n**Replay Buffer (Experience Replay)**: In Deep RL, a replay buffer stores past transitions (state, action, reward, next state) for sampling during training. This helps break correlation between consecutive samples‚Äîsince experiences are drawn randomly rather than sequentially‚Äîallowing the agent to learn from a more diverse and independent set of experiences, which improves data efficiency and stabilizes training.\n\n**Actor-Critic Architecture**: A hybrid approach combining a policy-based (actor) component that selects actions and a value-based (critic) component that evaluates them. The critic‚Äôs feedback stabilizes the actor‚Äôs learning.",
    "order": 1,
    "orderInChapter": 1,
    "difficulty": 4,
    "estimatedMinutes": 16,
    "tags": [
      "algorithmsarchitecture",
      "neural network",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": true,
      "wordCount": 3190,
      "contentLength": 317920
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#key-components-of-reinforcement-learning",
    "scrapedAt": "2025-12-28T11:47:08.458Z"
  },
  {
    "id": "ai-reinforcement-learning-the-bellman-equation-2",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Basics of Reinforcement Learning",
    "title": "The Bellman Equation",
    "subtitle": "Basics of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>\n    <p>The Bellman Equation is a fundamental concept in RL, used to describe the relationship between the value of a state and the value of its successor states. It breaks down the value function into immediate rewards and the expected value of future states.</p>\n  </li>\n  <li>\n    <p>For a given policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-49-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-385\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-386\"><span class=\"mi\" id=\"MathJax-Span-387\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-49\">\\pi</script>, the state-value function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-50-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-388\" style=\"width: 2.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.19em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-389\"><span class=\"msubsup\" id=\"MathJax-Span-390\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-391\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-392\"><span class=\"mrow\" id=\"MathJax-Span-393\"><span class=\"mi\" id=\"MathJax-Span-394\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-395\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-396\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-397\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-50\">V^{\\pi}(s)</script> can be written as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-51-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mi>&amp;#x03C0;</mi></msub><mrow><mo>[</mo><mrow><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B3;</mi><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-398\" style=\"width: 17.294em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 14.378em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.878em, 1014.22em, 3.44em, -999.997em); top: -2.914em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-399\"><span class=\"msubsup\" id=\"MathJax-Span-400\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-401\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-402\"><span class=\"mrow\" id=\"MathJax-Span-403\"><span class=\"mi\" id=\"MathJax-Span-404\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-405\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-406\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-407\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-408\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-409\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-410\"><span class=\"mrow\" id=\"MathJax-Span-411\"><span class=\"mi\" id=\"MathJax-Span-412\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-413\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-414\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-415\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-416\"><span class=\"msubsup\" id=\"MathJax-Span-417\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-418\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-419\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-420\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-421\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-422\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-423\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-424\"><span class=\"mrow\" id=\"MathJax-Span-425\"><span class=\"mi\" id=\"MathJax-Span-426\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-427\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-428\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-429\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-430\"><span class=\"mrow\" id=\"MathJax-Span-431\"><span class=\"mi\" id=\"MathJax-Span-432\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-433\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-434\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-435\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-436\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-437\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-438\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-439\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-440\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-441\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span></span><span class=\"mo\" id=\"MathJax-Span-442\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.919em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mi>œÄ</mi></msub><mrow><mo>[</mo><mrow><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>Œ≥</mi><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>‚à£</mo><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-51\">V^{\\pi}(s) = \\mathbb{E}_\\pi \\left[ r_t + \\gamma V^{\\pi}(s_{t+1}) \\mid s_t = s \\right]</script>\n\n    <ul>\n      <li>where:\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-52-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-443\" style=\"width: 2.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.19em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-444\"><span class=\"msubsup\" id=\"MathJax-Span-445\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-446\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-447\"><span class=\"mrow\" id=\"MathJax-Span-448\"><span class=\"mi\" id=\"MathJax-Span-449\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-450\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-451\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-452\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-52\">V^{\\pi}(s)</script> is the value of state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-53-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-453\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-454\"><span class=\"mi\" id=\"MathJax-Span-455\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-53\">s</script> under policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-54-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-456\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-457\"><span class=\"mi\" id=\"MathJax-Span-458\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-54\">\\pi</script>,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-55-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-459\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-460\"><span class=\"msubsup\" id=\"MathJax-Span-461\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-462\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-463\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-55\">r_t</script> is the reward received after taking an action at time <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-56-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-464\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-465\"><span class=\"mi\" id=\"MathJax-Span-466\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-56\">t</script>,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-57-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-467\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-468\"><span class=\"mi\" id=\"MathJax-Span-469\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-57\">\\gamma</script> is the discount factor (0 ‚â§ <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-58-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-470\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-471\"><span class=\"mi\" id=\"MathJax-Span-472\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-58\">\\gamma</script> ‚â§ 1) that determines the importance of future rewards,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-59-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-473\" style=\"width: 1.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.51em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-474\"><span class=\"msubsup\" id=\"MathJax-Span-475\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-476\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-477\"><span class=\"mrow\" id=\"MathJax-Span-478\"><span class=\"mi\" id=\"MathJax-Span-479\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-480\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-481\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-59\">s_{t+1}</script> is the next state after taking an action from state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-60-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-482\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-483\"><span class=\"mi\" id=\"MathJax-Span-484\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-60\">s</script>.</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>This equation expresses that the value of a state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-61-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-485\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-486\"><span class=\"mi\" id=\"MathJax-Span-487\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-61\">s</script> is the immediate reward <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-62-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-488\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-489\"><span class=\"msubsup\" id=\"MathJax-Span-490\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-491\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-492\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-62\">r_t</script> plus the discounted value of the next state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-63-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-493\" style=\"width: 4.065em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.388em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.34em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-494\"><span class=\"msubsup\" id=\"MathJax-Span-495\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-496\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-497\"><span class=\"mrow\" id=\"MathJax-Span-498\"><span class=\"mi\" id=\"MathJax-Span-499\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-500\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-501\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-502\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-503\"><span class=\"mrow\" id=\"MathJax-Span-504\"><span class=\"mi\" id=\"MathJax-Span-505\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-506\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-507\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-508\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-63\">V^{\\pi}(s_{t+1})</script>. The Bellman equation is central to many RL algorithms, as it provides the basis for recursively solving the optimal value function.</p>\n  </li>\n</ul>\n<p>The Bellman Equation is a fundamental concept in RL, used to describe the relationship between the value of a state and the value of its successor states. It breaks down the value function into immediate rewards and the expected value of future states.</p>\n<p>For a given policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-49-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-385\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-386\"><span class=\"mi\" id=\"MathJax-Span-387\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-49\">\\pi</script>, the state-value function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-50-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-388\" style=\"width: 2.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.19em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-389\"><span class=\"msubsup\" id=\"MathJax-Span-390\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-391\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-392\"><span class=\"mrow\" id=\"MathJax-Span-393\"><span class=\"mi\" id=\"MathJax-Span-394\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-395\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-396\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-397\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-50\">V^{\\pi}(s)</script> can be written as:</p>\n<ul>\n      <li>where:\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-52-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-443\" style=\"width: 2.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.19em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-444\"><span class=\"msubsup\" id=\"MathJax-Span-445\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-446\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-447\"><span class=\"mrow\" id=\"MathJax-Span-448\"><span class=\"mi\" id=\"MathJax-Span-449\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-450\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-451\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-452\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-52\">V^{\\pi}(s)</script> is the value of state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-53-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-453\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-454\"><span class=\"mi\" id=\"MathJax-Span-455\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-53\">s</script> under policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-54-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-456\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-457\"><span class=\"mi\" id=\"MathJax-Span-458\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-54\">\\pi</script>,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-55-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-459\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-460\"><span class=\"msubsup\" id=\"MathJax-Span-461\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-462\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-463\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-55\">r_t</script> is the reward received after taking an action at time <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-56-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-464\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-465\"><span class=\"mi\" id=\"MathJax-Span-466\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-56\">t</script>,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-57-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-467\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-468\"><span class=\"mi\" id=\"MathJax-Span-469\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-57\">\\gamma</script> is the discount factor (0 ‚â§ <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-58-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-470\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-471\"><span class=\"mi\" id=\"MathJax-Span-472\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-58\">\\gamma</script> ‚â§ 1) that determines the importance of future rewards,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-59-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-473\" style=\"width: 1.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.51em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-474\"><span class=\"msubsup\" id=\"MathJax-Span-475\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-476\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-477\"><span class=\"mrow\" id=\"MathJax-Span-478\"><span class=\"mi\" id=\"MathJax-Span-479\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-480\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-481\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-59\">s_{t+1}</script> is the next state after taking an action from state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-60-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-482\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-483\"><span class=\"mi\" id=\"MathJax-Span-484\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-60\">s</script>.</li>\n        </ul>\n      </li>\n    </ul>\n<ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-52-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-443\" style=\"width: 2.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.19em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-444\"><span class=\"msubsup\" id=\"MathJax-Span-445\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-446\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-447\"><span class=\"mrow\" id=\"MathJax-Span-448\"><span class=\"mi\" id=\"MathJax-Span-449\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-450\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-451\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-452\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-52\">V^{\\pi}(s)</script> is the value of state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-53-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-453\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-454\"><span class=\"mi\" id=\"MathJax-Span-455\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-53\">s</script> under policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-54-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-456\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-457\"><span class=\"mi\" id=\"MathJax-Span-458\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-54\">\\pi</script>,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-55-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-459\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-460\"><span class=\"msubsup\" id=\"MathJax-Span-461\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-462\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-463\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-55\">r_t</script> is the reward received after taking an action at time <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-56-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-464\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-465\"><span class=\"mi\" id=\"MathJax-Span-466\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-56\">t</script>,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-57-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-467\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-468\"><span class=\"mi\" id=\"MathJax-Span-469\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-57\">\\gamma</script> is the discount factor (0 ‚â§ <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-58-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-470\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-471\"><span class=\"mi\" id=\"MathJax-Span-472\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-58\">\\gamma</script> ‚â§ 1) that determines the importance of future rewards,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-59-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-473\" style=\"width: 1.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.51em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-474\"><span class=\"msubsup\" id=\"MathJax-Span-475\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-476\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-477\"><span class=\"mrow\" id=\"MathJax-Span-478\"><span class=\"mi\" id=\"MathJax-Span-479\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-480\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-481\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-59\">s_{t+1}</script> is the next state after taking an action from state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-60-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-482\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-483\"><span class=\"mi\" id=\"MathJax-Span-484\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-60\">s</script>.</li>\n        </ul>\n<p>This equation expresses that the value of a state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-61-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-485\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-486\"><span class=\"mi\" id=\"MathJax-Span-487\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-61\">s</script> is the immediate reward <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-62-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-488\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-489\"><span class=\"msubsup\" id=\"MathJax-Span-490\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-491\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-492\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-62\">r_t</script> plus the discounted value of the next state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-63-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-493\" style=\"width: 4.065em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.388em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.34em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-494\"><span class=\"msubsup\" id=\"MathJax-Span-495\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-496\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-497\"><span class=\"mrow\" id=\"MathJax-Span-498\"><span class=\"mi\" id=\"MathJax-Span-499\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-500\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-501\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-502\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-503\"><span class=\"mrow\" id=\"MathJax-Span-504\"><span class=\"mi\" id=\"MathJax-Span-505\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-506\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-507\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-508\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-63\">V^{\\pi}(s_{t+1})</script>. The Bellman equation is central to many RL algorithms, as it provides the basis for recursively solving the optimal value function.</p>",
    "contentMarkdown": "*   The Bellman Equation is a fundamental concept in RL, used to describe the relationship between the value of a state and the value of its successor states. It breaks down the value function into immediate rewards and the expected value of future states.\n    \n*   For a given policy œÄœÄ\\\\pi, the state-value function VœÄ(s)VœÄ(s)V^{\\\\pi}(s) can be written as:\n    \n    VœÄ(s)\\=ùîºœÄ\\[rt+Œ≥VœÄ(st+1)‚à£st\\=s\\]VœÄ(s)\\=EœÄ\\[rt+Œ≥VœÄ(st+1)‚à£st\\=s\\]\n    \n    V^{\\\\pi}(s) = \\\\mathbb{E}\\_\\\\pi \\\\left\\[ r\\_t + \\\\gamma V^{\\\\pi}(s\\_{t+1}) \\\\mid s\\_t = s \\\\right\\]\n    *   where:\n        *   VœÄ(s)VœÄ(s)V^{\\\\pi}(s) is the value of state sss under policy œÄœÄ\\\\pi,\n        *   rtrtr\\_t is the reward received after taking an action at time ttt,\n        *   Œ≥Œ≥\\\\gamma is the discount factor (0 ‚â§ Œ≥Œ≥\\\\gamma ‚â§ 1) that determines the importance of future rewards,\n        *   st+1st+1s\\_{t+1} is the next state after taking an action from state sss.\n*   This equation expresses that the value of a state sss is the immediate reward rtrtr\\_t plus the discounted value of the next state VœÄ(st+1)VœÄ(st+1)V^{\\\\pi}(s\\_{t+1}). The Bellman equation is central to many RL algorithms, as it provides the basis for recursively solving the optimal value function.\n    \n\nThe Bellman Equation is a fundamental concept in RL, used to describe the relationship between the value of a state and the value of its successor states. It breaks down the value function into immediate rewards and the expected value of future states.\n\nFor a given policy œÄœÄ\\\\pi, the state-value function VœÄ(s)VœÄ(s)V^{\\\\pi}(s) can be written as:\n\n*   where:\n    *   VœÄ(s)VœÄ(s)V^{\\\\pi}(s) is the value of state sss under policy œÄœÄ\\\\pi,\n    *   rtrtr\\_t is the reward received after taking an action at time ttt,\n    *   Œ≥Œ≥\\\\gamma is the discount factor (0 ‚â§ Œ≥Œ≥\\\\gamma ‚â§ 1) that determines the importance of future rewards,\n    *   st+1st+1s\\_{t+1} is the next state after taking an action from state sss.\n\n*   VœÄ(s)VœÄ(s)V^{\\\\pi}(s) is the value of state sss under policy œÄœÄ\\\\pi,\n*   rtrtr\\_t is the reward received after taking an action at time ttt,\n*   Œ≥Œ≥\\\\gamma is the discount factor (0 ‚â§ Œ≥Œ≥\\\\gamma ‚â§ 1) that determines the importance of future rewards,\n*   st+1st+1s\\_{t+1} is the next state after taking an action from state sss.\n\nThis equation expresses that the value of a state sss is the immediate reward rtrtr\\_t plus the discounted value of the next state VœÄ(st+1)VœÄ(st+1)V^{\\\\pi}(s\\_{t+1}). The Bellman equation is central to many RL algorithms, as it provides the basis for recursively solving the optimal value function.",
    "order": 2,
    "orderInChapter": 2,
    "difficulty": 3,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "llm"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 388,
      "contentLength": 77175
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#the-bellman-equation",
    "scrapedAt": "2025-12-28T11:47:08.458Z"
  },
  {
    "id": "ai-reinforcement-learning-the-rl-process-trial-and-error-learning-3",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Basics of Reinforcement Learning",
    "title": "The RL Process: Trial and Error Learning",
    "subtitle": "Basics of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>The agent interacts with the environment in a loop:\n    <ol>\n      <li>At each time step, the agent observes the current state of the environment.</li>\n      <li>Based on this state, it selects an action according to its policy.</li>\n      <li>The environment transitions to a new state, and the agent receives a reward.</li>\n      <li>The agent uses this feedback to update its policy, gradually improving its decision-making over time.</li>\n    </ol>\n  </li>\n  <li>This process of learning from trial and error allows the agent to explore different actions and outcomes, eventually finding the optimal policy that maximizes the long-term reward.</li>\n</ul>\n<ol>\n      <li>At each time step, the agent observes the current state of the environment.</li>\n      <li>Based on this state, it selects an action according to its policy.</li>\n      <li>The environment transitions to a new state, and the agent receives a reward.</li>\n      <li>The agent uses this feedback to update its policy, gradually improving its decision-making over time.</li>\n    </ol>",
    "contentMarkdown": "*   The agent interacts with the environment in a loop:\n    1.  At each time step, the agent observes the current state of the environment.\n    2.  Based on this state, it selects an action according to its policy.\n    3.  The environment transitions to a new state, and the agent receives a reward.\n    4.  The agent uses this feedback to update its policy, gradually improving its decision-making over time.\n*   This process of learning from trial and error allows the agent to explore different actions and outcomes, eventually finding the optimal policy that maximizes the long-term reward.\n\n1.  At each time step, the agent observes the current state of the environment.\n2.  Based on this state, it selects an action according to its policy.\n3.  The environment transitions to a new state, and the agent receives a reward.\n4.  The agent uses this feedback to update its policy, gradually improving its decision-making over time.",
    "order": 3,
    "orderInChapter": 3,
    "difficulty": 2,
    "estimatedMinutes": 1,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 152,
      "contentLength": 1066
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#the-rl-process:-trial-and-error-learning",
    "scrapedAt": "2025-12-28T11:47:08.458Z"
  },
  {
    "id": "ai-reinforcement-learning-mathematical-formulation-markov-decision-process-m-4",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Basics of Reinforcement Learning",
    "title": "Mathematical Formulation: Markov Decision Process (MDP)",
    "subtitle": "Basics of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>RL problems are typically framed as <strong>Markov Decision Processes (MDP)</strong>, which provide a mathematical framework for modeling decision-making where outcomes are partly random and partly under the control of the agent. An MDP is defined by:\n    <ul>\n      <li><strong>States (S)</strong>: The set of all possible states in the environment.</li>\n      <li><strong>Actions (A)</strong>: The set of all possible actions the agent can take.</li>\n      <li><strong>Transition function (P)</strong>: The probability distribution of moving from one state to another, given an action.</li>\n      <li><strong>Reward function (R)</strong>: The immediate reward received after transitioning from one state to another.</li>\n      <li><strong>Discount factor (Œ≥)</strong>: A factor between 0 and 1 that determines the importance of future rewards. A discount factor close to 0 prioritizes immediate rewards, while a value close to 1 encourages the agent to consider long-term rewards.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The agent‚Äôs goal is to learn a policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-64-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-509\" style=\"width: 2.034em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.669em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.62em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-510\"><span class=\"mi\" id=\"MathJax-Span-511\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-512\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-513\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-514\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-64\">\\pi(s)</script> that maximizes the <strong>expected cumulative reward</strong> or <strong>return</strong>, often expressed as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-65-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mi>k</mi></msup><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-515\" style=\"width: 8.336em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.93em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.419em, 1006.93em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-516\"><span class=\"msubsup\" id=\"MathJax-Span-517\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-518\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-519\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-520\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-521\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-522\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.15em, 4.273em, -999.997em); top: -2.862em; left: 0.055em;\"><span class=\"texatom\" id=\"MathJax-Span-523\"><span class=\"mrow\" id=\"MathJax-Span-524\"><span class=\"mi\" id=\"MathJax-Span-525\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-526\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-527\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -5.206em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-528\"><span class=\"mrow\" id=\"MathJax-Span-529\"><span class=\"mi\" id=\"MathJax-Span-530\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àû</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-531\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-532\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-533\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-534\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-535\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-536\"><span class=\"mrow\" id=\"MathJax-Span-537\"><span class=\"mi\" id=\"MathJax-Span-538\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-539\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-540\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-541\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-542\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">‚àû</mi></mrow></munderover><msup><mi>Œ≥</mi><mi>k</mi></msup><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-65\">G_t = \\sum_{k=0}^{\\infty} \\gamma^k r_{t+k+1}</script>\n\n    <ul>\n      <li>where:\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-66-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-543\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.99em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-544\"><span class=\"msubsup\" id=\"MathJax-Span-545\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-546\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-547\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>G</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-66\">G_t</script> is the total return starting from time step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-67-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-548\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-549\"><span class=\"mi\" id=\"MathJax-Span-550\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-67\">t</script>,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-68-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-551\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-552\"><span class=\"mi\" id=\"MathJax-Span-553\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-68\">\\gamma</script> is the discount factor,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-69-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-554\" style=\"width: 2.815em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1002.35em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-555\"><span class=\"msubsup\" id=\"MathJax-Span-556\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-557\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-558\"><span class=\"mrow\" id=\"MathJax-Span-559\"><span class=\"mi\" id=\"MathJax-Span-560\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-561\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-562\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-563\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-564\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-69\">r_{t+k+1}</script> is the reward received at time <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-70-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi><mo>+</mo><mi>k</mi><mo>+</mo><mn>1</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-565\" style=\"width: 4.221em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.492em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.39em, 2.398em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-566\"><span class=\"mi\" id=\"MathJax-Span-567\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-568\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-569\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-570\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mn\" id=\"MathJax-Span-571\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi><mo>+</mo><mi>k</mi><mo>+</mo><mn>1</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-70\">t+k+1</script>.</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n</ul>\n<ul>\n      <li><strong>States (S)</strong>: The set of all possible states in the environment.</li>\n      <li><strong>Actions (A)</strong>: The set of all possible actions the agent can take.</li>\n      <li><strong>Transition function (P)</strong>: The probability distribution of moving from one state to another, given an action.</li>\n      <li><strong>Reward function (R)</strong>: The immediate reward received after transitioning from one state to another.</li>\n      <li><strong>Discount factor (Œ≥)</strong>: A factor between 0 and 1 that determines the importance of future rewards. A discount factor close to 0 prioritizes immediate rewards, while a value close to 1 encourages the agent to consider long-term rewards.</li>\n    </ul>\n<p>The agent‚Äôs goal is to learn a policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-64-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-509\" style=\"width: 2.034em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.669em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.62em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-510\"><span class=\"mi\" id=\"MathJax-Span-511\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-512\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-513\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-514\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-64\">\\pi(s)</script> that maximizes the <strong>expected cumulative reward</strong> or <strong>return</strong>, often expressed as:</p>\n<ul>\n      <li>where:\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-66-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-543\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.99em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-544\"><span class=\"msubsup\" id=\"MathJax-Span-545\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-546\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-547\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>G</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-66\">G_t</script> is the total return starting from time step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-67-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-548\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-549\"><span class=\"mi\" id=\"MathJax-Span-550\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-67\">t</script>,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-68-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-551\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-552\"><span class=\"mi\" id=\"MathJax-Span-553\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-68\">\\gamma</script> is the discount factor,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-69-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-554\" style=\"width: 2.815em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1002.35em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-555\"><span class=\"msubsup\" id=\"MathJax-Span-556\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-557\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-558\"><span class=\"mrow\" id=\"MathJax-Span-559\"><span class=\"mi\" id=\"MathJax-Span-560\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-561\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-562\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-563\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-564\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-69\">r_{t+k+1}</script> is the reward received at time <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-70-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi><mo>+</mo><mi>k</mi><mo>+</mo><mn>1</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-565\" style=\"width: 4.221em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.492em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.39em, 2.398em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-566\"><span class=\"mi\" id=\"MathJax-Span-567\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-568\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-569\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-570\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mn\" id=\"MathJax-Span-571\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi><mo>+</mo><mi>k</mi><mo>+</mo><mn>1</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-70\">t+k+1</script>.</li>\n        </ul>\n      </li>\n    </ul>\n<ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-66-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-543\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.99em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-544\"><span class=\"msubsup\" id=\"MathJax-Span-545\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-546\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-547\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>G</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-66\">G_t</script> is the total return starting from time step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-67-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-548\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-549\"><span class=\"mi\" id=\"MathJax-Span-550\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-67\">t</script>,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-68-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-551\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-552\"><span class=\"mi\" id=\"MathJax-Span-553\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-68\">\\gamma</script> is the discount factor,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-69-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-554\" style=\"width: 2.815em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1002.35em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-555\"><span class=\"msubsup\" id=\"MathJax-Span-556\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-557\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-558\"><span class=\"mrow\" id=\"MathJax-Span-559\"><span class=\"mi\" id=\"MathJax-Span-560\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-561\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-562\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-563\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-564\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-69\">r_{t+k+1}</script> is the reward received at time <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-70-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi><mo>+</mo><mi>k</mi><mo>+</mo><mn>1</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-565\" style=\"width: 4.221em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.492em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.39em, 2.398em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-566\"><span class=\"mi\" id=\"MathJax-Span-567\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-568\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-569\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-570\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mn\" id=\"MathJax-Span-571\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi><mo>+</mo><mi>k</mi><mo>+</mo><mn>1</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-70\">t+k+1</script>.</li>\n        </ul>",
    "contentMarkdown": "*   RL problems are typically framed as **Markov Decision Processes (MDP)**, which provide a mathematical framework for modeling decision-making where outcomes are partly random and partly under the control of the agent. An MDP is defined by:\n    *   **States (S)**: The set of all possible states in the environment.\n    *   **Actions (A)**: The set of all possible actions the agent can take.\n    *   **Transition function (P)**: The probability distribution of moving from one state to another, given an action.\n    *   **Reward function (R)**: The immediate reward received after transitioning from one state to another.\n    *   **Discount factor (Œ≥)**: A factor between 0 and 1 that determines the importance of future rewards. A discount factor close to 0 prioritizes immediate rewards, while a value close to 1 encourages the agent to consider long-term rewards.\n*   The agent‚Äôs goal is to learn a policy œÄ(s)œÄ(s)\\\\pi(s) that maximizes the **expected cumulative reward** or **return**, often expressed as:\n    \n    Gt\\=‚àëk\\=0‚àûŒ≥krt+k+1Gt\\=‚àëk\\=0‚àûŒ≥krt+k+1\n    \n    G\\_t = \\\\sum\\_{k=0}^{\\\\infty} \\\\gamma^k r\\_{t+k+1}\n    *   where:\n        *   GtGtG\\_t is the total return starting from time step ttt,\n        *   Œ≥Œ≥\\\\gamma is the discount factor,\n        *   rt+k+1rt+k+1r\\_{t+k+1} is the reward received at time t+k+1t+k+1t+k+1.\n\n*   **States (S)**: The set of all possible states in the environment.\n*   **Actions (A)**: The set of all possible actions the agent can take.\n*   **Transition function (P)**: The probability distribution of moving from one state to another, given an action.\n*   **Reward function (R)**: The immediate reward received after transitioning from one state to another.\n*   **Discount factor (Œ≥)**: A factor between 0 and 1 that determines the importance of future rewards. A discount factor close to 0 prioritizes immediate rewards, while a value close to 1 encourages the agent to consider long-term rewards.\n\nThe agent‚Äôs goal is to learn a policy œÄ(s)œÄ(s)\\\\pi(s) that maximizes the **expected cumulative reward** or **return**, often expressed as:\n\n*   where:\n    *   GtGtG\\_t is the total return starting from time step ttt,\n    *   Œ≥Œ≥\\\\gamma is the discount factor,\n    *   rt+k+1rt+k+1r\\_{t+k+1} is the reward received at time t+k+1t+k+1t+k+1.\n\n*   GtGtG\\_t is the total return starting from time step ttt,\n*   Œ≥Œ≥\\\\gamma is the discount factor,\n*   rt+k+1rt+k+1r\\_{t+k+1} is the reward received at time t+k+1t+k+1t+k+1.",
    "order": 4,
    "orderInChapter": 4,
    "difficulty": 3,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 358,
      "contentLength": 40452
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#mathematical-formulation:-markov-decision-process-(mdp)",
    "scrapedAt": "2025-12-28T11:47:08.458Z"
  },
  {
    "id": "ai-reinforcement-learning-offline-reinforcement-learning-5",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Offline and Online Reinforcement Learning",
    "title": "Offline Reinforcement Learning",
    "subtitle": "Offline and Online Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>Definition</strong>: Offline RL, also known as batch RL, refers to a reinforcement learning paradigm where the agent learns solely from a pre-collected dataset of experiences without any interaction with the environment during training.</p>\n  </li>\n  <li><strong>Key Characteristics</strong>:\n    <ul>\n      <li><strong>Static Dataset</strong>: The dataset typically consists of tuples (state, action, reward, next state) that are collected by a specific policy, which could be suboptimal or from a combination of multiple policies.</li>\n      <li><strong>No Real-Time Interaction</strong>: Unlike online RL, the agent does not have the ability to gather new data or explore unknown parts of the state space.</li>\n      <li><strong>Policy Evaluation and Improvement</strong>: The primary goal is to learn a policy that generalizes well to the environment when deployed, leveraging the provided static data.</li>\n    </ul>\n  </li>\n  <li><strong>Advantages</strong>:\n    <ul>\n      <li><strong>Safety and Cost-Effectiveness</strong>: Offline RL eliminates the risks and costs associated with real-world interactions, making it particularly valuable in -itical applications like healthcare or autonomous vehicles.</li>\n      <li><strong>Utilization of Historical Data</strong>: It allows researchers to leverage existing datasets, such as logs from previously deployed systems, for policy improvement without further data collection efforts.</li>\n    </ul>\n  </li>\n  <li><strong>Challenges</strong>:\n    <ul>\n      <li><strong>Distributional Shift</strong>: The learned policy may take actions that lead to parts of the state space not covered in the dataset, resulting in poor performance (extrapolation error).</li>\n      <li><strong>Dependence on Dataset Quality</strong>: The effectiveness of the learning process is highly sensitive to the diversity and representativeness of the dataset.</li>\n      <li><strong>Overfitting</strong>: The agent might overfit to the static dataset, leading to poor generalization in unseen scenarios.</li>\n    </ul>\n  </li>\n  <li><strong>Techniques to Address Challenges</strong>:\n    <ul>\n      <li><strong>Conservative Algorithms</strong>: Methods like Conservative Q-Learning (CQL) restrict the agent from overestimating out-of-distribution actions.</li>\n      <li><strong>Uncertainty Estimation</strong>: Leveraging uncertainty-aware models to avoid relying on poorly represented regions of the dataset.</li>\n      <li><strong>Offline-Optimized Models</strong>: Algorithms such as Batch Constrained Q-Learning (BCQ) and Behavior Regularized Actor-Critic (BRAC) are designed specifically for offline settings.</li>\n    </ul>\n  </li>\n  <li><strong>Use Cases</strong>:\n    <ul>\n      <li><strong>Healthcare</strong>: Training models on patient treatment records to recommend actions without real-time experimentation.</li>\n      <li><strong>Autonomous Driving</strong>: Leveraging driving logs to improve decision-making policies without the risks of on-road testing.</li>\n      <li><strong>Robotics</strong>: Using pre-recorded demonstration data to teach robots tasks without additional data collection.</li>\n    </ul>\n  </li>\n</ul>\n<p><strong>Definition</strong>: Offline RL, also known as batch RL, refers to a reinforcement learning paradigm where the agent learns solely from a pre-collected dataset of experiences without any interaction with the environment during training.</p>\n<ul>\n      <li><strong>Static Dataset</strong>: The dataset typically consists of tuples (state, action, reward, next state) that are collected by a specific policy, which could be suboptimal or from a combination of multiple policies.</li>\n      <li><strong>No Real-Time Interaction</strong>: Unlike online RL, the agent does not have the ability to gather new data or explore unknown parts of the state space.</li>\n      <li><strong>Policy Evaluation and Improvement</strong>: The primary goal is to learn a policy that generalizes well to the environment when deployed, leveraging the provided static data.</li>\n    </ul>\n<ul>\n      <li><strong>Safety and Cost-Effectiveness</strong>: Offline RL eliminates the risks and costs associated with real-world interactions, making it particularly valuable in -itical applications like healthcare or autonomous vehicles.</li>\n      <li><strong>Utilization of Historical Data</strong>: It allows researchers to leverage existing datasets, such as logs from previously deployed systems, for policy improvement without further data collection efforts.</li>\n    </ul>\n<ul>\n      <li><strong>Distributional Shift</strong>: The learned policy may take actions that lead to parts of the state space not covered in the dataset, resulting in poor performance (extrapolation error).</li>\n      <li><strong>Dependence on Dataset Quality</strong>: The effectiveness of the learning process is highly sensitive to the diversity and representativeness of the dataset.</li>\n      <li><strong>Overfitting</strong>: The agent might overfit to the static dataset, leading to poor generalization in unseen scenarios.</li>\n    </ul>\n<ul>\n      <li><strong>Conservative Algorithms</strong>: Methods like Conservative Q-Learning (CQL) restrict the agent from overestimating out-of-distribution actions.</li>\n      <li><strong>Uncertainty Estimation</strong>: Leveraging uncertainty-aware models to avoid relying on poorly represented regions of the dataset.</li>\n      <li><strong>Offline-Optimized Models</strong>: Algorithms such as Batch Constrained Q-Learning (BCQ) and Behavior Regularized Actor-Critic (BRAC) are designed specifically for offline settings.</li>\n    </ul>\n<ul>\n      <li><strong>Healthcare</strong>: Training models on patient treatment records to recommend actions without real-time experimentation.</li>\n      <li><strong>Autonomous Driving</strong>: Leveraging driving logs to improve decision-making policies without the risks of on-road testing.</li>\n      <li><strong>Robotics</strong>: Using pre-recorded demonstration data to teach robots tasks without additional data collection.</li>\n    </ul>",
    "contentMarkdown": "*   **Definition**: Offline RL, also known as batch RL, refers to a reinforcement learning paradigm where the agent learns solely from a pre-collected dataset of experiences without any interaction with the environment during training.\n    \n*   **Key Characteristics**:\n    *   **Static Dataset**: The dataset typically consists of tuples (state, action, reward, next state) that are collected by a specific policy, which could be suboptimal or from a combination of multiple policies.\n    *   **No Real-Time Interaction**: Unlike online RL, the agent does not have the ability to gather new data or explore unknown parts of the state space.\n    *   **Policy Evaluation and Improvement**: The primary goal is to learn a policy that generalizes well to the environment when deployed, leveraging the provided static data.\n*   **Advantages**:\n    *   **Safety and Cost-Effectiveness**: Offline RL eliminates the risks and costs associated with real-world interactions, making it particularly valuable in -itical applications like healthcare or autonomous vehicles.\n    *   **Utilization of Historical Data**: It allows researchers to leverage existing datasets, such as logs from previously deployed systems, for policy improvement without further data collection efforts.\n*   **Challenges**:\n    *   **Distributional Shift**: The learned policy may take actions that lead to parts of the state space not covered in the dataset, resulting in poor performance (extrapolation error).\n    *   **Dependence on Dataset Quality**: The effectiveness of the learning process is highly sensitive to the diversity and representativeness of the dataset.\n    *   **Overfitting**: The agent might overfit to the static dataset, leading to poor generalization in unseen scenarios.\n*   **Techniques to Address Challenges**:\n    *   **Conservative Algorithms**: Methods like Conservative Q-Learning (CQL) restrict the agent from overestimating out-of-distribution actions.\n    *   **Uncertainty Estimation**: Leveraging uncertainty-aware models to avoid relying on poorly represented regions of the dataset.\n    *   **Offline-Optimized Models**: Algorithms such as Batch Constrained Q-Learning (BCQ) and Behavior Regularized Actor-Critic (BRAC) are designed specifically for offline settings.\n*   **Use Cases**:\n    *   **Healthcare**: Training models on patient treatment records to recommend actions without real-time experimentation.\n    *   **Autonomous Driving**: Leveraging driving logs to improve decision-making policies without the risks of on-road testing.\n    *   **Robotics**: Using pre-recorded demonstration data to teach robots tasks without additional data collection.\n\n**Definition**: Offline RL, also known as batch RL, refers to a reinforcement learning paradigm where the agent learns solely from a pre-collected dataset of experiences without any interaction with the environment during training.\n\n*   **Static Dataset**: The dataset typically consists of tuples (state, action, reward, next state) that are collected by a specific policy, which could be suboptimal or from a combination of multiple policies.\n*   **No Real-Time Interaction**: Unlike online RL, the agent does not have the ability to gather new data or explore unknown parts of the state space.\n*   **Policy Evaluation and Improvement**: The primary goal is to learn a policy that generalizes well to the environment when deployed, leveraging the provided static data.\n\n*   **Safety and Cost-Effectiveness**: Offline RL eliminates the risks and costs associated with real-world interactions, making it particularly valuable in -itical applications like healthcare or autonomous vehicles.\n*   **Utilization of Historical Data**: It allows researchers to leverage existing datasets, such as logs from previously deployed systems, for policy improvement without further data collection efforts.\n\n*   **Distributional Shift**: The learned policy may take actions that lead to parts of the state space not covered in the dataset, resulting in poor performance (extrapolation error).\n*   **Dependence on Dataset Quality**: The effectiveness of the learning process is highly sensitive to the diversity and representativeness of the dataset.\n*   **Overfitting**: The agent might overfit to the static dataset, leading to poor generalization in unseen scenarios.\n\n*   **Conservative Algorithms**: Methods like Conservative Q-Learning (CQL) restrict the agent from overestimating out-of-distribution actions.\n*   **Uncertainty Estimation**: Leveraging uncertainty-aware models to avoid relying on poorly represented regions of the dataset.\n*   **Offline-Optimized Models**: Algorithms such as Batch Constrained Q-Learning (BCQ) and Behavior Regularized Actor-Critic (BRAC) are designed specifically for offline settings.\n\n*   **Healthcare**: Training models on patient treatment records to recommend actions without real-time experimentation.\n*   **Autonomous Driving**: Leveraging driving logs to improve decision-making policies without the risks of on-road testing.\n*   **Robotics**: Using pre-recorded demonstration data to teach robots tasks without additional data collection.",
    "order": 5,
    "orderInChapter": 1,
    "difficulty": 2,
    "estimatedMinutes": 4,
    "tags": [
      "algorithmsarchitecture",
      "reinforcement learning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 684,
      "contentLength": 6098
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#offline-reinforcement-learning",
    "scrapedAt": "2025-12-28T11:47:08.459Z"
  },
  {
    "id": "ai-reinforcement-learning-online-reinforcement-learning-6",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Offline and Online Reinforcement Learning",
    "title": "Online Reinforcement Learning",
    "subtitle": "Offline and Online Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>Definition</strong>: Online RL involves continuous interaction between the agent and the environment during training. The agent collects data through trial and error, allowing it to refine its policy iteratively in real time.</p>\n  </li>\n  <li><strong>Key Characteristics</strong>:\n    <ul>\n      <li><strong>Active Data Collection</strong>: The agent explores the environment to gather new experiences, enabling adaptation to dynamic or previously unseen states.</li>\n      <li><strong>Feedback Loop</strong>: There is a direct link between the agent‚Äôs actions, the environment‚Äôs responses, and policy improvement.</li>\n      <li><strong>Exploration-Exploitation Tradeoff</strong>: Balancing the exploration of new actions and the exploitation of learned strategies is a critical aspect of online RL.</li>\n    </ul>\n  </li>\n  <li><strong>Advantages</strong>:\n    <ul>\n      <li><strong>Dynamic Adaptation</strong>: The agent can dynamically adapt to changes in the environment, ensuring robust performance.</li>\n      <li><strong>Optimal Exploration</strong>: By actively engaging with the environment, the agent can learn optimal strategies even in highly complex state spaces.</li>\n    </ul>\n  </li>\n  <li><strong>Challenges</strong>:\n    <ul>\n      <li><strong>Exploration Risks</strong>: Excessive exploration can lead to suboptimal or dangerous actions, particularly in high-stakes applications.</li>\n      <li><strong>Resource-Intensive</strong>: Online RL requires significant computational and environmental resources due to real-time interaction.</li>\n      <li><strong>Stability and Convergence</strong>: Ensuring stable learning and avoiding divergence are ongoing research challenges.</li>\n    </ul>\n  </li>\n  <li><strong>Techniques to Address Challenges</strong>:\n    <ul>\n      <li><strong>Exploration Strategies</strong>: Methods like epsilon-greedy, softmax exploration, or intrinsic motivation frameworks guide effective exploration.</li>\n      <li><strong>Stability Enhancements</strong>: Algorithms like Proximal Policy Optimization (PPO) and Trust Region Policy Optimization (TRPO) improve convergence stability.</li>\n      <li><strong>Efficient Learning</strong>: Techniques like prioritized experience replay and model-based RL improve data efficiency.</li>\n    </ul>\n  </li>\n  <li><strong>Use Cases</strong>:\n    <ul>\n      <li><strong>Robotics</strong>: Training robots in simulated environments with the ability to transfer learned policies to the real world.</li>\n      <li><strong>Games</strong>: Developing agents that play video games, such as AlphaGo or OpenAI Five, through millions of simulated interactions.</li>\n      <li><strong>Dynamic Systems</strong>: Adapting to real-world systems with changing conditions, such as stock trading or energy management.</li>\n    </ul>\n  </li>\n</ul>\n<p><strong>Definition</strong>: Online RL involves continuous interaction between the agent and the environment during training. The agent collects data through trial and error, allowing it to refine its policy iteratively in real time.</p>\n<ul>\n      <li><strong>Active Data Collection</strong>: The agent explores the environment to gather new experiences, enabling adaptation to dynamic or previously unseen states.</li>\n      <li><strong>Feedback Loop</strong>: There is a direct link between the agent‚Äôs actions, the environment‚Äôs responses, and policy improvement.</li>\n      <li><strong>Exploration-Exploitation Tradeoff</strong>: Balancing the exploration of new actions and the exploitation of learned strategies is a critical aspect of online RL.</li>\n    </ul>\n<ul>\n      <li><strong>Dynamic Adaptation</strong>: The agent can dynamically adapt to changes in the environment, ensuring robust performance.</li>\n      <li><strong>Optimal Exploration</strong>: By actively engaging with the environment, the agent can learn optimal strategies even in highly complex state spaces.</li>\n    </ul>\n<ul>\n      <li><strong>Exploration Risks</strong>: Excessive exploration can lead to suboptimal or dangerous actions, particularly in high-stakes applications.</li>\n      <li><strong>Resource-Intensive</strong>: Online RL requires significant computational and environmental resources due to real-time interaction.</li>\n      <li><strong>Stability and Convergence</strong>: Ensuring stable learning and avoiding divergence are ongoing research challenges.</li>\n    </ul>\n<ul>\n      <li><strong>Exploration Strategies</strong>: Methods like epsilon-greedy, softmax exploration, or intrinsic motivation frameworks guide effective exploration.</li>\n      <li><strong>Stability Enhancements</strong>: Algorithms like Proximal Policy Optimization (PPO) and Trust Region Policy Optimization (TRPO) improve convergence stability.</li>\n      <li><strong>Efficient Learning</strong>: Techniques like prioritized experience replay and model-based RL improve data efficiency.</li>\n    </ul>\n<ul>\n      <li><strong>Robotics</strong>: Training robots in simulated environments with the ability to transfer learned policies to the real world.</li>\n      <li><strong>Games</strong>: Developing agents that play video games, such as AlphaGo or OpenAI Five, through millions of simulated interactions.</li>\n      <li><strong>Dynamic Systems</strong>: Adapting to real-world systems with changing conditions, such as stock trading or energy management.</li>\n    </ul>",
    "contentMarkdown": "*   **Definition**: Online RL involves continuous interaction between the agent and the environment during training. The agent collects data through trial and error, allowing it to refine its policy iteratively in real time.\n    \n*   **Key Characteristics**:\n    *   **Active Data Collection**: The agent explores the environment to gather new experiences, enabling adaptation to dynamic or previously unseen states.\n    *   **Feedback Loop**: There is a direct link between the agent‚Äôs actions, the environment‚Äôs responses, and policy improvement.\n    *   **Exploration-Exploitation Tradeoff**: Balancing the exploration of new actions and the exploitation of learned strategies is a critical aspect of online RL.\n*   **Advantages**:\n    *   **Dynamic Adaptation**: The agent can dynamically adapt to changes in the environment, ensuring robust performance.\n    *   **Optimal Exploration**: By actively engaging with the environment, the agent can learn optimal strategies even in highly complex state spaces.\n*   **Challenges**:\n    *   **Exploration Risks**: Excessive exploration can lead to suboptimal or dangerous actions, particularly in high-stakes applications.\n    *   **Resource-Intensive**: Online RL requires significant computational and environmental resources due to real-time interaction.\n    *   **Stability and Convergence**: Ensuring stable learning and avoiding divergence are ongoing research challenges.\n*   **Techniques to Address Challenges**:\n    *   **Exploration Strategies**: Methods like epsilon-greedy, softmax exploration, or intrinsic motivation frameworks guide effective exploration.\n    *   **Stability Enhancements**: Algorithms like Proximal Policy Optimization (PPO) and Trust Region Policy Optimization (TRPO) improve convergence stability.\n    *   **Efficient Learning**: Techniques like prioritized experience replay and model-based RL improve data efficiency.\n*   **Use Cases**:\n    *   **Robotics**: Training robots in simulated environments with the ability to transfer learned policies to the real world.\n    *   **Games**: Developing agents that play video games, such as AlphaGo or OpenAI Five, through millions of simulated interactions.\n    *   **Dynamic Systems**: Adapting to real-world systems with changing conditions, such as stock trading or energy management.\n\n**Definition**: Online RL involves continuous interaction between the agent and the environment during training. The agent collects data through trial and error, allowing it to refine its policy iteratively in real time.\n\n*   **Active Data Collection**: The agent explores the environment to gather new experiences, enabling adaptation to dynamic or previously unseen states.\n*   **Feedback Loop**: There is a direct link between the agent‚Äôs actions, the environment‚Äôs responses, and policy improvement.\n*   **Exploration-Exploitation Tradeoff**: Balancing the exploration of new actions and the exploitation of learned strategies is a critical aspect of online RL.\n\n*   **Dynamic Adaptation**: The agent can dynamically adapt to changes in the environment, ensuring robust performance.\n*   **Optimal Exploration**: By actively engaging with the environment, the agent can learn optimal strategies even in highly complex state spaces.\n\n*   **Exploration Risks**: Excessive exploration can lead to suboptimal or dangerous actions, particularly in high-stakes applications.\n*   **Resource-Intensive**: Online RL requires significant computational and environmental resources due to real-time interaction.\n*   **Stability and Convergence**: Ensuring stable learning and avoiding divergence are ongoing research challenges.\n\n*   **Exploration Strategies**: Methods like epsilon-greedy, softmax exploration, or intrinsic motivation frameworks guide effective exploration.\n*   **Stability Enhancements**: Algorithms like Proximal Policy Optimization (PPO) and Trust Region Policy Optimization (TRPO) improve convergence stability.\n*   **Efficient Learning**: Techniques like prioritized experience replay and model-based RL improve data efficiency.\n\n*   **Robotics**: Training robots in simulated environments with the ability to transfer learned policies to the real world.\n*   **Games**: Developing agents that play video games, such as AlphaGo or OpenAI Five, through millions of simulated interactions.\n*   **Dynamic Systems**: Adapting to real-world systems with changing conditions, such as stock trading or energy management.",
    "order": 6,
    "orderInChapter": 2,
    "difficulty": 2,
    "estimatedMinutes": 3,
    "tags": [
      "algorithmsarchitecture",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 566,
      "contentLength": 5400
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#online-reinforcement-learning",
    "scrapedAt": "2025-12-28T11:47:08.459Z"
  },
  {
    "id": "ai-reinforcement-learning-comparison-table-7",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Offline and Online Reinforcement Learning",
    "title": "Comparison Table",
    "subtitle": "Offline and Online Reinforcement Learning",
    "contentHtml": "<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Aspect</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Offline RL</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Online RL</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">Data Source</td>\n<td class=\"tg-tleft-valign-first\">Fixed, pre-collected dataset</td>\n<td class=\"tg-tleft-valign-second\">Real-time interaction</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Exploration</td>\n<td class=\"tg-tleft-valign-first\">Not possible; constrained by dataset</td>\n<td class=\"tg-tleft-valign-second\">Required</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Learning</td>\n<td class=\"tg-tleft-valign-first\">Static learning from a fixed dataset</td>\n<td class=\"tg-tleft-valign-second\">Dynamic and iterative</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Environment Access</td>\n<td class=\"tg-tleft-valign-first\">No interaction during training</td>\n<td class=\"tg-tleft-valign-second\">Continuous interaction</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Main Challenges</td>\n<td class=\"tg-tleft-valign-first\">Distributional shift, dataset quality</td>\n<td class=\"tg-tleft-valign-second\">Exploration-exploitation balance, stability</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Efficiency</td>\n<td class=\"tg-tleft-valign-first\">Efficient with quality datasets</td>\n<td class=\"tg-tleft-valign-second\">Resource-intensive</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Use Cases</td>\n<td class=\"tg-tleft-valign-first\">Healthcare, autonomous driving, robotics</td>\n<td class=\"tg-tleft-valign-second\">Games, robotics, dynamic systems</td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Aspect</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Offline RL</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Online RL</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">Data Source</td>\n<td class=\"tg-tleft-valign-first\">Fixed, pre-collected dataset</td>\n<td class=\"tg-tleft-valign-second\">Real-time interaction</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Exploration</td>\n<td class=\"tg-tleft-valign-first\">Not possible; constrained by dataset</td>\n<td class=\"tg-tleft-valign-second\">Required</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Learning</td>\n<td class=\"tg-tleft-valign-first\">Static learning from a fixed dataset</td>\n<td class=\"tg-tleft-valign-second\">Dynamic and iterative</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Environment Access</td>\n<td class=\"tg-tleft-valign-first\">No interaction during training</td>\n<td class=\"tg-tleft-valign-second\">Continuous interaction</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Main Challenges</td>\n<td class=\"tg-tleft-valign-first\">Distributional shift, dataset quality</td>\n<td class=\"tg-tleft-valign-second\">Exploration-exploitation balance, stability</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Efficiency</td>\n<td class=\"tg-tleft-valign-first\">Efficient with quality datasets</td>\n<td class=\"tg-tleft-valign-second\">Resource-intensive</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Use Cases</td>\n<td class=\"tg-tleft-valign-first\">Healthcare, autonomous driving, robotics</td>\n<td class=\"tg-tleft-valign-second\">Games, robotics, dynamic systems</td>\n</tr>\n</tbody>\n</table>",
    "contentMarkdown": "**Aspect**\n\n**Offline RL**\n\n**Online RL**\n\nData Source\n\nFixed, pre-collected dataset\n\nReal-time interaction\n\nExploration\n\nNot possible; constrained by dataset\n\nRequired\n\nLearning\n\nStatic learning from a fixed dataset\n\nDynamic and iterative\n\nEnvironment Access\n\nNo interaction during training\n\nContinuous interaction\n\nMain Challenges\n\nDistributional shift, dataset quality\n\nExploration-exploitation balance, stability\n\nEfficiency\n\nEfficient with quality datasets\n\nResource-intensive\n\nUse Cases\n\nHealthcare, autonomous driving, robotics\n\nGames, robotics, dynamic systems\n\n**Aspect**\n\n**Offline RL**\n\n**Online RL**\n\nData Source\n\nFixed, pre-collected dataset\n\nReal-time interaction\n\nExploration\n\nNot possible; constrained by dataset\n\nRequired\n\nLearning\n\nStatic learning from a fixed dataset\n\nDynamic and iterative\n\nEnvironment Access\n\nNo interaction during training\n\nContinuous interaction\n\nMain Challenges\n\nDistributional shift, dataset quality\n\nExploration-exploitation balance, stability\n\nEfficiency\n\nEfficient with quality datasets\n\nResource-intensive\n\nUse Cases\n\nHealthcare, autonomous driving, robotics\n\nGames, robotics, dynamic systems",
    "order": 7,
    "orderInChapter": 3,
    "difficulty": 2,
    "estimatedMinutes": 1,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 124,
      "contentLength": 3397
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#comparison-table",
    "scrapedAt": "2025-12-28T11:47:08.459Z"
  },
  {
    "id": "ai-reinforcement-learning-hybrid-approaches-8",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Offline and Online Reinforcement Learning",
    "title": "Hybrid Approaches",
    "subtitle": "Offline and Online Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>Hybrid RL approaches combine the strengths of both paradigms. A typical strategy involves:\n    <ol>\n      <li><strong>Offline Pretraining</strong>: Using offline RL to initialize the agent‚Äôs policy with a high-quality dataset.</li>\n      <li><strong>Online Fine-Tuning</strong>: Allowing the agent to interact with the environment to refine its policy and improve performance further.</li>\n    </ol>\n  </li>\n  <li><strong>Advantages</strong>:\n    <ul>\n      <li>Combines safety and efficiency of offline training with the adaptability of online learning.</li>\n      <li>Accelerates convergence by leveraging prior knowledge from pretraining.</li>\n    </ul>\n  </li>\n  <li><strong>Examples</strong>:\n    <ul>\n      <li><strong>Autonomous Driving</strong>: Pretraining on driving logs followed by fine-tuning in simulation or controlled environments.</li>\n      <li><strong>Healthcare</strong>: Learning from historical patient data and adapting through real-time interactions in clinical trials.</li>\n    </ul>\n  </li>\n</ul>\n<ol>\n      <li><strong>Offline Pretraining</strong>: Using offline RL to initialize the agent‚Äôs policy with a high-quality dataset.</li>\n      <li><strong>Online Fine-Tuning</strong>: Allowing the agent to interact with the environment to refine its policy and improve performance further.</li>\n    </ol>\n<ul>\n      <li>Combines safety and efficiency of offline training with the adaptability of online learning.</li>\n      <li>Accelerates convergence by leveraging prior knowledge from pretraining.</li>\n    </ul>\n<ul>\n      <li><strong>Autonomous Driving</strong>: Pretraining on driving logs followed by fine-tuning in simulation or controlled environments.</li>\n      <li><strong>Healthcare</strong>: Learning from historical patient data and adapting through real-time interactions in clinical trials.</li>\n    </ul>",
    "contentMarkdown": "*   Hybrid RL approaches combine the strengths of both paradigms. A typical strategy involves:\n    1.  **Offline Pretraining**: Using offline RL to initialize the agent‚Äôs policy with a high-quality dataset.\n    2.  **Online Fine-Tuning**: Allowing the agent to interact with the environment to refine its policy and improve performance further.\n*   **Advantages**:\n    *   Combines safety and efficiency of offline training with the adaptability of online learning.\n    *   Accelerates convergence by leveraging prior knowledge from pretraining.\n*   **Examples**:\n    *   **Autonomous Driving**: Pretraining on driving logs followed by fine-tuning in simulation or controlled environments.\n    *   **Healthcare**: Learning from historical patient data and adapting through real-time interactions in clinical trials.\n\n1.  **Offline Pretraining**: Using offline RL to initialize the agent‚Äôs policy with a high-quality dataset.\n2.  **Online Fine-Tuning**: Allowing the agent to interact with the environment to refine its policy and improve performance further.\n\n*   Combines safety and efficiency of offline training with the adaptability of online learning.\n*   Accelerates convergence by leveraging prior knowledge from pretraining.\n\n*   **Autonomous Driving**: Pretraining on driving logs followed by fine-tuning in simulation or controlled environments.\n*   **Healthcare**: Learning from historical patient data and adapting through real-time interactions in clinical trials.",
    "order": 8,
    "orderInChapter": 4,
    "difficulty": 2,
    "estimatedMinutes": 1,
    "tags": [
      "algorithmsarchitecture",
      "fine-tuning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 192,
      "contentLength": 1855
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#hybrid-approaches",
    "scrapedAt": "2025-12-28T11:47:08.459Z"
  },
  {
    "id": "ai-reinforcement-learning-value-based-methods-9",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Types of Reinforcement Learning",
    "title": "Value-Based Methods",
    "subtitle": "Types of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>Value-based methods form the cornerstone of reinforcement learning. Their core principle is to learn <strong>value functions</strong> that estimate how good it is for an agent to be in a given state or to perform a specific action in that state.</li>\n  <li>These methods do not learn policies directly; instead, they infer the optimal policy from the learned values by choosing actions that maximize expected future rewards.</li>\n</ul>\n<h4 id=\"foundations-of-value-functions\">Foundations of Value Functions</h4>\n<ul>\n  <li>Two central value functions define this class of methods:</li>\n</ul>\n<ol>\n  <li>\n    <p><strong>State-Value Function:</strong></p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-80-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>S</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-672\" style=\"width: 14.951em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.451em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1012.14em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-673\"><span class=\"msubsup\" id=\"MathJax-Span-674\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-675\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-676\"><span class=\"mrow\" id=\"MathJax-Span-677\"><span class=\"mi\" id=\"MathJax-Span-678\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-679\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-680\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-681\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-682\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-683\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-684\"><span class=\"mrow\" id=\"MathJax-Span-685\"><span class=\"mi\" id=\"MathJax-Span-686\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-687\"><span class=\"mrow\" id=\"MathJax-Span-688\"><span class=\"mi\" id=\"MathJax-Span-689\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-690\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-691\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-692\"><span class=\"munderover\" id=\"MathJax-Span-693\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-694\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-695\"><span class=\"mrow\" id=\"MathJax-Span-696\"><span class=\"mi\" id=\"MathJax-Span-697\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-698\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-699\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -5.206em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-700\"><span class=\"mrow\" id=\"MathJax-Span-701\"><span class=\"mi\" id=\"MathJax-Span-702\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àû</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-703\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-704\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-705\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-706\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-707\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-708\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-709\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-710\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-711\" style=\"font-family: STIXGeneral-Italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-712\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-713\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-714\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span></span><span class=\"mo\" id=\"MathJax-Span-715\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">‚àû</mi></mrow></munderover><msup><mi>Œ≥</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>S</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-80\">V^{\\pi}(s) = \\mathbb{E}_{\\pi} \\left[ \\sum_{t=0}^{\\infty} \\gamma^t r_t \\mid S_0 = s \\right]</script>\n\n    <ul>\n      <li>This represents the expected cumulative reward when starting from state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-81-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-716\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-717\"><span class=\"mi\" id=\"MathJax-Span-718\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-81\">s</script> and following policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-82-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-719\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-720\"><span class=\"mi\" id=\"MathJax-Span-721\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-82\">\\pi</script> thereafter.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Action-Value Function:</strong></p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-83-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>S</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi><mo>,</mo><msub><mi>A</mi><mn>0</mn></msub><mo>=</mo><mi>a</mi></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-722\" style=\"width: 19.846em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1016.2em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-723\"><span class=\"msubsup\" id=\"MathJax-Span-724\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-725\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-726\"><span class=\"mrow\" id=\"MathJax-Span-727\"><span class=\"mi\" id=\"MathJax-Span-728\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-729\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-730\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-731\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-732\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-733\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-734\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-735\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-736\"><span class=\"mrow\" id=\"MathJax-Span-737\"><span class=\"mi\" id=\"MathJax-Span-738\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-739\"><span class=\"mrow\" id=\"MathJax-Span-740\"><span class=\"mi\" id=\"MathJax-Span-741\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-742\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-743\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-744\"><span class=\"munderover\" id=\"MathJax-Span-745\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-746\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-747\"><span class=\"mrow\" id=\"MathJax-Span-748\"><span class=\"mi\" id=\"MathJax-Span-749\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-750\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-751\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -5.206em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-752\"><span class=\"mrow\" id=\"MathJax-Span-753\"><span class=\"mi\" id=\"MathJax-Span-754\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àû</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-755\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-756\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-757\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-758\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-759\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-760\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-761\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-762\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-763\" style=\"font-family: STIXGeneral-Italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-764\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-765\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-766\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-767\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-768\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-769\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mn\" id=\"MathJax-Span-770\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-771\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-772\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">a</span></span><span class=\"mo\" id=\"MathJax-Span-773\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">‚àû</mi></mrow></munderover><msup><mi>Œ≥</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>S</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi><mo>,</mo><msub><mi>A</mi><mn>0</mn></msub><mo>=</mo><mi>a</mi></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-83\">Q^{\\pi}(s,a) = \\mathbb{E}_{\\pi} \\left[ \\sum_{t=0}^{\\infty} \\gamma^t r_t \\mid S_0 = s, A_0 = a \\right]</script>\n\n    <ul>\n      <li>This quantifies the expected return when taking action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-84-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-774\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-775\"><span class=\"mi\" id=\"MathJax-Span-776\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-84\">a</script> in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-85-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-777\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-778\"><span class=\"mi\" id=\"MathJax-Span-779\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-85\">s</script> and then following policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-86-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-780\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-781\"><span class=\"mi\" id=\"MathJax-Span-782\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-86\">\\pi</script>.</li>\n    </ul>\n  </li>\n</ol>\n<p><strong>State-Value Function:</strong></p>\n<ul>\n      <li>This represents the expected cumulative reward when starting from state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-81-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-716\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-717\"><span class=\"mi\" id=\"MathJax-Span-718\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-81\">s</script> and following policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-82-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-719\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-720\"><span class=\"mi\" id=\"MathJax-Span-721\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-82\">\\pi</script> thereafter.</li>\n    </ul>\n<p><strong>Action-Value Function:</strong></p>\n<ul>\n      <li>This quantifies the expected return when taking action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-84-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-774\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-775\"><span class=\"mi\" id=\"MathJax-Span-776\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-84\">a</script> in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-85-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-777\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-778\"><span class=\"mi\" id=\"MathJax-Span-779\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-85\">s</script> and then following policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-86-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-780\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-781\"><span class=\"mi\" id=\"MathJax-Span-782\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-86\">\\pi</script>.</li>\n    </ul>\n<ul>\n  <li>\n    <p>The optimal policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-87-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>&amp;#x03C0;</mi><mo>&amp;#x2217;</mo></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-783\" style=\"width: 1.253em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.04em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-784\"><span class=\"msubsup\" id=\"MathJax-Span-785\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-786\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.576em;\"><span class=\"mo\" id=\"MathJax-Span-787\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àó</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>œÄ</mi><mo>‚àó</mo></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-87\">\\pi^*</script> can then be derived as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-88-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>&amp;#x03C0;</mi><mo>&amp;#x2217;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>a</mi></munder><msup><mi>Q</mi><mo>&amp;#x2217;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-788\" style=\"width: 11.773em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.794em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1009.74em, 3.128em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-789\"><span class=\"msubsup\" id=\"MathJax-Span-790\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-791\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.576em;\"><span class=\"mo\" id=\"MathJax-Span-792\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àó</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-793\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-794\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-795\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-796\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-797\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-798\"></span><span class=\"munderover\" id=\"MathJax-Span-799\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-800\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.273em, -999.997em); top: -3.331em; left: 0.68em;\"><span class=\"mi\" id=\"MathJax-Span-801\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-802\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-803\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.732em;\"><span class=\"mo\" id=\"MathJax-Span-804\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àó</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-805\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-806\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-807\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-808\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-809\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.997em; border-left: 0px solid; width: 0px; height: 2.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>œÄ</mi><mo>‚àó</mo></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>a</mi></munder><msup><mi>Q</mi><mo>‚àó</mo></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-88\">\\pi^*(s) = \\arg\\max_a Q^*(s,a)</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-89-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>Q</mi><mo>&amp;#x2217;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-810\" style=\"width: 3.753em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.08em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-811\"><span class=\"msubsup\" id=\"MathJax-Span-812\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-813\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"mo\" id=\"MathJax-Span-814\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àó</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-815\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-816\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-817\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-818\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-819\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>Q</mi><mo>‚àó</mo></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-89\">Q^*(s,a)</script> is the optimal action-value function.</li>\n    </ul>\n  </li>\n</ul>\n<p>The optimal policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-87-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>&amp;#x03C0;</mi><mo>&amp;#x2217;</mo></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-783\" style=\"width: 1.253em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.04em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-784\"><span class=\"msubsup\" id=\"MathJax-Span-785\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-786\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.576em;\"><span class=\"mo\" id=\"MathJax-Span-787\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àó</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>œÄ</mi><mo>‚àó</mo></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-87\">\\pi^*</script> can then be derived as:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-89-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>Q</mi><mo>&amp;#x2217;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-810\" style=\"width: 3.753em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.08em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-811\"><span class=\"msubsup\" id=\"MathJax-Span-812\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-813\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"mo\" id=\"MathJax-Span-814\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àó</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-815\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-816\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-817\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-818\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-819\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>Q</mi><mo>‚àó</mo></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-89\">Q^*(s,a)</script> is the optimal action-value function.</li>\n    </ul>\n<h4 id=\"dynamic-programming-dp\">Dynamic Programming (DP)</h4>\n<ul>\n  <li>\n    <p>Dynamic Programming represents the earliest and most theoretically grounded approach to solving reinforcement learning problems. It assumes that a <strong>complete model</strong> of the environment is known‚Äîspecifically, the transition probabilities <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-90-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2223;</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-820\" style=\"width: 4.951em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.117em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1004.07em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-821\"><span class=\"mi\" id=\"MathJax-Span-822\" style=\"font-family: STIXGeneral-Italic;\">P</span><span class=\"mo\" id=\"MathJax-Span-823\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-824\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-825\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-826\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-827\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-828\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-829\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-830\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-831\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>P</mi><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>‚à£</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-90\">P(s' \\mid s,a)</script> and reward function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-91-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-832\" style=\"width: 3.232em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.61em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-833\"><span class=\"mi\" id=\"MathJax-Span-834\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-835\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-836\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-837\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-838\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-839\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-91\">R(s,a)</script>.</p>\n  </li>\n  <li>\n    <p>Introduced by <a href=\"https://people.math.ethz.ch/~jteichma/Teaching/FiniteMarkov/Bellman1957.pdf\">Bellman (1957)</a>, DP methods are built upon the <strong>Bellman Optimality Equation</strong>, which recursively expresses the relationship between the value of a state and the values of its successor states:</p>\n  </li>\n</ul>\n<p>Dynamic Programming represents the earliest and most theoretically grounded approach to solving reinforcement learning problems. It assumes that a <strong>complete model</strong> of the environment is known‚Äîspecifically, the transition probabilities <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-90-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2223;</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-820\" style=\"width: 4.951em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.117em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1004.07em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-821\"><span class=\"mi\" id=\"MathJax-Span-822\" style=\"font-family: STIXGeneral-Italic;\">P</span><span class=\"mo\" id=\"MathJax-Span-823\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-824\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-825\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-826\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-827\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-828\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-829\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-830\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-831\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>P</mi><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>‚à£</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-90\">P(s' \\mid s,a)</script> and reward function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-91-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-832\" style=\"width: 3.232em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.61em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-833\"><span class=\"mi\" id=\"MathJax-Span-834\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-835\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-836\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-837\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-838\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-839\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-91\">R(s,a)</script>.</p>\n<p>Introduced by <a href=\"https://people.math.ethz.ch/~jteichma/Teaching/FiniteMarkov/Bellman1957.pdf\">Bellman (1957)</a>, DP methods are built upon the <strong>Bellman Optimality Equation</strong>, which recursively expresses the relationship between the value of a state and the values of its successor states:</p>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-92-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>V</mi><mo>&amp;#x2217;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>a</mi></munder><mrow><mo>[</mo><mrow><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B3;</mi><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup></mrow></munder><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2223;</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><msup><mi>V</mi><mo>&amp;#x2217;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-840\" style=\"width: 23.336em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 19.43em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1019.12em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-841\"><span class=\"msubsup\" id=\"MathJax-Span-842\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-843\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.784em;\"><span class=\"mo\" id=\"MathJax-Span-844\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àó</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-845\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-846\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-847\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-848\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-849\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-850\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.273em, -999.997em); top: -3.331em; left: 0.68em;\"><span class=\"mi\" id=\"MathJax-Span-851\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-852\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-853\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-854\"><span class=\"mi\" id=\"MathJax-Span-855\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-856\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-857\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-858\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-859\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-860\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-861\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-862\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"munderover\" id=\"MathJax-Span-863\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-864\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1000.52em, 4.273em, -999.997em); top: -2.81em; left: 0.419em;\"><span class=\"texatom\" id=\"MathJax-Span-865\"><span class=\"mrow\" id=\"MathJax-Span-866\"><span class=\"msup\" id=\"MathJax-Span-867\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-868\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.263em;\"><span class=\"mo\" id=\"MathJax-Span-869\" style=\"font-size: 50%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-870\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">P</span><span class=\"mo\" id=\"MathJax-Span-871\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-872\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-873\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-874\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-875\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-876\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-877\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-878\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-879\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-880\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-881\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.784em;\"><span class=\"mo\" id=\"MathJax-Span-882\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àó</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-883\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-884\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-885\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-886\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-887\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-888\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>V</mi><mo>‚àó</mo></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>a</mi></munder><mrow><mo>[</mo><mrow><mi>R</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>Œ≥</mi><munder><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><msup><mi>s</mi><mo>‚Ä≤</mo></msup></mrow></munder><mi>P</mi><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>‚à£</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><msup><mi>V</mi><mo>‚àó</mo></msup><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div>\n<ul>\n  <li>\n    <p>Two major DP algorithms are:</p>\n\n    <ul>\n      <li><strong>Value Iteration:</strong> Alternates between evaluating and improving the value function until convergence to <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-93-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mo>&amp;#x2217;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-889\" style=\"width: 2.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.19em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-890\"><span class=\"msubsup\" id=\"MathJax-Span-891\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-892\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"mo\" id=\"MathJax-Span-893\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àó</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-894\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-895\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-896\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mo>‚àó</mo></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-93\">V^*(s)</script>.</li>\n      <li><strong>Policy Iteration:</strong> Alternates between <strong>policy evaluation</strong> (estimating <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-94-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-897\" style=\"width: 1.461em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.2em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-898\"><span class=\"msubsup\" id=\"MathJax-Span-899\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-900\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-901\"><span class=\"mrow\" id=\"MathJax-Span-902\"><span class=\"mi\" id=\"MathJax-Span-903\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-94\">V^{\\pi}</script>) and <strong>policy improvement</strong> (updating <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-95-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-904\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-905\"><span class=\"mi\" id=\"MathJax-Span-906\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-95\">\\pi</script>) until the policy stabilizes.</li>\n    </ul>\n  </li>\n  <li>\n    <p>DP is exact and guaranteed to converge for finite MDPs, but it is computationally infeasible in large state spaces due to the <strong>curse of dimensionality</strong>.</p>\n  </li>\n  <li>\n    <p><strong>Key Reference:</strong></p>\n    <ul>\n      <li><a href=\"https://pubsonline.informs.org/doi/10.1287/opre.8.6.716\">Howard (1960)</a>: introduced <em>policy iteration</em> as a computationally efficient refinement to Bellman‚Äôs DP framework.</li>\n    </ul>\n  </li>\n</ul>\n<p>Two major DP algorithms are:</p>\n<ul>\n      <li><strong>Value Iteration:</strong> Alternates between evaluating and improving the value function until convergence to <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-93-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mo>&amp;#x2217;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-889\" style=\"width: 2.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.19em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-890\"><span class=\"msubsup\" id=\"MathJax-Span-891\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-892\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"mo\" id=\"MathJax-Span-893\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àó</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-894\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-895\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-896\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mo>‚àó</mo></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-93\">V^*(s)</script>.</li>\n      <li><strong>Policy Iteration:</strong> Alternates between <strong>policy evaluation</strong> (estimating <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-94-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-897\" style=\"width: 1.461em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.2em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-898\"><span class=\"msubsup\" id=\"MathJax-Span-899\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-900\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-901\"><span class=\"mrow\" id=\"MathJax-Span-902\"><span class=\"mi\" id=\"MathJax-Span-903\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-94\">V^{\\pi}</script>) and <strong>policy improvement</strong> (updating <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-95-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-904\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-905\"><span class=\"mi\" id=\"MathJax-Span-906\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-95\">\\pi</script>) until the policy stabilizes.</li>\n    </ul>\n<p>DP is exact and guaranteed to converge for finite MDPs, but it is computationally infeasible in large state spaces due to the <strong>curse of dimensionality</strong>.</p>\n<p><strong>Key Reference:</strong></p>\n<ul>\n      <li><a href=\"https://pubsonline.informs.org/doi/10.1287/opre.8.6.716\">Howard (1960)</a>: introduced <em>policy iteration</em> as a computationally efficient refinement to Bellman‚Äôs DP framework.</li>\n    </ul>\n<h4 id=\"monte-carlo-mc-methods\">Monte Carlo (MC) Methods</h4>\n<ul>\n  <li>\n    <p>Monte Carlo methods learn value functions <strong>from experience</strong>, without requiring a model of the environment.\nThey estimate expected returns by averaging the actual returns observed after complete episodes of experience.</p>\n  </li>\n  <li>\n    <p>For a state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-96-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-907\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-908\"><span class=\"mi\" id=\"MathJax-Span-909\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-96\">s</script>, the Monte Carlo estimate of the value is:</p>\n  </li>\n</ul>\n<p>Monte Carlo methods learn value functions <strong>from experience</strong>, without requiring a model of the environment.\nThey estimate expected returns by averaging the actual returns observed after complete episodes of experience.</p>\n<p>For a state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-96-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-907\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-908\"><span class=\"mi\" id=\"MathJax-Span-909\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-96\">s</script>, the Monte Carlo estimate of the value is:</p>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-97-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2248;</mo><mfrac><mn>1</mn><mrow><mi>N</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></munderover><msub><mi>G</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-910\" style=\"width: 9.482em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.867em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.211em, 1007.87em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-911\"><span class=\"mi\" id=\"MathJax-Span-912\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-913\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-914\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-915\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-916\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚âà</span><span class=\"mfrac\" id=\"MathJax-Span-917\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.93em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;\"><span class=\"mn\" id=\"MathJax-Span-918\" style=\"font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1001.72em, 4.326em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.883em;\"><span class=\"mrow\" id=\"MathJax-Span-919\"><span class=\"mi\" id=\"MathJax-Span-920\" style=\"font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-921\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-922\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-923\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1001.93em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.93em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-924\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-925\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.94em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-926\"><span class=\"mrow\" id=\"MathJax-Span-927\"><span class=\"mi\" id=\"MathJax-Span-928\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-929\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-930\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1001.25em, 4.273em, -999.997em); top: -5.258em; left: 0.003em;\"><span class=\"texatom\" id=\"MathJax-Span-931\"><span class=\"mrow\" id=\"MathJax-Span-932\"><span class=\"mi\" id=\"MathJax-Span-933\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-934\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-935\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-936\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-937\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-938\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-939\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>V</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>‚âà</mo><mfrac><mn>1</mn><mrow><mi>N</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow></mfrac><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>N</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow></munderover><msub><mi>G</mi><mi>i</mi></msub></math></span></span></div>\n<ul>\n  <li>\n    <p>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-98-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-940\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.99em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-941\"><span class=\"msubsup\" id=\"MathJax-Span-942\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-943\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-944\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>G</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-98\">G_i</script> is the total return following the <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-99-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>i</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>h</mi></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-945\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1000.94em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-946\"><span class=\"msubsup\" id=\"MathJax-Span-947\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-948\" style=\"font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-949\"><span class=\"mrow\" id=\"MathJax-Span-950\"><span class=\"mi\" id=\"MathJax-Span-951\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-952\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">h</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>i</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mi>h</mi></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-99\">i^{th}</script> visit to <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-100-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-953\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-954\"><span class=\"mi\" id=\"MathJax-Span-955\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-100\">s</script>, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-101-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-956\" style=\"width: 2.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.77em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-957\"><span class=\"mi\" id=\"MathJax-Span-958\" style=\"font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-959\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-960\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-961\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>N</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-101\">N(s)</script> is the number of visits to <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-102-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-962\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-963\"><span class=\"mi\" id=\"MathJax-Span-964\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-102\">s</script>.</p>\n  </li>\n  <li>\n    <p><strong>Advantages:</strong></p>\n\n    <ul>\n      <li>Model-free: no need for transition probabilities.</li>\n      <li>Simple and unbiased estimates after enough samples.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Limitations:</strong></p>\n\n    <ul>\n      <li>Requires episodes to terminate (not suitable for continuing tasks).</li>\n      <li>Slow convergence due to reliance on complete trajectories.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Key References:</strong></p>\n\n    <ul>\n      <li><a href=\"https://ieeexplore.ieee.org/document/5392560\">Samuel (1959)</a>: introduced early machine learning ideas based on Monte Carlo updates in checkers.</li>\n      <li><a href=\"https://www.andrew.cmu.edu/course/10-703/textbook/BartoSutton.pdf\">Sutton &amp; Barto (1998)</a>: formalized Monte Carlo methods in modern RL.</li>\n    </ul>\n  </li>\n</ul>\n<p>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-98-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-940\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.99em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-941\"><span class=\"msubsup\" id=\"MathJax-Span-942\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-943\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-944\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>G</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-98\">G_i</script> is the total return following the <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-99-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>i</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>h</mi></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-945\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1000.94em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-946\"><span class=\"msubsup\" id=\"MathJax-Span-947\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-948\" style=\"font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-949\"><span class=\"mrow\" id=\"MathJax-Span-950\"><span class=\"mi\" id=\"MathJax-Span-951\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-952\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">h</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>i</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mi>h</mi></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-99\">i^{th}</script> visit to <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-100-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-953\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-954\"><span class=\"mi\" id=\"MathJax-Span-955\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-100\">s</script>, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-101-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-956\" style=\"width: 2.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.77em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-957\"><span class=\"mi\" id=\"MathJax-Span-958\" style=\"font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-959\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-960\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-961\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>N</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-101\">N(s)</script> is the number of visits to <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-102-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-962\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-963\"><span class=\"mi\" id=\"MathJax-Span-964\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-102\">s</script>.</p>\n<p><strong>Advantages:</strong></p>\n<ul>\n      <li>Model-free: no need for transition probabilities.</li>\n      <li>Simple and unbiased estimates after enough samples.</li>\n    </ul>\n<p><strong>Limitations:</strong></p>\n<ul>\n      <li>Requires episodes to terminate (not suitable for continuing tasks).</li>\n      <li>Slow convergence due to reliance on complete trajectories.</li>\n    </ul>\n<p><strong>Key References:</strong></p>\n<ul>\n      <li><a href=\"https://ieeexplore.ieee.org/document/5392560\">Samuel (1959)</a>: introduced early machine learning ideas based on Monte Carlo updates in checkers.</li>\n      <li><a href=\"https://www.andrew.cmu.edu/course/10-703/textbook/BartoSutton.pdf\">Sutton &amp; Barto (1998)</a>: formalized Monte Carlo methods in modern RL.</li>\n    </ul>\n<h4 id=\"temporal-difference-td-learning\">Temporal Difference (TD) Learning</h4>\n<ul>\n  <li>\n    <p>Temporal Difference learning blends the key ideas of <strong>Monte Carlo</strong> and <strong>Dynamic Programming</strong> ‚Äî learning directly from raw experience without requiring a model, and updating value estimates based on <em>bootstrapping</em> from other estimates.</p>\n  </li>\n  <li>\n    <p>The core update rule for TD(0) is:</p>\n  </li>\n</ul>\n<p>Temporal Difference learning blends the key ideas of <strong>Monte Carlo</strong> and <strong>Dynamic Programming</strong> ‚Äî learning directly from raw experience without requiring a model, and updating value estimates based on <em>bootstrapping</em> from other estimates.</p>\n<p>The core update rule for TD(0) is:</p>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-103-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>S</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>&amp;#x2190;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>S</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B1;</mi><mrow><mo>[</mo><mrow><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>&amp;#x03B3;</mi><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>S</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>S</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-965\" style=\"width: 21.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 18.18em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1018.08em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-966\"><span class=\"mi\" id=\"MathJax-Span-967\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-968\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-969\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-970\" style=\"font-family: STIXGeneral-Italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-971\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-972\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-973\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üê</span><span class=\"mi\" id=\"MathJax-Span-974\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-975\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-976\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-977\" style=\"font-family: STIXGeneral-Italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-978\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-979\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-980\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-981\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ±</span><span class=\"mrow\" id=\"MathJax-Span-982\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-983\" style=\"vertical-align: 0.003em;\"><span style=\"font-family: STIXGeneral-Regular;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-984\"><span class=\"msubsup\" id=\"MathJax-Span-985\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-986\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-987\"><span class=\"mrow\" id=\"MathJax-Span-988\"><span class=\"mi\" id=\"MathJax-Span-989\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-990\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-991\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-992\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-993\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-994\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-995\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-996\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-997\" style=\"font-family: STIXGeneral-Italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-998\"><span class=\"mrow\" id=\"MathJax-Span-999\"><span class=\"mi\" id=\"MathJax-Span-1000\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1001\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-1002\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1003\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1004\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-1005\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1006\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1007\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1008\" style=\"font-family: STIXGeneral-Italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1009\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1010\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-1011\" style=\"vertical-align: 0.003em;\"><span style=\"font-family: STIXGeneral-Regular;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>S</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">‚Üê</mo><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>S</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>+</mo><mi>Œ±</mi><mrow><mo>[</mo><mrow><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>Œ≥</mi><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>S</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>S</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div>\n<ul>\n  <li>Here, the agent updates its estimate of <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-104-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>S</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1012\" style=\"width: 2.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.19em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1013\"><span class=\"mi\" id=\"MathJax-Span-1014\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1015\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1016\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1017\" style=\"font-family: STIXGeneral-Italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1018\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1019\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>S</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-104\">V(S_t)</script> using the observed reward plus the discounted value of the next state, rather than waiting for the episode to finish.</li>\n  <li>\n    <p>TD learning provides the foundation for most modern value-based algorithms, including <strong>SARSA</strong> and <strong>Q-Learning</strong>.</p>\n  </li>\n  <li>\n    <p><strong>Advantages:</strong>:</p>\n\n    <ul>\n      <li>Online, incremental updates.</li>\n      <li>Works for both episodic and continuing tasks.</li>\n      <li>Converges faster than Monte Carlo in many settings.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Key References:</strong>:</p>\n\n    <ul>\n      <li><a href=\"https://link.springer.com/article/10.1007/BF00115009\">Sutton (1988)</a>: introduced <em>Temporal Difference Learning</em>, establishing the bridge between prediction and control.</li>\n      <li><a href=\"https://link.springer.com/article/10.1007/BF00992698\">Watkins &amp; Dayan (1992)</a>: extended TD ideas to <em>Q-Learning</em>, the most influential off-policy control algorithm.</li>\n    </ul>\n  </li>\n</ul>\n<p>TD learning provides the foundation for most modern value-based algorithms, including <strong>SARSA</strong> and <strong>Q-Learning</strong>.</p>\n<p><strong>Advantages:</strong>:</p>\n<ul>\n      <li>Online, incremental updates.</li>\n      <li>Works for both episodic and continuing tasks.</li>\n      <li>Converges faster than Monte Carlo in many settings.</li>\n    </ul>\n<p><strong>Key References:</strong>:</p>\n<ul>\n      <li><a href=\"https://link.springer.com/article/10.1007/BF00115009\">Sutton (1988)</a>: introduced <em>Temporal Difference Learning</em>, establishing the bridge between prediction and control.</li>\n      <li><a href=\"https://link.springer.com/article/10.1007/BF00992698\">Watkins &amp; Dayan (1992)</a>: extended TD ideas to <em>Q-Learning</em>, the most influential off-policy control algorithm.</li>\n    </ul>\n<h4 id=\"comparative-analysis\">Comparative Analysis</h4>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Method</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Model Requirement</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Update Type</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Sample Efficiency</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Key References</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Dynamic Programming</strong></td>\n<td class=\"tg-tleft-valign-first\">Requires full model</td>\n<td class=\"tg-tleft-valign-first\">Full backup</td>\n<td class=\"tg-tleft-valign-first\">High computational cost</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://people.math.ethz.ch/~jteichma/Teaching/FiniteMarkov/Bellman1957.pdf\">Bellman (1957)</a>, <a href=\"https://pubsonline.informs.org/doi/10.1287/opre.8.6.716\">Howard (1960)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Monte Carlo</strong></td>\n<td class=\"tg-tleft-valign-first\">Model-free</td>\n<td class=\"tg-tleft-valign-first\">Episodic, complete return</td>\n<td class=\"tg-tleft-valign-first\">Low</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://ieeexplore.ieee.org/document/5392560\">Samuel (1959)</a>, <a href=\"https://www.andrew.cmu.edu/course/10-703/textbook/BartoSutton.pdf\">Sutton &amp; Barto (1998)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Temporal Difference (TD)</strong></td>\n<td class=\"tg-tleft-valign-first\">Model-free</td>\n<td class=\"tg-tleft-valign-first\">Bootstrapped incremental</td>\n<td class=\"tg-tleft-valign-first\">High</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://link.springer.com/article/10.1007/BF00115009\">Sutton (1988)</a>, <a href=\"https://link.springer.com/article/10.1007/BF00992698\">Watkins &amp; Dayan (1992)</a></td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Method</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Model Requirement</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Update Type</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Sample Efficiency</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Key References</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Dynamic Programming</strong></td>\n<td class=\"tg-tleft-valign-first\">Requires full model</td>\n<td class=\"tg-tleft-valign-first\">Full backup</td>\n<td class=\"tg-tleft-valign-first\">High computational cost</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://people.math.ethz.ch/~jteichma/Teaching/FiniteMarkov/Bellman1957.pdf\">Bellman (1957)</a>, <a href=\"https://pubsonline.informs.org/doi/10.1287/opre.8.6.716\">Howard (1960)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Monte Carlo</strong></td>\n<td class=\"tg-tleft-valign-first\">Model-free</td>\n<td class=\"tg-tleft-valign-first\">Episodic, complete return</td>\n<td class=\"tg-tleft-valign-first\">Low</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://ieeexplore.ieee.org/document/5392560\">Samuel (1959)</a>, <a href=\"https://www.andrew.cmu.edu/course/10-703/textbook/BartoSutton.pdf\">Sutton &amp; Barto (1998)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Temporal Difference (TD)</strong></td>\n<td class=\"tg-tleft-valign-first\">Model-free</td>\n<td class=\"tg-tleft-valign-first\">Bootstrapped incremental</td>\n<td class=\"tg-tleft-valign-first\">High</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://link.springer.com/article/10.1007/BF00115009\">Sutton (1988)</a>, <a href=\"https://link.springer.com/article/10.1007/BF00992698\">Watkins &amp; Dayan (1992)</a></td>\n</tr>\n</tbody>\n</table>",
    "contentMarkdown": "*   Value-based methods form the cornerstone of reinforcement learning. Their core principle is to learn **value functions** that estimate how good it is for an agent to be in a given state or to perform a specific action in that state.\n*   These methods do not learn policies directly; instead, they infer the optimal policy from the learned values by choosing actions that maximize expected future rewards.\n\n#### Foundations of Value Functions\n\n*   Two central value functions define this class of methods:\n\n1.  **State-Value Function:**\n    \n    VœÄ(s)\\=ùîºœÄ\\[‚àët\\=0‚àûŒ≥trt‚à£S0\\=s\\]VœÄ(s)\\=EœÄ\\[‚àët\\=0‚àûŒ≥trt‚à£S0\\=s\\]\n    \n    V^{\\\\pi}(s) = \\\\mathbb{E}\\_{\\\\pi} \\\\left\\[ \\\\sum\\_{t=0}^{\\\\infty} \\\\gamma^t r\\_t \\\\mid S\\_0 = s \\\\right\\]\n    *   This represents the expected cumulative reward when starting from state sss and following policy œÄœÄ\\\\pi thereafter.\n2.  **Action-Value Function:**\n    \n    QœÄ(s,a)\\=ùîºœÄ\\[‚àët\\=0‚àûŒ≥trt‚à£S0\\=s,A0\\=a\\]QœÄ(s,a)\\=EœÄ\\[‚àët\\=0‚àûŒ≥trt‚à£S0\\=s,A0\\=a\\]\n    \n    Q^{\\\\pi}(s,a) = \\\\mathbb{E}\\_{\\\\pi} \\\\left\\[ \\\\sum\\_{t=0}^{\\\\infty} \\\\gamma^t r\\_t \\\\mid S\\_0 = s, A\\_0 = a \\\\right\\]\n    *   This quantifies the expected return when taking action aaa in state sss and then following policy œÄœÄ\\\\pi.\n\n**State-Value Function:**\n\n*   This represents the expected cumulative reward when starting from state sss and following policy œÄœÄ\\\\pi thereafter.\n\n**Action-Value Function:**\n\n*   This quantifies the expected return when taking action aaa in state sss and then following policy œÄœÄ\\\\pi.\n\n*   The optimal policy œÄ‚àóœÄ‚àó\\\\pi^\\* can then be derived as:\n    \n    œÄ‚àó(s)\\=argmaxaQ‚àó(s,a)œÄ‚àó(s)\\=arg‚Å°maxaQ‚àó(s,a)\n    \n    \\\\pi^\\*(s) = \\\\arg\\\\max\\_a Q^\\*(s,a)\n    *   where Q‚àó(s,a)Q‚àó(s,a)Q^\\*(s,a) is the optimal action-value function.\n\nThe optimal policy œÄ‚àóœÄ‚àó\\\\pi^\\* can then be derived as:\n\n*   where Q‚àó(s,a)Q‚àó(s,a)Q^\\*(s,a) is the optimal action-value function.\n\n#### Dynamic Programming (DP)\n\n*   Dynamic Programming represents the earliest and most theoretically grounded approach to solving reinforcement learning problems. It assumes that a **complete model** of the environment is known‚Äîspecifically, the transition probabilities P(s‚Ä≤‚à£s,a)P(s‚Ä≤‚à£s,a)P(s' \\\\mid s,a) and reward function R(s,a)R(s,a)R(s,a).\n    \n*   Introduced by [Bellman (1957)](https://people.math.ethz.ch/~jteichma/Teaching/FiniteMarkov/Bellman1957.pdf), DP methods are built upon the **Bellman Optimality Equation**, which recursively expresses the relationship between the value of a state and the values of its successor states:\n    \n\nDynamic Programming represents the earliest and most theoretically grounded approach to solving reinforcement learning problems. It assumes that a **complete model** of the environment is known‚Äîspecifically, the transition probabilities P(s‚Ä≤‚à£s,a)P(s‚Ä≤‚à£s,a)P(s' \\\\mid s,a) and reward function R(s,a)R(s,a)R(s,a).\n\nIntroduced by [Bellman (1957)](https://people.math.ethz.ch/~jteichma/Teaching/FiniteMarkov/Bellman1957.pdf), DP methods are built upon the **Bellman Optimality Equation**, which recursively expresses the relationship between the value of a state and the values of its successor states:\n\nV‚àó(s)\\=maxa\\[R(s,a)+Œ≥‚àës‚Ä≤P(s‚Ä≤‚à£s,a)V‚àó(s‚Ä≤)\\]V‚àó(s)\\=maxa\\[R(s,a)+Œ≥‚àës‚Ä≤P(s‚Ä≤‚à£s,a)V‚àó(s‚Ä≤)\\]\n\n*   Two major DP algorithms are:\n    \n    *   **Value Iteration:** Alternates between evaluating and improving the value function until convergence to V‚àó(s)V‚àó(s)V^\\*(s).\n    *   **Policy Iteration:** Alternates between **policy evaluation** (estimating VœÄVœÄV^{\\\\pi}) and **policy improvement** (updating œÄœÄ\\\\pi) until the policy stabilizes.\n*   DP is exact and guaranteed to converge for finite MDPs, but it is computationally infeasible in large state spaces due to the **curse of dimensionality**.\n    \n*   **Key Reference:**\n    \n    *   [Howard (1960)](https://pubsonline.informs.org/doi/10.1287/opre.8.6.716): introduced _policy iteration_ as a computationally efficient refinement to Bellman‚Äôs DP framework.\n\nTwo major DP algorithms are:\n\n*   **Value Iteration:** Alternates between evaluating and improving the value function until convergence to V‚àó(s)V‚àó(s)V^\\*(s).\n*   **Policy Iteration:** Alternates between **policy evaluation** (estimating VœÄVœÄV^{\\\\pi}) and **policy improvement** (updating œÄœÄ\\\\pi) until the policy stabilizes.\n\nDP is exact and guaranteed to converge for finite MDPs, but it is computationally infeasible in large state spaces due to the **curse of dimensionality**.\n\n**Key Reference:**\n\n*   [Howard (1960)](https://pubsonline.informs.org/doi/10.1287/opre.8.6.716): introduced _policy iteration_ as a computationally efficient refinement to Bellman‚Äôs DP framework.\n\n#### Monte Carlo (MC) Methods\n\n*   Monte Carlo methods learn value functions **from experience**, without requiring a model of the environment. They estimate expected returns by averaging the actual returns observed after complete episodes of experience.\n    \n*   For a state sss, the Monte Carlo estimate of the value is:\n    \n\nMonte Carlo methods learn value functions **from experience**, without requiring a model of the environment. They estimate expected returns by averaging the actual returns observed after complete episodes of experience.\n\nFor a state sss, the Monte Carlo estimate of the value is:\n\nV(s)‚âà1N(s)‚àëi\\=1N(s)GiV(s)‚âà1N(s)‚àëi\\=1N(s)Gi\n\n*   where GiGiG\\_i is the total return following the ithithi^{th} visit to sss, and N(s)N(s)N(s) is the number of visits to sss.\n    \n*   **Advantages:**\n    \n    *   Model-free: no need for transition probabilities.\n    *   Simple and unbiased estimates after enough samples.\n*   **Limitations:**\n    \n    *   Requires episodes to terminate (not suitable for continuing tasks).\n    *   Slow convergence due to reliance on complete trajectories.\n*   **Key References:**\n    \n    *   [Samuel (1959)](https://ieeexplore.ieee.org/document/5392560): introduced early machine learning ideas based on Monte Carlo updates in checkers.\n    *   [Sutton & Barto (1998)](https://www.andrew.cmu.edu/course/10-703/textbook/BartoSutton.pdf): formalized Monte Carlo methods in modern RL.\n\nwhere GiGiG\\_i is the total return following the ithithi^{th} visit to sss, and N(s)N(s)N(s) is the number of visits to sss.\n\n**Advantages:**\n\n*   Model-free: no need for transition probabilities.\n*   Simple and unbiased estimates after enough samples.\n\n**Limitations:**\n\n*   Requires episodes to terminate (not suitable for continuing tasks).\n*   Slow convergence due to reliance on complete trajectories.\n\n**Key References:**\n\n*   [Samuel (1959)](https://ieeexplore.ieee.org/document/5392560): introduced early machine learning ideas based on Monte Carlo updates in checkers.\n*   [Sutton & Barto (1998)](https://www.andrew.cmu.edu/course/10-703/textbook/BartoSutton.pdf): formalized Monte Carlo methods in modern RL.\n\n#### Temporal Difference (TD) Learning\n\n*   Temporal Difference learning blends the key ideas of **Monte Carlo** and **Dynamic Programming** ‚Äî learning directly from raw experience without requiring a model, and updating value estimates based on _bootstrapping_ from other estimates.\n    \n*   The core update rule for TD(0) is:\n    \n\nTemporal Difference learning blends the key ideas of **Monte Carlo** and **Dynamic Programming** ‚Äî learning directly from raw experience without requiring a model, and updating value estimates based on _bootstrapping_ from other estimates.\n\nThe core update rule for TD(0) is:\n\nV(St)‚ÜêV(St)+Œ±\\[rt+1+Œ≥V(St+1)‚àíV(St)\\]V(St)‚ÜêV(St)+Œ±\\[rt+1+Œ≥V(St+1)‚àíV(St)\\]\n\n*   Here, the agent updates its estimate of V(St)V(St)V(S\\_t) using the observed reward plus the discounted value of the next state, rather than waiting for the episode to finish.\n*   TD learning provides the foundation for most modern value-based algorithms, including **SARSA** and **Q-Learning**.\n    \n*   **Advantages:**:\n    \n    *   Online, incremental updates.\n    *   Works for both episodic and continuing tasks.\n    *   Converges faster than Monte Carlo in many settings.\n*   **Key References:**:\n    \n    *   [Sutton (1988)](https://link.springer.com/article/10.1007/BF00115009): introduced _Temporal Difference Learning_, establishing the bridge between prediction and control.\n    *   [Watkins & Dayan (1992)](https://link.springer.com/article/10.1007/BF00992698): extended TD ideas to _Q-Learning_, the most influential off-policy control algorithm.\n\nTD learning provides the foundation for most modern value-based algorithms, including **SARSA** and **Q-Learning**.\n\n**Advantages:**:\n\n*   Online, incremental updates.\n*   Works for both episodic and continuing tasks.\n*   Converges faster than Monte Carlo in many settings.\n\n**Key References:**:\n\n*   [Sutton (1988)](https://link.springer.com/article/10.1007/BF00115009): introduced _Temporal Difference Learning_, establishing the bridge between prediction and control.\n*   [Watkins & Dayan (1992)](https://link.springer.com/article/10.1007/BF00992698): extended TD ideas to _Q-Learning_, the most influential off-policy control algorithm.\n\n#### Comparative Analysis\n\n**Method**\n\n**Model Requirement**\n\n**Update Type**\n\n**Sample Efficiency**\n\n**Key References**\n\n**Dynamic Programming**\n\nRequires full model\n\nFull backup\n\nHigh computational cost\n\n[Bellman (1957)](https://people.math.ethz.ch/~jteichma/Teaching/FiniteMarkov/Bellman1957.pdf), [Howard (1960)](https://pubsonline.informs.org/doi/10.1287/opre.8.6.716)\n\n**Monte Carlo**\n\nModel-free\n\nEpisodic, complete return\n\nLow\n\n[Samuel (1959)](https://ieeexplore.ieee.org/document/5392560), [Sutton & Barto (1998)](https://www.andrew.cmu.edu/course/10-703/textbook/BartoSutton.pdf)\n\n**Temporal Difference (TD)**\n\nModel-free\n\nBootstrapped incremental\n\nHigh\n\n[Sutton (1988)](https://link.springer.com/article/10.1007/BF00115009), [Watkins & Dayan (1992)](https://link.springer.com/article/10.1007/BF00992698)\n\n**Method**\n\n**Model Requirement**\n\n**Update Type**\n\n**Sample Efficiency**\n\n**Key References**\n\n**Dynamic Programming**\n\nRequires full model\n\nFull backup\n\nHigh computational cost\n\n[Bellman (1957)](https://people.math.ethz.ch/~jteichma/Teaching/FiniteMarkov/Bellman1957.pdf), [Howard (1960)](https://pubsonline.informs.org/doi/10.1287/opre.8.6.716)\n\n**Monte Carlo**\n\nModel-free\n\nEpisodic, complete return\n\nLow\n\n[Samuel (1959)](https://ieeexplore.ieee.org/document/5392560), [Sutton & Barto (1998)](https://www.andrew.cmu.edu/course/10-703/textbook/BartoSutton.pdf)\n\n**Temporal Difference (TD)**\n\nModel-free\n\nBootstrapped incremental\n\nHigh\n\n[Sutton (1988)](https://link.springer.com/article/10.1007/BF00115009), [Watkins & Dayan (1992)](https://link.springer.com/article/10.1007/BF00992698)",
    "order": 9,
    "orderInChapter": 1,
    "difficulty": 3,
    "estimatedMinutes": 6,
    "tags": [
      "algorithmsarchitecture",
      "machine learning",
      "llm",
      "reinforcement learning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 1160,
      "contentLength": 130123
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#value-based-methods",
    "scrapedAt": "2025-12-28T11:47:08.459Z"
  },
  {
    "id": "ai-reinforcement-learning-policy-based-methods-10",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Types of Reinforcement Learning",
    "title": "Policy-Based Methods",
    "subtitle": "Types of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>\n    <p>While value-based methods focus on estimating the long-term value of states or state‚Äìaction pairs, <strong>policy-based methods</strong> take a more direct approach: they learn a <strong>parameterized policy</strong> that maps states to actions and optimize it to maximize expected return.</p>\n  </li>\n  <li>\n    <p>These methods are particularly useful in environments with <strong>continuous or stochastic action spaces</strong>, where value-based techniques like Q-learning are difficult to apply effectively.</p>\n  </li>\n</ul>\n<p>While value-based methods focus on estimating the long-term value of states or state‚Äìaction pairs, <strong>policy-based methods</strong> take a more direct approach: they learn a <strong>parameterized policy</strong> that maps states to actions and optimize it to maximize expected return.</p>\n<p>These methods are particularly useful in environments with <strong>continuous or stochastic action spaces</strong>, where value-based techniques like Q-learning are difficult to apply effectively.</p>\n<h4 id=\"policy-representation-and-objective\">Policy Representation and Objective</h4>\n<ul>\n  <li>In policy-based reinforcement learning, the agent‚Äôs behavior is represented by a <strong>stochastic policy</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-105-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1020\" style=\"width: 4.013em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.336em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.28em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1021\"><span class=\"msubsup\" id=\"MathJax-Span-1022\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1023\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1024\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1025\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1026\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-1027\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-1028\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1029\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-105\">\\pi_\\theta(a \\mid s)</script>, parameterized by <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-106-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1030\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1031\"><span class=\"mi\" id=\"MathJax-Span-1032\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ∏</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-106\">\\theta</script>. The goal is to find parameters that maximize the expected return:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-107-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1033\" style=\"width: 10.523em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 8.753em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1008.44em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1034\"><span class=\"mi\" id=\"MathJax-Span-1035\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1036\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1037\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1038\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1039\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-1040\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-1041\"><span class=\"mrow\" id=\"MathJax-Span-1042\"><span class=\"mi\" id=\"MathJax-Span-1043\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1044\"><span class=\"mrow\" id=\"MathJax-Span-1045\"><span class=\"msubsup\" id=\"MathJax-Span-1046\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1047\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1048\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-1049\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-1050\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-1051\"><span class=\"munderover\" id=\"MathJax-Span-1052\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1053\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-1054\"><span class=\"mrow\" id=\"MathJax-Span-1055\"><span class=\"mi\" id=\"MathJax-Span-1056\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1057\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-1058\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -5.206em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-1059\"><span class=\"mrow\" id=\"MathJax-Span-1060\"><span class=\"mi\" id=\"MathJax-Span-1061\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àû</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1062\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1063\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1064\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1065\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1066\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1067\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1068\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>J</mi><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">‚àû</mi></mrow></munderover><msup><mi>Œ≥</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub></mrow><mo>]</mo></mrow></math></span></span></div>\n<ul>\n  <li>Unlike value-based methods, which derive a policy indirectly from learned value estimates, policy-based approaches directly optimize this objective by computing its gradient with respect to the parameters <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-108-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1069\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1070\"><span class=\"mi\" id=\"MathJax-Span-1071\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ∏</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-108\">\\theta</script>.</li>\n</ul>\n<h4 id=\"the-policy-gradient-theorem\">The Policy Gradient Theorem</h4>\n<ul>\n  <li>The key insight enabling policy optimization is the <strong>Policy Gradient Theorem</strong> (<a href=\"https://proceedings.neurips.cc/paper_files/paper/1999/file/464d828b85b0bed98e80ade0a5c43b0f-Paper.pdf\">Sutton et al., 2000</a>).</li>\n  <li>It provides a way to estimate the gradient of the expected return without differentiating through the environment‚Äôs dynamics:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-109-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1072\" style=\"width: 20.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 17.19em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.878em, 1017.03em, 3.44em, -999.997em); top: -2.914em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1073\"><span class=\"msubsup\" id=\"MathJax-Span-1074\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1075\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-1076\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-1077\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1078\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1079\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1080\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1081\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-1082\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-1083\"><span class=\"mrow\" id=\"MathJax-Span-1084\"><span class=\"mi\" id=\"MathJax-Span-1085\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1086\"><span class=\"mrow\" id=\"MathJax-Span-1087\"><span class=\"msubsup\" id=\"MathJax-Span-1088\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1089\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1090\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-1091\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-1092\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-1093\"><span class=\"msubsup\" id=\"MathJax-Span-1094\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1095\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-1096\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-1097\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-1098\"></span><span class=\"msubsup\" id=\"MathJax-Span-1099\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1100\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1101\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1102\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1103\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1104\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1105\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1106\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-1107\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1108\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1109\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1110\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-1111\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1112\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-1113\"><span class=\"mrow\" id=\"MathJax-Span-1114\"><span class=\"msubsup\" id=\"MathJax-Span-1115\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1116\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1117\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1118\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1119\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1120\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1121\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1122\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1123\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1124\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1125\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1126\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-1127\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.919em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mi>J</mi><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mi>log</mi><mo>‚Å°</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></mrow></msup><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div>\n<ul>\n  <li>This formulation allows gradient ascent on <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-110-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1128\" style=\"width: 2.034em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.669em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.62em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1129\"><span class=\"mi\" id=\"MathJax-Span-1130\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1131\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1132\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1133\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>J</mi><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-110\">J(\\theta)</script> using trajectories sampled from the current policy.</li>\n  <li>Intuitively, the update increases the probability of actions that yield higher returns and decreases it for less rewarding ones.</li>\n</ul>\n<h4 id=\"reinforce-algorithm\">REINFORCE Algorithm</h4>\n<ul>\n  <li>The <strong>REINFORCE algorithm</strong> (<a href=\"https://www.sciencedirect.com/science/article/abs/pii/S0893608005800100\">Williams, 1992</a>) is the simplest and most influential policy gradient method.</li>\n  <li>It estimates the gradient using complete episodes of experience, updating the policy parameters as follows:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-111-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>&amp;#x2190;</mo><mi>&amp;#x03B8;</mi><mo>+</mo><mi>&amp;#x03B1;</mi><mo>,</mo><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><msub><mi>G</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1134\" style=\"width: 15.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 13.18em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1013.18em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1135\"><span class=\"mi\" id=\"MathJax-Span-1136\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1137\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üê</span><span class=\"mi\" id=\"MathJax-Span-1138\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1139\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-1140\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ±</span><span class=\"mo\" id=\"MathJax-Span-1141\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1142\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1143\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-1144\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-1145\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-1146\"></span><span class=\"msubsup\" id=\"MathJax-Span-1147\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1148\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1149\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1150\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1151\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1152\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1153\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1154\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-1155\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1156\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1157\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1158\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1159\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1160\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1161\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-1162\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>Œ∏</mi><mo stretchy=\"false\">‚Üê</mo><mi>Œ∏</mi><mo>+</mo><mi>Œ±</mi><mo>,</mo><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mi>log</mi><mo>‚Å°</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>,</mo><msub><mi>G</mi><mi>t</mi></msub></math></span></span></div>\n<ul>\n  <li>\n    <p>where:</p>\n\n    <ul>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-112-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1163\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1164\"><span class=\"mi\" id=\"MathJax-Span-1165\" style=\"font-family: STIXGeneral-Italic;\">Œ±</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ±</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-112\">\\alpha</script> is the learning rate,</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-113-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mi>t</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mi>t</mi></mrow></msup><msub><mi>r</mi><mi>k</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1166\" style=\"width: 8.232em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1006.83em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1167\"><span class=\"msubsup\" id=\"MathJax-Span-1168\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1169\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-1170\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1171\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-1172\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1173\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.52em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-1174\"><span class=\"mrow\" id=\"MathJax-Span-1175\"><span class=\"mi\" id=\"MathJax-Span-1176\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.1em, 4.169em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-1177\"><span class=\"mrow\" id=\"MathJax-Span-1178\"><span class=\"mi\" id=\"MathJax-Span-1179\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1180\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mi\" id=\"MathJax-Span-1181\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1182\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1183\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-1184\"><span class=\"mrow\" id=\"MathJax-Span-1185\"><span class=\"mi\" id=\"MathJax-Span-1186\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1187\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-1188\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1189\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1190\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1191\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mi>t</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>T</mi></mrow></munderover><msup><mi>Œ≥</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>‚àí</mo><mi>t</mi></mrow></msup><msub><mi>r</mi><mi>k</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-113\">G_t = \\sum_{k=t}^{T} \\gamma^{k-t} r_k</script> is the return following time <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-114-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1192\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1193\"><span class=\"mi\" id=\"MathJax-Span-1194\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-114\">t</script>.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The algorithm works by <em>reinforcing</em> (increasing the probability of) actions that lead to higher observed returns.</p>\n  </li>\n</ul>\n<p>where:</p>\n<ul>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-112-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B1;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1163\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1164\"><span class=\"mi\" id=\"MathJax-Span-1165\" style=\"font-family: STIXGeneral-Italic;\">Œ±</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ±</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-112\">\\alpha</script> is the learning rate,</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-113-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mi>t</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mi>t</mi></mrow></msup><msub><mi>r</mi><mi>k</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1166\" style=\"width: 8.232em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1006.83em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1167\"><span class=\"msubsup\" id=\"MathJax-Span-1168\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1169\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-1170\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1171\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-1172\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1173\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.52em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-1174\"><span class=\"mrow\" id=\"MathJax-Span-1175\"><span class=\"mi\" id=\"MathJax-Span-1176\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.1em, 4.169em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-1177\"><span class=\"mrow\" id=\"MathJax-Span-1178\"><span class=\"mi\" id=\"MathJax-Span-1179\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1180\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mi\" id=\"MathJax-Span-1181\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1182\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1183\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-1184\"><span class=\"mrow\" id=\"MathJax-Span-1185\"><span class=\"mi\" id=\"MathJax-Span-1186\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1187\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-1188\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1189\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1190\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1191\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mi>t</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>T</mi></mrow></munderover><msup><mi>Œ≥</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>‚àí</mo><mi>t</mi></mrow></msup><msub><mi>r</mi><mi>k</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-113\">G_t = \\sum_{k=t}^{T} \\gamma^{k-t} r_k</script> is the return following time <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-114-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1192\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1193\"><span class=\"mi\" id=\"MathJax-Span-1194\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-114\">t</script>.</li>\n    </ul>\n<p>The algorithm works by <em>reinforcing</em> (increasing the probability of) actions that lead to higher observed returns.</p>\n<h5 id=\"baseline-reduction\">Baseline Reduction</h5>\n<ul>\n  <li>Because the variance of gradient estimates can be large, REINFORCE often includes a <strong>baseline</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-115-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1195\" style=\"width: 2.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.77em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1196\"><span class=\"mi\" id=\"MathJax-Span-1197\" style=\"font-family: STIXGeneral-Italic;\">b</span><span class=\"mo\" id=\"MathJax-Span-1198\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1199\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1200\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1201\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1202\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>b</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-115\">b(s_t)</script>, typically the state value <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-116-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1203\" style=\"width: 3.076em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.555em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.5em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1204\"><span class=\"msubsup\" id=\"MathJax-Span-1205\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1206\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-1207\"><span class=\"mrow\" id=\"MathJax-Span-1208\"><span class=\"mi\" id=\"MathJax-Span-1209\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1210\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1211\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1212\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1213\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1214\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-116\">V^{\\pi}(s_t)</script>, to reduce variance without introducing bias:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-117-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>&amp;#x2190;</mo><mi>&amp;#x03B8;</mi><mo>+</mo><mi>&amp;#x03B1;</mi><mo>,</mo><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mo stretchy=&quot;false&quot;>[</mo><msub><mi>G</mi><mi>t</mi></msub><mo>&amp;#x2212;</mo><mi>b</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1215\" style=\"width: 20.159em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.773em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1016.67em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1216\"><span class=\"mi\" id=\"MathJax-Span-1217\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1218\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üê</span><span class=\"mi\" id=\"MathJax-Span-1219\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1220\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-1221\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ±</span><span class=\"mo\" id=\"MathJax-Span-1222\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1223\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1224\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-1225\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-1226\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-1227\"></span><span class=\"msubsup\" id=\"MathJax-Span-1228\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1229\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1230\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1231\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1232\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1233\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1234\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1235\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-1236\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1237\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1238\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1239\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1240\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-1241\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-1242\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1243\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-1244\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1245\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-1246\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">b</span><span class=\"mo\" id=\"MathJax-Span-1247\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1248\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1249\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1250\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1251\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1252\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>Œ∏</mi><mo stretchy=\"false\">‚Üê</mo><mi>Œ∏</mi><mo>+</mo><mi>Œ±</mi><mo>,</mo><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mi>log</mi><mo>‚Å°</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>,</mo><mo stretchy=\"false\">[</mo><msub><mi>G</mi><mi>t</mi></msub><mo>‚àí</mo><mi>b</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span></div>\n<ul>\n  <li>This concept laid the foundation for later <strong>actor‚Äìcritic</strong> methods, where the critic effectively serves as a learned baseline.</li>\n</ul>\n<h4 id=\"natural-policy-gradient-npg\">Natural Policy Gradient (NPG)</h4>\n<p>Standard gradient ascent can be inefficient in policy space due to curvature distortions caused by parameterization.\nThe <strong>Natural Policy Gradient</strong> method, introduced by <a href=\"https://proceedings.neurips.cc/paper_files/paper/2001/file/0158d89f54e956fb07627c17b3d7ac07-Paper.pdf\">Kakade (2001)</a>, addresses this by using the <strong>Fisher information matrix</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-118-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1253\" style=\"width: 2.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.77em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1254\"><span class=\"mi\" id=\"MathJax-Span-1255\" style=\"font-family: STIXGeneral-Italic;\">F<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1256\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1257\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1258\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>F</mi><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-118\">F(\\theta)</script> to compute updates invariant to the parameter scaling:</p>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-119-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>&amp;#x2190;</mo><mi>&amp;#x03B8;</mi><mo>+</mo><mi>&amp;#x03B1;</mi><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><msup><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1259\" style=\"width: 12.034em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.003em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1009.95em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1260\"><span class=\"mi\" id=\"MathJax-Span-1261\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1262\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üê</span><span class=\"mi\" id=\"MathJax-Span-1263\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1264\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-1265\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ±</span><span class=\"mi\" id=\"MathJax-Span-1266\" style=\"font-family: STIXGeneral-Italic;\">F<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1267\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1268\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-1269\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1270\" style=\"font-family: STIXGeneral-Regular;\">)</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-1271\"><span class=\"mrow\" id=\"MathJax-Span-1272\"><span class=\"mo\" id=\"MathJax-Span-1273\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"mn\" id=\"MathJax-Span-1274\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1275\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1276\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-1277\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-1278\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1279\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1280\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1281\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.441em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>Œ∏</mi><mo stretchy=\"false\">‚Üê</mo><mi>Œ∏</mi><mo>+</mo><mi>Œ±</mi><mi>F</mi><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><msup><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo>‚àí</mo><mn>1</mn></mrow></msup><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mi>J</mi><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo></math></span></span></div>\n<p>This ensures that updates are taken in directions that respect the geometry of the policy distribution, leading to faster and more stable convergence.</p>\n<h4 id=\"advantages-and-limitations\">Advantages and Limitations</h4>\n<ul>\n  <li>\n    <p><strong>Advantages:</strong></p>\n\n    <ul>\n      <li>Naturally handles continuous and stochastic action spaces.</li>\n      <li>Enables stochastic exploration without explicit noise.</li>\n      <li>Offers smooth policy improvement without discontinuities.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Limitations:</strong></p>\n\n    <ul>\n      <li>High variance in gradient estimates.</li>\n      <li>Often requires large numbers of trajectories for accurate estimation.</li>\n      <li>Sensitive to hyperparameters like learning rate and baseline design.</li>\n    </ul>\n  </li>\n</ul>\n<p><strong>Advantages:</strong></p>\n<ul>\n      <li>Naturally handles continuous and stochastic action spaces.</li>\n      <li>Enables stochastic exploration without explicit noise.</li>\n      <li>Offers smooth policy improvement without discontinuities.</li>\n    </ul>\n<p><strong>Limitations:</strong></p>\n<ul>\n      <li>High variance in gradient estimates.</li>\n      <li>Often requires large numbers of trajectories for accurate estimation.</li>\n      <li>Sensitive to hyperparameters like learning rate and baseline design.</li>\n    </ul>\n<h4 id=\"comparative-analysis-1\">Comparative Analysis</h4>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Method</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Core Idea</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Handles Continuous Actions</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Key Innovation</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Key References</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Policy Gradient (PG)</strong></td>\n<td class=\"tg-tleft-valign-first\">Optimize policy parameters via expected return gradient</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-first\">Policy Gradient Theorem</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://proceedings.neurips.cc/paper_files/paper/1999/file/464d828b85b0bed98e80ade0a5c43b0f-Paper.pdf\">Sutton et al. (2000)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>REINFORCE</strong></td>\n<td class=\"tg-tleft-valign-first\">Use sampled returns to update policy probabilities</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-first\">Monte Carlo estimation of policy gradient</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://www.sciencedirect.com/science/article/abs/pii/S0893608005800100\">Williams (1992)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Natural Policy Gradient</strong></td>\n<td class=\"tg-tleft-valign-first\">Adjust gradient using Fisher information for invariance</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-first\">Geometric optimization in policy space</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://proceedings.neurips.cc/paper_files/paper/2001/file/0158d89f54e956fb07627c17b3d7ac07-Paper.pdf\">Kakade (2001)</a></td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Method</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Core Idea</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Handles Continuous Actions</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Key Innovation</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Key References</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Policy Gradient (PG)</strong></td>\n<td class=\"tg-tleft-valign-first\">Optimize policy parameters via expected return gradient</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-first\">Policy Gradient Theorem</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://proceedings.neurips.cc/paper_files/paper/1999/file/464d828b85b0bed98e80ade0a5c43b0f-Paper.pdf\">Sutton et al. (2000)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>REINFORCE</strong></td>\n<td class=\"tg-tleft-valign-first\">Use sampled returns to update policy probabilities</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-first\">Monte Carlo estimation of policy gradient</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://www.sciencedirect.com/science/article/abs/pii/S0893608005800100\">Williams (1992)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Natural Policy Gradient</strong></td>\n<td class=\"tg-tleft-valign-first\">Adjust gradient using Fisher information for invariance</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-first\">Geometric optimization in policy space</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://proceedings.neurips.cc/paper_files/paper/2001/file/0158d89f54e956fb07627c17b3d7ac07-Paper.pdf\">Kakade (2001)</a></td>\n</tr>\n</tbody>\n</table>",
    "contentMarkdown": "*   While value-based methods focus on estimating the long-term value of states or state‚Äìaction pairs, **policy-based methods** take a more direct approach: they learn a **parameterized policy** that maps states to actions and optimize it to maximize expected return.\n    \n*   These methods are particularly useful in environments with **continuous or stochastic action spaces**, where value-based techniques like Q-learning are difficult to apply effectively.\n    \n\nWhile value-based methods focus on estimating the long-term value of states or state‚Äìaction pairs, **policy-based methods** take a more direct approach: they learn a **parameterized policy** that maps states to actions and optimize it to maximize expected return.\n\nThese methods are particularly useful in environments with **continuous or stochastic action spaces**, where value-based techniques like Q-learning are difficult to apply effectively.\n\n#### Policy Representation and Objective\n\n*   In policy-based reinforcement learning, the agent‚Äôs behavior is represented by a **stochastic policy** œÄŒ∏(a‚à£s)œÄŒ∏(a‚à£s)\\\\pi\\_\\\\theta(a \\\\mid s), parameterized by Œ∏Œ∏\\\\theta. The goal is to find parameters that maximize the expected return:\n\nJ(Œ∏)\\=ùîºœÄŒ∏\\[‚àët\\=0‚àûŒ≥trt\\]J(Œ∏)\\=EœÄŒ∏\\[‚àët\\=0‚àûŒ≥trt\\]\n\n*   Unlike value-based methods, which derive a policy indirectly from learned value estimates, policy-based approaches directly optimize this objective by computing its gradient with respect to the parameters Œ∏Œ∏\\\\theta.\n\n#### The Policy Gradient Theorem\n\n*   The key insight enabling policy optimization is the **Policy Gradient Theorem** ([Sutton et al., 2000](https://proceedings.neurips.cc/paper_files/paper/1999/file/464d828b85b0bed98e80ade0a5c43b0f-Paper.pdf)).\n*   It provides a way to estimate the gradient of the expected return without differentiating through the environment‚Äôs dynamics:\n\n‚àáŒ∏J(Œ∏)\\=ùîºœÄŒ∏\\[‚àáŒ∏logœÄŒ∏(at‚à£st)QœÄŒ∏(st,at)\\]‚àáŒ∏J(Œ∏)\\=EœÄŒ∏\\[‚àáŒ∏log‚Å°œÄŒ∏(at‚à£st)QœÄŒ∏(st,at)\\]\n\n*   This formulation allows gradient ascent on J(Œ∏)J(Œ∏)J(\\\\theta) using trajectories sampled from the current policy.\n*   Intuitively, the update increases the probability of actions that yield higher returns and decreases it for less rewarding ones.\n\n#### REINFORCE Algorithm\n\n*   The **REINFORCE algorithm** ([Williams, 1992](https://www.sciencedirect.com/science/article/abs/pii/S0893608005800100)) is the simplest and most influential policy gradient method.\n*   It estimates the gradient using complete episodes of experience, updating the policy parameters as follows:\n\nŒ∏‚ÜêŒ∏+Œ±,‚àáŒ∏logœÄŒ∏(at‚à£st),GtŒ∏‚ÜêŒ∏+Œ±,‚àáŒ∏log‚Å°œÄŒ∏(at‚à£st),Gt\n\n*   where:\n    \n    *   Œ±Œ±\\\\alpha is the learning rate,\n    *   Gt\\=‚àëTk\\=tŒ≥k‚àítrkGt\\=‚àëk\\=tTŒ≥k‚àítrkG\\_t = \\\\sum\\_{k=t}^{T} \\\\gamma^{k-t} r\\_k is the return following time ttt.\n*   The algorithm works by _reinforcing_ (increasing the probability of) actions that lead to higher observed returns.\n    \n\nwhere:\n\n*   Œ±Œ±\\\\alpha is the learning rate,\n*   Gt\\=‚àëTk\\=tŒ≥k‚àítrkGt\\=‚àëk\\=tTŒ≥k‚àítrkG\\_t = \\\\sum\\_{k=t}^{T} \\\\gamma^{k-t} r\\_k is the return following time ttt.\n\nThe algorithm works by _reinforcing_ (increasing the probability of) actions that lead to higher observed returns.\n\n##### Baseline Reduction\n\n*   Because the variance of gradient estimates can be large, REINFORCE often includes a **baseline** b(st)b(st)b(s\\_t), typically the state value VœÄ(st)VœÄ(st)V^{\\\\pi}(s\\_t), to reduce variance without introducing bias:\n\nŒ∏‚ÜêŒ∏+Œ±,‚àáŒ∏logœÄŒ∏(at‚à£st),\\[Gt‚àíb(st)\\]Œ∏‚ÜêŒ∏+Œ±,‚àáŒ∏log‚Å°œÄŒ∏(at‚à£st),\\[Gt‚àíb(st)\\]\n\n*   This concept laid the foundation for later **actor‚Äìcritic** methods, where the critic effectively serves as a learned baseline.\n\n#### Natural Policy Gradient (NPG)\n\nStandard gradient ascent can be inefficient in policy space due to curvature distortions caused by parameterization. The **Natural Policy Gradient** method, introduced by [Kakade (2001)](https://proceedings.neurips.cc/paper_files/paper/2001/file/0158d89f54e956fb07627c17b3d7ac07-Paper.pdf), addresses this by using the **Fisher information matrix** F(Œ∏)F(Œ∏)F(\\\\theta) to compute updates invariant to the parameter scaling:\n\nŒ∏‚ÜêŒ∏+Œ±F(Œ∏)‚àí1‚àáŒ∏J(Œ∏)Œ∏‚ÜêŒ∏+Œ±F(Œ∏)‚àí1‚àáŒ∏J(Œ∏)\n\nThis ensures that updates are taken in directions that respect the geometry of the policy distribution, leading to faster and more stable convergence.\n\n#### Advantages and Limitations\n\n*   **Advantages:**\n    \n    *   Naturally handles continuous and stochastic action spaces.\n    *   Enables stochastic exploration without explicit noise.\n    *   Offers smooth policy improvement without discontinuities.\n*   **Limitations:**\n    \n    *   High variance in gradient estimates.\n    *   Often requires large numbers of trajectories for accurate estimation.\n    *   Sensitive to hyperparameters like learning rate and baseline design.\n\n**Advantages:**\n\n*   Naturally handles continuous and stochastic action spaces.\n*   Enables stochastic exploration without explicit noise.\n*   Offers smooth policy improvement without discontinuities.\n\n**Limitations:**\n\n*   High variance in gradient estimates.\n*   Often requires large numbers of trajectories for accurate estimation.\n*   Sensitive to hyperparameters like learning rate and baseline design.\n\n#### Comparative Analysis\n\n**Method**\n\n**Core Idea**\n\n**Handles Continuous Actions**\n\n**Key Innovation**\n\n**Key References**\n\n**Policy Gradient (PG)**\n\nOptimize policy parameters via expected return gradient\n\nYes\n\nPolicy Gradient Theorem\n\n[Sutton et al. (2000)](https://proceedings.neurips.cc/paper_files/paper/1999/file/464d828b85b0bed98e80ade0a5c43b0f-Paper.pdf)\n\n**REINFORCE**\n\nUse sampled returns to update policy probabilities\n\nYes\n\nMonte Carlo estimation of policy gradient\n\n[Williams (1992)](https://www.sciencedirect.com/science/article/abs/pii/S0893608005800100)\n\n**Natural Policy Gradient**\n\nAdjust gradient using Fisher information for invariance\n\nYes\n\nGeometric optimization in policy space\n\n[Kakade (2001)](https://proceedings.neurips.cc/paper_files/paper/2001/file/0158d89f54e956fb07627c17b3d7ac07-Paper.pdf)\n\n**Method**\n\n**Core Idea**\n\n**Handles Continuous Actions**\n\n**Key Innovation**\n\n**Key References**\n\n**Policy Gradient (PG)**\n\nOptimize policy parameters via expected return gradient\n\nYes\n\nPolicy Gradient Theorem\n\n[Sutton et al. (2000)](https://proceedings.neurips.cc/paper_files/paper/1999/file/464d828b85b0bed98e80ade0a5c43b0f-Paper.pdf)\n\n**REINFORCE**\n\nUse sampled returns to update policy probabilities\n\nYes\n\nMonte Carlo estimation of policy gradient\n\n[Williams (1992)](https://www.sciencedirect.com/science/article/abs/pii/S0893608005800100)\n\n**Natural Policy Gradient**\n\nAdjust gradient using Fisher information for invariance\n\nYes\n\nGeometric optimization in policy space\n\n[Kakade (2001)](https://proceedings.neurips.cc/paper_files/paper/2001/file/0158d89f54e956fb07627c17b3d7ac07-Paper.pdf)",
    "order": 10,
    "orderInChapter": 2,
    "difficulty": 4,
    "estimatedMinutes": 4,
    "tags": [
      "algorithmsarchitecture",
      "reinforcement learning",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 729,
      "contentLength": 85689
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#policy-based-methods",
    "scrapedAt": "2025-12-28T11:47:08.459Z"
  },
  {
    "id": "ai-reinforcement-learning-actorcritic-methods-11",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Types of Reinforcement Learning",
    "title": "Actor‚ÄìCritic Methods",
    "subtitle": "Types of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>Actor‚ÄìCritic methods</strong> bridge the conceptual gap between value-based and policy-based reinforcement learning.\nWhile <strong>policy-based methods</strong> optimize the policy directly and <strong>value-based methods</strong> estimate the expected return, actor‚Äìcritic frameworks do both simultaneously.</p>\n  </li>\n  <li>\n    <p>They maintain two distinct components:</p>\n\n    <ul>\n      <li>The <strong>Actor</strong>, which updates the policy parameters in the direction suggested by the critic‚Äôs evaluation.</li>\n      <li>The <strong>Critic</strong>, which estimates value functions and provides a baseline to stabilize and guide policy updates.</li>\n    </ul>\n  </li>\n  <li>\n    <p>This architecture allows actor‚Äìcritic methods to combine the <strong>low variance</strong> of value-based updates with the <strong>expressive flexibility</strong> of policy-based optimization.</p>\n  </li>\n</ul>\n<p><strong>Actor‚ÄìCritic methods</strong> bridge the conceptual gap between value-based and policy-based reinforcement learning.\nWhile <strong>policy-based methods</strong> optimize the policy directly and <strong>value-based methods</strong> estimate the expected return, actor‚Äìcritic frameworks do both simultaneously.</p>\n<p>They maintain two distinct components:</p>\n<ul>\n      <li>The <strong>Actor</strong>, which updates the policy parameters in the direction suggested by the critic‚Äôs evaluation.</li>\n      <li>The <strong>Critic</strong>, which estimates value functions and provides a baseline to stabilize and guide policy updates.</li>\n    </ul>\n<p>This architecture allows actor‚Äìcritic methods to combine the <strong>low variance</strong> of value-based updates with the <strong>expressive flexibility</strong> of policy-based optimization.</p>\n<h4 id=\"conceptual-foundation\">Conceptual Foundation</h4>\n<ul>\n  <li>The actor‚Äìcritic approach builds upon the <strong>policy gradient theorem</strong> and <strong>temporal difference (TD)</strong> learning.</li>\n  <li>\n    <p>At time <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-120-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1282\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1283\"><span class=\"mi\" id=\"MathJax-Span-1284\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-120\">t</script>, the policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-121-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1285\" style=\"width: 4.013em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.336em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.28em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1286\"><span class=\"msubsup\" id=\"MathJax-Span-1287\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1288\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1289\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1290\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1291\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-1292\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-1293\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1294\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-121\">\\pi_\\theta(a \\mid s)</script> selects an action, and the critic evaluates it using a value function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-122-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>w</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1295\" style=\"width: 2.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.14em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1296\"><span class=\"msubsup\" id=\"MathJax-Span-1297\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1298\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1299\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1300\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1301\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1302\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>w</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-122\">V_w(s)</script> or <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-123-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>Q</mi><mi>w</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1303\" style=\"width: 3.909em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.232em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.18em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1304\"><span class=\"msubsup\" id=\"MathJax-Span-1305\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1306\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-1307\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1308\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1309\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1310\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1311\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1312\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>Q</mi><mi>w</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-123\">Q_w(s,a)</script>, parameterized by weights <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-124-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1313\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.73em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1314\"><span class=\"mi\" id=\"MathJax-Span-1315\" style=\"font-family: STIXGeneral-Italic;\">w</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>w</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-124\">w</script>.</p>\n  </li>\n  <li>\n    <p>The actor updates its policy parameters according to:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-125-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>&amp;#x2190;</mo><mi>&amp;#x03B8;</mi><mo>+</mo><mi>&amp;#x03B1;</mi><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><msub><mi>&amp;#x03B4;</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1316\" style=\"width: 14.951em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.451em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1012.45em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1317\"><span class=\"mi\" id=\"MathJax-Span-1318\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1319\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üê</span><span class=\"mi\" id=\"MathJax-Span-1320\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1321\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-1322\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ±</span><span class=\"msubsup\" id=\"MathJax-Span-1323\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1324\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-1325\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-1326\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-1327\"></span><span class=\"msubsup\" id=\"MathJax-Span-1328\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1329\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1330\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1331\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1332\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1333\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1334\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1335\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-1336\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1337\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1338\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1339\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1340\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1341\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1342\" style=\"font-family: STIXGeneral-Italic;\">Œ¥</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-1343\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>Œ∏</mi><mo stretchy=\"false\">‚Üê</mo><mi>Œ∏</mi><mo>+</mo><mi>Œ±</mi><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mi>log</mi><mo>‚Å°</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>,</mo><msub><mi>Œ¥</mi><mi>t</mi></msub></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-125\">\\theta \\leftarrow \\theta + \\alpha \\nabla_\\theta \\log \\pi_\\theta(a_t \\mid s_t) , \\delta_t</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-126-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B4;</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1344\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.73em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1345\"><span class=\"msubsup\" id=\"MathJax-Span-1346\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1347\" style=\"font-family: STIXGeneral-Italic;\">Œ¥</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-1348\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>Œ¥</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-126\">\\delta_t</script> is the <strong>TD error</strong>, defined as:</li>\n    </ul>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-127-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>&amp;#x03B4;</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>&amp;#x03B3;</mi><msub><mi>V</mi><mi>w</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>V</mi><mi>w</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1349\" style=\"width: 14.378em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 11.982em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1011.93em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1350\"><span class=\"msubsup\" id=\"MathJax-Span-1351\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1352\" style=\"font-family: STIXGeneral-Italic;\">Œ¥</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-1353\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1354\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-1355\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1356\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1357\"><span class=\"mrow\" id=\"MathJax-Span-1358\"><span class=\"mi\" id=\"MathJax-Span-1359\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1360\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-1361\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1362\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-1363\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-1364\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1365\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1366\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1367\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1368\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1369\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1370\"><span class=\"mrow\" id=\"MathJax-Span-1371\"><span class=\"mi\" id=\"MathJax-Span-1372\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1373\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-1374\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1375\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1376\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-1377\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1378\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1379\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1380\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1381\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1382\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1383\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1384\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>Œ¥</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>Œ≥</mi><msub><mi>V</mi><mi>w</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>V</mi><mi>w</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-127\">\\delta_t = r_{t+1} + \\gamma V_w(s_{t+1}) - V_w(s_t)</script>\n  </li>\n  <li>This TD error acts as a <strong>critic signal</strong>, indicating whether the action taken was better or worse than expected.</li>\n</ul>\n<p>At time <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-120-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1282\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1283\"><span class=\"mi\" id=\"MathJax-Span-1284\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-120\">t</script>, the policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-121-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1285\" style=\"width: 4.013em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.336em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.28em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1286\"><span class=\"msubsup\" id=\"MathJax-Span-1287\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1288\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1289\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1290\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1291\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-1292\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-1293\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1294\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-121\">\\pi_\\theta(a \\mid s)</script> selects an action, and the critic evaluates it using a value function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-122-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>w</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1295\" style=\"width: 2.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.14em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1296\"><span class=\"msubsup\" id=\"MathJax-Span-1297\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1298\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1299\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1300\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1301\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1302\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>w</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-122\">V_w(s)</script> or <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-123-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>Q</mi><mi>w</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1303\" style=\"width: 3.909em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.232em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.18em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1304\"><span class=\"msubsup\" id=\"MathJax-Span-1305\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1306\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-1307\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1308\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1309\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1310\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1311\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1312\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>Q</mi><mi>w</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-123\">Q_w(s,a)</script>, parameterized by weights <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-124-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1313\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.73em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1314\"><span class=\"mi\" id=\"MathJax-Span-1315\" style=\"font-family: STIXGeneral-Italic;\">w</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>w</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-124\">w</script>.</p>\n<p>The actor updates its policy parameters according to:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-126-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03B4;</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1344\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.73em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1345\"><span class=\"msubsup\" id=\"MathJax-Span-1346\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1347\" style=\"font-family: STIXGeneral-Italic;\">Œ¥</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-1348\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>Œ¥</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-126\">\\delta_t</script> is the <strong>TD error</strong>, defined as:</li>\n    </ul>\n<h4 id=\"the-advantage-function\">The Advantage Function</h4>\n<ul>\n  <li>To improve stability and efficiency, actor‚Äìcritic methods often use the <strong>advantage function</strong>, which measures how much better an action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-128-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1385\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1386\"><span class=\"mi\" id=\"MathJax-Span-1387\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-128\">a</script> is compared to the average action in a given state:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-129-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1388\" style=\"width: 12.919em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1010.68em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1389\"><span class=\"msubsup\" id=\"MathJax-Span-1390\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1391\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1392\"><span class=\"mrow\" id=\"MathJax-Span-1393\"><span class=\"mi\" id=\"MathJax-Span-1394\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1395\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1396\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1397\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1398\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1399\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1400\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-1401\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1402\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-1403\"><span class=\"mrow\" id=\"MathJax-Span-1404\"><span class=\"mi\" id=\"MathJax-Span-1405\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1406\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1407\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1408\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1409\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1410\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1411\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-1412\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1413\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-1414\"><span class=\"mrow\" id=\"MathJax-Span-1415\"><span class=\"mi\" id=\"MathJax-Span-1416\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1417\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1418\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1419\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>A</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span></div>\n<ul>\n  <li>Using the advantage function instead of raw returns reduces variance in policy gradient estimates, leading to smoother learning.</li>\n  <li>The resulting update rule becomes:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-130-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><msup><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1420\" style=\"width: 20.159em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.773em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.878em, 1016.62em, 3.44em, -999.997em); top: -2.914em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1421\"><span class=\"msubsup\" id=\"MathJax-Span-1422\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1423\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-1424\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-1425\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1426\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1427\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1428\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1429\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-1430\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-1431\"><span class=\"mrow\" id=\"MathJax-Span-1432\"><span class=\"mi\" id=\"MathJax-Span-1433\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1434\"><span class=\"mrow\" id=\"MathJax-Span-1435\"><span class=\"msubsup\" id=\"MathJax-Span-1436\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1437\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1438\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-1439\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-1440\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-1441\"><span class=\"msubsup\" id=\"MathJax-Span-1442\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1443\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-1444\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-1445\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-1446\"></span><span class=\"msubsup\" id=\"MathJax-Span-1447\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1448\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1449\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1450\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1451\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1452\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1453\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1454\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-1455\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1456\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1457\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1458\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-1459\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1460\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1461\"><span class=\"mrow\" id=\"MathJax-Span-1462\"><span class=\"mi\" id=\"MathJax-Span-1463\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1464\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1465\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1466\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1467\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1468\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1469\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1470\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1471\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1472\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-1473\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.919em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mi>J</mi><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mi>log</mi><mo>‚Å°</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><msup><mi>A</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div>\n<ul>\n  <li>This formulation unifies the <strong>critic‚Äôs evaluative feedback</strong> with the <strong>actor‚Äôs improvement mechanism</strong>.</li>\n</ul>\n<h4 id=\"classical-actorcritic-algorithms\">Classical Actor‚ÄìCritic Algorithms</h4>\n<ul>\n  <li>The actor‚Äìcritic paradigm originated with the <strong>Adaptive Heuristic Critic (AHC)</strong> architecture proposed by <a href=\"https://www.sciencedirect.com/science/article/abs/pii/S0893608005800136\">Barto, Sutton &amp; Anderson (1983)</a>.</li>\n  <li>\n    <p>It introduced the two-network idea ‚Äî one learning to evaluate (critic) and another learning to control (actor).</p>\n  </li>\n  <li>\n    <p>Subsequent developments expanded this framework into more specialized variants:</p>\n\n    <ol>\n      <li>\n        <p><strong>Incremental Natural Actor‚ÄìCritic (INAC)</strong>: Proposed by <a href=\"https://www.jmlr.org/papers/volume7/peters06a/peters06a.pdf\">Peters &amp; Schaal (2008)</a>, INAC integrated natural gradient concepts (from <a href=\"https://proceedings.neurips.cc/paper_files/paper/2001/file/0158d89f54e956fb07627c17b3d7ac07-Paper.pdf\">Kakade, 2001</a>) to improve convergence stability in actor‚Äìcritic settings.</p>\n      </li>\n      <li>\n        <p><strong>Continuous Actor‚ÄìCritic Learning Automaton (CACLA)</strong>: Introduced by <a href=\"https://link.springer.com/article/10.1007/s10458-007-9028-0\">Van Hasselt &amp; Wiering (2007)</a>, CACLA extended actor‚Äìcritic methods to continuous action domains by updating the actor only when the TD error is positive ‚Äî i.e., when the action performed better than expected.</p>\n      </li>\n      <li>\n        <p><strong>Asynchronous Advantage Actor‚ÄìCritic (A3C)</strong>: Although later extended into deep RL, its theoretical roots lie in classical actor‚Äìcritic formulations. The A3C framework applied parallelism to stabilize policy updates based on advantage estimation, conceptually descending from earlier work on synchronous actor‚Äìcritic learning.</p>\n      </li>\n    </ol>\n  </li>\n</ul>\n<p>It introduced the two-network idea ‚Äî one learning to evaluate (critic) and another learning to control (actor).</p>\n<p>Subsequent developments expanded this framework into more specialized variants:</p>\n<ol>\n      <li>\n        <p><strong>Incremental Natural Actor‚ÄìCritic (INAC)</strong>: Proposed by <a href=\"https://www.jmlr.org/papers/volume7/peters06a/peters06a.pdf\">Peters &amp; Schaal (2008)</a>, INAC integrated natural gradient concepts (from <a href=\"https://proceedings.neurips.cc/paper_files/paper/2001/file/0158d89f54e956fb07627c17b3d7ac07-Paper.pdf\">Kakade, 2001</a>) to improve convergence stability in actor‚Äìcritic settings.</p>\n      </li>\n      <li>\n        <p><strong>Continuous Actor‚ÄìCritic Learning Automaton (CACLA)</strong>: Introduced by <a href=\"https://link.springer.com/article/10.1007/s10458-007-9028-0\">Van Hasselt &amp; Wiering (2007)</a>, CACLA extended actor‚Äìcritic methods to continuous action domains by updating the actor only when the TD error is positive ‚Äî i.e., when the action performed better than expected.</p>\n      </li>\n      <li>\n        <p><strong>Asynchronous Advantage Actor‚ÄìCritic (A3C)</strong>: Although later extended into deep RL, its theoretical roots lie in classical actor‚Äìcritic formulations. The A3C framework applied parallelism to stabilize policy updates based on advantage estimation, conceptually descending from earlier work on synchronous actor‚Äìcritic learning.</p>\n      </li>\n    </ol>\n<p><strong>Incremental Natural Actor‚ÄìCritic (INAC)</strong>: Proposed by <a href=\"https://www.jmlr.org/papers/volume7/peters06a/peters06a.pdf\">Peters &amp; Schaal (2008)</a>, INAC integrated natural gradient concepts (from <a href=\"https://proceedings.neurips.cc/paper_files/paper/2001/file/0158d89f54e956fb07627c17b3d7ac07-Paper.pdf\">Kakade, 2001</a>) to improve convergence stability in actor‚Äìcritic settings.</p>\n<p><strong>Continuous Actor‚ÄìCritic Learning Automaton (CACLA)</strong>: Introduced by <a href=\"https://link.springer.com/article/10.1007/s10458-007-9028-0\">Van Hasselt &amp; Wiering (2007)</a>, CACLA extended actor‚Äìcritic methods to continuous action domains by updating the actor only when the TD error is positive ‚Äî i.e., when the action performed better than expected.</p>\n<p><strong>Asynchronous Advantage Actor‚ÄìCritic (A3C)</strong>: Although later extended into deep RL, its theoretical roots lie in classical actor‚Äìcritic formulations. The A3C framework applied parallelism to stabilize policy updates based on advantage estimation, conceptually descending from earlier work on synchronous actor‚Äìcritic learning.</p>\n<h4 id=\"policy-evaluation-and-improvement-cycle\">Policy Evaluation and Improvement Cycle</h4>\n<ul>\n  <li>\n    <p>Actor‚ÄìCritic algorithms can be seen as implementing a <strong>generalized policy iteration (GPI)</strong> process ‚Äî alternating between:</p>\n\n    <ol>\n      <li>\n        <p><strong>Policy Evaluation:</strong> The critic estimates <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-131-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1474\" style=\"width: 2.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.19em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1475\"><span class=\"msubsup\" id=\"MathJax-Span-1476\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1477\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-1478\"><span class=\"mrow\" id=\"MathJax-Span-1479\"><span class=\"mi\" id=\"MathJax-Span-1480\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1481\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1482\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1483\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-131\">V^{\\pi}(s)</script> or <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-132-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1484\" style=\"width: 3.857em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.18em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.13em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1485\"><span class=\"msubsup\" id=\"MathJax-Span-1486\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1487\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-1488\"><span class=\"mrow\" id=\"MathJax-Span-1489\"><span class=\"mi\" id=\"MathJax-Span-1490\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1491\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1492\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1493\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1494\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1495\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-132\">Q^{\\pi}(s,a)</script> using TD learning or Monte Carlo rollouts.</p>\n      </li>\n      <li>\n        <p><strong>Policy Improvement:</strong> The actor updates <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-133-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1496\" style=\"width: 4.013em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.336em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.28em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1497\"><span class=\"msubsup\" id=\"MathJax-Span-1498\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1499\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1500\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1501\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1502\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-1503\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-1504\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1505\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-133\">\\pi_\\theta(a \\mid s)</script> using gradient ascent based on the critic‚Äôs feedback.</p>\n      </li>\n    </ol>\n  </li>\n  <li>\n    <p>This dynamic mirrors classical <strong>policy iteration</strong> by <a href=\"https://pubsonline.informs.org/doi/10.1287/opre.8.6.716\">Howard (1960)</a>, but operates incrementally and stochastically, enabling online learning in complex environments.</p>\n  </li>\n</ul>\n<p>Actor‚ÄìCritic algorithms can be seen as implementing a <strong>generalized policy iteration (GPI)</strong> process ‚Äî alternating between:</p>\n<ol>\n      <li>\n        <p><strong>Policy Evaluation:</strong> The critic estimates <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-131-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1474\" style=\"width: 2.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.19em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1475\"><span class=\"msubsup\" id=\"MathJax-Span-1476\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1477\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-1478\"><span class=\"mrow\" id=\"MathJax-Span-1479\"><span class=\"mi\" id=\"MathJax-Span-1480\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1481\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1482\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1483\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-131\">V^{\\pi}(s)</script> or <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-132-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1484\" style=\"width: 3.857em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.18em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.13em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1485\"><span class=\"msubsup\" id=\"MathJax-Span-1486\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1487\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-1488\"><span class=\"mrow\" id=\"MathJax-Span-1489\"><span class=\"mi\" id=\"MathJax-Span-1490\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1491\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1492\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1493\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1494\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1495\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-132\">Q^{\\pi}(s,a)</script> using TD learning or Monte Carlo rollouts.</p>\n      </li>\n      <li>\n        <p><strong>Policy Improvement:</strong> The actor updates <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-133-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1496\" style=\"width: 4.013em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.336em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.28em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1497\"><span class=\"msubsup\" id=\"MathJax-Span-1498\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1499\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1500\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1501\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1502\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-1503\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-1504\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1505\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-133\">\\pi_\\theta(a \\mid s)</script> using gradient ascent based on the critic‚Äôs feedback.</p>\n      </li>\n    </ol>\n<p><strong>Policy Evaluation:</strong> The critic estimates <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-131-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1474\" style=\"width: 2.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.19em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1475\"><span class=\"msubsup\" id=\"MathJax-Span-1476\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1477\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-1478\"><span class=\"mrow\" id=\"MathJax-Span-1479\"><span class=\"mi\" id=\"MathJax-Span-1480\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1481\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1482\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1483\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-131\">V^{\\pi}(s)</script> or <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-132-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1484\" style=\"width: 3.857em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.18em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.13em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1485\"><span class=\"msubsup\" id=\"MathJax-Span-1486\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1487\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-1488\"><span class=\"mrow\" id=\"MathJax-Span-1489\"><span class=\"mi\" id=\"MathJax-Span-1490\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1491\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1492\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1493\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1494\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1495\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-132\">Q^{\\pi}(s,a)</script> using TD learning or Monte Carlo rollouts.</p>\n<p><strong>Policy Improvement:</strong> The actor updates <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-133-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1496\" style=\"width: 4.013em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.336em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.28em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1497\"><span class=\"msubsup\" id=\"MathJax-Span-1498\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1499\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1500\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1501\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1502\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-1503\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-1504\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1505\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-133\">\\pi_\\theta(a \\mid s)</script> using gradient ascent based on the critic‚Äôs feedback.</p>\n<p>This dynamic mirrors classical <strong>policy iteration</strong> by <a href=\"https://pubsonline.informs.org/doi/10.1287/opre.8.6.716\">Howard (1960)</a>, but operates incrementally and stochastically, enabling online learning in complex environments.</p>\n<h4 id=\"advantages-and-limitations-1\">Advantages and Limitations</h4>\n<ul>\n  <li>\n    <p><strong>Advantages</strong>:</p>\n\n    <ul>\n      <li>Combines the strengths of policy and value methods (low bias, low variance).</li>\n      <li>Suitable for continuous action spaces.</li>\n      <li>Supports online and incremental learning.</li>\n      <li>Naturally extends to partially observable and stochastic domains.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Limitations</strong>:</p>\n\n    <ul>\n      <li>Sensitive to critic accuracy; unstable when critic is poorly estimated.</li>\n      <li>Requires careful tuning of learning rates for actor and critic.</li>\n      <li>Can exhibit oscillatory dynamics if updates are not synchronized.</li>\n    </ul>\n  </li>\n</ul>\n<p><strong>Advantages</strong>:</p>\n<ul>\n      <li>Combines the strengths of policy and value methods (low bias, low variance).</li>\n      <li>Suitable for continuous action spaces.</li>\n      <li>Supports online and incremental learning.</li>\n      <li>Naturally extends to partially observable and stochastic domains.</li>\n    </ul>\n<p><strong>Limitations</strong>:</p>\n<ul>\n      <li>Sensitive to critic accuracy; unstable when critic is poorly estimated.</li>\n      <li>Requires careful tuning of learning rates for actor and critic.</li>\n      <li>Can exhibit oscillatory dynamics if updates are not synchronized.</li>\n    </ul>\n<h4 id=\"comparative-analysis-2\">Comparative Analysis</h4>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Method</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Core Idea</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Advantage Function</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Continuous Actions</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Key References</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Actor‚ÄìCritic (AHC)</strong></td>\n<td class=\"tg-tleft-valign-first\">Two-network structure: actor (policy) and critic (value)</td>\n<td class=\"tg-tleft-valign-first\">Optional</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://www.sciencedirect.com/science/article/abs/pii/S0893608005800136\">Barto, Sutton &amp; Anderson (1983)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>INAC</strong></td>\n<td class=\"tg-tleft-valign-first\">Combines actor‚Äìcritic with natural gradients for stability</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://www.jmlr.org/papers/volume7/peters06a/peters06a.pdf\">Peters &amp; Schaal (2008)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>CACLA</strong></td>\n<td class=\"tg-tleft-valign-first\">Updates actor only for positive TD errors</td>\n<td class=\"tg-tleft-valign-first\">Implicit</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://link.springer.com/article/10.1007/s10458-007-9028-0\">Van Hasselt &amp; Wiering (2007)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>GPI View</strong></td>\n<td class=\"tg-tleft-valign-first\">Alternating evaluation and improvement loops</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-first\">General</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://pubsonline.informs.org/doi/10.1287/opre.8.6.716\">Howard (1960)</a></td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Method</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Core Idea</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Advantage Function</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Continuous Actions</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Key References</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Actor‚ÄìCritic (AHC)</strong></td>\n<td class=\"tg-tleft-valign-first\">Two-network structure: actor (policy) and critic (value)</td>\n<td class=\"tg-tleft-valign-first\">Optional</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://www.sciencedirect.com/science/article/abs/pii/S0893608005800136\">Barto, Sutton &amp; Anderson (1983)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>INAC</strong></td>\n<td class=\"tg-tleft-valign-first\">Combines actor‚Äìcritic with natural gradients for stability</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://www.jmlr.org/papers/volume7/peters06a/peters06a.pdf\">Peters &amp; Schaal (2008)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>CACLA</strong></td>\n<td class=\"tg-tleft-valign-first\">Updates actor only for positive TD errors</td>\n<td class=\"tg-tleft-valign-first\">Implicit</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://link.springer.com/article/10.1007/s10458-007-9028-0\">Van Hasselt &amp; Wiering (2007)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>GPI View</strong></td>\n<td class=\"tg-tleft-valign-first\">Alternating evaluation and improvement loops</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-first\">General</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://pubsonline.informs.org/doi/10.1287/opre.8.6.716\">Howard (1960)</a></td>\n</tr>\n</tbody>\n</table>",
    "contentMarkdown": "*   **Actor‚ÄìCritic methods** bridge the conceptual gap between value-based and policy-based reinforcement learning. While **policy-based methods** optimize the policy directly and **value-based methods** estimate the expected return, actor‚Äìcritic frameworks do both simultaneously.\n    \n*   They maintain two distinct components:\n    \n    *   The **Actor**, which updates the policy parameters in the direction suggested by the critic‚Äôs evaluation.\n    *   The **Critic**, which estimates value functions and provides a baseline to stabilize and guide policy updates.\n*   This architecture allows actor‚Äìcritic methods to combine the **low variance** of value-based updates with the **expressive flexibility** of policy-based optimization.\n    \n\n**Actor‚ÄìCritic methods** bridge the conceptual gap between value-based and policy-based reinforcement learning. While **policy-based methods** optimize the policy directly and **value-based methods** estimate the expected return, actor‚Äìcritic frameworks do both simultaneously.\n\nThey maintain two distinct components:\n\n*   The **Actor**, which updates the policy parameters in the direction suggested by the critic‚Äôs evaluation.\n*   The **Critic**, which estimates value functions and provides a baseline to stabilize and guide policy updates.\n\nThis architecture allows actor‚Äìcritic methods to combine the **low variance** of value-based updates with the **expressive flexibility** of policy-based optimization.\n\n#### Conceptual Foundation\n\n*   The actor‚Äìcritic approach builds upon the **policy gradient theorem** and **temporal difference (TD)** learning.\n*   At time ttt, the policy œÄŒ∏(a‚à£s)œÄŒ∏(a‚à£s)\\\\pi\\_\\\\theta(a \\\\mid s) selects an action, and the critic evaluates it using a value function Vw(s)Vw(s)V\\_w(s) or Qw(s,a)Qw(s,a)Q\\_w(s,a), parameterized by weights www.\n    \n*   The actor updates its policy parameters according to:\n    \n    Œ∏‚ÜêŒ∏+Œ±‚àáŒ∏logœÄŒ∏(at‚à£st),Œ¥tŒ∏‚ÜêŒ∏+Œ±‚àáŒ∏log‚Å°œÄŒ∏(at‚à£st),Œ¥t\n    \n    \\\\theta \\\\leftarrow \\\\theta + \\\\alpha \\\\nabla\\_\\\\theta \\\\log \\\\pi\\_\\\\theta(a\\_t \\\\mid s\\_t) , \\\\delta\\_t\n    \n    *   where Œ¥tŒ¥t\\\\delta\\_t is the **TD error**, defined as:\n    \n    Œ¥t\\=rt+1+Œ≥Vw(st+1)‚àíVw(st)Œ¥t\\=rt+1+Œ≥Vw(st+1)‚àíVw(st)\n    \n    \\\\delta\\_t = r\\_{t+1} + \\\\gamma V\\_w(s\\_{t+1}) - V\\_w(s\\_t)\n*   This TD error acts as a **critic signal**, indicating whether the action taken was better or worse than expected.\n\nAt time ttt, the policy œÄŒ∏(a‚à£s)œÄŒ∏(a‚à£s)\\\\pi\\_\\\\theta(a \\\\mid s) selects an action, and the critic evaluates it using a value function Vw(s)Vw(s)V\\_w(s) or Qw(s,a)Qw(s,a)Q\\_w(s,a), parameterized by weights www.\n\nThe actor updates its policy parameters according to:\n\n*   where Œ¥tŒ¥t\\\\delta\\_t is the **TD error**, defined as:\n\n#### The Advantage Function\n\n*   To improve stability and efficiency, actor‚Äìcritic methods often use the **advantage function**, which measures how much better an action aaa is compared to the average action in a given state:\n\nAœÄ(s,a)\\=QœÄ(s,a)‚àíVœÄ(s)AœÄ(s,a)\\=QœÄ(s,a)‚àíVœÄ(s)\n\n*   Using the advantage function instead of raw returns reduces variance in policy gradient estimates, leading to smoother learning.\n*   The resulting update rule becomes:\n\n‚àáŒ∏J(Œ∏)\\=ùîºœÄŒ∏\\[‚àáŒ∏logœÄŒ∏(at‚à£st)AœÄ(st,at)\\]‚àáŒ∏J(Œ∏)\\=EœÄŒ∏\\[‚àáŒ∏log‚Å°œÄŒ∏(at‚à£st)AœÄ(st,at)\\]\n\n*   This formulation unifies the **critic‚Äôs evaluative feedback** with the **actor‚Äôs improvement mechanism**.\n\n#### Classical Actor‚ÄìCritic Algorithms\n\n*   The actor‚Äìcritic paradigm originated with the **Adaptive Heuristic Critic (AHC)** architecture proposed by [Barto, Sutton & Anderson (1983)](https://www.sciencedirect.com/science/article/abs/pii/S0893608005800136).\n*   It introduced the two-network idea ‚Äî one learning to evaluate (critic) and another learning to control (actor).\n    \n*   Subsequent developments expanded this framework into more specialized variants:\n    \n    1.  **Incremental Natural Actor‚ÄìCritic (INAC)**: Proposed by [Peters & Schaal (2008)](https://www.jmlr.org/papers/volume7/peters06a/peters06a.pdf), INAC integrated natural gradient concepts (from [Kakade, 2001](https://proceedings.neurips.cc/paper_files/paper/2001/file/0158d89f54e956fb07627c17b3d7ac07-Paper.pdf)) to improve convergence stability in actor‚Äìcritic settings.\n        \n    2.  **Continuous Actor‚ÄìCritic Learning Automaton (CACLA)**: Introduced by [Van Hasselt & Wiering (2007)](https://link.springer.com/article/10.1007/s10458-007-9028-0), CACLA extended actor‚Äìcritic methods to continuous action domains by updating the actor only when the TD error is positive ‚Äî i.e., when the action performed better than expected.\n        \n    3.  **Asynchronous Advantage Actor‚ÄìCritic (A3C)**: Although later extended into deep RL, its theoretical roots lie in classical actor‚Äìcritic formulations. The A3C framework applied parallelism to stabilize policy updates based on advantage estimation, conceptually descending from earlier work on synchronous actor‚Äìcritic learning.\n        \n\nIt introduced the two-network idea ‚Äî one learning to evaluate (critic) and another learning to control (actor).\n\nSubsequent developments expanded this framework into more specialized variants:\n\n1.  **Incremental Natural Actor‚ÄìCritic (INAC)**: Proposed by [Peters & Schaal (2008)](https://www.jmlr.org/papers/volume7/peters06a/peters06a.pdf), INAC integrated natural gradient concepts (from [Kakade, 2001](https://proceedings.neurips.cc/paper_files/paper/2001/file/0158d89f54e956fb07627c17b3d7ac07-Paper.pdf)) to improve convergence stability in actor‚Äìcritic settings.\n    \n2.  **Continuous Actor‚ÄìCritic Learning Automaton (CACLA)**: Introduced by [Van Hasselt & Wiering (2007)](https://link.springer.com/article/10.1007/s10458-007-9028-0), CACLA extended actor‚Äìcritic methods to continuous action domains by updating the actor only when the TD error is positive ‚Äî i.e., when the action performed better than expected.\n    \n3.  **Asynchronous Advantage Actor‚ÄìCritic (A3C)**: Although later extended into deep RL, its theoretical roots lie in classical actor‚Äìcritic formulations. The A3C framework applied parallelism to stabilize policy updates based on advantage estimation, conceptually descending from earlier work on synchronous actor‚Äìcritic learning.\n    \n\n**Incremental Natural Actor‚ÄìCritic (INAC)**: Proposed by [Peters & Schaal (2008)](https://www.jmlr.org/papers/volume7/peters06a/peters06a.pdf), INAC integrated natural gradient concepts (from [Kakade, 2001](https://proceedings.neurips.cc/paper_files/paper/2001/file/0158d89f54e956fb07627c17b3d7ac07-Paper.pdf)) to improve convergence stability in actor‚Äìcritic settings.\n\n**Continuous Actor‚ÄìCritic Learning Automaton (CACLA)**: Introduced by [Van Hasselt & Wiering (2007)](https://link.springer.com/article/10.1007/s10458-007-9028-0), CACLA extended actor‚Äìcritic methods to continuous action domains by updating the actor only when the TD error is positive ‚Äî i.e., when the action performed better than expected.\n\n**Asynchronous Advantage Actor‚ÄìCritic (A3C)**: Although later extended into deep RL, its theoretical roots lie in classical actor‚Äìcritic formulations. The A3C framework applied parallelism to stabilize policy updates based on advantage estimation, conceptually descending from earlier work on synchronous actor‚Äìcritic learning.\n\n#### Policy Evaluation and Improvement Cycle\n\n*   Actor‚ÄìCritic algorithms can be seen as implementing a **generalized policy iteration (GPI)** process ‚Äî alternating between:\n    \n    1.  **Policy Evaluation:** The critic estimates VœÄ(s)VœÄ(s)V^{\\\\pi}(s) or QœÄ(s,a)QœÄ(s,a)Q^{\\\\pi}(s,a) using TD learning or Monte Carlo rollouts.\n        \n    2.  **Policy Improvement:** The actor updates œÄŒ∏(a‚à£s)œÄŒ∏(a‚à£s)\\\\pi\\_\\\\theta(a \\\\mid s) using gradient ascent based on the critic‚Äôs feedback.\n        \n*   This dynamic mirrors classical **policy iteration** by [Howard (1960)](https://pubsonline.informs.org/doi/10.1287/opre.8.6.716), but operates incrementally and stochastically, enabling online learning in complex environments.\n    \n\nActor‚ÄìCritic algorithms can be seen as implementing a **generalized policy iteration (GPI)** process ‚Äî alternating between:\n\n1.  **Policy Evaluation:** The critic estimates VœÄ(s)VœÄ(s)V^{\\\\pi}(s) or QœÄ(s,a)QœÄ(s,a)Q^{\\\\pi}(s,a) using TD learning or Monte Carlo rollouts.\n    \n2.  **Policy Improvement:** The actor updates œÄŒ∏(a‚à£s)œÄŒ∏(a‚à£s)\\\\pi\\_\\\\theta(a \\\\mid s) using gradient ascent based on the critic‚Äôs feedback.\n    \n\n**Policy Evaluation:** The critic estimates VœÄ(s)VœÄ(s)V^{\\\\pi}(s) or QœÄ(s,a)QœÄ(s,a)Q^{\\\\pi}(s,a) using TD learning or Monte Carlo rollouts.\n\n**Policy Improvement:** The actor updates œÄŒ∏(a‚à£s)œÄŒ∏(a‚à£s)\\\\pi\\_\\\\theta(a \\\\mid s) using gradient ascent based on the critic‚Äôs feedback.\n\nThis dynamic mirrors classical **policy iteration** by [Howard (1960)](https://pubsonline.informs.org/doi/10.1287/opre.8.6.716), but operates incrementally and stochastically, enabling online learning in complex environments.\n\n#### Advantages and Limitations\n\n*   **Advantages**:\n    \n    *   Combines the strengths of policy and value methods (low bias, low variance).\n    *   Suitable for continuous action spaces.\n    *   Supports online and incremental learning.\n    *   Naturally extends to partially observable and stochastic domains.\n*   **Limitations**:\n    \n    *   Sensitive to critic accuracy; unstable when critic is poorly estimated.\n    *   Requires careful tuning of learning rates for actor and critic.\n    *   Can exhibit oscillatory dynamics if updates are not synchronized.\n\n**Advantages**:\n\n*   Combines the strengths of policy and value methods (low bias, low variance).\n*   Suitable for continuous action spaces.\n*   Supports online and incremental learning.\n*   Naturally extends to partially observable and stochastic domains.\n\n**Limitations**:\n\n*   Sensitive to critic accuracy; unstable when critic is poorly estimated.\n*   Requires careful tuning of learning rates for actor and critic.\n*   Can exhibit oscillatory dynamics if updates are not synchronized.\n\n#### Comparative Analysis\n\n**Method**\n\n**Core Idea**\n\n**Advantage Function**\n\n**Continuous Actions**\n\n**Key References**\n\n**Actor‚ÄìCritic (AHC)**\n\nTwo-network structure: actor (policy) and critic (value)\n\nOptional\n\nYes\n\n[Barto, Sutton & Anderson (1983)](https://www.sciencedirect.com/science/article/abs/pii/S0893608005800136)\n\n**INAC**\n\nCombines actor‚Äìcritic with natural gradients for stability\n\nYes\n\nYes\n\n[Peters & Schaal (2008)](https://www.jmlr.org/papers/volume7/peters06a/peters06a.pdf)\n\n**CACLA**\n\nUpdates actor only for positive TD errors\n\nImplicit\n\nYes\n\n[Van Hasselt & Wiering (2007)](https://link.springer.com/article/10.1007/s10458-007-9028-0)\n\n**GPI View**\n\nAlternating evaluation and improvement loops\n\nYes\n\nGeneral\n\n[Howard (1960)](https://pubsonline.informs.org/doi/10.1287/opre.8.6.716)\n\n**Method**\n\n**Core Idea**\n\n**Advantage Function**\n\n**Continuous Actions**\n\n**Key References**\n\n**Actor‚ÄìCritic (AHC)**\n\nTwo-network structure: actor (policy) and critic (value)\n\nOptional\n\nYes\n\n[Barto, Sutton & Anderson (1983)](https://www.sciencedirect.com/science/article/abs/pii/S0893608005800136)\n\n**INAC**\n\nCombines actor‚Äìcritic with natural gradients for stability\n\nYes\n\nYes\n\n[Peters & Schaal (2008)](https://www.jmlr.org/papers/volume7/peters06a/peters06a.pdf)\n\n**CACLA**\n\nUpdates actor only for positive TD errors\n\nImplicit\n\nYes\n\n[Van Hasselt & Wiering (2007)](https://link.springer.com/article/10.1007/s10458-007-9028-0)\n\n**GPI View**\n\nAlternating evaluation and improvement loops\n\nYes\n\nGeneral\n\n[Howard (1960)](https://pubsonline.informs.org/doi/10.1287/opre.8.6.716)",
    "order": 11,
    "orderInChapter": 3,
    "difficulty": 4,
    "estimatedMinutes": 7,
    "tags": [
      "algorithmsarchitecture",
      "reinforcement learning",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 1256,
      "contentLength": 99818
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#actor‚Äìcritic-methods",
    "scrapedAt": "2025-12-28T11:47:08.459Z"
  },
  {
    "id": "ai-reinforcement-learning-model-based-reinforcement-learning-12",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Types of Reinforcement Learning",
    "title": "Model-Based Reinforcement Learning",
    "subtitle": "Types of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>Model-Based Reinforcement Learning (MBRL)</strong> refers to a family of techniques that explicitly learn or exploit a <strong>model of the environment‚Äôs dynamics</strong> to predict future states and rewards, enabling planning and sample-efficient policy optimization.\nUnlike model-free methods that learn purely from experience, model-based approaches <strong>simulate</strong> potential futures to guide decision-making.</p>\n  </li>\n  <li>\n    <p>This distinction makes model-based methods conceptually closer to <strong>optimal control theory</strong> and <strong>planning algorithms</strong> used in operations research and robotics.</p>\n  </li>\n</ul>\n<p><strong>Model-Based Reinforcement Learning (MBRL)</strong> refers to a family of techniques that explicitly learn or exploit a <strong>model of the environment‚Äôs dynamics</strong> to predict future states and rewards, enabling planning and sample-efficient policy optimization.\nUnlike model-free methods that learn purely from experience, model-based approaches <strong>simulate</strong> potential futures to guide decision-making.</p>\n<p>This distinction makes model-based methods conceptually closer to <strong>optimal control theory</strong> and <strong>planning algorithms</strong> used in operations research and robotics.</p>\n<h4 id=\"the-environment-model\">The Environment Model</h4>\n<ul>\n  <li>\n    <p>The central concept in model-based RL is the <strong>Markov Decision Process (MDP) model</strong>, represented by:</p>\n\n    <ul>\n      <li><strong>Transition Function:</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-134-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2223;</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>Pr</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>S</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2223;</mo><msub><mi>S</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi><mo>,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1506\" style=\"width: 20.003em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.669em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1016.62em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1507\"><span class=\"mi\" id=\"MathJax-Span-1508\" style=\"font-family: STIXGeneral-Italic;\">P</span><span class=\"mo\" id=\"MathJax-Span-1509\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-1510\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1511\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1512\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1513\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-1514\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1515\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1516\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1517\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1518\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-1519\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">Pr</span><span class=\"mo\" id=\"MathJax-Span-1520\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1521\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1522\" style=\"font-family: STIXGeneral-Italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-1523\"><span class=\"mrow\" id=\"MathJax-Span-1524\"><span class=\"mi\" id=\"MathJax-Span-1525\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1526\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-1527\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1528\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msup\" id=\"MathJax-Span-1529\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1530\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1531\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1532\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-1533\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1534\" style=\"font-family: STIXGeneral-Italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1535\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1536\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-1537\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1538\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1539\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1540\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1541\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1542\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-1543\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1544\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>P</mi><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>‚à£</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo movablelimits=\"true\" form=\"prefix\">Pr</mo><mo stretchy=\"false\">(</mo><msub><mi>S</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>‚à£</mo><msub><mi>S</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi><mo>,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-134\">P(s' \\mid s,a) = \\Pr(S_{t+1}=s' \\mid S_t=s, A_t=a)</script></li>\n      <li><strong>Reward Function:</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-135-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>&amp;#x2223;</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1545\" style=\"width: 10.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 8.805em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1008.7em, 2.711em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1546\"><span class=\"mi\" id=\"MathJax-Span-1547\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-1548\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1549\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1550\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1551\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1552\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1553\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-1554\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-1555\"><span class=\"mi\" id=\"MathJax-Span-1556\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span class=\"mo\" id=\"MathJax-Span-1557\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-1558\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1559\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1560\"><span class=\"mrow\" id=\"MathJax-Span-1561\"><span class=\"mi\" id=\"MathJax-Span-1562\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1563\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-1564\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1565\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-1566\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1567\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1568\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1569\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mo stretchy=\"false\">[</mo><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>‚à£</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-135\">R(s,a) = \\mathbb{E}[r_{t+1} \\mid s,a]</script></li>\n    </ul>\n  </li>\n  <li>\n    <p>With access to these functions, one can compute <strong>expected returns</strong>, plan trajectories, and compute optimal policies using classical algorithms such as <strong>Value Iteration</strong> and <strong>Policy Iteration</strong> introduced by <a href=\"https://pubsonline.informs.org/doi/10.1287/opre.8.6.716\">Howard (1960)</a>.</p>\n  </li>\n  <li>\n    <p>The model can either be:</p>\n\n    <ol>\n      <li><strong>Given (known dynamics):</strong> The environment is fully specified, as in many simulated domains.</li>\n      <li><strong>Learned (unknown dynamics):</strong> The agent estimates <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-136-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2223;</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1570\" style=\"width: 4.951em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.117em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1004.07em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1571\"><span class=\"mi\" id=\"MathJax-Span-1572\" style=\"font-family: STIXGeneral-Italic;\">P</span><span class=\"mo\" id=\"MathJax-Span-1573\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-1574\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1575\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1576\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1577\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-1578\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1579\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1580\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1581\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>P</mi><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>‚à£</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-136\">P(s' \\mid s,a)</script> and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-137-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1582\" style=\"width: 3.232em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.61em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1583\"><span class=\"mi\" id=\"MathJax-Span-1584\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-1585\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1586\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1587\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1588\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1589\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-137\">R(s,a)</script> from collected experience.</li>\n    </ol>\n  </li>\n</ul>\n<p>The central concept in model-based RL is the <strong>Markov Decision Process (MDP) model</strong>, represented by:</p>\n<ul>\n      <li><strong>Transition Function:</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-134-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2223;</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>Pr</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>S</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2223;</mo><msub><mi>S</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi><mo>,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1506\" style=\"width: 20.003em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.669em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1016.62em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1507\"><span class=\"mi\" id=\"MathJax-Span-1508\" style=\"font-family: STIXGeneral-Italic;\">P</span><span class=\"mo\" id=\"MathJax-Span-1509\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-1510\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1511\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1512\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1513\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-1514\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1515\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1516\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1517\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1518\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-1519\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">Pr</span><span class=\"mo\" id=\"MathJax-Span-1520\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1521\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1522\" style=\"font-family: STIXGeneral-Italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-1523\"><span class=\"mrow\" id=\"MathJax-Span-1524\"><span class=\"mi\" id=\"MathJax-Span-1525\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1526\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-1527\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1528\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msup\" id=\"MathJax-Span-1529\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1530\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1531\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1532\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-1533\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1534\" style=\"font-family: STIXGeneral-Italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1535\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1536\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-1537\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1538\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1539\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1540\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-1541\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1542\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-1543\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1544\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>P</mi><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>‚à£</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo movablelimits=\"true\" form=\"prefix\">Pr</mo><mo stretchy=\"false\">(</mo><msub><mi>S</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>‚à£</mo><msub><mi>S</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi><mo>,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-134\">P(s' \\mid s,a) = \\Pr(S_{t+1}=s' \\mid S_t=s, A_t=a)</script></li>\n      <li><strong>Reward Function:</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-135-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>&amp;#x2223;</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1545\" style=\"width: 10.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 8.805em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1008.7em, 2.711em, -999.997em); top: -2.341em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1546\"><span class=\"mi\" id=\"MathJax-Span-1547\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-1548\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1549\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1550\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1551\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1552\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1553\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-1554\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-1555\"><span class=\"mi\" id=\"MathJax-Span-1556\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span class=\"mo\" id=\"MathJax-Span-1557\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-1558\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1559\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1560\"><span class=\"mrow\" id=\"MathJax-Span-1561\"><span class=\"mi\" id=\"MathJax-Span-1562\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1563\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-1564\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1565\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-1566\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1567\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1568\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1569\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.346em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mo stretchy=\"false\">[</mo><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>‚à£</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-135\">R(s,a) = \\mathbb{E}[r_{t+1} \\mid s,a]</script></li>\n    </ul>\n<p>With access to these functions, one can compute <strong>expected returns</strong>, plan trajectories, and compute optimal policies using classical algorithms such as <strong>Value Iteration</strong> and <strong>Policy Iteration</strong> introduced by <a href=\"https://pubsonline.informs.org/doi/10.1287/opre.8.6.716\">Howard (1960)</a>.</p>\n<p>The model can either be:</p>\n<ol>\n      <li><strong>Given (known dynamics):</strong> The environment is fully specified, as in many simulated domains.</li>\n      <li><strong>Learned (unknown dynamics):</strong> The agent estimates <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-136-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2223;</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1570\" style=\"width: 4.951em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.117em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1004.07em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1571\"><span class=\"mi\" id=\"MathJax-Span-1572\" style=\"font-family: STIXGeneral-Italic;\">P</span><span class=\"mo\" id=\"MathJax-Span-1573\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-1574\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1575\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1576\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1577\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-1578\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1579\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1580\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1581\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>P</mi><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>‚à£</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-136\">P(s' \\mid s,a)</script> and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-137-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1582\" style=\"width: 3.232em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.61em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1583\"><span class=\"mi\" id=\"MathJax-Span-1584\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-1585\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1586\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1587\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1588\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1589\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-137\">R(s,a)</script> from collected experience.</li>\n    </ol>\n<h4 id=\"planning-with-a-model\">Planning with a Model</h4>\n<ul>\n  <li>Given a known model, the agent can perform <strong>planning</strong> ‚Äî evaluating and improving policies without interacting with the real environment.</li>\n  <li>This is accomplished by recursively solving the <strong>Bellman Optimality Equation</strong>:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-138-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>V</mi><mo>&amp;#x2217;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>a</mi></munder><mrow><mo>[</mo><mrow><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B3;</mi><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup></mrow></munder><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2223;</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><msup><mi>V</mi><mo>&amp;#x2217;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1590\" style=\"width: 23.336em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 19.43em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1019.12em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1591\"><span class=\"msubsup\" id=\"MathJax-Span-1592\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1593\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.784em;\"><span class=\"mo\" id=\"MathJax-Span-1594\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àó</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1595\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1596\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1597\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1598\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-1599\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1600\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.273em, -999.997em); top: -3.331em; left: 0.68em;\"><span class=\"mi\" id=\"MathJax-Span-1601\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-1602\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-1603\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-1604\"><span class=\"mi\" id=\"MathJax-Span-1605\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-1606\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1607\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1608\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1609\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1610\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1611\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-1612\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"munderover\" id=\"MathJax-Span-1613\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1614\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1000.52em, 4.273em, -999.997em); top: -2.81em; left: 0.419em;\"><span class=\"texatom\" id=\"MathJax-Span-1615\"><span class=\"mrow\" id=\"MathJax-Span-1616\"><span class=\"msup\" id=\"MathJax-Span-1617\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1618\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.263em;\"><span class=\"mo\" id=\"MathJax-Span-1619\" style=\"font-size: 50%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-1620\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">P</span><span class=\"mo\" id=\"MathJax-Span-1621\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-1622\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1623\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1624\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1625\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-1626\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1627\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1628\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1629\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-1630\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1631\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.784em;\"><span class=\"mo\" id=\"MathJax-Span-1632\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àó</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1633\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-1634\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1635\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1636\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1637\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-1638\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>V</mi><mo>‚àó</mo></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>a</mi></munder><mrow><mo>[</mo><mrow><mi>R</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>Œ≥</mi><munder><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><msup><mi>s</mi><mo>‚Ä≤</mo></msup></mrow></munder><mi>P</mi><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>‚à£</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><msup><mi>V</mi><mo>‚àó</mo></msup><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div>\n<ul>\n  <li>and deriving the corresponding optimal policy:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-139-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>&amp;#x03C0;</mi><mo>&amp;#x2217;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mi>a</mi></munder><mrow><mo>[</mo><mrow><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B3;</mi><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup></mrow></munder><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2223;</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><msup><mi>V</mi><mo>&amp;#x2217;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1639\" style=\"width: 24.898em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 20.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1020.42em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1640\"><span class=\"msubsup\" id=\"MathJax-Span-1641\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1642\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.576em;\"><span class=\"mo\" id=\"MathJax-Span-1643\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àó</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1644\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1645\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1646\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1647\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-1648\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-1649\"></span><span class=\"munderover\" id=\"MathJax-Span-1650\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1651\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.273em, -999.997em); top: -3.331em; left: 0.68em;\"><span class=\"mi\" id=\"MathJax-Span-1652\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-1653\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-1654\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-1655\"><span class=\"mi\" id=\"MathJax-Span-1656\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-1657\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1658\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1659\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1660\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1661\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1662\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-1663\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"munderover\" id=\"MathJax-Span-1664\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1665\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1000.52em, 4.273em, -999.997em); top: -2.81em; left: 0.419em;\"><span class=\"texatom\" id=\"MathJax-Span-1666\"><span class=\"mrow\" id=\"MathJax-Span-1667\"><span class=\"msup\" id=\"MathJax-Span-1668\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1669\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.263em;\"><span class=\"mo\" id=\"MathJax-Span-1670\" style=\"font-size: 50%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-1671\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">P</span><span class=\"mo\" id=\"MathJax-Span-1672\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-1673\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1674\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1675\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1676\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-1677\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1678\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1679\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1680\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-1681\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1682\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.784em;\"><span class=\"mo\" id=\"MathJax-Span-1683\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àó</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1684\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-1685\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1686\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1687\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1688\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-1689\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>œÄ</mi><mo>‚àó</mo></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mi>a</mi></munder><mrow><mo>[</mo><mrow><mi>R</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>Œ≥</mi><munder><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><msup><mi>s</mi><mo>‚Ä≤</mo></msup></mrow></munder><mi>P</mi><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>‚à£</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><msup><mi>V</mi><mo>‚àó</mo></msup><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div>\n<ul>\n  <li>This class of methods, encompassing <strong>policy iteration</strong> and <strong>value iteration</strong>, forms the foundation of model-based reasoning and exact planning in small-scale or deterministic environments.</li>\n</ul>\n<h4 id=\"learning-the-model\">Learning the Model</h4>\n<ul>\n  <li>In more realistic settings, the transition and reward models are not known a priori.</li>\n  <li>In such cases, the agent must <strong>learn an approximate model</strong> from experience:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-140-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>P</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2223;</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2248;</mo><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2223;</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mspace width=&quot;1em&quot; /><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>R</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2248;</mo><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1690\" style=\"width: 21.044em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 17.503em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1017.45em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1691\"><span class=\"texatom\" id=\"MathJax-Span-1692\"><span class=\"mrow\" id=\"MathJax-Span-1693\"><span class=\"munderover\" id=\"MathJax-Span-1694\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1695\" style=\"font-family: STIXGeneral-Italic;\">P</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1696\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1697\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-1698\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1699\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1700\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1701\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-1702\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1703\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1704\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1705\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1706\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚âà</span><span class=\"mi\" id=\"MathJax-Span-1707\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">P</span><span class=\"mo\" id=\"MathJax-Span-1708\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-1709\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1710\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1711\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1712\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-1713\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1714\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1715\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1716\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1717\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mspace\" id=\"MathJax-Span-1718\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"texatom\" id=\"MathJax-Span-1719\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-1720\"><span class=\"munderover\" id=\"MathJax-Span-1721\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1722\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1723\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1724\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1725\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1726\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1727\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1728\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1729\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚âà</span><span class=\"mi\" id=\"MathJax-Span-1730\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">R</span><span class=\"mo\" id=\"MathJax-Span-1731\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1732\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1733\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1734\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1735\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>P</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>‚à£</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>‚âà</mo><mi>P</mi><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>‚à£</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>,</mo><mspace width=\"1em\"></mspace><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>R</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>‚âà</mo><mi>R</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span></div>\n<ul>\n  <li>\n    <p>Learning these models transforms the RL problem into a <strong>supervised learning</strong> task, where the goal is to predict next states and rewards from observed transitions <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-141-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>,</mo><mi>r</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1736\" style=\"width: 4.794em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.961em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1003.91em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1737\"><span class=\"mo\" id=\"MathJax-Span-1738\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1739\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1740\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1741\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1742\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-1743\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1744\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1745\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1746\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1747\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1748\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>,</mo><mi>r</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-141\">(s,a,s',r)</script>.</p>\n  </li>\n  <li>\n    <p>Model-learning can use:</p>\n\n    <ul>\n      <li><strong>Tabular frequency estimates</strong> (in small discrete environments),</li>\n      <li><strong>Regression or Gaussian processes</strong> (<a href=\"https://proceedings.neurips.cc/paper_files/paper/2011/file/7eb3c8be3d63a64a7f7e6f0ce9350b84-Paper.pdf\">Deisenroth &amp; Rasmussen, 2011</a>),</li>\n      <li>or <strong>function approximators</strong> (in continuous spaces).</li>\n    </ul>\n  </li>\n</ul>\n<p>Learning these models transforms the RL problem into a <strong>supervised learning</strong> task, where the goal is to predict next states and rewards from observed transitions <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-141-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>,</mo><mi>r</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1736\" style=\"width: 4.794em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.961em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1003.91em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1737\"><span class=\"mo\" id=\"MathJax-Span-1738\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1739\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1740\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1741\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1742\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-1743\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1744\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1745\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1746\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1747\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1748\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>,</mo><mi>r</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-141\">(s,a,s',r)</script>.</p>\n<p>Model-learning can use:</p>\n<ul>\n      <li><strong>Tabular frequency estimates</strong> (in small discrete environments),</li>\n      <li><strong>Regression or Gaussian processes</strong> (<a href=\"https://proceedings.neurips.cc/paper_files/paper/2011/file/7eb3c8be3d63a64a7f7e6f0ce9350b84-Paper.pdf\">Deisenroth &amp; Rasmussen, 2011</a>),</li>\n      <li>or <strong>function approximators</strong> (in continuous spaces).</li>\n    </ul>\n<h4 id=\"the-dyna-architecture\">The Dyna Architecture</h4>\n<ul>\n  <li>\n    <p>A seminal hybrid framework combining <strong>learning, planning, and acting</strong> was proposed in <strong>Dyna</strong> by <a href=\"https://www.researchgate.net/publication/220320601_Integrated_Architectures_for_Learning_Planning_and_Reactive_Control\">Sutton (1990)</a>.\nDyna integrates:</p>\n\n    <ol>\n      <li><strong>Model learning:</strong> Build an internal model from experience.</li>\n      <li><strong>Planning:</strong> Generate synthetic experiences from the model to update the value function.</li>\n      <li><strong>Real experience:</strong> Continue updating from actual environment interactions.</li>\n    </ol>\n  </li>\n  <li>\n    <p>This allows the agent to perform <strong>imaginary rollouts</strong> using its learned model, accelerating learning while maintaining adaptability.</p>\n  </li>\n  <li>\n    <p>Formally, Dyna‚Äôs process alternates between:</p>\n\n    <ul>\n      <li>\n        <p><strong>Direct reinforcement learning update</strong> (from real experiences):</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-142-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>&amp;#x2190;</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B1;</mi><mo stretchy=&quot;false&quot;>[</mo><mi>r</mi><mo>+</mo><mi>&amp;#x03B3;</mi><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup></mrow></munder><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>,</mo><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1749\" style=\"width: 24.846em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 20.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1020.58em, 3.18em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1750\"><span class=\"mi\" id=\"MathJax-Span-1751\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-1752\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1753\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1754\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1755\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1756\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1757\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üê</span><span class=\"mi\" id=\"MathJax-Span-1758\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Q</span><span class=\"mo\" id=\"MathJax-Span-1759\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1760\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1761\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1762\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1763\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1764\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-1765\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ±</span><span class=\"mo\" id=\"MathJax-Span-1766\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mi\" id=\"MathJax-Span-1767\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1768\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-1769\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"munderover\" id=\"MathJax-Span-1770\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1771\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1000.58em, 4.273em, -999.997em); top: -3.279em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-1772\"><span class=\"mrow\" id=\"MathJax-Span-1773\"><span class=\"msup\" id=\"MathJax-Span-1774\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1775\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1776\" style=\"font-size: 50%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-1777\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">Q</span><span class=\"mo\" id=\"MathJax-Span-1778\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-1779\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1780\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1781\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1782\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-1783\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1784\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-1785\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1786\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1787\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-1788\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Q</span><span class=\"mo\" id=\"MathJax-Span-1789\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1790\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1791\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1792\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1793\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1794\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.059em; border-left: 0px solid; width: 0px; height: 2.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">‚Üê</mo><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>Œ±</mi><mo stretchy=\"false\">[</mo><mi>r</mi><mo>+</mo><mi>Œ≥</mi><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mrow class=\"MJX-TeXAtom-ORD\"><msup><mi>a</mi><mo>‚Ä≤</mo></msup></mrow></munder><mi>Q</mi><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>,</mo><msup><mi>a</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-142\">Q(s,a) \\leftarrow Q(s,a) + \\alpha [r + \\gamma \\max_{a'} Q(s',a') - Q(s,a)]</script>\n      </li>\n      <li>\n        <p><strong>Simulated updates</strong> (using the learned model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-143-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>P</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>R</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1795\" style=\"width: 2.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1001.72em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1796\"><span class=\"texatom\" id=\"MathJax-Span-1797\"><span class=\"mrow\" id=\"MathJax-Span-1798\"><span class=\"munderover\" id=\"MathJax-Span-1799\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1800\" style=\"font-family: STIXGeneral-Italic;\">P</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1801\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1802\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-1803\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-1804\"><span class=\"munderover\" id=\"MathJax-Span-1805\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1806\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1807\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.441em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>P</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>R</mi><mo stretchy=\"false\">^</mo></mover></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-143\">\\hat{P}, \\hat{R}</script>):</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-144-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>Q</mi><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>&amp;#x2190;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>Q</mi><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B1;</mi><mo stretchy=&quot;false&quot;>[</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>R</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B3;</mi><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup></mrow></munder><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>Q</mi><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>s</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>&amp;#x2032;</mo></msup><mo>,</mo><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>Q</mi><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1808\" style=\"width: 27.607em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 22.971em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1022.87em, 3.18em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1809\"><span class=\"texatom\" id=\"MathJax-Span-1810\"><span class=\"mrow\" id=\"MathJax-Span-1811\"><span class=\"munderover\" id=\"MathJax-Span-1812\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1813\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.211em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.419em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1814\" style=\"font-family: STIXGeneral-Regular;\">ÃÉ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1815\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1816\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1817\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1818\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1819\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1820\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üê</span><span class=\"texatom\" id=\"MathJax-Span-1821\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-1822\"><span class=\"munderover\" id=\"MathJax-Span-1823\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1824\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.211em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.419em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1825\" style=\"font-family: STIXGeneral-Regular;\">ÃÉ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1826\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1827\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1828\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1829\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1830\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1831\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-1832\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ±</span><span class=\"mo\" id=\"MathJax-Span-1833\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"texatom\" id=\"MathJax-Span-1834\"><span class=\"mrow\" id=\"MathJax-Span-1835\"><span class=\"munderover\" id=\"MathJax-Span-1836\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1837\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1838\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1839\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1840\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1841\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1842\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1843\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1844\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-1845\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"munderover\" id=\"MathJax-Span-1846\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1847\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1000.58em, 4.273em, -999.997em); top: -3.279em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-1848\"><span class=\"mrow\" id=\"MathJax-Span-1849\"><span class=\"msup\" id=\"MathJax-Span-1850\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1851\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1852\" style=\"font-size: 50%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-1853\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-1854\"><span class=\"munderover\" id=\"MathJax-Span-1855\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1856\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.211em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.419em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1857\" style=\"font-family: STIXGeneral-Regular;\">ÃÉ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1858\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-1859\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.128em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-1860\"><span class=\"mrow\" id=\"MathJax-Span-1861\"><span class=\"munderover\" id=\"MathJax-Span-1862\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1863\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1864\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.477em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1865\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1866\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-1867\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1868\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-1869\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1870\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1871\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"texatom\" id=\"MathJax-Span-1872\" style=\"padding-left: 0.263em;\"><span class=\"mrow\" id=\"MathJax-Span-1873\"><span class=\"munderover\" id=\"MathJax-Span-1874\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1875\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.211em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.419em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1876\" style=\"font-family: STIXGeneral-Regular;\">ÃÉ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1877\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1878\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1879\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1880\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1881\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1882\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.059em; border-left: 0px solid; width: 0px; height: 2.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>Q</mi><mo stretchy=\"false\">~</mo></mover></mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">‚Üê</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>Q</mi><mo stretchy=\"false\">~</mo></mover></mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>Œ±</mi><mo stretchy=\"false\">[</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>R</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>Œ≥</mi><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mrow class=\"MJX-TeXAtom-ORD\"><msup><mi>a</mi><mo>‚Ä≤</mo></msup></mrow></munder><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>Q</mi><mo stretchy=\"false\">~</mo></mover></mrow><mo stretchy=\"false\">(</mo><msup><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>s</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>‚Ä≤</mo></msup><mo>,</mo><msup><mi>a</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>Q</mi><mo stretchy=\"false\">~</mo></mover></mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-144\">\\tilde{Q}(s,a) \\leftarrow \\tilde{Q}(s,a) + \\alpha [\\hat{R}(s,a) + \\gamma \\max_{a'} \\tilde{Q}(\\hat{s}',a') - \\tilde{Q}(s,a)]</script>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>This integration of <strong>planning and learning</strong> was foundational to later sample-efficient RL systems.</p>\n  </li>\n</ul>\n<p>A seminal hybrid framework combining <strong>learning, planning, and acting</strong> was proposed in <strong>Dyna</strong> by <a href=\"https://www.researchgate.net/publication/220320601_Integrated_Architectures_for_Learning_Planning_and_Reactive_Control\">Sutton (1990)</a>.\nDyna integrates:</p>\n<ol>\n      <li><strong>Model learning:</strong> Build an internal model from experience.</li>\n      <li><strong>Planning:</strong> Generate synthetic experiences from the model to update the value function.</li>\n      <li><strong>Real experience:</strong> Continue updating from actual environment interactions.</li>\n    </ol>\n<p>This allows the agent to perform <strong>imaginary rollouts</strong> using its learned model, accelerating learning while maintaining adaptability.</p>\n<p>Formally, Dyna‚Äôs process alternates between:</p>\n<ul>\n      <li>\n        <p><strong>Direct reinforcement learning update</strong> (from real experiences):</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-142-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>&amp;#x2190;</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B1;</mi><mo stretchy=&quot;false&quot;>[</mo><mi>r</mi><mo>+</mo><mi>&amp;#x03B3;</mi><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup></mrow></munder><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>,</mo><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1749\" style=\"width: 24.846em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 20.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1020.58em, 3.18em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1750\"><span class=\"mi\" id=\"MathJax-Span-1751\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-1752\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1753\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1754\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1755\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1756\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1757\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üê</span><span class=\"mi\" id=\"MathJax-Span-1758\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Q</span><span class=\"mo\" id=\"MathJax-Span-1759\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1760\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1761\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1762\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1763\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1764\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-1765\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ±</span><span class=\"mo\" id=\"MathJax-Span-1766\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mi\" id=\"MathJax-Span-1767\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1768\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-1769\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"munderover\" id=\"MathJax-Span-1770\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1771\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1000.58em, 4.273em, -999.997em); top: -3.279em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-1772\"><span class=\"mrow\" id=\"MathJax-Span-1773\"><span class=\"msup\" id=\"MathJax-Span-1774\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1775\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1776\" style=\"font-size: 50%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-1777\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">Q</span><span class=\"mo\" id=\"MathJax-Span-1778\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-1779\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1780\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1781\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1782\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-1783\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1784\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-1785\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1786\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1787\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-1788\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Q</span><span class=\"mo\" id=\"MathJax-Span-1789\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1790\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1791\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1792\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1793\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1794\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.059em; border-left: 0px solid; width: 0px; height: 2.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">‚Üê</mo><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>Œ±</mi><mo stretchy=\"false\">[</mo><mi>r</mi><mo>+</mo><mi>Œ≥</mi><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mrow class=\"MJX-TeXAtom-ORD\"><msup><mi>a</mi><mo>‚Ä≤</mo></msup></mrow></munder><mi>Q</mi><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>,</mo><msup><mi>a</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-142\">Q(s,a) \\leftarrow Q(s,a) + \\alpha [r + \\gamma \\max_{a'} Q(s',a') - Q(s,a)]</script>\n      </li>\n      <li>\n        <p><strong>Simulated updates</strong> (using the learned model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-143-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>P</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>R</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1795\" style=\"width: 2.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1001.72em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1796\"><span class=\"texatom\" id=\"MathJax-Span-1797\"><span class=\"mrow\" id=\"MathJax-Span-1798\"><span class=\"munderover\" id=\"MathJax-Span-1799\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1800\" style=\"font-family: STIXGeneral-Italic;\">P</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1801\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1802\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-1803\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-1804\"><span class=\"munderover\" id=\"MathJax-Span-1805\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1806\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1807\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.441em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>P</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>R</mi><mo stretchy=\"false\">^</mo></mover></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-143\">\\hat{P}, \\hat{R}</script>):</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-144-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>Q</mi><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>&amp;#x2190;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>Q</mi><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B1;</mi><mo stretchy=&quot;false&quot;>[</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>R</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B3;</mi><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup></mrow></munder><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>Q</mi><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>s</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>&amp;#x2032;</mo></msup><mo>,</mo><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>Q</mi><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1808\" style=\"width: 27.607em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 22.971em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1022.87em, 3.18em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1809\"><span class=\"texatom\" id=\"MathJax-Span-1810\"><span class=\"mrow\" id=\"MathJax-Span-1811\"><span class=\"munderover\" id=\"MathJax-Span-1812\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1813\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.211em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.419em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1814\" style=\"font-family: STIXGeneral-Regular;\">ÃÉ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1815\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1816\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1817\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1818\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1819\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1820\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üê</span><span class=\"texatom\" id=\"MathJax-Span-1821\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-1822\"><span class=\"munderover\" id=\"MathJax-Span-1823\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1824\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.211em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.419em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1825\" style=\"font-family: STIXGeneral-Regular;\">ÃÉ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1826\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1827\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1828\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1829\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1830\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1831\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-1832\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ±</span><span class=\"mo\" id=\"MathJax-Span-1833\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"texatom\" id=\"MathJax-Span-1834\"><span class=\"mrow\" id=\"MathJax-Span-1835\"><span class=\"munderover\" id=\"MathJax-Span-1836\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1837\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1838\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1839\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1840\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1841\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1842\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1843\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1844\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-1845\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"munderover\" id=\"MathJax-Span-1846\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1847\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1000.58em, 4.273em, -999.997em); top: -3.279em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-1848\"><span class=\"mrow\" id=\"MathJax-Span-1849\"><span class=\"msup\" id=\"MathJax-Span-1850\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1851\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1852\" style=\"font-size: 50%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-1853\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-1854\"><span class=\"munderover\" id=\"MathJax-Span-1855\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1856\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.211em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.419em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1857\" style=\"font-family: STIXGeneral-Regular;\">ÃÉ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1858\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-1859\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.128em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-1860\"><span class=\"mrow\" id=\"MathJax-Span-1861\"><span class=\"munderover\" id=\"MathJax-Span-1862\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1863\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.06em; left: 0.055em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1864\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.477em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1865\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1866\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-1867\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1868\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-1869\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1870\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1871\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"texatom\" id=\"MathJax-Span-1872\" style=\"padding-left: 0.263em;\"><span class=\"mrow\" id=\"MathJax-Span-1873\"><span class=\"munderover\" id=\"MathJax-Span-1874\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1875\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.211em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.419em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1876\" style=\"font-family: STIXGeneral-Regular;\">ÃÉ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1877\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1878\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1879\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1880\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1881\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1882\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.059em; border-left: 0px solid; width: 0px; height: 2.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>Q</mi><mo stretchy=\"false\">~</mo></mover></mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">‚Üê</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>Q</mi><mo stretchy=\"false\">~</mo></mover></mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>Œ±</mi><mo stretchy=\"false\">[</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>R</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>Œ≥</mi><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mrow class=\"MJX-TeXAtom-ORD\"><msup><mi>a</mi><mo>‚Ä≤</mo></msup></mrow></munder><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>Q</mi><mo stretchy=\"false\">~</mo></mover></mrow><mo stretchy=\"false\">(</mo><msup><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>s</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>‚Ä≤</mo></msup><mo>,</mo><msup><mi>a</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>Q</mi><mo stretchy=\"false\">~</mo></mover></mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-144\">\\tilde{Q}(s,a) \\leftarrow \\tilde{Q}(s,a) + \\alpha [\\hat{R}(s,a) + \\gamma \\max_{a'} \\tilde{Q}(\\hat{s}',a') - \\tilde{Q}(s,a)]</script>\n      </li>\n    </ul>\n<p><strong>Direct reinforcement learning update</strong> (from real experiences):</p>\n<p><strong>Simulated updates</strong> (using the learned model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-143-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>P</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>R</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1795\" style=\"width: 2.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1001.72em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1796\"><span class=\"texatom\" id=\"MathJax-Span-1797\"><span class=\"mrow\" id=\"MathJax-Span-1798\"><span class=\"munderover\" id=\"MathJax-Span-1799\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1800\" style=\"font-family: STIXGeneral-Italic;\">P</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1801\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1802\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-1803\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-1804\"><span class=\"munderover\" id=\"MathJax-Span-1805\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1806\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-1807\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.441em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>P</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>R</mi><mo stretchy=\"false\">^</mo></mover></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-143\">\\hat{P}, \\hat{R}</script>):</p>\n<p>This integration of <strong>planning and learning</strong> was foundational to later sample-efficient RL systems.</p>\n<h4 id=\"strengths-and-challenges\">Strengths and Challenges</h4>\n<ul>\n  <li>\n    <p><strong>Advantages:</strong></p>\n  </li>\n  <li><strong>Sample efficiency:</strong> Learns faster due to simulated experience.</li>\n  <li><strong>Planning capability:</strong> Can evaluate long-term effects before acting.</li>\n  <li>\n    <p><strong>Flexibility:</strong> Unifies learning and control.</p>\n  </li>\n  <li>\n    <p><strong>Challenges:</strong></p>\n  </li>\n  <li><strong>Model bias:</strong> Imperfect models can lead to suboptimal or unstable policies.</li>\n  <li><strong>Complexity:</strong> Model estimation adds computational and representational burden.</li>\n  <li><strong>Scalability:</strong> Accurate models are difficult in large or stochastic environments.</li>\n</ul>\n<p><strong>Advantages:</strong></p>\n<p><strong>Flexibility:</strong> Unifies learning and control.</p>\n<p><strong>Challenges:</strong></p>\n<h4 id=\"comparative-analysis-3\">Comparative Analysis</h4>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Method</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Requires Model</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Planning Component</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Sample Efficiency</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Key References</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Value/Policy Iteration</strong></td>\n<td class=\"tg-tleft-valign-first\">Yes (known model)</td>\n<td class=\"tg-tleft-valign-first\">Full backups</td>\n<td class=\"tg-tleft-valign-first\">High (exact)</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://pubsonline.informs.org/doi/10.1287/opre.8.6.716\">Howard (1960)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Learned Models</strong></td>\n<td class=\"tg-tleft-valign-first\">Estimated from data</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-first\">Moderate</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://proceedings.neurips.cc/paper_files/paper/2011/file/7eb3c8be3d63a64a7f7e6f0ce9350b84-Paper.pdf\">Deisenroth &amp; Rasmussen (2011)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Dyna Architecture</strong></td>\n<td class=\"tg-tleft-valign-first\">Yes (learned)</td>\n<td class=\"tg-tleft-valign-first\">Integrated</td>\n<td class=\"tg-tleft-valign-first\">High</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://www.researchgate.net/publication/220320601_Integrated_Architectures_for_Learning_Planning_and_Reactive_Control\">Sutton (1990)</a></td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Method</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Requires Model</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Planning Component</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Sample Efficiency</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Key References</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Value/Policy Iteration</strong></td>\n<td class=\"tg-tleft-valign-first\">Yes (known model)</td>\n<td class=\"tg-tleft-valign-first\">Full backups</td>\n<td class=\"tg-tleft-valign-first\">High (exact)</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://pubsonline.informs.org/doi/10.1287/opre.8.6.716\">Howard (1960)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Learned Models</strong></td>\n<td class=\"tg-tleft-valign-first\">Estimated from data</td>\n<td class=\"tg-tleft-valign-first\">Yes</td>\n<td class=\"tg-tleft-valign-first\">Moderate</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://proceedings.neurips.cc/paper_files/paper/2011/file/7eb3c8be3d63a64a7f7e6f0ce9350b84-Paper.pdf\">Deisenroth &amp; Rasmussen (2011)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Dyna Architecture</strong></td>\n<td class=\"tg-tleft-valign-first\">Yes (learned)</td>\n<td class=\"tg-tleft-valign-first\">Integrated</td>\n<td class=\"tg-tleft-valign-first\">High</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://www.researchgate.net/publication/220320601_Integrated_Architectures_for_Learning_Planning_and_Reactive_Control\">Sutton (1990)</a></td>\n</tr>\n</tbody>\n</table>",
    "contentMarkdown": "*   **Model-Based Reinforcement Learning (MBRL)** refers to a family of techniques that explicitly learn or exploit a **model of the environment‚Äôs dynamics** to predict future states and rewards, enabling planning and sample-efficient policy optimization. Unlike model-free methods that learn purely from experience, model-based approaches **simulate** potential futures to guide decision-making.\n    \n*   This distinction makes model-based methods conceptually closer to **optimal control theory** and **planning algorithms** used in operations research and robotics.\n    \n\n**Model-Based Reinforcement Learning (MBRL)** refers to a family of techniques that explicitly learn or exploit a **model of the environment‚Äôs dynamics** to predict future states and rewards, enabling planning and sample-efficient policy optimization. Unlike model-free methods that learn purely from experience, model-based approaches **simulate** potential futures to guide decision-making.\n\nThis distinction makes model-based methods conceptually closer to **optimal control theory** and **planning algorithms** used in operations research and robotics.\n\n#### The Environment Model\n\n*   The central concept in model-based RL is the **Markov Decision Process (MDP) model**, represented by:\n    \n    *   **Transition Function:** P(s‚Ä≤‚à£s,a)\\=Pr(St+1\\=s‚Ä≤‚à£St\\=s,At\\=a)P(s‚Ä≤‚à£s,a)\\=Pr(St+1\\=s‚Ä≤‚à£St\\=s,At\\=a)P(s' \\\\mid s,a) = \\\\Pr(S\\_{t+1}=s' \\\\mid S\\_t=s, A\\_t=a)\n    *   **Reward Function:** R(s,a)\\=ùîº\\[rt+1‚à£s,a\\]R(s,a)\\=E\\[rt+1‚à£s,a\\]R(s,a) = \\\\mathbb{E}\\[r\\_{t+1} \\\\mid s,a\\]\n*   With access to these functions, one can compute **expected returns**, plan trajectories, and compute optimal policies using classical algorithms such as **Value Iteration** and **Policy Iteration** introduced by [Howard (1960)](https://pubsonline.informs.org/doi/10.1287/opre.8.6.716).\n    \n*   The model can either be:\n    \n    1.  **Given (known dynamics):** The environment is fully specified, as in many simulated domains.\n    2.  **Learned (unknown dynamics):** The agent estimates P(s‚Ä≤‚à£s,a)P(s‚Ä≤‚à£s,a)P(s' \\\\mid s,a) and R(s,a)R(s,a)R(s,a) from collected experience.\n\nThe central concept in model-based RL is the **Markov Decision Process (MDP) model**, represented by:\n\n*   **Transition Function:** P(s‚Ä≤‚à£s,a)\\=Pr(St+1\\=s‚Ä≤‚à£St\\=s,At\\=a)P(s‚Ä≤‚à£s,a)\\=Pr(St+1\\=s‚Ä≤‚à£St\\=s,At\\=a)P(s' \\\\mid s,a) = \\\\Pr(S\\_{t+1}=s' \\\\mid S\\_t=s, A\\_t=a)\n*   **Reward Function:** R(s,a)\\=ùîº\\[rt+1‚à£s,a\\]R(s,a)\\=E\\[rt+1‚à£s,a\\]R(s,a) = \\\\mathbb{E}\\[r\\_{t+1} \\\\mid s,a\\]\n\nWith access to these functions, one can compute **expected returns**, plan trajectories, and compute optimal policies using classical algorithms such as **Value Iteration** and **Policy Iteration** introduced by [Howard (1960)](https://pubsonline.informs.org/doi/10.1287/opre.8.6.716).\n\nThe model can either be:\n\n1.  **Given (known dynamics):** The environment is fully specified, as in many simulated domains.\n2.  **Learned (unknown dynamics):** The agent estimates P(s‚Ä≤‚à£s,a)P(s‚Ä≤‚à£s,a)P(s' \\\\mid s,a) and R(s,a)R(s,a)R(s,a) from collected experience.\n\n#### Planning with a Model\n\n*   Given a known model, the agent can perform **planning** ‚Äî evaluating and improving policies without interacting with the real environment.\n*   This is accomplished by recursively solving the **Bellman Optimality Equation**:\n\nV‚àó(s)\\=maxa\\[R(s,a)+Œ≥‚àës‚Ä≤P(s‚Ä≤‚à£s,a)V‚àó(s‚Ä≤)\\]V‚àó(s)\\=maxa\\[R(s,a)+Œ≥‚àës‚Ä≤P(s‚Ä≤‚à£s,a)V‚àó(s‚Ä≤)\\]\n\n*   and deriving the corresponding optimal policy:\n\nœÄ‚àó(s)\\=argmaxa\\[R(s,a)+Œ≥‚àës‚Ä≤P(s‚Ä≤‚à£s,a)V‚àó(s‚Ä≤)\\]œÄ‚àó(s)\\=arg‚Å°maxa\\[R(s,a)+Œ≥‚àës‚Ä≤P(s‚Ä≤‚à£s,a)V‚àó(s‚Ä≤)\\]\n\n*   This class of methods, encompassing **policy iteration** and **value iteration**, forms the foundation of model-based reasoning and exact planning in small-scale or deterministic environments.\n\n#### Learning the Model\n\n*   In more realistic settings, the transition and reward models are not known a priori.\n*   In such cases, the agent must **learn an approximate model** from experience:\n\nPÃÇ¬†(s‚Ä≤‚à£s,a)‚âàP(s‚Ä≤‚à£s,a),RÃÇ¬†(s,a)‚âàR(s,a)P^(s‚Ä≤‚à£s,a)‚âàP(s‚Ä≤‚à£s,a),R^(s,a)‚âàR(s,a)\n\n*   Learning these models transforms the RL problem into a **supervised learning** task, where the goal is to predict next states and rewards from observed transitions (s,a,s‚Ä≤,r)(s,a,s‚Ä≤,r)(s,a,s',r).\n    \n*   Model-learning can use:\n    \n    *   **Tabular frequency estimates** (in small discrete environments),\n    *   **Regression or Gaussian processes** ([Deisenroth & Rasmussen, 2011](https://proceedings.neurips.cc/paper_files/paper/2011/file/7eb3c8be3d63a64a7f7e6f0ce9350b84-Paper.pdf)),\n    *   or **function approximators** (in continuous spaces).\n\nLearning these models transforms the RL problem into a **supervised learning** task, where the goal is to predict next states and rewards from observed transitions (s,a,s‚Ä≤,r)(s,a,s‚Ä≤,r)(s,a,s',r).\n\nModel-learning can use:\n\n*   **Tabular frequency estimates** (in small discrete environments),\n*   **Regression or Gaussian processes** ([Deisenroth & Rasmussen, 2011](https://proceedings.neurips.cc/paper_files/paper/2011/file/7eb3c8be3d63a64a7f7e6f0ce9350b84-Paper.pdf)),\n*   or **function approximators** (in continuous spaces).\n\n#### The Dyna Architecture\n\n*   A seminal hybrid framework combining **learning, planning, and acting** was proposed in **Dyna** by [Sutton (1990)](https://www.researchgate.net/publication/220320601_Integrated_Architectures_for_Learning_Planning_and_Reactive_Control). Dyna integrates:\n    \n    1.  **Model learning:** Build an internal model from experience.\n    2.  **Planning:** Generate synthetic experiences from the model to update the value function.\n    3.  **Real experience:** Continue updating from actual environment interactions.\n*   This allows the agent to perform **imaginary rollouts** using its learned model, accelerating learning while maintaining adaptability.\n    \n*   Formally, Dyna‚Äôs process alternates between:\n    \n    *   **Direct reinforcement learning update** (from real experiences):\n        \n        Q(s,a)‚ÜêQ(s,a)+Œ±\\[r+Œ≥maxa‚Ä≤Q(s‚Ä≤,a‚Ä≤)‚àíQ(s,a)\\]Q(s,a)‚ÜêQ(s,a)+Œ±\\[r+Œ≥maxa‚Ä≤Q(s‚Ä≤,a‚Ä≤)‚àíQ(s,a)\\]\n        \n        Q(s,a) \\\\leftarrow Q(s,a) + \\\\alpha \\[r + \\\\gamma \\\\max\\_{a'} Q(s',a') - Q(s,a)\\]\n    *   **Simulated updates** (using the learned model PÃÇ¬†,RÃÇ¬†P^,R^\\\\hat{P}, \\\\hat{R}):\n        \n        QÃÉ¬†(s,a)‚ÜêQÃÉ¬†(s,a)+Œ±\\[RÃÇ¬†(s,a)+Œ≥maxa‚Ä≤QÃÉ¬†(sÃÇ¬†‚Ä≤,a‚Ä≤)‚àíQÃÉ¬†(s,a)\\]Q~(s,a)‚ÜêQ~(s,a)+Œ±\\[R^(s,a)+Œ≥maxa‚Ä≤Q~(s^‚Ä≤,a‚Ä≤)‚àíQ~(s,a)\\]\n        \n        \\\\tilde{Q}(s,a) \\\\leftarrow \\\\tilde{Q}(s,a) + \\\\alpha \\[\\\\hat{R}(s,a) + \\\\gamma \\\\max\\_{a'} \\\\tilde{Q}(\\\\hat{s}',a') - \\\\tilde{Q}(s,a)\\]\n*   This integration of **planning and learning** was foundational to later sample-efficient RL systems.\n    \n\nA seminal hybrid framework combining **learning, planning, and acting** was proposed in **Dyna** by [Sutton (1990)](https://www.researchgate.net/publication/220320601_Integrated_Architectures_for_Learning_Planning_and_Reactive_Control). Dyna integrates:\n\n1.  **Model learning:** Build an internal model from experience.\n2.  **Planning:** Generate synthetic experiences from the model to update the value function.\n3.  **Real experience:** Continue updating from actual environment interactions.\n\nThis allows the agent to perform **imaginary rollouts** using its learned model, accelerating learning while maintaining adaptability.\n\nFormally, Dyna‚Äôs process alternates between:\n\n*   **Direct reinforcement learning update** (from real experiences):\n    \n    Q(s,a)‚ÜêQ(s,a)+Œ±\\[r+Œ≥maxa‚Ä≤Q(s‚Ä≤,a‚Ä≤)‚àíQ(s,a)\\]Q(s,a)‚ÜêQ(s,a)+Œ±\\[r+Œ≥maxa‚Ä≤Q(s‚Ä≤,a‚Ä≤)‚àíQ(s,a)\\]\n    \n    Q(s,a) \\\\leftarrow Q(s,a) + \\\\alpha \\[r + \\\\gamma \\\\max\\_{a'} Q(s',a') - Q(s,a)\\]\n*   **Simulated updates** (using the learned model PÃÇ¬†,RÃÇ¬†P^,R^\\\\hat{P}, \\\\hat{R}):\n    \n    QÃÉ¬†(s,a)‚ÜêQÃÉ¬†(s,a)+Œ±\\[RÃÇ¬†(s,a)+Œ≥maxa‚Ä≤QÃÉ¬†(sÃÇ¬†‚Ä≤,a‚Ä≤)‚àíQÃÉ¬†(s,a)\\]Q~(s,a)‚ÜêQ~(s,a)+Œ±\\[R^(s,a)+Œ≥maxa‚Ä≤Q~(s^‚Ä≤,a‚Ä≤)‚àíQ~(s,a)\\]\n    \n    \\\\tilde{Q}(s,a) \\\\leftarrow \\\\tilde{Q}(s,a) + \\\\alpha \\[\\\\hat{R}(s,a) + \\\\gamma \\\\max\\_{a'} \\\\tilde{Q}(\\\\hat{s}',a') - \\\\tilde{Q}(s,a)\\]\n\n**Direct reinforcement learning update** (from real experiences):\n\n**Simulated updates** (using the learned model PÃÇ¬†,RÃÇ¬†P^,R^\\\\hat{P}, \\\\hat{R}):\n\nThis integration of **planning and learning** was foundational to later sample-efficient RL systems.\n\n#### Strengths and Challenges\n\n*   **Advantages:**\n    \n*   **Sample efficiency:** Learns faster due to simulated experience.\n*   **Planning capability:** Can evaluate long-term effects before acting.\n*   **Flexibility:** Unifies learning and control.\n    \n*   **Challenges:**\n    \n*   **Model bias:** Imperfect models can lead to suboptimal or unstable policies.\n*   **Complexity:** Model estimation adds computational and representational burden.\n*   **Scalability:** Accurate models are difficult in large or stochastic environments.\n\n**Advantages:**\n\n**Flexibility:** Unifies learning and control.\n\n**Challenges:**\n\n#### Comparative Analysis\n\n**Method**\n\n**Requires Model**\n\n**Planning Component**\n\n**Sample Efficiency**\n\n**Key References**\n\n**Value/Policy Iteration**\n\nYes (known model)\n\nFull backups\n\nHigh (exact)\n\n[Howard (1960)](https://pubsonline.informs.org/doi/10.1287/opre.8.6.716)\n\n**Learned Models**\n\nEstimated from data\n\nYes\n\nModerate\n\n[Deisenroth & Rasmussen (2011)](https://proceedings.neurips.cc/paper_files/paper/2011/file/7eb3c8be3d63a64a7f7e6f0ce9350b84-Paper.pdf)\n\n**Dyna Architecture**\n\nYes (learned)\n\nIntegrated\n\nHigh\n\n[Sutton (1990)](https://www.researchgate.net/publication/220320601_Integrated_Architectures_for_Learning_Planning_and_Reactive_Control)\n\n**Method**\n\n**Requires Model**\n\n**Planning Component**\n\n**Sample Efficiency**\n\n**Key References**\n\n**Value/Policy Iteration**\n\nYes (known model)\n\nFull backups\n\nHigh (exact)\n\n[Howard (1960)](https://pubsonline.informs.org/doi/10.1287/opre.8.6.716)\n\n**Learned Models**\n\nEstimated from data\n\nYes\n\nModerate\n\n[Deisenroth & Rasmussen (2011)](https://proceedings.neurips.cc/paper_files/paper/2011/file/7eb3c8be3d63a64a7f7e6f0ce9350b84-Paper.pdf)\n\n**Dyna Architecture**\n\nYes (learned)\n\nIntegrated\n\nHigh\n\n[Sutton (1990)](https://www.researchgate.net/publication/220320601_Integrated_Architectures_for_Learning_Planning_and_Reactive_Control)",
    "order": 12,
    "orderInChapter": 4,
    "difficulty": 3,
    "estimatedMinutes": 6,
    "tags": [
      "algorithmsarchitecture",
      "llm",
      "reinforcement learning",
      "supervised learning",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 1004,
      "contentLength": 145507
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#model-based-reinforcement-learning",
    "scrapedAt": "2025-12-28T11:47:08.459Z"
  },
  {
    "id": "ai-reinforcement-learning-model-free-reinforcement-learning-13",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Types of Reinforcement Learning",
    "title": "Model-Free Reinforcement Learning",
    "subtitle": "Types of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>Model-Free Reinforcement Learning (MFRL)</strong> refers to a broad class of algorithms that learn optimal behavior <strong>without explicitly modeling the environment‚Äôs dynamics</strong>.\nInstead of estimating transition probabilities <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-145-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2223;</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1883\" style=\"width: 4.951em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.117em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1004.07em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1884\"><span class=\"mi\" id=\"MathJax-Span-1885\" style=\"font-family: STIXGeneral-Italic;\">P</span><span class=\"mo\" id=\"MathJax-Span-1886\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-1887\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1888\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1889\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1890\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-1891\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1892\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1893\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1894\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>P</mi><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>‚à£</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-145\">P(s' \\mid s,a)</script> or reward functions <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-146-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1895\" style=\"width: 3.232em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.61em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1896\"><span class=\"mi\" id=\"MathJax-Span-1897\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-1898\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1899\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1900\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1901\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1902\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-146\">R(s,a)</script>, model-free agents learn value functions or policies directly from raw experience tuples <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-147-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>r</mi><mo>,</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1903\" style=\"width: 4.794em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.961em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1003.91em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1904\"><span class=\"mo\" id=\"MathJax-Span-1905\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1906\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1907\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1908\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1909\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1910\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1911\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-1912\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1913\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1914\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1915\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>r</mi><mo>,</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-147\">(s, a, r, s')</script>.</p>\n  </li>\n  <li>\n    <p>This makes MFRL algorithms simpler and more general, at the expense of sample efficiency. They form the practical foundation for most online reinforcement learning systems and are closely tied to the concept of <strong>trial-and-error learning</strong>.</p>\n  </li>\n</ul>\n<p><strong>Model-Free Reinforcement Learning (MFRL)</strong> refers to a broad class of algorithms that learn optimal behavior <strong>without explicitly modeling the environment‚Äôs dynamics</strong>.\nInstead of estimating transition probabilities <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-145-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2223;</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1883\" style=\"width: 4.951em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.117em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1004.07em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1884\"><span class=\"mi\" id=\"MathJax-Span-1885\" style=\"font-family: STIXGeneral-Italic;\">P</span><span class=\"mo\" id=\"MathJax-Span-1886\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-1887\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1888\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1889\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1890\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-1891\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1892\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1893\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1894\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>P</mi><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>‚à£</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-145\">P(s' \\mid s,a)</script> or reward functions <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-146-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1895\" style=\"width: 3.232em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.61em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1896\"><span class=\"mi\" id=\"MathJax-Span-1897\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-1898\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1899\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1900\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1901\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1902\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-146\">R(s,a)</script>, model-free agents learn value functions or policies directly from raw experience tuples <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-147-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>r</mi><mo>,</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1903\" style=\"width: 4.794em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.961em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1003.91em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1904\"><span class=\"mo\" id=\"MathJax-Span-1905\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1906\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1907\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1908\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1909\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1910\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1911\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-1912\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1913\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-1914\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1915\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>r</mi><mo>,</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-147\">(s, a, r, s')</script>.</p>\n<p>This makes MFRL algorithms simpler and more general, at the expense of sample efficiency. They form the practical foundation for most online reinforcement learning systems and are closely tied to the concept of <strong>trial-and-error learning</strong>.</p>\n<h4 id=\"foundations\">Foundations</h4>\n<ul>\n  <li>In a model-free setting, the agent‚Äôs objective remains to learn an optimal policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-148-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>&amp;#x03C0;</mi><mo>&amp;#x2217;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1916\" style=\"width: 4.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.44em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.39em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1917\"><span class=\"msubsup\" id=\"MathJax-Span-1918\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1919\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.576em;\"><span class=\"mo\" id=\"MathJax-Span-1920\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àó</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1921\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1922\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-1923\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-1924\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-1925\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>œÄ</mi><mo>‚àó</mo></msup><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-148\">\\pi^*(a \\mid s)</script> that maximizes the expected return:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-149-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1926\" style=\"width: 10.263em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 8.544em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1008.23em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1927\"><span class=\"mi\" id=\"MathJax-Span-1928\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1929\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1930\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1931\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-1932\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-1933\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-1934\"><span class=\"mrow\" id=\"MathJax-Span-1935\"><span class=\"mi\" id=\"MathJax-Span-1936\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-1937\"><span class=\"mrow\" id=\"MathJax-Span-1938\"><span class=\"mi\" id=\"MathJax-Span-1939\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-1940\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-1941\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-1942\"><span class=\"munderover\" id=\"MathJax-Span-1943\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-1944\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-1945\"><span class=\"mrow\" id=\"MathJax-Span-1946\"><span class=\"mi\" id=\"MathJax-Span-1947\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1948\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-1949\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -5.206em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-1950\"><span class=\"mrow\" id=\"MathJax-Span-1951\"><span class=\"mi\" id=\"MathJax-Span-1952\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àû</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1953\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1954\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1955\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-1956\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1957\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1958\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1959\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>J</mi><mo stretchy=\"false\">(</mo><mi>œÄ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">‚àû</mi></mrow></munderover><msup><mi>Œ≥</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub></mrow><mo>]</mo></mrow></math></span></span></div>\n<ul>\n  <li>However, since the agent does not possess an explicit model of the environment, it must approximate this expectation using <strong>empirical experience</strong> collected through exploration.</li>\n  <li>Learning proceeds incrementally by adjusting estimates of value functions or policies based on <strong>observed temporal-difference (TD) errors</strong>.</li>\n</ul>\n<h4 id=\"on-policy-vs-off-policy-learning\">On-Policy vs. Off-Policy Learning</h4>\n<ul>\n  <li>\n    <p>A key distinction in model-free RL is <strong>how experiences are gathered and used</strong>:</p>\n\n    <ul>\n      <li>\n        <p><strong>On-Policy Methods:</strong> Learn from actions taken by the current policy (e.g., SARSA).\nThe agent learns to evaluate and improve the same policy it uses for exploration.</p>\n      </li>\n      <li>\n        <p><strong>Off-Policy Methods:</strong> Learn from actions generated by a different policy (e.g., Q-Learning).\nThis allows leveraging historical or exploratory data for more efficient learning.</p>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>This dichotomy was formalized by <a href=\"https://proceedings.neurips.cc/paper_files/paper/2000/file/094a3a42a20f93b8c0833d6505eaa8b3-Paper.pdf\">Precup, Sutton &amp; Singh (2000)</a>, who introduced <strong>importance sampling</strong> corrections to enable off-policy evaluation.</p>\n  </li>\n</ul>\n<p>A key distinction in model-free RL is <strong>how experiences are gathered and used</strong>:</p>\n<ul>\n      <li>\n        <p><strong>On-Policy Methods:</strong> Learn from actions taken by the current policy (e.g., SARSA).\nThe agent learns to evaluate and improve the same policy it uses for exploration.</p>\n      </li>\n      <li>\n        <p><strong>Off-Policy Methods:</strong> Learn from actions generated by a different policy (e.g., Q-Learning).\nThis allows leveraging historical or exploratory data for more efficient learning.</p>\n      </li>\n    </ul>\n<p><strong>On-Policy Methods:</strong> Learn from actions taken by the current policy (e.g., SARSA).\nThe agent learns to evaluate and improve the same policy it uses for exploration.</p>\n<p><strong>Off-Policy Methods:</strong> Learn from actions generated by a different policy (e.g., Q-Learning).\nThis allows leveraging historical or exploratory data for more efficient learning.</p>\n<p>This dichotomy was formalized by <a href=\"https://proceedings.neurips.cc/paper_files/paper/2000/file/094a3a42a20f93b8c0833d6505eaa8b3-Paper.pdf\">Precup, Sutton &amp; Singh (2000)</a>, who introduced <strong>importance sampling</strong> corrections to enable off-policy evaluation.</p>\n<h4 id=\"sarsa-on-policy-td-control\">SARSA: On-Policy TD Control</h4>\n<ul>\n  <li><strong>SARSA</strong> (State‚ÄìAction‚ÄìReward‚ÄìState‚ÄìAction), proposed by <a href=\"https://www.researchgate.net/publication/228845724_On-line_Q-learning_using_connectionist_systems\">Rummery &amp; Niranjan (1994)</a>, is an on-policy temporal-difference control algorithm.</li>\n  <li>It updates the action-value function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-150-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1960\" style=\"width: 3.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.66em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1961\"><span class=\"mi\" id=\"MathJax-Span-1962\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-1963\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-1964\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-1965\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-1966\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-1967\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-150\">Q(s,a)</script> based on the transition sequence <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-151-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>r</mi><mi>t</mi></msub><mo>,</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1968\" style=\"width: 9.326em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.763em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1007.71em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1969\"><span class=\"mo\" id=\"MathJax-Span-1970\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-1971\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1972\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1973\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1974\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1975\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1976\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-1977\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1978\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1979\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1980\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-1981\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1982\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1983\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1984\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-1985\"><span class=\"mrow\" id=\"MathJax-Span-1986\"><span class=\"mi\" id=\"MathJax-Span-1987\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1988\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-1989\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1990\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1991\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1992\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-1993\"><span class=\"mrow\" id=\"MathJax-Span-1994\"><span class=\"mi\" id=\"MathJax-Span-1995\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1996\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-1997\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1998\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>,</mo><msub><mi>r</mi><mi>t</mi></msub><mo>,</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-151\">(s_t, a_t, r_t, s_{t+1}, a_{t+1})</script>:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-152-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>&amp;#x2190;</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B1;</mi><mo stretchy=&quot;false&quot;>[</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B3;</mi><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1999\" style=\"width: 26.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 22.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1022.24em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2000\"><span class=\"mi\" id=\"MathJax-Span-2001\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2002\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2003\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2004\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2005\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2006\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2007\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2008\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2009\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2010\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2011\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üê</span><span class=\"mi\" id=\"MathJax-Span-2012\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2013\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2014\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2015\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2016\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2017\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2018\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2019\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2020\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2021\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2022\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-2023\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ±</span><span class=\"mo\" id=\"MathJax-Span-2024\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-2025\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2026\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2027\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2028\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-2029\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-2030\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2031\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2032\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2033\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-2034\"><span class=\"mrow\" id=\"MathJax-Span-2035\"><span class=\"mi\" id=\"MathJax-Span-2036\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2037\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-2038\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2039\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2040\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2041\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-2042\"><span class=\"mrow\" id=\"MathJax-Span-2043\"><span class=\"mi\" id=\"MathJax-Span-2044\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2045\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-2046\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2047\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2048\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-2049\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2050\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2051\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2052\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2053\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2054\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2055\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2056\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2057\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2058\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2059\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">‚Üê</mo><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>+</mo><mi>Œ±</mi><mo stretchy=\"false\">[</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>Œ≥</mi><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span></div>\n<ul>\n  <li>\n    <p>This update reflects the return expected from <strong>continuing to act according to the current policy</strong>, which makes it safer and more stable for non-stationary environments, though sometimes slower to converge.</p>\n  </li>\n  <li>\n    <p><strong>Key properties:</strong></p>\n\n    <ul>\n      <li>Evaluates the current (behavior) policy directly.</li>\n      <li>Naturally balances exploration and exploitation.</li>\n      <li>More robust under stochasticity.</li>\n    </ul>\n  </li>\n</ul>\n<p>This update reflects the return expected from <strong>continuing to act according to the current policy</strong>, which makes it safer and more stable for non-stationary environments, though sometimes slower to converge.</p>\n<p><strong>Key properties:</strong></p>\n<ul>\n      <li>Evaluates the current (behavior) policy directly.</li>\n      <li>Naturally balances exploration and exploitation.</li>\n      <li>More robust under stochasticity.</li>\n    </ul>\n<h4 id=\"q-learning-off-policy-td-control\">Q-Learning: Off-Policy TD Control</h4>\n<ul>\n  <li><strong>Q-Learning</strong>, introduced by <a href=\"https://link.springer.com/article/10.1007/BF00992698\">Watkins &amp; Dayan (1992)</a>, is the archetypal <strong>off-policy</strong> model-free algorithm.</li>\n  <li>It estimates the optimal action-value function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-153-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>Q</mi><mo>&amp;#x2217;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2060\" style=\"width: 3.753em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.08em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2061\"><span class=\"msubsup\" id=\"MathJax-Span-2062\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2063\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"mo\" id=\"MathJax-Span-2064\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àó</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2065\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2066\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2067\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2068\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-2069\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>Q</mi><mo>‚àó</mo></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-153\">Q^*(s,a)</script> by updating toward the maximum value achievable from the next state, regardless of the current behavior policy:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-154-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>&amp;#x2190;</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B1;</mi><mo stretchy=&quot;false&quot;>[</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B3;</mi><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup></mrow></munder><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2070\" style=\"width: 28.44em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 23.701em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1023.6em, 3.18em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2071\"><span class=\"mi\" id=\"MathJax-Span-2072\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2073\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2074\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2075\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2076\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2077\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2078\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2079\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2080\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2081\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2082\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üê</span><span class=\"mi\" id=\"MathJax-Span-2083\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2084\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2085\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2086\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2087\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2088\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2089\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2090\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2091\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2092\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2093\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-2094\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ±</span><span class=\"mo\" id=\"MathJax-Span-2095\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-2096\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2097\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2098\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2099\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-2100\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"munderover\" id=\"MathJax-Span-2101\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2102\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1000.58em, 4.273em, -999.997em); top: -3.279em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-2103\"><span class=\"mrow\" id=\"MathJax-Span-2104\"><span class=\"msup\" id=\"MathJax-Span-2105\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2106\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-2107\" style=\"font-size: 50%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-2108\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2109\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2110\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2111\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-2112\"><span class=\"mrow\" id=\"MathJax-Span-2113\"><span class=\"mi\" id=\"MathJax-Span-2114\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2115\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-2116\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2117\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-2118\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2119\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-2120\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2121\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2122\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-2123\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2124\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2125\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2126\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2127\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2128\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2129\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2130\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2131\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2132\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2133\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.059em; border-left: 0px solid; width: 0px; height: 2.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">‚Üê</mo><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>+</mo><mi>Œ±</mi><mo stretchy=\"false\">[</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>Œ≥</mi><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mrow class=\"MJX-TeXAtom-ORD\"><msup><mi>a</mi><mo>‚Ä≤</mo></msup></mrow></munder><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msup><mi>a</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span></div>\n<ul>\n  <li>\n    <p>This formulation separates <strong>policy evaluation</strong> (learning from exploratory behavior) from <strong>policy improvement</strong> (acting greedily with respect to <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-155-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2134\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.73em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2135\"><span class=\"mi\" id=\"MathJax-Span-2136\" style=\"font-family: STIXGeneral-Italic;\">Q</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-155\">Q</script>), enabling learning from arbitrary data sources or replay buffers.</p>\n  </li>\n  <li>\n    <p><strong>Key properties:</strong></p>\n\n    <ul>\n      <li>Converges to <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-156-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>Q</mi><mo>&amp;#x2217;</mo></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2137\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.15em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2138\"><span class=\"msubsup\" id=\"MathJax-Span-2139\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2140\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"mo\" id=\"MathJax-Span-2141\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àó</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>Q</mi><mo>‚àó</mo></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-156\">Q^*</script> under standard assumptions (finite state-action space, decaying learning rate).</li>\n      <li>Highly flexible ‚Äî can learn from off-policy or logged data.</li>\n      <li>The foundation for most modern off-policy algorithms, including Deep Q-Networks (DQN).</li>\n    </ul>\n  </li>\n</ul>\n<p>This formulation separates <strong>policy evaluation</strong> (learning from exploratory behavior) from <strong>policy improvement</strong> (acting greedily with respect to <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-155-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2134\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.73em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2135\"><span class=\"mi\" id=\"MathJax-Span-2136\" style=\"font-family: STIXGeneral-Italic;\">Q</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-155\">Q</script>), enabling learning from arbitrary data sources or replay buffers.</p>\n<p><strong>Key properties:</strong></p>\n<ul>\n      <li>Converges to <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-156-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>Q</mi><mo>&amp;#x2217;</mo></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2137\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.15em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2138\"><span class=\"msubsup\" id=\"MathJax-Span-2139\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2140\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"mo\" id=\"MathJax-Span-2141\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àó</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>Q</mi><mo>‚àó</mo></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-156\">Q^*</script> under standard assumptions (finite state-action space, decaying learning rate).</li>\n      <li>Highly flexible ‚Äî can learn from off-policy or logged data.</li>\n      <li>The foundation for most modern off-policy algorithms, including Deep Q-Networks (DQN).</li>\n    </ul>\n<h4 id=\"exploration-strategies\">Exploration Strategies</h4>\n<ul>\n  <li>\n    <p>Model-free RL requires effective exploration to ensure sufficient coverage of the state‚Äìaction space. Common strategies include:</p>\n\n    <ul>\n      <li><strong><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-157-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03F5;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2142\" style=\"width: 0.519em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.552em, 1000.42em, 2.327em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2143\"><span class=\"mi\" id=\"MathJax-Span-2144\" style=\"font-family: STIXGeneral-Italic;\">œµ</span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œµ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-157\">\\epsilon</script>-Greedy Exploration:</strong>\n        <ul>\n          <li>With probability <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-158-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03B5;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2145\" style=\"width: 2.451em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.03em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2146\"><span class=\"mn\" id=\"MathJax-Span-2147\" style=\"font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-2148\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-2149\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œµ</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn><mo>‚àí</mo><mi>Œµ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-158\">1 - \\varepsilon</script>, choose the greedy action; with probability <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-159-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B5;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2150\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2151\"><span class=\"mi\" id=\"MathJax-Span-2152\" style=\"font-family: STIXGeneral-Italic;\">Œµ</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œµ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-159\">\\varepsilon</script>, pick a random one.</li>\n          <li>Balances exploitation of known high-value actions with exploration of new ones.</li>\n        </ul>\n      </li>\n      <li><strong>Softmax / Boltzmann Exploration:</strong>\n        <ul>\n          <li>Selects actions probabilistically according to their estimated Q-values: <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-160-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>&amp;#x03C4;</mi></mrow></msup><mrow><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>b</mi></mrow></munder><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>&amp;#x03C4;</mi></mrow></msup></mrow></mfrac></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2153\" style=\"width: 9.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.607em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1007.61em, 3.076em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2154\"><span class=\"mi\" id=\"MathJax-Span-2155\" style=\"font-family: STIXGeneral-Italic;\">P</span><span class=\"mo\" id=\"MathJax-Span-2156\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2157\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-2158\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-2159\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-2160\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2161\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-2162\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.284em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.284em, 1001.98em, 4.169em, -999.997em); top: -4.424em; left: 50%; margin-left: -0.987em;\"><span class=\"msubsup\" id=\"MathJax-Span-2163\"><span style=\"display: inline-block; position: relative; width: 1.982em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2164\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">e</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-2165\"><span class=\"mrow\" id=\"MathJax-Span-2166\"><span class=\"mi\" id=\"MathJax-Span-2167\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2168\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2169\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2170\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2171\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-2172\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-2173\"><span class=\"mrow\" id=\"MathJax-Span-2174\"><span class=\"mo\" id=\"MathJax-Span-2175\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">/</span></span></span><span class=\"mi\" id=\"MathJax-Span-2176\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">œÑ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1003.13em, 4.378em, -999.997em); top: -3.539em; left: 50%; margin-left: -1.56em;\"><span class=\"mrow\" id=\"MathJax-Span-2177\"><span class=\"munderover\" id=\"MathJax-Span-2178\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.336em, 1000.63em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2179\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.799em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2180\"><span class=\"mrow\" id=\"MathJax-Span-2181\"><span class=\"mi\" id=\"MathJax-Span-2182\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">b</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2183\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.982em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2184\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">e</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.216em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-2185\"><span class=\"mrow\" id=\"MathJax-Span-2186\"><span class=\"mi\" id=\"MathJax-Span-2187\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2188\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2189\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2190\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2191\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">b</span><span class=\"mo\" id=\"MathJax-Span-2192\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-2193\"><span class=\"mrow\" id=\"MathJax-Span-2194\"><span class=\"mo\" id=\"MathJax-Span-2195\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">/</span></span></span><span class=\"mi\" id=\"MathJax-Span-2196\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">œÑ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.28em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.284em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>P</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><msup><mi>e</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo>/</mo></mrow><mi>œÑ</mi></mrow></msup><mrow><munder><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>b</mi></mrow></munder><msup><mi>e</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>b</mi><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo>/</mo></mrow><mi>œÑ</mi></mrow></msup></mrow></mfrac></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-160\">P(a \\mid s) = \\frac{e^{Q(s,a)/\\tau}}{\\sum_{b} e^{Q(s,b)/\\tau}}</script></li>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-161-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C4;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2197\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2198\"><span class=\"mi\" id=\"MathJax-Span-2199\" style=\"font-family: STIXGeneral-Italic;\">œÑ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÑ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-161\">\\tau</script> controls exploration temperature.</li>\n        </ul>\n      </li>\n      <li><strong>Upper Confidence Bounds (UCB):</strong>\n        <ul>\n          <li>Encourages exploration of actions with higher uncertainty in their value estimates.</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>These techniques are crucial for preventing premature convergence to suboptimal policies, especially in stochastic or large environments.</p>\n  </li>\n</ul>\n<p>Model-free RL requires effective exploration to ensure sufficient coverage of the state‚Äìaction space. Common strategies include:</p>\n<ul>\n      <li><strong><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-157-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03F5;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2142\" style=\"width: 0.519em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.416em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.552em, 1000.42em, 2.327em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2143\"><span class=\"mi\" id=\"MathJax-Span-2144\" style=\"font-family: STIXGeneral-Italic;\">œµ</span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œµ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-157\">\\epsilon</script>-Greedy Exploration:</strong>\n        <ul>\n          <li>With probability <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-158-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03B5;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2145\" style=\"width: 2.451em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.03em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2146\"><span class=\"mn\" id=\"MathJax-Span-2147\" style=\"font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-2148\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-2149\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œµ</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn><mo>‚àí</mo><mi>Œµ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-158\">1 - \\varepsilon</script>, choose the greedy action; with probability <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-159-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B5;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2150\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2151\"><span class=\"mi\" id=\"MathJax-Span-2152\" style=\"font-family: STIXGeneral-Italic;\">Œµ</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œµ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-159\">\\varepsilon</script>, pick a random one.</li>\n          <li>Balances exploitation of known high-value actions with exploration of new ones.</li>\n        </ul>\n      </li>\n      <li><strong>Softmax / Boltzmann Exploration:</strong>\n        <ul>\n          <li>Selects actions probabilistically according to their estimated Q-values: <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-160-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>&amp;#x03C4;</mi></mrow></msup><mrow><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>b</mi></mrow></munder><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>&amp;#x03C4;</mi></mrow></msup></mrow></mfrac></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2153\" style=\"width: 9.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.607em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1007.61em, 3.076em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2154\"><span class=\"mi\" id=\"MathJax-Span-2155\" style=\"font-family: STIXGeneral-Italic;\">P</span><span class=\"mo\" id=\"MathJax-Span-2156\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2157\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-2158\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-2159\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-2160\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2161\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-2162\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.284em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.284em, 1001.98em, 4.169em, -999.997em); top: -4.424em; left: 50%; margin-left: -0.987em;\"><span class=\"msubsup\" id=\"MathJax-Span-2163\"><span style=\"display: inline-block; position: relative; width: 1.982em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2164\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">e</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-2165\"><span class=\"mrow\" id=\"MathJax-Span-2166\"><span class=\"mi\" id=\"MathJax-Span-2167\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2168\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2169\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2170\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2171\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-2172\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-2173\"><span class=\"mrow\" id=\"MathJax-Span-2174\"><span class=\"mo\" id=\"MathJax-Span-2175\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">/</span></span></span><span class=\"mi\" id=\"MathJax-Span-2176\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">œÑ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1003.13em, 4.378em, -999.997em); top: -3.539em; left: 50%; margin-left: -1.56em;\"><span class=\"mrow\" id=\"MathJax-Span-2177\"><span class=\"munderover\" id=\"MathJax-Span-2178\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.336em, 1000.63em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2179\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.799em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2180\"><span class=\"mrow\" id=\"MathJax-Span-2181\"><span class=\"mi\" id=\"MathJax-Span-2182\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">b</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2183\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.982em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2184\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">e</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.216em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-2185\"><span class=\"mrow\" id=\"MathJax-Span-2186\"><span class=\"mi\" id=\"MathJax-Span-2187\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2188\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2189\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2190\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2191\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">b</span><span class=\"mo\" id=\"MathJax-Span-2192\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-2193\"><span class=\"mrow\" id=\"MathJax-Span-2194\"><span class=\"mo\" id=\"MathJax-Span-2195\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">/</span></span></span><span class=\"mi\" id=\"MathJax-Span-2196\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">œÑ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.28em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.284em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>P</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><msup><mi>e</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo>/</mo></mrow><mi>œÑ</mi></mrow></msup><mrow><munder><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>b</mi></mrow></munder><msup><mi>e</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>b</mi><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo>/</mo></mrow><mi>œÑ</mi></mrow></msup></mrow></mfrac></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-160\">P(a \\mid s) = \\frac{e^{Q(s,a)/\\tau}}{\\sum_{b} e^{Q(s,b)/\\tau}}</script></li>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-161-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C4;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2197\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2198\"><span class=\"mi\" id=\"MathJax-Span-2199\" style=\"font-family: STIXGeneral-Italic;\">œÑ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÑ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-161\">\\tau</script> controls exploration temperature.</li>\n        </ul>\n      </li>\n      <li><strong>Upper Confidence Bounds (UCB):</strong>\n        <ul>\n          <li>Encourages exploration of actions with higher uncertainty in their value estimates.</li>\n        </ul>\n      </li>\n    </ul>\n<ul>\n          <li>With probability <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-158-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03B5;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2145\" style=\"width: 2.451em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.03em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2146\"><span class=\"mn\" id=\"MathJax-Span-2147\" style=\"font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-2148\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-2149\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œµ</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn><mo>‚àí</mo><mi>Œµ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-158\">1 - \\varepsilon</script>, choose the greedy action; with probability <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-159-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B5;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2150\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2151\"><span class=\"mi\" id=\"MathJax-Span-2152\" style=\"font-family: STIXGeneral-Italic;\">Œµ</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œµ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-159\">\\varepsilon</script>, pick a random one.</li>\n          <li>Balances exploitation of known high-value actions with exploration of new ones.</li>\n        </ul>\n<ul>\n          <li>Selects actions probabilistically according to their estimated Q-values: <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-160-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>&amp;#x03C4;</mi></mrow></msup><mrow><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>b</mi></mrow></munder><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>&amp;#x03C4;</mi></mrow></msup></mrow></mfrac></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2153\" style=\"width: 9.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.607em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1007.61em, 3.076em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2154\"><span class=\"mi\" id=\"MathJax-Span-2155\" style=\"font-family: STIXGeneral-Italic;\">P</span><span class=\"mo\" id=\"MathJax-Span-2156\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2157\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-2158\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-2159\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-2160\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2161\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-2162\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.284em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.284em, 1001.98em, 4.169em, -999.997em); top: -4.424em; left: 50%; margin-left: -0.987em;\"><span class=\"msubsup\" id=\"MathJax-Span-2163\"><span style=\"display: inline-block; position: relative; width: 1.982em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2164\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">e</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-2165\"><span class=\"mrow\" id=\"MathJax-Span-2166\"><span class=\"mi\" id=\"MathJax-Span-2167\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2168\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2169\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2170\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2171\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-2172\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-2173\"><span class=\"mrow\" id=\"MathJax-Span-2174\"><span class=\"mo\" id=\"MathJax-Span-2175\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">/</span></span></span><span class=\"mi\" id=\"MathJax-Span-2176\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">œÑ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1003.13em, 4.378em, -999.997em); top: -3.539em; left: 50%; margin-left: -1.56em;\"><span class=\"mrow\" id=\"MathJax-Span-2177\"><span class=\"munderover\" id=\"MathJax-Span-2178\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.336em, 1000.63em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2179\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.799em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2180\"><span class=\"mrow\" id=\"MathJax-Span-2181\"><span class=\"mi\" id=\"MathJax-Span-2182\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">b</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2183\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.982em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2184\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">e</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.216em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-2185\"><span class=\"mrow\" id=\"MathJax-Span-2186\"><span class=\"mi\" id=\"MathJax-Span-2187\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2188\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2189\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2190\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2191\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">b</span><span class=\"mo\" id=\"MathJax-Span-2192\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-2193\"><span class=\"mrow\" id=\"MathJax-Span-2194\"><span class=\"mo\" id=\"MathJax-Span-2195\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">/</span></span></span><span class=\"mi\" id=\"MathJax-Span-2196\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">œÑ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.28em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.284em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>P</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><msup><mi>e</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo>/</mo></mrow><mi>œÑ</mi></mrow></msup><mrow><munder><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>b</mi></mrow></munder><msup><mi>e</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>b</mi><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo>/</mo></mrow><mi>œÑ</mi></mrow></msup></mrow></mfrac></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-160\">P(a \\mid s) = \\frac{e^{Q(s,a)/\\tau}}{\\sum_{b} e^{Q(s,b)/\\tau}}</script></li>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-161-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C4;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2197\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2198\"><span class=\"mi\" id=\"MathJax-Span-2199\" style=\"font-family: STIXGeneral-Italic;\">œÑ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÑ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-161\">\\tau</script> controls exploration temperature.</li>\n        </ul>\n<ul>\n          <li>Encourages exploration of actions with higher uncertainty in their value estimates.</li>\n        </ul>\n<p>These techniques are crucial for preventing premature convergence to suboptimal policies, especially in stochastic or large environments.</p>\n<h4 id=\"strengths-and-limitations\">Strengths and Limitations</h4>\n<ul>\n  <li>\n    <p><strong>Advantages:</strong></p>\n\n    <ul>\n      <li>Simpler and easier to implement than model-based methods.</li>\n      <li>No need for an explicit environment model.</li>\n      <li>Robust across varied environments and tasks.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Limitations:</strong></p>\n\n    <ul>\n      <li>Poor sample efficiency due to reliance on real experience.</li>\n      <li>Limited ability to plan or simulate long-term outcomes.</li>\n      <li>Exploration‚Äìexploitation trade-offs can be difficult to tune.</li>\n    </ul>\n  </li>\n</ul>\n<p><strong>Advantages:</strong></p>\n<ul>\n      <li>Simpler and easier to implement than model-based methods.</li>\n      <li>No need for an explicit environment model.</li>\n      <li>Robust across varied environments and tasks.</li>\n    </ul>\n<p><strong>Limitations:</strong></p>\n<ul>\n      <li>Poor sample efficiency due to reliance on real experience.</li>\n      <li>Limited ability to plan or simulate long-term outcomes.</li>\n      <li>Exploration‚Äìexploitation trade-offs can be difficult to tune.</li>\n    </ul>\n<h4 id=\"comparative-analysis-4\">Comparative Analysis</h4>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Algorithm</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Policy Type</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Model Requirement</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Learning Type</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Key References</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>SARSA</strong></td>\n<td class=\"tg-tleft-valign-first\">On-policy</td>\n<td class=\"tg-tleft-valign-first\">Model-free</td>\n<td class=\"tg-tleft-valign-first\">TD control</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://www.researchgate.net/publication/228845724_On-line_Q-learning_using_connectionist_systems\">Rummery &amp; Niranjan (1994)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Q-Learning</strong></td>\n<td class=\"tg-tleft-valign-first\">Off-policy</td>\n<td class=\"tg-tleft-valign-first\">Model-free</td>\n<td class=\"tg-tleft-valign-first\">TD control</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://link.springer.com/article/10.1007/BF00992698\">Watkins &amp; Dayan (1992)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Off-Policy Evaluation</strong></td>\n<td class=\"tg-tleft-valign-first\">Off-policy</td>\n<td class=\"tg-tleft-valign-first\">Model-free</td>\n<td class=\"tg-tleft-valign-first\">Importance sampling</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://proceedings.neurips.cc/paper_files/paper/2000/file/094a3a42a20f93b8c0833d6505eaa8b3-Paper.pdf\">Precup, Sutton &amp; Singh (2000)</a></td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Algorithm</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Policy Type</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Model Requirement</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Learning Type</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Key References</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>SARSA</strong></td>\n<td class=\"tg-tleft-valign-first\">On-policy</td>\n<td class=\"tg-tleft-valign-first\">Model-free</td>\n<td class=\"tg-tleft-valign-first\">TD control</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://www.researchgate.net/publication/228845724_On-line_Q-learning_using_connectionist_systems\">Rummery &amp; Niranjan (1994)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Q-Learning</strong></td>\n<td class=\"tg-tleft-valign-first\">Off-policy</td>\n<td class=\"tg-tleft-valign-first\">Model-free</td>\n<td class=\"tg-tleft-valign-first\">TD control</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://link.springer.com/article/10.1007/BF00992698\">Watkins &amp; Dayan (1992)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Off-Policy Evaluation</strong></td>\n<td class=\"tg-tleft-valign-first\">Off-policy</td>\n<td class=\"tg-tleft-valign-first\">Model-free</td>\n<td class=\"tg-tleft-valign-first\">Importance sampling</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://proceedings.neurips.cc/paper_files/paper/2000/file/094a3a42a20f93b8c0833d6505eaa8b3-Paper.pdf\">Precup, Sutton &amp; Singh (2000)</a></td>\n</tr>\n</tbody>\n</table>",
    "contentMarkdown": "*   **Model-Free Reinforcement Learning (MFRL)** refers to a broad class of algorithms that learn optimal behavior **without explicitly modeling the environment‚Äôs dynamics**. Instead of estimating transition probabilities P(s‚Ä≤‚à£s,a)P(s‚Ä≤‚à£s,a)P(s' \\\\mid s,a) or reward functions R(s,a)R(s,a)R(s,a), model-free agents learn value functions or policies directly from raw experience tuples (s,a,r,s‚Ä≤)(s,a,r,s‚Ä≤)(s, a, r, s').\n    \n*   This makes MFRL algorithms simpler and more general, at the expense of sample efficiency. They form the practical foundation for most online reinforcement learning systems and are closely tied to the concept of **trial-and-error learning**.\n    \n\n**Model-Free Reinforcement Learning (MFRL)** refers to a broad class of algorithms that learn optimal behavior **without explicitly modeling the environment‚Äôs dynamics**. Instead of estimating transition probabilities P(s‚Ä≤‚à£s,a)P(s‚Ä≤‚à£s,a)P(s' \\\\mid s,a) or reward functions R(s,a)R(s,a)R(s,a), model-free agents learn value functions or policies directly from raw experience tuples (s,a,r,s‚Ä≤)(s,a,r,s‚Ä≤)(s, a, r, s').\n\nThis makes MFRL algorithms simpler and more general, at the expense of sample efficiency. They form the practical foundation for most online reinforcement learning systems and are closely tied to the concept of **trial-and-error learning**.\n\n#### Foundations\n\n*   In a model-free setting, the agent‚Äôs objective remains to learn an optimal policy œÄ‚àó(a‚à£s)œÄ‚àó(a‚à£s)\\\\pi^\\*(a \\\\mid s) that maximizes the expected return:\n\nJ(œÄ)\\=ùîºœÄ\\[‚àët\\=0‚àûŒ≥trt\\]J(œÄ)\\=EœÄ\\[‚àët\\=0‚àûŒ≥trt\\]\n\n*   However, since the agent does not possess an explicit model of the environment, it must approximate this expectation using **empirical experience** collected through exploration.\n*   Learning proceeds incrementally by adjusting estimates of value functions or policies based on **observed temporal-difference (TD) errors**.\n\n#### On-Policy vs. Off-Policy Learning\n\n*   A key distinction in model-free RL is **how experiences are gathered and used**:\n    \n    *   **On-Policy Methods:** Learn from actions taken by the current policy (e.g., SARSA). The agent learns to evaluate and improve the same policy it uses for exploration.\n        \n    *   **Off-Policy Methods:** Learn from actions generated by a different policy (e.g., Q-Learning). This allows leveraging historical or exploratory data for more efficient learning.\n        \n*   This dichotomy was formalized by [Precup, Sutton & Singh (2000)](https://proceedings.neurips.cc/paper_files/paper/2000/file/094a3a42a20f93b8c0833d6505eaa8b3-Paper.pdf), who introduced **importance sampling** corrections to enable off-policy evaluation.\n    \n\nA key distinction in model-free RL is **how experiences are gathered and used**:\n\n*   **On-Policy Methods:** Learn from actions taken by the current policy (e.g., SARSA). The agent learns to evaluate and improve the same policy it uses for exploration.\n    \n*   **Off-Policy Methods:** Learn from actions generated by a different policy (e.g., Q-Learning). This allows leveraging historical or exploratory data for more efficient learning.\n    \n\n**On-Policy Methods:** Learn from actions taken by the current policy (e.g., SARSA). The agent learns to evaluate and improve the same policy it uses for exploration.\n\n**Off-Policy Methods:** Learn from actions generated by a different policy (e.g., Q-Learning). This allows leveraging historical or exploratory data for more efficient learning.\n\nThis dichotomy was formalized by [Precup, Sutton & Singh (2000)](https://proceedings.neurips.cc/paper_files/paper/2000/file/094a3a42a20f93b8c0833d6505eaa8b3-Paper.pdf), who introduced **importance sampling** corrections to enable off-policy evaluation.\n\n#### SARSA: On-Policy TD Control\n\n*   **SARSA** (State‚ÄìAction‚ÄìReward‚ÄìState‚ÄìAction), proposed by [Rummery & Niranjan (1994)](https://www.researchgate.net/publication/228845724_On-line_Q-learning_using_connectionist_systems), is an on-policy temporal-difference control algorithm.\n*   It updates the action-value function Q(s,a)Q(s,a)Q(s,a) based on the transition sequence (st,at,rt,st+1,at+1)(st,at,rt,st+1,at+1)(s\\_t, a\\_t, r\\_t, s\\_{t+1}, a\\_{t+1}):\n\nQ(st,at)‚ÜêQ(st,at)+Œ±\\[rt+Œ≥Q(st+1,at+1)‚àíQ(st,at)\\]Q(st,at)‚ÜêQ(st,at)+Œ±\\[rt+Œ≥Q(st+1,at+1)‚àíQ(st,at)\\]\n\n*   This update reflects the return expected from **continuing to act according to the current policy**, which makes it safer and more stable for non-stationary environments, though sometimes slower to converge.\n    \n*   **Key properties:**\n    \n    *   Evaluates the current (behavior) policy directly.\n    *   Naturally balances exploration and exploitation.\n    *   More robust under stochasticity.\n\nThis update reflects the return expected from **continuing to act according to the current policy**, which makes it safer and more stable for non-stationary environments, though sometimes slower to converge.\n\n**Key properties:**\n\n*   Evaluates the current (behavior) policy directly.\n*   Naturally balances exploration and exploitation.\n*   More robust under stochasticity.\n\n#### Q-Learning: Off-Policy TD Control\n\n*   **Q-Learning**, introduced by [Watkins & Dayan (1992)](https://link.springer.com/article/10.1007/BF00992698), is the archetypal **off-policy** model-free algorithm.\n*   It estimates the optimal action-value function Q‚àó(s,a)Q‚àó(s,a)Q^\\*(s,a) by updating toward the maximum value achievable from the next state, regardless of the current behavior policy:\n\nQ(st,at)‚ÜêQ(st,at)+Œ±\\[rt+Œ≥maxa‚Ä≤Q(st+1,a‚Ä≤)‚àíQ(st,at)\\]Q(st,at)‚ÜêQ(st,at)+Œ±\\[rt+Œ≥maxa‚Ä≤Q(st+1,a‚Ä≤)‚àíQ(st,at)\\]\n\n*   This formulation separates **policy evaluation** (learning from exploratory behavior) from **policy improvement** (acting greedily with respect to QQQ), enabling learning from arbitrary data sources or replay buffers.\n    \n*   **Key properties:**\n    \n    *   Converges to Q‚àóQ‚àóQ^\\* under standard assumptions (finite state-action space, decaying learning rate).\n    *   Highly flexible ‚Äî can learn from off-policy or logged data.\n    *   The foundation for most modern off-policy algorithms, including Deep Q-Networks (DQN).\n\nThis formulation separates **policy evaluation** (learning from exploratory behavior) from **policy improvement** (acting greedily with respect to QQQ), enabling learning from arbitrary data sources or replay buffers.\n\n**Key properties:**\n\n*   Converges to Q‚àóQ‚àóQ^\\* under standard assumptions (finite state-action space, decaying learning rate).\n*   Highly flexible ‚Äî can learn from off-policy or logged data.\n*   The foundation for most modern off-policy algorithms, including Deep Q-Networks (DQN).\n\n#### Exploration Strategies\n\n*   Model-free RL requires effective exploration to ensure sufficient coverage of the state‚Äìaction space. Common strategies include:\n    \n    *   **œµœµ\\\\epsilon\\-Greedy Exploration:**\n        *   With probability 1‚àíŒµ1‚àíŒµ1 - \\\\varepsilon, choose the greedy action; with probability ŒµŒµ\\\\varepsilon, pick a random one.\n        *   Balances exploitation of known high-value actions with exploration of new ones.\n    *   **Softmax / Boltzmann Exploration:**\n        *   Selects actions probabilistically according to their estimated Q-values: P(a‚à£s)\\=eQ(s,a)/œÑ‚àëbeQ(s,b)/œÑP(a‚à£s)\\=eQ(s,a)/œÑ‚àëbeQ(s,b)/œÑP(a \\\\mid s) = \\\\frac{e^{Q(s,a)/\\\\tau}}{\\\\sum\\_{b} e^{Q(s,b)/\\\\tau}}\n        *   where œÑœÑ\\\\tau controls exploration temperature.\n    *   **Upper Confidence Bounds (UCB):**\n        *   Encourages exploration of actions with higher uncertainty in their value estimates.\n*   These techniques are crucial for preventing premature convergence to suboptimal policies, especially in stochastic or large environments.\n    \n\nModel-free RL requires effective exploration to ensure sufficient coverage of the state‚Äìaction space. Common strategies include:\n\n*   **œµœµ\\\\epsilon\\-Greedy Exploration:**\n    *   With probability 1‚àíŒµ1‚àíŒµ1 - \\\\varepsilon, choose the greedy action; with probability ŒµŒµ\\\\varepsilon, pick a random one.\n    *   Balances exploitation of known high-value actions with exploration of new ones.\n*   **Softmax / Boltzmann Exploration:**\n    *   Selects actions probabilistically according to their estimated Q-values: P(a‚à£s)\\=eQ(s,a)/œÑ‚àëbeQ(s,b)/œÑP(a‚à£s)\\=eQ(s,a)/œÑ‚àëbeQ(s,b)/œÑP(a \\\\mid s) = \\\\frac{e^{Q(s,a)/\\\\tau}}{\\\\sum\\_{b} e^{Q(s,b)/\\\\tau}}\n    *   where œÑœÑ\\\\tau controls exploration temperature.\n*   **Upper Confidence Bounds (UCB):**\n    *   Encourages exploration of actions with higher uncertainty in their value estimates.\n\n*   With probability 1‚àíŒµ1‚àíŒµ1 - \\\\varepsilon, choose the greedy action; with probability ŒµŒµ\\\\varepsilon, pick a random one.\n*   Balances exploitation of known high-value actions with exploration of new ones.\n\n*   Selects actions probabilistically according to their estimated Q-values: P(a‚à£s)\\=eQ(s,a)/œÑ‚àëbeQ(s,b)/œÑP(a‚à£s)\\=eQ(s,a)/œÑ‚àëbeQ(s,b)/œÑP(a \\\\mid s) = \\\\frac{e^{Q(s,a)/\\\\tau}}{\\\\sum\\_{b} e^{Q(s,b)/\\\\tau}}\n*   where œÑœÑ\\\\tau controls exploration temperature.\n\n*   Encourages exploration of actions with higher uncertainty in their value estimates.\n\nThese techniques are crucial for preventing premature convergence to suboptimal policies, especially in stochastic or large environments.\n\n#### Strengths and Limitations\n\n*   **Advantages:**\n    \n    *   Simpler and easier to implement than model-based methods.\n    *   No need for an explicit environment model.\n    *   Robust across varied environments and tasks.\n*   **Limitations:**\n    \n    *   Poor sample efficiency due to reliance on real experience.\n    *   Limited ability to plan or simulate long-term outcomes.\n    *   Exploration‚Äìexploitation trade-offs can be difficult to tune.\n\n**Advantages:**\n\n*   Simpler and easier to implement than model-based methods.\n*   No need for an explicit environment model.\n*   Robust across varied environments and tasks.\n\n**Limitations:**\n\n*   Poor sample efficiency due to reliance on real experience.\n*   Limited ability to plan or simulate long-term outcomes.\n*   Exploration‚Äìexploitation trade-offs can be difficult to tune.\n\n#### Comparative Analysis\n\n**Algorithm**\n\n**Policy Type**\n\n**Model Requirement**\n\n**Learning Type**\n\n**Key References**\n\n**SARSA**\n\nOn-policy\n\nModel-free\n\nTD control\n\n[Rummery & Niranjan (1994)](https://www.researchgate.net/publication/228845724_On-line_Q-learning_using_connectionist_systems)\n\n**Q-Learning**\n\nOff-policy\n\nModel-free\n\nTD control\n\n[Watkins & Dayan (1992)](https://link.springer.com/article/10.1007/BF00992698)\n\n**Off-Policy Evaluation**\n\nOff-policy\n\nModel-free\n\nImportance sampling\n\n[Precup, Sutton & Singh (2000)](https://proceedings.neurips.cc/paper_files/paper/2000/file/094a3a42a20f93b8c0833d6505eaa8b3-Paper.pdf)\n\n**Algorithm**\n\n**Policy Type**\n\n**Model Requirement**\n\n**Learning Type**\n\n**Key References**\n\n**SARSA**\n\nOn-policy\n\nModel-free\n\nTD control\n\n[Rummery & Niranjan (1994)](https://www.researchgate.net/publication/228845724_On-line_Q-learning_using_connectionist_systems)\n\n**Q-Learning**\n\nOff-policy\n\nModel-free\n\nTD control\n\n[Watkins & Dayan (1992)](https://link.springer.com/article/10.1007/BF00992698)\n\n**Off-Policy Evaluation**\n\nOff-policy\n\nModel-free\n\nImportance sampling\n\n[Precup, Sutton & Singh (2000)](https://proceedings.neurips.cc/paper_files/paper/2000/file/094a3a42a20f93b8c0833d6505eaa8b3-Paper.pdf)",
    "order": 13,
    "orderInChapter": 5,
    "difficulty": 3,
    "estimatedMinutes": 7,
    "tags": [
      "algorithmsarchitecture",
      "reinforcement learning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 1251,
      "contentLength": 124912
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#model-free-reinforcement-learning",
    "scrapedAt": "2025-12-28T11:47:08.459Z"
  },
  {
    "id": "ai-reinforcement-learning-on-policy-vs-off-policy-reinforcement-learning-14",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Types of Reinforcement Learning",
    "title": "On-Policy vs. Off-Policy Reinforcement Learning",
    "subtitle": "Types of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>\n    <p>In reinforcement learning, a critical design choice is <strong>how experience is collected and used to update the agent‚Äôs knowledge</strong>.\nThis gives rise to two fundamental paradigms ‚Äî <strong>on-policy</strong> and <strong>off-policy</strong> learning ‚Äî which differ in the relationship between the policy being <em>improved</em> and the policy being <em>used to generate data</em>.</p>\n  </li>\n  <li>\n    <p>These paradigms span across value-based, policy-based, and actor‚Äìcritic methods, and understanding their trade-offs is essential for algorithm design and stability.</p>\n  </li>\n</ul>\n<p>In reinforcement learning, a critical design choice is <strong>how experience is collected and used to update the agent‚Äôs knowledge</strong>.\nThis gives rise to two fundamental paradigms ‚Äî <strong>on-policy</strong> and <strong>off-policy</strong> learning ‚Äî which differ in the relationship between the policy being <em>improved</em> and the policy being <em>used to generate data</em>.</p>\n<p>These paradigms span across value-based, policy-based, and actor‚Äìcritic methods, and understanding their trade-offs is essential for algorithm design and stability.</p>\n<h4 id=\"core-distinction\">Core Distinction</h4>\n<ul>\n  <li>\n    <p>Let:</p>\n\n    <ul>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-162-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2200\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2201\"><span class=\"mi\" id=\"MathJax-Span-2202\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-162\">\\pi</script> denote the <strong>target policy</strong>, i.e., the policy being optimized, and</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-163-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03BC;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2203\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2204\"><span class=\"mi\" id=\"MathJax-Span-2205\" style=\"font-family: STIXGeneral-Italic;\">Œº</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œº</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-163\">\\mu</script> denote the <strong>behavior policy</strong>, i.e., the policy used to generate experience data.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Then:</p>\n\n    <ul>\n      <li>\n        <p><strong>On-Policy Learning:</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-164-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi><mo>=</mo><mi>&amp;#x03BC;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2206\" style=\"width: 2.815em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1002.29em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2207\"><span class=\"mi\" id=\"MathJax-Span-2208\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2209\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-2210\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Œº</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi><mo>=</mo><mi>Œº</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-164\">\\pi = \\mu</script>\nThe agent learns from data generated by its current policy.</p>\n      </li>\n      <li>\n        <p><strong>Off-Policy Learning:</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-165-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi><mo>&amp;#x2260;</mo><mi>&amp;#x03BC;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2211\" style=\"width: 2.815em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.29em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2212\"><span class=\"mi\" id=\"MathJax-Span-2213\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2214\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚â†</span><span class=\"mi\" id=\"MathJax-Span-2215\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Œº</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi><mo>‚â†</mo><mi>Œº</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-165\">\\pi \\neq \\mu</script>\nThe agent learns from data collected under a different policy (e.g., past versions of itself, exploratory policies, or logged data).</p>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>This distinction influences the agent‚Äôs stability, efficiency, and ability to reuse old experiences.</p>\n  </li>\n</ul>\n<p>Let:</p>\n<ul>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-162-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2200\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2201\"><span class=\"mi\" id=\"MathJax-Span-2202\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-162\">\\pi</script> denote the <strong>target policy</strong>, i.e., the policy being optimized, and</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-163-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03BC;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2203\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2204\"><span class=\"mi\" id=\"MathJax-Span-2205\" style=\"font-family: STIXGeneral-Italic;\">Œº</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œº</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-163\">\\mu</script> denote the <strong>behavior policy</strong>, i.e., the policy used to generate experience data.</li>\n    </ul>\n<p>Then:</p>\n<ul>\n      <li>\n        <p><strong>On-Policy Learning:</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-164-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi><mo>=</mo><mi>&amp;#x03BC;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2206\" style=\"width: 2.815em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1002.29em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2207\"><span class=\"mi\" id=\"MathJax-Span-2208\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2209\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-2210\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Œº</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi><mo>=</mo><mi>Œº</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-164\">\\pi = \\mu</script>\nThe agent learns from data generated by its current policy.</p>\n      </li>\n      <li>\n        <p><strong>Off-Policy Learning:</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-165-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi><mo>&amp;#x2260;</mo><mi>&amp;#x03BC;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2211\" style=\"width: 2.815em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.29em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2212\"><span class=\"mi\" id=\"MathJax-Span-2213\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2214\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚â†</span><span class=\"mi\" id=\"MathJax-Span-2215\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Œº</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi><mo>‚â†</mo><mi>Œº</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-165\">\\pi \\neq \\mu</script>\nThe agent learns from data collected under a different policy (e.g., past versions of itself, exploratory policies, or logged data).</p>\n      </li>\n    </ul>\n<p><strong>On-Policy Learning:</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-164-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi><mo>=</mo><mi>&amp;#x03BC;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2206\" style=\"width: 2.815em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1002.29em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2207\"><span class=\"mi\" id=\"MathJax-Span-2208\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2209\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-2210\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Œº</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi><mo>=</mo><mi>Œº</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-164\">\\pi = \\mu</script>\nThe agent learns from data generated by its current policy.</p>\n<p><strong>Off-Policy Learning:</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-165-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi><mo>&amp;#x2260;</mo><mi>&amp;#x03BC;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2211\" style=\"width: 2.815em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.29em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2212\"><span class=\"mi\" id=\"MathJax-Span-2213\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2214\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚â†</span><span class=\"mi\" id=\"MathJax-Span-2215\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Œº</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi><mo>‚â†</mo><mi>Œº</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-165\">\\pi \\neq \\mu</script>\nThe agent learns from data collected under a different policy (e.g., past versions of itself, exploratory policies, or logged data).</p>\n<p>This distinction influences the agent‚Äôs stability, efficiency, and ability to reuse old experiences.</p>\n<h4 id=\"on-policy-learning\">On-Policy Learning</h4>\n<ul>\n  <li>\n    <p>In <strong>on-policy</strong> methods, the agent continuously improves the same policy it uses to interact with the environment.\nThis ensures <strong>consistency</strong> between learning and behavior, but requires ongoing exploration and data collection.</p>\n  </li>\n  <li>\n    <p>Mathematically, for a policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-166-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2216\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2217\"><span class=\"mi\" id=\"MathJax-Span-2218\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-166\">\\pi</script>, the value function satisfies:</p>\n  </li>\n</ul>\n<p>In <strong>on-policy</strong> methods, the agent continuously improves the same policy it uses to interact with the environment.\nThis ensures <strong>consistency</strong> between learning and behavior, but requires ongoing exploration and data collection.</p>\n<p>Mathematically, for a policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-166-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2216\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2217\"><span class=\"mi\" id=\"MathJax-Span-2218\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-166\">\\pi</script>, the value function satisfies:</p>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-167-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>S</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2219\" style=\"width: 14.951em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.451em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1012.14em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2220\"><span class=\"msubsup\" id=\"MathJax-Span-2221\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2222\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-2223\"><span class=\"mrow\" id=\"MathJax-Span-2224\"><span class=\"mi\" id=\"MathJax-Span-2225\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2226\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2227\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2228\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2229\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-2230\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2231\"><span class=\"mrow\" id=\"MathJax-Span-2232\"><span class=\"mi\" id=\"MathJax-Span-2233\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2234\"><span class=\"mrow\" id=\"MathJax-Span-2235\"><span class=\"mi\" id=\"MathJax-Span-2236\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-2237\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-2238\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-2239\"><span class=\"munderover\" id=\"MathJax-Span-2240\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2241\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-2242\"><span class=\"mrow\" id=\"MathJax-Span-2243\"><span class=\"mi\" id=\"MathJax-Span-2244\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2245\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-2246\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -5.206em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-2247\"><span class=\"mrow\" id=\"MathJax-Span-2248\"><span class=\"mi\" id=\"MathJax-Span-2249\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àû</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2250\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2251\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2252\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2253\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2254\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2255\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2256\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-2257\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2258\" style=\"font-family: STIXGeneral-Italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mn\" id=\"MathJax-Span-2259\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2260\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-2261\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span></span><span class=\"mo\" id=\"MathJax-Span-2262\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">‚àû</mi></mrow></munderover><msup><mi>Œ≥</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>S</mi><mn>0</mn></msub><mo>=</mo><mi>s</mi></mrow><mo>]</mo></mrow></math></span></span></div>\n<ul>\n  <li>A classical example is <strong>SARSA</strong> (<a href=\"https://www.researchgate.net/publication/228845724_On-line_Q-learning_using_connectionist_systems\">Rummery &amp; Niranjan, 1994</a>), which updates its Q-values based on the actual next action taken by the same policy:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-168-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>&amp;#x2190;</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B1;</mi><mo stretchy=&quot;false&quot;>[</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B3;</mi><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2263\" style=\"width: 26.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 22.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1022.24em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2264\"><span class=\"mi\" id=\"MathJax-Span-2265\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2266\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2267\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2268\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2269\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2270\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2271\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2272\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2273\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2274\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2275\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üê</span><span class=\"mi\" id=\"MathJax-Span-2276\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2277\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2278\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2279\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2280\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2281\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2282\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2283\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2284\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2285\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2286\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-2287\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ±</span><span class=\"mo\" id=\"MathJax-Span-2288\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-2289\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2290\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2291\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2292\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-2293\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-2294\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2295\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2296\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2297\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-2298\"><span class=\"mrow\" id=\"MathJax-Span-2299\"><span class=\"mi\" id=\"MathJax-Span-2300\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2301\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-2302\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2303\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2304\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2305\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-2306\"><span class=\"mrow\" id=\"MathJax-Span-2307\"><span class=\"mi\" id=\"MathJax-Span-2308\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2309\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-2310\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2311\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2312\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-2313\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2314\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2315\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2316\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2317\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2318\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2319\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2320\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2321\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2322\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2323\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">‚Üê</mo><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>+</mo><mi>Œ±</mi><mo stretchy=\"false\">[</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>Œ≥</mi><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span></div>\n<ul>\n  <li>This results in a learning process that closely tracks the policy‚Äôs real performance ‚Äî leading to greater <strong>stability</strong>, though potentially slower convergence.</li>\n</ul>\n<h4 id=\"off-policy-learning\">Off-Policy Learning</h4>\n<ul>\n  <li>\n    <p>In <strong>off-policy</strong> methods, the agent can learn from experience generated by <strong>another policy</strong>, allowing it to leverage past data, demonstrations, or exploration strategies.</p>\n  </li>\n  <li>\n    <p>For example, <strong>Q-Learning</strong> (<a href=\"https://link.springer.com/article/10.1007/BF00992698\">Watkins &amp; Dayan, 1992</a>) uses the behavior policy to collect data, but learns about the optimal (greedy) target policy:</p>\n  </li>\n</ul>\n<p>In <strong>off-policy</strong> methods, the agent can learn from experience generated by <strong>another policy</strong>, allowing it to leverage past data, demonstrations, or exploration strategies.</p>\n<p>For example, <strong>Q-Learning</strong> (<a href=\"https://link.springer.com/article/10.1007/BF00992698\">Watkins &amp; Dayan, 1992</a>) uses the behavior policy to collect data, but learns about the optimal (greedy) target policy:</p>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-169-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>&amp;#x2190;</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B1;</mi><mo stretchy=&quot;false&quot;>[</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B3;</mi><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup></mrow></munder><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2324\" style=\"width: 28.44em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 23.701em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1023.6em, 3.18em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2325\"><span class=\"mi\" id=\"MathJax-Span-2326\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2327\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2328\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2329\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2330\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2331\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2332\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2333\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2334\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2335\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2336\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üê</span><span class=\"mi\" id=\"MathJax-Span-2337\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2338\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2339\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2340\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2341\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2342\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2343\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2344\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2345\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2346\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2347\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-2348\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ±</span><span class=\"mo\" id=\"MathJax-Span-2349\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-2350\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2351\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2352\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2353\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-2354\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"munderover\" id=\"MathJax-Span-2355\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2356\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1000.58em, 4.273em, -999.997em); top: -3.279em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-2357\"><span class=\"mrow\" id=\"MathJax-Span-2358\"><span class=\"msup\" id=\"MathJax-Span-2359\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2360\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-2361\" style=\"font-size: 50%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-2362\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2363\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2364\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2365\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-2366\"><span class=\"mrow\" id=\"MathJax-Span-2367\"><span class=\"mi\" id=\"MathJax-Span-2368\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2369\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-2370\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2371\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-2372\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2373\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-2374\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2375\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2376\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-2377\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2378\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2379\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2380\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2381\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2382\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2383\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2384\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2385\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2386\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2387\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.059em; border-left: 0px solid; width: 0px; height: 2.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">‚Üê</mo><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>+</mo><mi>Œ±</mi><mo stretchy=\"false\">[</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>Œ≥</mi><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mrow class=\"MJX-TeXAtom-ORD\"><msup><mi>a</mi><mo>‚Ä≤</mo></msup></mrow></munder><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msup><mi>a</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mi>Q</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span></div>\n<ul>\n  <li>Here, the agent‚Äôs <strong>learning policy (greedy)</strong> differs from its <strong>behavior policy (exploratory)</strong> ‚Äî enabling <strong>data reuse</strong>, <strong>offline learning</strong>, and <strong>greater flexibility</strong>.</li>\n</ul>\n<h4 id=\"importance-sampling-for-off-policy-correction\">Importance Sampling for Off-Policy Correction</h4>\n<ul>\n  <li>Off-policy learning introduces <strong>distribution mismatch</strong> between the target policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-170-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2388\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2389\"><span class=\"mi\" id=\"MathJax-Span-2390\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-170\">\\pi</script> and behavior policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-171-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03BC;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2391\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2392\"><span class=\"mi\" id=\"MathJax-Span-2393\" style=\"font-family: STIXGeneral-Italic;\">Œº</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œº</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-171\">\\mu</script>.</li>\n  <li>To correct for this bias, <strong>importance sampling</strong> re-weights returns by the probability ratio of target and behavior policies:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-172-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>&amp;#x03C1;</mi><mi>t</mi></msub><mo>=</mo><mfrac><mrow><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi>&amp;#x03BC;</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2394\" style=\"width: 7.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.68em, 1005.89em, 3.232em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2395\"><span class=\"msubsup\" id=\"MathJax-Span-2396\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2397\" style=\"font-family: STIXGeneral-Italic;\">œÅ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2398\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2399\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-2400\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.701em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.49em, 4.378em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.768em;\"><span class=\"mrow\" id=\"MathJax-Span-2401\"><span class=\"mi\" id=\"MathJax-Span-2402\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2403\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2404\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2405\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2406\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2407\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-2408\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2409\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2410\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2411\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1003.49em, 4.378em, -999.997em); top: -3.331em; left: 50%; margin-left: -1.768em;\"><span class=\"mrow\" id=\"MathJax-Span-2412\"><span class=\"mi\" id=\"MathJax-Span-2413\" style=\"font-family: STIXGeneral-Italic;\">Œº</span><span class=\"mo\" id=\"MathJax-Span-2414\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2415\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2416\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2417\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2418\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-2419\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2420\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2421\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2422\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.7em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.701em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>œÅ</mi><mi>t</mi></msub><mo>=</mo><mfrac><mrow><mi>œÄ</mi><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><mi>Œº</mi><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span></div>\n<ul>\n  <li>\n    <p>The corrected value estimate becomes:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-173-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03BC;</mi></mrow></msub><mrow><mo>[</mo><mrow><msub><mi>&amp;#x03C1;</mi><mi>t</mi></msub><mo>,</mo><msub><mi>G</mi><mi>t</mi></msub></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2423\" style=\"width: 9.586em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.971em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1007.87em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2424\"><span class=\"msubsup\" id=\"MathJax-Span-2425\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2426\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-2427\"><span class=\"mrow\" id=\"MathJax-Span-2428\"><span class=\"mi\" id=\"MathJax-Span-2429\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2430\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-2431\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2432\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2433\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2434\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2435\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-2436\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2437\"><span class=\"mrow\" id=\"MathJax-Span-2438\"><span class=\"mi\" id=\"MathJax-Span-2439\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2440\"><span class=\"mrow\" id=\"MathJax-Span-2441\"><span class=\"mi\" id=\"MathJax-Span-2442\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-2443\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-2444\" style=\"vertical-align: 0.003em;\"><span style=\"font-family: STIXGeneral-Regular;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-2445\"><span class=\"msubsup\" id=\"MathJax-Span-2446\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2447\" style=\"font-family: STIXGeneral-Italic;\">œÅ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2448\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2449\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2450\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2451\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-2452\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2453\" style=\"vertical-align: 0.003em;\"><span style=\"font-family: STIXGeneral-Regular;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>Œº</mi></mrow></msub><mrow><mo>[</mo><mrow><msub><mi>œÅ</mi><mi>t</mi></msub><mo>,</mo><msub><mi>G</mi><mi>t</mi></msub></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-173\">V^{\\pi}(s_t) = \\mathbb{E}_{\\mu} \\left[ \\rho_t , G_t \\right]</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-174-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mi>t</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mi>t</mi></mrow></msup><msub><mi>r</mi><mi>k</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2454\" style=\"width: 8.232em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1006.83em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2455\"><span class=\"msubsup\" id=\"MathJax-Span-2456\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2457\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-2458\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2459\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-2460\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2461\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.73em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-2462\"><span class=\"mrow\" id=\"MathJax-Span-2463\"><span class=\"mi\" id=\"MathJax-Span-2464\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àû</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.1em, 4.169em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-2465\"><span class=\"mrow\" id=\"MathJax-Span-2466\"><span class=\"mi\" id=\"MathJax-Span-2467\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2468\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mi\" id=\"MathJax-Span-2469\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2470\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2471\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-2472\"><span class=\"mrow\" id=\"MathJax-Span-2473\"><span class=\"mi\" id=\"MathJax-Span-2474\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2475\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-2476\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2477\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2478\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2479\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mi>t</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">‚àû</mi></mrow></munderover><msup><mi>Œ≥</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>‚àí</mo><mi>t</mi></mrow></msup><msub><mi>r</mi><mi>k</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-174\">G_t = \\sum_{k=t}^{\\infty} \\gamma^{k-t} r_k</script> is the observed return.</li>\n    </ul>\n  </li>\n  <li>\n    <p>This technique allows off-policy algorithms to learn about arbitrary target policies from diverse datasets ‚Äî a foundation for <strong>offline RL</strong> and <strong>batch learning</strong>.</p>\n  </li>\n  <li>\n    <p>Key reference: <a href=\"https://proceedings.neurips.cc/paper_files/paper/2000/file/094a3a42a20f93b8c0833d6505eaa8b3-Paper.pdf\">Precup, Sutton &amp; Singh (2000)</a>.</p>\n  </li>\n</ul>\n<p>The corrected value estimate becomes:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-174-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mi>t</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mi>t</mi></mrow></msup><msub><mi>r</mi><mi>k</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2454\" style=\"width: 8.232em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1006.83em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2455\"><span class=\"msubsup\" id=\"MathJax-Span-2456\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2457\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-2458\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2459\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-2460\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2461\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.73em, 4.169em, -999.997em); top: -4.477em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-2462\"><span class=\"mrow\" id=\"MathJax-Span-2463\"><span class=\"mi\" id=\"MathJax-Span-2464\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àû</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.1em, 4.169em, -999.997em); top: -3.695em; left: 0.94em;\"><span class=\"texatom\" id=\"MathJax-Span-2465\"><span class=\"mrow\" id=\"MathJax-Span-2466\"><span class=\"mi\" id=\"MathJax-Span-2467\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2468\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mi\" id=\"MathJax-Span-2469\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2470\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2471\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-2472\"><span class=\"mrow\" id=\"MathJax-Span-2473\"><span class=\"mi\" id=\"MathJax-Span-2474\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2475\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-2476\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2477\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2478\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2479\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mi>t</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">‚àû</mi></mrow></munderover><msup><mi>Œ≥</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>‚àí</mo><mi>t</mi></mrow></msup><msub><mi>r</mi><mi>k</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-174\">G_t = \\sum_{k=t}^{\\infty} \\gamma^{k-t} r_k</script> is the observed return.</li>\n    </ul>\n<p>This technique allows off-policy algorithms to learn about arbitrary target policies from diverse datasets ‚Äî a foundation for <strong>offline RL</strong> and <strong>batch learning</strong>.</p>\n<p>Key reference: <a href=\"https://proceedings.neurips.cc/paper_files/paper/2000/file/094a3a42a20f93b8c0833d6505eaa8b3-Paper.pdf\">Precup, Sutton &amp; Singh (2000)</a>.</p>\n<h4 id=\"biasvariance-trade-off\">Bias‚ÄìVariance Trade-Off</h4>\n<ul>\n  <li>The two paradigms exhibit complementary characteristics:</li>\n</ul>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Property</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>On-Policy</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Off-Policy</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">Bias</td>\n<td class=\"tg-tleft-valign-first\">Low (samples match learning policy)</td>\n<td class=\"tg-tleft-valign-second\">Potentially high (distribution mismatch)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Variance</td>\n<td class=\"tg-tleft-valign-first\">Moderate</td>\n<td class=\"tg-tleft-valign-second\">High (due to importance weights)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Sample Efficiency</td>\n<td class=\"tg-tleft-valign-first\">Low (requires fresh data)</td>\n<td class=\"tg-tleft-valign-second\">High (reuses past experiences)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Stability</td>\n<td class=\"tg-tleft-valign-first\">High</td>\n<td class=\"tg-tleft-valign-second\">Can be unstable without correction</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Applicability</td>\n<td class=\"tg-tleft-valign-first\">Online / continual learning</td>\n<td class=\"tg-tleft-valign-second\">Offline / batch learning</td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Property</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>On-Policy</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Off-Policy</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">Bias</td>\n<td class=\"tg-tleft-valign-first\">Low (samples match learning policy)</td>\n<td class=\"tg-tleft-valign-second\">Potentially high (distribution mismatch)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Variance</td>\n<td class=\"tg-tleft-valign-first\">Moderate</td>\n<td class=\"tg-tleft-valign-second\">High (due to importance weights)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Sample Efficiency</td>\n<td class=\"tg-tleft-valign-first\">Low (requires fresh data)</td>\n<td class=\"tg-tleft-valign-second\">High (reuses past experiences)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Stability</td>\n<td class=\"tg-tleft-valign-first\">High</td>\n<td class=\"tg-tleft-valign-second\">Can be unstable without correction</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Applicability</td>\n<td class=\"tg-tleft-valign-first\">Online / continual learning</td>\n<td class=\"tg-tleft-valign-second\">Offline / batch learning</td>\n</tr>\n</tbody>\n</table>\n<ul>\n  <li>In practice, hybrid approaches such as <strong>actor‚Äìcritic</strong> or <strong>experience replay</strong> systems combine both paradigms to balance stability and efficiency.</li>\n</ul>\n<h4 id=\"examples-of-on--and-off-policy-algorithms\">Examples of On- and Off-Policy Algorithms</h4>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Algorithm</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Type</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Method Class</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Learning Mechanism</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Key References</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>SARSA</strong></td>\n<td class=\"tg-tleft-valign-first\">On-Policy</td>\n<td class=\"tg-tleft-valign-first\">Value-Based</td>\n<td class=\"tg-tleft-valign-first\">TD update using actual next action</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://www.researchgate.net/publication/228845724_On-line_Q-learning_using_connectionist_systems\">Rummery &amp; Niranjan (1994)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>REINFORCE</strong></td>\n<td class=\"tg-tleft-valign-first\">On-Policy</td>\n<td class=\"tg-tleft-valign-first\">Policy-Based</td>\n<td class=\"tg-tleft-valign-first\">Monte Carlo gradient using own policy</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://www.sciencedirect.com/science/article/abs/pii/S0893608005800100\">Williams (1992)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Actor‚ÄìCritic (A2C)</strong></td>\n<td class=\"tg-tleft-valign-first\">On-Policy</td>\n<td class=\"tg-tleft-valign-first\">Hybrid</td>\n<td class=\"tg-tleft-valign-first\">TD-based advantage estimation</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://www.sciencedirect.com/science/article/abs/pii/S0893608005800136\">Barto, Sutton &amp; Anderson (1983)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Q-Learning</strong></td>\n<td class=\"tg-tleft-valign-first\">Off-Policy</td>\n<td class=\"tg-tleft-valign-first\">Value-Based</td>\n<td class=\"tg-tleft-valign-first\">Bootstrapped max operator</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://link.springer.com/article/10.1007/BF00992698\">Watkins &amp; Dayan (1992)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Dyna-Q</strong></td>\n<td class=\"tg-tleft-valign-first\">Off-Policy</td>\n<td class=\"tg-tleft-valign-first\">Model-Based</td>\n<td class=\"tg-tleft-valign-first\">Synthetic rollouts with Q-learning</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://www.researchgate.net/publication/220320601_Integrated_Architectures_for_Learning_Planning_and_Reactive_Control\">Sutton (1990)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Off-Policy Policy Gradient (OPPG)</strong></td>\n<td class=\"tg-tleft-valign-first\">Off-Policy</td>\n<td class=\"tg-tleft-valign-first\">Policy-Based</td>\n<td class=\"tg-tleft-valign-first\">Importance-weighted gradient updates</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://proceedings.neurips.cc/paper_files/paper/2012/file/1cecc7a77928ca8133fa24680a88d2f9-Paper.pdf\">Degris, White &amp; Sutton (2012)</a></td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Algorithm</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Type</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Method Class</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Learning Mechanism</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Key References</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>SARSA</strong></td>\n<td class=\"tg-tleft-valign-first\">On-Policy</td>\n<td class=\"tg-tleft-valign-first\">Value-Based</td>\n<td class=\"tg-tleft-valign-first\">TD update using actual next action</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://www.researchgate.net/publication/228845724_On-line_Q-learning_using_connectionist_systems\">Rummery &amp; Niranjan (1994)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>REINFORCE</strong></td>\n<td class=\"tg-tleft-valign-first\">On-Policy</td>\n<td class=\"tg-tleft-valign-first\">Policy-Based</td>\n<td class=\"tg-tleft-valign-first\">Monte Carlo gradient using own policy</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://www.sciencedirect.com/science/article/abs/pii/S0893608005800100\">Williams (1992)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Actor‚ÄìCritic (A2C)</strong></td>\n<td class=\"tg-tleft-valign-first\">On-Policy</td>\n<td class=\"tg-tleft-valign-first\">Hybrid</td>\n<td class=\"tg-tleft-valign-first\">TD-based advantage estimation</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://www.sciencedirect.com/science/article/abs/pii/S0893608005800136\">Barto, Sutton &amp; Anderson (1983)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Q-Learning</strong></td>\n<td class=\"tg-tleft-valign-first\">Off-Policy</td>\n<td class=\"tg-tleft-valign-first\">Value-Based</td>\n<td class=\"tg-tleft-valign-first\">Bootstrapped max operator</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://link.springer.com/article/10.1007/BF00992698\">Watkins &amp; Dayan (1992)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Dyna-Q</strong></td>\n<td class=\"tg-tleft-valign-first\">Off-Policy</td>\n<td class=\"tg-tleft-valign-first\">Model-Based</td>\n<td class=\"tg-tleft-valign-first\">Synthetic rollouts with Q-learning</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://www.researchgate.net/publication/220320601_Integrated_Architectures_for_Learning_Planning_and_Reactive_Control\">Sutton (1990)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Off-Policy Policy Gradient (OPPG)</strong></td>\n<td class=\"tg-tleft-valign-first\">Off-Policy</td>\n<td class=\"tg-tleft-valign-first\">Policy-Based</td>\n<td class=\"tg-tleft-valign-first\">Importance-weighted gradient updates</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://proceedings.neurips.cc/paper_files/paper/2012/file/1cecc7a77928ca8133fa24680a88d2f9-Paper.pdf\">Degris, White &amp; Sutton (2012)</a></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"takeaways\">Takeaways</h4>\n<ul>\n  <li>\n    <p>On-policy methods excel in <strong>stability</strong> and <strong>interpretability</strong>, making them ideal for online learning in dynamic environments.\nOff-policy methods, in contrast, enable <strong>data efficiency</strong> and <strong>reusability</strong>, powering modern <strong>offline reinforcement learning</strong> and <strong>experience replay</strong> systems.</p>\n  </li>\n  <li>\n    <p>Both paradigms are fundamental to reinforcement learning‚Äôs evolution ‚Äî their interplay forming the theoretical basis for hybrid algorithms such as <strong>actor‚Äìcritic</strong>, <strong>Dyna</strong>, and deep variants like <strong>DDPG</strong> and <strong>SAC</strong> in later generations.</p>\n  </li>\n</ul>\n<p>On-policy methods excel in <strong>stability</strong> and <strong>interpretability</strong>, making them ideal for online learning in dynamic environments.\nOff-policy methods, in contrast, enable <strong>data efficiency</strong> and <strong>reusability</strong>, powering modern <strong>offline reinforcement learning</strong> and <strong>experience replay</strong> systems.</p>\n<p>Both paradigms are fundamental to reinforcement learning‚Äôs evolution ‚Äî their interplay forming the theoretical basis for hybrid algorithms such as <strong>actor‚Äìcritic</strong>, <strong>Dyna</strong>, and deep variants like <strong>DDPG</strong> and <strong>SAC</strong> in later generations.</p>",
    "contentMarkdown": "*   In reinforcement learning, a critical design choice is **how experience is collected and used to update the agent‚Äôs knowledge**. This gives rise to two fundamental paradigms ‚Äî **on-policy** and **off-policy** learning ‚Äî which differ in the relationship between the policy being _improved_ and the policy being _used to generate data_.\n    \n*   These paradigms span across value-based, policy-based, and actor‚Äìcritic methods, and understanding their trade-offs is essential for algorithm design and stability.\n    \n\nIn reinforcement learning, a critical design choice is **how experience is collected and used to update the agent‚Äôs knowledge**. This gives rise to two fundamental paradigms ‚Äî **on-policy** and **off-policy** learning ‚Äî which differ in the relationship between the policy being _improved_ and the policy being _used to generate data_.\n\nThese paradigms span across value-based, policy-based, and actor‚Äìcritic methods, and understanding their trade-offs is essential for algorithm design and stability.\n\n#### Core Distinction\n\n*   Let:\n    \n    *   œÄœÄ\\\\pi denote the **target policy**, i.e., the policy being optimized, and\n    *   ŒºŒº\\\\mu denote the **behavior policy**, i.e., the policy used to generate experience data.\n*   Then:\n    \n    *   **On-Policy Learning:** œÄ\\=ŒºœÄ\\=Œº\\\\pi = \\\\mu The agent learns from data generated by its current policy.\n        \n    *   **Off-Policy Learning:** œÄ‚â†ŒºœÄ‚â†Œº\\\\pi \\\\neq \\\\mu The agent learns from data collected under a different policy (e.g., past versions of itself, exploratory policies, or logged data).\n        \n*   This distinction influences the agent‚Äôs stability, efficiency, and ability to reuse old experiences.\n    \n\nLet:\n\n*   œÄœÄ\\\\pi denote the **target policy**, i.e., the policy being optimized, and\n*   ŒºŒº\\\\mu denote the **behavior policy**, i.e., the policy used to generate experience data.\n\nThen:\n\n*   **On-Policy Learning:** œÄ\\=ŒºœÄ\\=Œº\\\\pi = \\\\mu The agent learns from data generated by its current policy.\n    \n*   **Off-Policy Learning:** œÄ‚â†ŒºœÄ‚â†Œº\\\\pi \\\\neq \\\\mu The agent learns from data collected under a different policy (e.g., past versions of itself, exploratory policies, or logged data).\n    \n\n**On-Policy Learning:** œÄ\\=ŒºœÄ\\=Œº\\\\pi = \\\\mu The agent learns from data generated by its current policy.\n\n**Off-Policy Learning:** œÄ‚â†ŒºœÄ‚â†Œº\\\\pi \\\\neq \\\\mu The agent learns from data collected under a different policy (e.g., past versions of itself, exploratory policies, or logged data).\n\nThis distinction influences the agent‚Äôs stability, efficiency, and ability to reuse old experiences.\n\n#### On-Policy Learning\n\n*   In **on-policy** methods, the agent continuously improves the same policy it uses to interact with the environment. This ensures **consistency** between learning and behavior, but requires ongoing exploration and data collection.\n    \n*   Mathematically, for a policy œÄœÄ\\\\pi, the value function satisfies:\n    \n\nIn **on-policy** methods, the agent continuously improves the same policy it uses to interact with the environment. This ensures **consistency** between learning and behavior, but requires ongoing exploration and data collection.\n\nMathematically, for a policy œÄœÄ\\\\pi, the value function satisfies:\n\nVœÄ(s)\\=ùîºœÄ\\[‚àët\\=0‚àûŒ≥trt‚à£S0\\=s\\]VœÄ(s)\\=EœÄ\\[‚àët\\=0‚àûŒ≥trt‚à£S0\\=s\\]\n\n*   A classical example is **SARSA** ([Rummery & Niranjan, 1994](https://www.researchgate.net/publication/228845724_On-line_Q-learning_using_connectionist_systems)), which updates its Q-values based on the actual next action taken by the same policy:\n\nQ(st,at)‚ÜêQ(st,at)+Œ±\\[rt+Œ≥Q(st+1,at+1)‚àíQ(st,at)\\]Q(st,at)‚ÜêQ(st,at)+Œ±\\[rt+Œ≥Q(st+1,at+1)‚àíQ(st,at)\\]\n\n*   This results in a learning process that closely tracks the policy‚Äôs real performance ‚Äî leading to greater **stability**, though potentially slower convergence.\n\n#### Off-Policy Learning\n\n*   In **off-policy** methods, the agent can learn from experience generated by **another policy**, allowing it to leverage past data, demonstrations, or exploration strategies.\n    \n*   For example, **Q-Learning** ([Watkins & Dayan, 1992](https://link.springer.com/article/10.1007/BF00992698)) uses the behavior policy to collect data, but learns about the optimal (greedy) target policy:\n    \n\nIn **off-policy** methods, the agent can learn from experience generated by **another policy**, allowing it to leverage past data, demonstrations, or exploration strategies.\n\nFor example, **Q-Learning** ([Watkins & Dayan, 1992](https://link.springer.com/article/10.1007/BF00992698)) uses the behavior policy to collect data, but learns about the optimal (greedy) target policy:\n\nQ(st,at)‚ÜêQ(st,at)+Œ±\\[rt+Œ≥maxa‚Ä≤Q(st+1,a‚Ä≤)‚àíQ(st,at)\\]Q(st,at)‚ÜêQ(st,at)+Œ±\\[rt+Œ≥maxa‚Ä≤Q(st+1,a‚Ä≤)‚àíQ(st,at)\\]\n\n*   Here, the agent‚Äôs **learning policy (greedy)** differs from its **behavior policy (exploratory)** ‚Äî enabling **data reuse**, **offline learning**, and **greater flexibility**.\n\n#### Importance Sampling for Off-Policy Correction\n\n*   Off-policy learning introduces **distribution mismatch** between the target policy œÄœÄ\\\\pi and behavior policy ŒºŒº\\\\mu.\n*   To correct for this bias, **importance sampling** re-weights returns by the probability ratio of target and behavior policies:\n\nœÅt\\=œÄ(at‚à£st)Œº(at‚à£st)œÅt\\=œÄ(at‚à£st)Œº(at‚à£st)\n\n*   The corrected value estimate becomes:\n    \n    VœÄ(st)\\=ùîºŒº\\[œÅt,Gt\\]VœÄ(st)\\=EŒº\\[œÅt,Gt\\]\n    \n    V^{\\\\pi}(s\\_t) = \\\\mathbb{E}\\_{\\\\mu} \\\\left\\[ \\\\rho\\_t , G\\_t \\\\right\\]\n    *   where Gt\\=‚àë‚àûk\\=tŒ≥k‚àítrkGt\\=‚àëk\\=t‚àûŒ≥k‚àítrkG\\_t = \\\\sum\\_{k=t}^{\\\\infty} \\\\gamma^{k-t} r\\_k is the observed return.\n*   This technique allows off-policy algorithms to learn about arbitrary target policies from diverse datasets ‚Äî a foundation for **offline RL** and **batch learning**.\n    \n*   Key reference: [Precup, Sutton & Singh (2000)](https://proceedings.neurips.cc/paper_files/paper/2000/file/094a3a42a20f93b8c0833d6505eaa8b3-Paper.pdf).\n    \n\nThe corrected value estimate becomes:\n\n*   where Gt\\=‚àë‚àûk\\=tŒ≥k‚àítrkGt\\=‚àëk\\=t‚àûŒ≥k‚àítrkG\\_t = \\\\sum\\_{k=t}^{\\\\infty} \\\\gamma^{k-t} r\\_k is the observed return.\n\nThis technique allows off-policy algorithms to learn about arbitrary target policies from diverse datasets ‚Äî a foundation for **offline RL** and **batch learning**.\n\nKey reference: [Precup, Sutton & Singh (2000)](https://proceedings.neurips.cc/paper_files/paper/2000/file/094a3a42a20f93b8c0833d6505eaa8b3-Paper.pdf).\n\n#### Bias‚ÄìVariance Trade-Off\n\n*   The two paradigms exhibit complementary characteristics:\n\n**Property**\n\n**On-Policy**\n\n**Off-Policy**\n\nBias\n\nLow (samples match learning policy)\n\nPotentially high (distribution mismatch)\n\nVariance\n\nModerate\n\nHigh (due to importance weights)\n\nSample Efficiency\n\nLow (requires fresh data)\n\nHigh (reuses past experiences)\n\nStability\n\nHigh\n\nCan be unstable without correction\n\nApplicability\n\nOnline / continual learning\n\nOffline / batch learning\n\n**Property**\n\n**On-Policy**\n\n**Off-Policy**\n\nBias\n\nLow (samples match learning policy)\n\nPotentially high (distribution mismatch)\n\nVariance\n\nModerate\n\nHigh (due to importance weights)\n\nSample Efficiency\n\nLow (requires fresh data)\n\nHigh (reuses past experiences)\n\nStability\n\nHigh\n\nCan be unstable without correction\n\nApplicability\n\nOnline / continual learning\n\nOffline / batch learning\n\n*   In practice, hybrid approaches such as **actor‚Äìcritic** or **experience replay** systems combine both paradigms to balance stability and efficiency.\n\n#### Examples of On- and Off-Policy Algorithms\n\n**Algorithm**\n\n**Type**\n\n**Method Class**\n\n**Learning Mechanism**\n\n**Key References**\n\n**SARSA**\n\nOn-Policy\n\nValue-Based\n\nTD update using actual next action\n\n[Rummery & Niranjan (1994)](https://www.researchgate.net/publication/228845724_On-line_Q-learning_using_connectionist_systems)\n\n**REINFORCE**\n\nOn-Policy\n\nPolicy-Based\n\nMonte Carlo gradient using own policy\n\n[Williams (1992)](https://www.sciencedirect.com/science/article/abs/pii/S0893608005800100)\n\n**Actor‚ÄìCritic (A2C)**\n\nOn-Policy\n\nHybrid\n\nTD-based advantage estimation\n\n[Barto, Sutton & Anderson (1983)](https://www.sciencedirect.com/science/article/abs/pii/S0893608005800136)\n\n**Q-Learning**\n\nOff-Policy\n\nValue-Based\n\nBootstrapped max operator\n\n[Watkins & Dayan (1992)](https://link.springer.com/article/10.1007/BF00992698)\n\n**Dyna-Q**\n\nOff-Policy\n\nModel-Based\n\nSynthetic rollouts with Q-learning\n\n[Sutton (1990)](https://www.researchgate.net/publication/220320601_Integrated_Architectures_for_Learning_Planning_and_Reactive_Control)\n\n**Off-Policy Policy Gradient (OPPG)**\n\nOff-Policy\n\nPolicy-Based\n\nImportance-weighted gradient updates\n\n[Degris, White & Sutton (2012)](https://proceedings.neurips.cc/paper_files/paper/2012/file/1cecc7a77928ca8133fa24680a88d2f9-Paper.pdf)\n\n**Algorithm**\n\n**Type**\n\n**Method Class**\n\n**Learning Mechanism**\n\n**Key References**\n\n**SARSA**\n\nOn-Policy\n\nValue-Based\n\nTD update using actual next action\n\n[Rummery & Niranjan (1994)](https://www.researchgate.net/publication/228845724_On-line_Q-learning_using_connectionist_systems)\n\n**REINFORCE**\n\nOn-Policy\n\nPolicy-Based\n\nMonte Carlo gradient using own policy\n\n[Williams (1992)](https://www.sciencedirect.com/science/article/abs/pii/S0893608005800100)\n\n**Actor‚ÄìCritic (A2C)**\n\nOn-Policy\n\nHybrid\n\nTD-based advantage estimation\n\n[Barto, Sutton & Anderson (1983)](https://www.sciencedirect.com/science/article/abs/pii/S0893608005800136)\n\n**Q-Learning**\n\nOff-Policy\n\nValue-Based\n\nBootstrapped max operator\n\n[Watkins & Dayan (1992)](https://link.springer.com/article/10.1007/BF00992698)\n\n**Dyna-Q**\n\nOff-Policy\n\nModel-Based\n\nSynthetic rollouts with Q-learning\n\n[Sutton (1990)](https://www.researchgate.net/publication/220320601_Integrated_Architectures_for_Learning_Planning_and_Reactive_Control)\n\n**Off-Policy Policy Gradient (OPPG)**\n\nOff-Policy\n\nPolicy-Based\n\nImportance-weighted gradient updates\n\n[Degris, White & Sutton (2012)](https://proceedings.neurips.cc/paper_files/paper/2012/file/1cecc7a77928ca8133fa24680a88d2f9-Paper.pdf)\n\n#### Takeaways\n\n*   On-policy methods excel in **stability** and **interpretability**, making them ideal for online learning in dynamic environments. Off-policy methods, in contrast, enable **data efficiency** and **reusability**, powering modern **offline reinforcement learning** and **experience replay** systems.\n    \n*   Both paradigms are fundamental to reinforcement learning‚Äôs evolution ‚Äî their interplay forming the theoretical basis for hybrid algorithms such as **actor‚Äìcritic**, **Dyna**, and deep variants like **DDPG** and **SAC** in later generations.\n    \n\nOn-policy methods excel in **stability** and **interpretability**, making them ideal for online learning in dynamic environments. Off-policy methods, in contrast, enable **data efficiency** and **reusability**, powering modern **offline reinforcement learning** and **experience replay** systems.\n\nBoth paradigms are fundamental to reinforcement learning‚Äôs evolution ‚Äî their interplay forming the theoretical basis for hybrid algorithms such as **actor‚Äìcritic**, **Dyna**, and deep variants like **DDPG** and **SAC** in later generations.",
    "order": 14,
    "orderInChapter": 6,
    "difficulty": 4,
    "estimatedMinutes": 6,
    "tags": [
      "algorithmsarchitecture",
      "reinforcement learning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 1171,
      "contentLength": 102276
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#on-policy-vs.-off-policy-reinforcement-learning",
    "scrapedAt": "2025-12-28T11:47:08.460Z"
  },
  {
    "id": "ai-reinforcement-learning-deep-reinforcement-learning-15",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Types of Reinforcement Learning",
    "title": "Deep Reinforcement Learning",
    "subtitle": "Types of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>\n    <p>Deep Reinforcement Learning (Deep RL) refers to the integration of deep neural networks with reinforcement learning, enabling agents to operate in high-dimensional, raw-input spaces (such as images or sensor feeds) and learn complex policies or value functions with minimal manual feature engineering. Classical RL methods (value-based, policy-based, model-based etc.) provided the foundational theory; Deep RL extends these by using neural networks as function approximators for value functions, policies, or models.</p>\n  </li>\n  <li>\n    <p>In Deep RL, one often writes:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-175-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><msub><mi>V</mi><mi>w</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><msub><mi>Q</mi><mi>w</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2480\" style=\"width: 11.669em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.69em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1009.64em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2481\"><span class=\"msubsup\" id=\"MathJax-Span-2482\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2483\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2484\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2485\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2486\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-2487\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-2488\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-2489\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2490\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2491\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2492\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-2493\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2494\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2495\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2496\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2497\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-2498\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2499\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-2500\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2501\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2502\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2503\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2504\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-2505\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>,</mo><msub><mi>V</mi><mi>w</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>,</mo><msub><mi>Q</mi><mi>w</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-175\">\\pi_\\theta(a \\mid s),  V_w(s),  Q_w(s,a)</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-176-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi><mo>,</mo><mi>w</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2506\" style=\"width: 2.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.72em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2507\"><span class=\"mi\" id=\"MathJax-Span-2508\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2509\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2510\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">w</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ∏</mi><mo>,</mo><mi>w</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-176\">\\theta, w</script> are deep network parameters. The networks can approximate large or continuous state and action spaces, enabling Deep RL to surpass classical tabular or linear-function-approximation RL in many applications.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Below are the major families of deep RL techniques which have defined the landscape of deep RL, with each representing a distinct way of integrating neural networks with the reinforcement learning paradigm.</p>\n  </li>\n</ul>\n<p>Deep Reinforcement Learning (Deep RL) refers to the integration of deep neural networks with reinforcement learning, enabling agents to operate in high-dimensional, raw-input spaces (such as images or sensor feeds) and learn complex policies or value functions with minimal manual feature engineering. Classical RL methods (value-based, policy-based, model-based etc.) provided the foundational theory; Deep RL extends these by using neural networks as function approximators for value functions, policies, or models.</p>\n<p>In Deep RL, one often writes:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-176-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi><mo>,</mo><mi>w</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2506\" style=\"width: 2.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.72em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2507\"><span class=\"mi\" id=\"MathJax-Span-2508\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2509\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2510\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">w</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ∏</mi><mo>,</mo><mi>w</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-176\">\\theta, w</script> are deep network parameters. The networks can approximate large or continuous state and action spaces, enabling Deep RL to surpass classical tabular or linear-function-approximation RL in many applications.</li>\n    </ul>\n<p>Below are the major families of deep RL techniques which have defined the landscape of deep RL, with each representing a distinct way of integrating neural networks with the reinforcement learning paradigm.</p>\n<h4 id=\"deep-value-based-methods\">Deep Value-Based Methods</h4>\n<ul>\n  <li>\n    <p>These methods extend classical value-based RL by approximating <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-177-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2511\" style=\"width: 3.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.66em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2512\"><span class=\"mi\" id=\"MathJax-Span-2513\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2514\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2515\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2516\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2517\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-2518\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-177\">Q(s,a)</script> (or <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-178-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2519\" style=\"width: 2.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.77em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2520\"><span class=\"mi\" id=\"MathJax-Span-2521\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2522\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2523\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2524\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-178\">V(s)</script>) via deep neural networks and selecting actions greedily (or nearly so) from those networks.</p>\n\n    <ul>\n      <li><strong>Deep Q-Network (DQN)</strong>, introduced in <em>‚ÄúHuman-level control through deep reinforcement learning‚Äù</em> by <a href=\"https://www.nature.com/articles/nature14236\">Mnih et al. (2015)</a>, showed an agent learning to play Atari 2600 games from raw pixels.</li>\n      <li>Variants include Double DQN, Dueling networks, prioritized experience replay, etc.</li>\n    </ul>\n  </li>\n</ul>\n<p>These methods extend classical value-based RL by approximating <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-177-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2511\" style=\"width: 3.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.66em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2512\"><span class=\"mi\" id=\"MathJax-Span-2513\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2514\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2515\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2516\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2517\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-2518\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-177\">Q(s,a)</script> (or <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-178-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2519\" style=\"width: 2.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.77em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2520\"><span class=\"mi\" id=\"MathJax-Span-2521\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2522\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2523\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2524\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-178\">V(s)</script>) via deep neural networks and selecting actions greedily (or nearly so) from those networks.</p>\n<ul>\n      <li><strong>Deep Q-Network (DQN)</strong>, introduced in <em>‚ÄúHuman-level control through deep reinforcement learning‚Äù</em> by <a href=\"https://www.nature.com/articles/nature14236\">Mnih et al. (2015)</a>, showed an agent learning to play Atari 2600 games from raw pixels.</li>\n      <li>Variants include Double DQN, Dueling networks, prioritized experience replay, etc.</li>\n    </ul>\n<h4 id=\"deep-policy-based-methods\">Deep Policy-Based Methods</h4>\n<ul>\n  <li>\n    <p>In this family, the policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-179-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2525\" style=\"width: 4.013em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.336em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.28em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2526\"><span class=\"msubsup\" id=\"MathJax-Span-2527\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2528\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2529\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2530\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2531\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-2532\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-2533\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-2534\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-179\">\\pi_\\theta(a \\mid s)</script> is parameterized by a deep network and optimized directly via policy gradients, bypassing explicit value-function estimation (though value functions may still be used as baselines).</p>\n\n    <ul>\n      <li><strong>Policy Gradient Methods</strong> (function‚Äêapproximation context) by <a href=\"https://papers.nips.cc/paper/1713-policy-gradient-methods-for-reinforcement-learning-with-function-approximation.pdf\">Sutton et al. (2000)</a> ‚Äî although not ‚Äúdeep‚Äù per se, this work laid the basis for deep policy-gradient RL.</li>\n      <li>Later deep-policy work includes algorithms like TRPO, PPO, etc.</li>\n    </ul>\n  </li>\n</ul>\n<p>In this family, the policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-179-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2525\" style=\"width: 4.013em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.336em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.28em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2526\"><span class=\"msubsup\" id=\"MathJax-Span-2527\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2528\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2529\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2530\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2531\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-2532\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-2533\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-2534\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-179\">\\pi_\\theta(a \\mid s)</script> is parameterized by a deep network and optimized directly via policy gradients, bypassing explicit value-function estimation (though value functions may still be used as baselines).</p>\n<ul>\n      <li><strong>Policy Gradient Methods</strong> (function‚Äêapproximation context) by <a href=\"https://papers.nips.cc/paper/1713-policy-gradient-methods-for-reinforcement-learning-with-function-approximation.pdf\">Sutton et al. (2000)</a> ‚Äî although not ‚Äúdeep‚Äù per se, this work laid the basis for deep policy-gradient RL.</li>\n      <li>Later deep-policy work includes algorithms like TRPO, PPO, etc.</li>\n    </ul>\n<h4 id=\"deep-actorcritic-methods\">Deep Actor‚ÄìCritic Methods</h4>\n<ul>\n  <li>\n    <p>These methods combine deep policy networks (actor) with deep value or Q-networks (critic). The critic evaluates the current policy, and the actor uses this feedback to update. They offer the expressiveness of deep policies with the stability of value-based evaluation.</p>\n\n    <ul>\n      <li>One deep actor‚Äìcritic method: <strong>Deep Deterministic Policy Gradient (DDPG)</strong> by <a href=\"https://arxiv.org/abs/1509.02971\">Lillicrap et al. (2015)</a> ‚Äî handles continuous action spaces using an actor‚Äìcritic architecture (commonly referenced in Deep RL surveys).</li>\n      <li>More recent deep actor‚Äìcritics include SAC, TD3, etc.</li>\n    </ul>\n  </li>\n</ul>\n<p>These methods combine deep policy networks (actor) with deep value or Q-networks (critic). The critic evaluates the current policy, and the actor uses this feedback to update. They offer the expressiveness of deep policies with the stability of value-based evaluation.</p>\n<ul>\n      <li>One deep actor‚Äìcritic method: <strong>Deep Deterministic Policy Gradient (DDPG)</strong> by <a href=\"https://arxiv.org/abs/1509.02971\">Lillicrap et al. (2015)</a> ‚Äî handles continuous action spaces using an actor‚Äìcritic architecture (commonly referenced in Deep RL surveys).</li>\n      <li>More recent deep actor‚Äìcritics include SAC, TD3, etc.</li>\n    </ul>\n<h4 id=\"deep-model-based-methods\">Deep Model-Based Methods</h4>\n<ul>\n  <li>Here, deep networks are used to learn models of the environment <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-180-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>P</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2223;</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>R</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2535\" style=\"width: 8.701em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1007.19em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2536\"><span class=\"texatom\" id=\"MathJax-Span-2537\"><span class=\"mrow\" id=\"MathJax-Span-2538\"><span class=\"munderover\" id=\"MathJax-Span-2539\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2540\" style=\"font-family: STIXGeneral-Italic;\">P</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-2541\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2542\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-2543\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2544\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-2545\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2546\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-2547\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-2548\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2549\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-2550\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2551\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-2552\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-2553\"><span class=\"munderover\" id=\"MathJax-Span-2554\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2555\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-2556\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2557\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2558\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2559\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2560\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-2561\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>P</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>‚à£</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>R</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-180\">\\hat P(s' \\mid s,a), \\hat R(s,a)</script>, or latent dynamics, which enable planning or simulation in high-dimensional spaces.</li>\n</ul>",
    "contentMarkdown": "*   Deep Reinforcement Learning (Deep RL) refers to the integration of deep neural networks with reinforcement learning, enabling agents to operate in high-dimensional, raw-input spaces (such as images or sensor feeds) and learn complex policies or value functions with minimal manual feature engineering. Classical RL methods (value-based, policy-based, model-based etc.) provided the foundational theory; Deep RL extends these by using neural networks as function approximators for value functions, policies, or models.\n    \n*   In Deep RL, one often writes:\n    \n    œÄŒ∏(a‚à£s),Vw(s),Qw(s,a)œÄŒ∏(a‚à£s),Vw(s),Qw(s,a)\n    \n    \\\\pi\\_\\\\theta(a \\\\mid s), V\\_w(s), Q\\_w(s,a)\n    *   where Œ∏,wŒ∏,w\\\\theta, w are deep network parameters. The networks can approximate large or continuous state and action spaces, enabling Deep RL to surpass classical tabular or linear-function-approximation RL in many applications.\n*   Below are the major families of deep RL techniques which have defined the landscape of deep RL, with each representing a distinct way of integrating neural networks with the reinforcement learning paradigm.\n    \n\nDeep Reinforcement Learning (Deep RL) refers to the integration of deep neural networks with reinforcement learning, enabling agents to operate in high-dimensional, raw-input spaces (such as images or sensor feeds) and learn complex policies or value functions with minimal manual feature engineering. Classical RL methods (value-based, policy-based, model-based etc.) provided the foundational theory; Deep RL extends these by using neural networks as function approximators for value functions, policies, or models.\n\nIn Deep RL, one often writes:\n\n*   where Œ∏,wŒ∏,w\\\\theta, w are deep network parameters. The networks can approximate large or continuous state and action spaces, enabling Deep RL to surpass classical tabular or linear-function-approximation RL in many applications.\n\nBelow are the major families of deep RL techniques which have defined the landscape of deep RL, with each representing a distinct way of integrating neural networks with the reinforcement learning paradigm.\n\n#### Deep Value-Based Methods\n\n*   These methods extend classical value-based RL by approximating Q(s,a)Q(s,a)Q(s,a) (or V(s)V(s)V(s)) via deep neural networks and selecting actions greedily (or nearly so) from those networks.\n    \n    *   **Deep Q-Network (DQN)**, introduced in _‚ÄúHuman-level control through deep reinforcement learning‚Äù_ by [Mnih et al. (2015)](https://www.nature.com/articles/nature14236), showed an agent learning to play Atari 2600 games from raw pixels.\n    *   Variants include Double DQN, Dueling networks, prioritized experience replay, etc.\n\nThese methods extend classical value-based RL by approximating Q(s,a)Q(s,a)Q(s,a) (or V(s)V(s)V(s)) via deep neural networks and selecting actions greedily (or nearly so) from those networks.\n\n*   **Deep Q-Network (DQN)**, introduced in _‚ÄúHuman-level control through deep reinforcement learning‚Äù_ by [Mnih et al. (2015)](https://www.nature.com/articles/nature14236), showed an agent learning to play Atari 2600 games from raw pixels.\n*   Variants include Double DQN, Dueling networks, prioritized experience replay, etc.\n\n#### Deep Policy-Based Methods\n\n*   In this family, the policy œÄŒ∏(a‚à£s)œÄŒ∏(a‚à£s)\\\\pi\\_\\\\theta(a \\\\mid s) is parameterized by a deep network and optimized directly via policy gradients, bypassing explicit value-function estimation (though value functions may still be used as baselines).\n    \n    *   **Policy Gradient Methods** (function‚Äêapproximation context) by [Sutton et al. (2000)](https://papers.nips.cc/paper/1713-policy-gradient-methods-for-reinforcement-learning-with-function-approximation.pdf) ‚Äî although not ‚Äúdeep‚Äù per se, this work laid the basis for deep policy-gradient RL.\n    *   Later deep-policy work includes algorithms like TRPO, PPO, etc.\n\nIn this family, the policy œÄŒ∏(a‚à£s)œÄŒ∏(a‚à£s)\\\\pi\\_\\\\theta(a \\\\mid s) is parameterized by a deep network and optimized directly via policy gradients, bypassing explicit value-function estimation (though value functions may still be used as baselines).\n\n*   **Policy Gradient Methods** (function‚Äêapproximation context) by [Sutton et al. (2000)](https://papers.nips.cc/paper/1713-policy-gradient-methods-for-reinforcement-learning-with-function-approximation.pdf) ‚Äî although not ‚Äúdeep‚Äù per se, this work laid the basis for deep policy-gradient RL.\n*   Later deep-policy work includes algorithms like TRPO, PPO, etc.\n\n#### Deep Actor‚ÄìCritic Methods\n\n*   These methods combine deep policy networks (actor) with deep value or Q-networks (critic). The critic evaluates the current policy, and the actor uses this feedback to update. They offer the expressiveness of deep policies with the stability of value-based evaluation.\n    \n    *   One deep actor‚Äìcritic method: **Deep Deterministic Policy Gradient (DDPG)** by [Lillicrap et al. (2015)](https://arxiv.org/abs/1509.02971) ‚Äî handles continuous action spaces using an actor‚Äìcritic architecture (commonly referenced in Deep RL surveys).\n    *   More recent deep actor‚Äìcritics include SAC, TD3, etc.\n\nThese methods combine deep policy networks (actor) with deep value or Q-networks (critic). The critic evaluates the current policy, and the actor uses this feedback to update. They offer the expressiveness of deep policies with the stability of value-based evaluation.\n\n*   One deep actor‚Äìcritic method: **Deep Deterministic Policy Gradient (DDPG)** by [Lillicrap et al. (2015)](https://arxiv.org/abs/1509.02971) ‚Äî handles continuous action spaces using an actor‚Äìcritic architecture (commonly referenced in Deep RL surveys).\n*   More recent deep actor‚Äìcritics include SAC, TD3, etc.\n\n#### Deep Model-Based Methods\n\n*   Here, deep networks are used to learn models of the environment PÃÇ¬†(s‚Ä≤‚à£s,a),RÃÇ¬†(s,a)P^(s‚Ä≤‚à£s,a),R^(s,a)\\\\hat P(s' \\\\mid s,a), \\\\hat R(s,a), or latent dynamics, which enable planning or simulation in high-dimensional spaces.",
    "order": 15,
    "orderInChapter": 7,
    "difficulty": 3,
    "estimatedMinutes": 4,
    "tags": [
      "algorithmsarchitecture",
      "neural network",
      "reinforcement learning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 765,
      "contentLength": 33827
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#deep-reinforcement-learning",
    "scrapedAt": "2025-12-28T11:47:08.460Z"
  },
  {
    "id": "ai-reinforcement-learning-deep-value-based-methods-16",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Types of Reinforcement Learning",
    "title": "Deep Value-Based Methods",
    "subtitle": "Types of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>Deep Value-Based methods extend classical <strong>value-based reinforcement learning</strong>‚Äîsuch as Q-learning‚Äîby using deep neural networks to approximate the value function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-181-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2562\" style=\"width: 3.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.66em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2563\"><span class=\"mi\" id=\"MathJax-Span-2564\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2565\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2566\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2567\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2568\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-2569\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-181\">Q(s,a)</script>.</li>\n  <li>This innovation enables agents to operate in high-dimensional observation spaces (like raw images), overcoming the limitations of tabular and linear methods that dominated early RL research.</li>\n</ul>\n<h4 id=\"background-from-q-learning-to-deep-q-learning\">Background: from Q-Learning to Deep Q-Learning</h4>\n<ul>\n  <li>In classical Q-learning, the optimal action-value function satisfies the <strong>Bellman Optimality Equation</strong>:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-182-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>Q</mi><mo>&amp;#x2217;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup></mrow></msub><mrow><mo>[</mo><mrow><mi>r</mi><mo>+</mo><mi>&amp;#x03B3;</mi><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup></mrow></munder><msup><mi>Q</mi><mo>&amp;#x2217;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>,</mo><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2570\" style=\"width: 17.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 14.69em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.398em, 1014.48em, 4.794em, -999.997em); top: -3.799em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2571\"><span class=\"msubsup\" id=\"MathJax-Span-2572\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2573\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.732em;\"><span class=\"mo\" id=\"MathJax-Span-2574\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àó</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2575\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2576\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2577\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2578\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-2579\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2580\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-2581\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2582\"><span class=\"mrow\" id=\"MathJax-Span-2583\"><span class=\"mi\" id=\"MathJax-Span-2584\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2585\"><span class=\"mrow\" id=\"MathJax-Span-2586\"><span class=\"msup\" id=\"MathJax-Span-2587\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2588\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.216em; left: 0.263em;\"><span class=\"mo\" id=\"MathJax-Span-2589\" style=\"font-size: 50%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-2590\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-2591\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">[</span></span></span><span class=\"mrow\" id=\"MathJax-Span-2592\"><span class=\"mi\" id=\"MathJax-Span-2593\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2594\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-2595\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"munderover\" id=\"MathJax-Span-2596\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2597\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1000.58em, 4.273em, -999.997em); top: -3.279em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-2598\"><span class=\"mrow\" id=\"MathJax-Span-2599\"><span class=\"msup\" id=\"MathJax-Span-2600\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2601\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-2602\" style=\"font-size: 50%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2603\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2604\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.732em;\"><span class=\"mo\" id=\"MathJax-Span-2605\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àó</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2606\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-2607\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2608\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-2609\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2610\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-2611\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2612\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-2613\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2614\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-2615\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">]</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.805em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.059em; border-left: 0px solid; width: 0px; height: 2.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>Q</mi><mo>‚àó</mo></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msup><mi>s</mi><mo>‚Ä≤</mo></msup></mrow></msub><mrow><mo>[</mo><mrow><mi>r</mi><mo>+</mo><mi>Œ≥</mi><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mrow class=\"MJX-TeXAtom-ORD\"><msup><mi>a</mi><mo>‚Ä≤</mo></msup></mrow></munder><msup><mi>Q</mi><mo>‚àó</mo></msup><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>,</mo><msup><mi>a</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div>\n<ul>\n  <li>However, maintaining a tabular representation of <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-183-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2616\" style=\"width: 3.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.66em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2617\"><span class=\"mi\" id=\"MathJax-Span-2618\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2619\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2620\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2621\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2622\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-2623\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-183\">Q(s,a)</script> becomes infeasible in large or continuous state spaces.</li>\n  <li>Deep Value-Based methods overcome this by parameterizing <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-184-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2624\" style=\"width: 3.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.66em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2625\"><span class=\"mi\" id=\"MathJax-Span-2626\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2627\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2628\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2629\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2630\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-2631\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-184\">Q(s,a)</script> as a deep neural network <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-185-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>Q</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2632\" style=\"width: 3.753em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.08em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2633\"><span class=\"msubsup\" id=\"MathJax-Span-2634\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2635\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-2636\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2637\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2638\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2639\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2640\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-2641\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>Q</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-185\">Q_\\theta(s,a)</script>, trained to minimize the <strong>Temporal Difference (TD) error</strong>:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-186-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>L</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>r</mi><mo>,</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><mrow><mo>[</mo><msup><mrow><mo>(</mo><mrow><mi>r</mi><mo>+</mo><mi>&amp;#x03B3;</mi><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup></mrow></munder><msub><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>&amp;#x03B8;</mi><mo>&amp;#x2212;</mo></msup></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>,</mo><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>Q</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>)</mo></mrow><mn>2</mn></msup><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2642\" style=\"width: 26.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 21.982em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.503em, 1021.77em, 5.263em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2643\"><span class=\"mi\" id=\"MathJax-Span-2644\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2645\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2646\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2647\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2648\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-2649\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2650\"><span class=\"mrow\" id=\"MathJax-Span-2651\"><span class=\"mi\" id=\"MathJax-Span-2652\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2653\"><span class=\"mrow\" id=\"MathJax-Span-2654\"><span class=\"mo\" id=\"MathJax-Span-2655\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2656\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2657\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2658\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-2659\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2660\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2661\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-2662\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2663\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.216em; left: 0.263em;\"><span class=\"mo\" id=\"MathJax-Span-2664\" style=\"font-size: 50%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2665\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-2666\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-2667\" style=\"vertical-align: -0.57em;\"><span style=\"font-family: STIXSizeThreeSym;\">[</span></span><span class=\"msubsup\" id=\"MathJax-Span-2668\"><span style=\"display: inline-block; position: relative; width: 14.586em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.607em, 1014.01em, 5.003em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2669\"><span class=\"mo\" id=\"MathJax-Span-2670\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">(</span></span></span><span class=\"mrow\" id=\"MathJax-Span-2671\"><span class=\"mi\" id=\"MathJax-Span-2672\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2673\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-2674\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"munderover\" id=\"MathJax-Span-2675\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2676\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1000.58em, 4.273em, -999.997em); top: -3.279em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-2677\"><span class=\"mrow\" id=\"MathJax-Span-2678\"><span class=\"msup\" id=\"MathJax-Span-2679\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2680\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-2681\" style=\"font-size: 50%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2682\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2683\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.799em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-2684\"><span class=\"mrow\" id=\"MathJax-Span-2685\"><span class=\"msubsup\" id=\"MathJax-Span-2686\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2687\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.419em;\"><span class=\"mo\" id=\"MathJax-Span-2688\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">‚àí</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2689\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-2690\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2691\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-2692\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2693\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-2694\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2695\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-2696\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2697\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2698\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-2699\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2700\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-2701\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2702\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2703\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2704\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2705\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-2706\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-2707\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">)</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.997em; left: 14.169em;\"><span class=\"mn\" id=\"MathJax-Span-2708\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2709\" style=\"vertical-align: -0.57em;\"><span style=\"font-family: STIXSizeThreeSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>L</mi><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>r</mi><mo>,</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo></mrow></msub><mrow><mo>[</mo><msup><mrow><mo>(</mo><mrow><mi>r</mi><mo>+</mo><mi>Œ≥</mi><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mrow class=\"MJX-TeXAtom-ORD\"><msup><mi>a</mi><mo>‚Ä≤</mo></msup></mrow></munder><msub><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><msup><mi>Œ∏</mi><mo>‚àí</mo></msup></mrow></msub><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>,</mo><msup><mi>a</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>Q</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><mo>)</mo></mrow><mn>2</mn></msup><mo>]</mo></mrow></math></span></span></div>\n<ul>\n  <li>Here, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-187-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>&amp;#x03B8;</mi><mo>&amp;#x2212;</mo></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2710\" style=\"width: 1.357em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1001.1em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2711\"><span class=\"msubsup\" id=\"MathJax-Span-2712\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2713\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.576em;\"><span class=\"mo\" id=\"MathJax-Span-2714\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àí</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>Œ∏</mi><mo>‚àí</mo></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-187\">\\theta^-</script> represents the parameters of a <strong>target network</strong>, updated periodically to stabilize training.</li>\n</ul>\n<h4 id=\"deep-q-network-dqn\">Deep Q-Network (DQN)</h4>\n<ul>\n  <li>The <strong>Deep Q-Network (DQN)</strong> introduced by <a href=\"https://www.nature.com/articles/nature14236\">Mnih et al. (2015)</a> marked a watershed moment for reinforcement learning.</li>\n  <li>\n    <p>By integrating convolutional neural networks with Q-learning, DQN achieved <strong>human-level control</strong> on Atari 2600 games from raw pixel inputs.</p>\n  </li>\n  <li>\n    <p>DQN introduced two key innovations to stabilize learning:</p>\n\n    <ol>\n      <li><strong>Experience Replay:</strong> Transitions <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-188-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>r</mi><mo>,</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2715\" style=\"width: 4.794em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.961em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1003.91em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2716\"><span class=\"mo\" id=\"MathJax-Span-2717\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2718\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2719\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2720\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-2721\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2722\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2723\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-2724\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2725\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-2726\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2727\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>r</mi><mo>,</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-188\">(s,a,r,s')</script> are stored in a replay buffer and sampled uniformly to break correlation between sequential updates.</li>\n      <li><strong>Target Network:</strong> A separate network <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-189-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>&amp;#x03B8;</mi><mo>&amp;#x2212;</mo></msup></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2728\" style=\"width: 1.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.62em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2729\"><span class=\"msubsup\" id=\"MathJax-Span-2730\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2731\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.799em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-2732\"><span class=\"mrow\" id=\"MathJax-Span-2733\"><span class=\"msubsup\" id=\"MathJax-Span-2734\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2735\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.419em;\"><span class=\"mo\" id=\"MathJax-Span-2736\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">‚àí</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><msup><mi>Œ∏</mi><mo>‚àí</mo></msup></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-189\">Q_{\\theta^-}</script> is used for target computation, updated less frequently to prevent divergence.</li>\n    </ol>\n  </li>\n  <li>The combined algorithm iteratively minimizes the TD loss above, leading to stable convergence in high-dimensional settings.</li>\n</ul>\n<p>By integrating convolutional neural networks with Q-learning, DQN achieved <strong>human-level control</strong> on Atari 2600 games from raw pixel inputs.</p>\n<p>DQN introduced two key innovations to stabilize learning:</p>\n<ol>\n      <li><strong>Experience Replay:</strong> Transitions <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-188-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>r</mi><mo>,</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2715\" style=\"width: 4.794em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.961em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1003.91em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2716\"><span class=\"mo\" id=\"MathJax-Span-2717\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2718\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2719\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2720\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-2721\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2722\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2723\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-2724\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2725\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-2726\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2727\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>r</mi><mo>,</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-188\">(s,a,r,s')</script> are stored in a replay buffer and sampled uniformly to break correlation between sequential updates.</li>\n      <li><strong>Target Network:</strong> A separate network <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-189-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>&amp;#x03B8;</mi><mo>&amp;#x2212;</mo></msup></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2728\" style=\"width: 1.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.62em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2729\"><span class=\"msubsup\" id=\"MathJax-Span-2730\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2731\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.799em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-2732\"><span class=\"mrow\" id=\"MathJax-Span-2733\"><span class=\"msubsup\" id=\"MathJax-Span-2734\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2735\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.419em;\"><span class=\"mo\" id=\"MathJax-Span-2736\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">‚àí</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><msup><mi>Œ∏</mi><mo>‚àí</mo></msup></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-189\">Q_{\\theta^-}</script> is used for target computation, updated less frequently to prevent divergence.</li>\n    </ol>\n<h4 id=\"double-dqn\">Double DQN</h4>\n<ul>\n  <li>One major limitation of the original DQN was <strong>overestimation bias</strong> in value updates due to the use of <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-190-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup></mrow></munder><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>,</mo><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2737\" style=\"width: 7.294em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.044em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1005.99em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2738\"><span class=\"munderover\" id=\"MathJax-Span-2739\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2740\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.799em; left: 1.721em;\"><span class=\"texatom\" id=\"MathJax-Span-2741\"><span class=\"mrow\" id=\"MathJax-Span-2742\"><span class=\"msup\" id=\"MathJax-Span-2743\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2744\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-2745\" style=\"font-size: 50%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-2746\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2747\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-2748\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2749\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-2750\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2751\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-2752\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2753\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-2754\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2755\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mrow class=\"MJX-TeXAtom-ORD\"><msup><mi>a</mi><mo>‚Ä≤</mo></msup></mrow></munder><mi>Q</mi><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>,</mo><msup><mi>a</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-190\">\\max_{a'} Q(s',a')</script> both for action selection and evaluation.</li>\n  <li>To address this, <strong>Double DQN</strong> by <a href=\"https://arxiv.org/abs/1509.06461\">van Hasselt et al. (2016)</a> decouples these steps:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-191-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>L</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mrow><mo>(</mo><mrow><mi>r</mi><mo>+</mo><mi>&amp;#x03B3;</mi><msub><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>&amp;#x03B8;</mi><mo>&amp;#x2212;</mo></msup></mrow></msub><mrow><mo>(</mo><mrow><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>,</mo><mi>arg</mi><mo>&amp;#x2061;</mo><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup></mrow></munder><msub><mi>Q</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>,</mo><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>)</mo></mrow><mo>&amp;#x2212;</mo><msub><mi>Q</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>)</mo></mrow><mn>2</mn></msup></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2756\" style=\"width: 27.294em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 22.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.576em, 1022.71em, 3.18em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2757\"><span class=\"mi\" id=\"MathJax-Span-2758\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2759\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2760\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2761\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2762\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-2763\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 19.69em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.607em, 1019.12em, 5.003em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2764\"><span class=\"mo\" id=\"MathJax-Span-2765\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">(</span></span></span><span class=\"mrow\" id=\"MathJax-Span-2766\"><span class=\"mi\" id=\"MathJax-Span-2767\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2768\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-2769\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-2770\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2771\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.799em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-2772\"><span class=\"mrow\" id=\"MathJax-Span-2773\"><span class=\"msubsup\" id=\"MathJax-Span-2774\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2775\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.419em;\"><span class=\"mo\" id=\"MathJax-Span-2776\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">‚àí</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-2777\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-2778\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">(</span></span></span><span class=\"mrow\" id=\"MathJax-Span-2779\"><span class=\"msup\" id=\"MathJax-Span-2780\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2781\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-2782\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2783\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2784\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">arg</span><span class=\"mo\" id=\"MathJax-Span-2785\"></span><span class=\"munderover\" id=\"MathJax-Span-2786\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2787\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1000.58em, 4.273em, -999.997em); top: -3.279em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-2788\"><span class=\"mrow\" id=\"MathJax-Span-2789\"><span class=\"msup\" id=\"MathJax-Span-2790\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2791\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-2792\" style=\"font-size: 50%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2793\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2794\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-2795\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2796\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-2797\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2798\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-2799\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2800\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-2801\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2802\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-2803\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2804\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-2805\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">)</span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2806\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-2807\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2808\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-2809\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2810\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2811\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2812\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2813\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-2814\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-2815\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">)</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.997em; left: 19.273em;\"><span class=\"mn\" id=\"MathJax-Span-2816\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.059em; border-left: 0px solid; width: 0px; height: 2.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>L</mi><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mrow><mo>(</mo><mrow><mi>r</mi><mo>+</mo><mi>Œ≥</mi><msub><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><msup><mi>Œ∏</mi><mo>‚àí</mo></msup></mrow></msub><mrow><mo>(</mo><mrow><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>,</mo><mi>arg</mi><mo>‚Å°</mo><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mrow class=\"MJX-TeXAtom-ORD\"><msup><mi>a</mi><mo>‚Ä≤</mo></msup></mrow></munder><msub><mi>Q</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>,</mo><msup><mi>a</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>)</mo></mrow><mo>‚àí</mo><msub><mi>Q</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><mo>)</mo></mrow><mn>2</mn></msup></math></span></span></div>\n<ul>\n  <li>This reduces overestimation and yields more accurate Q-value estimates, improving both stability and performance.</li>\n</ul>\n<h4 id=\"dueling-network-architecture\">Dueling Network Architecture</h4>\n<ul>\n  <li>\n    <p>The <strong>Dueling DQN</strong> architecture by <a href=\"https://arxiv.org/abs/1511.06581\">Wang et al. (2016)</a> decomposes the Q-function into two separate estimators:</p>\n\n    <ul>\n      <li>A <strong>state-value function</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-192-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2817\" style=\"width: 2.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.77em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2818\"><span class=\"mi\" id=\"MathJax-Span-2819\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2820\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2821\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2822\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-192\">V(s)</script></li>\n      <li>An <strong>advantage function</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-193-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2823\" style=\"width: 3.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.66em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2824\"><span class=\"mi\" id=\"MathJax-Span-2825\" style=\"font-family: STIXGeneral-Italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-2826\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2827\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2828\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2829\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-2830\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>A</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-193\">A(s,a)</script></li>\n    </ul>\n  </li>\n  <li>\n    <p>The combined Q-function is then reconstructed as:</p>\n  </li>\n</ul>\n<p>The <strong>Dueling DQN</strong> architecture by <a href=\"https://arxiv.org/abs/1511.06581\">Wang et al. (2016)</a> decomposes the Q-function into two separate estimators:</p>\n<ul>\n      <li>A <strong>state-value function</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-192-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2817\" style=\"width: 2.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.77em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2818\"><span class=\"mi\" id=\"MathJax-Span-2819\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2820\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2821\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2822\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-192\">V(s)</script></li>\n      <li>An <strong>advantage function</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-193-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2823\" style=\"width: 3.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.66em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2824\"><span class=\"mi\" id=\"MathJax-Span-2825\" style=\"font-family: STIXGeneral-Italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-2826\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2827\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2828\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2829\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-2830\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>A</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-193\">A(s,a)</script></li>\n    </ul>\n<p>The combined Q-function is then reconstructed as:</p>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-194-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>;</mo><mi>&amp;#x03B8;</mi><mo>,</mo><mi>&amp;#x03B1;</mi><mo>,</mo><mi>&amp;#x03B2;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>;</mo><mi>&amp;#x03B8;</mi><mo>,</mo><mi>&amp;#x03B2;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mrow><mo>(</mo><mrow><mi>A</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>;</mo><mi>&amp;#x03B8;</mi><mo>,</mo><mi>&amp;#x03B1;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mfrac><mn>1</mn><mrow><mo stretchy=&quot;false&quot;>&amp;#x2223;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>A</mi></mrow><mo stretchy=&quot;false&quot;>&amp;#x2223;</mo></mrow></mfrac><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup></mrow></munder><mi>A</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><msup><mi>a</mi><mo>&amp;#x2032;</mo></msup><mo>;</mo><mi>&amp;#x03B8;</mi><mo>,</mo><mi>&amp;#x03B1;</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>)</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2831\" style=\"width: 33.857em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 28.18em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1028.08em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2832\"><span class=\"mi\" id=\"MathJax-Span-2833\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span class=\"mo\" id=\"MathJax-Span-2834\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2835\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2836\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2837\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-2838\" style=\"font-family: STIXGeneral-Regular;\">;</span><span class=\"mi\" id=\"MathJax-Span-2839\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2840\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2841\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">Œ±</span><span class=\"mo\" id=\"MathJax-Span-2842\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2843\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2844\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2845\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-2846\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2847\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2848\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2849\" style=\"font-family: STIXGeneral-Regular;\">;</span><span class=\"mi\" id=\"MathJax-Span-2850\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2851\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2852\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2853\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2854\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mrow\" id=\"MathJax-Span-2855\" style=\"padding-left: 0.263em;\"><span class=\"mo\" id=\"MathJax-Span-2856\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">(</span></span><span class=\"mrow\" id=\"MathJax-Span-2857\"><span class=\"mi\" id=\"MathJax-Span-2858\" style=\"font-family: STIXGeneral-Italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-2859\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2860\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2861\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2862\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-2863\" style=\"font-family: STIXGeneral-Regular;\">;</span><span class=\"mi\" id=\"MathJax-Span-2864\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2865\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2866\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">Œ±</span><span class=\"mo\" id=\"MathJax-Span-2867\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2868\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mfrac\" id=\"MathJax-Span-2869\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;\"><span class=\"mn\" id=\"MathJax-Span-2870\" style=\"font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1001.3em, 4.378em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.674em;\"><span class=\"mrow\" id=\"MathJax-Span-2871\"><span class=\"mo\" id=\"MathJax-Span-2872\" style=\"font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"texatom\" id=\"MathJax-Span-2873\"><span class=\"mrow\" id=\"MathJax-Span-2874\"><span class=\"mi\" id=\"MathJax-Span-2875\" style=\"font-family: STIXNonUnicode-Italic;\">Óà≠</span></span></span><span class=\"mo\" id=\"MathJax-Span-2876\" style=\"font-family: STIXGeneral-Regular;\">‚à£</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1001.51em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.513em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-2877\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2878\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1000.58em, 4.273em, -999.997em); top: -2.81em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-2879\"><span class=\"mrow\" id=\"MathJax-Span-2880\"><span class=\"msup\" id=\"MathJax-Span-2881\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2882\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-2883\" style=\"font-size: 50%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-2884\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">A</span><span class=\"mo\" id=\"MathJax-Span-2885\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2886\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-2887\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-2888\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2889\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mo\" id=\"MathJax-Span-2890\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2891\" style=\"font-family: STIXGeneral-Regular;\">;</span><span class=\"mi\" id=\"MathJax-Span-2892\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2893\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-2894\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">Œ±</span><span class=\"mo\" id=\"MathJax-Span-2895\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-2896\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">)</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>Q</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>;</mo><mi>Œ∏</mi><mo>,</mo><mi>Œ±</mi><mo>,</mo><mi>Œ≤</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>V</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>;</mo><mi>Œ∏</mi><mo>,</mo><mi>Œ≤</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mrow><mo>(</mo><mrow><mi>A</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>;</mo><mi>Œ∏</mi><mo>,</mo><mi>Œ±</mi><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mfrac><mn>1</mn><mrow><mo stretchy=\"false\">‚à£</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">A</mi></mrow><mo stretchy=\"false\">‚à£</mo></mrow></mfrac><munder><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><msup><mi>a</mi><mo>‚Ä≤</mo></msup></mrow></munder><mi>A</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><msup><mi>a</mi><mo>‚Ä≤</mo></msup><mo>;</mo><mi>Œ∏</mi><mo>,</mo><mi>Œ±</mi><mo stretchy=\"false\">)</mo></mrow><mo>)</mo></mrow></math></span></span></div>\n<ul>\n  <li>This structure improves learning efficiency by allowing the network to learn which states are valuable, independent of the specific actions.</li>\n</ul>\n<h4 id=\"prioritized-experience-replay\">Prioritized Experience Replay</h4>\n<ul>\n  <li>Standard DQN samples uniformly from the replay buffer, treating all transitions equally.</li>\n  <li><strong>Prioritized Experience Replay</strong> by <a href=\"https://arxiv.org/abs/1511.05952\">Schaul et al. (2016)</a> instead samples transitions with probability proportional to their TD error magnitude:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-195-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><mo stretchy=&quot;false&quot;>&amp;#x2223;</mo><msub><mi>&amp;#x03B4;</mi><mi>i</mi></msub><msup><mo stretchy=&quot;false&quot;>&amp;#x2223;</mo><mi>&amp;#x03B1;</mi></msup></mrow><mrow><munder><mo>&amp;#x2211;</mo><mi>k</mi></munder><mo>&amp;#x2223;</mo><msub><mi>&amp;#x03B4;</mi><mi>k</mi></msub><msup><mo stretchy=&quot;false&quot;>&amp;#x2223;</mo><mi>&amp;#x03B1;</mi></msup></mrow></mfrac></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2897\" style=\"width: 8.232em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.68em, 1006.83em, 3.388em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2898\"><span class=\"mi\" id=\"MathJax-Span-2899\" style=\"font-family: STIXGeneral-Italic;\">P</span><span class=\"mo\" id=\"MathJax-Span-2900\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2901\" style=\"font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-2902\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2903\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-2904\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.909em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1001.72em, 4.378em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.883em;\"><span class=\"mrow\" id=\"MathJax-Span-2905\"><span class=\"mo\" id=\"MathJax-Span-2906\" style=\"font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-2907\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2908\" style=\"font-family: STIXGeneral-Italic;\">Œ¥</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-2909\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2910\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.16em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2911\" style=\"font-family: STIXGeneral-Regular;\">‚à£</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-2912\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ±</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.076em, 1003.8em, 4.482em, -999.997em); top: -3.279em; left: 50%; margin-left: -1.924em;\"><span class=\"mrow\" id=\"MathJax-Span-2913\"><span class=\"munderover\" id=\"MathJax-Span-2914\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2915\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.695em; left: 0.94em;\"><span class=\"mi\" id=\"MathJax-Span-2916\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2917\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-2918\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2919\" style=\"font-family: STIXGeneral-Italic;\">Œ¥</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-2920\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2921\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.16em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2922\" style=\"font-family: STIXGeneral-Regular;\">‚à£</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-2923\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ±</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.91em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.909em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.309em; border-left: 0px solid; width: 0px; height: 3.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>P</mi><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mo stretchy=\"false\">‚à£</mo><msub><mi>Œ¥</mi><mi>i</mi></msub><msup><mo stretchy=\"false\">‚à£</mo><mi>Œ±</mi></msup></mrow><mrow><munder><mo>‚àë</mo><mi>k</mi></munder><mo>‚à£</mo><msub><mi>Œ¥</mi><mi>k</mi></msub><msup><mo stretchy=\"false\">‚à£</mo><mi>Œ±</mi></msup></mrow></mfrac></math></span></span></div>\n<ul>\n  <li>\n    <p>This focuses updates on transitions where the model is most surprised, improving data efficiency and convergence rates.</p>\n  </li>\n  <li>\n    <p>To correct for the bias introduced by non-uniform sampling, importance sampling weights are applied:</p>\n  </li>\n</ul>\n<p>This focuses updates on transitions where the model is most surprised, improving data efficiency and convergence rates.</p>\n<p>To correct for the bias introduced by non-uniform sampling, importance sampling weights are applied:</p>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-196-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><msup><mrow><mo>(</mo><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac><mo>&amp;#x22C5;</mo><mfrac><mn>1</mn><mrow><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>i</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></mrow><mo>)</mo></mrow><mi>&amp;#x03B2;</mi></msup></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2924\" style=\"width: 9.273em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.711em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.471em, 1007.71em, 3.232em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2925\"><span class=\"msubsup\" id=\"MathJax-Span-2926\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2927\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"mi\" id=\"MathJax-Span-2928\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2929\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-2930\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 5.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.503em, 1005em, 5.055em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2931\"><span class=\"mo\" id=\"MathJax-Span-2932\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">(</span></span></span><span class=\"mrow\" id=\"MathJax-Span-2933\"><span class=\"mfrac\" id=\"MathJax-Span-2934\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;\"><span class=\"mn\" id=\"MathJax-Span-2935\" style=\"font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.362em;\"><span class=\"mi\" id=\"MathJax-Span-2936\" style=\"font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1000.84em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.836em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2937\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚ãÖ</span><span class=\"mfrac\" id=\"MathJax-Span-2938\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.669em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;\"><span class=\"mn\" id=\"MathJax-Span-2939\" style=\"font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1001.51em, 4.326em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.779em;\"><span class=\"mrow\" id=\"MathJax-Span-2940\"><span class=\"mi\" id=\"MathJax-Span-2941\" style=\"font-family: STIXGeneral-Italic;\">P</span><span class=\"mo\" id=\"MathJax-Span-2942\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2943\" style=\"font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-2944\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1001.67em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.669em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2945\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">)</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -5.102em; left: 5.159em;\"><span class=\"mi\" id=\"MathJax-Span-2946\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 3.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><msup><mrow><mo>(</mo><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac><mo>‚ãÖ</mo><mfrac><mn>1</mn><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow><mo>)</mo></mrow><mi>Œ≤</mi></msup></math></span></span></div>\n<h4 id=\"extensions-and-variants\">Extensions and Variants</h4>\n<ul>\n  <li>\n    <p>Several extensions of DQN further improved stability and performance:</p>\n\n    <ul>\n      <li><strong>NoisyNet DQN</strong> (<a href=\"https://arxiv.org/abs/1706.10295\">Fortunato et al., 2018</a>): adds parameterized noise for exploration.</li>\n      <li><strong>Rainbow DQN</strong> (<a href=\"https://arxiv.org/abs/1710.02298\">Hessel et al., 2018</a>): integrates multiple DQN enhancements (Double DQN, Dueling, Prioritized Replay, Noisy Nets, Distributional RL, and N-Step Returns).</li>\n      <li><strong>Distributional DQN</strong> (<a href=\"https://arxiv.org/abs/1707.06887\">Bellemare et al., 2017</a>): learns a distribution over returns rather than a scalar expected value.</li>\n    </ul>\n  </li>\n</ul>\n<p>Several extensions of DQN further improved stability and performance:</p>\n<ul>\n      <li><strong>NoisyNet DQN</strong> (<a href=\"https://arxiv.org/abs/1706.10295\">Fortunato et al., 2018</a>): adds parameterized noise for exploration.</li>\n      <li><strong>Rainbow DQN</strong> (<a href=\"https://arxiv.org/abs/1710.02298\">Hessel et al., 2018</a>): integrates multiple DQN enhancements (Double DQN, Dueling, Prioritized Replay, Noisy Nets, Distributional RL, and N-Step Returns).</li>\n      <li><strong>Distributional DQN</strong> (<a href=\"https://arxiv.org/abs/1707.06887\">Bellemare et al., 2017</a>): learns a distribution over returns rather than a scalar expected value.</li>\n    </ul>\n<h4 id=\"comparative-analysis-5\">Comparative Analysis</h4>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Algorithm</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Key Idea</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Core Innovation</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Reference</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>DQN</strong></td>\n<td class=\"tg-tleft-valign-first\">Deep neural approximation of Q-function</td>\n<td class=\"tg-tleft-valign-first\">Replay buffer, target network</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://www.nature.com/articles/nature14236\">Mnih et al., 2015</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Double DQN</strong></td>\n<td class=\"tg-tleft-valign-first\">Reduces overestimation bias</td>\n<td class=\"tg-tleft-valign-first\">Decouples selection and evaluation</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1509.06461\">van Hasselt et al., 2016</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Dueling DQN</strong></td>\n<td class=\"tg-tleft-valign-first\">Decomposes value and advantage</td>\n<td class=\"tg-tleft-valign-first\">Separate value and advantage streams</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1511.06581\">Wang et al., 2016</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Prioritized Replay</strong></td>\n<td class=\"tg-tleft-valign-first\">Sample important transitions</td>\n<td class=\"tg-tleft-valign-first\">Weighted replay sampling</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1511.05952\">Schaul et al., 2016</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Rainbow DQN</strong></td>\n<td class=\"tg-tleft-valign-first\">Combines all improvements</td>\n<td class=\"tg-tleft-valign-first\">Unified architecture</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1710.02298\">Hessel et al., 2018</a></td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Algorithm</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Key Idea</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Core Innovation</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Reference</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>DQN</strong></td>\n<td class=\"tg-tleft-valign-first\">Deep neural approximation of Q-function</td>\n<td class=\"tg-tleft-valign-first\">Replay buffer, target network</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://www.nature.com/articles/nature14236\">Mnih et al., 2015</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Double DQN</strong></td>\n<td class=\"tg-tleft-valign-first\">Reduces overestimation bias</td>\n<td class=\"tg-tleft-valign-first\">Decouples selection and evaluation</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1509.06461\">van Hasselt et al., 2016</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Dueling DQN</strong></td>\n<td class=\"tg-tleft-valign-first\">Decomposes value and advantage</td>\n<td class=\"tg-tleft-valign-first\">Separate value and advantage streams</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1511.06581\">Wang et al., 2016</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Prioritized Replay</strong></td>\n<td class=\"tg-tleft-valign-first\">Sample important transitions</td>\n<td class=\"tg-tleft-valign-first\">Weighted replay sampling</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1511.05952\">Schaul et al., 2016</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Rainbow DQN</strong></td>\n<td class=\"tg-tleft-valign-first\">Combines all improvements</td>\n<td class=\"tg-tleft-valign-first\">Unified architecture</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1710.02298\">Hessel et al., 2018</a></td>\n</tr>\n</tbody>\n</table>",
    "contentMarkdown": "*   Deep Value-Based methods extend classical **value-based reinforcement learning**‚Äîsuch as Q-learning‚Äîby using deep neural networks to approximate the value function Q(s,a)Q(s,a)Q(s,a).\n*   This innovation enables agents to operate in high-dimensional observation spaces (like raw images), overcoming the limitations of tabular and linear methods that dominated early RL research.\n\n#### Background: from Q-Learning to Deep Q-Learning\n\n*   In classical Q-learning, the optimal action-value function satisfies the **Bellman Optimality Equation**:\n\nQ‚àó(s,a)\\=ùîºs‚Ä≤\\[r+Œ≥maxa‚Ä≤Q‚àó(s‚Ä≤,a‚Ä≤)\\]Q‚àó(s,a)\\=Es‚Ä≤\\[r+Œ≥maxa‚Ä≤Q‚àó(s‚Ä≤,a‚Ä≤)\\]\n\n*   However, maintaining a tabular representation of Q(s,a)Q(s,a)Q(s,a) becomes infeasible in large or continuous state spaces.\n*   Deep Value-Based methods overcome this by parameterizing Q(s,a)Q(s,a)Q(s,a) as a deep neural network QŒ∏(s,a)QŒ∏(s,a)Q\\_\\\\theta(s,a), trained to minimize the **Temporal Difference (TD) error**:\n\nL(Œ∏)\\=ùîº(s,a,r,s‚Ä≤)\\[(r+Œ≥maxa‚Ä≤QŒ∏‚àí(s‚Ä≤,a‚Ä≤)‚àíQŒ∏(s,a))2\\]L(Œ∏)\\=E(s,a,r,s‚Ä≤)\\[(r+Œ≥maxa‚Ä≤QŒ∏‚àí(s‚Ä≤,a‚Ä≤)‚àíQŒ∏(s,a))2\\]\n\n*   Here, Œ∏‚àíŒ∏‚àí\\\\theta^- represents the parameters of a **target network**, updated periodically to stabilize training.\n\n#### Deep Q-Network (DQN)\n\n*   The **Deep Q-Network (DQN)** introduced by [Mnih et al. (2015)](https://www.nature.com/articles/nature14236) marked a watershed moment for reinforcement learning.\n*   By integrating convolutional neural networks with Q-learning, DQN achieved **human-level control** on Atari 2600 games from raw pixel inputs.\n    \n*   DQN introduced two key innovations to stabilize learning:\n    \n    1.  **Experience Replay:** Transitions (s,a,r,s‚Ä≤)(s,a,r,s‚Ä≤)(s,a,r,s') are stored in a replay buffer and sampled uniformly to break correlation between sequential updates.\n    2.  **Target Network:** A separate network QŒ∏‚àíQŒ∏‚àíQ\\_{\\\\theta^-} is used for target computation, updated less frequently to prevent divergence.\n*   The combined algorithm iteratively minimizes the TD loss above, leading to stable convergence in high-dimensional settings.\n\nBy integrating convolutional neural networks with Q-learning, DQN achieved **human-level control** on Atari 2600 games from raw pixel inputs.\n\nDQN introduced two key innovations to stabilize learning:\n\n1.  **Experience Replay:** Transitions (s,a,r,s‚Ä≤)(s,a,r,s‚Ä≤)(s,a,r,s') are stored in a replay buffer and sampled uniformly to break correlation between sequential updates.\n2.  **Target Network:** A separate network QŒ∏‚àíQŒ∏‚àíQ\\_{\\\\theta^-} is used for target computation, updated less frequently to prevent divergence.\n\n#### Double DQN\n\n*   One major limitation of the original DQN was **overestimation bias** in value updates due to the use of maxa‚Ä≤Q(s‚Ä≤,a‚Ä≤)maxa‚Ä≤Q(s‚Ä≤,a‚Ä≤)\\\\max\\_{a'} Q(s',a') both for action selection and evaluation.\n*   To address this, **Double DQN** by [van Hasselt et al. (2016)](https://arxiv.org/abs/1509.06461) decouples these steps:\n\nL(Œ∏)\\=(r+Œ≥QŒ∏‚àí(s‚Ä≤,argmaxa‚Ä≤QŒ∏(s‚Ä≤,a‚Ä≤))‚àíQŒ∏(s,a))2L(Œ∏)\\=(r+Œ≥QŒ∏‚àí(s‚Ä≤,arg‚Å°maxa‚Ä≤QŒ∏(s‚Ä≤,a‚Ä≤))‚àíQŒ∏(s,a))2\n\n*   This reduces overestimation and yields more accurate Q-value estimates, improving both stability and performance.\n\n#### Dueling Network Architecture\n\n*   The **Dueling DQN** architecture by [Wang et al. (2016)](https://arxiv.org/abs/1511.06581) decomposes the Q-function into two separate estimators:\n    \n    *   A **state-value function** V(s)V(s)V(s)\n    *   An **advantage function** A(s,a)A(s,a)A(s,a)\n*   The combined Q-function is then reconstructed as:\n    \n\nThe **Dueling DQN** architecture by [Wang et al. (2016)](https://arxiv.org/abs/1511.06581) decomposes the Q-function into two separate estimators:\n\n*   A **state-value function** V(s)V(s)V(s)\n*   An **advantage function** A(s,a)A(s,a)A(s,a)\n\nThe combined Q-function is then reconstructed as:\n\nQ(s,a;Œ∏,Œ±,Œ≤)\\=V(s;Œ∏,Œ≤)+(A(s,a;Œ∏,Œ±)‚àí1‚à£Óà≠‚à£‚àëa‚Ä≤A(s,a‚Ä≤;Œ∏,Œ±))Q(s,a;Œ∏,Œ±,Œ≤)\\=V(s;Œ∏,Œ≤)+(A(s,a;Œ∏,Œ±)‚àí1‚à£A‚à£‚àëa‚Ä≤A(s,a‚Ä≤;Œ∏,Œ±))\n\n*   This structure improves learning efficiency by allowing the network to learn which states are valuable, independent of the specific actions.\n\n#### Prioritized Experience Replay\n\n*   Standard DQN samples uniformly from the replay buffer, treating all transitions equally.\n*   **Prioritized Experience Replay** by [Schaul et al. (2016)](https://arxiv.org/abs/1511.05952) instead samples transitions with probability proportional to their TD error magnitude:\n\nP(i)\\=‚à£Œ¥i‚à£Œ±‚àëk‚à£Œ¥k‚à£Œ±P(i)\\=‚à£Œ¥i‚à£Œ±‚àëk‚à£Œ¥k‚à£Œ±\n\n*   This focuses updates on transitions where the model is most surprised, improving data efficiency and convergence rates.\n    \n*   To correct for the bias introduced by non-uniform sampling, importance sampling weights are applied:\n    \n\nThis focuses updates on transitions where the model is most surprised, improving data efficiency and convergence rates.\n\nTo correct for the bias introduced by non-uniform sampling, importance sampling weights are applied:\n\nwi\\=(1N‚ãÖ1P(i))Œ≤wi\\=(1N‚ãÖ1P(i))Œ≤\n\n#### Extensions and Variants\n\n*   Several extensions of DQN further improved stability and performance:\n    \n    *   **NoisyNet DQN** ([Fortunato et al., 2018](https://arxiv.org/abs/1706.10295)): adds parameterized noise for exploration.\n    *   **Rainbow DQN** ([Hessel et al., 2018](https://arxiv.org/abs/1710.02298)): integrates multiple DQN enhancements (Double DQN, Dueling, Prioritized Replay, Noisy Nets, Distributional RL, and N-Step Returns).\n    *   **Distributional DQN** ([Bellemare et al., 2017](https://arxiv.org/abs/1707.06887)): learns a distribution over returns rather than a scalar expected value.\n\nSeveral extensions of DQN further improved stability and performance:\n\n*   **NoisyNet DQN** ([Fortunato et al., 2018](https://arxiv.org/abs/1706.10295)): adds parameterized noise for exploration.\n*   **Rainbow DQN** ([Hessel et al., 2018](https://arxiv.org/abs/1710.02298)): integrates multiple DQN enhancements (Double DQN, Dueling, Prioritized Replay, Noisy Nets, Distributional RL, and N-Step Returns).\n*   **Distributional DQN** ([Bellemare et al., 2017](https://arxiv.org/abs/1707.06887)): learns a distribution over returns rather than a scalar expected value.\n\n#### Comparative Analysis\n\n**Algorithm**\n\n**Key Idea**\n\n**Core Innovation**\n\n**Reference**\n\n**DQN**\n\nDeep neural approximation of Q-function\n\nReplay buffer, target network\n\n[Mnih et al., 2015](https://www.nature.com/articles/nature14236)\n\n**Double DQN**\n\nReduces overestimation bias\n\nDecouples selection and evaluation\n\n[van Hasselt et al., 2016](https://arxiv.org/abs/1509.06461)\n\n**Dueling DQN**\n\nDecomposes value and advantage\n\nSeparate value and advantage streams\n\n[Wang et al., 2016](https://arxiv.org/abs/1511.06581)\n\n**Prioritized Replay**\n\nSample important transitions\n\nWeighted replay sampling\n\n[Schaul et al., 2016](https://arxiv.org/abs/1511.05952)\n\n**Rainbow DQN**\n\nCombines all improvements\n\nUnified architecture\n\n[Hessel et al., 2018](https://arxiv.org/abs/1710.02298)\n\n**Algorithm**\n\n**Key Idea**\n\n**Core Innovation**\n\n**Reference**\n\n**DQN**\n\nDeep neural approximation of Q-function\n\nReplay buffer, target network\n\n[Mnih et al., 2015](https://www.nature.com/articles/nature14236)\n\n**Double DQN**\n\nReduces overestimation bias\n\nDecouples selection and evaluation\n\n[van Hasselt et al., 2016](https://arxiv.org/abs/1509.06461)\n\n**Dueling DQN**\n\nDecomposes value and advantage\n\nSeparate value and advantage streams\n\n[Wang et al., 2016](https://arxiv.org/abs/1511.06581)\n\n**Prioritized Replay**\n\nSample important transitions\n\nWeighted replay sampling\n\n[Schaul et al., 2016](https://arxiv.org/abs/1511.05952)\n\n**Rainbow DQN**\n\nCombines all improvements\n\nUnified architecture\n\n[Hessel et al., 2018](https://arxiv.org/abs/1710.02298)",
    "order": 16,
    "orderInChapter": 8,
    "difficulty": 4,
    "estimatedMinutes": 5,
    "tags": [
      "algorithmsarchitecture",
      "neural network",
      "convolution",
      "llm",
      "reinforcement learning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 829,
      "contentLength": 107374
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#deep-value-based-methods",
    "scrapedAt": "2025-12-28T11:47:08.460Z"
  },
  {
    "id": "ai-reinforcement-learning-deep-policy-based-methods-17",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Types of Reinforcement Learning",
    "title": "Deep Policy-Based Methods",
    "subtitle": "Types of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>While value-based methods estimate (Q(s,a)) or (V(s)) and act greedily with respect to those values, <strong>policy-based reinforcement learning</strong> directly optimizes a <em>parameterized policy</em> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-197-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2947\" style=\"width: 4.013em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.336em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.28em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2948\"><span class=\"msubsup\" id=\"MathJax-Span-2949\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2950\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2951\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2952\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2953\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-2954\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-2955\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-2956\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-197\">\\pi_\\theta(a \\mid s)</script> to maximize expected return.\nThis direct optimization allows the handling of <strong>continuous or stochastic action spaces</strong> and yields <strong>smoother learning dynamics</strong>.</li>\n  <li>Deep Policy-Based Methods extend classical policy-gradient ideas by representing <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-198-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2957\" style=\"width: 4.013em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.336em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.28em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2958\"><span class=\"msubsup\" id=\"MathJax-Span-2959\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2960\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2961\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2962\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2963\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-2964\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-2965\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-2966\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-198\">\\pi_\\theta(a \\mid s)</script> as a deep neural network, enabling end-to-end learning from high-dimensional inputs such as images or sensor data.</li>\n</ul>\n<h4 id=\"policy-gradient-theorem\">Policy Gradient Theorem</h4>\n<ul>\n  <li>The goal is to maximize the expected return:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-199-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2967\" style=\"width: 10.523em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 8.753em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1008.44em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2968\"><span class=\"mi\" id=\"MathJax-Span-2969\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2970\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-2971\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2972\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-2973\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-2974\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-2975\"><span class=\"mrow\" id=\"MathJax-Span-2976\"><span class=\"mi\" id=\"MathJax-Span-2977\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-2978\"><span class=\"mrow\" id=\"MathJax-Span-2979\"><span class=\"msubsup\" id=\"MathJax-Span-2980\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2981\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-2982\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-2983\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-2984\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-2985\"><span class=\"munderover\" id=\"MathJax-Span-2986\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-2987\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-2988\"><span class=\"mrow\" id=\"MathJax-Span-2989\"><span class=\"mi\" id=\"MathJax-Span-2990\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-2991\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-2992\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -5.206em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-2993\"><span class=\"mrow\" id=\"MathJax-Span-2994\"><span class=\"mi\" id=\"MathJax-Span-2995\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àû</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2996\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2997\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-2998\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2999\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3000\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3001\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3002\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>J</mi><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">‚àû</mi></mrow></munderover><msup><mi>Œ≥</mi><mi>t</mi></msup><msub><mi>r</mi><mi>t</mi></msub></mrow><mo>]</mo></mrow></math></span></span></div>\n<ul>\n  <li>The <strong>Policy Gradient Theorem</strong> (<a href=\"https://papers.nips.cc/paper/1713-policy-gradient-methods-for-reinforcement-learning-with-function-approximation.pdf\">Sutton et al., 2000</a>) gives the gradient of (J(\\theta)):</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-200-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3003\" style=\"width: 21.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 17.659em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.878em, 1017.5em, 3.44em, -999.997em); top: -2.914em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3004\"><span class=\"msubsup\" id=\"MathJax-Span-3005\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3006\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-3007\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-3008\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3009\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3010\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3011\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3012\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-3013\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3014\"><span class=\"mrow\" id=\"MathJax-Span-3015\"><span class=\"mi\" id=\"MathJax-Span-3016\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3017\"><span class=\"mrow\" id=\"MathJax-Span-3018\"><span class=\"msubsup\" id=\"MathJax-Span-3019\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3020\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3021\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-3022\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-3023\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-3024\"><span class=\"msubsup\" id=\"MathJax-Span-3025\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3026\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-3027\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-3028\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-3029\"></span><span class=\"msubsup\" id=\"MathJax-Span-3030\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3031\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3032\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3033\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3034\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3035\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3036\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3037\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-3038\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3039\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3040\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3041\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3042\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3043\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3044\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-3045\"><span class=\"mrow\" id=\"MathJax-Span-3046\"><span class=\"msubsup\" id=\"MathJax-Span-3047\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3048\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3049\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3050\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3051\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3052\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3053\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3054\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3055\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3056\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3057\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3058\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-3059\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.919em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mi>J</mi><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mi>log</mi><mo>‚Å°</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>,</mo><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></mrow></msup><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div>\n<ul>\n  <li>This elegant result allows gradient-based optimization of policies without differentiating through the environment dynamics.</li>\n</ul>\n<h4 id=\"reinforce-algorithm-1\">REINFORCE Algorithm</h4>\n<ul>\n  <li>The <strong>REINFORCE</strong> algorithm by <a href=\"https://www.sciencedirect.com/science/article/abs/pii/S0893608005800100\">Williams (1992)</a> is the foundational Monte-Carlo policy-gradient method.</li>\n  <li>\n    <p>It estimates the gradient using complete episode returns:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-201-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2248;</mo><munder><mo>&amp;#x2211;</mo><mi>t</mi></munder><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>G</mi><mi>t</mi></msub><mo>&amp;#x2212;</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3060\" style=\"width: 19.273em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.044em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1015.99em, 3.648em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3061\"><span class=\"msubsup\" id=\"MathJax-Span-3062\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3063\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-3064\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-3065\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3066\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3067\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3068\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3069\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚âà</span><span class=\"munderover\" id=\"MathJax-Span-3070\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3071\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.21em, 4.273em, -999.997em); top: -2.862em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3072\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3073\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3074\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-3075\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-3076\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-3077\"></span><span class=\"msubsup\" id=\"MathJax-Span-3078\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3079\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3080\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3081\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3082\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3083\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3084\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3085\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-3086\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3087\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3088\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3089\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3090\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-3091\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3092\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3093\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-3094\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3095\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-3096\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">b</span><span class=\"mo\" id=\"MathJax-Span-3097\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 2.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mi>J</mi><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>‚âà</mo><munder><mo>‚àë</mo><mi>t</mi></munder><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mi>log</mi><mo>‚Å°</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>,</mo><mo stretchy=\"false\">(</mo><msub><mi>G</mi><mi>t</mi></msub><mo>‚àí</mo><mi>b</mi><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-201\">\\nabla_\\theta J(\\theta)\n\\approx\n\\sum_t \\nabla_\\theta \\log \\pi_\\theta(a_t \\mid s_t) , (G_t - b)</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-202-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3098\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.99em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3099\"><span class=\"msubsup\" id=\"MathJax-Span-3100\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3101\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-3102\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>G</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-202\">G_t</script> is the empirical return and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-203-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3103\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3104\"><span class=\"mi\" id=\"MathJax-Span-3105\" style=\"font-family: STIXGeneral-Italic;\">b</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>b</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-203\">b</script> is a baseline (often the mean return) that reduces variance without biasing the gradient.</li>\n    </ul>\n  </li>\n  <li>Despite high variance, REINFORCE provides an unbiased estimator and demonstrates the feasibility of learning stochastic deep policies.</li>\n</ul>\n<p>It estimates the gradient using complete episode returns:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-202-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3098\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.99em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3099\"><span class=\"msubsup\" id=\"MathJax-Span-3100\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3101\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-3102\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>G</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-202\">G_t</script> is the empirical return and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-203-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3103\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3104\"><span class=\"mi\" id=\"MathJax-Span-3105\" style=\"font-family: STIXGeneral-Italic;\">b</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>b</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-203\">b</script> is a baseline (often the mean return) that reduces variance without biasing the gradient.</li>\n    </ul>\n<h4 id=\"variance-reduction-and-baselines\">Variance Reduction and Baselines</h4>\n<ul>\n  <li>\n    <p>To make policy-gradient learning practical, variance-reduction techniques are crucial:</p>\n\n    <ul>\n      <li><strong>State-Value Baselines:</strong> Replace raw return (G_t) with an estimate of the advantage <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-204-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>Q</mi><mi>t</mi></msub><mo>&amp;#x2212;</mo><msub><mi>V</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3106\" style=\"width: 6.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.055em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.05em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3107\"><span class=\"msubsup\" id=\"MathJax-Span-3108\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3109\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3110\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3111\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-3112\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3113\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-3114\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3115\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-3116\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3117\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3118\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>Q</mi><mi>t</mi></msub><mo>‚àí</mo><msub><mi>V</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-204\">A_t = Q_t - V_t</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-205-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3119\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3120\"><span class=\"msubsup\" id=\"MathJax-Span-3121\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3122\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3123\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-205\">V_t</script> is a learned value baseline.</li>\n      <li><strong>Generalized Advantage Estimation (GAE):</strong> Introduced by <a href=\"https://arxiv.org/abs/1506.02438\">Schulman et al., 2016</a>,\n        <ul>\n          <li>GAE computes a bias-variance-controlled estimator of advantage by exponentially weighting multi-step TD errors:</li>\n        </ul>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-206-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03BB;</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>l</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B3;</mi><mi>&amp;#x03BB;</mi><msup><mo stretchy=&quot;false&quot;>)</mo><mi>l</mi></msup><msub><mi>&amp;#x03B4;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>l</mi></mrow></msub><mspace width=&quot;1em&quot; /><mtext>where</mtext><mspace width=&quot;1em&quot; /><msub><mi>&amp;#x03B4;</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B3;</mi><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3124\" style=\"width: 27.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 22.555em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.419em, 1022.5em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3125\"><span class=\"msubsup\" id=\"MathJax-Span-3126\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3127\"><span class=\"mrow\" id=\"MathJax-Span-3128\"><span class=\"munderover\" id=\"MathJax-Span-3129\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3130\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-3131\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.89em, 4.273em, -999.997em); top: -4.685em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3132\"><span class=\"mrow\" id=\"MathJax-Span-3133\"><span class=\"mo\" id=\"MathJax-Span-3134\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3135\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œª</span><span class=\"mo\" id=\"MathJax-Span-3136\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.747em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3137\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3138\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-3139\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3140\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-3141\"><span class=\"mrow\" id=\"MathJax-Span-3142\"><span class=\"mi\" id=\"MathJax-Span-3143\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3144\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-3145\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -5.206em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-3146\"><span class=\"mrow\" id=\"MathJax-Span-3147\"><span class=\"mi\" id=\"MathJax-Span-3148\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àû</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3149\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3150\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3151\" style=\"font-family: STIXGeneral-Italic;\">Œª</span><span class=\"msubsup\" id=\"MathJax-Span-3152\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3153\" style=\"font-family: STIXGeneral-Regular;\">)</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-3154\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3155\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3156\" style=\"font-family: STIXGeneral-Italic;\">Œ¥</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3157\"><span class=\"mrow\" id=\"MathJax-Span-3158\"><span class=\"mi\" id=\"MathJax-Span-3159\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3160\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-3161\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mspace\" id=\"MathJax-Span-3162\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"mtext\" id=\"MathJax-Span-3163\" style=\"font-family: STIXGeneral-Regular;\">where</span><span class=\"mspace\" id=\"MathJax-Span-3164\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"msubsup\" id=\"MathJax-Span-3165\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3166\" style=\"font-family: STIXGeneral-Italic;\">Œ¥</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-3167\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3168\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-3169\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3170\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3171\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3172\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3173\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3174\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3175\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3176\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3177\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-3178\"><span class=\"mrow\" id=\"MathJax-Span-3179\"><span class=\"mi\" id=\"MathJax-Span-3180\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3181\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-3182\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3183\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3184\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-3185\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3186\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3187\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3188\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3189\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3190\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>Œª</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>=</mo><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>l</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">‚àû</mi></mrow></munderover><mo stretchy=\"false\">(</mo><mi>Œ≥</mi><mi>Œª</mi><msup><mo stretchy=\"false\">)</mo><mi>l</mi></msup><msub><mi>Œ¥</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mi>l</mi></mrow></msub><mspace width=\"1em\"></mspace><mtext>where</mtext><mspace width=\"1em\"></mspace><msub><mi>Œ¥</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>Œ≥</mi><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-206\">\\hat{A}_t^{(\\lambda)} =\n\\sum_{l=0}^{\\infty} (\\gamma\\lambda)^l\n\\delta_{t+l}\n\\quad \\text{where}\\quad\n\\delta_t = r_t + \\gamma V(s_{t+1}) - V(s_t)</script>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>This innovation enabled the training stability of modern deep policy-gradient algorithms.</p>\n  </li>\n</ul>\n<p>To make policy-gradient learning practical, variance-reduction techniques are crucial:</p>\n<ul>\n      <li><strong>State-Value Baselines:</strong> Replace raw return (G_t) with an estimate of the advantage <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-204-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>Q</mi><mi>t</mi></msub><mo>&amp;#x2212;</mo><msub><mi>V</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3106\" style=\"width: 6.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.055em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.05em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3107\"><span class=\"msubsup\" id=\"MathJax-Span-3108\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3109\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3110\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3111\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-3112\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3113\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-3114\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3115\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-3116\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3117\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3118\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>Q</mi><mi>t</mi></msub><mo>‚àí</mo><msub><mi>V</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-204\">A_t = Q_t - V_t</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-205-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3119\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3120\"><span class=\"msubsup\" id=\"MathJax-Span-3121\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3122\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3123\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-205\">V_t</script> is a learned value baseline.</li>\n      <li><strong>Generalized Advantage Estimation (GAE):</strong> Introduced by <a href=\"https://arxiv.org/abs/1506.02438\">Schulman et al., 2016</a>,\n        <ul>\n          <li>GAE computes a bias-variance-controlled estimator of advantage by exponentially weighting multi-step TD errors:</li>\n        </ul>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-206-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03BB;</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msubsup><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>l</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B3;</mi><mi>&amp;#x03BB;</mi><msup><mo stretchy=&quot;false&quot;>)</mo><mi>l</mi></msup><msub><mi>&amp;#x03B4;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>l</mi></mrow></msub><mspace width=&quot;1em&quot; /><mtext>where</mtext><mspace width=&quot;1em&quot; /><msub><mi>&amp;#x03B4;</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B3;</mi><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3124\" style=\"width: 27.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 22.555em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.419em, 1022.5em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3125\"><span class=\"msubsup\" id=\"MathJax-Span-3126\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3127\"><span class=\"mrow\" id=\"MathJax-Span-3128\"><span class=\"munderover\" id=\"MathJax-Span-3129\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3130\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-3131\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.89em, 4.273em, -999.997em); top: -4.685em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3132\"><span class=\"mrow\" id=\"MathJax-Span-3133\"><span class=\"mo\" id=\"MathJax-Span-3134\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3135\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œª</span><span class=\"mo\" id=\"MathJax-Span-3136\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.747em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3137\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3138\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-3139\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3140\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-3141\"><span class=\"mrow\" id=\"MathJax-Span-3142\"><span class=\"mi\" id=\"MathJax-Span-3143\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3144\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-3145\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -5.206em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-3146\"><span class=\"mrow\" id=\"MathJax-Span-3147\"><span class=\"mi\" id=\"MathJax-Span-3148\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àû</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3149\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3150\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3151\" style=\"font-family: STIXGeneral-Italic;\">Œª</span><span class=\"msubsup\" id=\"MathJax-Span-3152\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3153\" style=\"font-family: STIXGeneral-Regular;\">)</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-3154\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3155\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3156\" style=\"font-family: STIXGeneral-Italic;\">Œ¥</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-3157\"><span class=\"mrow\" id=\"MathJax-Span-3158\"><span class=\"mi\" id=\"MathJax-Span-3159\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3160\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-3161\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mspace\" id=\"MathJax-Span-3162\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"mtext\" id=\"MathJax-Span-3163\" style=\"font-family: STIXGeneral-Regular;\">where</span><span class=\"mspace\" id=\"MathJax-Span-3164\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"msubsup\" id=\"MathJax-Span-3165\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3166\" style=\"font-family: STIXGeneral-Italic;\">Œ¥</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-3167\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3168\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-3169\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3170\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3171\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3172\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3173\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-3174\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3175\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3176\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3177\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-3178\"><span class=\"mrow\" id=\"MathJax-Span-3179\"><span class=\"mi\" id=\"MathJax-Span-3180\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3181\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-3182\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3183\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3184\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-3185\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3186\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3187\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3188\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3189\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3190\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>t</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>Œª</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo>=</mo><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>l</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">‚àû</mi></mrow></munderover><mo stretchy=\"false\">(</mo><mi>Œ≥</mi><mi>Œª</mi><msup><mo stretchy=\"false\">)</mo><mi>l</mi></msup><msub><mi>Œ¥</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mi>l</mi></mrow></msub><mspace width=\"1em\"></mspace><mtext>where</mtext><mspace width=\"1em\"></mspace><msub><mi>Œ¥</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>Œ≥</mi><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-206\">\\hat{A}_t^{(\\lambda)} =\n\\sum_{l=0}^{\\infty} (\\gamma\\lambda)^l\n\\delta_{t+l}\n\\quad \\text{where}\\quad\n\\delta_t = r_t + \\gamma V(s_{t+1}) - V(s_t)</script>\n      </li>\n    </ul>\n<ul>\n          <li>GAE computes a bias-variance-controlled estimator of advantage by exponentially weighting multi-step TD errors:</li>\n        </ul>\n<p>This innovation enabled the training stability of modern deep policy-gradient algorithms.</p>\n<h4 id=\"trust-region-policy-optimization-trpo\">Trust Region Policy Optimization (TRPO)</h4>\n<ul>\n  <li>One challenge in policy-gradient methods is <strong>catastrophic policy collapse</strong> due to overly large updates.</li>\n  <li><strong>TRPO</strong>, proposed by <a href=\"https://arxiv.org/abs/1502.05477\">Schulman et al., 2015</a>, constrains the policy step within a <em>trust region</em> to ensure monotonic improvement:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-207-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></munder><mo>;</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mo>,</mo><mi>a</mi><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub></mrow></msub><mrow><mo>[</mo><mrow><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo>,</mo><msub><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow><mspace width=&quot;1em&quot; /><mtext>s.t.&amp;#xA0;</mtext><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow><mo>[</mo><mrow><msub><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>KL</mtext></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>(</mo></mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>&amp;#x2016;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>)</mo></mrow></mrow><mo>]</mo></mrow><mo>&amp;#x2264;</mo><mi>&amp;#x03B4;</mi></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3191\" style=\"width: 38.44em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 32.034em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.503em, 1032.03em, 5.263em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3192\"><span class=\"munderover\" id=\"MathJax-Span-3193\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3194\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.273em, -999.997em); top: -3.331em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-3195\"><span class=\"mrow\" id=\"MathJax-Span-3196\"><span class=\"mi\" id=\"MathJax-Span-3197\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3198\" style=\"font-family: STIXGeneral-Regular;\">;</span><span class=\"msubsup\" id=\"MathJax-Span-3199\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 3.336em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3200\"><span class=\"mrow\" id=\"MathJax-Span-3201\"><span class=\"mi\" id=\"MathJax-Span-3202\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3203\"><span class=\"mrow\" id=\"MathJax-Span-3204\"><span class=\"mi\" id=\"MathJax-Span-3205\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-3206\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3207\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-3208\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"msubsup\" id=\"MathJax-Span-3209\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3210\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-3211\"><span class=\"mrow\" id=\"MathJax-Span-3212\"><span class=\"msubsup\" id=\"MathJax-Span-3213\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3214\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-3215\"><span class=\"mrow\" id=\"MathJax-Span-3216\"><span class=\"mtext\" id=\"MathJax-Span-3217\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-3218\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-3219\" style=\"vertical-align: -0.57em;\"><span style=\"font-family: STIXSizeThreeSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-3220\"><span class=\"mfrac\" id=\"MathJax-Span-3221\"><span style=\"display: inline-block; position: relative; width: 4.169em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.34em, 4.378em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.664em;\"><span class=\"mrow\" id=\"MathJax-Span-3222\"><span class=\"msubsup\" id=\"MathJax-Span-3223\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3224\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3225\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3226\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3227\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-3228\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-3229\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-3230\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1004.01em, 4.43em, -999.997em); top: -3.331em; left: 50%; margin-left: -2.029em;\"><span class=\"mrow\" id=\"MathJax-Span-3231\"><span class=\"msubsup\" id=\"MathJax-Span-3232\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3233\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3234\"><span class=\"mrow\" id=\"MathJax-Span-3235\"><span class=\"msubsup\" id=\"MathJax-Span-3236\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3237\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-3238\"><span class=\"mrow\" id=\"MathJax-Span-3239\"><span class=\"mtext\" id=\"MathJax-Span-3240\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3241\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3242\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-3243\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-3244\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-3245\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1004.17em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 4.169em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3246\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3247\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3248\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3249\"><span class=\"mrow\" id=\"MathJax-Span-3250\"><span class=\"msubsup\" id=\"MathJax-Span-3251\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3252\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-3253\"><span class=\"mrow\" id=\"MathJax-Span-3254\"><span class=\"msubsup\" id=\"MathJax-Span-3255\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3256\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-3257\"><span class=\"mrow\" id=\"MathJax-Span-3258\"><span class=\"mtext\" id=\"MathJax-Span-3259\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3260\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3261\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-3262\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3263\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-3264\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-3265\" style=\"vertical-align: -0.57em;\"><span style=\"font-family: STIXSizeThreeSym;\">]</span></span></span><span class=\"mspace\" id=\"MathJax-Span-3266\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"mtext\" id=\"MathJax-Span-3267\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">s.t.&nbsp;</span><span class=\"texatom\" id=\"MathJax-Span-3268\"><span class=\"mrow\" id=\"MathJax-Span-3269\"><span class=\"mi\" id=\"MathJax-Span-3270\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span class=\"mrow\" id=\"MathJax-Span-3271\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-3272\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-3273\"><span class=\"msubsup\" id=\"MathJax-Span-3274\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3275\" style=\"font-family: STIXGeneral-Italic;\">D</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-3276\"><span class=\"mrow\" id=\"MathJax-Span-3277\"><span class=\"mtext\" id=\"MathJax-Span-3278\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">KL</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-3279\"><span class=\"mrow\" id=\"MathJax-Span-3280\"><span class=\"mo\" id=\"MathJax-Span-3281\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">(</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3282\"><span style=\"display: inline-block; position: relative; width: 1.617em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3283\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3284\"><span class=\"mrow\" id=\"MathJax-Span-3285\"><span class=\"msubsup\" id=\"MathJax-Span-3286\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3287\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-3288\"><span class=\"mrow\" id=\"MathJax-Span-3289\"><span class=\"mtext\" id=\"MathJax-Span-3290\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3291\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-3292\" style=\"font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-3293\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-3294\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-3295\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3296\" style=\"font-family: STIXGeneral-Regular;\">‚Äñ</span><span class=\"msubsup\" id=\"MathJax-Span-3297\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3298\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3299\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3300\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-3301\" style=\"font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-3302\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-3303\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-3304\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-3305\"><span class=\"mrow\" id=\"MathJax-Span-3306\"><span class=\"mo\" id=\"MathJax-Span-3307\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">)</span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3308\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">]</span></span></span><span class=\"mo\" id=\"MathJax-Span-3309\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚â§</span><span class=\"mi\" id=\"MathJax-Span-3310\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Œ¥</span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>Œ∏</mi></mrow></munder><mo>;</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>s</mi><mo>,</mo><mi>a</mi><mo>‚àº</mo><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>Œ∏</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub></mrow></msub><mrow><mo>[</mo><mrow><mfrac><mrow><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>Œ∏</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow></mfrac><mo>,</mo><msub><mi>A</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>Œ∏</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub></mrow></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow><mspace width=\"1em\"></mspace><mtext>s.t.&nbsp;</mtext><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow><mo>[</mo><mrow><msub><mi>D</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>KL</mtext></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo></mrow><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>Œ∏</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo fence=\"false\" stretchy=\"false\">‚Äñ</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo></mrow></mrow><mo>]</mo></mrow><mo>‚â§</mo><mi>Œ¥</mi></math></span></span></div>\n<ul>\n  <li>This optimization ensures conservative updates, improving stability across large neural-network policies.</li>\n</ul>\n<h4 id=\"proximal-policy-optimization-ppo\">Proximal Policy Optimization (PPO)</h4>\n<ul>\n  <li><strong>PPO</strong>, by <a href=\"https://arxiv.org/abs/1707.06347\">Schulman et al., 2017</a>, is a policy-gradient algorithm designed to balance learning stability and efficiency. It improves on Trust Region Policy Optimization (TRPO) by enforcing a <em>soft trust region</em> through a <strong>clipped surrogate objective</strong>, which discourages updates that move the policy too far from its previous version.</li>\n  <li>\n    <p>The <strong>clipped objective</strong> is defined as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-208-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>CLIP</mtext></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mi>t</mi></msub><mrow><mo>[</mo><mrow><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>min</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;>(</mo></mrow><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>t</mi></msub><mo>,</mo><mtext>clip</mtext><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>(</mo></mrow><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03F5;</mi><mo>,</mo><mn>1</mn><mo>+</mo><mi>&amp;#x03F5;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>)</mo></mrow><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;>)</mo></mrow></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3311\" style=\"width: 27.763em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 23.128em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.138em, 1022.92em, 4.326em, -999.997em); top: -3.487em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3312\"><span class=\"msubsup\" id=\"MathJax-Span-3313\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3314\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3315\"><span class=\"mrow\" id=\"MathJax-Span-3316\"><span class=\"mtext\" id=\"MathJax-Span-3317\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">CLIP</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3318\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3319\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3320\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3321\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-3322\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3323\"><span class=\"mrow\" id=\"MathJax-Span-3324\"><span class=\"mi\" id=\"MathJax-Span-3325\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3326\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-3327\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-3328\" style=\"vertical-align: -0.414em;\"><span style=\"font-family: STIXSizeTwoSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-3329\"><span class=\"mo\" id=\"MathJax-Span-3330\" style=\"font-family: STIXGeneral-Regular;\">min</span><span class=\"texatom\" id=\"MathJax-Span-3331\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-3332\"><span class=\"mo\" id=\"MathJax-Span-3333\" style=\"vertical-align: -0.414em;\"><span style=\"font-family: STIXSizeTwoSym;\">(</span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3334\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3335\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3336\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3337\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3338\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3339\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-3340\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3341\"><span class=\"mrow\" id=\"MathJax-Span-3342\"><span class=\"munderover\" id=\"MathJax-Span-3343\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3344\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-3345\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3346\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3347\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mtext\" id=\"MathJax-Span-3348\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">clip</span><span class=\"texatom\" id=\"MathJax-Span-3349\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-3350\"><span class=\"mo\" id=\"MathJax-Span-3351\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">(</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3352\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3353\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3354\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3355\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3356\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3357\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3358\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-3359\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-3360\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-3361\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">œµ</span><span class=\"mo\" id=\"MathJax-Span-3362\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-3363\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-3364\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3365\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">œµ</span><span class=\"texatom\" id=\"MathJax-Span-3366\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-3367\"><span class=\"mo\" id=\"MathJax-Span-3368\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">)</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3369\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3370\"><span class=\"mrow\" id=\"MathJax-Span-3371\"><span class=\"munderover\" id=\"MathJax-Span-3372\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3373\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-3374\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3375\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-3376\"><span class=\"mrow\" id=\"MathJax-Span-3377\"><span class=\"mo\" id=\"MathJax-Span-3378\" style=\"vertical-align: -0.414em;\"><span style=\"font-family: STIXSizeTwoSym;\">)</span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3379\" style=\"vertical-align: -0.414em;\"><span style=\"font-family: STIXSizeTwoSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.492em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>CLIP</mtext></mrow></msup><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mi>t</mi></msub><mrow><mo>[</mo><mrow><mo movablelimits=\"true\" form=\"prefix\">min</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.623em\" minsize=\"1.623em\">(</mo></mrow><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>t</mi></msub><mo>,</mo><mtext>clip</mtext><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo></mrow><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>,</mo><mn>1</mn><mo>‚àí</mo><mi>œµ</mi><mo>,</mo><mn>1</mn><mo>+</mo><mi>œµ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo></mrow><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>t</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.623em\" minsize=\"1.623em\">)</mo></mrow></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-208\">L^{\\text{CLIP}}(\\theta)\n=\n\\mathbb{E}_t\n\\left[\n\\min \\Big(\nr_t(\\theta) \\hat{A}_t,\n\\text{clip}\\big(r_t(\\theta), 1-\\epsilon, 1+\\epsilon\\big) \\hat{A}_t\n\\Big)\n\\right]</script>\n\n    <ul>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-209-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3380\" style=\"width: 7.763em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.461em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.992em, 1006.46em, 3.023em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3381\"><span class=\"msubsup\" id=\"MathJax-Span-3382\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3383\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3384\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3385\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3386\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3387\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3388\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-3389\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1002.29em, 4.326em, -999.997em); top: -4.529em; left: 50%; margin-left: -1.195em;\"><span class=\"mrow\" id=\"MathJax-Span-3390\"><span class=\"msubsup\" id=\"MathJax-Span-3391\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3392\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3393\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3394\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3395\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3396\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3397\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3398\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-3399\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3400\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-3401\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3402\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1002.97em, 4.43em, -999.997em); top: -3.591em; left: 50%; margin-left: -1.508em;\"><span class=\"mrow\" id=\"MathJax-Span-3403\"><span class=\"msubsup\" id=\"MathJax-Span-3404\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3405\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-3406\"><span class=\"mrow\" id=\"MathJax-Span-3407\"><span class=\"msubsup\" id=\"MathJax-Span-3408\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3409\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-3410\"><span class=\"mrow\" id=\"MathJax-Span-3411\"><span class=\"mtext\" id=\"MathJax-Span-3412\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3413\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3414\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3415\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3416\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3417\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-3418\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3419\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-3420\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3421\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.13em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.128em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>Œ∏</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-209\">r_t(\\theta) = \\frac{\\pi_\\theta(a_t \\mid s_t)}{\\pi_{\\theta_{\\text{old}}}(a_t \\mid s_t)}</script>: the <strong>probability ratio</strong> between new and old policies.</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-210-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3422\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.992em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3423\"><span class=\"msubsup\" id=\"MathJax-Span-3424\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3425\"><span class=\"mrow\" id=\"MathJax-Span-3426\"><span class=\"munderover\" id=\"MathJax-Span-3427\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3428\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-3429\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3430\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-210\">\\hat{A}_t</script>: the <strong>advantage estimate</strong>, typically <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-211-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub><mo>&amp;#x2212;</mo><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3431\" style=\"width: 5.159em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.273em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1004.22em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3432\"><span class=\"msubsup\" id=\"MathJax-Span-3433\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3434\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3435\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3436\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-3437\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3438\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3439\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3440\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3441\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3442\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3443\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3444\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub><mo>‚àí</mo><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-211\">r_t - V_\\phi(s_t)</script>, showing how much better the taken action was than expected.</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-212-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03F5;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3445\" style=\"width: 0.523em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.42em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3446\"><span class=\"mi\" id=\"MathJax-Span-3447\" style=\"font-family: STIXGeneral-Italic;\">œµ</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œµ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-212\">\\epsilon</script>: a small constant (often 0.1‚Äì0.3) controlling the trust-region width.</li>\n      <li>The <code class=\"language-plaintext highlighter-rouge\">min</code> operator ensures that the policy update never increases the objective beyond what the clipped surrogate allows, preventing overly large steps that can harm performance.</li>\n    </ul>\n  </li>\n  <li>Intuitively, PPO encourages policy improvement proportional to the advantage while <strong>clipping</strong> the update if the new policy deviates too far from the old one. This yields a stable and robust optimization process widely used in RLHF for aligning large language models.</li>\n</ul>\n<p>The <strong>clipped objective</strong> is defined as:</p>\n<ul>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-209-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3380\" style=\"width: 7.763em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.461em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.992em, 1006.46em, 3.023em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3381\"><span class=\"msubsup\" id=\"MathJax-Span-3382\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3383\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3384\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3385\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3386\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3387\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3388\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-3389\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1002.29em, 4.326em, -999.997em); top: -4.529em; left: 50%; margin-left: -1.195em;\"><span class=\"mrow\" id=\"MathJax-Span-3390\"><span class=\"msubsup\" id=\"MathJax-Span-3391\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3392\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3393\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3394\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3395\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3396\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3397\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3398\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-3399\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3400\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-3401\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3402\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1002.97em, 4.43em, -999.997em); top: -3.591em; left: 50%; margin-left: -1.508em;\"><span class=\"mrow\" id=\"MathJax-Span-3403\"><span class=\"msubsup\" id=\"MathJax-Span-3404\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3405\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-3406\"><span class=\"mrow\" id=\"MathJax-Span-3407\"><span class=\"msubsup\" id=\"MathJax-Span-3408\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3409\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-3410\"><span class=\"mrow\" id=\"MathJax-Span-3411\"><span class=\"mtext\" id=\"MathJax-Span-3412\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3413\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3414\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3415\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3416\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3417\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-3418\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3419\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-3420\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3421\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.13em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.128em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>Œ∏</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-209\">r_t(\\theta) = \\frac{\\pi_\\theta(a_t \\mid s_t)}{\\pi_{\\theta_{\\text{old}}}(a_t \\mid s_t)}</script>: the <strong>probability ratio</strong> between new and old policies.</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-210-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3422\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.992em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3423\"><span class=\"msubsup\" id=\"MathJax-Span-3424\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3425\"><span class=\"mrow\" id=\"MathJax-Span-3426\"><span class=\"munderover\" id=\"MathJax-Span-3427\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3428\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-3429\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3430\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-210\">\\hat{A}_t</script>: the <strong>advantage estimate</strong>, typically <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-211-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub><mo>&amp;#x2212;</mo><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3431\" style=\"width: 5.159em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.273em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1004.22em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3432\"><span class=\"msubsup\" id=\"MathJax-Span-3433\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3434\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3435\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3436\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-3437\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3438\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3439\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3440\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3441\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3442\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3443\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3444\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub><mo>‚àí</mo><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-211\">r_t - V_\\phi(s_t)</script>, showing how much better the taken action was than expected.</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-212-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03F5;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3445\" style=\"width: 0.523em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.42em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3446\"><span class=\"mi\" id=\"MathJax-Span-3447\" style=\"font-family: STIXGeneral-Italic;\">œµ</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œµ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-212\">\\epsilon</script>: a small constant (often 0.1‚Äì0.3) controlling the trust-region width.</li>\n      <li>The <code class=\"language-plaintext highlighter-rouge\">min</code> operator ensures that the policy update never increases the objective beyond what the clipped surrogate allows, preventing overly large steps that can harm performance.</li>\n    </ul>\n<h4 id=\"entropy-regularization-and-exploration\">Entropy Regularization and Exploration</h4>\n<ul>\n  <li>To encourage exploration and avoid premature convergence to deterministic policies, <strong>entropy regularization</strong> augments the objective:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-213-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>J</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B2;</mi><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>H</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3448\" style=\"width: 16.357em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 13.596em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1013.49em, 2.659em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3449\"><span class=\"msup\" id=\"MathJax-Span-3450\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3451\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.576em;\"><span class=\"mo\" id=\"MathJax-Span-3452\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3453\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3454\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3455\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3456\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-3457\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3458\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3459\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3460\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3461\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3462\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-3463\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3464\"><span class=\"mrow\" id=\"MathJax-Span-3465\"><span class=\"mi\" id=\"MathJax-Span-3466\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3467\"><span class=\"mrow\" id=\"MathJax-Span-3468\"><span class=\"msubsup\" id=\"MathJax-Span-3469\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3470\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3471\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-3472\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-3473\" style=\"vertical-align: 0.003em;\"><span style=\"font-family: STIXGeneral-Regular;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-3474\"><span class=\"texatom\" id=\"MathJax-Span-3475\"><span class=\"mrow\" id=\"MathJax-Span-3476\"><span class=\"mi\" id=\"MathJax-Span-3477\" style=\"font-family: STIXNonUnicode-Italic;\">Óà¥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3478\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3479\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3480\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3481\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3482\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-3483\" style=\"font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-3484\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-3485\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-3486\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3487\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-3488\" style=\"vertical-align: 0.003em;\"><span style=\"font-family: STIXGeneral-Regular;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.441em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>J</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>J</mi><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>Œ≤</mi><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">H</mi></mrow><mo stretchy=\"false\">(</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div>\n<ul>\n  <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-214-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>H</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo>&amp;#x2212;</mo><munder><mo>&amp;#x2211;</mo><mi>a</mi></munder><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mi>log</mi><mo>&amp;#x2061;</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3489\" style=\"width: 15.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 13.18em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1013.13em, 2.711em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3490\"><span class=\"texatom\" id=\"MathJax-Span-3491\"><span class=\"mrow\" id=\"MathJax-Span-3492\"><span class=\"mi\" id=\"MathJax-Span-3493\" style=\"font-family: STIXNonUnicode-Italic;\">Óà¥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3494\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3495\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3496\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3497\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-3498\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àí</span><span class=\"munderover\" id=\"MathJax-Span-3499\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3500\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.695em; left: 0.94em;\"><span class=\"mi\" id=\"MathJax-Span-3501\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-3502\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3503\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3504\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-3505\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-3506\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-3507\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mi\" id=\"MathJax-Span-3508\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-3509\"></span><span class=\"mi\" id=\"MathJax-Span-3510\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3511\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3512\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-3513\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-3514\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-3515\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">H</mi></mrow><mo stretchy=\"false\">(</mo><mi>œÄ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo>‚àí</mo><munder><mo>‚àë</mo><mi>a</mi></munder><mi>œÄ</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mi>log</mi><mo>‚Å°</mo><mi>œÄ</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-214\">\\mathcal{H}(\\pi) = -\\sum_a \\pi(a \\mid s)\\log\\pi(a \\mid s)</script>.</li>\n  <li>This technique, introduced in <strong>Soft Actor‚ÄìCritic</strong> and earlier A3C methods, keeps the policy sufficiently stochastic to explore effectively.</li>\n</ul>\n<h4 id=\"comparative-analysis-6\">Comparative Analysis</h4>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Algorithm</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Key Idea</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Stability Technique</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Reference</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>REINFORCE</strong></td>\n<td class=\"tg-tleft-valign-first\">Monte-Carlo policy-gradient</td>\n<td class=\"tg-tleft-valign-first\">Baseline subtraction</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://www.sciencedirect.com/science/article/abs/pii/S0893608005800100\">Williams (1992)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>TRPO</strong></td>\n<td class=\"tg-tleft-valign-first\">Trust-region constrained updates</td>\n<td class=\"tg-tleft-valign-first\">KL-divergence constraint</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1502.05477\">Schulman et al., 2015</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>PPO</strong></td>\n<td class=\"tg-tleft-valign-first\">Clipped surrogate objective</td>\n<td class=\"tg-tleft-valign-first\">Implicit trust-region</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1707.06347\">Schulman et al., 2017</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>GAE</strong></td>\n<td class=\"tg-tleft-valign-first\">Low-variance advantage estimator</td>\n<td class=\"tg-tleft-valign-first\">Œª-weighted TD residuals</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1506.02438\">Schulman et al., 2016</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Entropy Regularization</strong></td>\n<td class=\"tg-tleft-valign-first\">Exploration through stochasticity</td>\n<td class=\"tg-tleft-valign-first\">Entropy bonus</td>\n<td class=\"tg-tleft-valign-second\">A3C / SAC families</td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Algorithm</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Key Idea</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Stability Technique</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Reference</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>REINFORCE</strong></td>\n<td class=\"tg-tleft-valign-first\">Monte-Carlo policy-gradient</td>\n<td class=\"tg-tleft-valign-first\">Baseline subtraction</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://www.sciencedirect.com/science/article/abs/pii/S0893608005800100\">Williams (1992)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>TRPO</strong></td>\n<td class=\"tg-tleft-valign-first\">Trust-region constrained updates</td>\n<td class=\"tg-tleft-valign-first\">KL-divergence constraint</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1502.05477\">Schulman et al., 2015</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>PPO</strong></td>\n<td class=\"tg-tleft-valign-first\">Clipped surrogate objective</td>\n<td class=\"tg-tleft-valign-first\">Implicit trust-region</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1707.06347\">Schulman et al., 2017</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>GAE</strong></td>\n<td class=\"tg-tleft-valign-first\">Low-variance advantage estimator</td>\n<td class=\"tg-tleft-valign-first\">Œª-weighted TD residuals</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1506.02438\">Schulman et al., 2016</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Entropy Regularization</strong></td>\n<td class=\"tg-tleft-valign-first\">Exploration through stochasticity</td>\n<td class=\"tg-tleft-valign-first\">Entropy bonus</td>\n<td class=\"tg-tleft-valign-second\">A3C / SAC families</td>\n</tr>\n</tbody>\n</table>",
    "contentMarkdown": "*   While value-based methods estimate (Q(s,a)) or (V(s)) and act greedily with respect to those values, **policy-based reinforcement learning** directly optimizes a _parameterized policy_ œÄŒ∏(a‚à£s)œÄŒ∏(a‚à£s)\\\\pi\\_\\\\theta(a \\\\mid s) to maximize expected return. This direct optimization allows the handling of **continuous or stochastic action spaces** and yields **smoother learning dynamics**.\n*   Deep Policy-Based Methods extend classical policy-gradient ideas by representing œÄŒ∏(a‚à£s)œÄŒ∏(a‚à£s)\\\\pi\\_\\\\theta(a \\\\mid s) as a deep neural network, enabling end-to-end learning from high-dimensional inputs such as images or sensor data.\n\n#### Policy Gradient Theorem\n\n*   The goal is to maximize the expected return:\n\nJ(Œ∏)\\=ùîºœÄŒ∏\\[‚àët\\=0‚àûŒ≥trt\\]J(Œ∏)\\=EœÄŒ∏\\[‚àët\\=0‚àûŒ≥trt\\]\n\n*   The **Policy Gradient Theorem** ([Sutton et al., 2000](https://papers.nips.cc/paper/1713-policy-gradient-methods-for-reinforcement-learning-with-function-approximation.pdf)) gives the gradient of (J(\\\\theta)):\n\n‚àáŒ∏J(Œ∏)\\=ùîºœÄŒ∏\\[‚àáŒ∏logœÄŒ∏(at‚à£st),QœÄŒ∏(st,at)\\]‚àáŒ∏J(Œ∏)\\=EœÄŒ∏\\[‚àáŒ∏log‚Å°œÄŒ∏(at‚à£st),QœÄŒ∏(st,at)\\]\n\n*   This elegant result allows gradient-based optimization of policies without differentiating through the environment dynamics.\n\n#### REINFORCE Algorithm\n\n*   The **REINFORCE** algorithm by [Williams (1992)](https://www.sciencedirect.com/science/article/abs/pii/S0893608005800100) is the foundational Monte-Carlo policy-gradient method.\n*   It estimates the gradient using complete episode returns:\n    \n    ‚àáŒ∏J(Œ∏)‚âà‚àët‚àáŒ∏logœÄŒ∏(at‚à£st),(Gt‚àíb)‚àáŒ∏J(Œ∏)‚âà‚àët‚àáŒ∏log‚Å°œÄŒ∏(at‚à£st),(Gt‚àíb)\n    \n    \\\\nabla\\_\\\\theta J(\\\\theta) \\\\approx \\\\sum\\_t \\\\nabla\\_\\\\theta \\\\log \\\\pi\\_\\\\theta(a\\_t \\\\mid s\\_t) , (G\\_t - b)\n    *   where GtGtG\\_t is the empirical return and bbb is a baseline (often the mean return) that reduces variance without biasing the gradient.\n*   Despite high variance, REINFORCE provides an unbiased estimator and demonstrates the feasibility of learning stochastic deep policies.\n\nIt estimates the gradient using complete episode returns:\n\n*   where GtGtG\\_t is the empirical return and bbb is a baseline (often the mean return) that reduces variance without biasing the gradient.\n\n#### Variance Reduction and Baselines\n\n*   To make policy-gradient learning practical, variance-reduction techniques are crucial:\n    \n    *   **State-Value Baselines:** Replace raw return (G\\_t) with an estimate of the advantage At\\=Qt‚àíVtAt\\=Qt‚àíVtA\\_t = Q\\_t - V\\_t, where VtVtV\\_t is a learned value baseline.\n    *   **Generalized Advantage Estimation (GAE):** Introduced by [Schulman et al., 2016](https://arxiv.org/abs/1506.02438),\n        \n        *   GAE computes a bias-variance-controlled estimator of advantage by exponentially weighting multi-step TD errors:\n        \n        AÃÇ¬†(Œª)t\\=‚àël\\=0‚àû(Œ≥Œª)lŒ¥t+lwhereŒ¥t\\=rt+Œ≥V(st+1)‚àíV(st)A^t(Œª)\\=‚àël\\=0‚àû(Œ≥Œª)lŒ¥t+lwhereŒ¥t\\=rt+Œ≥V(st+1)‚àíV(st)\n        \n        \\\\hat{A}\\_t^{(\\\\lambda)} = \\\\sum\\_{l=0}^{\\\\infty} (\\\\gamma\\\\lambda)^l \\\\delta\\_{t+l} \\\\quad \\\\text{where}\\\\quad \\\\delta\\_t = r\\_t + \\\\gamma V(s\\_{t+1}) - V(s\\_t)\n*   This innovation enabled the training stability of modern deep policy-gradient algorithms.\n    \n\nTo make policy-gradient learning practical, variance-reduction techniques are crucial:\n\n*   **State-Value Baselines:** Replace raw return (G\\_t) with an estimate of the advantage At\\=Qt‚àíVtAt\\=Qt‚àíVtA\\_t = Q\\_t - V\\_t, where VtVtV\\_t is a learned value baseline.\n*   **Generalized Advantage Estimation (GAE):** Introduced by [Schulman et al., 2016](https://arxiv.org/abs/1506.02438),\n    \n    *   GAE computes a bias-variance-controlled estimator of advantage by exponentially weighting multi-step TD errors:\n    \n    AÃÇ¬†(Œª)t\\=‚àël\\=0‚àû(Œ≥Œª)lŒ¥t+lwhereŒ¥t\\=rt+Œ≥V(st+1)‚àíV(st)A^t(Œª)\\=‚àël\\=0‚àû(Œ≥Œª)lŒ¥t+lwhereŒ¥t\\=rt+Œ≥V(st+1)‚àíV(st)\n    \n    \\\\hat{A}\\_t^{(\\\\lambda)} = \\\\sum\\_{l=0}^{\\\\infty} (\\\\gamma\\\\lambda)^l \\\\delta\\_{t+l} \\\\quad \\\\text{where}\\\\quad \\\\delta\\_t = r\\_t + \\\\gamma V(s\\_{t+1}) - V(s\\_t)\n\n*   GAE computes a bias-variance-controlled estimator of advantage by exponentially weighting multi-step TD errors:\n\nThis innovation enabled the training stability of modern deep policy-gradient algorithms.\n\n#### Trust Region Policy Optimization (TRPO)\n\n*   One challenge in policy-gradient methods is **catastrophic policy collapse** due to overly large updates.\n*   **TRPO**, proposed by [Schulman et al., 2015](https://arxiv.org/abs/1502.05477), constrains the policy step within a _trust region_ to ensure monotonic improvement:\n\nmaxŒ∏;ùîºs,a‚àºœÄŒ∏old\\[œÄŒ∏(a‚à£s)œÄŒ∏old(a‚à£s),AœÄŒ∏old(s,a)\\]s.t.¬†ùîº\\[DKL(œÄŒ∏old(‚ãÖ‚à£s)‚ÄñœÄŒ∏(‚ãÖ‚à£s))\\]‚â§Œ¥maxŒ∏;Es,a‚àºœÄŒ∏old\\[œÄŒ∏(a‚à£s)œÄŒ∏old(a‚à£s),AœÄŒ∏old(s,a)\\]s.t.¬†E\\[DKL(œÄŒ∏old(‚ãÖ‚à£s)‚ÄñœÄŒ∏(‚ãÖ‚à£s))\\]‚â§Œ¥\n\n*   This optimization ensures conservative updates, improving stability across large neural-network policies.\n\n#### Proximal Policy Optimization (PPO)\n\n*   **PPO**, by [Schulman et al., 2017](https://arxiv.org/abs/1707.06347), is a policy-gradient algorithm designed to balance learning stability and efficiency. It improves on Trust Region Policy Optimization (TRPO) by enforcing a _soft trust region_ through a **clipped surrogate objective**, which discourages updates that move the policy too far from its previous version.\n*   The **clipped objective** is defined as:\n    \n    LCLIP(Œ∏)\\=ùîºt\\[min(rt(Œ∏)AÃÇ¬†t,clip(rt(Œ∏),1‚àíœµ,1+œµ)AÃÇ¬†t)\\]LCLIP(Œ∏)\\=Et\\[min(rt(Œ∏)A^t,clip(rt(Œ∏),1‚àíœµ,1+œµ)A^t)\\]\n    \n    L^{\\\\text{CLIP}}(\\\\theta) = \\\\mathbb{E}\\_t \\\\left\\[ \\\\min \\\\Big( r\\_t(\\\\theta) \\\\hat{A}\\_t, \\\\text{clip}\\\\big(r\\_t(\\\\theta), 1-\\\\epsilon, 1+\\\\epsilon\\\\big) \\\\hat{A}\\_t \\\\Big) \\\\right\\]\n    *   rt(Œ∏)\\=œÄŒ∏(at‚à£st)œÄŒ∏old(at‚à£st)rt(Œ∏)\\=œÄŒ∏(at‚à£st)œÄŒ∏old(at‚à£st)r\\_t(\\\\theta) = \\\\frac{\\\\pi\\_\\\\theta(a\\_t \\\\mid s\\_t)}{\\\\pi\\_{\\\\theta\\_{\\\\text{old}}}(a\\_t \\\\mid s\\_t)}: the **probability ratio** between new and old policies.\n    *   AÃÇ¬†tA^t\\\\hat{A}\\_t: the **advantage estimate**, typically rt‚àíVœï(st)rt‚àíVœï(st)r\\_t - V\\_\\\\phi(s\\_t), showing how much better the taken action was than expected.\n    *   œµœµ\\\\epsilon: a small constant (often 0.1‚Äì0.3) controlling the trust-region width.\n    *   The `min` operator ensures that the policy update never increases the objective beyond what the clipped surrogate allows, preventing overly large steps that can harm performance.\n*   Intuitively, PPO encourages policy improvement proportional to the advantage while **clipping** the update if the new policy deviates too far from the old one. This yields a stable and robust optimization process widely used in RLHF for aligning large language models.\n\nThe **clipped objective** is defined as:\n\n*   rt(Œ∏)\\=œÄŒ∏(at‚à£st)œÄŒ∏old(at‚à£st)rt(Œ∏)\\=œÄŒ∏(at‚à£st)œÄŒ∏old(at‚à£st)r\\_t(\\\\theta) = \\\\frac{\\\\pi\\_\\\\theta(a\\_t \\\\mid s\\_t)}{\\\\pi\\_{\\\\theta\\_{\\\\text{old}}}(a\\_t \\\\mid s\\_t)}: the **probability ratio** between new and old policies.\n*   AÃÇ¬†tA^t\\\\hat{A}\\_t: the **advantage estimate**, typically rt‚àíVœï(st)rt‚àíVœï(st)r\\_t - V\\_\\\\phi(s\\_t), showing how much better the taken action was than expected.\n*   œµœµ\\\\epsilon: a small constant (often 0.1‚Äì0.3) controlling the trust-region width.\n*   The `min` operator ensures that the policy update never increases the objective beyond what the clipped surrogate allows, preventing overly large steps that can harm performance.\n\n#### Entropy Regularization and Exploration\n\n*   To encourage exploration and avoid premature convergence to deterministic policies, **entropy regularization** augments the objective:\n\nJ‚Ä≤(Œ∏)\\=J(Œ∏)+Œ≤ùîºœÄŒ∏\\[Óà¥(œÄŒ∏(‚ãÖ‚à£s))\\]J‚Ä≤(Œ∏)\\=J(Œ∏)+Œ≤EœÄŒ∏\\[H(œÄŒ∏(‚ãÖ‚à£s))\\]\n\n*   where Óà¥(œÄ)\\=‚àí‚àëaœÄ(a‚à£s)logœÄ(a‚à£s)H(œÄ)\\=‚àí‚àëaœÄ(a‚à£s)log‚Å°œÄ(a‚à£s)\\\\mathcal{H}(\\\\pi) = -\\\\sum\\_a \\\\pi(a \\\\mid s)\\\\log\\\\pi(a \\\\mid s).\n*   This technique, introduced in **Soft Actor‚ÄìCritic** and earlier A3C methods, keeps the policy sufficiently stochastic to explore effectively.\n\n#### Comparative Analysis\n\n**Algorithm**\n\n**Key Idea**\n\n**Stability Technique**\n\n**Reference**\n\n**REINFORCE**\n\nMonte-Carlo policy-gradient\n\nBaseline subtraction\n\n[Williams (1992)](https://www.sciencedirect.com/science/article/abs/pii/S0893608005800100)\n\n**TRPO**\n\nTrust-region constrained updates\n\nKL-divergence constraint\n\n[Schulman et al., 2015](https://arxiv.org/abs/1502.05477)\n\n**PPO**\n\nClipped surrogate objective\n\nImplicit trust-region\n\n[Schulman et al., 2017](https://arxiv.org/abs/1707.06347)\n\n**GAE**\n\nLow-variance advantage estimator\n\nŒª-weighted TD residuals\n\n[Schulman et al., 2016](https://arxiv.org/abs/1506.02438)\n\n**Entropy Regularization**\n\nExploration through stochasticity\n\nEntropy bonus\n\nA3C / SAC families\n\n**Algorithm**\n\n**Key Idea**\n\n**Stability Technique**\n\n**Reference**\n\n**REINFORCE**\n\nMonte-Carlo policy-gradient\n\nBaseline subtraction\n\n[Williams (1992)](https://www.sciencedirect.com/science/article/abs/pii/S0893608005800100)\n\n**TRPO**\n\nTrust-region constrained updates\n\nKL-divergence constraint\n\n[Schulman et al., 2015](https://arxiv.org/abs/1502.05477)\n\n**PPO**\n\nClipped surrogate objective\n\nImplicit trust-region\n\n[Schulman et al., 2017](https://arxiv.org/abs/1707.06347)\n\n**GAE**\n\nLow-variance advantage estimator\n\nŒª-weighted TD residuals\n\n[Schulman et al., 2016](https://arxiv.org/abs/1506.02438)\n\n**Entropy Regularization**\n\nExploration through stochasticity\n\nEntropy bonus\n\nA3C / SAC families",
    "order": 17,
    "orderInChapter": 9,
    "difficulty": 5,
    "estimatedMinutes": 5,
    "tags": [
      "algorithmsarchitecture",
      "neural network",
      "reinforcement learning",
      "optimization",
      "regularization"
    ],
    "metadata": {
      "hasCode": true,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 923,
      "contentLength": 188553
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#deep-policy-based-methods",
    "scrapedAt": "2025-12-28T11:47:08.460Z"
  },
  {
    "id": "ai-reinforcement-learning-deep-actorcritic-methods-18",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Types of Reinforcement Learning",
    "title": "Deep Actor‚ÄìCritic Methods",
    "subtitle": "Types of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>\n    <p><strong>Actor‚ÄìCritic methods</strong> combine the advantages of value-based and policy-based reinforcement learning by maintaining two distinct components:</p>\n\n    <ol>\n      <li><strong>Actor</strong>: A policy network <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-215-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3516\" style=\"width: 4.013em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.336em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.28em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3517\"><span class=\"msubsup\" id=\"MathJax-Span-3518\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3519\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3520\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3521\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3522\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-3523\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-3524\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-3525\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-215\">\\pi_\\theta(a \\mid s)</script> that selects actions.</li>\n      <li><strong>Critic</strong>: A value or Q-network <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-216-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>w</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3526\" style=\"width: 2.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.14em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3527\"><span class=\"msubsup\" id=\"MathJax-Span-3528\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3529\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3530\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3531\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3532\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-3533\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>w</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-216\">V_w(s)</script> or <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-217-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>Q</mi><mi>w</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3534\" style=\"width: 3.909em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.232em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.18em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3535\"><span class=\"msubsup\" id=\"MathJax-Span-3536\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3537\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-3538\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3539\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3540\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-3541\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3542\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-3543\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>Q</mi><mi>w</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-217\">Q_w(s,a)</script> that estimates expected returns and provides feedback to the actor.</li>\n    </ol>\n  </li>\n  <li>The actor updates its parameters to maximize the critic‚Äôs estimated value, while the critic updates to better predict the returns observed from the actor‚Äôs behavior.</li>\n  <li>Deep Actor‚ÄìCritic methods extend this paradigm using deep neural networks for both components, enabling scalability to complex, continuous, or high-dimensional environments.</li>\n</ul>\n<p><strong>Actor‚ÄìCritic methods</strong> combine the advantages of value-based and policy-based reinforcement learning by maintaining two distinct components:</p>\n<ol>\n      <li><strong>Actor</strong>: A policy network <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-215-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3516\" style=\"width: 4.013em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.336em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.28em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3517\"><span class=\"msubsup\" id=\"MathJax-Span-3518\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3519\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3520\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3521\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3522\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-3523\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-3524\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-3525\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-215\">\\pi_\\theta(a \\mid s)</script> that selects actions.</li>\n      <li><strong>Critic</strong>: A value or Q-network <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-216-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>w</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3526\" style=\"width: 2.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.14em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3527\"><span class=\"msubsup\" id=\"MathJax-Span-3528\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3529\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3530\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3531\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3532\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-3533\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>w</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-216\">V_w(s)</script> or <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-217-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>Q</mi><mi>w</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3534\" style=\"width: 3.909em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.232em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.18em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3535\"><span class=\"msubsup\" id=\"MathJax-Span-3536\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3537\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-3538\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3539\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3540\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-3541\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3542\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-3543\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>Q</mi><mi>w</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-217\">Q_w(s,a)</script> that estimates expected returns and provides feedback to the actor.</li>\n    </ol>\n<h4 id=\"theoretical-foundation\">Theoretical Foundation</h4>\n<ul>\n  <li>\n    <p>The policy gradient for an actor‚Äìcritic setup is given by:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-218-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3544\" style=\"width: 22.294em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 18.544em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.034em, 1018.34em, 3.753em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3545\"><span class=\"msubsup\" id=\"MathJax-Span-3546\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3547\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-3548\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-3549\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3550\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3551\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3552\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3553\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-3554\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3555\"><span class=\"mrow\" id=\"MathJax-Span-3556\"><span class=\"mi\" id=\"MathJax-Span-3557\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3558\"><span class=\"mrow\" id=\"MathJax-Span-3559\"><span class=\"msubsup\" id=\"MathJax-Span-3560\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3561\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-3562\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3563\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3564\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3565\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3566\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3567\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"msubsup\" id=\"MathJax-Span-3568\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3569\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3570\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-3571\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-3572\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span><span class=\"mrow\" id=\"MathJax-Span-3573\"><span class=\"msubsup\" id=\"MathJax-Span-3574\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3575\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-3576\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-3577\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-3578\"></span><span class=\"msubsup\" id=\"MathJax-Span-3579\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3580\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3581\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3582\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3583\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3584\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3585\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3586\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-3587\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3588\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3589\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3590\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3591\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-3592\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-3593\"><span class=\"munderover\" id=\"MathJax-Span-3594\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3595\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-3596\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3597\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3598\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3599\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3600\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3601\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3602\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3603\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3604\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3605\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-3606\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mi>J</mi><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>‚àº</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mi>log</mi><mo>‚Å°</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-218\">\\nabla_\\theta J(\\theta) = \\mathbb{E}_{s_t,a_t \\sim \\pi_\\theta}  \\left[\n\\nabla_\\theta \\log \\pi_\\theta(a_t \\mid s_t) , \\hat{A}(s_t,a_t)\n\\right]</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-219-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3607\" style=\"width: 3.909em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.232em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1003.18em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3608\"><span class=\"texatom\" id=\"MathJax-Span-3609\"><span class=\"mrow\" id=\"MathJax-Span-3610\"><span class=\"munderover\" id=\"MathJax-Span-3611\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3612\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-3613\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3614\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3615\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3616\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3617\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3618\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3619\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3620\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3621\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3622\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-219\">\\hat{A}(s_t,a_t)</script> is the <strong>advantage estimate</strong> that quantifies how much better action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-220-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3623\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3624\"><span class=\"msubsup\" id=\"MathJax-Span-3625\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3626\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3627\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-220\">a_t</script> is compared to the average performance at state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-221-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3628\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3629\"><span class=\"msubsup\" id=\"MathJax-Span-3630\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3631\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3632\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-221\">s_t</script>.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The critic learns this advantage by minimizing a regression loss, typically using Temporal Difference (TD) learning:</p>\n  </li>\n</ul>\n<p>The policy gradient for an actor‚Äìcritic setup is given by:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-219-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3607\" style=\"width: 3.909em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.232em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1003.18em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3608\"><span class=\"texatom\" id=\"MathJax-Span-3609\"><span class=\"mrow\" id=\"MathJax-Span-3610\"><span class=\"munderover\" id=\"MathJax-Span-3611\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3612\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-3613\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3614\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3615\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3616\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3617\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3618\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3619\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3620\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3621\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3622\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-219\">\\hat{A}(s_t,a_t)</script> is the <strong>advantage estimate</strong> that quantifies how much better action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-220-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3623\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3624\"><span class=\"msubsup\" id=\"MathJax-Span-3625\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3626\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3627\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-220\">a_t</script> is compared to the average performance at state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-221-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3628\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3629\"><span class=\"msubsup\" id=\"MathJax-Span-3630\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3631\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3632\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-221\">s_t</script>.</li>\n    </ul>\n<p>The critic learns this advantage by minimizing a regression loss, typically using Temporal Difference (TD) learning:</p>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-222-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>L</mi><mo stretchy=&quot;false&quot;>(</mo><mi>w</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow><mo>[</mo><msup><mrow><mo>(</mo><mrow><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B3;</mi><msub><mi>V</mi><mi>w</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>V</mi><mi>w</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>)</mo></mrow><mn>2</mn></msup><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3633\" style=\"width: 18.336em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 15.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.878em, 1015.11em, 3.44em, -999.997em); top: -2.914em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3634\"><span class=\"mi\" id=\"MathJax-Span-3635\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3636\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3637\" style=\"font-family: STIXGeneral-Italic;\">w</span><span class=\"mo\" id=\"MathJax-Span-3638\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3639\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-3640\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-3641\"><span class=\"mi\" id=\"MathJax-Span-3642\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span class=\"mrow\" id=\"MathJax-Span-3643\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-3644\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">[</span></span><span class=\"msubsup\" id=\"MathJax-Span-3645\"><span style=\"display: inline-block; position: relative; width: 10.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1010em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3646\"><span class=\"mo\" id=\"MathJax-Span-3647\" style=\"vertical-align: 0em;\"><span style=\"font-family: STIXGeneral-Regular;\">(</span></span><span class=\"mrow\" id=\"MathJax-Span-3648\"><span class=\"msubsup\" id=\"MathJax-Span-3649\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3650\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3651\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3652\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3653\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-3654\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3655\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3656\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3657\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3658\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3659\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-3660\"><span class=\"mrow\" id=\"MathJax-Span-3661\"><span class=\"mi\" id=\"MathJax-Span-3662\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3663\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-3664\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3665\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3666\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-3667\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3668\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3669\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3670\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3671\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3672\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3673\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3674\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-3675\" style=\"vertical-align: 0em;\"><span style=\"font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 10.055em;\"><span class=\"mn\" id=\"MathJax-Span-3676\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3677\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.919em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>L</mi><mo stretchy=\"false\">(</mo><mi>w</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow><mo>[</mo><msup><mrow><mo>(</mo><mrow><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>Œ≥</mi><msub><mi>V</mi><mi>w</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>V</mi><mi>w</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>)</mo></mrow><mn>2</mn></msup><mo>]</mo></mrow></math></span></span></div>\n<ul>\n  <li>Thus, the actor improves its policy using gradients from the critic‚Äôs evaluation, creating a feedback loop that balances <strong>bias (from bootstrapping)</strong> and <strong>variance (from sampling)</strong>.</li>\n</ul>\n<h4 id=\"asynchronous-advantage-actorcritic-a3c\">Asynchronous Advantage Actor‚ÄìCritic (A3C)</h4>\n<ul>\n  <li>\n    <p>The <strong>A3C algorithm</strong>, introduced by <a href=\"https://arxiv.org/abs/1602.01783\">Mnih et al. (2016)</a>, demonstrated that multiple agents (workers) can interact with independent environment instances in parallel, asynchronously updating a shared global model.</p>\n  </li>\n  <li>\n    <p>Each worker learns both an actor and a critic, using an advantage-based update:</p>\n  </li>\n</ul>\n<p>The <strong>A3C algorithm</strong>, introduced by <a href=\"https://arxiv.org/abs/1602.01783\">Mnih et al. (2016)</a>, demonstrated that multiple agents (workers) can interact with independent environment instances in parallel, asynchronously updating a shared global model.</p>\n<p>Each worker learns both an actor and a critic, using an advantage-based update:</p>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-223-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>&amp;#x2190;</mo><mi>&amp;#x03B8;</mi><mo>+</mo><mi>&amp;#x03B1;</mi><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>R</mi><mi>t</mi></msub><mo>&amp;#x2212;</mo><msub><mi>V</mi><mi>w</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3678\" style=\"width: 19.69em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 16.409em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1016.36em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3679\"><span class=\"mi\" id=\"MathJax-Span-3680\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3681\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üê</span><span class=\"mi\" id=\"MathJax-Span-3682\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3683\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3684\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ±</span><span class=\"msubsup\" id=\"MathJax-Span-3685\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3686\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-3687\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-3688\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-3689\"></span><span class=\"msubsup\" id=\"MathJax-Span-3690\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3691\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3692\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3693\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3694\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3695\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3696\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3697\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-3698\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3699\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3700\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3701\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3702\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3703\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3704\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3705\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3706\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-3707\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3708\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3709\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3710\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3711\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3712\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3713\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3714\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3715\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>Œ∏</mi><mo stretchy=\"false\">‚Üê</mo><mi>Œ∏</mi><mo>+</mo><mi>Œ±</mi><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mi>log</mi><mo>‚Å°</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><msub><mi>R</mi><mi>t</mi></msub><mo>‚àí</mo><msub><mi>V</mi><mi>w</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></math></span></span></div>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-224-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>w</mi><mo stretchy=&quot;false&quot;>&amp;#x2190;</mo><mi>w</mi><mo>&amp;#x2212;</mo><mi>&amp;#x03B2;</mi><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>w</mi></msub><msup><mrow><mo>(</mo><mrow><msub><mi>R</mi><mi>t</mi></msub><mo>&amp;#x2212;</mo><msub><mi>V</mi><mi>w</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>)</mo></mrow><mn>2</mn></msup></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3716\" style=\"width: 14.065em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 11.721em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1011.72em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3717\"><span class=\"mi\" id=\"MathJax-Span-3718\" style=\"font-family: STIXGeneral-Italic;\">w</span><span class=\"mo\" id=\"MathJax-Span-3719\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Üê</span><span class=\"mi\" id=\"MathJax-Span-3720\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">w</span><span class=\"mo\" id=\"MathJax-Span-3721\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-3722\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-3723\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3724\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-3725\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3726\"><span style=\"display: inline-block; position: relative; width: 5.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1005.21em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3727\"><span class=\"mo\" id=\"MathJax-Span-3728\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mrow\" id=\"MathJax-Span-3729\"><span class=\"msubsup\" id=\"MathJax-Span-3730\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3731\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3732\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3733\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-3734\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3735\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3736\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3737\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3738\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3739\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3740\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3741\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-3742\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 5.263em;\"><span class=\"mn\" id=\"MathJax-Span-3743\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.441em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>w</mi><mo stretchy=\"false\">‚Üê</mo><mi>w</mi><mo>‚àí</mo><mi>Œ≤</mi><msub><mi mathvariant=\"normal\">‚àá</mi><mi>w</mi></msub><msup><mrow><mo>(</mo><mrow><msub><mi>R</mi><mi>t</mi></msub><mo>‚àí</mo><msub><mi>V</mi><mi>w</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>)</mo></mrow><mn>2</mn></msup></math></span></span></div>\n<ul>\n  <li>This asynchronous setup increases data throughput and decorrelates experience, enabling training without replay buffers.</li>\n  <li>A3C achieved state-of-the-art performance on a variety of Atari and continuous control benchmarks.</li>\n</ul>\n<h4 id=\"advantage-actorcritic-a2c\">Advantage Actor‚ÄìCritic (A2C)</h4>\n<ul>\n  <li>The <strong>A2C algorithm</strong> is a <strong>synchronous</strong> variant of A3C that aggregates gradients from multiple parallel environments before performing a single update.</li>\n  <li>\n    <p>Although less parallelized, A2C offers improved training stability and is widely used in implementations such as OpenAI Baselines.</p>\n  </li>\n  <li>The advantage function is often estimated using <strong>Generalized Advantage Estimation (GAE)</strong> (<a href=\"https://arxiv.org/abs/1506.02438\">Schulman et al., 2016</a>), which balances bias and variance for stable learning.</li>\n</ul>\n<p>Although less parallelized, A2C offers improved training stability and is widely used in implementations such as OpenAI Baselines.</p>\n<h4 id=\"deep-deterministic-policy-gradient-ddpg\">Deep Deterministic Policy Gradient (DDPG)</h4>\n<ul>\n  <li>For <strong>continuous control</strong> tasks (e.g., robotic movement), discrete action selection is infeasible.</li>\n  <li><strong>DDPG</strong>, introduced by <a href=\"https://arxiv.org/abs/1509.02971\">Lillicrap et al. (2015)</a>, extends the actor‚Äìcritic framework to <strong>deterministic policies</strong>:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-225-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>a</mi><mo>=</mo><msub><mi>&amp;#x03BC;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3744\" style=\"width: 4.378em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.648em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.6em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3745\"><span class=\"mi\" id=\"MathJax-Span-3746\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-3747\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-3748\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3749\" style=\"font-family: STIXGeneral-Italic;\">Œº</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3750\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3751\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3752\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-3753\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>a</mi><mo>=</mo><msub><mi>Œº</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span></div>\n<ul>\n  <li>The actor is updated using the gradient of the critic‚Äôs Q-value:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-226-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mo>&amp;#x223C;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>D</mi></mrow></mrow></msub><mrow><mo>[</mo><mrow><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>a</mi></msub><msub><mi>Q</mi><mi>w</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>a</mi><mo>=</mo><msub><mi>&amp;#x03BC;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><msub><mi>&amp;#x03BC;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3754\" style=\"width: 20.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 17.398em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.398em, 1017.19em, 4.846em, -999.997em); top: -3.799em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3755\"><span class=\"msubsup\" id=\"MathJax-Span-3756\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3757\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-3758\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-3759\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3760\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3761\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3762\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3763\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-3764\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3765\"><span class=\"mrow\" id=\"MathJax-Span-3766\"><span class=\"mi\" id=\"MathJax-Span-3767\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3768\"><span class=\"mrow\" id=\"MathJax-Span-3769\"><span class=\"mi\" id=\"MathJax-Span-3770\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-3771\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"texatom\" id=\"MathJax-Span-3772\"><span class=\"mrow\" id=\"MathJax-Span-3773\"><span class=\"mi\" id=\"MathJax-Span-3774\" style=\"font-size: 70.7%; font-family: STIXNonUnicode-Italic;\">Óà∞</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-3775\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-3776\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">[</span></span></span><span class=\"mrow\" id=\"MathJax-Span-3777\"><span class=\"msubsup\" id=\"MathJax-Span-3778\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3779\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-3780\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3781\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3782\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-3783\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3784\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3785\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-3786\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3787\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-3788\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-3789\" style=\"\"><span style=\"display: inline-block; position: relative; width: 2.607em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.711em, 1000.16em, 4.846em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3790\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-3791\"><span class=\"mo\" id=\"MathJax-Span-3792\" style=\"vertical-align: 1.148em;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px;\"><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -3.331em; left: 0em;\">‚à£<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -2.393em; left: 0em;\">‚à£<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -2.862em; left: 0em;\">‚à£<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.331em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-3793\"><span class=\"mrow\" id=\"MathJax-Span-3794\"><span class=\"mi\" id=\"MathJax-Span-3795\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-3796\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-3797\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3798\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œº</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3799\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3800\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3801\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-3802\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3803\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3804\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-3805\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3806\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3807\" style=\"font-family: STIXGeneral-Italic;\">Œº</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3808\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3809\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3810\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-3811\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-3812\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">]</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.805em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><mi>J</mi><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>s</mi><mo>‚àº</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">D</mi></mrow></mrow></msub><mrow><mo>[</mo><mrow><msub><mi mathvariant=\"normal\">‚àá</mi><mi>a</mi></msub><msub><mi>Q</mi><mi>w</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.623em\" minsize=\"1.623em\">|</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>a</mi><mo>=</mo><msub><mi>Œº</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow></msub><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><msub><mi>Œº</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div>\n<ul>\n  <li>\n    <p>DDPG employs:</p>\n\n    <ul>\n      <li>A <strong>replay buffer</strong> for decorrelated training data,</li>\n      <li><strong>Target networks</strong> for stable updates, and</li>\n      <li><strong>Ornstein‚ÄìUhlenbeck noise</strong> for exploration in continuous spaces.</li>\n    </ul>\n  </li>\n  <li>\n    <p>This made DDPG a foundational algorithm for robotic and control applications.</p>\n  </li>\n</ul>\n<p>DDPG employs:</p>\n<ul>\n      <li>A <strong>replay buffer</strong> for decorrelated training data,</li>\n      <li><strong>Target networks</strong> for stable updates, and</li>\n      <li><strong>Ornstein‚ÄìUhlenbeck noise</strong> for exploration in continuous spaces.</li>\n    </ul>\n<p>This made DDPG a foundational algorithm for robotic and control applications.</p>\n<h4 id=\"twin-delayed-ddpg-td3\">Twin Delayed DDPG (TD3)</h4>\n<ul>\n  <li>While DDPG is powerful, it suffers from overestimation bias similar to Q-learning.</li>\n  <li><strong>TD3</strong>, by <a href=\"https://arxiv.org/abs/1802.09477\">Fujimoto et al. (2018)</a>, mitigates this through three improvements:</li>\n</ul>\n<ol>\n  <li><strong>Clipped Double Q-Learning:</strong> Two critics are trained, and the smaller Q-value is used for the target.</li>\n  <li><strong>Target Policy Smoothing:</strong> Adds noise to target actions for robustness.</li>\n  <li><strong>Delayed Policy Updates:</strong> Updates the actor less frequently than the critic for stability.</li>\n</ol>\n<ul>\n  <li>\n    <p>Target computation in TD3 becomes:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-227-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>y</mi><mo>=</mo><mi>r</mi><mo>+</mo><mi>&amp;#x03B3;</mi><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>min</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn></mrow></munder><msub><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msubsup><mi>w</mi><mi>i</mi><mo>&amp;#x2032;</mo></msubsup></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>,</mo><msub><mi>&amp;#x03BC;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>&amp;#x03B8;</mi><mo>&amp;#x2032;</mo></msup></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03F5;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3813\" style=\"width: 15.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 13.18em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1013.13em, 3.232em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3814\"><span class=\"mi\" id=\"MathJax-Span-3815\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-3816\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-3817\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3818\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3819\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"munderover\" id=\"MathJax-Span-3820\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1001.57em, 4.169em, -999.997em); top: -4.008em; left: 0.003em;\"><span class=\"mo\" id=\"MathJax-Span-3821\" style=\"font-family: STIXGeneral-Regular;\">min</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.57em, 4.378em, -999.997em); top: -3.331em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3822\"><span class=\"mrow\" id=\"MathJax-Span-3823\"><span class=\"mi\" id=\"MathJax-Span-3824\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-3825\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-3826\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-3827\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-3828\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3829\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3830\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-3831\"><span class=\"mrow\" id=\"MathJax-Span-3832\"><span class=\"msubsup\" id=\"MathJax-Span-3833\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3834\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.596em, 1000.21em, 4.169em, -999.997em); top: -4.216em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-3835\" style=\"font-size: 50%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.21em, 4.169em, -999.997em); top: -3.799em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-3836\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3837\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-3838\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3839\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-3840\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3841\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3842\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3843\" style=\"font-family: STIXGeneral-Italic;\">Œº</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.799em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-3844\"><span class=\"mrow\" id=\"MathJax-Span-3845\"><span class=\"msup\" id=\"MathJax-Span-3846\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3847\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.419em;\"><span class=\"mo\" id=\"MathJax-Span-3848\" style=\"font-size: 50%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3849\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-3850\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3851\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-3852\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3853\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3854\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3855\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">œµ</span><span class=\"mo\" id=\"MathJax-Span-3856\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>y</mi><mo>=</mo><mi>r</mi><mo>+</mo><mi>Œ≥</mi><munder><mo movablelimits=\"true\" form=\"prefix\">min</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn></mrow></munder><msub><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><msubsup><mi>w</mi><mi>i</mi><mo>‚Ä≤</mo></msubsup></mrow></msub><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>,</mo><msub><mi>Œº</mi><mrow class=\"MJX-TeXAtom-ORD\"><msup><mi>Œ∏</mi><mo>‚Ä≤</mo></msup></mrow></msub><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo><mo>+</mo><mi>œµ</mi><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-227\">y = r + \\gamma \\min_{i=1,2} Q_{w_i'}(s', \\mu_{\\theta'}(s') + \\epsilon)</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-228-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03F5;</mi><mo>&amp;#x223C;</mo><mtext>clip</mtext><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>N</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo>,</mo><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mo>&amp;#x2212;</mo><mi>c</mi><mo>,</mo><mi>c</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3857\" style=\"width: 11.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.221em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1009.17em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3858\"><span class=\"mi\" id=\"MathJax-Span-3859\" style=\"font-family: STIXGeneral-Italic;\">œµ</span><span class=\"mo\" id=\"MathJax-Span-3860\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àº</span><span class=\"mtext\" id=\"MathJax-Span-3861\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">clip</span><span class=\"mo\" id=\"MathJax-Span-3862\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"texatom\" id=\"MathJax-Span-3863\"><span class=\"mrow\" id=\"MathJax-Span-3864\"><span class=\"mi\" id=\"MathJax-Span-3865\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∫<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.107em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3866\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mn\" id=\"MathJax-Span-3867\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-3868\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3869\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">œÉ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3870\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3871\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-3872\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-3873\" style=\"font-family: STIXGeneral-Italic;\">c</span><span class=\"mo\" id=\"MathJax-Span-3874\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3875\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">c</span><span class=\"mo\" id=\"MathJax-Span-3876\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œµ</mi><mo>‚àº</mo><mtext>clip</mtext><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">N</mi></mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mi>œÉ</mi><mo stretchy=\"false\">)</mo><mo>,</mo><mo>‚àí</mo><mi>c</mi><mo>,</mo><mi>c</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-228\">\\epsilon \\sim \\text{clip}(\\mathcal{N}(0, \\sigma), -c, c)</script>.</li>\n    </ul>\n  </li>\n</ul>\n<p>Target computation in TD3 becomes:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-228-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03F5;</mi><mo>&amp;#x223C;</mo><mtext>clip</mtext><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>N</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo>,</mo><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mo>&amp;#x2212;</mo><mi>c</mi><mo>,</mo><mi>c</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3857\" style=\"width: 11.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.221em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1009.17em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3858\"><span class=\"mi\" id=\"MathJax-Span-3859\" style=\"font-family: STIXGeneral-Italic;\">œµ</span><span class=\"mo\" id=\"MathJax-Span-3860\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àº</span><span class=\"mtext\" id=\"MathJax-Span-3861\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">clip</span><span class=\"mo\" id=\"MathJax-Span-3862\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"texatom\" id=\"MathJax-Span-3863\"><span class=\"mrow\" id=\"MathJax-Span-3864\"><span class=\"mi\" id=\"MathJax-Span-3865\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∫<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.107em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3866\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mn\" id=\"MathJax-Span-3867\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-3868\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3869\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">œÉ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3870\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3871\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mo\" id=\"MathJax-Span-3872\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-3873\" style=\"font-family: STIXGeneral-Italic;\">c</span><span class=\"mo\" id=\"MathJax-Span-3874\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3875\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">c</span><span class=\"mo\" id=\"MathJax-Span-3876\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œµ</mi><mo>‚àº</mo><mtext>clip</mtext><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">N</mi></mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mi>œÉ</mi><mo stretchy=\"false\">)</mo><mo>,</mo><mo>‚àí</mo><mi>c</mi><mo>,</mo><mi>c</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-228\">\\epsilon \\sim \\text{clip}(\\mathcal{N}(0, \\sigma), -c, c)</script>.</li>\n    </ul>\n<h4 id=\"soft-actorcritic-sac\">Soft Actor‚ÄìCritic (SAC)</h4>\n<ul>\n  <li>The <strong>Soft Actor‚ÄìCritic (SAC)</strong> algorithm, proposed by <a href=\"https://arxiv.org/abs/1801.01290\">Haarnoja et al. (2018)</a>, extends actor‚Äìcritic learning to the <strong>maximum-entropy RL framework</strong>, optimizing not only expected returns but also <strong>policy entropy</strong>:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-229-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munder><mo>&amp;#x2211;</mo><mi>t</mi></munder><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x223C;</mo><mi>&amp;#x03C0;</mi></mrow></msub><mrow><mo>[</mo><mrow><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>&amp;#x03B1;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>H</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3877\" style=\"width: 21.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 17.815em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1017.71em, 3.648em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3878\"><span class=\"mi\" id=\"MathJax-Span-3879\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3880\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3881\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3882\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3883\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-3884\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-3885\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.21em, 4.273em, -999.997em); top: -2.862em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3886\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3887\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 3.232em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3888\"><span class=\"mrow\" id=\"MathJax-Span-3889\"><span class=\"mi\" id=\"MathJax-Span-3890\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-3891\"><span class=\"mrow\" id=\"MathJax-Span-3892\"><span class=\"mo\" id=\"MathJax-Span-3893\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3894\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3895\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-3896\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3897\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3898\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3899\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3900\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3901\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3902\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"mi\" id=\"MathJax-Span-3903\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-3904\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-3905\" style=\"vertical-align: 0.003em;\"><span style=\"font-family: STIXGeneral-Regular;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-3906\"><span class=\"mi\" id=\"MathJax-Span-3907\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3908\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-3909\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3910\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3911\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3912\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-3913\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3914\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3915\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3916\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3917\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3918\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ±</span><span class=\"texatom\" id=\"MathJax-Span-3919\"><span class=\"mrow\" id=\"MathJax-Span-3920\"><span class=\"mi\" id=\"MathJax-Span-3921\" style=\"font-family: STIXNonUnicode-Italic;\">Óà¥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3922\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3923\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3924\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-3925\" style=\"font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-3926\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-3927\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3928\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-3929\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3930\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3931\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-3932\" style=\"vertical-align: 0.003em;\"><span style=\"font-family: STIXGeneral-Regular;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 2.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>J</mi><mo stretchy=\"false\">(</mo><mi>œÄ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munder><mo>‚àë</mo><mi>t</mi></munder><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>‚àº</mo><mi>œÄ</mi></mrow></msub><mrow><mo>[</mo><mrow><mi>r</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>+</mo><mi>Œ±</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">H</mi></mrow><mo stretchy=\"false\">(</mo><mi>œÄ</mi><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div>\n<ul>\n  <li>This encourages exploration by maximizing randomness in action selection while maintaining performance.</li>\n  <li>SAC combines off-policy replay buffers with entropy regularization and is one of the most sample-efficient continuous control algorithms available.</li>\n</ul>\n<h4 id=\"comparative-analysis-7\">Comparative Analysis</h4>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Algorithm</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Policy Type</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Exploration</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Stability Mechanism</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Key Reference</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>A3C</strong></td>\n<td class=\"tg-tleft-valign-first\">Stochastic</td>\n<td class=\"tg-tleft-valign-first\">Parallel workers</td>\n<td class=\"tg-tleft-valign-first\">Asynchronous updates</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1602.01783\">Mnih et al., 2016</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>A2C</strong></td>\n<td class=\"tg-tleft-valign-first\">Stochastic</td>\n<td class=\"tg-tleft-valign-first\">Parallel rollout</td>\n<td class=\"tg-tleft-valign-first\">Synchronous gradient averaging</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1506.02438\">Schulman et al., 2016</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>DDPG</strong></td>\n<td class=\"tg-tleft-valign-first\">Deterministic</td>\n<td class=\"tg-tleft-valign-first\">OU noise</td>\n<td class=\"tg-tleft-valign-first\">Target networks, replay buffer</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1509.02971\">Lillicrap et al., 2015</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>TD3</strong></td>\n<td class=\"tg-tleft-valign-first\">Deterministic</td>\n<td class=\"tg-tleft-valign-first\">Policy smoothing</td>\n<td class=\"tg-tleft-valign-first\">Double critics, delayed updates</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1802.09477\">Fujimoto et al., 2018</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>SAC</strong></td>\n<td class=\"tg-tleft-valign-first\">Stochastic</td>\n<td class=\"tg-tleft-valign-first\">Maximum entropy</td>\n<td class=\"tg-tleft-valign-first\">Entropy regularization</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1801.01290\">Haarnoja et al., 2018</a></td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Algorithm</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Policy Type</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Exploration</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Stability Mechanism</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Key Reference</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>A3C</strong></td>\n<td class=\"tg-tleft-valign-first\">Stochastic</td>\n<td class=\"tg-tleft-valign-first\">Parallel workers</td>\n<td class=\"tg-tleft-valign-first\">Asynchronous updates</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1602.01783\">Mnih et al., 2016</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>A2C</strong></td>\n<td class=\"tg-tleft-valign-first\">Stochastic</td>\n<td class=\"tg-tleft-valign-first\">Parallel rollout</td>\n<td class=\"tg-tleft-valign-first\">Synchronous gradient averaging</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1506.02438\">Schulman et al., 2016</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>DDPG</strong></td>\n<td class=\"tg-tleft-valign-first\">Deterministic</td>\n<td class=\"tg-tleft-valign-first\">OU noise</td>\n<td class=\"tg-tleft-valign-first\">Target networks, replay buffer</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1509.02971\">Lillicrap et al., 2015</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>TD3</strong></td>\n<td class=\"tg-tleft-valign-first\">Deterministic</td>\n<td class=\"tg-tleft-valign-first\">Policy smoothing</td>\n<td class=\"tg-tleft-valign-first\">Double critics, delayed updates</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1802.09477\">Fujimoto et al., 2018</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>SAC</strong></td>\n<td class=\"tg-tleft-valign-first\">Stochastic</td>\n<td class=\"tg-tleft-valign-first\">Maximum entropy</td>\n<td class=\"tg-tleft-valign-first\">Entropy regularization</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1801.01290\">Haarnoja et al., 2018</a></td>\n</tr>\n</tbody>\n</table>\n<ul>\n  <li>Deep Actor‚ÄìCritic methods form the backbone of modern Deep RL systems, bridging discrete and continuous domains while balancing stability, efficiency, and exploration.</li>\n  <li>They underpin much of the progress in robotics, game-playing, and large-scale simulation-based learning.</li>\n</ul>",
    "contentMarkdown": "*   **Actor‚ÄìCritic methods** combine the advantages of value-based and policy-based reinforcement learning by maintaining two distinct components:\n    \n    1.  **Actor**: A policy network œÄŒ∏(a‚à£s)œÄŒ∏(a‚à£s)\\\\pi\\_\\\\theta(a \\\\mid s) that selects actions.\n    2.  **Critic**: A value or Q-network Vw(s)Vw(s)V\\_w(s) or Qw(s,a)Qw(s,a)Q\\_w(s,a) that estimates expected returns and provides feedback to the actor.\n*   The actor updates its parameters to maximize the critic‚Äôs estimated value, while the critic updates to better predict the returns observed from the actor‚Äôs behavior.\n*   Deep Actor‚ÄìCritic methods extend this paradigm using deep neural networks for both components, enabling scalability to complex, continuous, or high-dimensional environments.\n\n**Actor‚ÄìCritic methods** combine the advantages of value-based and policy-based reinforcement learning by maintaining two distinct components:\n\n1.  **Actor**: A policy network œÄŒ∏(a‚à£s)œÄŒ∏(a‚à£s)\\\\pi\\_\\\\theta(a \\\\mid s) that selects actions.\n2.  **Critic**: A value or Q-network Vw(s)Vw(s)V\\_w(s) or Qw(s,a)Qw(s,a)Q\\_w(s,a) that estimates expected returns and provides feedback to the actor.\n\n#### Theoretical Foundation\n\n*   The policy gradient for an actor‚Äìcritic setup is given by:\n    \n    ‚àáŒ∏J(Œ∏)\\=ùîºst,at‚àºœÄŒ∏\\[‚àáŒ∏logœÄŒ∏(at‚à£st),AÃÇ¬†(st,at)\\]‚àáŒ∏J(Œ∏)\\=Est,at‚àºœÄŒ∏\\[‚àáŒ∏log‚Å°œÄŒ∏(at‚à£st),A^(st,at)\\]\n    \n    \\\\nabla\\_\\\\theta J(\\\\theta) = \\\\mathbb{E}\\_{s\\_t,a\\_t \\\\sim \\\\pi\\_\\\\theta} \\\\left\\[ \\\\nabla\\_\\\\theta \\\\log \\\\pi\\_\\\\theta(a\\_t \\\\mid s\\_t) , \\\\hat{A}(s\\_t,a\\_t) \\\\right\\]\n    *   where AÃÇ¬†(st,at)A^(st,at)\\\\hat{A}(s\\_t,a\\_t) is the **advantage estimate** that quantifies how much better action atata\\_t is compared to the average performance at state ststs\\_t.\n*   The critic learns this advantage by minimizing a regression loss, typically using Temporal Difference (TD) learning:\n    \n\nThe policy gradient for an actor‚Äìcritic setup is given by:\n\n*   where AÃÇ¬†(st,at)A^(st,at)\\\\hat{A}(s\\_t,a\\_t) is the **advantage estimate** that quantifies how much better action atata\\_t is compared to the average performance at state ststs\\_t.\n\nThe critic learns this advantage by minimizing a regression loss, typically using Temporal Difference (TD) learning:\n\nL(w)\\=ùîº\\[(rt+Œ≥Vw(st+1)‚àíVw(st))2\\]L(w)\\=E\\[(rt+Œ≥Vw(st+1)‚àíVw(st))2\\]\n\n*   Thus, the actor improves its policy using gradients from the critic‚Äôs evaluation, creating a feedback loop that balances **bias (from bootstrapping)** and **variance (from sampling)**.\n\n#### Asynchronous Advantage Actor‚ÄìCritic (A3C)\n\n*   The **A3C algorithm**, introduced by [Mnih et al. (2016)](https://arxiv.org/abs/1602.01783), demonstrated that multiple agents (workers) can interact with independent environment instances in parallel, asynchronously updating a shared global model.\n    \n*   Each worker learns both an actor and a critic, using an advantage-based update:\n    \n\nThe **A3C algorithm**, introduced by [Mnih et al. (2016)](https://arxiv.org/abs/1602.01783), demonstrated that multiple agents (workers) can interact with independent environment instances in parallel, asynchronously updating a shared global model.\n\nEach worker learns both an actor and a critic, using an advantage-based update:\n\nŒ∏‚ÜêŒ∏+Œ±‚àáŒ∏logœÄŒ∏(at‚à£st)(Rt‚àíVw(st))Œ∏‚ÜêŒ∏+Œ±‚àáŒ∏log‚Å°œÄŒ∏(at‚à£st)(Rt‚àíVw(st))\n\nw‚Üêw‚àíŒ≤‚àáw(Rt‚àíVw(st))2w‚Üêw‚àíŒ≤‚àáw(Rt‚àíVw(st))2\n\n*   This asynchronous setup increases data throughput and decorrelates experience, enabling training without replay buffers.\n*   A3C achieved state-of-the-art performance on a variety of Atari and continuous control benchmarks.\n\n#### Advantage Actor‚ÄìCritic (A2C)\n\n*   The **A2C algorithm** is a **synchronous** variant of A3C that aggregates gradients from multiple parallel environments before performing a single update.\n*   Although less parallelized, A2C offers improved training stability and is widely used in implementations such as OpenAI Baselines.\n    \n*   The advantage function is often estimated using **Generalized Advantage Estimation (GAE)** ([Schulman et al., 2016](https://arxiv.org/abs/1506.02438)), which balances bias and variance for stable learning.\n\nAlthough less parallelized, A2C offers improved training stability and is widely used in implementations such as OpenAI Baselines.\n\n#### Deep Deterministic Policy Gradient (DDPG)\n\n*   For **continuous control** tasks (e.g., robotic movement), discrete action selection is infeasible.\n*   **DDPG**, introduced by [Lillicrap et al. (2015)](https://arxiv.org/abs/1509.02971), extends the actor‚Äìcritic framework to **deterministic policies**:\n\na\\=ŒºŒ∏(s)a\\=ŒºŒ∏(s)\n\n*   The actor is updated using the gradient of the critic‚Äôs Q-value:\n\n‚àáŒ∏J(Œ∏)\\=ùîºs‚àºÓà∞\\[‚àáaQw(s,a)‚à£‚à£‚à£a\\=ŒºŒ∏(s)‚àáŒ∏ŒºŒ∏(s)\\]‚àáŒ∏J(Œ∏)\\=Es‚àºD\\[‚àáaQw(s,a)|a\\=ŒºŒ∏(s)‚àáŒ∏ŒºŒ∏(s)\\]\n\n*   DDPG employs:\n    \n    *   A **replay buffer** for decorrelated training data,\n    *   **Target networks** for stable updates, and\n    *   **Ornstein‚ÄìUhlenbeck noise** for exploration in continuous spaces.\n*   This made DDPG a foundational algorithm for robotic and control applications.\n    \n\nDDPG employs:\n\n*   A **replay buffer** for decorrelated training data,\n*   **Target networks** for stable updates, and\n*   **Ornstein‚ÄìUhlenbeck noise** for exploration in continuous spaces.\n\nThis made DDPG a foundational algorithm for robotic and control applications.\n\n#### Twin Delayed DDPG (TD3)\n\n*   While DDPG is powerful, it suffers from overestimation bias similar to Q-learning.\n*   **TD3**, by [Fujimoto et al. (2018)](https://arxiv.org/abs/1802.09477), mitigates this through three improvements:\n\n1.  **Clipped Double Q-Learning:** Two critics are trained, and the smaller Q-value is used for the target.\n2.  **Target Policy Smoothing:** Adds noise to target actions for robustness.\n3.  **Delayed Policy Updates:** Updates the actor less frequently than the critic for stability.\n\n*   Target computation in TD3 becomes:\n    \n    y\\=r+Œ≥mini\\=1,2Qw‚Ä≤i(s‚Ä≤,ŒºŒ∏‚Ä≤(s‚Ä≤)+œµ)y\\=r+Œ≥mini\\=1,2Qwi‚Ä≤(s‚Ä≤,ŒºŒ∏‚Ä≤(s‚Ä≤)+œµ)\n    \n    y = r + \\\\gamma \\\\min\\_{i=1,2} Q\\_{w\\_i'}(s', \\\\mu\\_{\\\\theta'}(s') + \\\\epsilon)\n    *   where œµ‚àºclip(Óà∫(0,œÉ),‚àíc,c)œµ‚àºclip(N(0,œÉ),‚àíc,c)\\\\epsilon \\\\sim \\\\text{clip}(\\\\mathcal{N}(0, \\\\sigma), -c, c).\n\nTarget computation in TD3 becomes:\n\n*   where œµ‚àºclip(Óà∫(0,œÉ),‚àíc,c)œµ‚àºclip(N(0,œÉ),‚àíc,c)\\\\epsilon \\\\sim \\\\text{clip}(\\\\mathcal{N}(0, \\\\sigma), -c, c).\n\n#### Soft Actor‚ÄìCritic (SAC)\n\n*   The **Soft Actor‚ÄìCritic (SAC)** algorithm, proposed by [Haarnoja et al. (2018)](https://arxiv.org/abs/1801.01290), extends actor‚Äìcritic learning to the **maximum-entropy RL framework**, optimizing not only expected returns but also **policy entropy**:\n\nJ(œÄ)\\=‚àëtùîº(st,at)‚àºœÄ\\[r(st,at)+Œ±Óà¥(œÄ(‚ãÖ‚à£st))\\]J(œÄ)\\=‚àëtE(st,at)‚àºœÄ\\[r(st,at)+Œ±H(œÄ(‚ãÖ‚à£st))\\]\n\n*   This encourages exploration by maximizing randomness in action selection while maintaining performance.\n*   SAC combines off-policy replay buffers with entropy regularization and is one of the most sample-efficient continuous control algorithms available.\n\n#### Comparative Analysis\n\n**Algorithm**\n\n**Policy Type**\n\n**Exploration**\n\n**Stability Mechanism**\n\n**Key Reference**\n\n**A3C**\n\nStochastic\n\nParallel workers\n\nAsynchronous updates\n\n[Mnih et al., 2016](https://arxiv.org/abs/1602.01783)\n\n**A2C**\n\nStochastic\n\nParallel rollout\n\nSynchronous gradient averaging\n\n[Schulman et al., 2016](https://arxiv.org/abs/1506.02438)\n\n**DDPG**\n\nDeterministic\n\nOU noise\n\nTarget networks, replay buffer\n\n[Lillicrap et al., 2015](https://arxiv.org/abs/1509.02971)\n\n**TD3**\n\nDeterministic\n\nPolicy smoothing\n\nDouble critics, delayed updates\n\n[Fujimoto et al., 2018](https://arxiv.org/abs/1802.09477)\n\n**SAC**\n\nStochastic\n\nMaximum entropy\n\nEntropy regularization\n\n[Haarnoja et al., 2018](https://arxiv.org/abs/1801.01290)\n\n**Algorithm**\n\n**Policy Type**\n\n**Exploration**\n\n**Stability Mechanism**\n\n**Key Reference**\n\n**A3C**\n\nStochastic\n\nParallel workers\n\nAsynchronous updates\n\n[Mnih et al., 2016](https://arxiv.org/abs/1602.01783)\n\n**A2C**\n\nStochastic\n\nParallel rollout\n\nSynchronous gradient averaging\n\n[Schulman et al., 2016](https://arxiv.org/abs/1506.02438)\n\n**DDPG**\n\nDeterministic\n\nOU noise\n\nTarget networks, replay buffer\n\n[Lillicrap et al., 2015](https://arxiv.org/abs/1509.02971)\n\n**TD3**\n\nDeterministic\n\nPolicy smoothing\n\nDouble critics, delayed updates\n\n[Fujimoto et al., 2018](https://arxiv.org/abs/1802.09477)\n\n**SAC**\n\nStochastic\n\nMaximum entropy\n\nEntropy regularization\n\n[Haarnoja et al., 2018](https://arxiv.org/abs/1801.01290)\n\n*   Deep Actor‚ÄìCritic methods form the backbone of modern Deep RL systems, bridging discrete and continuous domains while balancing stability, efficiency, and exploration.\n*   They underpin much of the progress in robotics, game-playing, and large-scale simulation-based learning.",
    "order": 18,
    "orderInChapter": 10,
    "difficulty": 4,
    "estimatedMinutes": 5,
    "tags": [
      "algorithmsarchitecture",
      "neural network",
      "reinforcement learning",
      "regularization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 962,
      "contentLength": 129796
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#deep-actor‚Äìcritic-methods",
    "scrapedAt": "2025-12-28T11:47:08.460Z"
  },
  {
    "id": "ai-reinforcement-learning-deep-model-based-methods-19",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Types of Reinforcement Learning",
    "title": "Deep Model-Based Methods",
    "subtitle": "Types of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>Deep Model-Based Reinforcement Learning (MBRL) integrates the predictive structure of classical model-based RL with the representational power of deep neural networks.</li>\n  <li>\n    <p>Rather than learning purely through trial and error, the agent first learns an internal <strong>world model</strong>‚Äîa neural approximation of the environment‚Äôs dynamics and rewards‚Äîand then <strong>plans or trains policies within this learned model</strong>.</p>\n  </li>\n  <li>This approach promises greater <strong>sample efficiency</strong>, <strong>safety</strong>, and <strong>generalization</strong>, since much of the learning occurs through simulated rollouts rather than direct environment interaction.</li>\n</ul>\n<p>Rather than learning purely through trial and error, the agent first learns an internal <strong>world model</strong>‚Äîa neural approximation of the environment‚Äôs dynamics and rewards‚Äîand then <strong>plans or trains policies within this learned model</strong>.</p>\n<h4 id=\"the-model-based-rl-framework\">The Model-Based RL Framework</h4>\n<ul>\n  <li>\n    <p>An MBRL system typically learns three components:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-230-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>P</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2223;</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mspace width=&quot;1em&quot; /><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>R</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mspace width=&quot;1em&quot; /><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>&amp;#x2223;</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3933\" style=\"width: 17.294em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 14.378em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1014.33em, 2.711em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3934\"><span class=\"msubsup\" id=\"MathJax-Span-3935\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.919em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3936\"><span class=\"mrow\" id=\"MathJax-Span-3937\"><span class=\"munderover\" id=\"MathJax-Span-3938\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3939\" style=\"font-family: STIXGeneral-Italic;\">P</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-3940\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3941\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3942\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-3943\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3944\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-3945\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3946\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-3947\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-3948\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3949\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-3950\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3951\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mspace\" id=\"MathJax-Span-3952\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"msubsup\" id=\"MathJax-Span-3953\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.919em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3954\"><span class=\"mrow\" id=\"MathJax-Span-3955\"><span class=\"munderover\" id=\"MathJax-Span-3956\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3957\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-3958\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3959\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3960\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3961\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-3962\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-3963\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-3964\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-3965\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mspace\" id=\"MathJax-Span-3966\" style=\"height: 0em; vertical-align: 0em; width: 1.148em; display: inline-block; overflow: hidden;\"></span><span class=\"msubsup\" id=\"MathJax-Span-3967\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3968\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3969\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3970\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-3971\" style=\"font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-3972\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-3973\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-3974\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>P</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>‚à£</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>,</mo><mspace width=\"1em\"></mspace><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>R</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>,</mo><mspace width=\"1em\"></mspace><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>a</mi><mo>‚à£</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-230\">\\hat{P}_\\phi(s' \\mid s,a), \\quad\n\\hat{R}_\\phi(s,a), \\quad\n\\pi_\\theta(a \\mid s)</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-231-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>P</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3975\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3976\"><span class=\"msubsup\" id=\"MathJax-Span-3977\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.919em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3978\"><span class=\"mrow\" id=\"MathJax-Span-3979\"><span class=\"munderover\" id=\"MathJax-Span-3980\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3981\" style=\"font-family: STIXGeneral-Italic;\">P</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-3982\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3983\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>P</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>œï</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-231\">\\hat{P}_\\phi</script> is a learned transition model, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-232-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>R</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3984\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3985\"><span class=\"msubsup\" id=\"MathJax-Span-3986\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.919em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3987\"><span class=\"mrow\" id=\"MathJax-Span-3988\"><span class=\"munderover\" id=\"MathJax-Span-3989\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3990\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-3991\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3992\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>R</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>œï</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-232\">\\hat{R}_\\phi</script> is a reward predictor, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-233-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3993\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3994\"><span class=\"msubsup\" id=\"MathJax-Span-3995\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3996\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3997\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-233\">\\pi_\\theta</script> is the policy.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The model can be <strong>explicit</strong> (predicting next states) or <strong>latent</strong> (predicting compact internal representations).</p>\n  </li>\n  <li>\n    <p>Training alternates between:</p>\n\n    <ol>\n      <li>Collecting real experience using the current policy,</li>\n      <li>Updating the learned model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-234-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>P</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>&amp;#x03D5;</mi></msub><mo>,</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>R</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3998\" style=\"width: 4.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.44em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1003.39em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3999\"><span class=\"mo\" id=\"MathJax-Span-4000\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4001\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.919em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4002\"><span class=\"mrow\" id=\"MathJax-Span-4003\"><span class=\"munderover\" id=\"MathJax-Span-4004\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4005\" style=\"font-family: STIXGeneral-Italic;\">P</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-4006\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-4007\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4008\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4009\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.919em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4010\"><span class=\"mrow\" id=\"MathJax-Span-4011\"><span class=\"munderover\" id=\"MathJax-Span-4012\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4013\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-4014\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-4015\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4016\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>P</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>œï</mi></msub><mo>,</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>R</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>œï</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-234\">(\\hat{P}_\\phi, \\hat{R}_\\phi)</script>, and</li>\n      <li>Improving <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-235-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4017\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4018\"><span class=\"msubsup\" id=\"MathJax-Span-4019\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4020\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4021\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-235\">\\pi_\\theta</script> via rollouts simulated inside the model.</li>\n    </ol>\n  </li>\n  <li>\n    <p>This inner simulation loop enables learning with fewer real interactions‚Äîa major advantage over model-free Deep RL.</p>\n  </li>\n</ul>\n<p>An MBRL system typically learns three components:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-231-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>P</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3975\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3976\"><span class=\"msubsup\" id=\"MathJax-Span-3977\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.919em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3978\"><span class=\"mrow\" id=\"MathJax-Span-3979\"><span class=\"munderover\" id=\"MathJax-Span-3980\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3981\" style=\"font-family: STIXGeneral-Italic;\">P</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-3982\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3983\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>P</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>œï</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-231\">\\hat{P}_\\phi</script> is a learned transition model, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-232-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>R</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3984\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3985\"><span class=\"msubsup\" id=\"MathJax-Span-3986\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.919em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-3987\"><span class=\"mrow\" id=\"MathJax-Span-3988\"><span class=\"munderover\" id=\"MathJax-Span-3989\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3990\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-3991\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-3992\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>R</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>œï</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-232\">\\hat{R}_\\phi</script> is a reward predictor, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-233-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3993\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3994\"><span class=\"msubsup\" id=\"MathJax-Span-3995\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3996\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-3997\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-233\">\\pi_\\theta</script> is the policy.</li>\n    </ul>\n<p>The model can be <strong>explicit</strong> (predicting next states) or <strong>latent</strong> (predicting compact internal representations).</p>\n<p>Training alternates between:</p>\n<ol>\n      <li>Collecting real experience using the current policy,</li>\n      <li>Updating the learned model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-234-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>P</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>&amp;#x03D5;</mi></msub><mo>,</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>R</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3998\" style=\"width: 4.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.44em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1003.39em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3999\"><span class=\"mo\" id=\"MathJax-Span-4000\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4001\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.919em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4002\"><span class=\"mrow\" id=\"MathJax-Span-4003\"><span class=\"munderover\" id=\"MathJax-Span-4004\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4005\" style=\"font-family: STIXGeneral-Italic;\">P</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-4006\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-4007\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4008\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4009\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.919em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4010\"><span class=\"mrow\" id=\"MathJax-Span-4011\"><span class=\"munderover\" id=\"MathJax-Span-4012\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4013\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-4014\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-4015\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4016\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>P</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>œï</mi></msub><mo>,</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>R</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>œï</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-234\">(\\hat{P}_\\phi, \\hat{R}_\\phi)</script>, and</li>\n      <li>Improving <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-235-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4017\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4018\"><span class=\"msubsup\" id=\"MathJax-Span-4019\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4020\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4021\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-235\">\\pi_\\theta</script> via rollouts simulated inside the model.</li>\n    </ol>\n<p>This inner simulation loop enables learning with fewer real interactions‚Äîa major advantage over model-free Deep RL.</p>\n<h4 id=\"world-models\">World Models</h4>\n<ul>\n  <li><strong>World Models</strong>, introduced by <a href=\"https://arxiv.org/abs/1803.10122\">Ha &amp; Schmidhuber (2018)</a>, pioneered neural latent-world modeling for RL.</li>\n  <li>\n    <p>Their framework decomposed the agent into:</p>\n\n    <ul>\n      <li><strong>VAE</strong>: encodes high-dimensional observations into a latent space,</li>\n      <li><strong>MDN-RNN</strong>: predicts latent transitions over time, and</li>\n      <li><strong>Controller</strong>: a small policy trained entirely in the latent world.</li>\n    </ul>\n  </li>\n  <li>This demonstrated that an agent could learn a compact generative model of the environment and achieve competitive control using simulated experience alone.</li>\n</ul>\n<p>Their framework decomposed the agent into:</p>\n<ul>\n      <li><strong>VAE</strong>: encodes high-dimensional observations into a latent space,</li>\n      <li><strong>MDN-RNN</strong>: predicts latent transitions over time, and</li>\n      <li><strong>Controller</strong>: a small policy trained entirely in the latent world.</li>\n    </ul>\n<h4 id=\"model-based-policy-optimization-mbpo\">Model-Based Policy Optimization (MBPO)</h4>\n<ul>\n  <li><strong>MBPO</strong>, by <a href=\"https://arxiv.org/abs/1906.08253\">Janner et al. (2019)</a>, refined model-based learning by coupling short model rollouts with off-policy policy optimization.</li>\n  <li>\n    <p>Instead of long, error-prone simulated trajectories, MBPO performs brief rollouts from real states sampled from the replay buffer.</p>\n  </li>\n  <li>\n    <p>Formally, it optimizes:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-236-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>r</mi><mo>,</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x223C;</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>D</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>real</mtext></mrow></msub><mo>&amp;#x222A;</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>D</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>model</mtext></mrow></msub></mrow></msub><mrow><mo>[</mo><mrow><mi>r</mi><mo>+</mo><mi>&amp;#x03B3;</mi><msub><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4022\" style=\"width: 19.065em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 15.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.878em, 1015.73em, 3.44em, -999.997em); top: -2.914em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4023\"><span class=\"mi\" id=\"MathJax-Span-4024\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4025\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4026\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4027\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4028\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-4029\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 7.294em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4030\"><span class=\"mrow\" id=\"MathJax-Span-4031\"><span class=\"mi\" id=\"MathJax-Span-4032\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-4033\"><span class=\"mrow\" id=\"MathJax-Span-4034\"><span class=\"mo\" id=\"MathJax-Span-4035\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4036\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-4037\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4038\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-4039\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4040\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4041\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-4042\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4043\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.216em; left: 0.263em;\"><span class=\"mo\" id=\"MathJax-Span-4044\" style=\"font-size: 50%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4045\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4046\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"msubsup\" id=\"MathJax-Span-4047\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4048\"><span class=\"mrow\" id=\"MathJax-Span-4049\"><span class=\"mi\" id=\"MathJax-Span-4050\" style=\"font-size: 70.7%; font-family: STIXNonUnicode-Italic;\">Óà∞</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4051\"><span class=\"mrow\" id=\"MathJax-Span-4052\"><span class=\"mtext\" id=\"MathJax-Span-4053\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">real</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4054\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à™</span><span class=\"msubsup\" id=\"MathJax-Span-4055\"><span style=\"display: inline-block; position: relative; width: 1.878em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4056\"><span class=\"mrow\" id=\"MathJax-Span-4057\"><span class=\"mi\" id=\"MathJax-Span-4058\" style=\"font-size: 70.7%; font-family: STIXNonUnicode-Italic;\">Óà∞</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4059\"><span class=\"mrow\" id=\"MathJax-Span-4060\"><span class=\"mtext\" id=\"MathJax-Span-4061\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">model</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-4062\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-4063\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-4064\"><span class=\"mi\" id=\"MathJax-Span-4065\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4066\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-4067\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-4068\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4069\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-4070\"><span class=\"mrow\" id=\"MathJax-Span-4071\"><span class=\"msubsup\" id=\"MathJax-Span-4072\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4073\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4074\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4075\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-4076\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4077\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-4078\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4079\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-4080\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.919em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>J</mi><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>r</mi><mo>,</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo><mo>‚àº</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">D</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mtext>real</mtext></mrow></msub><mo>‚à™</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">D</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mtext>model</mtext></mrow></msub></mrow></msub><mrow><mo>[</mo><mrow><mi>r</mi><mo>+</mo><mi>Œ≥</mi><msub><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></mrow></msub><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-236\">J(\\theta) =\n\\mathbb{E}_{(s,a,r,s')\\sim\\mathcal{D}_{\\text{real}} \\cup \\mathcal{D}_{\\text{model}}}\n\\left[\nr + \\gamma V_{\\pi_\\theta}(s')\n\\right]</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-237-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>D</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>model</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4081\" style=\"width: 3.232em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1002.66em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4082\"><span class=\"msubsup\" id=\"MathJax-Span-4083\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.78em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4084\"><span class=\"mrow\" id=\"MathJax-Span-4085\"><span class=\"mi\" id=\"MathJax-Span-4086\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∞</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-4087\"><span class=\"mrow\" id=\"MathJax-Span-4088\"><span class=\"mtext\" id=\"MathJax-Span-4089\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">model</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">D</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mtext>model</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-237\">\\mathcal{D}_{\\text{model}}</script> contains transitions generated by the learned dynamics <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-238-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>P</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03D5;</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4090\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4091\"><span class=\"msubsup\" id=\"MathJax-Span-4092\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.919em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4093\"><span class=\"mrow\" id=\"MathJax-Span-4094\"><span class=\"munderover\" id=\"MathJax-Span-4095\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4096\" style=\"font-family: STIXGeneral-Italic;\">P</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-4097\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-4098\"><span class=\"mrow\" id=\"MathJax-Span-4099\"><span class=\"mi\" id=\"MathJax-Span-4100\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>P</mi><mo stretchy=\"false\">^</mo></mover></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>œï</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-238\">\\hat{P}_{\\phi}</script>.</li>\n    </ul>\n  </li>\n  <li>This hybrid dataset balances realism and data efficiency, producing state-of-the-art sample efficiency among model-based algorithms.</li>\n</ul>\n<p>Instead of long, error-prone simulated trajectories, MBPO performs brief rollouts from real states sampled from the replay buffer.</p>\n<p>Formally, it optimizes:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-237-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>D</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>model</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4081\" style=\"width: 3.232em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1002.66em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4082\"><span class=\"msubsup\" id=\"MathJax-Span-4083\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.78em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4084\"><span class=\"mrow\" id=\"MathJax-Span-4085\"><span class=\"mi\" id=\"MathJax-Span-4086\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∞</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-4087\"><span class=\"mrow\" id=\"MathJax-Span-4088\"><span class=\"mtext\" id=\"MathJax-Span-4089\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">model</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">D</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mtext>model</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-237\">\\mathcal{D}_{\\text{model}}</script> contains transitions generated by the learned dynamics <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-238-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>P</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03D5;</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4090\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4091\"><span class=\"msubsup\" id=\"MathJax-Span-4092\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.919em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4093\"><span class=\"mrow\" id=\"MathJax-Span-4094\"><span class=\"munderover\" id=\"MathJax-Span-4095\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4096\" style=\"font-family: STIXGeneral-Italic;\">P</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-4097\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-4098\"><span class=\"mrow\" id=\"MathJax-Span-4099\"><span class=\"mi\" id=\"MathJax-Span-4100\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>P</mi><mo stretchy=\"false\">^</mo></mover></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>œï</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-238\">\\hat{P}_{\\phi}</script>.</li>\n    </ul>\n<h4 id=\"dreamer-and-latent-dynamics-models\">Dreamer and Latent Dynamics Models</h4>\n<ul>\n  <li>The <strong>Dreamer</strong> family of algorithms, beginning with <a href=\"https://arxiv.org/abs/1912.01603\">Hafner et al. (2019)</a>, introduced <strong>latent imagination-based planning</strong>.</li>\n  <li>\n    <p>Dreamer learns a <strong>Recurrent State-Space Model (RSSM)</strong> to represent dynamics in a compact latent space, enabling policy updates entirely through ‚Äúdreamed‚Äù trajectories without interacting with the environment.</p>\n  </li>\n  <li>Subsequent versions (Dreamer V2 and V3) improved scalability to visual and continuous-control tasks, achieving human-level or super-human performance on benchmarks such as Atari and DMControl.</li>\n</ul>\n<p>Dreamer learns a <strong>Recurrent State-Space Model (RSSM)</strong> to represent dynamics in a compact latent space, enabling policy updates entirely through ‚Äúdreamed‚Äù trajectories without interacting with the environment.</p>\n<h4 id=\"muzero\">MuZero</h4>\n<ul>\n  <li><strong>MuZero</strong>, introduced by <a href=\"https://www.nature.com/articles/s41586-020-03051-4\">Schrittwieser et al. (2020)</a>, combined deep model-based learning with <strong>Monte Carlo Tree Search (MCTS)</strong> while discarding explicit environment modeling.</li>\n  <li>\n    <p>Instead of predicting next observations, MuZero learns <strong>latent dynamics</strong> sufficient for accurate planning in the representation space.</p>\n  </li>\n  <li>\n    <p>Its core components are:</p>\n\n    <ul>\n      <li>A <strong>representation network</strong> (h_\\theta) mapping observations to latent states,</li>\n      <li>A <strong>dynamics network</strong> (g_\\theta) predicting next latent states and rewards, and</li>\n      <li>A <strong>prediction network</strong> (f_\\theta) estimating policy and value from latent states.</li>\n    </ul>\n  </li>\n  <li>\n    <p>These networks are trained jointly to minimize:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-239-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>L</mi><mo>=</mo><munder><mo>&amp;#x2211;</mo><mi>t</mi></munder><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><msubsup><mi>l</mi><mi>t</mi><mi>r</mi></msubsup><mo>+</mo><msubsup><mi>l</mi><mi>t</mi><mi>v</mi></msubsup><mo>+</mo><msubsup><mi>l</mi><mi>t</mi><mi>p</mi></msubsup><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>c</mi><mo>&amp;#x2223;&amp;#x2223;</mo><mi>&amp;#x03B8;</mi><mo>&amp;#x2223;</mo><msup><mo>&amp;#x2223;</mo><mn>2</mn></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4101\" style=\"width: 16.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 14.013em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.034em, 1013.8em, 4.586em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4102\"><span class=\"mi\" id=\"MathJax-Span-4103\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4104\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-4105\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4106\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.21em, 4.273em, -999.997em); top: -2.862em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4107\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-4108\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-4109\"><span class=\"mo\" id=\"MathJax-Span-4110\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4111\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4112\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4113\" style=\"font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.372em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-4114\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-4115\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4116\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"msubsup\" id=\"MathJax-Span-4117\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4118\" style=\"font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.372em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-4119\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">v</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-4120\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4121\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"msubsup\" id=\"MathJax-Span-4122\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4123\" style=\"font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.42em, 4.326em, -999.997em); top: -4.477em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-4124\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-4125\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4126\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4127\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-4128\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">c</span><span class=\"mo\" id=\"MathJax-Span-4129\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£<span style=\"font-family: STIXGeneral-Regular; font-style: normal; font-weight: normal;\">‚à£</span></span><span class=\"mi\" id=\"MathJax-Span-4130\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4131\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-4132\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.16em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4133\" style=\"font-family: STIXGeneral-Regular;\">‚à£</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.263em;\"><span class=\"mn\" id=\"MathJax-Span-4134\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-4135\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-4136\"><span class=\"mo\" id=\"MathJax-Span-4137\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 2.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>L</mi><mo>=</mo><munder><mo>‚àë</mo><mi>t</mi></munder><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">[</mo></mrow><mo stretchy=\"false\">(</mo><msubsup><mi>l</mi><mi>t</mi><mi>r</mi></msubsup><mo>+</mo><msubsup><mi>l</mi><mi>t</mi><mi>v</mi></msubsup><mo>+</mo><msubsup><mi>l</mi><mi>t</mi><mi>p</mi></msubsup><mo stretchy=\"false\">)</mo><mo>+</mo><mi>c</mi><mo>‚à£‚à£</mo><mi>Œ∏</mi><mo>‚à£</mo><msup><mo>‚à£</mo><mn>2</mn></msup><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-239\">L = \\sum_t\n\\big[\n(l^r_t + l^v_t + l^p_t)\n+ c \\mid  \\mid \\theta \\mid  \\mid ^2\n\\big]</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-240-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>l</mi><mi>t</mi><mi>r</mi></msubsup><mo>,</mo><msubsup><mi>l</mi><mi>t</mi><mi>v</mi></msubsup><mo>,</mo><msubsup><mi>l</mi><mi>t</mi><mi>p</mi></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4138\" style=\"width: 3.753em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1003.13em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4139\"><span class=\"msubsup\" id=\"MathJax-Span-4140\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4141\" style=\"font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.372em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-4142\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-4143\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4144\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4145\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4146\" style=\"font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.372em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-4147\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">v</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-4148\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4149\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4150\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4151\" style=\"font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.42em, 4.326em, -999.997em); top: -4.477em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-4152\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-4153\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>l</mi><mi>t</mi><mi>r</mi></msubsup><mo>,</mo><msubsup><mi>l</mi><mi>t</mi><mi>v</mi></msubsup><mo>,</mo><msubsup><mi>l</mi><mi>t</mi><mi>p</mi></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-240\">l^r_t, l^v_t, l^p_t</script> denote reward, value, and policy losses, respectively.</li>\n    </ul>\n  </li>\n  <li>MuZero achieved state-of-the-art results on Atari, Go, chess, and shogi‚Äîmatching or surpassing AlphaZero‚Äôs performance without direct access to the environment‚Äôs rules.</li>\n</ul>\n<p>Instead of predicting next observations, MuZero learns <strong>latent dynamics</strong> sufficient for accurate planning in the representation space.</p>\n<p>Its core components are:</p>\n<ul>\n      <li>A <strong>representation network</strong> (h_\\theta) mapping observations to latent states,</li>\n      <li>A <strong>dynamics network</strong> (g_\\theta) predicting next latent states and rewards, and</li>\n      <li>A <strong>prediction network</strong> (f_\\theta) estimating policy and value from latent states.</li>\n    </ul>\n<p>These networks are trained jointly to minimize:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-240-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup><mi>l</mi><mi>t</mi><mi>r</mi></msubsup><mo>,</mo><msubsup><mi>l</mi><mi>t</mi><mi>v</mi></msubsup><mo>,</mo><msubsup><mi>l</mi><mi>t</mi><mi>p</mi></msubsup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4138\" style=\"width: 3.753em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.253em, 1003.13em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4139\"><span class=\"msubsup\" id=\"MathJax-Span-4140\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4141\" style=\"font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.372em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-4142\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-4143\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4144\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4145\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4146\" style=\"font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.372em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-4147\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">v</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-4148\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4149\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-4150\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4151\" style=\"font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.42em, 4.326em, -999.997em); top: -4.477em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-4152\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -3.799em; left: 0.263em;\"><span class=\"mi\" id=\"MathJax-Span-4153\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msubsup><mi>l</mi><mi>t</mi><mi>r</mi></msubsup><mo>,</mo><msubsup><mi>l</mi><mi>t</mi><mi>v</mi></msubsup><mo>,</mo><msubsup><mi>l</mi><mi>t</mi><mi>p</mi></msubsup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-240\">l^r_t, l^v_t, l^p_t</script> denote reward, value, and policy losses, respectively.</li>\n    </ul>\n<h4 id=\"advantages-and-challenges\">Advantages and Challenges</h4>\n<ul>\n  <li>\n    <p><strong>Advantages</strong>:</p>\n\n    <ul>\n      <li>High <strong>sample efficiency</strong> by leveraging learned models for synthetic experience.</li>\n      <li>Enhanced <strong>planning ability</strong> and <strong>interpretability</strong> via internal simulation.</li>\n      <li>Feasibility in <strong>real-world robotics</strong> and resource-constrained settings.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Challenges</strong>:</p>\n\n    <ul>\n      <li><strong>Model bias</strong>‚Äîcompounding errors in long rollouts can degrade policy quality.</li>\n      <li><strong>Training instability</strong> due to non-stationary data and shared model‚Äìpolicy optimization.</li>\n      <li>High <strong>computational cost</strong> for large-scale latent dynamics models.</li>\n    </ul>\n  </li>\n</ul>\n<p><strong>Advantages</strong>:</p>\n<ul>\n      <li>High <strong>sample efficiency</strong> by leveraging learned models for synthetic experience.</li>\n      <li>Enhanced <strong>planning ability</strong> and <strong>interpretability</strong> via internal simulation.</li>\n      <li>Feasibility in <strong>real-world robotics</strong> and resource-constrained settings.</li>\n    </ul>\n<p><strong>Challenges</strong>:</p>\n<ul>\n      <li><strong>Model bias</strong>‚Äîcompounding errors in long rollouts can degrade policy quality.</li>\n      <li><strong>Training instability</strong> due to non-stationary data and shared model‚Äìpolicy optimization.</li>\n      <li>High <strong>computational cost</strong> for large-scale latent dynamics models.</li>\n    </ul>\n<h4 id=\"comparative-analysis-8\">Comparative Analysis</h4>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Algorithm</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Key Idea</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Learning Paradigm</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Reference</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>World Models</strong></td>\n<td class=\"tg-tleft-valign-first\">Latent-space world modeling</td>\n<td class=\"tg-tleft-valign-first\">Unsupervised generative world</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1803.10122\">Ha &amp; Schmidhuber (2018)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>MBPO</strong></td>\n<td class=\"tg-tleft-valign-first\">Short-horizon model rollouts + off-policy learning</td>\n<td class=\"tg-tleft-valign-first\">Hybrid real + simulated data</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1906.08253\">Janner et al. (2019)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Dreamer</strong></td>\n<td class=\"tg-tleft-valign-first\">Latent imagination-based planning</td>\n<td class=\"tg-tleft-valign-first\">Recurrent state-space model</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1912.01603\">Hafner et al. (2019)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>MuZero</strong></td>\n<td class=\"tg-tleft-valign-first\">Latent dynamics for tree-search planning</td>\n<td class=\"tg-tleft-valign-first\">Model-based with implicit rules</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://www.nature.com/articles/s41586-020-03051-4\">Schrittwieser et al. (2020)</a></td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Algorithm</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Key Idea</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Learning Paradigm</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Reference</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>World Models</strong></td>\n<td class=\"tg-tleft-valign-first\">Latent-space world modeling</td>\n<td class=\"tg-tleft-valign-first\">Unsupervised generative world</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1803.10122\">Ha &amp; Schmidhuber (2018)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>MBPO</strong></td>\n<td class=\"tg-tleft-valign-first\">Short-horizon model rollouts + off-policy learning</td>\n<td class=\"tg-tleft-valign-first\">Hybrid real + simulated data</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1906.08253\">Janner et al. (2019)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Dreamer</strong></td>\n<td class=\"tg-tleft-valign-first\">Latent imagination-based planning</td>\n<td class=\"tg-tleft-valign-first\">Recurrent state-space model</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1912.01603\">Hafner et al. (2019)</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>MuZero</strong></td>\n<td class=\"tg-tleft-valign-first\">Latent dynamics for tree-search planning</td>\n<td class=\"tg-tleft-valign-first\">Model-based with implicit rules</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://www.nature.com/articles/s41586-020-03051-4\">Schrittwieser et al. (2020)</a></td>\n</tr>\n</tbody>\n</table>\n<ul>\n  <li>Deep model-based methods close the loop between <strong>perception</strong>, <strong>prediction</strong>, and <strong>planning</strong>, combining the analytical rigor of model-based control with the generalization power of deep networks.</li>\n  <li>They represent a key direction toward more <strong>data-efficient</strong>, <strong>interpretable</strong>, and <strong>human-like</strong> decision-making systems.</li>\n</ul>",
    "contentMarkdown": "*   Deep Model-Based Reinforcement Learning (MBRL) integrates the predictive structure of classical model-based RL with the representational power of deep neural networks.\n*   Rather than learning purely through trial and error, the agent first learns an internal **world model**‚Äîa neural approximation of the environment‚Äôs dynamics and rewards‚Äîand then **plans or trains policies within this learned model**.\n    \n*   This approach promises greater **sample efficiency**, **safety**, and **generalization**, since much of the learning occurs through simulated rollouts rather than direct environment interaction.\n\nRather than learning purely through trial and error, the agent first learns an internal **world model**‚Äîa neural approximation of the environment‚Äôs dynamics and rewards‚Äîand then **plans or trains policies within this learned model**.\n\n#### The Model-Based RL Framework\n\n*   An MBRL system typically learns three components:\n    \n    PÃÇ¬†œï(s‚Ä≤‚à£s,a),RÃÇ¬†œï(s,a),œÄŒ∏(a‚à£s)P^œï(s‚Ä≤‚à£s,a),R^œï(s,a),œÄŒ∏(a‚à£s)\n    \n    \\\\hat{P}\\_\\\\phi(s' \\\\mid s,a), \\\\quad \\\\hat{R}\\_\\\\phi(s,a), \\\\quad \\\\pi\\_\\\\theta(a \\\\mid s)\n    *   where PÃÇ¬†œïP^œï\\\\hat{P}\\_\\\\phi is a learned transition model, RÃÇ¬†œïR^œï\\\\hat{R}\\_\\\\phi is a reward predictor, and œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta is the policy.\n*   The model can be **explicit** (predicting next states) or **latent** (predicting compact internal representations).\n    \n*   Training alternates between:\n    \n    1.  Collecting real experience using the current policy,\n    2.  Updating the learned model (PÃÇ¬†œï,RÃÇ¬†œï)(P^œï,R^œï)(\\\\hat{P}\\_\\\\phi, \\\\hat{R}\\_\\\\phi), and\n    3.  Improving œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta via rollouts simulated inside the model.\n*   This inner simulation loop enables learning with fewer real interactions‚Äîa major advantage over model-free Deep RL.\n    \n\nAn MBRL system typically learns three components:\n\n*   where PÃÇ¬†œïP^œï\\\\hat{P}\\_\\\\phi is a learned transition model, RÃÇ¬†œïR^œï\\\\hat{R}\\_\\\\phi is a reward predictor, and œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta is the policy.\n\nThe model can be **explicit** (predicting next states) or **latent** (predicting compact internal representations).\n\nTraining alternates between:\n\n1.  Collecting real experience using the current policy,\n2.  Updating the learned model (PÃÇ¬†œï,RÃÇ¬†œï)(P^œï,R^œï)(\\\\hat{P}\\_\\\\phi, \\\\hat{R}\\_\\\\phi), and\n3.  Improving œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta via rollouts simulated inside the model.\n\nThis inner simulation loop enables learning with fewer real interactions‚Äîa major advantage over model-free Deep RL.\n\n#### World Models\n\n*   **World Models**, introduced by [Ha & Schmidhuber (2018)](https://arxiv.org/abs/1803.10122), pioneered neural latent-world modeling for RL.\n*   Their framework decomposed the agent into:\n    \n    *   **VAE**: encodes high-dimensional observations into a latent space,\n    *   **MDN-RNN**: predicts latent transitions over time, and\n    *   **Controller**: a small policy trained entirely in the latent world.\n*   This demonstrated that an agent could learn a compact generative model of the environment and achieve competitive control using simulated experience alone.\n\nTheir framework decomposed the agent into:\n\n*   **VAE**: encodes high-dimensional observations into a latent space,\n*   **MDN-RNN**: predicts latent transitions over time, and\n*   **Controller**: a small policy trained entirely in the latent world.\n\n#### Model-Based Policy Optimization (MBPO)\n\n*   **MBPO**, by [Janner et al. (2019)](https://arxiv.org/abs/1906.08253), refined model-based learning by coupling short model rollouts with off-policy policy optimization.\n*   Instead of long, error-prone simulated trajectories, MBPO performs brief rollouts from real states sampled from the replay buffer.\n    \n*   Formally, it optimizes:\n    \n    J(Œ∏)\\=ùîº(s,a,r,s‚Ä≤)‚àºÓà∞real‚à™Óà∞model\\[r+Œ≥VœÄŒ∏(s‚Ä≤)\\]J(Œ∏)\\=E(s,a,r,s‚Ä≤)‚àºDreal‚à™Dmodel\\[r+Œ≥VœÄŒ∏(s‚Ä≤)\\]\n    \n    J(\\\\theta) = \\\\mathbb{E}\\_{(s,a,r,s')\\\\sim\\\\mathcal{D}\\_{\\\\text{real}} \\\\cup \\\\mathcal{D}\\_{\\\\text{model}}} \\\\left\\[ r + \\\\gamma V\\_{\\\\pi\\_\\\\theta}(s') \\\\right\\]\n    *   where Óà∞modelDmodel\\\\mathcal{D}\\_{\\\\text{model}} contains transitions generated by the learned dynamics PÃÇ¬†œïP^œï\\\\hat{P}\\_{\\\\phi}.\n*   This hybrid dataset balances realism and data efficiency, producing state-of-the-art sample efficiency among model-based algorithms.\n\nInstead of long, error-prone simulated trajectories, MBPO performs brief rollouts from real states sampled from the replay buffer.\n\nFormally, it optimizes:\n\n*   where Óà∞modelDmodel\\\\mathcal{D}\\_{\\\\text{model}} contains transitions generated by the learned dynamics PÃÇ¬†œïP^œï\\\\hat{P}\\_{\\\\phi}.\n\n#### Dreamer and Latent Dynamics Models\n\n*   The **Dreamer** family of algorithms, beginning with [Hafner et al. (2019)](https://arxiv.org/abs/1912.01603), introduced **latent imagination-based planning**.\n*   Dreamer learns a **Recurrent State-Space Model (RSSM)** to represent dynamics in a compact latent space, enabling policy updates entirely through ‚Äúdreamed‚Äù trajectories without interacting with the environment.\n    \n*   Subsequent versions (Dreamer V2 and V3) improved scalability to visual and continuous-control tasks, achieving human-level or super-human performance on benchmarks such as Atari and DMControl.\n\nDreamer learns a **Recurrent State-Space Model (RSSM)** to represent dynamics in a compact latent space, enabling policy updates entirely through ‚Äúdreamed‚Äù trajectories without interacting with the environment.\n\n#### MuZero\n\n*   **MuZero**, introduced by [Schrittwieser et al. (2020)](https://www.nature.com/articles/s41586-020-03051-4), combined deep model-based learning with **Monte Carlo Tree Search (MCTS)** while discarding explicit environment modeling.\n*   Instead of predicting next observations, MuZero learns **latent dynamics** sufficient for accurate planning in the representation space.\n    \n*   Its core components are:\n    \n    *   A **representation network** (h\\_\\\\theta) mapping observations to latent states,\n    *   A **dynamics network** (g\\_\\\\theta) predicting next latent states and rewards, and\n    *   A **prediction network** (f\\_\\\\theta) estimating policy and value from latent states.\n*   These networks are trained jointly to minimize:\n    \n    L\\=‚àët\\[(lrt+lvt+lpt)+c‚à£‚à£Œ∏‚à£‚à£2\\]L\\=‚àët\\[(ltr+ltv+ltp)+c‚à£‚à£Œ∏‚à£‚à£2\\]\n    \n    L = \\\\sum\\_t \\\\big\\[ (l^r\\_t + l^v\\_t + l^p\\_t) + c \\\\mid \\\\mid \\\\theta \\\\mid \\\\mid ^2 \\\\big\\]\n    *   where lrt,lvt,lptltr,ltv,ltpl^r\\_t, l^v\\_t, l^p\\_t denote reward, value, and policy losses, respectively.\n*   MuZero achieved state-of-the-art results on Atari, Go, chess, and shogi‚Äîmatching or surpassing AlphaZero‚Äôs performance without direct access to the environment‚Äôs rules.\n\nInstead of predicting next observations, MuZero learns **latent dynamics** sufficient for accurate planning in the representation space.\n\nIts core components are:\n\n*   A **representation network** (h\\_\\\\theta) mapping observations to latent states,\n*   A **dynamics network** (g\\_\\\\theta) predicting next latent states and rewards, and\n*   A **prediction network** (f\\_\\\\theta) estimating policy and value from latent states.\n\nThese networks are trained jointly to minimize:\n\n*   where lrt,lvt,lptltr,ltv,ltpl^r\\_t, l^v\\_t, l^p\\_t denote reward, value, and policy losses, respectively.\n\n#### Advantages and Challenges\n\n*   **Advantages**:\n    \n    *   High **sample efficiency** by leveraging learned models for synthetic experience.\n    *   Enhanced **planning ability** and **interpretability** via internal simulation.\n    *   Feasibility in **real-world robotics** and resource-constrained settings.\n*   **Challenges**:\n    \n    *   **Model bias**‚Äîcompounding errors in long rollouts can degrade policy quality.\n    *   **Training instability** due to non-stationary data and shared model‚Äìpolicy optimization.\n    *   High **computational cost** for large-scale latent dynamics models.\n\n**Advantages**:\n\n*   High **sample efficiency** by leveraging learned models for synthetic experience.\n*   Enhanced **planning ability** and **interpretability** via internal simulation.\n*   Feasibility in **real-world robotics** and resource-constrained settings.\n\n**Challenges**:\n\n*   **Model bias**‚Äîcompounding errors in long rollouts can degrade policy quality.\n*   **Training instability** due to non-stationary data and shared model‚Äìpolicy optimization.\n*   High **computational cost** for large-scale latent dynamics models.\n\n#### Comparative Analysis\n\n**Algorithm**\n\n**Key Idea**\n\n**Learning Paradigm**\n\n**Reference**\n\n**World Models**\n\nLatent-space world modeling\n\nUnsupervised generative world\n\n[Ha & Schmidhuber (2018)](https://arxiv.org/abs/1803.10122)\n\n**MBPO**\n\nShort-horizon model rollouts + off-policy learning\n\nHybrid real + simulated data\n\n[Janner et al. (2019)](https://arxiv.org/abs/1906.08253)\n\n**Dreamer**\n\nLatent imagination-based planning\n\nRecurrent state-space model\n\n[Hafner et al. (2019)](https://arxiv.org/abs/1912.01603)\n\n**MuZero**\n\nLatent dynamics for tree-search planning\n\nModel-based with implicit rules\n\n[Schrittwieser et al. (2020)](https://www.nature.com/articles/s41586-020-03051-4)\n\n**Algorithm**\n\n**Key Idea**\n\n**Learning Paradigm**\n\n**Reference**\n\n**World Models**\n\nLatent-space world modeling\n\nUnsupervised generative world\n\n[Ha & Schmidhuber (2018)](https://arxiv.org/abs/1803.10122)\n\n**MBPO**\n\nShort-horizon model rollouts + off-policy learning\n\nHybrid real + simulated data\n\n[Janner et al. (2019)](https://arxiv.org/abs/1906.08253)\n\n**Dreamer**\n\nLatent imagination-based planning\n\nRecurrent state-space model\n\n[Hafner et al. (2019)](https://arxiv.org/abs/1912.01603)\n\n**MuZero**\n\nLatent dynamics for tree-search planning\n\nModel-based with implicit rules\n\n[Schrittwieser et al. (2020)](https://www.nature.com/articles/s41586-020-03051-4)\n\n*   Deep model-based methods close the loop between **perception**, **prediction**, and **planning**, combining the analytical rigor of model-based control with the generalization power of deep networks.\n*   They represent a key direction toward more **data-efficient**, **interpretable**, and **human-like** decision-making systems.",
    "order": 19,
    "orderInChapter": 11,
    "difficulty": 4,
    "estimatedMinutes": 6,
    "tags": [
      "algorithmsarchitecture",
      "neural network",
      "rnn",
      "reinforcement learning",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 1147,
      "contentLength": 97466
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#deep-model-based-methods",
    "scrapedAt": "2025-12-28T11:47:08.460Z"
  },
  {
    "id": "ai-reinforcement-learning-hybrid-and-meta-deep-reinforcement-learning-method-20",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Types of Reinforcement Learning",
    "title": "Hybrid and Meta Deep Reinforcement Learning Methods",
    "subtitle": "Types of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>While the earlier categories of Deep Reinforcement Learning (Deep RL) isolate specific mechanisms‚Äîvalue prediction, policy optimization, or world modeling‚Äîmany recent advances emerge from <strong>hybrid approaches</strong> that combine these paradigms.</li>\n  <li>In parallel, <strong>meta-learning frameworks</strong> extend deep RL to settings where agents must <strong>adapt quickly</strong> to new environments or tasks by leveraging prior experience.</li>\n</ul>\n<h4 id=\"hybrid-reinforcement-learning\">Hybrid Reinforcement Learning</h4>\n<ul>\n  <li>\n    <p>Hybrid RL methods aim to exploit the complementary strengths of different learning paradigms:</p>\n\n    <ul>\n      <li><strong>Value-based components</strong> provide stable, sample-efficient bootstrapping.</li>\n      <li><strong>Policy-based components</strong> enable smooth updates and stochastic exploration.</li>\n      <li><strong>Model-based components</strong> offer foresight through predictive dynamics.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Together, these elements create <strong>multi-objective, multi-stream</strong>, and <strong>off-policy</strong> architectures capable of scaling to massive environments.</p>\n  </li>\n</ul>\n<p>Hybrid RL methods aim to exploit the complementary strengths of different learning paradigms:</p>\n<ul>\n      <li><strong>Value-based components</strong> provide stable, sample-efficient bootstrapping.</li>\n      <li><strong>Policy-based components</strong> enable smooth updates and stochastic exploration.</li>\n      <li><strong>Model-based components</strong> offer foresight through predictive dynamics.</li>\n    </ul>\n<p>Together, these elements create <strong>multi-objective, multi-stream</strong>, and <strong>off-policy</strong> architectures capable of scaling to massive environments.</p>\n<h5 id=\"actor-learner-architectures\">Actor-Learner Architectures)</h5>\n<ul>\n  <li><strong>IMPALA</strong>, introduced by <a href=\"https://arxiv.org/abs/1802.01561\">Espeholt et al. (2018)</a>, scales actor‚Äìcritic learning to distributed settings.</li>\n  <li>\n    <p>It separates <strong>actors</strong>, which generate trajectories in parallel environments, from a central <strong>learner</strong>, which updates shared parameters using an off-policy correction method called <strong>V-trace</strong>.</p>\n  </li>\n  <li>The V-trace targets correct the discrepancy between behavior policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-241-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03BC;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4154\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4155\"><span class=\"mi\" id=\"MathJax-Span-4156\" style=\"font-family: STIXGeneral-Italic;\">Œº</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œº</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-241\">\\mu</script> and target policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-242-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4157\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4158\"><span class=\"mi\" id=\"MathJax-Span-4159\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-242\">\\pi</script>:</li>\n</ul>\n<p>It separates <strong>actors</strong>, which generate trajectories in parallel environments, from a central <strong>learner</strong>, which updates shared parameters using an off-policy correction method called <strong>V-trace</strong>.</p>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-243-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>v</mi><mi>s</mi></msub><mo>=</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>s</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mi>s</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mo>+</mo><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mi>s</mi></mrow></msup><mrow><mo>(</mo><mrow><munderover><mo>&amp;#x220F;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mi>s</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></munderover><msub><mi>c</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><msub><mi>&amp;#x03C1;</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B3;</mi><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4160\" style=\"width: 28.076em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 23.388em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1023.34em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4161\"><span class=\"msubsup\" id=\"MathJax-Span-4162\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4163\" style=\"font-family: STIXGeneral-Italic;\">v</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4164\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4165\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-4166\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4167\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4168\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4169\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4170\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4171\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4172\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"munderover\" id=\"MathJax-Span-4173\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.93em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0.315em;\"><span class=\"mo\" id=\"MathJax-Span-4174\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.492em, 1000.94em, 4.273em, -999.997em); top: -2.862em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4175\"><span class=\"mrow\" id=\"MathJax-Span-4176\"><span class=\"mi\" id=\"MathJax-Span-4177\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4178\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mi\" id=\"MathJax-Span-4179\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1001.88em, 4.273em, -999.997em); top: -5.206em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4180\"><span class=\"mrow\" id=\"MathJax-Span-4181\"><span class=\"mi\" id=\"MathJax-Span-4182\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-4183\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-4184\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-4185\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"mn\" id=\"MathJax-Span-4186\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-4187\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4188\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-4189\"><span class=\"mrow\" id=\"MathJax-Span-4190\"><span class=\"mi\" id=\"MathJax-Span-4191\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4192\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-4193\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-4194\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-4195\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">(</span></span><span class=\"mrow\" id=\"MathJax-Span-4196\"><span class=\"munderover\" id=\"MathJax-Span-4197\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.3em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4198\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àè</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.94em, 4.273em, -999.997em); top: -2.862em; left: 0.211em;\"><span class=\"texatom\" id=\"MathJax-Span-4199\"><span class=\"mrow\" id=\"MathJax-Span-4200\"><span class=\"mi\" id=\"MathJax-Span-4201\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-4202\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mi\" id=\"MathJax-Span-4203\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.99em, 4.273em, -999.997em); top: -5.206em; left: 0.159em;\"><span class=\"texatom\" id=\"MathJax-Span-4204\"><span class=\"mrow\" id=\"MathJax-Span-4205\"><span class=\"mi\" id=\"MathJax-Span-4206\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4207\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"mn\" id=\"MathJax-Span-4208\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-4209\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4210\" style=\"font-family: STIXGeneral-Italic;\">c</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4211\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4212\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">)</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-4213\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4214\" style=\"font-family: STIXGeneral-Italic;\">œÅ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4215\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4216\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4217\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4218\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4219\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4220\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-4221\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-4222\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4223\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4224\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4225\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4226\"><span class=\"mrow\" id=\"MathJax-Span-4227\"><span class=\"mi\" id=\"MathJax-Span-4228\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4229\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-4230\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4231\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4232\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-4233\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4234\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4235\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4236\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4237\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4238\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4239\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>v</mi><mi>s</mi></msub><mo>=</mo><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>s</mi></msub><mo stretchy=\"false\">)</mo><mo>+</mo><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mi>s</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>s</mi><mo>+</mo><mi>n</mi><mo>‚àí</mo><mn>1</mn></mrow></munderover><msup><mi>Œ≥</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>‚àí</mo><mi>s</mi></mrow></msup><mrow><mo>(</mo><mrow><munderover><mo>‚àè</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mi>s</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>‚àí</mo><mn>1</mn></mrow></munderover><msub><mi>c</mi><mi>i</mi></msub></mrow><mo>)</mo></mrow><msub><mi>œÅ</mi><mi>t</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>Œ≥</mi><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></math></span></span></div>\n<ul>\n  <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-244-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C1;</mi><mi>t</mi></msub><mo>=</mo><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>min</mo><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>&amp;#x03C1;</mi><mo stretchy=&quot;false&quot;>&amp;#x00AF;</mo></mover></mrow><mo>,</mo><mfrac><mrow><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi>&amp;#x03BC;</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4240\" style=\"width: 9.221em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.659em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.992em, 1007.61em, 2.867em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4241\"><span class=\"msubsup\" id=\"MathJax-Span-4242\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4243\" style=\"font-family: STIXGeneral-Italic;\">œÅ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4244\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4245\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-4246\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">min</span><span class=\"mo\" id=\"MathJax-Span-4247\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"texatom\" id=\"MathJax-Span-4248\"><span class=\"mrow\" id=\"MathJax-Span-4249\"><span class=\"munderover\" id=\"MathJax-Span-4250\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4251\" style=\"font-family: STIXGeneral-Italic;\">œÅ</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.232em, 1000.32em, 3.596em, -999.997em); top: -4.008em; left: 0.107em;\"><span class=\"mo\" id=\"MathJax-Span-4252\" style=\"font-family: STIXGeneral-Regular;\">¬Ø</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4253\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mfrac\" id=\"MathJax-Span-4254\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1002.09em, 4.326em, -999.997em); top: -4.529em; left: 50%; margin-left: -1.039em;\"><span class=\"mrow\" id=\"MathJax-Span-4255\"><span class=\"mi\" id=\"MathJax-Span-4256\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4257\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4258\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4259\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4260\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4261\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-4262\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4263\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-4264\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4265\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1002.09em, 4.326em, -999.997em); top: -3.591em; left: 50%; margin-left: -1.039em;\"><span class=\"mrow\" id=\"MathJax-Span-4266\"><span class=\"mi\" id=\"MathJax-Span-4267\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œº</span><span class=\"mo\" id=\"MathJax-Span-4268\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4269\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4270\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4271\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4272\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-4273\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4274\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-4275\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4276\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1002.24em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.242em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4277\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.684em; border-left: 0px solid; width: 0px; height: 2.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÅ</mi><mi>t</mi></msub><mo>=</mo><mo movablelimits=\"true\" form=\"prefix\">min</mo><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>œÅ</mi><mo stretchy=\"false\">¬Ø</mo></mover></mrow><mo>,</mo><mfrac><mrow><mi>œÄ</mi><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><mi>Œº</mi><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-244\">\\rho_t = \\min(\\bar{\\rho}, \\frac{\\pi(a_t \\mid x_t)}{\\mu(a_t \\mid x_t)})</script>.</li>\n  <li>IMPALA enabled scalable training across thousands of environments with stable, near-linear performance gains.</li>\n</ul>\n<h5 id=\"distributed-dqn\">Distributed DQN)</h5>\n<ul>\n  <li><strong>R2D2</strong>, proposed by <a href=\"https://openreview.net/forum?id=r1lyTjAqYX\">Kapturowski et al. (2019)</a>, extended DQN to <strong>recurrent networks</strong> for partially observable environments.</li>\n  <li>\n    <p>It combines:</p>\n  </li>\n  <li>A distributed architecture similar to IMPALA,</li>\n  <li>Experience replay for off-policy learning, and</li>\n  <li>\n    <p>Recurrent state-tracking through LSTM layers.</p>\n  </li>\n  <li>This combination of <strong>value learning</strong>, <strong>sequence modeling</strong>, and <strong>distributed execution</strong> yields strong performance in tasks requiring memory, such as DeepMind Lab and Atari with partial observability.</li>\n</ul>\n<p>It combines:</p>\n<p>Recurrent state-tracking through LSTM layers.</p>\n<h5 id=\"model-based-control\">Model-Based Control</h5>\n<ul>\n  <li>\n    <p>Other hybrid frameworks explicitly merge <strong>model-based planning</strong> with <strong>policy learning</strong>, e.g.:</p>\n  </li>\n  <li><strong>PlaNet</strong> by <a href=\"https://arxiv.org/abs/1811.04551\">Hafner et al. (2019)</a>: learns a latent dynamics model for planning continuous-control actions.</li>\n  <li><strong>LEC-based hybrids</strong> (Learning Explicit Controllers): integrate control-theoretic priors into deep actor‚Äìcritic loops, improving sample efficiency and interpretability.</li>\n  <li><strong>MuZero‚Äôs descendants</strong>, such as EfficientZero (<a href=\"https://arxiv.org/abs/2111.00210\">Ye et al., 2021</a>), extend this concept with self-supervised planning.</li>\n</ul>\n<p>Other hybrid frameworks explicitly merge <strong>model-based planning</strong> with <strong>policy learning</strong>, e.g.:</p>\n<h4 id=\"meta-reinforcement-learning-meta-rl\">Meta Reinforcement Learning (Meta-RL)</h4>\n<ul>\n  <li><strong>Meta-RL</strong>, also known as ‚Äúlearning to learn,‚Äù equips an agent to <strong>adapt rapidly to new tasks</strong> after minimal additional experience.</li>\n  <li>Formally, the goal is to learn parameters <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-245-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4278\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4279\"><span class=\"mi\" id=\"MathJax-Span-4280\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ∏</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-245\">\\theta</script> that enable fast adaptation of a policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-246-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>&amp;#x03B8;</mi><mo>&amp;#x2032;</mo></msup></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4281\" style=\"width: 1.461em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.2em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4282\"><span class=\"msubsup\" id=\"MathJax-Span-4283\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4284\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.799em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-4285\"><span class=\"mrow\" id=\"MathJax-Span-4286\"><span class=\"msup\" id=\"MathJax-Span-4287\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4288\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.419em;\"><span class=\"mo\" id=\"MathJax-Span-4289\" style=\"font-size: 50%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><msup><mi>Œ∏</mi><mo>‚Ä≤</mo></msup></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-246\">\\pi_{\\theta'}</script> to new tasks <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-247-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>T</mi><mi>i</mi></msub><mo>&amp;#x223C;</mo><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>T</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4290\" style=\"width: 4.638em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.857em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.8em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4291\"><span class=\"msubsup\" id=\"MathJax-Span-4292\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4293\" style=\"font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"mi\" id=\"MathJax-Span-4294\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4295\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àº</span><span class=\"mi\" id=\"MathJax-Span-4296\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">p</span><span class=\"mo\" id=\"MathJax-Span-4297\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4298\" style=\"font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4299\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>T</mi><mi>i</mi></msub><mo>‚àº</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mi>T</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-247\">T_i \\sim p(T)</script> with only a few gradient steps.</li>\n</ul>\n<h5 id=\"model-agnostic-meta-learning-maml\">Model-Agnostic Meta-Learning (MAML)</h5>\n<ul>\n  <li><strong>MAML</strong> for RL, by <a href=\"https://arxiv.org/abs/1703.03400\">Finn et al. (2017)</a>, learns an initialization that can be fine-tuned efficiently:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-248-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msubsup><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow><mo>&amp;#x2032;</mo></msubsup><mo>=</mo><mi>&amp;#x03B8;</mi><mo>&amp;#x2212;</mo><mi>&amp;#x03B1;</mi><msub><mi mathvariant=&quot;normal&quot;>&amp;#x2207;</mi><mi>&amp;#x03B8;</mi></msub><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>T</mi><mi>i</mi></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4300\" style=\"width: 9.534em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.919em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1007.87em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4301\"><span class=\"msubsup\" id=\"MathJax-Span-4302\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4303\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.32em, 4.169em, -999.997em); top: -4.32em; left: 0.576em;\"><span class=\"mo\" id=\"MathJax-Span-4304\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -3.695em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-4305\"><span class=\"mrow\" id=\"MathJax-Span-4306\"><span class=\"mi\" id=\"MathJax-Span-4307\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4308\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-4309\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4310\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-4311\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ±</span><span class=\"msubsup\" id=\"MathJax-Span-4312\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4313\" style=\"font-family: STIXGeneral-Regular;\">‚àá</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-4314\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-4315\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4316\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4317\"><span class=\"mrow\" id=\"MathJax-Span-4318\"><span class=\"msubsup\" id=\"MathJax-Span-4319\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4320\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-4321\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4322\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4323\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4324\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msubsup><mi>Œ∏</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi></mrow><mo>‚Ä≤</mo></msubsup><mo>=</mo><mi>Œ∏</mi><mo>‚àí</mo><mi>Œ±</mi><msub><mi mathvariant=\"normal\">‚àá</mi><mi>Œ∏</mi></msub><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>T</mi><mi>i</mi></msub></mrow></msub><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo></math></span></span></div>\n<ul>\n  <li>and optimizes across tasks to minimize post-adaptation loss:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-249-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>min</mo><mi>&amp;#x03B8;</mi></munder><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></munder><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>T</mi><mi>i</mi></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msubsup><mi>&amp;#x03B8;</mi><mi>i</mi><mo>&amp;#x2032;</mo></msubsup><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4325\" style=\"width: 7.294em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.044em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1005.99em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4326\"><span class=\"munderover\" id=\"MathJax-Span-4327\"><span style=\"display: inline-block; position: relative; width: 1.565em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1001.57em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4328\" style=\"font-family: STIXGeneral-Regular;\">min</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.273em, -999.997em); top: -3.331em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-4329\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-4330\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4331\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.21em, 4.273em, -999.997em); top: -2.862em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4332\"><span class=\"mrow\" id=\"MathJax-Span-4333\"><span class=\"mi\" id=\"MathJax-Span-4334\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-4335\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4336\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-4337\"><span class=\"mrow\" id=\"MathJax-Span-4338\"><span class=\"msubsup\" id=\"MathJax-Span-4339\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4340\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.419em;\"><span class=\"mi\" id=\"MathJax-Span-4341\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4342\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4343\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4344\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.32em, 4.169em, -999.997em); top: -4.32em; left: 0.576em;\"><span class=\"mo\" id=\"MathJax-Span-4345\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.26em, 4.169em, -999.997em); top: -3.695em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-4346\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4347\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 2.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><munder><mo movablelimits=\"true\" form=\"prefix\">min</mo><mi>Œ∏</mi></munder><munder><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi></mrow></munder><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>T</mi><mi>i</mi></msub></mrow></msub><mo stretchy=\"false\">(</mo><msubsup><mi>Œ∏</mi><mi>i</mi><mo>‚Ä≤</mo></msubsup><mo stretchy=\"false\">)</mo></math></span></span></div>\n<ul>\n  <li>This gradient-through-gradient formulation allows fast policy adaptation to unseen environments.</li>\n</ul>\n<h5 id=\"rl2-and-recurrent-meta-learners\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-250-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><msup><mi>L</mi><mn>2</mn></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4348\" style=\"width: 2.086em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1001.72em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4349\"><span class=\"mi\" id=\"MathJax-Span-4350\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"msubsup\" id=\"MathJax-Span-4351\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4352\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.628em;\"><span class=\"mn\" id=\"MathJax-Span-4353\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><msup><mi>L</mi><mn>2</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-250\">RL^2</script> and Recurrent Meta-Learners</h5>\n<ul>\n  <li><strong><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-251-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><msup><mi>L</mi><mn>2</mn></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4354\" style=\"width: 2.069em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.707em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.191em, 1001.71em, 2.327em, -999.997em); top: -2.167em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4355\"><span class=\"mi\" id=\"MathJax-Span-4356\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"msubsup\" id=\"MathJax-Span-4357\"><span style=\"display: inline-block; position: relative; width: 1.036em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.153em, 1000.57em, 4.135em, -999.997em); top: -3.975em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4358\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.98em;\"></span></span><span style=\"position: absolute; top: -4.336em; left: 0.622em;\"><span class=\"mn\" id=\"MathJax-Span-4359\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 3.98em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.172em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><msup><mi>L</mi><mn>2</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-251\">RL^2</script></strong>, proposed by <a href=\"https://arxiv.org/abs/1611.02779\">Duan et al. (2016)</a>, represents meta-learning as a <strong>recurrent policy</strong> that learns to infer the task structure over time.</li>\n  <li>The agent‚Äôs hidden state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-252-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>h</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4360\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4361\"><span class=\"msubsup\" id=\"MathJax-Span-4362\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4363\" style=\"font-family: STIXGeneral-Italic;\">h</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4364\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>h</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-252\">h_t</script> captures task-specific knowledge from past trajectories, enabling <strong>online adaptation</strong> without explicit gradient updates.</li>\n</ul>\n<h5 id=\"pearl-probabilistic-embedding-for-actorcritic-rl\">PEARL (Probabilistic Embedding for Actor‚ÄìCritic RL)</h5>\n<ul>\n  <li><strong>PEARL</strong>, by <a href=\"https://arxiv.org/abs/1903.08254\">Rakelly et al. (2019)</a>, introduces probabilistic context variables <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-253-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4365\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4366\"><span class=\"mi\" id=\"MathJax-Span-4367\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-253\">z</script> to represent tasks in a latent embedding space.</li>\n  <li>Policies are conditioned on <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-254-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4368\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.451em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4369\"><span class=\"mi\" id=\"MathJax-Span-4370\" style=\"font-family: STIXGeneral-Italic;\">z</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>z</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-254\">z</script>, which is inferred from a small context set of transitions:</li>\n</ul>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-255-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo>&amp;#x2223;</mo><mi>c</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x221D;</mo><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><munder><mo>&amp;#x220F;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>r</mi><mo>,</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2208;</mo><mi>c</mi></mrow></munder><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>r</mi><mo>,</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2223;</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4371\" style=\"width: 18.128em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 15.107em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1015.05em, 3.805em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4372\"><span class=\"mi\" id=\"MathJax-Span-4373\" style=\"font-family: STIXGeneral-Italic;\">p</span><span class=\"mo\" id=\"MathJax-Span-4374\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4375\" style=\"font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-4376\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4377\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">c</span><span class=\"mo\" id=\"MathJax-Span-4378\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4379\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àù</span><span class=\"mi\" id=\"MathJax-Span-4380\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">p</span><span class=\"mo\" id=\"MathJax-Span-4381\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4382\" style=\"font-family: STIXGeneral-Italic;\">z</span><span class=\"mo\" id=\"MathJax-Span-4383\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"munderover\" id=\"MathJax-Span-4384\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 3.232em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.3em, 4.638em, -999.997em); top: -4.008em; left: 0.94em;\"><span class=\"mo\" id=\"MathJax-Span-4385\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àè</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.336em, 1003.23em, 4.378em, -999.997em); top: -2.81em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4386\"><span class=\"mrow\" id=\"MathJax-Span-4387\"><span class=\"mo\" id=\"MathJax-Span-4388\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4389\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-4390\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4391\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-4392\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4393\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4394\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-4395\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4396\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.263em;\"><span class=\"mo\" id=\"MathJax-Span-4397\" style=\"font-size: 50%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4398\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4399\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àà</span><span class=\"mi\" id=\"MathJax-Span-4400\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">c</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-4401\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">p</span><span class=\"mo\" id=\"MathJax-Span-4402\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4403\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4404\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msup\" id=\"MathJax-Span-4405\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4406\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-4407\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4408\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4409\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-4410\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4411\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-4412\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4413\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">z</span><span class=\"mo\" id=\"MathJax-Span-4414\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.747em; border-left: 0px solid; width: 0px; height: 3.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>p</mi><mo stretchy=\"false\">(</mo><mi>z</mi><mo>‚à£</mo><mi>c</mi><mo stretchy=\"false\">)</mo><mo>‚àù</mo><mi>p</mi><mo stretchy=\"false\">(</mo><mi>z</mi><mo stretchy=\"false\">)</mo><munder><mo>‚àè</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>r</mi><mo>,</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo><mo>‚àà</mo><mi>c</mi></mrow></munder><mi>p</mi><mo stretchy=\"false\">(</mo><mi>r</mi><mo>,</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo>‚à£</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo>,</mo><mi>z</mi><mo stretchy=\"false\">)</mo></math></span></span></div>\n<ul>\n  <li>This method enables <strong>Bayesian inference over tasks</strong>, blending meta-learning with off-policy actor‚Äìcritic updates.</li>\n</ul>\n<h4 id=\"advantages-and-emerging-trends\">Advantages and Emerging Trends</h4>\n<ul>\n  <li>\n    <p><strong>Advantages</strong>:</p>\n\n    <ul>\n      <li>Increased <strong>scalability</strong> through distributed architectures (IMPALA, R2D2).</li>\n      <li>Enhanced <strong>data efficiency</strong> via hybrid replay and model-based rollouts.</li>\n      <li>Improved <strong>generalization and adaptability</strong> through meta-learning frameworks.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Emerging Directions</strong>:</p>\n\n    <ul>\n      <li><strong>Hierarchical RL:</strong> multi-level policies for temporal abstraction (e.g., FeUdal Networks by <a href=\"https://arxiv.org/abs/1703.01161\">Vezhnevets et al., 2017</a>).</li>\n      <li><strong>Continual RL:</strong> lifelong agents that learn across non-stationary environments.</li>\n      <li><strong>Meta-World benchmarks:</strong> standardized environments for evaluating cross-task adaptability.</li>\n    </ul>\n  </li>\n</ul>\n<p><strong>Advantages</strong>:</p>\n<ul>\n      <li>Increased <strong>scalability</strong> through distributed architectures (IMPALA, R2D2).</li>\n      <li>Enhanced <strong>data efficiency</strong> via hybrid replay and model-based rollouts.</li>\n      <li>Improved <strong>generalization and adaptability</strong> through meta-learning frameworks.</li>\n    </ul>\n<p><strong>Emerging Directions</strong>:</p>\n<ul>\n      <li><strong>Hierarchical RL:</strong> multi-level policies for temporal abstraction (e.g., FeUdal Networks by <a href=\"https://arxiv.org/abs/1703.01161\">Vezhnevets et al., 2017</a>).</li>\n      <li><strong>Continual RL:</strong> lifelong agents that learn across non-stationary environments.</li>\n      <li><strong>Meta-World benchmarks:</strong> standardized environments for evaluating cross-task adaptability.</li>\n    </ul>\n<h4 id=\"comparative-analysis-9\">Comparative Analysis</h4>\n<p>Here is your table formatted according to the provided example styles:</p>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Category</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Key Algorithm</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Core Idea</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Reference</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Hybrid Distributed RL</strong></td>\n<td class=\"tg-tleft-valign-first\">IMPALA</td>\n<td class=\"tg-tleft-valign-first\">Off-policy correction with scalable actor‚Äìlearner design</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1802.01561\">Espeholt et al., 2018</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Recurrent Value Learning</strong></td>\n<td class=\"tg-tleft-valign-first\">R2D2</td>\n<td class=\"tg-tleft-valign-first\">Distributed DQN with LSTM and replay</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://openreview.net/forum?id=r1lyTjAqYX\">Kapturowski et al., 2019</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Latent Model Hybrid</strong></td>\n<td class=\"tg-tleft-valign-first\">PlaNet</td>\n<td class=\"tg-tleft-valign-first\">Latent dynamics for model-based planning</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1811.04551\">Hafner et al., 2019</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Meta-Initialization</strong></td>\n<td class=\"tg-tleft-valign-first\">MAML</td>\n<td class=\"tg-tleft-valign-first\">Fast adaptation across tasks</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1703.03400\">Finn et al., 2017</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Recurrent Meta-RL</strong></td>\n<td class=\"tg-tleft-valign-first\">RL¬≤</td>\n<td class=\"tg-tleft-valign-first\">Hidden-state-driven adaptation</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1611.02779\">Duan et al., 2016</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Probabilistic Meta-RL</strong></td>\n<td class=\"tg-tleft-valign-first\">PEARL</td>\n<td class=\"tg-tleft-valign-first\">Task latent embedding for meta policy</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1903.08254\">Rakelly et al., 2019</a></td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Category</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Key Algorithm</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Core Idea</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Reference</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Hybrid Distributed RL</strong></td>\n<td class=\"tg-tleft-valign-first\">IMPALA</td>\n<td class=\"tg-tleft-valign-first\">Off-policy correction with scalable actor‚Äìlearner design</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1802.01561\">Espeholt et al., 2018</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Recurrent Value Learning</strong></td>\n<td class=\"tg-tleft-valign-first\">R2D2</td>\n<td class=\"tg-tleft-valign-first\">Distributed DQN with LSTM and replay</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://openreview.net/forum?id=r1lyTjAqYX\">Kapturowski et al., 2019</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Latent Model Hybrid</strong></td>\n<td class=\"tg-tleft-valign-first\">PlaNet</td>\n<td class=\"tg-tleft-valign-first\">Latent dynamics for model-based planning</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1811.04551\">Hafner et al., 2019</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Meta-Initialization</strong></td>\n<td class=\"tg-tleft-valign-first\">MAML</td>\n<td class=\"tg-tleft-valign-first\">Fast adaptation across tasks</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1703.03400\">Finn et al., 2017</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Recurrent Meta-RL</strong></td>\n<td class=\"tg-tleft-valign-first\">RL¬≤</td>\n<td class=\"tg-tleft-valign-first\">Hidden-state-driven adaptation</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1611.02779\">Duan et al., 2016</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Probabilistic Meta-RL</strong></td>\n<td class=\"tg-tleft-valign-first\">PEARL</td>\n<td class=\"tg-tleft-valign-first\">Task latent embedding for meta policy</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1903.08254\">Rakelly et al., 2019</a></td>\n</tr>\n</tbody>\n</table>\n<ul>\n  <li><strong>Hybrid and Meta Deep RL</strong> represent the frontier of reinforcement learning‚Äîblurring the boundaries between model-free and model-based paradigms while equipping agents with <strong>adaptivity</strong>, <strong>memory</strong>, and <strong>transferability</strong>.</li>\n  <li>They lay the groundwork for general-purpose learning systems capable of reasoning across tasks and time scales.</li>\n</ul>",
    "contentMarkdown": "*   While the earlier categories of Deep Reinforcement Learning (Deep RL) isolate specific mechanisms‚Äîvalue prediction, policy optimization, or world modeling‚Äîmany recent advances emerge from **hybrid approaches** that combine these paradigms.\n*   In parallel, **meta-learning frameworks** extend deep RL to settings where agents must **adapt quickly** to new environments or tasks by leveraging prior experience.\n\n#### Hybrid Reinforcement Learning\n\n*   Hybrid RL methods aim to exploit the complementary strengths of different learning paradigms:\n    \n    *   **Value-based components** provide stable, sample-efficient bootstrapping.\n    *   **Policy-based components** enable smooth updates and stochastic exploration.\n    *   **Model-based components** offer foresight through predictive dynamics.\n*   Together, these elements create **multi-objective, multi-stream**, and **off-policy** architectures capable of scaling to massive environments.\n    \n\nHybrid RL methods aim to exploit the complementary strengths of different learning paradigms:\n\n*   **Value-based components** provide stable, sample-efficient bootstrapping.\n*   **Policy-based components** enable smooth updates and stochastic exploration.\n*   **Model-based components** offer foresight through predictive dynamics.\n\nTogether, these elements create **multi-objective, multi-stream**, and **off-policy** architectures capable of scaling to massive environments.\n\n##### Actor-Learner Architectures)\n\n*   **IMPALA**, introduced by [Espeholt et al. (2018)](https://arxiv.org/abs/1802.01561), scales actor‚Äìcritic learning to distributed settings.\n*   It separates **actors**, which generate trajectories in parallel environments, from a central **learner**, which updates shared parameters using an off-policy correction method called **V-trace**.\n    \n*   The V-trace targets correct the discrepancy between behavior policy ŒºŒº\\\\mu and target policy œÄœÄ\\\\pi:\n\nIt separates **actors**, which generate trajectories in parallel environments, from a central **learner**, which updates shared parameters using an off-policy correction method called **V-trace**.\n\nvs\\=V(xs)+‚àët\\=ss+n‚àí1Œ≥t‚àís(‚àèi\\=st‚àí1ci)œÅt(rt+Œ≥V(xt+1)‚àíV(xt))vs\\=V(xs)+‚àët\\=ss+n‚àí1Œ≥t‚àís(‚àèi\\=st‚àí1ci)œÅt(rt+Œ≥V(xt+1)‚àíV(xt))\n\n*   where œÅt\\=min(œÅ¬Ø,œÄ(at‚à£xt)Œº(at‚à£xt))œÅt\\=min(œÅ¬Ø,œÄ(at‚à£xt)Œº(at‚à£xt))\\\\rho\\_t = \\\\min(\\\\bar{\\\\rho}, \\\\frac{\\\\pi(a\\_t \\\\mid x\\_t)}{\\\\mu(a\\_t \\\\mid x\\_t)}).\n*   IMPALA enabled scalable training across thousands of environments with stable, near-linear performance gains.\n\n##### Distributed DQN)\n\n*   **R2D2**, proposed by [Kapturowski et al. (2019)](https://openreview.net/forum?id=r1lyTjAqYX), extended DQN to **recurrent networks** for partially observable environments.\n*   It combines:\n    \n*   A distributed architecture similar to IMPALA,\n*   Experience replay for off-policy learning, and\n*   Recurrent state-tracking through LSTM layers.\n    \n*   This combination of **value learning**, **sequence modeling**, and **distributed execution** yields strong performance in tasks requiring memory, such as DeepMind Lab and Atari with partial observability.\n\nIt combines:\n\nRecurrent state-tracking through LSTM layers.\n\n##### Model-Based Control\n\n*   Other hybrid frameworks explicitly merge **model-based planning** with **policy learning**, e.g.:\n    \n*   **PlaNet** by [Hafner et al. (2019)](https://arxiv.org/abs/1811.04551): learns a latent dynamics model for planning continuous-control actions.\n*   **LEC-based hybrids** (Learning Explicit Controllers): integrate control-theoretic priors into deep actor‚Äìcritic loops, improving sample efficiency and interpretability.\n*   **MuZero‚Äôs descendants**, such as EfficientZero ([Ye et al., 2021](https://arxiv.org/abs/2111.00210)), extend this concept with self-supervised planning.\n\nOther hybrid frameworks explicitly merge **model-based planning** with **policy learning**, e.g.:\n\n#### Meta Reinforcement Learning (Meta-RL)\n\n*   **Meta-RL**, also known as ‚Äúlearning to learn,‚Äù equips an agent to **adapt rapidly to new tasks** after minimal additional experience.\n*   Formally, the goal is to learn parameters Œ∏Œ∏\\\\theta that enable fast adaptation of a policy œÄŒ∏‚Ä≤œÄŒ∏‚Ä≤\\\\pi\\_{\\\\theta'} to new tasks Ti‚àºp(T)Ti‚àºp(T)T\\_i \\\\sim p(T) with only a few gradient steps.\n\n##### Model-Agnostic Meta-Learning (MAML)\n\n*   **MAML** for RL, by [Finn et al. (2017)](https://arxiv.org/abs/1703.03400), learns an initialization that can be fine-tuned efficiently:\n\nŒ∏‚Ä≤i\\=Œ∏‚àíŒ±‚àáŒ∏LTi(Œ∏)Œ∏i‚Ä≤\\=Œ∏‚àíŒ±‚àáŒ∏LTi(Œ∏)\n\n*   and optimizes across tasks to minimize post-adaptation loss:\n\nminŒ∏‚àëiLTi(Œ∏‚Ä≤i)minŒ∏‚àëiLTi(Œ∏i‚Ä≤)\n\n*   This gradient-through-gradient formulation allows fast policy adaptation to unseen environments.\n\n##### RL2RL2RL^2 and Recurrent Meta-Learners\n\n*   **RL2RL2RL^2**, proposed by [Duan et al. (2016)](https://arxiv.org/abs/1611.02779), represents meta-learning as a **recurrent policy** that learns to infer the task structure over time.\n*   The agent‚Äôs hidden state hthth\\_t captures task-specific knowledge from past trajectories, enabling **online adaptation** without explicit gradient updates.\n\n##### PEARL (Probabilistic Embedding for Actor‚ÄìCritic RL)\n\n*   **PEARL**, by [Rakelly et al. (2019)](https://arxiv.org/abs/1903.08254), introduces probabilistic context variables zzz to represent tasks in a latent embedding space.\n*   Policies are conditioned on zzz, which is inferred from a small context set of transitions:\n\np(z‚à£c)‚àùp(z)‚àè(s,a,r,s‚Ä≤)‚ààcp(r,s‚Ä≤‚à£s,a,z)p(z‚à£c)‚àùp(z)‚àè(s,a,r,s‚Ä≤)‚ààcp(r,s‚Ä≤‚à£s,a,z)\n\n*   This method enables **Bayesian inference over tasks**, blending meta-learning with off-policy actor‚Äìcritic updates.\n\n#### Advantages and Emerging Trends\n\n*   **Advantages**:\n    \n    *   Increased **scalability** through distributed architectures (IMPALA, R2D2).\n    *   Enhanced **data efficiency** via hybrid replay and model-based rollouts.\n    *   Improved **generalization and adaptability** through meta-learning frameworks.\n*   **Emerging Directions**:\n    \n    *   **Hierarchical RL:** multi-level policies for temporal abstraction (e.g., FeUdal Networks by [Vezhnevets et al., 2017](https://arxiv.org/abs/1703.01161)).\n    *   **Continual RL:** lifelong agents that learn across non-stationary environments.\n    *   **Meta-World benchmarks:** standardized environments for evaluating cross-task adaptability.\n\n**Advantages**:\n\n*   Increased **scalability** through distributed architectures (IMPALA, R2D2).\n*   Enhanced **data efficiency** via hybrid replay and model-based rollouts.\n*   Improved **generalization and adaptability** through meta-learning frameworks.\n\n**Emerging Directions**:\n\n*   **Hierarchical RL:** multi-level policies for temporal abstraction (e.g., FeUdal Networks by [Vezhnevets et al., 2017](https://arxiv.org/abs/1703.01161)).\n*   **Continual RL:** lifelong agents that learn across non-stationary environments.\n*   **Meta-World benchmarks:** standardized environments for evaluating cross-task adaptability.\n\n#### Comparative Analysis\n\nHere is your table formatted according to the provided example styles:\n\n**Category**\n\n**Key Algorithm**\n\n**Core Idea**\n\n**Reference**\n\n**Hybrid Distributed RL**\n\nIMPALA\n\nOff-policy correction with scalable actor‚Äìlearner design\n\n[Espeholt et al., 2018](https://arxiv.org/abs/1802.01561)\n\n**Recurrent Value Learning**\n\nR2D2\n\nDistributed DQN with LSTM and replay\n\n[Kapturowski et al., 2019](https://openreview.net/forum?id=r1lyTjAqYX)\n\n**Latent Model Hybrid**\n\nPlaNet\n\nLatent dynamics for model-based planning\n\n[Hafner et al., 2019](https://arxiv.org/abs/1811.04551)\n\n**Meta-Initialization**\n\nMAML\n\nFast adaptation across tasks\n\n[Finn et al., 2017](https://arxiv.org/abs/1703.03400)\n\n**Recurrent Meta-RL**\n\nRL¬≤\n\nHidden-state-driven adaptation\n\n[Duan et al., 2016](https://arxiv.org/abs/1611.02779)\n\n**Probabilistic Meta-RL**\n\nPEARL\n\nTask latent embedding for meta policy\n\n[Rakelly et al., 2019](https://arxiv.org/abs/1903.08254)\n\n**Category**\n\n**Key Algorithm**\n\n**Core Idea**\n\n**Reference**\n\n**Hybrid Distributed RL**\n\nIMPALA\n\nOff-policy correction with scalable actor‚Äìlearner design\n\n[Espeholt et al., 2018](https://arxiv.org/abs/1802.01561)\n\n**Recurrent Value Learning**\n\nR2D2\n\nDistributed DQN with LSTM and replay\n\n[Kapturowski et al., 2019](https://openreview.net/forum?id=r1lyTjAqYX)\n\n**Latent Model Hybrid**\n\nPlaNet\n\nLatent dynamics for model-based planning\n\n[Hafner et al., 2019](https://arxiv.org/abs/1811.04551)\n\n**Meta-Initialization**\n\nMAML\n\nFast adaptation across tasks\n\n[Finn et al., 2017](https://arxiv.org/abs/1703.03400)\n\n**Recurrent Meta-RL**\n\nRL¬≤\n\nHidden-state-driven adaptation\n\n[Duan et al., 2016](https://arxiv.org/abs/1611.02779)\n\n**Probabilistic Meta-RL**\n\nPEARL\n\nTask latent embedding for meta policy\n\n[Rakelly et al., 2019](https://arxiv.org/abs/1903.08254)\n\n*   **Hybrid and Meta Deep RL** represent the frontier of reinforcement learning‚Äîblurring the boundaries between model-free and model-based paradigms while equipping agents with **adaptivity**, **memory**, and **transferability**.\n*   They lay the groundwork for general-purpose learning systems capable of reasoning across tasks and time scales.",
    "order": 20,
    "orderInChapter": 12,
    "difficulty": 5,
    "estimatedMinutes": 5,
    "tags": [
      "algorithmsarchitecture",
      "embedding",
      "lstm",
      "reinforcement learning",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 977,
      "contentLength": 78557
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#hybrid-and-meta-deep-reinforcement-learning-methods",
    "scrapedAt": "2025-12-28T11:47:08.461Z"
  },
  {
    "id": "ai-reinforcement-learning-practical-considerations-21",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Types of Reinforcement Learning",
    "title": "Practical Considerations",
    "subtitle": "Types of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>While Deep RL has demonstrated remarkable success in domains such as gaming, robotics, and autonomous systems, practical deployment involves a range of technical, computational, and methodological challenges. By combining rigorous experimentation, careful reward design, and scalable infrastructure, researchers and engineers can harness Deep RL‚Äôs full potential to tackle increasingly complex, dynamic, and impactful problems across domains.</li>\n  <li>This section outlines the essential considerations practitioners should address when transitioning from research prototypes to real-world applications.</li>\n</ul>\n<h4 id=\"algorithm-selection-and-stability\">Algorithm Selection and Stability</h4>\n<ul>\n  <li>The performance and stability of reinforcement learning algorithms depend heavily on the <strong>environment‚Äôs complexity</strong>, <strong>state‚Äìaction dimensionality</strong>, and <strong>reward structure</strong>.</li>\n  <li>\n    <p>For newcomers, starting with robust, well-studied algorithms such as <strong>DQN</strong> (<a href=\"https://www.nature.com/articles/nature14236\">Mnih et al., 2015</a>) or <strong>PPO</strong> (<a href=\"https://arxiv.org/abs/1707.06347\">Schulman et al., 2017</a>) is recommended due to their relative simplicity and stable learning dynamics.</p>\n  </li>\n  <li>In contrast, advanced methods like <strong>Soft Actor‚ÄìCritic (SAC)</strong> or <strong>Twin Delayed DDPG (TD3)</strong> provide higher performance in continuous domains but demand greater hyperparameter tuning and computational resources.</li>\n  <li>\n    <p>Ultimately, algorithm choice should balance:</p>\n\n    <ul>\n      <li><strong>Exploration vs. exploitation trade-offs</strong></li>\n      <li><strong>Data efficiency vs. computational cost</strong></li>\n      <li><strong>Model complexity vs. interpretability</strong></li>\n    </ul>\n  </li>\n</ul>\n<p>For newcomers, starting with robust, well-studied algorithms such as <strong>DQN</strong> (<a href=\"https://www.nature.com/articles/nature14236\">Mnih et al., 2015</a>) or <strong>PPO</strong> (<a href=\"https://arxiv.org/abs/1707.06347\">Schulman et al., 2017</a>) is recommended due to their relative simplicity and stable learning dynamics.</p>\n<p>Ultimately, algorithm choice should balance:</p>\n<ul>\n      <li><strong>Exploration vs. exploitation trade-offs</strong></li>\n      <li><strong>Data efficiency vs. computational cost</strong></li>\n      <li><strong>Model complexity vs. interpretability</strong></li>\n    </ul>\n<h4 id=\"sample-efficiency-and-computational-constraints\">Sample Efficiency and Computational Constraints</h4>\n<ul>\n  <li>\n    <p>Deep RL is notoriously <strong>data-hungry</strong>. Algorithms such as <strong>model-based RL</strong> and <strong>off-policy actor‚Äìcritic methods</strong> (e.g., SAC, DDPG) mitigate this by reusing past experiences and simulating synthetic rollouts.\nHowever, computational requirements for training can be substantial‚Äîespecially when scaling to high-dimensional visual or multi-agent environments.</p>\n  </li>\n  <li>\n    <p>Practical mitigations include:</p>\n\n    <ul>\n      <li>Using <strong>experience replay buffers</strong> efficiently to maximize sample reuse.</li>\n      <li>Leveraging <strong>parallelized environments</strong> (e.g., via <a href=\"https://arxiv.org/abs/1802.01561\">IMPALA</a>) for increased data throughput.</li>\n      <li>Applying <strong>hardware acceleration</strong> (GPU/TPU clusters) to speed up gradient updates.</li>\n      <li>Employing <strong>mixed-precision training</strong> to optimize resource utilization.</li>\n    </ul>\n  </li>\n</ul>\n<p>Deep RL is notoriously <strong>data-hungry</strong>. Algorithms such as <strong>model-based RL</strong> and <strong>off-policy actor‚Äìcritic methods</strong> (e.g., SAC, DDPG) mitigate this by reusing past experiences and simulating synthetic rollouts.\nHowever, computational requirements for training can be substantial‚Äîespecially when scaling to high-dimensional visual or multi-agent environments.</p>\n<p>Practical mitigations include:</p>\n<ul>\n      <li>Using <strong>experience replay buffers</strong> efficiently to maximize sample reuse.</li>\n      <li>Leveraging <strong>parallelized environments</strong> (e.g., via <a href=\"https://arxiv.org/abs/1802.01561\">IMPALA</a>) for increased data throughput.</li>\n      <li>Applying <strong>hardware acceleration</strong> (GPU/TPU clusters) to speed up gradient updates.</li>\n      <li>Employing <strong>mixed-precision training</strong> to optimize resource utilization.</li>\n    </ul>\n<h4 id=\"environment-design-and-simulation-fidelity\">Environment Design and Simulation Fidelity</h4>\n<ul>\n  <li>Simulation environments such as <strong>OpenAI Gym</strong>, <strong>DeepMind Control Suite</strong>, and <strong>Unity ML-Agents</strong> are indispensable for prototyping and testing RL systems.</li>\n  <li>\n    <p>Nevertheless, the <strong>‚Äúsim-to-real gap‚Äù</strong>‚Äîthe discrepancy between simulated and real-world dynamics‚Äîposes a major challenge for deploying learned policies in robotics, logistics, or autonomous driving.</p>\n  </li>\n  <li>\n    <p>Mitigation strategies include:</p>\n\n    <ul>\n      <li><strong>Domain randomization:</strong> Training across diverse simulated variations to improve generalization (<a href=\"https://arxiv.org/abs/1703.06907\">Tobin et al., 2017</a>).</li>\n      <li><strong>Transfer learning:</strong> Fine-tuning pretrained policies on real-world data.</li>\n      <li><strong>Hybrid modeling:</strong> Incorporating partial physics-based models into neural dynamics learning.</li>\n    </ul>\n  </li>\n  <li>Simulation fidelity must strike a balance between realism, computational efficiency, and reproducibility.</li>\n</ul>\n<p>Nevertheless, the <strong>‚Äúsim-to-real gap‚Äù</strong>‚Äîthe discrepancy between simulated and real-world dynamics‚Äîposes a major challenge for deploying learned policies in robotics, logistics, or autonomous driving.</p>\n<p>Mitigation strategies include:</p>\n<ul>\n      <li><strong>Domain randomization:</strong> Training across diverse simulated variations to improve generalization (<a href=\"https://arxiv.org/abs/1703.06907\">Tobin et al., 2017</a>).</li>\n      <li><strong>Transfer learning:</strong> Fine-tuning pretrained policies on real-world data.</li>\n      <li><strong>Hybrid modeling:</strong> Incorporating partial physics-based models into neural dynamics learning.</li>\n    </ul>\n<h4 id=\"reward-engineering-and-safety\">Reward Engineering and Safety</h4>\n<ul>\n  <li>\n    <p>Designing an appropriate <strong>reward function</strong> is one of the most critical and subtle challenges in RL. Misaligned or sparse rewards can lead to:</p>\n\n    <ul>\n      <li><strong>Unintended behaviors</strong> (reward hacking),</li>\n      <li><strong>Slow convergence</strong>, or</li>\n      <li><strong>Unsafe exploration</strong> in real-world settings.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Practical strategies for robust reward design include:</p>\n  </li>\n  <li>Using <strong>reward shaping</strong> to guide learning without overfitting.</li>\n  <li>Incorporating <strong>auxiliary objectives</strong> (e.g., curiosity, intrinsic motivation) to drive exploration (<a href=\"https://arxiv.org/abs/1705.05363\">Pathak et al., 2017</a>).</li>\n  <li>Applying <strong>safety constraints</strong> through Constrained Policy Optimization (CPO) (<a href=\"https://arxiv.org/abs/1705.10528\">Achiam et al., 2017</a>) or shielded exploration.</li>\n</ul>\n<p>Designing an appropriate <strong>reward function</strong> is one of the most critical and subtle challenges in RL. Misaligned or sparse rewards can lead to:</p>\n<ul>\n      <li><strong>Unintended behaviors</strong> (reward hacking),</li>\n      <li><strong>Slow convergence</strong>, or</li>\n      <li><strong>Unsafe exploration</strong> in real-world settings.</li>\n    </ul>\n<p>Practical strategies for robust reward design include:</p>\n<h4 id=\"distributed-and-scalable-training\">Distributed and Scalable Training</h4>\n<ul>\n  <li>\n    <p>Training complex Deep RL systems often requires distributed computation frameworks capable of managing large-scale experiments.\nModern RL infrastructure commonly relies on:</p>\n\n    <ul>\n      <li><strong>Ray RLlib</strong> (<a href=\"https://arxiv.org/abs/1712.09381\">Liang et al., 2018</a>) for distributed execution and hyperparameter tuning.</li>\n      <li><strong>TensorFlow Agents (TF-Agents)</strong> or <strong>PyTorch Lightning</strong> for modular model construction.</li>\n      <li><strong>Weights &amp; Biases</strong> and <strong>Neptune.ai</strong> for real-time monitoring and experiment tracking.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Such frameworks enable multi-environment rollouts, large replay buffers, and asynchronous updates‚Äîall essential for scaling Deep RL to production-level workloads.</p>\n  </li>\n</ul>\n<p>Training complex Deep RL systems often requires distributed computation frameworks capable of managing large-scale experiments.\nModern RL infrastructure commonly relies on:</p>\n<ul>\n      <li><strong>Ray RLlib</strong> (<a href=\"https://arxiv.org/abs/1712.09381\">Liang et al., 2018</a>) for distributed execution and hyperparameter tuning.</li>\n      <li><strong>TensorFlow Agents (TF-Agents)</strong> or <strong>PyTorch Lightning</strong> for modular model construction.</li>\n      <li><strong>Weights &amp; Biases</strong> and <strong>Neptune.ai</strong> for real-time monitoring and experiment tracking.</li>\n    </ul>\n<p>Such frameworks enable multi-environment rollouts, large replay buffers, and asynchronous updates‚Äîall essential for scaling Deep RL to production-level workloads.</p>\n<h4 id=\"interpretability-and-debugging\">Interpretability and Debugging</h4>\n<ul>\n  <li>Unlike supervised learning, where loss curves provide clear convergence signals, RL training often exhibits <strong>non-stationary</strong>, <strong>high-variance</strong>, and <strong>delayed-reward</strong> feedback.</li>\n  <li>\n    <p>This makes debugging particularly challenging. Best practices include:</p>\n\n    <ul>\n      <li>Tracking <strong>per-episode returns</strong> and <strong>value function estimates</strong>.</li>\n      <li>Logging <strong>policy entropy</strong> and <strong>action distributions</strong> to monitor exploration.</li>\n      <li>Visualizing <strong>state embeddings</strong> to assess feature learning and policy drift.</li>\n    </ul>\n  </li>\n  <li>Additionally, recent research into <strong>explainable RL (XRL)</strong>‚Äîsuch as causal policy analysis and saliency-based visualization‚Äîaims to improve interpretability for high-stakes applications.</li>\n</ul>\n<p>This makes debugging particularly challenging. Best practices include:</p>\n<ul>\n      <li>Tracking <strong>per-episode returns</strong> and <strong>value function estimates</strong>.</li>\n      <li>Logging <strong>policy entropy</strong> and <strong>action distributions</strong> to monitor exploration.</li>\n      <li>Visualizing <strong>state embeddings</strong> to assess feature learning and policy drift.</li>\n    </ul>\n<h4 id=\"ethical-and-operational-constraints\">Ethical and Operational Constraints</h4>\n<ul>\n  <li>As RL systems increasingly impact real-world environments, ensuring ethical compliance and operational safety is paramount.</li>\n  <li>\n    <p>Important considerations include:</p>\n\n    <ul>\n      <li><strong>Fairness:</strong> Preventing biased decision policies in resource allocation or recommendation contexts.</li>\n      <li><strong>Accountability:</strong> Logging agent decisions and maintaining audit trails.</li>\n      <li><strong>Human-in-the-loop control:</strong> Allowing oversight and correction during exploration phases.</li>\n    </ul>\n  </li>\n  <li>Emerging work in <strong>safe RL</strong> and <strong>responsible autonomy</strong> seeks to align algorithmic optimization with human values and societal constraints.</li>\n</ul>\n<p>Important considerations include:</p>\n<ul>\n      <li><strong>Fairness:</strong> Preventing biased decision policies in resource allocation or recommendation contexts.</li>\n      <li><strong>Accountability:</strong> Logging agent decisions and maintaining audit trails.</li>\n      <li><strong>Human-in-the-loop control:</strong> Allowing oversight and correction during exploration phases.</li>\n    </ul>",
    "contentMarkdown": "*   While Deep RL has demonstrated remarkable success in domains such as gaming, robotics, and autonomous systems, practical deployment involves a range of technical, computational, and methodological challenges. By combining rigorous experimentation, careful reward design, and scalable infrastructure, researchers and engineers can harness Deep RL‚Äôs full potential to tackle increasingly complex, dynamic, and impactful problems across domains.\n*   This section outlines the essential considerations practitioners should address when transitioning from research prototypes to real-world applications.\n\n#### Algorithm Selection and Stability\n\n*   The performance and stability of reinforcement learning algorithms depend heavily on the **environment‚Äôs complexity**, **state‚Äìaction dimensionality**, and **reward structure**.\n*   For newcomers, starting with robust, well-studied algorithms such as **DQN** ([Mnih et al., 2015](https://www.nature.com/articles/nature14236)) or **PPO** ([Schulman et al., 2017](https://arxiv.org/abs/1707.06347)) is recommended due to their relative simplicity and stable learning dynamics.\n    \n*   In contrast, advanced methods like **Soft Actor‚ÄìCritic (SAC)** or **Twin Delayed DDPG (TD3)** provide higher performance in continuous domains but demand greater hyperparameter tuning and computational resources.\n*   Ultimately, algorithm choice should balance:\n    \n    *   **Exploration vs. exploitation trade-offs**\n    *   **Data efficiency vs. computational cost**\n    *   **Model complexity vs. interpretability**\n\nFor newcomers, starting with robust, well-studied algorithms such as **DQN** ([Mnih et al., 2015](https://www.nature.com/articles/nature14236)) or **PPO** ([Schulman et al., 2017](https://arxiv.org/abs/1707.06347)) is recommended due to their relative simplicity and stable learning dynamics.\n\nUltimately, algorithm choice should balance:\n\n*   **Exploration vs. exploitation trade-offs**\n*   **Data efficiency vs. computational cost**\n*   **Model complexity vs. interpretability**\n\n#### Sample Efficiency and Computational Constraints\n\n*   Deep RL is notoriously **data-hungry**. Algorithms such as **model-based RL** and **off-policy actor‚Äìcritic methods** (e.g., SAC, DDPG) mitigate this by reusing past experiences and simulating synthetic rollouts. However, computational requirements for training can be substantial‚Äîespecially when scaling to high-dimensional visual or multi-agent environments.\n    \n*   Practical mitigations include:\n    \n    *   Using **experience replay buffers** efficiently to maximize sample reuse.\n    *   Leveraging **parallelized environments** (e.g., via [IMPALA](https://arxiv.org/abs/1802.01561)) for increased data throughput.\n    *   Applying **hardware acceleration** (GPU/TPU clusters) to speed up gradient updates.\n    *   Employing **mixed-precision training** to optimize resource utilization.\n\nDeep RL is notoriously **data-hungry**. Algorithms such as **model-based RL** and **off-policy actor‚Äìcritic methods** (e.g., SAC, DDPG) mitigate this by reusing past experiences and simulating synthetic rollouts. However, computational requirements for training can be substantial‚Äîespecially when scaling to high-dimensional visual or multi-agent environments.\n\nPractical mitigations include:\n\n*   Using **experience replay buffers** efficiently to maximize sample reuse.\n*   Leveraging **parallelized environments** (e.g., via [IMPALA](https://arxiv.org/abs/1802.01561)) for increased data throughput.\n*   Applying **hardware acceleration** (GPU/TPU clusters) to speed up gradient updates.\n*   Employing **mixed-precision training** to optimize resource utilization.\n\n#### Environment Design and Simulation Fidelity\n\n*   Simulation environments such as **OpenAI Gym**, **DeepMind Control Suite**, and **Unity ML-Agents** are indispensable for prototyping and testing RL systems.\n*   Nevertheless, the **‚Äúsim-to-real gap‚Äù**‚Äîthe discrepancy between simulated and real-world dynamics‚Äîposes a major challenge for deploying learned policies in robotics, logistics, or autonomous driving.\n    \n*   Mitigation strategies include:\n    \n    *   **Domain randomization:** Training across diverse simulated variations to improve generalization ([Tobin et al., 2017](https://arxiv.org/abs/1703.06907)).\n    *   **Transfer learning:** Fine-tuning pretrained policies on real-world data.\n    *   **Hybrid modeling:** Incorporating partial physics-based models into neural dynamics learning.\n*   Simulation fidelity must strike a balance between realism, computational efficiency, and reproducibility.\n\nNevertheless, the **‚Äúsim-to-real gap‚Äù**‚Äîthe discrepancy between simulated and real-world dynamics‚Äîposes a major challenge for deploying learned policies in robotics, logistics, or autonomous driving.\n\nMitigation strategies include:\n\n*   **Domain randomization:** Training across diverse simulated variations to improve generalization ([Tobin et al., 2017](https://arxiv.org/abs/1703.06907)).\n*   **Transfer learning:** Fine-tuning pretrained policies on real-world data.\n*   **Hybrid modeling:** Incorporating partial physics-based models into neural dynamics learning.\n\n#### Reward Engineering and Safety\n\n*   Designing an appropriate **reward function** is one of the most critical and subtle challenges in RL. Misaligned or sparse rewards can lead to:\n    \n    *   **Unintended behaviors** (reward hacking),\n    *   **Slow convergence**, or\n    *   **Unsafe exploration** in real-world settings.\n*   Practical strategies for robust reward design include:\n    \n*   Using **reward shaping** to guide learning without overfitting.\n*   Incorporating **auxiliary objectives** (e.g., curiosity, intrinsic motivation) to drive exploration ([Pathak et al., 2017](https://arxiv.org/abs/1705.05363)).\n*   Applying **safety constraints** through Constrained Policy Optimization (CPO) ([Achiam et al., 2017](https://arxiv.org/abs/1705.10528)) or shielded exploration.\n\nDesigning an appropriate **reward function** is one of the most critical and subtle challenges in RL. Misaligned or sparse rewards can lead to:\n\n*   **Unintended behaviors** (reward hacking),\n*   **Slow convergence**, or\n*   **Unsafe exploration** in real-world settings.\n\nPractical strategies for robust reward design include:\n\n#### Distributed and Scalable Training\n\n*   Training complex Deep RL systems often requires distributed computation frameworks capable of managing large-scale experiments. Modern RL infrastructure commonly relies on:\n    \n    *   **Ray RLlib** ([Liang et al., 2018](https://arxiv.org/abs/1712.09381)) for distributed execution and hyperparameter tuning.\n    *   **TensorFlow Agents (TF-Agents)** or **PyTorch Lightning** for modular model construction.\n    *   **Weights & Biases** and **Neptune.ai** for real-time monitoring and experiment tracking.\n*   Such frameworks enable multi-environment rollouts, large replay buffers, and asynchronous updates‚Äîall essential for scaling Deep RL to production-level workloads.\n    \n\nTraining complex Deep RL systems often requires distributed computation frameworks capable of managing large-scale experiments. Modern RL infrastructure commonly relies on:\n\n*   **Ray RLlib** ([Liang et al., 2018](https://arxiv.org/abs/1712.09381)) for distributed execution and hyperparameter tuning.\n*   **TensorFlow Agents (TF-Agents)** or **PyTorch Lightning** for modular model construction.\n*   **Weights & Biases** and **Neptune.ai** for real-time monitoring and experiment tracking.\n\nSuch frameworks enable multi-environment rollouts, large replay buffers, and asynchronous updates‚Äîall essential for scaling Deep RL to production-level workloads.\n\n#### Interpretability and Debugging\n\n*   Unlike supervised learning, where loss curves provide clear convergence signals, RL training often exhibits **non-stationary**, **high-variance**, and **delayed-reward** feedback.\n*   This makes debugging particularly challenging. Best practices include:\n    \n    *   Tracking **per-episode returns** and **value function estimates**.\n    *   Logging **policy entropy** and **action distributions** to monitor exploration.\n    *   Visualizing **state embeddings** to assess feature learning and policy drift.\n*   Additionally, recent research into **explainable RL (XRL)**‚Äîsuch as causal policy analysis and saliency-based visualization‚Äîaims to improve interpretability for high-stakes applications.\n\nThis makes debugging particularly challenging. Best practices include:\n\n*   Tracking **per-episode returns** and **value function estimates**.\n*   Logging **policy entropy** and **action distributions** to monitor exploration.\n*   Visualizing **state embeddings** to assess feature learning and policy drift.\n\n#### Ethical and Operational Constraints\n\n*   As RL systems increasingly impact real-world environments, ensuring ethical compliance and operational safety is paramount.\n*   Important considerations include:\n    \n    *   **Fairness:** Preventing biased decision policies in resource allocation or recommendation contexts.\n    *   **Accountability:** Logging agent decisions and maintaining audit trails.\n    *   **Human-in-the-loop control:** Allowing oversight and correction during exploration phases.\n*   Emerging work in **safe RL** and **responsible autonomy** seeks to align algorithmic optimization with human values and societal constraints.\n\nImportant considerations include:\n\n*   **Fairness:** Preventing biased decision policies in resource allocation or recommendation contexts.\n*   **Accountability:** Logging agent decisions and maintaining audit trails.\n*   **Human-in-the-loop control:** Allowing oversight and correction during exploration phases.",
    "order": 21,
    "orderInChapter": 13,
    "difficulty": 4,
    "estimatedMinutes": 6,
    "tags": [
      "algorithmsarchitecture",
      "embedding",
      "reinforcement learning",
      "supervised learning",
      "optimization",
      "fine-tuning",
      "transfer learning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 1104,
      "contentLength": 12277
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#practical-considerations",
    "scrapedAt": "2025-12-28T11:47:08.461Z"
  },
  {
    "id": "ai-reinforcement-learning-tools-and-frameworks-for-deep-reinforcement-learni-22",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Types of Reinforcement Learning",
    "title": "Tools and Frameworks for Deep Reinforcement Learning",
    "subtitle": "Types of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>The evolution of Deep RL has been accompanied by an ecosystem of <strong>open-source tools and frameworks</strong> that simplify experimentation, benchmarking, and large-scale deployment. These frameworks abstract away much of the engineering complexity‚Äîsuch as distributed training, environment interfacing, and algorithmic reproducibility‚Äîallowing researchers and practitioners to focus on innovation and application.</li>\n</ul>\n<h4 id=\"simulation-and-environment-libraries\">Simulation and Environment Libraries</h4>\n<ul>\n  <li>A well-designed environment is foundational to any RL experiment. The following platforms are widely adopted for training, evaluation, and benchmarking.</li>\n</ul>\n<h5 id=\"openai-gym\">OpenAI Gym</h5>\n<ul>\n  <li><strong>Reference:</strong> <a href=\"https://arxiv.org/abs/1606.01540\">Brockman et al. (2016)</a></li>\n  <li><strong>Overview:</strong> The de facto standard for RL environments, offering a unified API for tasks ranging from simple control problems (e.g., <em>CartPole</em>) to Atari games and MuJoCo physics-based simulations.</li>\n  <li>\n    <p><strong>Features:</strong></p>\n\n    <ul>\n      <li>Consistent step/reset interface: <code class=\"language-plaintext highlighter-rouge\">observation, reward, done, info = env.step(action)</code></li>\n      <li>Extensive third-party support via custom environments</li>\n      <li>Compatibility with Gymnasium (the community-maintained successor)</li>\n    </ul>\n  </li>\n</ul>\n<p><strong>Features:</strong></p>\n<ul>\n      <li>Consistent step/reset interface: <code class=\"language-plaintext highlighter-rouge\">observation, reward, done, info = env.step(action)</code></li>\n      <li>Extensive third-party support via custom environments</li>\n      <li>Compatibility with Gymnasium (the community-maintained successor)</li>\n    </ul>\n<h5 id=\"deepmind-control-suite\">DeepMind Control Suite</h5>\n<ul>\n  <li><strong>Reference:</strong> <a href=\"https://arxiv.org/abs/1801.00690\">Tassa et al. (2018)</a></li>\n  <li>Designed for <strong>continuous control</strong> research, this suite provides physics-accurate environments built on the <strong>MuJoCo</strong> engine.</li>\n  <li>Often used for benchmarking actor‚Äìcritic methods like DDPG, TD3, and SAC.</li>\n</ul>\n<h5 id=\"unity-ml-agents\">Unity ML-Agents</h5>\n<ul>\n  <li><strong>Reference:</strong> <a href=\"https://arxiv.org/abs/1809.02627\">Juliani et al. (2018)</a></li>\n  <li>A flexible platform for developing <strong>3D interactive learning environments</strong> using Unity.</li>\n  <li>Supports both <strong>discrete and continuous</strong> actions and facilitates training in <strong>multi-agent</strong> or <strong>curriculum learning</strong> setups.</li>\n</ul>\n<h5 id=\"meta-world\">Meta-World</h5>\n<ul>\n  <li><strong>Reference:</strong> <a href=\"https://arxiv.org/abs/1910.10897\">Yu et al. (2020)</a></li>\n  <li>A benchmark for <strong>meta-RL</strong> and <strong>transfer learning</strong>, consisting of over 50 robotic manipulation tasks sharing a consistent observation and action space.</li>\n  <li>Enables evaluation of generalization and cross-task adaptation capabilities.</li>\n</ul>\n<h4 id=\"algorithmic-frameworks-and-libraries\">Algorithmic Frameworks and Libraries</h4>\n<ul>\n  <li>Modern Deep RL frameworks encapsulate key algorithmic components (policy networks, replay buffers, optimizers, and loss functions) while allowing flexible experimentation and large-scale distributed training.</li>\n</ul>\n<h5 id=\"stable-baselines3\">Stable Baselines3</h5>\n<ul>\n  <li><strong>Reference:</strong> <a href=\"https://github.com/DLR-RM/stable-baselines3\">Raffin et al. (2021)</a></li>\n  <li><strong>Overview:</strong> A well-maintained PyTorch reimplementation of popular algorithms (DQN, PPO, A2C, SAC, TD3).</li>\n  <li>\n    <p><strong>Advantages:</strong></p>\n\n    <ul>\n      <li>Simple, unified interface: <code class=\"language-plaintext highlighter-rouge\">model = PPO(\"MlpPolicy\", env).learn(1e6)</code></li>\n      <li>Pretrained policies and logging integrations</li>\n      <li>Excellent for reproducible research and small to medium-scale tasks</li>\n    </ul>\n  </li>\n</ul>\n<p><strong>Advantages:</strong></p>\n<ul>\n      <li>Simple, unified interface: <code class=\"language-plaintext highlighter-rouge\">model = PPO(\"MlpPolicy\", env).learn(1e6)</code></li>\n      <li>Pretrained policies and logging integrations</li>\n      <li>Excellent for reproducible research and small to medium-scale tasks</li>\n    </ul>\n<h5 id=\"rllib-ray\">RLlib (Ray)</h5>\n<ul>\n  <li><strong>Reference:</strong> <a href=\"https://arxiv.org/abs/1712.09381\">Liang et al. (2018)</a></li>\n  <li>A production-grade distributed RL framework built on <strong>Ray</strong>.</li>\n  <li>\n    <p><strong>Highlights:</strong></p>\n\n    <ul>\n      <li>Supports large-scale distributed training (e.g., IMPALA, Ape-X, R2D2)</li>\n      <li>Integrated hyperparameter tuning with <strong>Ray Tune</strong></li>\n      <li>Seamless scaling from local machines to cloud clusters</li>\n    </ul>\n  </li>\n</ul>\n<p><strong>Highlights:</strong></p>\n<ul>\n      <li>Supports large-scale distributed training (e.g., IMPALA, Ape-X, R2D2)</li>\n      <li>Integrated hyperparameter tuning with <strong>Ray Tune</strong></li>\n      <li>Seamless scaling from local machines to cloud clusters</li>\n    </ul>\n<h5 id=\"tensorflow-agents-tf-agents\">TensorFlow Agents (TF-Agents)</h5>\n<ul>\n  <li><strong>Reference:</strong> <a href=\"https://www.tensorflow.org/agents\">TF-Agents Documentation</a></li>\n  <li>Modular TensorFlow-based library for composing RL pipelines with reusable building blocks (agents, networks, policies, drivers).</li>\n  <li>Ideal for Google Cloud and TensorFlow ecosystem users.</li>\n</ul>\n<h5 id=\"acme\">Acme</h5>\n<ul>\n  <li><strong>Reference:</strong> <a href=\"https://arxiv.org/abs/2006.00979\">Hoffman et al. (2020)</a></li>\n  <li>Developed by DeepMind for scalable, research-friendly RL experimentation.</li>\n  <li>Implements a flexible component-based architecture with abstractions like <em>actors</em>, <em>learners</em>, and <em>environment loops</em>, inspired by real-world production needs.</li>\n</ul>\n<h4 id=\"visualization-debugging-and-monitoring-tools\">Visualization, Debugging, and Monitoring Tools</h4>\n<ul>\n  <li>Effective training of Deep RL models requires continuous monitoring of rewards, losses, and policy stability.</li>\n</ul>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Tool</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Functionality</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Integration</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>TensorBoard</strong></td>\n<td class=\"tg-tleft-valign-first\">Visualizes scalar metrics, histograms, and computational graphs</td>\n<td class=\"tg-tleft-valign-second\">Native in TF-Agents and RLlib</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Weights &amp; Biases (W&amp;B)</strong></td>\n<td class=\"tg-tleft-valign-first\">Experiment tracking, hyperparameter sweeps, and visual dashboards</td>\n<td class=\"tg-tleft-valign-second\">Plug-in for Stable Baselines3 and PyTorch RL</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Neptune.ai</strong></td>\n<td class=\"tg-tleft-valign-first\">Collaborative experiment management</td>\n<td class=\"tg-tleft-valign-second\">Integrates with custom PyTorch/TensorFlow code</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Gym Monitor / MoviePy</strong></td>\n<td class=\"tg-tleft-valign-first\">Renders episode videos for qualitative evaluation</td>\n<td class=\"tg-tleft-valign-second\">Useful for policy interpretability</td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Tool</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Functionality</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Integration</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>TensorBoard</strong></td>\n<td class=\"tg-tleft-valign-first\">Visualizes scalar metrics, histograms, and computational graphs</td>\n<td class=\"tg-tleft-valign-second\">Native in TF-Agents and RLlib</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Weights &amp; Biases (W&amp;B)</strong></td>\n<td class=\"tg-tleft-valign-first\">Experiment tracking, hyperparameter sweeps, and visual dashboards</td>\n<td class=\"tg-tleft-valign-second\">Plug-in for Stable Baselines3 and PyTorch RL</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Neptune.ai</strong></td>\n<td class=\"tg-tleft-valign-first\">Collaborative experiment management</td>\n<td class=\"tg-tleft-valign-second\">Integrates with custom PyTorch/TensorFlow code</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Gym Monitor / MoviePy</strong></td>\n<td class=\"tg-tleft-valign-first\">Renders episode videos for qualitative evaluation</td>\n<td class=\"tg-tleft-valign-second\">Useful for policy interpretability</td>\n</tr>\n</tbody>\n</table>\n<ul>\n  <li>These tools make it easier to interpret agent behaviors, detect mode collapse, and fine-tune learning schedules.</li>\n</ul>\n<h4 id=\"distributed-training-and-cloud-deployment\">Distributed Training and Cloud Deployment</h4>\n<ul>\n  <li>\n    <p>Scaling RL beyond local experiments often requires <strong>cloud-based training pipelines</strong>. Modern frameworks support distributed execution and resource orchestration via:</p>\n\n    <ul>\n      <li><strong>Ray Cluster / RLlib</strong> for multi-node actor‚Äìlearner training</li>\n      <li><strong>Kubernetes</strong> for container orchestration</li>\n      <li><strong>Vertex AI</strong>, <strong>AWS SageMaker</strong>, and <strong>Azure ML</strong> for managed distributed compute</li>\n      <li><strong>Weights &amp; Biases Sweeps</strong> for large-scale hyperparameter optimization</li>\n    </ul>\n  </li>\n  <li>\n    <p>Combining these systems enables real-time experimentation, model checkpointing, and rollout aggregation across hundreds of simulated agents‚Äîessential for complex, non-stationary environments.</p>\n  </li>\n</ul>\n<p>Scaling RL beyond local experiments often requires <strong>cloud-based training pipelines</strong>. Modern frameworks support distributed execution and resource orchestration via:</p>\n<ul>\n      <li><strong>Ray Cluster / RLlib</strong> for multi-node actor‚Äìlearner training</li>\n      <li><strong>Kubernetes</strong> for container orchestration</li>\n      <li><strong>Vertex AI</strong>, <strong>AWS SageMaker</strong>, and <strong>Azure ML</strong> for managed distributed compute</li>\n      <li><strong>Weights &amp; Biases Sweeps</strong> for large-scale hyperparameter optimization</li>\n    </ul>\n<p>Combining these systems enables real-time experimentation, model checkpointing, and rollout aggregation across hundreds of simulated agents‚Äîessential for complex, non-stationary environments.</p>\n<h4 id=\"benchmark-suites-and-evaluation-protocols\">Benchmark Suites and Evaluation Protocols</h4>\n<ul>\n  <li>Benchmarking ensures fair and reproducible evaluation across methods.</li>\n  <li>\n    <p>Prominent benchmarks include:</p>\n\n    <ul>\n      <li><strong>Atari 2600 Suite</strong> (<a href=\"https://arxiv.org/abs/1305.4208\">Bellemare et al., 2013</a>): evaluates discrete-action performance and exploration strategies.</li>\n      <li><strong>DeepMind Control Suite</strong>: tests continuous control robustness.</li>\n      <li><strong>Procgen Benchmark</strong> (<a href=\"https://arxiv.org/abs/1912.01588\">Cobbe et al., 2019</a>): measures generalization to unseen procedural environments.</li>\n      <li><strong>Meta-World and D4RL</strong> (<a href=\"https://arxiv.org/abs/2004.07219\">Fu et al., 2020</a>): assess offline and transfer learning capabilities.</li>\n    </ul>\n  </li>\n  <li>Adhering to standardized evaluation protocols fosters comparability and reproducibility in Deep RL research.</li>\n</ul>\n<p>Prominent benchmarks include:</p>\n<ul>\n      <li><strong>Atari 2600 Suite</strong> (<a href=\"https://arxiv.org/abs/1305.4208\">Bellemare et al., 2013</a>): evaluates discrete-action performance and exploration strategies.</li>\n      <li><strong>DeepMind Control Suite</strong>: tests continuous control robustness.</li>\n      <li><strong>Procgen Benchmark</strong> (<a href=\"https://arxiv.org/abs/1912.01588\">Cobbe et al., 2019</a>): measures generalization to unseen procedural environments.</li>\n      <li><strong>Meta-World and D4RL</strong> (<a href=\"https://arxiv.org/abs/2004.07219\">Fu et al., 2020</a>): assess offline and transfer learning capabilities.</li>\n    </ul>\n<h4 id=\"putting-it-all-together-a-typical-deep-rl-workflow\">Putting It All Together: a Typical Deep RL Workflow</h4>\n<ol>\n  <li><strong>Select and configure an environment</strong> (e.g., Gym or DMControl).</li>\n  <li><strong>Choose an algorithm and framework</strong> (e.g., PPO via Stable Baselines3).</li>\n  <li><strong>Tune hyperparameters</strong> using Ray Tune or W&amp;B Sweeps.</li>\n  <li><strong>Monitor training progress</strong> using TensorBoard or W&amp;B.</li>\n  <li><strong>Evaluate and visualize performance</strong> through standardized benchmarks.</li>\n  <li><strong>Deploy or transfer learned policies</strong> into real or simulated production systems.</li>\n</ol>\n<ul>\n  <li>This modular workflow streamlines the iterative RL development process, enabling reproducible, scalable experimentation.</li>\n</ul>\n<h4 id=\"comparative-analysis-10\">Comparative Analysis</h4>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Category</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Tool</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Primary Use Case</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Reference</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Simulation</strong></td>\n<td class=\"tg-tleft-valign-first\">OpenAI Gym</td>\n<td class=\"tg-tleft-valign-first\">Benchmark and prototyping</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1606.01540\">Brockman et al., 2016</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Continuous Control</strong></td>\n<td class=\"tg-tleft-valign-first\">DeepMind Control Suite</td>\n<td class=\"tg-tleft-valign-first\">Physics-based training</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1801.00690\">Tassa et al., 2018</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>3D Learning</strong></td>\n<td class=\"tg-tleft-valign-first\">Unity ML-Agents</td>\n<td class=\"tg-tleft-valign-first\">Multi-agent, curriculum tasks</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1809.02627\">Juliani et al., 2018</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Distributed Training</strong></td>\n<td class=\"tg-tleft-valign-first\">RLlib</td>\n<td class=\"tg-tleft-valign-first\">Production-scale workloads</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1712.09381\">Liang et al., 2018</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Research Framework</strong></td>\n<td class=\"tg-tleft-valign-first\">Stable Baselines3</td>\n<td class=\"tg-tleft-valign-first\">Algorithm prototyping</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://github.com/DLR-RM/stable-baselines3\">Raffin et al., 2021</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Visualization</strong></td>\n<td class=\"tg-tleft-valign-first\">W&amp;B, TensorBoard</td>\n<td class=\"tg-tleft-valign-first\">Metrics and debugging</td>\n<td class=\"tg-tleft-valign-second\">‚Äî</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Benchmarking</strong></td>\n<td class=\"tg-tleft-valign-first\">D4RL, Procgen</td>\n<td class=\"tg-tleft-valign-first\">Reproducible evaluation</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/2004.07219\">Fu et al., 2020</a></td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Category</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Tool</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Primary Use Case</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Reference</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Simulation</strong></td>\n<td class=\"tg-tleft-valign-first\">OpenAI Gym</td>\n<td class=\"tg-tleft-valign-first\">Benchmark and prototyping</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1606.01540\">Brockman et al., 2016</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Continuous Control</strong></td>\n<td class=\"tg-tleft-valign-first\">DeepMind Control Suite</td>\n<td class=\"tg-tleft-valign-first\">Physics-based training</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1801.00690\">Tassa et al., 2018</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>3D Learning</strong></td>\n<td class=\"tg-tleft-valign-first\">Unity ML-Agents</td>\n<td class=\"tg-tleft-valign-first\">Multi-agent, curriculum tasks</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1809.02627\">Juliani et al., 2018</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Distributed Training</strong></td>\n<td class=\"tg-tleft-valign-first\">RLlib</td>\n<td class=\"tg-tleft-valign-first\">Production-scale workloads</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/1712.09381\">Liang et al., 2018</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Research Framework</strong></td>\n<td class=\"tg-tleft-valign-first\">Stable Baselines3</td>\n<td class=\"tg-tleft-valign-first\">Algorithm prototyping</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://github.com/DLR-RM/stable-baselines3\">Raffin et al., 2021</a></td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Visualization</strong></td>\n<td class=\"tg-tleft-valign-first\">W&amp;B, TensorBoard</td>\n<td class=\"tg-tleft-valign-first\">Metrics and debugging</td>\n<td class=\"tg-tleft-valign-second\">‚Äî</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Benchmarking</strong></td>\n<td class=\"tg-tleft-valign-first\">D4RL, Procgen</td>\n<td class=\"tg-tleft-valign-first\">Reproducible evaluation</td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/2004.07219\">Fu et al., 2020</a></td>\n</tr>\n</tbody>\n</table>",
    "contentMarkdown": "*   The evolution of Deep RL has been accompanied by an ecosystem of **open-source tools and frameworks** that simplify experimentation, benchmarking, and large-scale deployment. These frameworks abstract away much of the engineering complexity‚Äîsuch as distributed training, environment interfacing, and algorithmic reproducibility‚Äîallowing researchers and practitioners to focus on innovation and application.\n\n#### Simulation and Environment Libraries\n\n*   A well-designed environment is foundational to any RL experiment. The following platforms are widely adopted for training, evaluation, and benchmarking.\n\n##### OpenAI Gym\n\n*   **Reference:** [Brockman et al. (2016)](https://arxiv.org/abs/1606.01540)\n*   **Overview:** The de facto standard for RL environments, offering a unified API for tasks ranging from simple control problems (e.g., _CartPole_) to Atari games and MuJoCo physics-based simulations.\n*   **Features:**\n    \n    *   Consistent step/reset interface: `observation, reward, done, info = env.step(action)`\n    *   Extensive third-party support via custom environments\n    *   Compatibility with Gymnasium (the community-maintained successor)\n\n**Features:**\n\n*   Consistent step/reset interface: `observation, reward, done, info = env.step(action)`\n*   Extensive third-party support via custom environments\n*   Compatibility with Gymnasium (the community-maintained successor)\n\n##### DeepMind Control Suite\n\n*   **Reference:** [Tassa et al. (2018)](https://arxiv.org/abs/1801.00690)\n*   Designed for **continuous control** research, this suite provides physics-accurate environments built on the **MuJoCo** engine.\n*   Often used for benchmarking actor‚Äìcritic methods like DDPG, TD3, and SAC.\n\n##### Unity ML-Agents\n\n*   **Reference:** [Juliani et al. (2018)](https://arxiv.org/abs/1809.02627)\n*   A flexible platform for developing **3D interactive learning environments** using Unity.\n*   Supports both **discrete and continuous** actions and facilitates training in **multi-agent** or **curriculum learning** setups.\n\n##### Meta-World\n\n*   **Reference:** [Yu et al. (2020)](https://arxiv.org/abs/1910.10897)\n*   A benchmark for **meta-RL** and **transfer learning**, consisting of over 50 robotic manipulation tasks sharing a consistent observation and action space.\n*   Enables evaluation of generalization and cross-task adaptation capabilities.\n\n#### Algorithmic Frameworks and Libraries\n\n*   Modern Deep RL frameworks encapsulate key algorithmic components (policy networks, replay buffers, optimizers, and loss functions) while allowing flexible experimentation and large-scale distributed training.\n\n##### Stable Baselines3\n\n*   **Reference:** [Raffin et al. (2021)](https://github.com/DLR-RM/stable-baselines3)\n*   **Overview:** A well-maintained PyTorch reimplementation of popular algorithms (DQN, PPO, A2C, SAC, TD3).\n*   **Advantages:**\n    \n    *   Simple, unified interface: `model = PPO(\"MlpPolicy\", env).learn(1e6)`\n    *   Pretrained policies and logging integrations\n    *   Excellent for reproducible research and small to medium-scale tasks\n\n**Advantages:**\n\n*   Simple, unified interface: `model = PPO(\"MlpPolicy\", env).learn(1e6)`\n*   Pretrained policies and logging integrations\n*   Excellent for reproducible research and small to medium-scale tasks\n\n##### RLlib (Ray)\n\n*   **Reference:** [Liang et al. (2018)](https://arxiv.org/abs/1712.09381)\n*   A production-grade distributed RL framework built on **Ray**.\n*   **Highlights:**\n    \n    *   Supports large-scale distributed training (e.g., IMPALA, Ape-X, R2D2)\n    *   Integrated hyperparameter tuning with **Ray Tune**\n    *   Seamless scaling from local machines to cloud clusters\n\n**Highlights:**\n\n*   Supports large-scale distributed training (e.g., IMPALA, Ape-X, R2D2)\n*   Integrated hyperparameter tuning with **Ray Tune**\n*   Seamless scaling from local machines to cloud clusters\n\n##### TensorFlow Agents (TF-Agents)\n\n*   **Reference:** [TF-Agents Documentation](https://www.tensorflow.org/agents)\n*   Modular TensorFlow-based library for composing RL pipelines with reusable building blocks (agents, networks, policies, drivers).\n*   Ideal for Google Cloud and TensorFlow ecosystem users.\n\n##### Acme\n\n*   **Reference:** [Hoffman et al. (2020)](https://arxiv.org/abs/2006.00979)\n*   Developed by DeepMind for scalable, research-friendly RL experimentation.\n*   Implements a flexible component-based architecture with abstractions like _actors_, _learners_, and _environment loops_, inspired by real-world production needs.\n\n#### Visualization, Debugging, and Monitoring Tools\n\n*   Effective training of Deep RL models requires continuous monitoring of rewards, losses, and policy stability.\n\n**Tool**\n\n**Functionality**\n\n**Integration**\n\n**TensorBoard**\n\nVisualizes scalar metrics, histograms, and computational graphs\n\nNative in TF-Agents and RLlib\n\n**Weights & Biases (W&B)**\n\nExperiment tracking, hyperparameter sweeps, and visual dashboards\n\nPlug-in for Stable Baselines3 and PyTorch RL\n\n**Neptune.ai**\n\nCollaborative experiment management\n\nIntegrates with custom PyTorch/TensorFlow code\n\n**Gym Monitor / MoviePy**\n\nRenders episode videos for qualitative evaluation\n\nUseful for policy interpretability\n\n**Tool**\n\n**Functionality**\n\n**Integration**\n\n**TensorBoard**\n\nVisualizes scalar metrics, histograms, and computational graphs\n\nNative in TF-Agents and RLlib\n\n**Weights & Biases (W&B)**\n\nExperiment tracking, hyperparameter sweeps, and visual dashboards\n\nPlug-in for Stable Baselines3 and PyTorch RL\n\n**Neptune.ai**\n\nCollaborative experiment management\n\nIntegrates with custom PyTorch/TensorFlow code\n\n**Gym Monitor / MoviePy**\n\nRenders episode videos for qualitative evaluation\n\nUseful for policy interpretability\n\n*   These tools make it easier to interpret agent behaviors, detect mode collapse, and fine-tune learning schedules.\n\n#### Distributed Training and Cloud Deployment\n\n*   Scaling RL beyond local experiments often requires **cloud-based training pipelines**. Modern frameworks support distributed execution and resource orchestration via:\n    \n    *   **Ray Cluster / RLlib** for multi-node actor‚Äìlearner training\n    *   **Kubernetes** for container orchestration\n    *   **Vertex AI**, **AWS SageMaker**, and **Azure ML** for managed distributed compute\n    *   **Weights & Biases Sweeps** for large-scale hyperparameter optimization\n*   Combining these systems enables real-time experimentation, model checkpointing, and rollout aggregation across hundreds of simulated agents‚Äîessential for complex, non-stationary environments.\n    \n\nScaling RL beyond local experiments often requires **cloud-based training pipelines**. Modern frameworks support distributed execution and resource orchestration via:\n\n*   **Ray Cluster / RLlib** for multi-node actor‚Äìlearner training\n*   **Kubernetes** for container orchestration\n*   **Vertex AI**, **AWS SageMaker**, and **Azure ML** for managed distributed compute\n*   **Weights & Biases Sweeps** for large-scale hyperparameter optimization\n\nCombining these systems enables real-time experimentation, model checkpointing, and rollout aggregation across hundreds of simulated agents‚Äîessential for complex, non-stationary environments.\n\n#### Benchmark Suites and Evaluation Protocols\n\n*   Benchmarking ensures fair and reproducible evaluation across methods.\n*   Prominent benchmarks include:\n    \n    *   **Atari 2600 Suite** ([Bellemare et al., 2013](https://arxiv.org/abs/1305.4208)): evaluates discrete-action performance and exploration strategies.\n    *   **DeepMind Control Suite**: tests continuous control robustness.\n    *   **Procgen Benchmark** ([Cobbe et al., 2019](https://arxiv.org/abs/1912.01588)): measures generalization to unseen procedural environments.\n    *   **Meta-World and D4RL** ([Fu et al., 2020](https://arxiv.org/abs/2004.07219)): assess offline and transfer learning capabilities.\n*   Adhering to standardized evaluation protocols fosters comparability and reproducibility in Deep RL research.\n\nProminent benchmarks include:\n\n*   **Atari 2600 Suite** ([Bellemare et al., 2013](https://arxiv.org/abs/1305.4208)): evaluates discrete-action performance and exploration strategies.\n*   **DeepMind Control Suite**: tests continuous control robustness.\n*   **Procgen Benchmark** ([Cobbe et al., 2019](https://arxiv.org/abs/1912.01588)): measures generalization to unseen procedural environments.\n*   **Meta-World and D4RL** ([Fu et al., 2020](https://arxiv.org/abs/2004.07219)): assess offline and transfer learning capabilities.\n\n#### Putting It All Together: a Typical Deep RL Workflow\n\n1.  **Select and configure an environment** (e.g., Gym or DMControl).\n2.  **Choose an algorithm and framework** (e.g., PPO via Stable Baselines3).\n3.  **Tune hyperparameters** using Ray Tune or W&B Sweeps.\n4.  **Monitor training progress** using TensorBoard or W&B.\n5.  **Evaluate and visualize performance** through standardized benchmarks.\n6.  **Deploy or transfer learned policies** into real or simulated production systems.\n\n*   This modular workflow streamlines the iterative RL development process, enabling reproducible, scalable experimentation.\n\n#### Comparative Analysis\n\n**Category**\n\n**Tool**\n\n**Primary Use Case**\n\n**Reference**\n\n**Simulation**\n\nOpenAI Gym\n\nBenchmark and prototyping\n\n[Brockman et al., 2016](https://arxiv.org/abs/1606.01540)\n\n**Continuous Control**\n\nDeepMind Control Suite\n\nPhysics-based training\n\n[Tassa et al., 2018](https://arxiv.org/abs/1801.00690)\n\n**3D Learning**\n\nUnity ML-Agents\n\nMulti-agent, curriculum tasks\n\n[Juliani et al., 2018](https://arxiv.org/abs/1809.02627)\n\n**Distributed Training**\n\nRLlib\n\nProduction-scale workloads\n\n[Liang et al., 2018](https://arxiv.org/abs/1712.09381)\n\n**Research Framework**\n\nStable Baselines3\n\nAlgorithm prototyping\n\n[Raffin et al., 2021](https://github.com/DLR-RM/stable-baselines3)\n\n**Visualization**\n\nW&B, TensorBoard\n\nMetrics and debugging\n\n‚Äî\n\n**Benchmarking**\n\nD4RL, Procgen\n\nReproducible evaluation\n\n[Fu et al., 2020](https://arxiv.org/abs/2004.07219)\n\n**Category**\n\n**Tool**\n\n**Primary Use Case**\n\n**Reference**\n\n**Simulation**\n\nOpenAI Gym\n\nBenchmark and prototyping\n\n[Brockman et al., 2016](https://arxiv.org/abs/1606.01540)\n\n**Continuous Control**\n\nDeepMind Control Suite\n\nPhysics-based training\n\n[Tassa et al., 2018](https://arxiv.org/abs/1801.00690)\n\n**3D Learning**\n\nUnity ML-Agents\n\nMulti-agent, curriculum tasks\n\n[Juliani et al., 2018](https://arxiv.org/abs/1809.02627)\n\n**Distributed Training**\n\nRLlib\n\nProduction-scale workloads\n\n[Liang et al., 2018](https://arxiv.org/abs/1712.09381)\n\n**Research Framework**\n\nStable Baselines3\n\nAlgorithm prototyping\n\n[Raffin et al., 2021](https://github.com/DLR-RM/stable-baselines3)\n\n**Visualization**\n\nW&B, TensorBoard\n\nMetrics and debugging\n\n‚Äî\n\n**Benchmarking**\n\nD4RL, Procgen\n\nReproducible evaluation\n\n[Fu et al., 2020](https://arxiv.org/abs/2004.07219)",
    "order": 22,
    "orderInChapter": 14,
    "difficulty": 5,
    "estimatedMinutes": 6,
    "tags": [
      "algorithmsarchitecture",
      "optimization",
      "loss function",
      "transfer learning"
    ],
    "metadata": {
      "hasCode": true,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 1197,
      "contentLength": 18399
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#tools-and-frameworks-for-deep-reinforcement-learning",
    "scrapedAt": "2025-12-28T11:47:08.461Z"
  },
  {
    "id": "ai-reinforcement-learning-model-roles-23",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Policy Optimization for LLMs",
    "title": "Model Roles",
    "subtitle": "Policy Optimization for LLMs",
    "contentHtml": "<ul>\n  <li>\n    <p>To implement the RLHF pipeline effectively, several models are employed in distinct but interdependent roles. Each contributes to a part of the reward-driven learning loop, from generating responses to evaluating and optimizing them:</p>\n\n    <ul>\n      <li>\n        <p><strong>Policy model</strong>: The main LLM we wish to optimize (parameterized by <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-263-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4486\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4487\"><span class=\"mi\" id=\"MathJax-Span-4488\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ∏</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-263\">\\theta</script>). It functions as the environment‚Äôs actor, generating responses, and is fine-tuned via policy optimization techniques (e.g., PPO).</p>\n      </li>\n      <li>\n        <p><strong>Reference model</strong>: A frozen or slowly-updated baseline version of the policy (or a supervised fine-tuned model) used to compute KL or likelihood penalties to ensure the optimized policy does not diverge too far from acceptable behaviours.</p>\n      </li>\n      <li>\n        <p><strong>Value model</strong>: A model that estimates the expected return (value) of a given prompt-response pair or sequence, often used to compute advantage estimates in actor‚Äìcritic style updates.</p>\n      </li>\n      <li>\n        <p><strong>Reward model</strong>: A separate model trained (often via human preference data or comparisons) to map a prompt-response pair <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-264-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4489\" style=\"width: 2.607em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.09em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4490\"><span class=\"mo\" id=\"MathJax-Span-4491\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4492\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4493\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4494\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-4495\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-264\">(x,y)</script> to a scalar reward <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-265-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4496\" style=\"width: 2.971em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.4em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4497\"><span class=\"mi\" id=\"MathJax-Span-4498\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4499\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4500\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4501\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4502\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-4503\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-265\">r(x,y)</script>. It encapsulates human or designer preferences and drives the optimization of the policy model.</p>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>In typical LLM fine-tuning pipelines, the flow is:</p>\n\n    <ol>\n      <li>The <strong>policy model</strong> generates responses.</li>\n      <li>The <strong>reward model</strong> scores them.</li>\n      <li>The <strong>value model</strong> estimates future return or baseline.</li>\n      <li>A <strong>reference model</strong> imposes a divergence penalty or acts as a safe anchor.</li>\n      <li>Using a policy-optimization algorithm (e.g., Proximal Policy Optimization) the policy model is updated to <strong>increase</strong> rewards <strong>while constraining</strong> divergence from the reference.</li>\n    </ol>\n  </li>\n  <li>\n    <p>Refer <em>Fine-Tuning Language Models with Reward Learning on Policy</em> by <a href=\"https://arxiv.org/abs/2403.19279\">Lang et al. (2024)</a> for a more formal treatment.</p>\n  </li>\n</ul>\n<p>To implement the RLHF pipeline effectively, several models are employed in distinct but interdependent roles. Each contributes to a part of the reward-driven learning loop, from generating responses to evaluating and optimizing them:</p>\n<ul>\n      <li>\n        <p><strong>Policy model</strong>: The main LLM we wish to optimize (parameterized by <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-263-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4486\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4487\"><span class=\"mi\" id=\"MathJax-Span-4488\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ∏</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-263\">\\theta</script>). It functions as the environment‚Äôs actor, generating responses, and is fine-tuned via policy optimization techniques (e.g., PPO).</p>\n      </li>\n      <li>\n        <p><strong>Reference model</strong>: A frozen or slowly-updated baseline version of the policy (or a supervised fine-tuned model) used to compute KL or likelihood penalties to ensure the optimized policy does not diverge too far from acceptable behaviours.</p>\n      </li>\n      <li>\n        <p><strong>Value model</strong>: A model that estimates the expected return (value) of a given prompt-response pair or sequence, often used to compute advantage estimates in actor‚Äìcritic style updates.</p>\n      </li>\n      <li>\n        <p><strong>Reward model</strong>: A separate model trained (often via human preference data or comparisons) to map a prompt-response pair <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-264-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4489\" style=\"width: 2.607em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.09em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4490\"><span class=\"mo\" id=\"MathJax-Span-4491\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4492\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4493\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4494\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-4495\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-264\">(x,y)</script> to a scalar reward <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-265-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4496\" style=\"width: 2.971em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.4em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4497\"><span class=\"mi\" id=\"MathJax-Span-4498\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4499\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4500\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4501\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4502\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-4503\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-265\">r(x,y)</script>. It encapsulates human or designer preferences and drives the optimization of the policy model.</p>\n      </li>\n    </ul>\n<p><strong>Policy model</strong>: The main LLM we wish to optimize (parameterized by <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-263-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4486\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4487\"><span class=\"mi\" id=\"MathJax-Span-4488\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ∏</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-263\">\\theta</script>). It functions as the environment‚Äôs actor, generating responses, and is fine-tuned via policy optimization techniques (e.g., PPO).</p>\n<p><strong>Reference model</strong>: A frozen or slowly-updated baseline version of the policy (or a supervised fine-tuned model) used to compute KL or likelihood penalties to ensure the optimized policy does not diverge too far from acceptable behaviours.</p>\n<p><strong>Value model</strong>: A model that estimates the expected return (value) of a given prompt-response pair or sequence, often used to compute advantage estimates in actor‚Äìcritic style updates.</p>\n<p><strong>Reward model</strong>: A separate model trained (often via human preference data or comparisons) to map a prompt-response pair <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-264-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4489\" style=\"width: 2.607em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.09em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4490\"><span class=\"mo\" id=\"MathJax-Span-4491\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4492\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4493\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4494\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-4495\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-264\">(x,y)</script> to a scalar reward <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-265-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4496\" style=\"width: 2.971em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.4em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4497\"><span class=\"mi\" id=\"MathJax-Span-4498\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4499\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4500\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4501\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4502\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-4503\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-265\">r(x,y)</script>. It encapsulates human or designer preferences and drives the optimization of the policy model.</p>\n<p>In typical LLM fine-tuning pipelines, the flow is:</p>\n<ol>\n      <li>The <strong>policy model</strong> generates responses.</li>\n      <li>The <strong>reward model</strong> scores them.</li>\n      <li>The <strong>value model</strong> estimates future return or baseline.</li>\n      <li>A <strong>reference model</strong> imposes a divergence penalty or acts as a safe anchor.</li>\n      <li>Using a policy-optimization algorithm (e.g., Proximal Policy Optimization) the policy model is updated to <strong>increase</strong> rewards <strong>while constraining</strong> divergence from the reference.</li>\n    </ol>\n<p>Refer <em>Fine-Tuning Language Models with Reward Learning on Policy</em> by <a href=\"https://arxiv.org/abs/2403.19279\">Lang et al. (2024)</a> for a more formal treatment.</p>\n<h4 id=\"policy-model\">Policy Model</h4>\n<ul>\n  <li>The <strong>policy model</strong> in an RLHF‚Äìstyle setup is the LLM that we treat as a policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-266-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4504\" style=\"width: 4.221em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.492em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.44em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4505\"><span class=\"msubsup\" id=\"MathJax-Span-4506\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4507\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-4508\"><span class=\"mrow\" id=\"MathJax-Span-4509\"><span class=\"mi\" id=\"MathJax-Span-4510\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4511\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4512\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-4513\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4514\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4515\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>Œ∏</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-266\">\\pi_{\\theta} (y \\mid x)</script>, parameterized by <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-267-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B8;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4516\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4517\"><span class=\"mi\" id=\"MathJax-Span-4518\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ∏</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-267\">\\theta</script>, which given an input prompt <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-268-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4519\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4520\"><span class=\"mi\" id=\"MathJax-Span-4521\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-268\">x</script> produces a response <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-269-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4522\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4523\"><span class=\"mi\" id=\"MathJax-Span-4524\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-269\">y</script>. This section covers its function, typical architecture, training data, and model size considerations.</li>\n  <li>The policy model is the central actor in the RLHF pipeline: it generates responses to prompts and is updated to align with human preferences. It carries the full representational capacity of a large LLM architecture, is trained in multiple phases (pretraining <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-270-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4525\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4526\"><span class=\"mo\" id=\"MathJax-Span-4527\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-270\">\\rightarrow</script> SFT <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-271-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4528\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4529\"><span class=\"mo\" id=\"MathJax-Span-4530\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-271\">\\rightarrow</script> RLHF), and must be large enough to enable high-quality responses while still being trainable. Its design must support computing log-probabilities, KL divergences, and synergy with reward/value models.</li>\n</ul>\n<h5 id=\"function\">Function</h5>\n<ul>\n  <li>The policy model is the <strong>agent</strong> that interacts with the ‚Äúenvironment‚Äù by generating outputs (responses <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-272-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4531\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4532\"><span class=\"mi\" id=\"MathJax-Span-4533\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-272\">y</script>) to prompts <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-273-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4534\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4535\"><span class=\"mi\" id=\"MathJax-Span-4536\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-273\">x</script>.</li>\n  <li>Its objective is to maximize a <strong>reward signal</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-274-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4537\" style=\"width: 2.971em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.4em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4538\"><span class=\"mi\" id=\"MathJax-Span-4539\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4540\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4541\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4542\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4543\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-4544\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-274\">r(x,y)</script>, subject to constraints or regularization (for example via KL-divergence to a reference policy).</li>\n  <li>\n    <p>Formally, the objective can be written as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-275-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></munder><mo>;</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi><mo>&amp;#x223C;</mo><msub><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>m</mi><mi mathvariant=&quot;normal&quot;>p</mi><mi mathvariant=&quot;normal&quot;>t</mi></mrow></msub><mo>,</mo><mi>y</mi><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;>[</mo></mrow><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>&amp;#x03B2;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>K</mi><mi mathvariant=&quot;normal&quot;>L</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>(</mo></mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>&amp;#x2016;</mo><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>f</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4545\" style=\"width: 28.284em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 23.544em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.138em, 1023.34em, 4.43em, -999.997em); top: -3.487em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4546\"><span class=\"munderover\" id=\"MathJax-Span-4547\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4548\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.273em, -999.997em); top: -3.331em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-4549\"><span class=\"mrow\" id=\"MathJax-Span-4550\"><span class=\"mi\" id=\"MathJax-Span-4551\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4552\" style=\"font-family: STIXGeneral-Regular;\">;</span><span class=\"msubsup\" id=\"MathJax-Span-4553\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 6.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4554\"><span class=\"mrow\" id=\"MathJax-Span-4555\"><span class=\"mi\" id=\"MathJax-Span-4556\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-4557\"><span class=\"mrow\" id=\"MathJax-Span-4558\"><span class=\"mi\" id=\"MathJax-Span-4559\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4560\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"msubsup\" id=\"MathJax-Span-4561\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4562\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">D</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-4563\"><span class=\"mrow\" id=\"MathJax-Span-4564\"><span class=\"mi\" id=\"MathJax-Span-4565\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">p</span><span class=\"mi\" id=\"MathJax-Span-4566\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-4567\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">o</span><span class=\"mi\" id=\"MathJax-Span-4568\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">m</span><span class=\"mi\" id=\"MathJax-Span-4569\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">p</span><span class=\"mi\" id=\"MathJax-Span-4570\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4571\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4572\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-4573\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"msubsup\" id=\"MathJax-Span-4574\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4575\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4576\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4577\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-4578\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-4579\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4580\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4581\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-4582\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-4583\"><span class=\"mo\" id=\"MathJax-Span-4584\" style=\"vertical-align: -0.414em;\"><span style=\"font-family: STIXSizeTwoSym;\">[</span></span></span></span><span class=\"mi\" id=\"MathJax-Span-4585\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4586\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4587\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4588\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4589\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-4590\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4591\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-4592\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"texatom\" id=\"MathJax-Span-4593\"><span class=\"mrow\" id=\"MathJax-Span-4594\"><span class=\"mi\" id=\"MathJax-Span-4595\" style=\"font-family: STIXGeneral-Regular;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-4596\" style=\"font-family: STIXGeneral-Regular;\">L</span></span></span><span class=\"texatom\" id=\"MathJax-Span-4597\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-4598\"><span class=\"mo\" id=\"MathJax-Span-4599\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">(</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-4600\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4601\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4602\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4603\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-4604\" style=\"font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-4605\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4606\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4607\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4608\" style=\"font-family: STIXGeneral-Regular;\">‚Äñ</span><span class=\"msubsup\" id=\"MathJax-Span-4609\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4610\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-4611\"><span class=\"mrow\" id=\"MathJax-Span-4612\"><span class=\"mi\" id=\"MathJax-Span-4613\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-4614\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-4615\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4616\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-4617\" style=\"font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-4618\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4619\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4620\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-4621\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-4622\"><span class=\"mo\" id=\"MathJax-Span-4623\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">)</span></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-4624\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-4625\"><span class=\"mo\" id=\"MathJax-Span-4626\" style=\"vertical-align: -0.414em;\"><span style=\"font-family: STIXSizeTwoSym;\">]</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.492em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.997em; border-left: 0px solid; width: 0px; height: 2.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>Œ∏</mi></mrow></munder><mo>;</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>x</mi><mo>‚àº</mo><msub><mi>D</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">p</mi><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">p</mi><mi mathvariant=\"normal\">t</mi></mrow></msub><mo>,</mo><mi>y</mi><mo>‚àº</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.623em\" minsize=\"1.623em\">[</mo></mrow><mi>r</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mi>Œ≤</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">K</mi><mi mathvariant=\"normal\">L</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo></mrow><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo fence=\"false\" stretchy=\"false\">‚Äñ</mo><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.623em\" minsize=\"1.623em\">]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-275\">\\max_{\\theta}; \\mathbb{E}_{x\\sim D_{\\rm prompt},y\\sim\\pi_\\theta(\\cdot\\mid x)}\\Big[r(x,y) - \\beta\\mathrm{KL}\\big(\\pi_\\theta(\\cdot\\mid x) \\Vert \\pi_{\\rm ref}(\\cdot\\mid x)\\big)\\Big]</script>\n\n    <ul>\n      <li>\n        <p>where:</p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-276-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4627\" style=\"width: 2.971em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.4em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4628\"><span class=\"mi\" id=\"MathJax-Span-4629\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4630\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4631\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4632\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4633\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-4634\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-276\">r(x,y)</script>: reward signal from human preference or a learned reward model</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-277-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>f</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4635\" style=\"width: 1.721em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.41em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4636\"><span class=\"msubsup\" id=\"MathJax-Span-4637\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4638\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-4639\"><span class=\"mrow\" id=\"MathJax-Span-4640\"><span class=\"mi\" id=\"MathJax-Span-4641\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-4642\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-4643\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-277\">\\pi_{\\rm ref}</script>: reference (often supervised-finetuned) policy</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-278-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4644\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4645\"><span class=\"mi\" id=\"MathJax-Span-4646\" style=\"font-family: STIXGeneral-Italic;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≤</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-278\">\\beta</script>: KL regularization coefficient balancing reward maximization and divergence from the reference policy</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>During training, the policy model generates responses, receives reward model scores or value-model feedback, and is updated (often via algorithms like Proximal Policy Optimization). The policy model thus evolves from a ‚Äúsupervised fine-tuned‚Äù base model into a behaviour-aligned model.</li>\n  <li>The policy model must balance <strong>helpfulness</strong>, <strong>accuracy</strong>, <strong>safety</strong>, and <strong>alignment</strong> (for example to human preferences). See, for example, the instruct-tuning phase described in <a href=\"https://arxiv.org/abs/2203.02155\">Ouyang et al. (2022)</a> (‚ÄúTraining language models to follow instructions with human feedback‚Äù).</li>\n</ul>\n<p>Formally, the objective can be written as:</p>\n<ul>\n      <li>\n        <p>where:</p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-276-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4627\" style=\"width: 2.971em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.4em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4628\"><span class=\"mi\" id=\"MathJax-Span-4629\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4630\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4631\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4632\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4633\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-4634\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-276\">r(x,y)</script>: reward signal from human preference or a learned reward model</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-277-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>f</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4635\" style=\"width: 1.721em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.41em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4636\"><span class=\"msubsup\" id=\"MathJax-Span-4637\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4638\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-4639\"><span class=\"mrow\" id=\"MathJax-Span-4640\"><span class=\"mi\" id=\"MathJax-Span-4641\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-4642\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-4643\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-277\">\\pi_{\\rm ref}</script>: reference (often supervised-finetuned) policy</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-278-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4644\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4645\"><span class=\"mi\" id=\"MathJax-Span-4646\" style=\"font-family: STIXGeneral-Italic;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≤</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-278\">\\beta</script>: KL regularization coefficient balancing reward maximization and divergence from the reference policy</li>\n        </ul>\n      </li>\n    </ul>\n<p>where:</p>\n<ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-276-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4627\" style=\"width: 2.971em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.4em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4628\"><span class=\"mi\" id=\"MathJax-Span-4629\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4630\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4631\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4632\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4633\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-4634\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-276\">r(x,y)</script>: reward signal from human preference or a learned reward model</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-277-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>f</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4635\" style=\"width: 1.721em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.41em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4636\"><span class=\"msubsup\" id=\"MathJax-Span-4637\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4638\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-4639\"><span class=\"mrow\" id=\"MathJax-Span-4640\"><span class=\"mi\" id=\"MathJax-Span-4641\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-4642\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-4643\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-277\">\\pi_{\\rm ref}</script>: reference (often supervised-finetuned) policy</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-278-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4644\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4645\"><span class=\"mi\" id=\"MathJax-Span-4646\" style=\"font-family: STIXGeneral-Italic;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≤</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-278\">\\beta</script>: KL regularization coefficient balancing reward maximization and divergence from the reference policy</li>\n        </ul>\n<h5 id=\"architecture\">Architecture</h5>\n<ul>\n  <li>The policy model is typically a <strong>causal (autoregressive) transformer</strong> with large scale: e.g., dozens of layers, high hidden dimensionality, multi-head self-attention, positional embeddings, etc.</li>\n  <li>Initially pretrained on massive corpora of text. Then often fine-tuned via supervised fine-tuning (SFT) on instruction‚Äìresponse pairs.</li>\n  <li>For RLHF, a further head or mechanism may be added or used for value/advantage estimation, but the core remains the transformer.</li>\n  <li>Recent work sometimes uses <strong>parameter efficient tuning</strong> (e.g., LoRA, adapters) to limit full-model updates during RL optimisation.</li>\n  <li>The architecture must support sampling from <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-279-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4647\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4648\"><span class=\"msubsup\" id=\"MathJax-Span-4649\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4650\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4651\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-279\">\\pi_\\theta</script>, computing log-probabilities <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-280-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>log</mi><mo>&amp;#x2061;</mo><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4652\" style=\"width: 6.044em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.003em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1004.95em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4653\"><span class=\"mi\" id=\"MathJax-Span-4654\" style=\"font-family: STIXGeneral-Regular;\">log</span><span class=\"mo\" id=\"MathJax-Span-4655\"></span><span class=\"msubsup\" id=\"MathJax-Span-4656\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4657\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-4658\"><span class=\"mrow\" id=\"MathJax-Span-4659\"><span class=\"mi\" id=\"MathJax-Span-4660\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4661\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4662\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-4663\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4664\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4665\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>log</mi><mo>‚Å°</mo><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>Œ∏</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-280\">\\log \\pi_{\\theta} (y \\mid x)</script>, and computing KL divergence between <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-281-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4666\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4667\"><span class=\"msubsup\" id=\"MathJax-Span-4668\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4669\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4670\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-281\">\\pi_\\theta</script> and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-282-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>f</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4671\" style=\"width: 1.721em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.41em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4672\"><span class=\"msubsup\" id=\"MathJax-Span-4673\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4674\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-4675\"><span class=\"mrow\" id=\"MathJax-Span-4676\"><span class=\"mi\" id=\"MathJax-Span-4677\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-4678\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-4679\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-282\">\\pi_{\\rm ref}</script>.</li>\n  <li>For instance, <em>Fine-Tuning Language Models with Reward Learning on Policy</em> by <a href=\"https://arxiv.org/abs/2403.19279\">Lang et al. (2024)</a> explores how the policy model interacts with a reward model under RLHF.</li>\n</ul>\n<h5 id=\"training-data\">Training Data</h5>\n<ul>\n  <li><strong>Pretraining</strong>: The policy model is first trained on large unlabeled text corpora (e.g., hundreds of billions to trillions of tokens).</li>\n  <li><strong>Supervised Fine-Tuning (SFT)</strong>: Instruction‚Äìresponse pairs collected from humans or human-augmented data; e.g., prompts with ‚Äúgood‚Äù responses. Many alignment pipelines begin with this stage to provide a reasonable starting policy.</li>\n  <li><strong>RL Finetuning</strong>: The model generates responses to prompts; responses are scored (via reward model or human ranking). This prompt‚Äìresponse‚Äìreward dataset is used in the reinforcement signal. Because the distribution of responses changes as <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-283-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4680\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4681\"><span class=\"msubsup\" id=\"MathJax-Span-4682\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4683\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-4684\"><span class=\"mrow\" id=\"MathJax-Span-4685\"><span class=\"mi\" id=\"MathJax-Span-4686\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>Œ∏</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-283\">\\pi_{\\theta}</script> updates, continuing to sample from updated policy is important.</li>\n  <li><strong>Replay / Off-Policy Data</strong>: Some pipelines incorporate past responses and reward scores into replay buffers or datasets for stability and reuse.</li>\n  <li>Training the policy model via RL typically uses batches of prompt‚Äìresponse pairs, plus log-probabilities of responses under both <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-284-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4687\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4688\"><span class=\"msubsup\" id=\"MathJax-Span-4689\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4690\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-4691\"><span class=\"mrow\" id=\"MathJax-Span-4692\"><span class=\"mi\" id=\"MathJax-Span-4693\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>Œ∏</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-284\">\\pi_{\\theta}</script> and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-285-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>r</mi><mi mathvariant=&quot;normal&quot;>e</mi><mi mathvariant=&quot;normal&quot;>f</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4694\" style=\"width: 1.721em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.41em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4695\"><span class=\"msubsup\" id=\"MathJax-Span-4696\"><span style=\"display: inline-block; position: relative; width: 1.409em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4697\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-4698\"><span class=\"mrow\" id=\"MathJax-Span-4699\"><span class=\"mi\" id=\"MathJax-Span-4700\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-4701\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">e</span><span class=\"mi\" id=\"MathJax-Span-4702\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">r</mi><mi mathvariant=\"normal\">e</mi><mi mathvariant=\"normal\">f</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-285\">\\pi_{\\rm ref}</script>, plus the advantage estimate from a value model.</li>\n  <li><strong>Note:</strong> Human preference data (for reward model) is often relatively small compared to the pretraining corpus; the RL step amplifies it via policy-generated samples.</li>\n</ul>\n<h5 id=\"typical-model-size\">Typical Model Size</h5>\n<ul>\n  <li>The policy model used in RLHF pipelines tends to be <strong>large</strong> (tens of billions of parameters or more) to provide strong language understanding and generation capabilities.</li>\n  <li>For example, many state-of-the-art systems use models in the 7B‚Äì70B parameter range or larger (100B+).</li>\n  <li>During SFT and then RLHF, often only the base model (e.g., 20B‚Äì70B) is used, to manage compute cost and stability. For example, the InstructGPT series used the GPT-3 175B model for SFT, then RLHF. (See <a href=\"https://arxiv.org/abs/2203.02155\">Ouyang et al. (2022)</a>).</li>\n  <li>In practice, training or fine-tuning such large policy models via RL requires specialized distributed compute, large memory, and careful hyper-parameter tuning.</li>\n</ul>\n<h4 id=\"reference-model\">Reference Model</h4>\n<ul>\n  <li>The <strong>reference model</strong> (also sometimes called the <strong>anchor model</strong>) is a fixed or slowly updated copy of the policy model used as a <em>baseline</em> or <em>constraint</em> in RLHF and related policy optimization setups for LLMs. Its primary purpose is to ensure that the updated policy model remains <strong>linguistically coherent</strong>, <strong>safe</strong>, and <strong>semantically aligned</strong> with the pre-RL distribution, while still learning to maximize the new reward signal. Put simply, the reference model plays a crucial safety and stability role in RLHF. It anchors the optimization process by maintaining linguistic and factual consistency, ensuring that policy optimization leads to meaningful alignment rather than degenerate exploration.</li>\n</ul>\n<h5 id=\"function-1\">Function</h5>\n<ul>\n  <li>The reference model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-286-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>ref</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4703\" style=\"width: 4.69em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.909em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.86em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4704\"><span class=\"msubsup\" id=\"MathJax-Span-4705\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4706\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-4707\"><span class=\"mrow\" id=\"MathJax-Span-4708\"><span class=\"mtext\" id=\"MathJax-Span-4709\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">ref</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4710\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4711\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-4712\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4713\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4714\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>ref</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-286\">\\pi_{\\text{ref}}(y \\mid x)</script> acts as a <strong>stability regulator</strong> during the reinforcement learning phase.\n    <ul>\n      <li>\n        <p>It appears in the <strong>KL-divergence regularization term</strong> in the RL objective:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-287-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi><mo>,</mo><mi>y</mi><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>&amp;#x03B2;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>K</mi><mi mathvariant=&quot;normal&quot;>L</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>&amp;#x2016;</mo><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>ref</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4715\" style=\"width: 24.065em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 20.055em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.086em, 1019.85em, 3.753em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4716\"><span class=\"mi\" id=\"MathJax-Span-4717\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4718\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4719\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4720\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4721\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-4722\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4723\"><span class=\"mrow\" id=\"MathJax-Span-4724\"><span class=\"mi\" id=\"MathJax-Span-4725\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-4726\"><span class=\"mrow\" id=\"MathJax-Span-4727\"><span class=\"mi\" id=\"MathJax-Span-4728\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4729\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4730\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-4731\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"msubsup\" id=\"MathJax-Span-4732\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4733\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4734\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-4735\"><span class=\"mrow\" id=\"MathJax-Span-4736\"><span class=\"mo\" id=\"MathJax-Span-4737\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-4738\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4739\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4740\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4741\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4742\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-4743\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4744\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-4745\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"texatom\" id=\"MathJax-Span-4746\"><span class=\"mrow\" id=\"MathJax-Span-4747\"><span class=\"mi\" id=\"MathJax-Span-4748\" style=\"font-family: STIXGeneral-Regular;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-4749\" style=\"font-family: STIXGeneral-Regular;\">L</span></span></span><span class=\"mo\" id=\"MathJax-Span-4750\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4751\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4752\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4753\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4754\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-4755\" style=\"font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-4756\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4757\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4758\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4759\" style=\"font-family: STIXGeneral-Regular;\">‚Äñ</span><span class=\"msubsup\" id=\"MathJax-Span-4760\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4761\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-4762\"><span class=\"mrow\" id=\"MathJax-Span-4763\"><span class=\"mtext\" id=\"MathJax-Span-4764\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">ref</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4765\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-4766\" style=\"font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-4767\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4768\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4769\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4770\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-4771\"><span class=\"mrow\" id=\"MathJax-Span-4772\"><span class=\"mo\" id=\"MathJax-Span-4773\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>J</mi><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>x</mi><mo>,</mo><mi>y</mi><mo>‚àº</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">[</mo></mrow><mi>r</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mi>Œ≤</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">K</mi><mi mathvariant=\"normal\">L</mi></mrow><mo stretchy=\"false\">(</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo fence=\"false\" stretchy=\"false\">‚Äñ</mo><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>ref</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-287\">J(\\theta) = \\mathbb{E}_{x,y \\sim \\pi_\\theta}\n\\big[\nr(x,y) - \\beta \\mathrm{KL}(\\pi_\\theta(\\cdot \\mid x) \\Vert \\pi_{\\text{ref}}(\\cdot \\mid x))\n\\big]</script>\n\n        <ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-288-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4774\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4775\"><span class=\"msubsup\" id=\"MathJax-Span-4776\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4777\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4778\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-288\">\\pi_\\theta</script> is the policy model being optimized, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-289-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4779\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4780\"><span class=\"mi\" id=\"MathJax-Span-4781\" style=\"font-family: STIXGeneral-Italic;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≤</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-289\">\\beta</script> is a scaling factor.</li>\n        </ul>\n      </li>\n      <li>\n        <p>The KL term penalizes deviations from the reference model distribution, preventing <strong>mode collapse</strong>, <strong>reward hacking</strong>, or <strong>drift</strong> into incoherent or unfaithful responses.</p>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>Conceptually, the reference model anchors the optimization so that:</p>\n\n    <ul>\n      <li>The policy model can explore higher-reward regions of response space.</li>\n      <li>But does not diverge too far from its pretrained linguistic and factual priors.</li>\n    </ul>\n  </li>\n  <li>In practice, the reference model helps maintain <strong>fluency</strong>, <strong>truthfulness</strong>, and <strong>diversity</strong> of outputs throughout training.</li>\n</ul>\n<ul>\n      <li>\n        <p>It appears in the <strong>KL-divergence regularization term</strong> in the RL objective:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-287-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi><mo>,</mo><mi>y</mi><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>&amp;#x03B2;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>K</mi><mi mathvariant=&quot;normal&quot;>L</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>&amp;#x2016;</mo><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>ref</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4715\" style=\"width: 24.065em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 20.055em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.086em, 1019.85em, 3.753em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4716\"><span class=\"mi\" id=\"MathJax-Span-4717\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4718\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4719\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4720\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4721\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-4722\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-4723\"><span class=\"mrow\" id=\"MathJax-Span-4724\"><span class=\"mi\" id=\"MathJax-Span-4725\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-4726\"><span class=\"mrow\" id=\"MathJax-Span-4727\"><span class=\"mi\" id=\"MathJax-Span-4728\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4729\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4730\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-4731\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"msubsup\" id=\"MathJax-Span-4732\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4733\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4734\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-4735\"><span class=\"mrow\" id=\"MathJax-Span-4736\"><span class=\"mo\" id=\"MathJax-Span-4737\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-4738\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4739\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4740\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4741\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4742\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-4743\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4744\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-4745\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"texatom\" id=\"MathJax-Span-4746\"><span class=\"mrow\" id=\"MathJax-Span-4747\"><span class=\"mi\" id=\"MathJax-Span-4748\" style=\"font-family: STIXGeneral-Regular;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-4749\" style=\"font-family: STIXGeneral-Regular;\">L</span></span></span><span class=\"mo\" id=\"MathJax-Span-4750\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4751\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4752\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4753\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4754\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-4755\" style=\"font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-4756\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4757\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4758\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4759\" style=\"font-family: STIXGeneral-Regular;\">‚Äñ</span><span class=\"msubsup\" id=\"MathJax-Span-4760\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4761\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-4762\"><span class=\"mrow\" id=\"MathJax-Span-4763\"><span class=\"mtext\" id=\"MathJax-Span-4764\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">ref</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4765\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-4766\" style=\"font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-4767\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4768\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4769\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4770\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-4771\"><span class=\"mrow\" id=\"MathJax-Span-4772\"><span class=\"mo\" id=\"MathJax-Span-4773\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>J</mi><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>x</mi><mo>,</mo><mi>y</mi><mo>‚àº</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">[</mo></mrow><mi>r</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mi>Œ≤</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">K</mi><mi mathvariant=\"normal\">L</mi></mrow><mo stretchy=\"false\">(</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo fence=\"false\" stretchy=\"false\">‚Äñ</mo><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>ref</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-287\">J(\\theta) = \\mathbb{E}_{x,y \\sim \\pi_\\theta}\n\\big[\nr(x,y) - \\beta \\mathrm{KL}(\\pi_\\theta(\\cdot \\mid x) \\Vert \\pi_{\\text{ref}}(\\cdot \\mid x))\n\\big]</script>\n\n        <ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-288-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4774\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4775\"><span class=\"msubsup\" id=\"MathJax-Span-4776\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4777\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4778\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-288\">\\pi_\\theta</script> is the policy model being optimized, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-289-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4779\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4780\"><span class=\"mi\" id=\"MathJax-Span-4781\" style=\"font-family: STIXGeneral-Italic;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≤</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-289\">\\beta</script> is a scaling factor.</li>\n        </ul>\n      </li>\n      <li>\n        <p>The KL term penalizes deviations from the reference model distribution, preventing <strong>mode collapse</strong>, <strong>reward hacking</strong>, or <strong>drift</strong> into incoherent or unfaithful responses.</p>\n      </li>\n    </ul>\n<p>It appears in the <strong>KL-divergence regularization term</strong> in the RL objective:</p>\n<ul>\n          <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-288-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4774\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4775\"><span class=\"msubsup\" id=\"MathJax-Span-4776\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4777\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4778\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-288\">\\pi_\\theta</script> is the policy model being optimized, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-289-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4779\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4780\"><span class=\"mi\" id=\"MathJax-Span-4781\" style=\"font-family: STIXGeneral-Italic;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≤</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-289\">\\beta</script> is a scaling factor.</li>\n        </ul>\n<p>The KL term penalizes deviations from the reference model distribution, preventing <strong>mode collapse</strong>, <strong>reward hacking</strong>, or <strong>drift</strong> into incoherent or unfaithful responses.</p>\n<p>Conceptually, the reference model anchors the optimization so that:</p>\n<ul>\n      <li>The policy model can explore higher-reward regions of response space.</li>\n      <li>But does not diverge too far from its pretrained linguistic and factual priors.</li>\n    </ul>\n<h5 id=\"architecture-1\">Architecture</h5>\n<ul>\n  <li>\n    <p>The reference model is architecturally <strong>identical</strong> to the policy model. It is often just a <strong>frozen copy</strong> of the supervised fine-tuned (SFT) model.</p>\n  </li>\n  <li>\n    <p>Example pipeline:</p>\n\n    <ol>\n      <li>Begin with a pretrained transformer (e.g., GPT-3, LLaMA, or PaLM).</li>\n      <li>Fine-tune it with instruction data <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-290-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4782\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4783\"><span class=\"mo\" id=\"MathJax-Span-4784\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-290\">\\rightarrow</script> <strong>SFT model</strong>.</li>\n      <li>Clone the SFT model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-291-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4785\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4786\"><span class=\"mo\" id=\"MathJax-Span-4787\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-291\">\\rightarrow</script> <strong>Reference model (frozen)</strong>.</li>\n      <li>Train another copy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-292-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4788\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4789\"><span class=\"mo\" id=\"MathJax-Span-4790\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-292\">\\rightarrow</script> <strong>Policy model (trainable)</strong> with PPO or another RL optimizer, using the frozen reference for KL regularization.</li>\n    </ol>\n  </li>\n  <li>\n    <p>Since it shares weights and architecture with the policy model, the reference model uses a <strong>causal decoder-only transformer</strong>, typically with the same number of layers, hidden dimensions, and parameters.</p>\n  </li>\n  <li>\n    <p>The architectural identity ensures that <strong>token-wise probability distributions</strong> are directly comparable, allowing exact computation of\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-293-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>K</mi><mi mathvariant=&quot;normal&quot;>L</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>&amp;#x2016;</mo><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>ref</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munder><mo>&amp;#x2211;</mo><mi>y</mi></munder><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mi>log</mi><mo>&amp;#x2061;</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>ref</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo>.</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4791\" style=\"width: 24.378em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 20.315em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1020.26em, 2.919em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4792\"><span class=\"texatom\" id=\"MathJax-Span-4793\"><span class=\"mrow\" id=\"MathJax-Span-4794\"><span class=\"mi\" id=\"MathJax-Span-4795\" style=\"font-family: STIXGeneral-Regular;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-4796\" style=\"font-family: STIXGeneral-Regular;\">L</span></span></span><span class=\"mo\" id=\"MathJax-Span-4797\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4798\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4799\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4800\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4801\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-4802\" style=\"font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-4803\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4804\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4805\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4806\" style=\"font-family: STIXGeneral-Regular;\">‚Äñ</span><span class=\"msubsup\" id=\"MathJax-Span-4807\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4808\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-4809\"><span class=\"mrow\" id=\"MathJax-Span-4810\"><span class=\"mtext\" id=\"MathJax-Span-4811\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">ref</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4812\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-4813\" style=\"font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-4814\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4815\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4816\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4817\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4818\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-4819\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4820\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.695em; left: 0.94em;\"><span class=\"mi\" id=\"MathJax-Span-4821\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-4822\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4823\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4824\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4825\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4826\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-4827\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4828\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4829\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mi\" id=\"MathJax-Span-4830\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-4831\"></span><span class=\"mfrac\" id=\"MathJax-Span-4832\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.93em, 4.326em, -999.997em); top: -4.581em; left: 50%; margin-left: -0.987em;\"><span class=\"mrow\" id=\"MathJax-Span-4833\"><span class=\"msubsup\" id=\"MathJax-Span-4834\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4835\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4836\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4837\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4838\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-4839\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4840\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4841\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1002.24em, 4.326em, -999.997em); top: -3.591em; left: 50%; margin-left: -1.143em;\"><span class=\"mrow\" id=\"MathJax-Span-4842\"><span class=\"msubsup\" id=\"MathJax-Span-4843\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4844\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-4845\"><span class=\"mrow\" id=\"MathJax-Span-4846\"><span class=\"mtext\" id=\"MathJax-Span-4847\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">ref</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4848\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4849\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-4850\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4851\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4852\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1002.4em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.398em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4853\" style=\"font-family: STIXGeneral-Regular;\">.</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.684em; border-left: 0px solid; width: 0px; height: 2.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">K</mi><mi mathvariant=\"normal\">L</mi></mrow><mo stretchy=\"false\">(</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo fence=\"false\" stretchy=\"false\">‚Äñ</mo><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>ref</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>=</mo><munder><mo>‚àë</mo><mi>y</mi></munder><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mi>log</mi><mo>‚Å°</mo><mfrac><mrow><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>ref</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mfrac><mo>.</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-293\">\\mathrm{KL}(\\pi_\\theta(\\cdot \\mid x) \\Vert \\pi_{\\text{ref}}(\\cdot \\mid x))\n= \\sum_y \\pi_\\theta(y \\mid x) \\log\\frac{\\pi_\\theta(y \\mid x)}{\\pi_{\\text{ref}}(y \\mid x)}.</script></p>\n  </li>\n  <li>\n    <p>Some implementations (e.g., <a href=\"https://arxiv.org/abs/2009.01325\">Stiennon et al., 2020</a>, ‚ÄúLearning to summarize with human feedback‚Äù) experimented with slowly updating the reference model, but most production pipelines freeze it entirely.</p>\n  </li>\n</ul>\n<p>The reference model is architecturally <strong>identical</strong> to the policy model. It is often just a <strong>frozen copy</strong> of the supervised fine-tuned (SFT) model.</p>\n<p>Example pipeline:</p>\n<ol>\n      <li>Begin with a pretrained transformer (e.g., GPT-3, LLaMA, or PaLM).</li>\n      <li>Fine-tune it with instruction data <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-290-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4782\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4783\"><span class=\"mo\" id=\"MathJax-Span-4784\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-290\">\\rightarrow</script> <strong>SFT model</strong>.</li>\n      <li>Clone the SFT model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-291-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4785\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4786\"><span class=\"mo\" id=\"MathJax-Span-4787\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-291\">\\rightarrow</script> <strong>Reference model (frozen)</strong>.</li>\n      <li>Train another copy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-292-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4788\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4789\"><span class=\"mo\" id=\"MathJax-Span-4790\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-292\">\\rightarrow</script> <strong>Policy model (trainable)</strong> with PPO or another RL optimizer, using the frozen reference for KL regularization.</li>\n    </ol>\n<p>Since it shares weights and architecture with the policy model, the reference model uses a <strong>causal decoder-only transformer</strong>, typically with the same number of layers, hidden dimensions, and parameters.</p>\n<p>The architectural identity ensures that <strong>token-wise probability distributions</strong> are directly comparable, allowing exact computation of\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-293-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>K</mi><mi mathvariant=&quot;normal&quot;>L</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>&amp;#x2016;</mo><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>ref</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munder><mo>&amp;#x2211;</mo><mi>y</mi></munder><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mi>log</mi><mo>&amp;#x2061;</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>ref</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo>.</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4791\" style=\"width: 24.378em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 20.315em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1020.26em, 2.919em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4792\"><span class=\"texatom\" id=\"MathJax-Span-4793\"><span class=\"mrow\" id=\"MathJax-Span-4794\"><span class=\"mi\" id=\"MathJax-Span-4795\" style=\"font-family: STIXGeneral-Regular;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-4796\" style=\"font-family: STIXGeneral-Regular;\">L</span></span></span><span class=\"mo\" id=\"MathJax-Span-4797\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4798\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4799\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4800\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4801\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-4802\" style=\"font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-4803\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4804\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4805\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4806\" style=\"font-family: STIXGeneral-Regular;\">‚Äñ</span><span class=\"msubsup\" id=\"MathJax-Span-4807\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4808\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-4809\"><span class=\"mrow\" id=\"MathJax-Span-4810\"><span class=\"mtext\" id=\"MathJax-Span-4811\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">ref</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4812\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-4813\" style=\"font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-4814\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4815\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4816\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4817\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4818\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-4819\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.076em, 1000.84em, 4.43em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-4820\" style=\"font-family: STIXGeneral-Regular; vertical-align: 0.003em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.695em; left: 0.94em;\"><span class=\"mi\" id=\"MathJax-Span-4821\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-4822\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4823\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4824\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4825\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4826\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-4827\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4828\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4829\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mi\" id=\"MathJax-Span-4830\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-4831\"></span><span class=\"mfrac\" id=\"MathJax-Span-4832\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 2.398em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.93em, 4.326em, -999.997em); top: -4.581em; left: 50%; margin-left: -0.987em;\"><span class=\"mrow\" id=\"MathJax-Span-4833\"><span class=\"msubsup\" id=\"MathJax-Span-4834\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4835\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4836\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4837\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4838\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-4839\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4840\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4841\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1002.24em, 4.326em, -999.997em); top: -3.591em; left: 50%; margin-left: -1.143em;\"><span class=\"mrow\" id=\"MathJax-Span-4842\"><span class=\"msubsup\" id=\"MathJax-Span-4843\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4844\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-4845\"><span class=\"mrow\" id=\"MathJax-Span-4846\"><span class=\"mtext\" id=\"MathJax-Span-4847\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">ref</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4848\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4849\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-4850\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-4851\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4852\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1002.4em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.398em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4853\" style=\"font-family: STIXGeneral-Regular;\">.</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.684em; border-left: 0px solid; width: 0px; height: 2.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">K</mi><mi mathvariant=\"normal\">L</mi></mrow><mo stretchy=\"false\">(</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo fence=\"false\" stretchy=\"false\">‚Äñ</mo><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>ref</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>=</mo><munder><mo>‚àë</mo><mi>y</mi></munder><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mi>log</mi><mo>‚Å°</mo><mfrac><mrow><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>ref</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mfrac><mo>.</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-293\">\\mathrm{KL}(\\pi_\\theta(\\cdot \\mid x) \\Vert \\pi_{\\text{ref}}(\\cdot \\mid x))\n= \\sum_y \\pi_\\theta(y \\mid x) \\log\\frac{\\pi_\\theta(y \\mid x)}{\\pi_{\\text{ref}}(y \\mid x)}.</script></p>\n<p>Some implementations (e.g., <a href=\"https://arxiv.org/abs/2009.01325\">Stiennon et al., 2020</a>, ‚ÄúLearning to summarize with human feedback‚Äù) experimented with slowly updating the reference model, but most production pipelines freeze it entirely.</p>\n<h5 id=\"training-data-1\">Training Data</h5>\n<ul>\n  <li>\n    <p>The reference model is not trained during the RL stage.\nInstead, it is a <strong>snapshot</strong> of the model before RLHF fine-tuning.</p>\n  </li>\n  <li>\n    <p>It is trained in the <strong>supervised fine-tuning (SFT)</strong> phase using instruction-following data such as:</p>\n\n    <ul>\n      <li>Prompt‚Äìresponse pairs written or rated by humans.</li>\n      <li>Curated high-quality datasets covering Q&amp;A, summarization, code generation, reasoning, and dialog.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The SFT dataset is usually <strong>smaller</strong> and more human-curated than pretraining data‚Äîranging from a few thousand to a few hundred thousand high-quality examples.</p>\n  </li>\n  <li>\n    <p>By preserving this SFT policy, the reference model embodies the <strong>linguistic priors</strong> and <strong>alignment baseline</strong> learned from human demonstrations before introducing reinforcement signals.</p>\n  </li>\n</ul>\n<p>The reference model is not trained during the RL stage.\nInstead, it is a <strong>snapshot</strong> of the model before RLHF fine-tuning.</p>\n<p>It is trained in the <strong>supervised fine-tuning (SFT)</strong> phase using instruction-following data such as:</p>\n<ul>\n      <li>Prompt‚Äìresponse pairs written or rated by humans.</li>\n      <li>Curated high-quality datasets covering Q&amp;A, summarization, code generation, reasoning, and dialog.</li>\n    </ul>\n<p>The SFT dataset is usually <strong>smaller</strong> and more human-curated than pretraining data‚Äîranging from a few thousand to a few hundred thousand high-quality examples.</p>\n<p>By preserving this SFT policy, the reference model embodies the <strong>linguistic priors</strong> and <strong>alignment baseline</strong> learned from human demonstrations before introducing reinforcement signals.</p>\n<h5 id=\"typical-model-size-1\">Typical Model Size</h5>\n<ul>\n  <li>\n    <p>The reference model must match the policy model in architecture and vocabulary to make KL computation meaningful.\nTherefore, it has the <strong>same parameter count</strong> as the policy model‚Äîcommonly in the range of:</p>\n\n    <ul>\n      <li><strong>7B‚Äì70B parameters</strong> for research-grade or open-source systems (e.g., LLaMA-2, Falcon, Mistral RLHF variants).</li>\n      <li><strong>175B‚Äì500B+ parameters</strong> for frontier models (e.g., GPT-3 or GPT-4 scale).</li>\n    </ul>\n  </li>\n  <li>Because the reference model is frozen, its storage and compute requirements are primarily for <strong>forward passes</strong> during KL evaluation rather than gradient updates.</li>\n  <li>In distributed training pipelines (e.g., <a href=\"https://arxiv.org/abs/2203.02155\">Ouyang et al., 2022</a>), both the policy and reference models are sharded across GPUs but only the policy model receives gradient updates.</li>\n</ul>\n<p>The reference model must match the policy model in architecture and vocabulary to make KL computation meaningful.\nTherefore, it has the <strong>same parameter count</strong> as the policy model‚Äîcommonly in the range of:</p>\n<ul>\n      <li><strong>7B‚Äì70B parameters</strong> for research-grade or open-source systems (e.g., LLaMA-2, Falcon, Mistral RLHF variants).</li>\n      <li><strong>175B‚Äì500B+ parameters</strong> for frontier models (e.g., GPT-3 or GPT-4 scale).</li>\n    </ul>\n<h5 id=\"comparative-analysis-11\">Comparative Analysis</h5>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Aspect</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Role</strong></td>\n<td class=\"tg-tleft-valign-second\">Baseline distribution constraining RL updates</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Function</strong></td>\n<td class=\"tg-tleft-valign-second\">Provides KL regularization to prevent policy drift</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Architecture</strong></td>\n<td class=\"tg-tleft-valign-second\">Identical to policy (decoder-only transformer)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Training Data</strong></td>\n<td class=\"tg-tleft-valign-second\">SFT instruction data (high-quality human responses)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Model Size</strong></td>\n<td class=\"tg-tleft-valign-second\">Same as policy; typically 7B‚Äì175B parameters</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Status During RL</strong></td>\n<td class=\"tg-tleft-valign-second\">Frozen (no updates)</td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Aspect</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Role</strong></td>\n<td class=\"tg-tleft-valign-second\">Baseline distribution constraining RL updates</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Function</strong></td>\n<td class=\"tg-tleft-valign-second\">Provides KL regularization to prevent policy drift</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Architecture</strong></td>\n<td class=\"tg-tleft-valign-second\">Identical to policy (decoder-only transformer)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Training Data</strong></td>\n<td class=\"tg-tleft-valign-second\">SFT instruction data (high-quality human responses)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Model Size</strong></td>\n<td class=\"tg-tleft-valign-second\">Same as policy; typically 7B‚Äì175B parameters</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Status During RL</strong></td>\n<td class=\"tg-tleft-valign-second\">Frozen (no updates)</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"reward-model\">Reward Model</h4>\n<ul>\n  <li>The <strong>reward model (RM)</strong> is one of the most crucial components in the RLHF pipeline.</li>\n  <li>It provides the <strong>scalar feedback signal</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-294-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4854\" style=\"width: 2.971em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.4em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4855\"><span class=\"mi\" id=\"MathJax-Span-4856\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4857\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4858\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4859\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4860\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-4861\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-294\">r(x, y)</script> that quantifies the quality of a model‚Äôs response <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-295-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4862\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4863\"><span class=\"mi\" id=\"MathJax-Span-4864\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-295\">y</script> to a prompt <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-296-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4865\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4866\"><span class=\"mi\" id=\"MathJax-Span-4867\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-296\">x</script>, translating human preferences into a form usable by reinforcement learning algorithms.</li>\n  <li>In modern LLM alignment, the reward model serves as the <strong>surrogate objective</strong> for human satisfaction, steering the policy model toward behaviors that humans find helpful, truthful, and safe.</li>\n  <li>The reward model provides the <strong>human-aligned feedback mechanism</strong> that guides reinforcement learning updates. It bridges subjective human judgment and quantitative optimization, serving as the anchor for policy alignment and safety in LLM fine-tuning.</li>\n</ul>\n<h5 id=\"function-2\">Function</h5>\n<ul>\n  <li>\n    <p>The reward model approximates a <strong>latent human preference function</strong>. Given a prompt <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-297-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4868\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4869\"><span class=\"mi\" id=\"MathJax-Span-4870\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-297\">x</script> and a response <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-298-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4871\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4872\"><span class=\"mi\" id=\"MathJax-Span-4873\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-298\">y</script>, the model outputs a scalar value <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-299-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4874\" style=\"width: 2.971em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.4em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4875\"><span class=\"mi\" id=\"MathJax-Span-4876\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4877\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4878\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4879\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4880\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-4881\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-299\">r(x,y)</script> representing how much a human would prefer that response.</p>\n  </li>\n  <li>\n    <p>Its primary role is to act as a <strong>critic</strong> that scores generated text, so that the <strong>policy model</strong> can be optimized to produce higher-reward responses.</p>\n  </li>\n  <li>\n    <p>Formally, the goal is to learn a function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-300-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2248;</mo><mtext>Expected human preference score</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4882\" style=\"width: 23.857em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 19.846em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1019.79em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4883\"><span class=\"msubsup\" id=\"MathJax-Span-4884\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4885\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4886\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4887\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4888\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4889\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4890\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-4891\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4892\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚âà</span><span class=\"mtext\" id=\"MathJax-Span-4893\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">Expected human preference score</span><span class=\"mo\" id=\"MathJax-Span-4894\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4895\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4896\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4897\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-4898\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>‚âà</mo><mtext>Expected human preference score</mtext><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-300\">r_\\phi(x,y) \\approx \\text{Expected human preference score}(x,y)</script>, parameterized by <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-301-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03D5;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4899\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4900\"><span class=\"mi\" id=\"MathJax-Span-4901\" style=\"font-family: STIXGeneral-Italic;\">œï</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œï</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-301\">\\phi</script>.</p>\n  </li>\n  <li>\n    <p>The reward model is trained using <strong>human preference data</strong> collected as pairwise or ranked comparisons. The reward modeling methodology ‚Äî from ranking-based supervision and cross-entropy loss to normalization ‚Äî originates from <a href=\"https://arxiv.org/abs/2009.01325\">Learning to Summarize from Human Feedback</a> by Stiennon et al. (2020) and was directly integrated into <a href=\"https://arxiv.org/abs/2203.02155\">Training Language Models to Follow instructions with Human Feedback</a> (InstructGPT) by Ouyang et al. (2022), forming the standard foundation of modern RLHF systems.</p>\n  </li>\n  <li>\n    <p>The image below <a href=\"https://huggingface.co/blog/rlhf\">(source)</a> illustrates how a reward model functions:</p>\n  </li>\n</ul>\n<p>The reward model approximates a <strong>latent human preference function</strong>. Given a prompt <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-297-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4868\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4869\"><span class=\"mi\" id=\"MathJax-Span-4870\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-297\">x</script> and a response <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-298-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4871\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4872\"><span class=\"mi\" id=\"MathJax-Span-4873\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-298\">y</script>, the model outputs a scalar value <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-299-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4874\" style=\"width: 2.971em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.4em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4875\"><span class=\"mi\" id=\"MathJax-Span-4876\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4877\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4878\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4879\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4880\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-4881\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-299\">r(x,y)</script> representing how much a human would prefer that response.</p>\n<p>Its primary role is to act as a <strong>critic</strong> that scores generated text, so that the <strong>policy model</strong> can be optimized to produce higher-reward responses.</p>\n<p>Formally, the goal is to learn a function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-300-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2248;</mo><mtext>Expected human preference score</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4882\" style=\"width: 23.857em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 19.846em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1019.79em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4883\"><span class=\"msubsup\" id=\"MathJax-Span-4884\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4885\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4886\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4887\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4888\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4889\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4890\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-4891\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4892\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚âà</span><span class=\"mtext\" id=\"MathJax-Span-4893\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">Expected human preference score</span><span class=\"mo\" id=\"MathJax-Span-4894\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4895\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4896\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4897\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-4898\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>‚âà</mo><mtext>Expected human preference score</mtext><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-300\">r_\\phi(x,y) \\approx \\text{Expected human preference score}(x,y)</script>, parameterized by <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-301-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03D5;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4899\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.47em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4900\"><span class=\"mi\" id=\"MathJax-Span-4901\" style=\"font-family: STIXGeneral-Italic;\">œï</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œï</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-301\">\\phi</script>.</p>\n<p>The reward model is trained using <strong>human preference data</strong> collected as pairwise or ranked comparisons. The reward modeling methodology ‚Äî from ranking-based supervision and cross-entropy loss to normalization ‚Äî originates from <a href=\"https://arxiv.org/abs/2009.01325\">Learning to Summarize from Human Feedback</a> by Stiennon et al. (2020) and was directly integrated into <a href=\"https://arxiv.org/abs/2203.02155\">Training Language Models to Follow instructions with Human Feedback</a> (InstructGPT) by Ouyang et al. (2022), forming the standard foundation of modern RLHF systems.</p>\n<p>The image below <a href=\"https://huggingface.co/blog/rlhf\">(source)</a> illustrates how a reward model functions:</p>\n<p><img src=\"/primers/ai/assets/rlhf/6.png\" alt=\"\"></p>\n<ul>\n  <li>\n    <p>In <a href=\"https://arxiv.org/abs/2009.01325\">Stiennon et al. (2020)</a>, the RM was trained on a dataset of <strong>comparisons between two model outputs</strong> on the same input. They used a cross-entropy loss, with the comparisons as labels‚Äîthe difference in rewards represents the log odds that one response will be preferred to the other by a human labeler. This approach was later adopted and extended in <a href=\"https://arxiv.org/abs/2203.02155\">Ouyang et al. (2022)</a>, which used this same reward model formulation as the basis of their RLHF training pipeline, with the following changes to sample creation and batching strategy:</p>\n\n    <ul>\n      <li>In order to <strong>speed up comparison collection</strong> (i.e., reduce labeling effort per prompt by ranking multiple responses at once), each labeler is presented with anywhere between <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-302-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi><mo>=</mo><mn>4</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4902\" style=\"width: 2.971em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.4em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4903\"><span class=\"mi\" id=\"MathJax-Span-4904\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4905\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-4906\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">4</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi><mo>=</mo><mn>4</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-302\">K = 4</script> and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-303-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi><mo>=</mo><mn>9</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4907\" style=\"width: 2.971em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.4em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4908\"><span class=\"mi\" id=\"MathJax-Span-4909\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4910\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-4911\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">9</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi><mo>=</mo><mn>9</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-303\">K = 9</script> responses to rank ‚Äî larger <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-304-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4912\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4913\"><span class=\"mi\" id=\"MathJax-Span-4914\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-304\">K</script> values mean more comparisons per labeling task and richer training signal. This ranking procedure automatically generates up to <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-305-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>K</mi><mn>2</mn></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4915\" style=\"width: 1.461em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.2em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4916\"><span class=\"msubsup\" id=\"MathJax-Span-4917\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4918\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"mn\" id=\"MathJax-Span-4919\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>K</mi><mn>2</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-305\">K^2</script> pairwise comparisons per prompt (since every possible pair of completions produces one ‚Äúwin/loss‚Äù label).</li>\n      <li>However, because these <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-306-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>K</mi><mn>2</mn></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4920\" style=\"width: 1.461em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.2em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4921\"><span class=\"msubsup\" id=\"MathJax-Span-4922\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4923\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"mn\" id=\"MathJax-Span-4924\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>K</mi><mn>2</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-306\">K^2</script> comparisons are <strong>highly correlated</strong> within the same labeling task, simply shuffling and treating each pair as an independent datapoint led to severe <strong>overfitting</strong> ‚Äî the reward model quickly memorized specific completions and degraded generalization.</li>\n      <li>Specifically, if each of the <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-307-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>K</mi><mn>2</mn></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4925\" style=\"width: 1.461em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.2em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4926\"><span class=\"msubsup\" id=\"MathJax-Span-4927\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4928\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"mn\" id=\"MathJax-Span-4929\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>K</mi><mn>2</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-307\">K^2</script> comparisons is treated separately, then each completion may appear in <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-308-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi><mo>&amp;#x2212;</mo><mn>1</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4930\" style=\"width: 2.815em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.24em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4931\"><span class=\"mi\" id=\"MathJax-Span-4932\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4933\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mn\" id=\"MathJax-Span-4934\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi><mo>‚àí</mo><mn>1</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-308\">K-1</script> distinct pairs, resulting in multiple redundant gradient updates per sample. The authors observed that under this setup, the model <strong>overfit within a single epoch</strong>, and even reusing the data within an epoch caused further overfitting.</li>\n      <li>To mitigate this, they changed the training approach to treat <strong>all <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-309-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>K</mi><mn>2</mn></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4935\" style=\"width: 1.501em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.242em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.139em, 1001.24em, 2.275em, -999.997em); top: -2.115em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4936\"><span class=\"msubsup\" id=\"MathJax-Span-4937\"><span style=\"display: inline-block; position: relative; width: 1.242em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.153em, 1000.73em, 4.135em, -999.997em); top: -3.975em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4938\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.054em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.98em;\"></span></span><span style=\"position: absolute; top: -4.336em; left: 0.777em;\"><span class=\"mn\" id=\"MathJax-Span-4939\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 3.98em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.12em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>K</mi><mn>2</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-309\">K^2</script> comparisons for a given prompt as a single batch element</strong>. This ensures that every completion is processed only once per batch while still contributing to all necessary pairwise comparisons. This modification was both <strong>computationally efficient</strong>‚Äîrequiring only one forward pass of the reward model per completion instead of <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-310-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>K</mi><mn>2</mn></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4940\" style=\"width: 1.461em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.2em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4941\"><span class=\"msubsup\" id=\"MathJax-Span-4942\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4943\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"mn\" id=\"MathJax-Span-4944\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>K</mi><mn>2</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-310\">K^2</script>‚Äîand <strong>empirically superior</strong>, yielding much improved <strong>validation accuracy and log loss</strong>. This batching strategy adopted by <a href=\"https://arxiv.org/abs/2203.02155\">Ouyang et al. (2022)</a> became a standard approach, forming a key component of modern RLHF reward model training.</li>\n    </ul>\n  </li>\n</ul>\n<p>In <a href=\"https://arxiv.org/abs/2009.01325\">Stiennon et al. (2020)</a>, the RM was trained on a dataset of <strong>comparisons between two model outputs</strong> on the same input. They used a cross-entropy loss, with the comparisons as labels‚Äîthe difference in rewards represents the log odds that one response will be preferred to the other by a human labeler. This approach was later adopted and extended in <a href=\"https://arxiv.org/abs/2203.02155\">Ouyang et al. (2022)</a>, which used this same reward model formulation as the basis of their RLHF training pipeline, with the following changes to sample creation and batching strategy:</p>\n<ul>\n      <li>In order to <strong>speed up comparison collection</strong> (i.e., reduce labeling effort per prompt by ranking multiple responses at once), each labeler is presented with anywhere between <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-302-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi><mo>=</mo><mn>4</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4902\" style=\"width: 2.971em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.4em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4903\"><span class=\"mi\" id=\"MathJax-Span-4904\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4905\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-4906\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">4</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi><mo>=</mo><mn>4</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-302\">K = 4</script> and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-303-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi><mo>=</mo><mn>9</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4907\" style=\"width: 2.971em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.4em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4908\"><span class=\"mi\" id=\"MathJax-Span-4909\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4910\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-4911\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">9</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi><mo>=</mo><mn>9</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-303\">K = 9</script> responses to rank ‚Äî larger <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-304-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4912\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.78em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4913\"><span class=\"mi\" id=\"MathJax-Span-4914\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-304\">K</script> values mean more comparisons per labeling task and richer training signal. This ranking procedure automatically generates up to <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-305-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>K</mi><mn>2</mn></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4915\" style=\"width: 1.461em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.2em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4916\"><span class=\"msubsup\" id=\"MathJax-Span-4917\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4918\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"mn\" id=\"MathJax-Span-4919\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>K</mi><mn>2</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-305\">K^2</script> pairwise comparisons per prompt (since every possible pair of completions produces one ‚Äúwin/loss‚Äù label).</li>\n      <li>However, because these <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-306-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>K</mi><mn>2</mn></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4920\" style=\"width: 1.461em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.2em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4921\"><span class=\"msubsup\" id=\"MathJax-Span-4922\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4923\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"mn\" id=\"MathJax-Span-4924\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>K</mi><mn>2</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-306\">K^2</script> comparisons are <strong>highly correlated</strong> within the same labeling task, simply shuffling and treating each pair as an independent datapoint led to severe <strong>overfitting</strong> ‚Äî the reward model quickly memorized specific completions and degraded generalization.</li>\n      <li>Specifically, if each of the <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-307-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>K</mi><mn>2</mn></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4925\" style=\"width: 1.461em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.2em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4926\"><span class=\"msubsup\" id=\"MathJax-Span-4927\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4928\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"mn\" id=\"MathJax-Span-4929\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>K</mi><mn>2</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-307\">K^2</script> comparisons is treated separately, then each completion may appear in <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-308-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi><mo>&amp;#x2212;</mo><mn>1</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4930\" style=\"width: 2.815em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.24em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4931\"><span class=\"mi\" id=\"MathJax-Span-4932\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4933\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mn\" id=\"MathJax-Span-4934\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>K</mi><mo>‚àí</mo><mn>1</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-308\">K-1</script> distinct pairs, resulting in multiple redundant gradient updates per sample. The authors observed that under this setup, the model <strong>overfit within a single epoch</strong>, and even reusing the data within an epoch caused further overfitting.</li>\n      <li>To mitigate this, they changed the training approach to treat <strong>all <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-309-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>K</mi><mn>2</mn></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4935\" style=\"width: 1.501em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.242em; height: 0px; font-size: 121%;\"><span style=\"position: absolute; clip: rect(1.139em, 1001.24em, 2.275em, -999.997em); top: -2.115em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4936\"><span class=\"msubsup\" id=\"MathJax-Span-4937\"><span style=\"display: inline-block; position: relative; width: 1.242em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.153em, 1000.73em, 4.135em, -999.997em); top: -3.975em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4938\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.054em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.98em;\"></span></span><span style=\"position: absolute; top: -4.336em; left: 0.777em;\"><span class=\"mn\" id=\"MathJax-Span-4939\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 3.98em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.12em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>K</mi><mn>2</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-309\">K^2</script> comparisons for a given prompt as a single batch element</strong>. This ensures that every completion is processed only once per batch while still contributing to all necessary pairwise comparisons. This modification was both <strong>computationally efficient</strong>‚Äîrequiring only one forward pass of the reward model per completion instead of <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-310-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>K</mi><mn>2</mn></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4940\" style=\"width: 1.461em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1001.2em, 2.294em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4941\"><span class=\"msubsup\" id=\"MathJax-Span-4942\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4943\" style=\"font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"mn\" id=\"MathJax-Span-4944\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>K</mi><mn>2</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-310\">K^2</script>‚Äîand <strong>empirically superior</strong>, yielding much improved <strong>validation accuracy and log loss</strong>. This batching strategy adopted by <a href=\"https://arxiv.org/abs/2203.02155\">Ouyang et al. (2022)</a> became a standard approach, forming a key component of modern RLHF reward model training.</li>\n    </ul>\n<h5 id=\"architecture-2\">Architecture</h5>\n<ul>\n  <li>The reward model is typically a model derived from the same family as the policy model, sharing the same backbone architecture but differing in its <strong>output head</strong> and <strong>training objective</strong>. While some early or alternative setups explored encoder-based reward models, the canonical and most widely adopted approach‚Äîused in <a href=\"https://arxiv.org/abs/2203.02155\">InstructGPT</a> by Ouyang et al. (2022) and all modern large-scale RLHF pipelines‚Äîis <strong>decoder-only</strong>, consistent with the architecture of the policy (causal language) model. Architecturally, it‚Äôs identical to the policy model but with a <strong>scalar regression head</strong> added on top of the final hidden state.\n    <ul>\n      <li>In <a href=\"https://arxiv.org/abs/2203.02155\"><em>Training language models to follow instructions with human feedback</em></a> by Ouyang et al. (2022), the reward model is based on the <strong>GPT-3 architecture</strong> (<strong>specifically the 6B parameter variant</strong>), a <strong>decoder-only transformer</strong> trained autoregressively. Per the paper, the RM is <strong>initialized from the supervised fine-tuned (SFT) model</strong>, with the <strong>final unembedding layer removed and replaced by a new linear head</strong> that outputs a single real-valued reward for a given prompt‚Äìcompletion pair. This added linear layer is a regression head that maps the final hidden representation to a scalar value representing the model‚Äôs predicted human preference score. Put simply, the reward model is thus architecturally identical to the base language model, except for the replacement of the next-token prediction head with a <strong>linear head</strong> applied to the final hidden state that outputs a scalar value.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Mathematically speaking, the final token‚Äôs hidden representation <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-311-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>h</mi><mi>T</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4945\" style=\"width: 1.253em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.04em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4946\"><span class=\"msubsup\" id=\"MathJax-Span-4947\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4948\" style=\"font-family: STIXGeneral-Italic;\">h</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4949\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>h</mi><mi>T</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-311\">h_T</script> (or an average over all tokens) is passed through a linear projection to output <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-312-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4950\" style=\"width: 3.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4951\"><span class=\"msubsup\" id=\"MathJax-Span-4952\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4953\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4954\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4955\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4956\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4957\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4958\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-4959\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-312\">r_\\phi(x,y)</script> a <strong>single scalar reward</strong> representing the model‚Äôs predicted human preference for the given prompt‚Äìcompletion pair.</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-313-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>w</mi><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><msub><mi>h</mi><mi>T</mi></msub><mo>+</mo><mi>b</mi></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4960\" style=\"width: 9.794em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 8.128em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1008.08em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4961\"><span class=\"msubsup\" id=\"MathJax-Span-4962\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4963\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4964\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4965\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4966\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4967\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4968\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-4969\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-4970\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-4971\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4972\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.68em;\"><span class=\"mi\" id=\"MathJax-Span-4973\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ä§</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-4974\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4975\" style=\"font-family: STIXGeneral-Italic;\">h</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4976\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4977\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-4978\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">b</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>w</mi><mi mathvariant=\"normal\">‚ä§</mi></msup><msub><mi>h</mi><mi>T</mi></msub><mo>+</mo><mi>b</mi></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-313\">r_\\phi(x,y) = w^\\top h_T + b</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-314-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi><mo>,</mo><mi>b</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4979\" style=\"width: 2.034em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.669em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.62em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4980\"><span class=\"mi\" id=\"MathJax-Span-4981\" style=\"font-family: STIXGeneral-Italic;\">w</span><span class=\"mo\" id=\"MathJax-Span-4982\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4983\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">b</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>w</mi><mo>,</mo><mi>b</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-314\">w,b</script> are learned parameters.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The model therefore learns to encode text sequences and output a <strong>single continuous reward value</strong>, capturing human preference judgments.</p>\n  </li>\n  <li>\n    <p>In practice:</p>\n\n    <ul>\n      <li>The scalar head is lightweight (a single dense linear layer).</li>\n      <li>The underlying transformer backbone (6B parameters in InstructGPT) is initialized from the SFT model, preserving its linguistic and contextual knowledge.</li>\n      <li>During RM training, only the new scalar head and a subset of backbone parameters may be fine-tuned for efficiency and stability.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Several architectural variants are used for reward modeling, including:</p>\n\n    <ol>\n      <li><strong>LM Classifiers</strong>: Language models fine-tuned as binary classifiers to score which response better aligns with human preferences.</li>\n      <li><strong>Value Networks</strong>: Regression models that predict scalar ratings representing relative human preference.</li>\n      <li><strong>Critique Generators</strong>: Language models trained to generate evaluative critiques explaining which response is better and why, used in conjunction with instruction tuning.</li>\n    </ol>\n  </li>\n</ul>\n<ul>\n      <li>In <a href=\"https://arxiv.org/abs/2203.02155\"><em>Training language models to follow instructions with human feedback</em></a> by Ouyang et al. (2022), the reward model is based on the <strong>GPT-3 architecture</strong> (<strong>specifically the 6B parameter variant</strong>), a <strong>decoder-only transformer</strong> trained autoregressively. Per the paper, the RM is <strong>initialized from the supervised fine-tuned (SFT) model</strong>, with the <strong>final unembedding layer removed and replaced by a new linear head</strong> that outputs a single real-valued reward for a given prompt‚Äìcompletion pair. This added linear layer is a regression head that maps the final hidden representation to a scalar value representing the model‚Äôs predicted human preference score. Put simply, the reward model is thus architecturally identical to the base language model, except for the replacement of the next-token prediction head with a <strong>linear head</strong> applied to the final hidden state that outputs a scalar value.</li>\n    </ul>\n<p>Mathematically speaking, the final token‚Äôs hidden representation <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-311-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>h</mi><mi>T</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4945\" style=\"width: 1.253em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.04em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4946\"><span class=\"msubsup\" id=\"MathJax-Span-4947\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4948\" style=\"font-family: STIXGeneral-Italic;\">h</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-4949\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>h</mi><mi>T</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-311\">h_T</script> (or an average over all tokens) is passed through a linear projection to output <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-312-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4950\" style=\"width: 3.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4951\"><span class=\"msubsup\" id=\"MathJax-Span-4952\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4953\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4954\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-4955\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-4956\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-4957\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4958\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-4959\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-312\">r_\\phi(x,y)</script> a <strong>single scalar reward</strong> representing the model‚Äôs predicted human preference for the given prompt‚Äìcompletion pair.</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-314-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi><mo>,</mo><mi>b</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4979\" style=\"width: 2.034em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.669em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.62em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4980\"><span class=\"mi\" id=\"MathJax-Span-4981\" style=\"font-family: STIXGeneral-Italic;\">w</span><span class=\"mo\" id=\"MathJax-Span-4982\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-4983\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">b</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>w</mi><mo>,</mo><mi>b</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-314\">w,b</script> are learned parameters.</li>\n    </ul>\n<p>The model therefore learns to encode text sequences and output a <strong>single continuous reward value</strong>, capturing human preference judgments.</p>\n<p>In practice:</p>\n<ul>\n      <li>The scalar head is lightweight (a single dense linear layer).</li>\n      <li>The underlying transformer backbone (6B parameters in InstructGPT) is initialized from the SFT model, preserving its linguistic and contextual knowledge.</li>\n      <li>During RM training, only the new scalar head and a subset of backbone parameters may be fine-tuned for efficiency and stability.</li>\n    </ul>\n<p>Several architectural variants are used for reward modeling, including:</p>\n<ol>\n      <li><strong>LM Classifiers</strong>: Language models fine-tuned as binary classifiers to score which response better aligns with human preferences.</li>\n      <li><strong>Value Networks</strong>: Regression models that predict scalar ratings representing relative human preference.</li>\n      <li><strong>Critique Generators</strong>: Language models trained to generate evaluative critiques explaining which response is better and why, used in conjunction with instruction tuning.</li>\n    </ol>\n<h5 id=\"training-objective\">Training Objective</h5>\n<h6 id=\"background-bradley-terry-model\">Background: Bradley-Terry Model</h6>\n<ul>\n  <li>\n    <p>The reward model is trained using ranked comparison data and assigns a scalar score to model-generated responses. A common formulation of the pairwise loss uses the <strong>Bradley-Terry model</strong>, where the probability that a rater prefers response <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-315-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4984\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4985\"><span class=\"msubsup\" id=\"MathJax-Span-4986\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4987\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4988\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-315\">r_i</script> over <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-316-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>j</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4989\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4990\"><span class=\"msubsup\" id=\"MathJax-Span-4991\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4992\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4993\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>j</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-316\">r_j</script> is:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-317-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>r</mi><mi>i</mi></msub><mo>&amp;gt;</mo><msub><mi>r</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>p</mi><mo>,</mo><msub><mi>r</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi>exp</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>p</mi><mo>,</mo><msub><mi>r</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>exp</mi><mo>&amp;#x2061;</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>p</mi><mo>,</mo><msub><mi>r</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4994\" style=\"width: 20.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 17.138em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.576em, 1017.14em, 3.336em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4995\"><span class=\"mi\" id=\"MathJax-Span-4996\" style=\"font-family: STIXGeneral-Italic;\">P</span><span class=\"mo\" id=\"MathJax-Span-4997\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-4998\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4999\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5000\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5001\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">&gt;</span><span class=\"msubsup\" id=\"MathJax-Span-5002\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5003\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5004\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5005\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5006\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-5007\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 11.93em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1005.26em, 4.482em, -999.997em); top: -4.789em; left: 50%; margin-left: -2.654em;\"><span class=\"mrow\" id=\"MathJax-Span-5008\"><span class=\"mi\" id=\"MathJax-Span-5009\" style=\"font-family: STIXGeneral-Regular;\">exp</span><span class=\"mo\" id=\"MathJax-Span-5010\"></span><span class=\"mo\" id=\"MathJax-Span-5011\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5012\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5013\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5014\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5015\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5016\" style=\"font-family: STIXGeneral-Italic;\">p</span><span class=\"mo\" id=\"MathJax-Span-5017\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5018\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5019\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5020\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5021\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5022\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1011.77em, 4.482em, -999.997em); top: -3.331em; left: 50%; margin-left: -5.935em;\"><span class=\"mrow\" id=\"MathJax-Span-5023\"><span class=\"mi\" id=\"MathJax-Span-5024\" style=\"font-family: STIXGeneral-Regular;\">exp</span><span class=\"mo\" id=\"MathJax-Span-5025\"></span><span class=\"mo\" id=\"MathJax-Span-5026\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5027\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5028\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5029\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5030\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5031\" style=\"font-family: STIXGeneral-Italic;\">p</span><span class=\"mo\" id=\"MathJax-Span-5032\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5033\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5034\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5035\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5036\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5037\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5038\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-5039\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">exp</span><span class=\"mo\" id=\"MathJax-Span-5040\"></span><span class=\"mo\" id=\"MathJax-Span-5041\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5042\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5043\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5044\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5045\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5046\" style=\"font-family: STIXGeneral-Italic;\">p</span><span class=\"mo\" id=\"MathJax-Span-5047\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5048\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5049\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5050\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5051\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5052\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1011.93em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 11.93em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.066em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mi>i</mi></msub><mo>&gt;</mo><msub><mi>r</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>‚Å°</mo><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>p</mi><mo>,</mo><msub><mi>r</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><mrow><mi>exp</mi><mo>‚Å°</mo><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>p</mi><mo>,</mo><msub><mi>r</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>+</mo><mi>exp</mi><mo>‚Å°</mo><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>p</mi><mo>,</mo><msub><mi>r</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-317\">P(r_i > r_j) = \\frac{\\exp(r_\\phi(p, r_i))}{\\exp(r_\\phi(p, r_i)) + \\exp(r_\\phi(p, r_j))}</script>\n  </li>\n  <li>\n    <p>The corresponding loss function is:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-318-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>L</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03D5;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo>&amp;#x2212;</mo><mi>log</mi><mo>&amp;#x2061;</mo><mi>&amp;#x03C3;</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>p</mi><mo>,</mo><msub><mi>r</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>p</mi><mo>,</mo><msub><mi>r</mi><mi>j</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5053\" style=\"width: 16.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 14.117em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1014.07em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5054\"><span class=\"texatom\" id=\"MathJax-Span-5055\"><span class=\"mrow\" id=\"MathJax-Span-5056\"><span class=\"mi\" id=\"MathJax-Span-5057\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∏</span></span></span><span class=\"mo\" id=\"MathJax-Span-5058\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5059\" style=\"font-family: STIXGeneral-Italic;\">œï</span><span class=\"mo\" id=\"MathJax-Span-5060\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5061\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-5062\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-5063\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-5064\"></span><span class=\"mi\" id=\"MathJax-Span-5065\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">œÉ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5066\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5067\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5068\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5069\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5070\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5071\" style=\"font-family: STIXGeneral-Italic;\">p</span><span class=\"mo\" id=\"MathJax-Span-5072\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5073\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5074\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5075\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5076\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5077\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-5078\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5079\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5080\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5081\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5082\" style=\"font-family: STIXGeneral-Italic;\">p</span><span class=\"mo\" id=\"MathJax-Span-5083\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5084\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5085\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5086\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5087\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5088\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">L</mi></mrow><mo stretchy=\"false\">(</mo><mi>œï</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo>‚àí</mo><mi>log</mi><mo>‚Å°</mo><mi>œÉ</mi><mo stretchy=\"false\">(</mo><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>p</mi><mo>,</mo><msub><mi>r</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>p</mi><mo>,</mo><msub><mi>r</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-318\">\\mathcal{L}(\\phi) = -\\log \\sigma(r_\\phi(p, r_i) - r_\\phi(p, r_j))</script>\n\n    <ul>\n      <li>\n        <p>where:</p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-319-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5089\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5090\"><span class=\"mi\" id=\"MathJax-Span-5091\" style=\"font-family: STIXGeneral-Italic;\">œÉ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÉ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-319\">\\sigma</script> is the sigmoid function,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-320-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5092\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.89em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5093\"><span class=\"msubsup\" id=\"MathJax-Span-5094\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5095\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5096\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>œï</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-320\">r_\\phi</script> is the reward model,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-321-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5097\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5098\"><span class=\"mi\" id=\"MathJax-Span-5099\" style=\"font-family: STIXGeneral-Italic;\">p</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>p</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-321\">p</script> is the prompt,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-322-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>i</mi></msub><mo>,</mo><msub><mi>r</mi><mi>j</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5100\" style=\"width: 2.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1001.83em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5101\"><span class=\"msubsup\" id=\"MathJax-Span-5102\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5103\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5104\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5105\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5106\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5107\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5108\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>i</mi></msub><mo>,</mo><msub><mi>r</mi><mi>j</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-322\">r_i, r_j</script> are two responses being compared.</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>This formulation ensures that the reward model learns to assign higher scores to responses more preferred by humans. A <strong>key implementation detail</strong>: the reward for <strong>partial responses</strong> is always 0; only <strong>complete</strong> responses receive a non-zero scalar score. This design encourages the generation of coherent and full outputs during policy training.</p>\n  </li>\n</ul>\n<p>The reward model is trained using ranked comparison data and assigns a scalar score to model-generated responses. A common formulation of the pairwise loss uses the <strong>Bradley-Terry model</strong>, where the probability that a rater prefers response <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-315-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4984\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4985\"><span class=\"msubsup\" id=\"MathJax-Span-4986\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4987\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4988\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-315\">r_i</script> over <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-316-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>j</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4989\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-4990\"><span class=\"msubsup\" id=\"MathJax-Span-4991\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-4992\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-4993\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>j</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-316\">r_j</script> is:</p>\n<p>The corresponding loss function is:</p>\n<ul>\n      <li>\n        <p>where:</p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-319-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5089\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5090\"><span class=\"mi\" id=\"MathJax-Span-5091\" style=\"font-family: STIXGeneral-Italic;\">œÉ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÉ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-319\">\\sigma</script> is the sigmoid function,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-320-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5092\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.89em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5093\"><span class=\"msubsup\" id=\"MathJax-Span-5094\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5095\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5096\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>œï</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-320\">r_\\phi</script> is the reward model,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-321-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5097\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5098\"><span class=\"mi\" id=\"MathJax-Span-5099\" style=\"font-family: STIXGeneral-Italic;\">p</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>p</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-321\">p</script> is the prompt,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-322-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>i</mi></msub><mo>,</mo><msub><mi>r</mi><mi>j</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5100\" style=\"width: 2.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1001.83em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5101\"><span class=\"msubsup\" id=\"MathJax-Span-5102\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5103\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5104\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5105\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5106\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5107\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5108\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>i</mi></msub><mo>,</mo><msub><mi>r</mi><mi>j</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-322\">r_i, r_j</script> are two responses being compared.</li>\n        </ul>\n      </li>\n    </ul>\n<p>where:</p>\n<ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-319-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5089\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5090\"><span class=\"mi\" id=\"MathJax-Span-5091\" style=\"font-family: STIXGeneral-Italic;\">œÉ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÉ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-319\">\\sigma</script> is the sigmoid function,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-320-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5092\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.89em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5093\"><span class=\"msubsup\" id=\"MathJax-Span-5094\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5095\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5096\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>œï</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-320\">r_\\phi</script> is the reward model,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-321-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5097\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5098\"><span class=\"mi\" id=\"MathJax-Span-5099\" style=\"font-family: STIXGeneral-Italic;\">p</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>p</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-321\">p</script> is the prompt,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-322-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>i</mi></msub><mo>,</mo><msub><mi>r</mi><mi>j</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5100\" style=\"width: 2.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.826em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1001.83em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5101\"><span class=\"msubsup\" id=\"MathJax-Span-5102\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5103\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5104\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5105\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5106\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5107\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5108\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">j<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>i</mi></msub><mo>,</mo><msub><mi>r</mi><mi>j</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-322\">r_i, r_j</script> are two responses being compared.</li>\n        </ul>\n<p>This formulation ensures that the reward model learns to assign higher scores to responses more preferred by humans. A <strong>key implementation detail</strong>: the reward for <strong>partial responses</strong> is always 0; only <strong>complete</strong> responses receive a non-zero scalar score. This design encourages the generation of coherent and full outputs during policy training.</p>\n<h6 id=\"instructgpts-pairwise-cross-entropy-ranking-loss\">InstructGPT‚Äôs Pairwise Cross-entropy Ranking Loss</h6>\n<ul>\n  <li>\n    <p><a href=\"https://arxiv.org/abs/2203.02155\">Ouyang et al. (2022)</a>‚Äôs offers a practical implementation of this formulation, the reward model is trained using a <strong>pairwise cross-entropy ranking loss</strong>, because it directly models the probability that one completion is preferred over another using a sigmoid over the reward difference, and optimizes this probability via a cross-entropy objective:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-323-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>L</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>RM</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo>&amp;#x2212;</mo><mfrac><mn>1</mn><mrow><mrow class=&quot;MJX-TeXAtom-OPEN&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>(</mo></mrow><mfrac linethickness=&quot;0&quot;><mi>K</mi><mn>2</mn></mfrac><mrow class=&quot;MJX-TeXAtom-CLOSE&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>)</mo></mrow></mrow></mfrac><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>w</mi></msub><mo>,</mo><msub><mi>y</mi><mi>l</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x223C;</mo><mi>D</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;>[</mo></mrow><mi>log</mi><mo>&amp;#x2061;</mo><mi>&amp;#x03C3;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>(</mo></mrow><msub><mi>r</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>w</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>r</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>l</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.623em&quot; minsize=&quot;1.623em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5109\" style=\"width: 27.398em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 22.815em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.982em, 1022.61em, 4.951em, -999.997em); top: -3.487em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5110\"><span class=\"msubsup\" id=\"MathJax-Span-5111\"><span style=\"display: inline-block; position: relative; width: 1.878em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-5112\"><span class=\"mrow\" id=\"MathJax-Span-5113\"><span class=\"mi\" id=\"MathJax-Span-5114\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∏</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-5115\"><span class=\"mrow\" id=\"MathJax-Span-5116\"><span class=\"mtext\" id=\"MathJax-Span-5117\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">RM</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5118\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5119\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5120\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5121\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mo\" id=\"MathJax-Span-5122\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àí</span><span class=\"mfrac\" id=\"MathJax-Span-5123\"><span style=\"display: inline-block; position: relative; width: 1.669em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.42em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.258em;\"><span class=\"mn\" id=\"MathJax-Span-5124\" style=\"font-family: STIXGeneral-Regular;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(2.919em, 1001.41em, 4.586em, -999.997em); top: -3.122em; left: 50%; margin-left: -0.779em;\"><span class=\"mrow\" id=\"MathJax-Span-5125\"><span class=\"TeXmathchoice\" id=\"MathJax-Span-5126\"><span class=\"texatom\" id=\"MathJax-Span-5127\"><span class=\"mrow\" id=\"MathJax-Span-5128\"><span class=\"mo\" id=\"MathJax-Span-5129\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">(</span></span></span></span></span></span><span class=\"mfrac\" id=\"MathJax-Span-5130\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.52em, 4.169em, -999.997em); top: -4.477em; left: 50%; margin-left: -0.258em;\"><span class=\"mi\" id=\"MathJax-Span-5131\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.32em, 4.169em, -999.997em); top: -3.643em; left: 50%; margin-left: -0.154em;\"><span class=\"mn\" id=\"MathJax-Span-5132\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"TeXmathchoice\" id=\"MathJax-Span-5133\"><span class=\"texatom\" id=\"MathJax-Span-5134\"><span class=\"mrow\" id=\"MathJax-Span-5135\"><span class=\"mo\" id=\"MathJax-Span-5136\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">)</span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1001.67em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.669em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-5137\"><span style=\"display: inline-block; position: relative; width: 4.065em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-5138\"><span class=\"mrow\" id=\"MathJax-Span-5139\"><span class=\"mi\" id=\"MathJax-Span-5140\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-5141\"><span class=\"mrow\" id=\"MathJax-Span-5142\"><span class=\"mo\" id=\"MathJax-Span-5143\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5144\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5145\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5146\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5147\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-5148\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5149\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5150\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5151\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-5152\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5153\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5154\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"mi\" id=\"MathJax-Span-5155\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">D</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-5156\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-5157\"><span class=\"mo\" id=\"MathJax-Span-5158\" style=\"vertical-align: -0.414em;\"><span style=\"font-family: STIXSizeTwoSym;\">[</span></span></span></span><span class=\"mi\" id=\"MathJax-Span-5159\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">log</span><span class=\"mo\" id=\"MathJax-Span-5160\"></span><span class=\"mi\" id=\"MathJax-Span-5161\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">œÉ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"texatom\" id=\"MathJax-Span-5162\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-5163\"><span class=\"mo\" id=\"MathJax-Span-5164\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">(</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-5165\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5166\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5167\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5168\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5169\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5170\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5171\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5172\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5173\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5174\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5175\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-5176\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5177\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5178\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5179\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5180\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5181\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5182\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5183\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5184\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5185\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-5186\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-5187\"><span class=\"mo\" id=\"MathJax-Span-5188\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">)</span></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-5189\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-5190\"><span class=\"mo\" id=\"MathJax-Span-5191\" style=\"vertical-align: -0.414em;\"><span style=\"font-family: STIXSizeTwoSym;\">]</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.492em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">L</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mtext>RM</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo>‚àí</mo><mfrac><mn>1</mn><mrow><mrow class=\"MJX-TeXAtom-OPEN\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo></mrow><mfrac linethickness=\"0\"><mi>K</mi><mn>2</mn></mfrac><mrow class=\"MJX-TeXAtom-CLOSE\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo></mrow></mrow></mfrac><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>w</mi></msub><mo>,</mo><msub><mi>y</mi><mi>l</mi></msub><mo stretchy=\"false\">)</mo><mo>‚àº</mo><mi>D</mi></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.623em\" minsize=\"1.623em\">[</mo></mrow><mi>log</mi><mo>‚Å°</mo><mi>œÉ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo></mrow><msub><mi>r</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>w</mi></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>r</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>l</mi></msub><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.623em\" minsize=\"1.623em\">]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-323\">\\mathcal{L}_{\\text{RM}}(\\theta)\n= -\\frac{1}{\\binom{K}{2}}\n\\mathbb{E}_{(x, y_w, y_l) \\sim D}\n\\Big[\\log \\sigma\\big(r_\\theta(x,y_w) - r_\\theta(x,y_l)\\big)\\Big]</script>\n\n    <ul>\n      <li>\n        <p>where:</p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-324-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mi>w</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5192\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.99em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5193\"><span class=\"msubsup\" id=\"MathJax-Span-5194\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5195\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5196\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mi>w</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-324\">y_w</script> is the <strong>preferred</strong> completion,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-325-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mi>l</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5197\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.73em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5198\"><span class=\"msubsup\" id=\"MathJax-Span-5199\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5200\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5201\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mi>l</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-325\">y_l</script> is the <strong>dispreferred</strong> (or losing) completion,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-326-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5202\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5203\"><span class=\"mi\" id=\"MathJax-Span-5204\" style=\"font-family: STIXGeneral-Italic;\">œÉ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÉ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-326\">\\sigma</script> is the sigmoid function mapping the score difference to a probability of preference,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-327-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5205\" style=\"width: 3.596em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.971em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.92em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5206\"><span class=\"msubsup\" id=\"MathJax-Span-5207\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5208\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5209\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5210\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5211\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5212\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5213\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5214\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-327\">r_\\theta(x, y)</script> is the reward model‚Äôs scalar output.</li>\n          <li>The <strong>difference</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-328-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>w</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>r</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>l</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5215\" style=\"width: 9.326em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.763em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1007.71em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5216\"><span class=\"msubsup\" id=\"MathJax-Span-5217\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5218\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5219\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5220\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5221\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5222\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5223\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5224\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5225\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5226\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5227\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-5228\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5229\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5230\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5231\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5232\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5233\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5234\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5235\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5236\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5237\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>w</mi></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>r</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>l</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-328\">r_\\theta(x,y_w) - r_\\theta(x,y_l)</script> represents the <strong>log odds</strong> that a human would prefer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-329-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mi>w</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5238\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.99em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5239\"><span class=\"msubsup\" id=\"MathJax-Span-5240\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5241\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5242\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mi>w</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-329\">y_w</script> over <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-330-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mi>l</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5243\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.73em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5244\"><span class=\"msubsup\" id=\"MathJax-Span-5245\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5246\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5247\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mi>l</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-330\">y_l</script>.</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Normalization and Practical Notes</strong>:</p>\n    <ul>\n      <li>Since the reward model‚Äôs loss is <strong>invariant to additive shifts</strong> in reward, it is normalized by adding a bias term so that <strong>labeler demonstrations have mean score 0</strong> before PPO training begins.</li>\n      <li>This ensures that the scale and offset of rewards remain consistent across updates, stabilizing policy learning.</li>\n    </ul>\n  </li>\n</ul>\n<p><a href=\"https://arxiv.org/abs/2203.02155\">Ouyang et al. (2022)</a>‚Äôs offers a practical implementation of this formulation, the reward model is trained using a <strong>pairwise cross-entropy ranking loss</strong>, because it directly models the probability that one completion is preferred over another using a sigmoid over the reward difference, and optimizes this probability via a cross-entropy objective:</p>\n<ul>\n      <li>\n        <p>where:</p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-324-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mi>w</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5192\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.99em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5193\"><span class=\"msubsup\" id=\"MathJax-Span-5194\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5195\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5196\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mi>w</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-324\">y_w</script> is the <strong>preferred</strong> completion,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-325-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mi>l</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5197\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.73em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5198\"><span class=\"msubsup\" id=\"MathJax-Span-5199\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5200\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5201\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mi>l</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-325\">y_l</script> is the <strong>dispreferred</strong> (or losing) completion,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-326-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5202\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5203\"><span class=\"mi\" id=\"MathJax-Span-5204\" style=\"font-family: STIXGeneral-Italic;\">œÉ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÉ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-326\">\\sigma</script> is the sigmoid function mapping the score difference to a probability of preference,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-327-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5205\" style=\"width: 3.596em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.971em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.92em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5206\"><span class=\"msubsup\" id=\"MathJax-Span-5207\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5208\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5209\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5210\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5211\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5212\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5213\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5214\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-327\">r_\\theta(x, y)</script> is the reward model‚Äôs scalar output.</li>\n          <li>The <strong>difference</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-328-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>w</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>r</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>l</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5215\" style=\"width: 9.326em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.763em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1007.71em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5216\"><span class=\"msubsup\" id=\"MathJax-Span-5217\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5218\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5219\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5220\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5221\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5222\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5223\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5224\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5225\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5226\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5227\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-5228\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5229\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5230\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5231\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5232\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5233\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5234\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5235\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5236\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5237\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>w</mi></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>r</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>l</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-328\">r_\\theta(x,y_w) - r_\\theta(x,y_l)</script> represents the <strong>log odds</strong> that a human would prefer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-329-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mi>w</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5238\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.99em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5239\"><span class=\"msubsup\" id=\"MathJax-Span-5240\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5241\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5242\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mi>w</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-329\">y_w</script> over <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-330-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mi>l</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5243\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.73em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5244\"><span class=\"msubsup\" id=\"MathJax-Span-5245\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5246\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5247\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mi>l</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-330\">y_l</script>.</li>\n        </ul>\n      </li>\n    </ul>\n<p>where:</p>\n<ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-324-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mi>w</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5192\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.99em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5193\"><span class=\"msubsup\" id=\"MathJax-Span-5194\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5195\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5196\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mi>w</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-324\">y_w</script> is the <strong>preferred</strong> completion,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-325-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mi>l</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5197\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.73em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5198\"><span class=\"msubsup\" id=\"MathJax-Span-5199\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5200\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5201\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mi>l</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-325\">y_l</script> is the <strong>dispreferred</strong> (or losing) completion,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-326-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5202\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5203\"><span class=\"mi\" id=\"MathJax-Span-5204\" style=\"font-family: STIXGeneral-Italic;\">œÉ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÉ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-326\">\\sigma</script> is the sigmoid function mapping the score difference to a probability of preference,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-327-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5205\" style=\"width: 3.596em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.971em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.92em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5206\"><span class=\"msubsup\" id=\"MathJax-Span-5207\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5208\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5209\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5210\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5211\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5212\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5213\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5214\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-327\">r_\\theta(x, y)</script> is the reward model‚Äôs scalar output.</li>\n          <li>The <strong>difference</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-328-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>w</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>r</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>l</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5215\" style=\"width: 9.326em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.763em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1007.71em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5216\"><span class=\"msubsup\" id=\"MathJax-Span-5217\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5218\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5219\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5220\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5221\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5222\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5223\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5224\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5225\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5226\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5227\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-5228\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5229\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5230\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5231\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5232\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5233\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5234\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5235\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5236\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5237\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>w</mi></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>r</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>l</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-328\">r_\\theta(x,y_w) - r_\\theta(x,y_l)</script> represents the <strong>log odds</strong> that a human would prefer <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-329-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mi>w</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5238\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.99em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5239\"><span class=\"msubsup\" id=\"MathJax-Span-5240\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5241\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5242\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mi>w</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-329\">y_w</script> over <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-330-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mi>l</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5243\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.73em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5244\"><span class=\"msubsup\" id=\"MathJax-Span-5245\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5246\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5247\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mi>l</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-330\">y_l</script>.</li>\n        </ul>\n<p><strong>Normalization and Practical Notes</strong>:</p>\n<ul>\n      <li>Since the reward model‚Äôs loss is <strong>invariant to additive shifts</strong> in reward, it is normalized by adding a bias term so that <strong>labeler demonstrations have mean score 0</strong> before PPO training begins.</li>\n      <li>This ensures that the scale and offset of rewards remain consistent across updates, stabilizing policy learning.</li>\n    </ul>\n<h5 id=\"training-data-2\">Training Data</h5>\n<ul>\n  <li>\n    <p>The training data for reward models comes from <strong>human preference labeling</strong>:</p>\n\n    <ul>\n      <li>A set of prompts <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-331-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5248\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5249\"><span class=\"mi\" id=\"MathJax-Span-5250\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-331\">x</script> is sampled (often from SFT datasets or model-generated prompts).</li>\n      <li>Multiple responses are generated by one or more models.</li>\n      <li>Human annotators rank or choose preferred responses based on <strong>helpfulness</strong>, <strong>accuracy</strong>, <strong>harmlessness</strong>, or <strong>style</strong> criteria.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The collected comparisons yield tuples <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-332-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>w</mi></msub><mo>,</mo><msub><mi>y</mi><mi>l</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5251\" style=\"width: 4.586em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.805em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.75em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5252\"><span class=\"mo\" id=\"MathJax-Span-5253\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5254\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5255\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5256\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5257\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5258\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5259\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5260\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5261\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5262\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5263\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>w</mi></msub><mo>,</mo><msub><mi>y</mi><mi>l</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-332\">(x, y_w, y_l)</script>, forming the basis for pairwise training.</p>\n  </li>\n  <li>\n    <p>Datasets of this form can range from <strong>50,000 to several million comparisons</strong>, depending on the scale of the deployment.\nFor example:</p>\n\n    <ul>\n      <li>The <strong>InstructGPT</strong> reward model used approximately <strong>30,000‚Äì40,000 labeled comparisons</strong>.</li>\n      <li>Larger RLHF systems (e.g., Anthropic‚Äôs Constitutional AI) use <strong>100K‚Äì1M+</strong> pairs.</li>\n      <li>Recent work such as <strong>RLHF on LLaMA 2</strong> and <strong>OpenAI‚Äôs GPT-4-turbo alignment</strong> use data from extensive human evaluation and preference modeling pipelines.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Synthetic preference data</strong> (generated using smaller models or heuristics) is also increasingly used to supplement limited human data, as in Self-Instruct by <a href=\"https://arxiv.org/abs/2212.10560\">Wang et al. (2022)</a>.</p>\n  </li>\n</ul>\n<p>The training data for reward models comes from <strong>human preference labeling</strong>:</p>\n<ul>\n      <li>A set of prompts <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-331-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5248\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5249\"><span class=\"mi\" id=\"MathJax-Span-5250\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-331\">x</script> is sampled (often from SFT datasets or model-generated prompts).</li>\n      <li>Multiple responses are generated by one or more models.</li>\n      <li>Human annotators rank or choose preferred responses based on <strong>helpfulness</strong>, <strong>accuracy</strong>, <strong>harmlessness</strong>, or <strong>style</strong> criteria.</li>\n    </ul>\n<p>The collected comparisons yield tuples <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-332-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>w</mi></msub><mo>,</mo><msub><mi>y</mi><mi>l</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5251\" style=\"width: 4.586em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.805em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.75em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5252\"><span class=\"mo\" id=\"MathJax-Span-5253\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5254\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5255\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5256\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5257\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5258\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5259\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5260\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5261\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5262\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">l<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5263\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><msub><mi>y</mi><mi>w</mi></msub><mo>,</mo><msub><mi>y</mi><mi>l</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-332\">(x, y_w, y_l)</script>, forming the basis for pairwise training.</p>\n<p>Datasets of this form can range from <strong>50,000 to several million comparisons</strong>, depending on the scale of the deployment.\nFor example:</p>\n<ul>\n      <li>The <strong>InstructGPT</strong> reward model used approximately <strong>30,000‚Äì40,000 labeled comparisons</strong>.</li>\n      <li>Larger RLHF systems (e.g., Anthropic‚Äôs Constitutional AI) use <strong>100K‚Äì1M+</strong> pairs.</li>\n      <li>Recent work such as <strong>RLHF on LLaMA 2</strong> and <strong>OpenAI‚Äôs GPT-4-turbo alignment</strong> use data from extensive human evaluation and preference modeling pipelines.</li>\n    </ul>\n<p><strong>Synthetic preference data</strong> (generated using smaller models or heuristics) is also increasingly used to supplement limited human data, as in Self-Instruct by <a href=\"https://arxiv.org/abs/2212.10560\">Wang et al. (2022)</a>.</p>\n<h5 id=\"model-size\">Model Size</h5>\n<ul>\n  <li>\n    <p>The reward model is usually <strong>smaller</strong> than the policy model (especially since it doesn‚Äôt have to incorporate the unembedding layers), since it only provides scalar evaluations and doesn‚Äôt need to generate text.</p>\n\n    <ul>\n      <li>Common sizes range from <strong>1B to 13B parameters</strong> for large-scale pipelines.</li>\n      <li>For example:\n        <ul>\n          <li>InstructGPT used reward models of <strong>6B parameters</strong>, while the policy model was 175B.</li>\n          <li>Open-source LLaMA 2‚ÄìChat models used reward models of <strong>7B‚Äì13B parameters</strong>.</li>\n        </ul>\n      </li>\n      <li>Compact reward models are often used to reduce the cost of reward evaluation during RLHF training (since thousands of responses must be scored per update).</li>\n    </ul>\n  </li>\n  <li>\n    <p>Some recent methods, such as <strong>Direct Preference Optimization (DPO)</strong> by <a href=\"https://arxiv.org/abs/2305.18290\">Rafailov et al. (2023)</a>, avoid training a separate reward model altogether, instead <strong>implicitizing</strong> it through log-probability ratios between the policy and reference models.</p>\n  </li>\n</ul>\n<p>The reward model is usually <strong>smaller</strong> than the policy model (especially since it doesn‚Äôt have to incorporate the unembedding layers), since it only provides scalar evaluations and doesn‚Äôt need to generate text.</p>\n<ul>\n      <li>Common sizes range from <strong>1B to 13B parameters</strong> for large-scale pipelines.</li>\n      <li>For example:\n        <ul>\n          <li>InstructGPT used reward models of <strong>6B parameters</strong>, while the policy model was 175B.</li>\n          <li>Open-source LLaMA 2‚ÄìChat models used reward models of <strong>7B‚Äì13B parameters</strong>.</li>\n        </ul>\n      </li>\n      <li>Compact reward models are often used to reduce the cost of reward evaluation during RLHF training (since thousands of responses must be scored per update).</li>\n    </ul>\n<ul>\n          <li>InstructGPT used reward models of <strong>6B parameters</strong>, while the policy model was 175B.</li>\n          <li>Open-source LLaMA 2‚ÄìChat models used reward models of <strong>7B‚Äì13B parameters</strong>.</li>\n        </ul>\n<p>Some recent methods, such as <strong>Direct Preference Optimization (DPO)</strong> by <a href=\"https://arxiv.org/abs/2305.18290\">Rafailov et al. (2023)</a>, avoid training a separate reward model altogether, instead <strong>implicitizing</strong> it through log-probability ratios between the policy and reference models.</p>\n<h5 id=\"prevention-of-over-optimization\">Prevention of Over-optimization</h5>\n<ul>\n  <li>\n    <p>To prevent the fine-tuned model from overfitting or drifting too far from its pretrained distribution, <strong>KL divergence penalties</strong> are applied during RL:</p>\n\n    <ul>\n      <li>KL divergence measures the difference between the output distributions of the current policy and the original (pretrained) model.</li>\n      <li>This constraint regularizes learning and <strong>ensures that the fine-tuned model does not deviate excessively</strong>, preserving safety and coherence.</li>\n    </ul>\n  </li>\n  <li>\n    <p>This KL penalty is crucial for maintaining a balance between alignment and generalization.</p>\n  </li>\n</ul>\n<p>To prevent the fine-tuned model from overfitting or drifting too far from its pretrained distribution, <strong>KL divergence penalties</strong> are applied during RL:</p>\n<ul>\n      <li>KL divergence measures the difference between the output distributions of the current policy and the original (pretrained) model.</li>\n      <li>This constraint regularizes learning and <strong>ensures that the fine-tuned model does not deviate excessively</strong>, preserving safety and coherence.</li>\n    </ul>\n<p>This KL penalty is crucial for maintaining a balance between alignment and generalization.</p>\n<h5 id=\"evaluation-and-monitoring\">Evaluation and Monitoring</h5>\n<ul>\n  <li>Reward models are evaluated on <strong>held-out preference sets</strong> using accuracy metrics‚Äîhow often the model correctly predicts the human-preferred response.</li>\n  <li>Typical accuracy benchmarks range between <strong>65‚Äì80%</strong>, depending on domain and data quality.</li>\n  <li>Regular retraining and drift monitoring are essential, since the distribution of policy outputs changes as the policy improves.</li>\n</ul>\n<h5 id=\"comparative-analysis-12\">Comparative Analysis</h5>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Aspect</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Role</strong></td>\n<td class=\"tg-tleft-valign-second\">Translates human preference into scalar rewards</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Training Objective</strong></td>\n<td class=\"tg-tleft-valign-second\">Pairwise ranking loss on human preference data</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Architecture</strong></td>\n<td class=\"tg-tleft-valign-second\">Transformer with scalar reward head</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Data</strong></td>\n<td class=\"tg-tleft-valign-second\">Human-ranked prompt‚Äìresponse pairs (tens of thousands to millions)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Model Size</strong></td>\n<td class=\"tg-tleft-valign-second\">Typically 1B‚Äì13B parameters</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Reference Papers</strong></td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/2203.02155\">Ouyang et al., 2022</a>; <a href=\"https://arxiv.org/abs/2305.18290\">Rafailov et al., 2023</a></td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Aspect</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Role</strong></td>\n<td class=\"tg-tleft-valign-second\">Translates human preference into scalar rewards</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Training Objective</strong></td>\n<td class=\"tg-tleft-valign-second\">Pairwise ranking loss on human preference data</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Architecture</strong></td>\n<td class=\"tg-tleft-valign-second\">Transformer with scalar reward head</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Data</strong></td>\n<td class=\"tg-tleft-valign-second\">Human-ranked prompt‚Äìresponse pairs (tens of thousands to millions)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Model Size</strong></td>\n<td class=\"tg-tleft-valign-second\">Typically 1B‚Äì13B parameters</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Reference Papers</strong></td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://arxiv.org/abs/2203.02155\">Ouyang et al., 2022</a>; <a href=\"https://arxiv.org/abs/2305.18290\">Rafailov et al., 2023</a></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"value-model\">Value Model</h4>\n<ul>\n  <li>The <strong>value model</strong> (sometimes called the <strong>critic model</strong>) plays a critical but often under-discussed role in LLM reinforcement learning pipelines such as RLHF and RLAIF (Reinforcement Learning from AI Feedback).</li>\n  <li>While the <strong>reward model</strong> provides <em>immediate feedback</em> for a given response, the <strong>value model</strong> estimates the <em>expected future reward</em> from a state (or state‚Äìprompt pair), enabling <strong>advantage estimation</strong>, <strong>variance reduction</strong>, and <strong>stabilized policy updates</strong>‚Äîconcepts foundational to modern policy-gradient methods like PPO.</li>\n  <li>\n    <p>In RLHF implementations such as <a href=\"https://arxiv.org/abs/2203.02155\"><strong>InstructGPT</strong></a> by Ouyang et al. (2022), a value model (critic) is initialized from the reward model and is used to compute advantages in the PPO update:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-333-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5264\" style=\"width: 7.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.94em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5265\"><span class=\"msubsup\" id=\"MathJax-Span-5266\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5267\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5268\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5269\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5270\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5271\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5272\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5273\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-5274\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5275\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5276\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5277\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5278\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5279\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>‚àí</mo><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-333\">A_t = r_t - V(s_t)</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-334-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5280\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5281\"><span class=\"msubsup\" id=\"MathJax-Span-5282\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5283\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5284\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-334\">r_t</script> is the observed reward (from the <strong>reward model</strong>) and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-335-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5285\" style=\"width: 2.607em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.09em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5286\"><span class=\"mi\" id=\"MathJax-Span-5287\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5288\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5289\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5290\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5291\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5292\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-335\">V(s_t)</script> is the <strong>value model‚Äôs</strong> prediction. This follows the standard actor‚Äìcritic formulation in PPO.</li>\n    </ul>\n  </li>\n</ul>\n<p>In RLHF implementations such as <a href=\"https://arxiv.org/abs/2203.02155\"><strong>InstructGPT</strong></a> by Ouyang et al. (2022), a value model (critic) is initialized from the reward model and is used to compute advantages in the PPO update:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-334-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5280\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.68em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5281\"><span class=\"msubsup\" id=\"MathJax-Span-5282\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5283\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5284\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-334\">r_t</script> is the observed reward (from the <strong>reward model</strong>) and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-335-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5285\" style=\"width: 2.607em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.09em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5286\"><span class=\"mi\" id=\"MathJax-Span-5287\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5288\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5289\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5290\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5291\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5292\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-335\">V(s_t)</script> is the <strong>value model‚Äôs</strong> prediction. This follows the standard actor‚Äìcritic formulation in PPO.</li>\n    </ul>\n<h5 id=\"function-3\">Function</h5>\n<ul>\n  <li>\n    <p>In the context of LLM alignment, the value model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-336-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5293\" style=\"width: 2.815em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.29em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5294\"><span class=\"msubsup\" id=\"MathJax-Span-5295\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5296\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5297\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5298\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5299\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5300\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-336\">V_\\phi(x)</script> or <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-337-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5301\" style=\"width: 3.961em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.284em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.23em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5302\"><span class=\"msubsup\" id=\"MathJax-Span-5303\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5304\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5305\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5306\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5307\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5308\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5309\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5310\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-337\">V_\\phi(x, y)</script> predicts the <strong>expected return</strong> (i.e., cumulative reward) for a given prompt <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-338-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5311\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5312\"><span class=\"mi\" id=\"MathJax-Span-5313\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-338\">x</script> or prompt‚Äìresponse pair <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-339-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5314\" style=\"width: 2.607em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.09em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5315\"><span class=\"mo\" id=\"MathJax-Span-5316\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5317\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5318\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5319\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5320\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-339\">(x,y)</script>.</p>\n  </li>\n  <li>\n    <p>It serves the same theoretical role as the <strong>critic</strong> in an actor‚Äìcritic framework, providing a learned baseline that allows the policy (actor) to improve using lower-variance gradient estimates.</p>\n  </li>\n  <li>\n    <p>The fundamental definition is</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-340-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2248;</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>a</mi><mo>&amp;#x223C;</mo><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5321\" style=\"width: 10.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 8.909em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1008.8em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5322\"><span class=\"msubsup\" id=\"MathJax-Span-5323\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5324\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5325\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5326\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5327\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-5328\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5329\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚âà</span><span class=\"msubsup\" id=\"MathJax-Span-5330\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-5331\"><span class=\"mrow\" id=\"MathJax-Span-5332\"><span class=\"mi\" id=\"MathJax-Span-5333\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-5334\"><span class=\"mrow\" id=\"MathJax-Span-5335\"><span class=\"mi\" id=\"MathJax-Span-5336\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-5337\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"mi\" id=\"MathJax-Span-5338\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-5339\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5340\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mi\" id=\"MathJax-Span-5341\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-5342\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5343\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-5344\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5345\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-5346\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5347\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>‚âà</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>a</mi><mo>‚àº</mo><mi>œÄ</mi><mi>Œ∏</mi></mrow></msub><mo stretchy=\"false\">[</mo><mi>R</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-340\">V_\\phi(s) \\approx \\mathbb{E}_{a\\sim\\pi\\theta} [R(s,a)]</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-341-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5348\" style=\"width: 3.232em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.61em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5349\"><span class=\"mi\" id=\"MathJax-Span-5350\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-5351\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5352\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-5353\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5354\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-5355\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-341\">R(s,a)</script> is the return or scalar reward obtained when the policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-342-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5356\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5357\"><span class=\"msubsup\" id=\"MathJax-Span-5358\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5359\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5360\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-342\">\\pi_\\theta</script> takes action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-343-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5361\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5362\"><span class=\"mi\" id=\"MathJax-Span-5363\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-343\">a</script> in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-344-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5364\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5365\"><span class=\"mi\" id=\"MathJax-Span-5366\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-344\">s</script>.</li>\n    </ul>\n  </li>\n  <li>\n    <p>In the language modeling context, the ‚Äústate‚Äù corresponds to the <strong>prompt or prefix</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-345-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5367\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5368\"><span class=\"mi\" id=\"MathJax-Span-5369\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-345\">x</script>, and the ‚Äúaction‚Äù corresponds to the <strong>generated token sequence</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-346-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5370\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5371\"><span class=\"mi\" id=\"MathJax-Span-5372\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-346\">y</script>.</p>\n  </li>\n  <li>\n    <p>The value model enables several key operations:</p>\n\n    <ol>\n      <li><strong>Advantage estimation:</strong>\n        <ul>\n          <li>Used to compute a baseline-corrected signal for PPO or similar algorithms:</li>\n        </ul>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-347-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5373\" style=\"width: 11.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.846em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1009.79em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5374\"><span class=\"texatom\" id=\"MathJax-Span-5375\"><span class=\"mrow\" id=\"MathJax-Span-5376\"><span class=\"munderover\" id=\"MathJax-Span-5377\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5378\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-5379\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5380\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5381\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5382\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5383\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5384\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5385\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-5386\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5387\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5388\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5389\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5390\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5391\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5392\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-5393\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5394\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5395\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5396\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5397\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5398\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>r</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-347\">\\hat{A}(x,y) = r(x,y) - V_\\phi(x)</script>\n\n        <ul>\n          <li>‚Ä¶ or, at a token-wise level, via temporal-difference (TD) methods:</li>\n        </ul>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-348-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>t</mi></msub><mo>=</mo><msub><mi>&amp;#x03B4;</mi><mi>t</mi></msub><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B3;</mi><mi>&amp;#x03BB;</mi><mo stretchy=&quot;false&quot;>)</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5399\" style=\"width: 8.857em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1007.35em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5400\"><span class=\"msubsup\" id=\"MathJax-Span-5401\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-5402\"><span class=\"mrow\" id=\"MathJax-Span-5403\"><span class=\"munderover\" id=\"MathJax-Span-5404\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5405\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-5406\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5407\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5408\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5409\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5410\" style=\"font-family: STIXGeneral-Italic;\">Œ¥</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5411\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5412\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mo\" id=\"MathJax-Span-5413\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">(</span><span class=\"mi\" id=\"MathJax-Span-5414\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-5415\" style=\"font-family: STIXGeneral-Italic;\">Œª</span><span class=\"mo\" id=\"MathJax-Span-5416\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-5417\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-5418\"><span class=\"mrow\" id=\"MathJax-Span-5419\"><span class=\"munderover\" id=\"MathJax-Span-5420\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5421\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-5422\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-5423\"><span class=\"mrow\" id=\"MathJax-Span-5424\"><span class=\"mi\" id=\"MathJax-Span-5425\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5426\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-5427\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>t</mi></msub><mo>=</mo><msub><mi>Œ¥</mi><mi>t</mi></msub><mo>+</mo><mo stretchy=\"false\">(</mo><mi>Œ≥</mi><mi>Œª</mi><mo stretchy=\"false\">)</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-348\">\\hat{A}_t = \\delta_t + (\\gamma \\lambda)\\hat{A}_{t+1}</script>\n\n        <ul>\n          <li>‚Ä¶ with:</li>\n        </ul>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-349-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>&amp;#x03B4;</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B3;</mi><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5428\" style=\"width: 13.388em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 11.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1011.1em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5429\"><span class=\"msubsup\" id=\"MathJax-Span-5430\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5431\" style=\"font-family: STIXGeneral-Italic;\">Œ¥</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5432\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5433\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5434\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5435\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5436\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5437\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-5438\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-5439\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5440\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5441\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5442\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5443\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5444\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-5445\"><span class=\"mrow\" id=\"MathJax-Span-5446\"><span class=\"mi\" id=\"MathJax-Span-5447\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5448\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-5449\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5450\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5451\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-5452\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5453\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5454\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5455\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5456\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5457\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5458\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5459\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>Œ¥</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>Œ≥</mi><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-349\">\\delta_t = r_t + \\gamma V_\\phi(s_{t+1}) - V_\\phi(s_t)</script>\n\n        <ul>\n          <li>In <strong>bandit-style</strong> settings like RLHF (prompt <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-350-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5460\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5461\"><span class=\"mo\" id=\"MathJax-Span-5462\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-350\">\\rightarrow</script> response <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-351-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5463\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5464\"><span class=\"mo\" id=\"MathJax-Span-5465\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-351\">\\rightarrow</script> single reward), this simplifies to <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-352-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5466\" style=\"width: 7.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.94em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5467\"><span class=\"msubsup\" id=\"MathJax-Span-5468\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5469\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5470\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5471\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5472\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5473\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5474\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5475\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-5476\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5477\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5478\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5479\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5480\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5481\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>‚àí</mo><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-352\">A_t = r_t - V(s_t)</script>, as the episode length is one. The short-horizon ‚Äúbandit‚Äù structure still benefits from the critic, since it stabilizes training and reduces gradient variance.</li>\n        </ul>\n      </li>\n      <li><strong>Variance reduction:</strong>\n        <ul>\n          <li>By learning a baseline for expected reward, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-353-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5482\" style=\"width: 2.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.14em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5483\"><span class=\"msubsup\" id=\"MathJax-Span-5484\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5485\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5486\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5487\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5488\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-5489\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-353\">V_\\phi(s)</script> removes state-dependent bias and allows the policy gradient to focus on relative action quality.</li>\n        </ul>\n      </li>\n      <li><strong>Critic-driven generalization:</strong>\n        <ul>\n          <li>The critic can generalize expected reward patterns across prompts, enabling continual improvement even when human preference labels are unavailable.</li>\n        </ul>\n      </li>\n    </ol>\n\n    <ul>\n      <li>These functions mirror classical actor‚Äìcritic frameworks, such as those in <a href=\"https://papers.nips.cc/paper/2000/hash/60941600aaa93c7e3de7729355a0913e-Abstract.html\">Konda and Tsitsiklis (2000)</a>, but are adapted to the autoregressive, token-level structure of language models.</li>\n    </ul>\n  </li>\n</ul>\n<p>In the context of LLM alignment, the value model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-336-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5293\" style=\"width: 2.815em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.29em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5294\"><span class=\"msubsup\" id=\"MathJax-Span-5295\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5296\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5297\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5298\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5299\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5300\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-336\">V_\\phi(x)</script> or <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-337-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5301\" style=\"width: 3.961em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.284em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.23em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5302\"><span class=\"msubsup\" id=\"MathJax-Span-5303\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5304\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5305\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5306\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5307\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5308\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5309\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5310\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-337\">V_\\phi(x, y)</script> predicts the <strong>expected return</strong> (i.e., cumulative reward) for a given prompt <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-338-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5311\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5312\"><span class=\"mi\" id=\"MathJax-Span-5313\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-338\">x</script> or prompt‚Äìresponse pair <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-339-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5314\" style=\"width: 2.607em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.138em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.09em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5315\"><span class=\"mo\" id=\"MathJax-Span-5316\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5317\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5318\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5319\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5320\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-339\">(x,y)</script>.</p>\n<p>It serves the same theoretical role as the <strong>critic</strong> in an actor‚Äìcritic framework, providing a learned baseline that allows the policy (actor) to improve using lower-variance gradient estimates.</p>\n<p>The fundamental definition is</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-341-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5348\" style=\"width: 3.232em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.659em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.61em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5349\"><span class=\"mi\" id=\"MathJax-Span-5350\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-5351\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5352\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-5353\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5354\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-5355\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-341\">R(s,a)</script> is the return or scalar reward obtained when the policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-342-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5356\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5357\"><span class=\"msubsup\" id=\"MathJax-Span-5358\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5359\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5360\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-342\">\\pi_\\theta</script> takes action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-343-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5361\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5362\"><span class=\"mi\" id=\"MathJax-Span-5363\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-343\">a</script> in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-344-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5364\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5365\"><span class=\"mi\" id=\"MathJax-Span-5366\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-344\">s</script>.</li>\n    </ul>\n<p>In the language modeling context, the ‚Äústate‚Äù corresponds to the <strong>prompt or prefix</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-345-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5367\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5368\"><span class=\"mi\" id=\"MathJax-Span-5369\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-345\">x</script>, and the ‚Äúaction‚Äù corresponds to the <strong>generated token sequence</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-346-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5370\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5371\"><span class=\"mi\" id=\"MathJax-Span-5372\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-346\">y</script>.</p>\n<p>The value model enables several key operations:</p>\n<ol>\n      <li><strong>Advantage estimation:</strong>\n        <ul>\n          <li>Used to compute a baseline-corrected signal for PPO or similar algorithms:</li>\n        </ul>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-347-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5373\" style=\"width: 11.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.846em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1009.79em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5374\"><span class=\"texatom\" id=\"MathJax-Span-5375\"><span class=\"mrow\" id=\"MathJax-Span-5376\"><span class=\"munderover\" id=\"MathJax-Span-5377\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5378\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-5379\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5380\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5381\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5382\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5383\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5384\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5385\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-5386\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5387\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5388\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5389\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5390\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5391\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5392\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-5393\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5394\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5395\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5396\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5397\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5398\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>r</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-347\">\\hat{A}(x,y) = r(x,y) - V_\\phi(x)</script>\n\n        <ul>\n          <li>‚Ä¶ or, at a token-wise level, via temporal-difference (TD) methods:</li>\n        </ul>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-348-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>t</mi></msub><mo>=</mo><msub><mi>&amp;#x03B4;</mi><mi>t</mi></msub><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B3;</mi><mi>&amp;#x03BB;</mi><mo stretchy=&quot;false&quot;>)</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5399\" style=\"width: 8.857em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1007.35em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5400\"><span class=\"msubsup\" id=\"MathJax-Span-5401\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-5402\"><span class=\"mrow\" id=\"MathJax-Span-5403\"><span class=\"munderover\" id=\"MathJax-Span-5404\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5405\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-5406\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5407\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5408\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5409\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5410\" style=\"font-family: STIXGeneral-Italic;\">Œ¥</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5411\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5412\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mo\" id=\"MathJax-Span-5413\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">(</span><span class=\"mi\" id=\"MathJax-Span-5414\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-5415\" style=\"font-family: STIXGeneral-Italic;\">Œª</span><span class=\"mo\" id=\"MathJax-Span-5416\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-5417\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-5418\"><span class=\"mrow\" id=\"MathJax-Span-5419\"><span class=\"munderover\" id=\"MathJax-Span-5420\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5421\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-5422\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-5423\"><span class=\"mrow\" id=\"MathJax-Span-5424\"><span class=\"mi\" id=\"MathJax-Span-5425\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5426\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-5427\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>t</mi></msub><mo>=</mo><msub><mi>Œ¥</mi><mi>t</mi></msub><mo>+</mo><mo stretchy=\"false\">(</mo><mi>Œ≥</mi><mi>Œª</mi><mo stretchy=\"false\">)</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-348\">\\hat{A}_t = \\delta_t + (\\gamma \\lambda)\\hat{A}_{t+1}</script>\n\n        <ul>\n          <li>‚Ä¶ with:</li>\n        </ul>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-349-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>&amp;#x03B4;</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B3;</mi><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5428\" style=\"width: 13.388em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 11.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1011.1em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5429\"><span class=\"msubsup\" id=\"MathJax-Span-5430\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5431\" style=\"font-family: STIXGeneral-Italic;\">Œ¥</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5432\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5433\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5434\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5435\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5436\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5437\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-5438\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-5439\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5440\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5441\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5442\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5443\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5444\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-5445\"><span class=\"mrow\" id=\"MathJax-Span-5446\"><span class=\"mi\" id=\"MathJax-Span-5447\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5448\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-5449\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5450\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5451\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-5452\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5453\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5454\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5455\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5456\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5457\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5458\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5459\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>Œ¥</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>Œ≥</mi><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-349\">\\delta_t = r_t + \\gamma V_\\phi(s_{t+1}) - V_\\phi(s_t)</script>\n\n        <ul>\n          <li>In <strong>bandit-style</strong> settings like RLHF (prompt <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-350-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5460\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5461\"><span class=\"mo\" id=\"MathJax-Span-5462\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-350\">\\rightarrow</script> response <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-351-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5463\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5464\"><span class=\"mo\" id=\"MathJax-Span-5465\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-351\">\\rightarrow</script> single reward), this simplifies to <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-352-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5466\" style=\"width: 7.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.94em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5467\"><span class=\"msubsup\" id=\"MathJax-Span-5468\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5469\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5470\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5471\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5472\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5473\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5474\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5475\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-5476\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5477\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5478\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5479\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5480\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5481\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>‚àí</mo><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-352\">A_t = r_t - V(s_t)</script>, as the episode length is one. The short-horizon ‚Äúbandit‚Äù structure still benefits from the critic, since it stabilizes training and reduces gradient variance.</li>\n        </ul>\n      </li>\n      <li><strong>Variance reduction:</strong>\n        <ul>\n          <li>By learning a baseline for expected reward, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-353-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5482\" style=\"width: 2.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.14em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5483\"><span class=\"msubsup\" id=\"MathJax-Span-5484\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5485\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5486\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5487\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5488\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-5489\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-353\">V_\\phi(s)</script> removes state-dependent bias and allows the policy gradient to focus on relative action quality.</li>\n        </ul>\n      </li>\n      <li><strong>Critic-driven generalization:</strong>\n        <ul>\n          <li>The critic can generalize expected reward patterns across prompts, enabling continual improvement even when human preference labels are unavailable.</li>\n        </ul>\n      </li>\n    </ol>\n<ul>\n          <li>Used to compute a baseline-corrected signal for PPO or similar algorithms:</li>\n        </ul>\n<ul>\n          <li>‚Ä¶ or, at a token-wise level, via temporal-difference (TD) methods:</li>\n        </ul>\n<ul>\n          <li>‚Ä¶ with:</li>\n        </ul>\n<ul>\n          <li>In <strong>bandit-style</strong> settings like RLHF (prompt <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-350-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5460\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5461\"><span class=\"mo\" id=\"MathJax-Span-5462\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-350\">\\rightarrow</script> response <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-351-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5463\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.294em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5464\"><span class=\"mo\" id=\"MathJax-Span-5465\" style=\"font-family: STIXGeneral-Regular;\">‚Üí</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: 0.003em; border-left: 0px solid; width: 0px; height: 0.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">‚Üí</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-351\">\\rightarrow</script> single reward), this simplifies to <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-352-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5466\" style=\"width: 7.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.94em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5467\"><span class=\"msubsup\" id=\"MathJax-Span-5468\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5469\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5470\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5471\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5472\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5473\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5474\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5475\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-5476\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5477\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5478\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5479\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5480\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5481\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>‚àí</mo><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-352\">A_t = r_t - V(s_t)</script>, as the episode length is one. The short-horizon ‚Äúbandit‚Äù structure still benefits from the critic, since it stabilizes training and reduces gradient variance.</li>\n        </ul>\n<ul>\n          <li>By learning a baseline for expected reward, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-353-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5482\" style=\"width: 2.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.19em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.14em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5483\"><span class=\"msubsup\" id=\"MathJax-Span-5484\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5485\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5486\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5487\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5488\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-5489\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-353\">V_\\phi(s)</script> removes state-dependent bias and allows the policy gradient to focus on relative action quality.</li>\n        </ul>\n<ul>\n          <li>The critic can generalize expected reward patterns across prompts, enabling continual improvement even when human preference labels are unavailable.</li>\n        </ul>\n<ul>\n      <li>These functions mirror classical actor‚Äìcritic frameworks, such as those in <a href=\"https://papers.nips.cc/paper/2000/hash/60941600aaa93c7e3de7729355a0913e-Abstract.html\">Konda and Tsitsiklis (2000)</a>, but are adapted to the autoregressive, token-level structure of language models.</li>\n    </ul>\n<h5 id=\"architecture-3\">Architecture</h5>\n<ul>\n  <li>Architecturally, the value model is typically a <strong>decoder-only transformer</strong>, sharing its structure with both the policy and reward models, but differing in its <strong>output head</strong> and <strong>training objective</strong>.\n    <ul>\n      <li>In the implementation described in <a href=\"https://arxiv.org/abs/2203.02155\"><em>Training language models to follow instructions with human feedback</em></a> by Ouyang et al. (2022), all components‚Äîincluding the supervised fine-tuned (SFT) policy, the reward model, and the value model used for PPO fine-tuning‚Äîare based on the GPT-3 architecture (specifically the 6B parameter variant), a unidirectional transformer decoder trained on autoregressive language modeling. The value function is <strong>initialized from the reward model</strong>, which itself is <strong>trained starting from the SFT model with the final unembedding layer removed and replaced with a new linear head</strong> that outputs a <strong>scalar regression value</strong> for each prompt‚Äìcompletion pair. This added linear layer serves as a learned projection that maps the final hidden state representation of the sequence to a single scalar reward estimate. The same architectural modification is used for the value model, which learns to predict expected returns during reinforcement learning with human feedback (RLHF).</li>\n    </ul>\n  </li>\n  <li>\n    <p>Mathematically speaking, the final token‚Äôs hidden representation <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-354-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>h</mi><mi>T</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5490\" style=\"width: 1.253em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.04em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5491\"><span class=\"msubsup\" id=\"MathJax-Span-5492\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5493\" style=\"font-family: STIXGeneral-Italic;\">h</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5494\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>h</mi><mi>T</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-354\">h_T</script> (or an average over all tokens) is passed through a linear projection to output <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-355-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5495\" style=\"width: 3.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5496\"><span class=\"msubsup\" id=\"MathJax-Span-5497\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5498\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5499\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5500\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5501\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5502\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5503\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5504\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-355\">r_\\phi(x,y)</script> a <strong>single scalar reward</strong> representing the model‚Äôs predicted human preference for the given prompt‚Äìcompletion pair.</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-356-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>w</mi><mi mathvariant=&quot;normal&quot;>&amp;#x22A4;</mi></msup><msub><mi>h</mi><mi>T</mi></msub><mo>+</mo><mi>b</mi></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5505\" style=\"width: 9.794em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 8.128em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1008.08em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5506\"><span class=\"msubsup\" id=\"MathJax-Span-5507\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5508\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5509\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5510\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5511\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5512\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5513\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5514\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5515\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5516\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5517\" style=\"font-family: STIXGeneral-Italic;\">w</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.68em;\"><span class=\"mi\" id=\"MathJax-Span-5518\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ä§</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-5519\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5520\" style=\"font-family: STIXGeneral-Italic;\">h</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5521\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5522\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-5523\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">b</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>w</mi><mi mathvariant=\"normal\">‚ä§</mi></msup><msub><mi>h</mi><mi>T</mi></msub><mo>+</mo><mi>b</mi></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-356\">r_\\phi(x,y) = w^\\top h_T + b</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-357-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi><mo>,</mo><mi>b</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5524\" style=\"width: 2.034em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.669em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.62em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5525\"><span class=\"mi\" id=\"MathJax-Span-5526\" style=\"font-family: STIXGeneral-Italic;\">w</span><span class=\"mo\" id=\"MathJax-Span-5527\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5528\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">b</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>w</mi><mo>,</mo><mi>b</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-357\">w,b</script> are learned parameters.</li>\n    </ul>\n  </li>\n  <li>\n    <p>Put simply, the value model outputs a <strong>single scalar estimate</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-358-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5529\" style=\"width: 2.815em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.29em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5530\"><span class=\"msubsup\" id=\"MathJax-Span-5531\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5532\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5533\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5534\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5535\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5536\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-358\">V_\\phi(x)</script> (or per-token estimates <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-359-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5537\" style=\"width: 3.44em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.867em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.82em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5538\"><span class=\"msubsup\" id=\"MathJax-Span-5539\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5540\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5541\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5542\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5543\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5544\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5545\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5546\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5547\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-359\">V_\\phi(x_t))</script>, rather than next-token probabilities or pairwise reward scores.</p>\n  </li>\n  <li>\n    <p><strong>Implementation details:</strong></p>\n\n    <ul>\n      <li>The <strong>hidden representation</strong> of the final token (or the mean of hidden states) is passed through a <strong>linear projection layer</strong> to produce the scalar value prediction.</li>\n      <li>Architecturally, it may <strong>share parameters</strong> with the policy model up to the final projection layer, forming a multi-head actor‚Äìcritic structure.</li>\n      <li>However, many implementations, including <a href=\"https://arxiv.org/abs/2203.02155\"><strong>InstructGPT</strong></a>, initialize the value model <strong>separately</strong> from the reward model rather than sharing parameters with the policy, ensuring that the two objectives‚Äîpolicy improvement and value estimation‚Äîdo not interfere.</li>\n      <li>Some designs explicitly decouple the policy and value networks to prevent gradient interference between actor and critic signals, which helps maintain training stability.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The <strong>reason for a dedicated value model or value head</strong> is that PPO (and more generally, actor‚Äìcritic methods) rely on (V(s)) to compute advantages:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-360-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>A</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2248;</mo><mi>r</mi><mo>+</mo><mi>&amp;#x03B3;</mi><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5548\" style=\"width: 13.128em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.201em, 1010.89em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5549\"><span class=\"mi\" id=\"MathJax-Span-5550\" style=\"font-family: STIXGeneral-Italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-5551\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5552\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-5553\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5554\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-5555\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5556\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚âà</span><span class=\"mi\" id=\"MathJax-Span-5557\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5558\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-5559\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-5560\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5561\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msup\" id=\"MathJax-Span-5562\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5563\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.367em;\"><span class=\"mo\" id=\"MathJax-Span-5564\" style=\"font-size: 70.7%; font-family: STIXVariants;\">‚Ä≤</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5565\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5566\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-5567\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5568\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5569\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-5570\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>A</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>‚âà</mo><mi>r</mi><mo>+</mo><mi>Œ≥</mi><mi>V</mi><mo stretchy=\"false\">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mi>V</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-360\">A(s,a) \\approx r + \\gamma V(s') - V(s)</script>\n\n    <ul>\n      <li>\n        <p>or, in the short-horizon (bandit) case, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-361-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mo>=</mo><mi>r</mi><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5571\" style=\"width: 6.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.159em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.11em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5572\"><span class=\"mi\" id=\"MathJax-Span-5573\" style=\"font-family: STIXGeneral-Italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-5574\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-5575\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5576\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-5577\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5578\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5579\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-5580\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>A</mi><mo>=</mo><mi>r</mi><mo>‚àí</mo><mi>V</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-361\">A = r - V(s)</script>.</p>\n      </li>\n      <li>\n        <p>Without a critic, the gradient estimator would have much higher variance, leading to instability.</p>\n      </li>\n    </ul>\n  </li>\n  <li>Additionally, LLMs define states as (prompt + partial generation) and actions as next tokens. Having a <strong>separate value head or model</strong> allows for stable and interpretable gradient flow through long token sequences.</li>\n</ul>\n<ul>\n      <li>In the implementation described in <a href=\"https://arxiv.org/abs/2203.02155\"><em>Training language models to follow instructions with human feedback</em></a> by Ouyang et al. (2022), all components‚Äîincluding the supervised fine-tuned (SFT) policy, the reward model, and the value model used for PPO fine-tuning‚Äîare based on the GPT-3 architecture (specifically the 6B parameter variant), a unidirectional transformer decoder trained on autoregressive language modeling. The value function is <strong>initialized from the reward model</strong>, which itself is <strong>trained starting from the SFT model with the final unembedding layer removed and replaced with a new linear head</strong> that outputs a <strong>scalar regression value</strong> for each prompt‚Äìcompletion pair. This added linear layer serves as a learned projection that maps the final hidden state representation of the sequence to a single scalar reward estimate. The same architectural modification is used for the value model, which learns to predict expected returns during reinforcement learning with human feedback (RLHF).</li>\n    </ul>\n<p>Mathematically speaking, the final token‚Äôs hidden representation <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-354-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>h</mi><mi>T</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5490\" style=\"width: 1.253em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.04em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5491\"><span class=\"msubsup\" id=\"MathJax-Span-5492\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5493\" style=\"font-family: STIXGeneral-Italic;\">h</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5494\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">T<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>h</mi><mi>T</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-354\">h_T</script> (or an average over all tokens) is passed through a linear projection to output <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-355-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5495\" style=\"width: 3.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5496\"><span class=\"msubsup\" id=\"MathJax-Span-5497\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5498\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5499\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5500\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5501\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5502\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5503\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5504\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-355\">r_\\phi(x,y)</script> a <strong>single scalar reward</strong> representing the model‚Äôs predicted human preference for the given prompt‚Äìcompletion pair.</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-357-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi><mo>,</mo><mi>b</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5524\" style=\"width: 2.034em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.669em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1001.62em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5525\"><span class=\"mi\" id=\"MathJax-Span-5526\" style=\"font-family: STIXGeneral-Italic;\">w</span><span class=\"mo\" id=\"MathJax-Span-5527\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5528\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">b</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>w</mi><mo>,</mo><mi>b</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-357\">w,b</script> are learned parameters.</li>\n    </ul>\n<p>Put simply, the value model outputs a <strong>single scalar estimate</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-358-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5529\" style=\"width: 2.815em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.346em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.29em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5530\"><span class=\"msubsup\" id=\"MathJax-Span-5531\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5532\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5533\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5534\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5535\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5536\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-358\">V_\\phi(x)</script> (or per-token estimates <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-359-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5537\" style=\"width: 3.44em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.867em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.82em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5538\"><span class=\"msubsup\" id=\"MathJax-Span-5539\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5540\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5541\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5542\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5543\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5544\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5545\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5546\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5547\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-359\">V_\\phi(x_t))</script>, rather than next-token probabilities or pairwise reward scores.</p>\n<p><strong>Implementation details:</strong></p>\n<ul>\n      <li>The <strong>hidden representation</strong> of the final token (or the mean of hidden states) is passed through a <strong>linear projection layer</strong> to produce the scalar value prediction.</li>\n      <li>Architecturally, it may <strong>share parameters</strong> with the policy model up to the final projection layer, forming a multi-head actor‚Äìcritic structure.</li>\n      <li>However, many implementations, including <a href=\"https://arxiv.org/abs/2203.02155\"><strong>InstructGPT</strong></a>, initialize the value model <strong>separately</strong> from the reward model rather than sharing parameters with the policy, ensuring that the two objectives‚Äîpolicy improvement and value estimation‚Äîdo not interfere.</li>\n      <li>Some designs explicitly decouple the policy and value networks to prevent gradient interference between actor and critic signals, which helps maintain training stability.</li>\n    </ul>\n<p>The <strong>reason for a dedicated value model or value head</strong> is that PPO (and more generally, actor‚Äìcritic methods) rely on (V(s)) to compute advantages:</p>\n<ul>\n      <li>\n        <p>or, in the short-horizon (bandit) case, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-361-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mo>=</mo><mi>r</mi><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5571\" style=\"width: 6.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.159em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.11em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5572\"><span class=\"mi\" id=\"MathJax-Span-5573\" style=\"font-family: STIXGeneral-Italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-5574\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-5575\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5576\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-5577\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5578\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5579\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-5580\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>A</mi><mo>=</mo><mi>r</mi><mo>‚àí</mo><mi>V</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-361\">A = r - V(s)</script>.</p>\n      </li>\n      <li>\n        <p>Without a critic, the gradient estimator would have much higher variance, leading to instability.</p>\n      </li>\n    </ul>\n<p>or, in the short-horizon (bandit) case, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-361-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mo>=</mo><mi>r</mi><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5571\" style=\"width: 6.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.159em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.11em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5572\"><span class=\"mi\" id=\"MathJax-Span-5573\" style=\"font-family: STIXGeneral-Italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-5574\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-5575\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5576\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-5577\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5578\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5579\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-5580\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>A</mi><mo>=</mo><mi>r</mi><mo>‚àí</mo><mi>V</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-361\">A = r - V(s)</script>.</p>\n<p>Without a critic, the gradient estimator would have much higher variance, leading to instability.</p>\n<h5 id=\"training-objective-1\">Training Objective</h5>\n<ul>\n  <li>\n    <p>The value model is trained via <strong>regression</strong> to predict observed or bootstrapped returns:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-362-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>L</mi></mrow><mi>V</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03D5;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x223C;</mo><mi>D</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>V</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>R</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5581\" style=\"width: 17.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 14.742em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.086em, 1014.53em, 3.753em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5582\"><span class=\"msubsup\" id=\"MathJax-Span-5583\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-5584\"><span class=\"mrow\" id=\"MathJax-Span-5585\"><span class=\"mi\" id=\"MathJax-Span-5586\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∏</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"mi\" id=\"MathJax-Span-5587\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5588\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5589\" style=\"font-family: STIXGeneral-Italic;\">œï</span><span class=\"mo\" id=\"MathJax-Span-5590\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5591\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5592\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 2.971em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-5593\"><span class=\"mrow\" id=\"MathJax-Span-5594\"><span class=\"mi\" id=\"MathJax-Span-5595\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-5596\"><span class=\"mrow\" id=\"MathJax-Span-5597\"><span class=\"mo\" id=\"MathJax-Span-5598\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5599\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5600\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5601\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-5602\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5603\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"mi\" id=\"MathJax-Span-5604\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">D</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-5605\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-5606\"><span class=\"mo\" id=\"MathJax-Span-5607\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5608\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5609\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5610\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5611\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5612\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5613\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5614\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5615\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"texatom\" id=\"MathJax-Span-5616\" style=\"padding-left: 0.263em;\"><span class=\"mrow\" id=\"MathJax-Span-5617\"><span class=\"munderover\" id=\"MathJax-Span-5618\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5619\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-5620\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5621\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5622\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5623\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5624\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5625\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-5626\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-5627\" style=\"font-family: STIXGeneral-Regular;\">)</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.315em;\"><span class=\"mn\" id=\"MathJax-Span-5628\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-5629\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-5630\"><span class=\"mo\" id=\"MathJax-Span-5631\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">L</mi></mrow><mi>V</mi></msub><mo stretchy=\"false\">(</mo><mi>œï</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>‚àº</mo><mi>D</mi></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">[</mo></mrow><mo stretchy=\"false\">(</mo><msub><mi>V</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>R</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-362\">\\mathcal{L}_V(\\phi) = \\mathbb{E}_{(x,y)\\sim D} \\big[(V_\\phi(x) - \\hat{R}(x,y))^2\\big]</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-363-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>R</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5632\" style=\"width: 3.336em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.763em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1002.71em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5633\"><span class=\"texatom\" id=\"MathJax-Span-5634\"><span class=\"mrow\" id=\"MathJax-Span-5635\"><span class=\"munderover\" id=\"MathJax-Span-5636\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5637\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-5638\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5639\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5640\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5641\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5642\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5643\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>R</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-363\">\\hat{R}(x,y)</script> is the observed reward‚Äîtypically obtained from the <strong>reward model</strong> (RM) or human feedback.</li>\n    </ul>\n  </li>\n  <li>\n    <p>The <a href=\"https://arxiv.org/abs/2203.02155\"><strong>InstructGPT</strong></a> paper notes that the value function is initialized from the reward model and fine-tuned concurrently during PPO to predict reward expectations.</p>\n  </li>\n  <li>\n    <p>Token-level PPO variants extend this objective to <strong>per-token values</strong>, improving credit assignment within long completions.</p>\n  </li>\n  <li>\n    <p>A <strong>target value network</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-364-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>&amp;#x03D5;</mi><mo>&amp;#x2212;</mo></msup></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5644\" style=\"width: 1.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.51em, 2.659em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5645\"><span class=\"msubsup\" id=\"MathJax-Span-5646\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5647\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.799em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-5648\"><span class=\"mrow\" id=\"MathJax-Span-5649\"><span class=\"msubsup\" id=\"MathJax-Span-5650\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.42em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5651\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-5652\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">‚àí</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><msup><mi>œï</mi><mo>‚àí</mo></msup></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-364\">V_{\\phi^-}</script> may also be used to stabilize TD targets, updated periodically as in traditional deep RL.</p>\n  </li>\n  <li>\n    <p>The training data consist of tuples <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-365-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5653\" style=\"width: 6.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.055em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5654\"><span class=\"mo\" id=\"MathJax-Span-5655\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5656\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5657\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5658\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5659\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5660\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5661\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5662\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5663\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5664\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5665\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5666\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>r</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-365\">(x, y, r(x,y))</script> where:</p>\n\n    <ul>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-366-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5667\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5668\"><span class=\"mi\" id=\"MathJax-Span-5669\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-366\">x</script>: prompt sampled from curated datasets or user queries.</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-367-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5670\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5671\"><span class=\"mi\" id=\"MathJax-Span-5672\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-367\">y</script>: response generated by the current policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-368-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5673\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5674\"><span class=\"msubsup\" id=\"MathJax-Span-5675\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5676\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5677\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-368\">\\pi_\\theta</script>.</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-369-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5678\" style=\"width: 2.971em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.4em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5679\"><span class=\"mi\" id=\"MathJax-Span-5680\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5681\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5682\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5683\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5684\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5685\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-369\">r(x,y)</script>: scalar reward from the reward model (and optional KL-penalty adjustments).</li>\n    </ul>\n  </li>\n  <li>\n    <p>In the InstructGPT PPO setup, additional techniques such as a <strong>token-wise KL penalty</strong> (from the supervised fine-tuned model) are applied to the reward objective to constrain the policy from drifting too far from its original distribution. They also mention <strong>mixing pretraining gradients</strong> into PPO (‚ÄúPPO-ptx‚Äù) to mitigate regression on NLP benchmarks. This hybrid approach blends the <strong>language modeling loss</strong> from pretraining with the <strong>reinforcement objective</strong>, ensuring that while the model learns from reward feedback, it retains its broad linguistic competence and factual grounding. By interleaving supervised and reinforcement signals, PPO-ptx effectively regularizes the optimization trajectory, preventing catastrophic forgetting of general capabilities. In practice, this technique improves both <strong>instruction-following behavior</strong> and <strong>robustness across unseen prompts</strong>, striking a balance between alignment and general language proficiency.</p>\n  </li>\n</ul>\n<p>The value model is trained via <strong>regression</strong> to predict observed or bootstrapped returns:</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-363-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>R</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5632\" style=\"width: 3.336em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.763em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1002.71em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5633\"><span class=\"texatom\" id=\"MathJax-Span-5634\"><span class=\"mrow\" id=\"MathJax-Span-5635\"><span class=\"munderover\" id=\"MathJax-Span-5636\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5637\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-5638\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5639\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5640\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5641\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5642\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5643\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>R</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-363\">\\hat{R}(x,y)</script> is the observed reward‚Äîtypically obtained from the <strong>reward model</strong> (RM) or human feedback.</li>\n    </ul>\n<p>The <a href=\"https://arxiv.org/abs/2203.02155\"><strong>InstructGPT</strong></a> paper notes that the value function is initialized from the reward model and fine-tuned concurrently during PPO to predict reward expectations.</p>\n<p>Token-level PPO variants extend this objective to <strong>per-token values</strong>, improving credit assignment within long completions.</p>\n<p>A <strong>target value network</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-364-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mi>&amp;#x03D5;</mi><mo>&amp;#x2212;</mo></msup></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5644\" style=\"width: 1.826em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.51em, 2.659em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5645\"><span class=\"msubsup\" id=\"MathJax-Span-5646\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5647\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.799em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-5648\"><span class=\"mrow\" id=\"MathJax-Span-5649\"><span class=\"msubsup\" id=\"MathJax-Span-5650\"><span style=\"display: inline-block; position: relative; width: 0.836em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.42em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5651\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.471em;\"><span class=\"mo\" id=\"MathJax-Span-5652\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">‚àí</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><msup><mi>œï</mi><mo>‚àí</mo></msup></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-364\">V_{\\phi^-}</script> may also be used to stabilize TD targets, updated periodically as in traditional deep RL.</p>\n<p>The training data consist of tuples <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-365-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5653\" style=\"width: 6.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.055em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5654\"><span class=\"mo\" id=\"MathJax-Span-5655\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5656\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5657\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5658\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5659\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5660\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5661\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5662\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5663\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5664\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5665\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5666\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>r</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-365\">(x, y, r(x,y))</script> where:</p>\n<ul>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-366-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5667\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5668\"><span class=\"mi\" id=\"MathJax-Span-5669\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-366\">x</script>: prompt sampled from curated datasets or user queries.</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-367-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5670\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5671\"><span class=\"mi\" id=\"MathJax-Span-5672\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-367\">y</script>: response generated by the current policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-368-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5673\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5674\"><span class=\"msubsup\" id=\"MathJax-Span-5675\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5676\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5677\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-368\">\\pi_\\theta</script>.</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-369-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5678\" style=\"width: 2.971em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.451em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.4em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5679\"><span class=\"mi\" id=\"MathJax-Span-5680\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5681\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5682\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5683\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5684\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5685\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-369\">r(x,y)</script>: scalar reward from the reward model (and optional KL-penalty adjustments).</li>\n    </ul>\n<p>In the InstructGPT PPO setup, additional techniques such as a <strong>token-wise KL penalty</strong> (from the supervised fine-tuned model) are applied to the reward objective to constrain the policy from drifting too far from its original distribution. They also mention <strong>mixing pretraining gradients</strong> into PPO (‚ÄúPPO-ptx‚Äù) to mitigate regression on NLP benchmarks. This hybrid approach blends the <strong>language modeling loss</strong> from pretraining with the <strong>reinforcement objective</strong>, ensuring that while the model learns from reward feedback, it retains its broad linguistic competence and factual grounding. By interleaving supervised and reinforcement signals, PPO-ptx effectively regularizes the optimization trajectory, preventing catastrophic forgetting of general capabilities. In practice, this technique improves both <strong>instruction-following behavior</strong> and <strong>robustness across unseen prompts</strong>, striking a balance between alignment and general language proficiency.</p>\n<h5 id=\"training-data-3\">Training Data</h5>\n<ul>\n  <li><strong>Primary source:</strong> On-policy samples collected during RLHF fine-tuning, typically generated from curated instruction datasets.</li>\n  <li><strong>Reward signals:</strong> Derived from the reward model or human-preference comparisons.</li>\n  <li><strong>Scale:</strong> Hundreds of thousands to millions of prompt‚Äìresponse pairs per training loop.</li>\n  <li><strong>Temporal structure:</strong> Since LLM reward modeling is usually <em>bandit-like</em> (single scalar per completion), the value model relies on <strong>Monte Carlo estimates</strong> or <strong>generalized advantage estimation (GAE)</strong> to stabilize learning despite sparse supervision.</li>\n</ul>\n<h5 id=\"model-size-1\">Model Size</h5>\n<ul>\n  <li>\n    <p>The value model‚Äôs size is often comparable to the reward model and smaller than the policy model.</p>\n\n    <ul>\n      <li>For instance, in <a href=\"https://arxiv.org/abs/2203.02155\"><strong>InstructGPT</strong></a>, the critic had a similar scale (~6 B parameters) to the reward model and served as a critic for a 175 B parameter policy.</li>\n      <li>In open-source frameworks such as <strong>TRLX</strong> or <strong>DeepSpeed-Chat</strong>, value heads are attached to 7 B‚Äì13 B base LLMs or trained as independent critics.</li>\n    </ul>\n  </li>\n  <li>\n    <p>When computational resources are limited, a <strong>shared-head</strong> architecture is used, where the value head is attached directly to the policy model‚Äôs hidden states, enabling efficient joint training of actor and critic.</p>\n  </li>\n</ul>\n<p>The value model‚Äôs size is often comparable to the reward model and smaller than the policy model.</p>\n<ul>\n      <li>For instance, in <a href=\"https://arxiv.org/abs/2203.02155\"><strong>InstructGPT</strong></a>, the critic had a similar scale (~6 B parameters) to the reward model and served as a critic for a 175 B parameter policy.</li>\n      <li>In open-source frameworks such as <strong>TRLX</strong> or <strong>DeepSpeed-Chat</strong>, value heads are attached to 7 B‚Äì13 B base LLMs or trained as independent critics.</li>\n    </ul>\n<p>When computational resources are limited, a <strong>shared-head</strong> architecture is used, where the value head is attached directly to the policy model‚Äôs hidden states, enabling efficient joint training of actor and critic.</p>\n<h5 id=\"relationship-to-the-reward-model\">Relationship to the Reward Model</h5>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Aspect</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Reward Model</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Value Model</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">Input</td>\n<td class=\"tg-tleft-valign-first\">Prompt + response</td>\n<td class=\"tg-tleft-valign-second\">Prompt (or prompt + partial response)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Output</td>\n<td class=\"tg-tleft-valign-first\">Scalar reward (human preference estimate)</td>\n<td class=\"tg-tleft-valign-second\">Expected future reward (baseline or critic)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Training data</td>\n<td class=\"tg-tleft-valign-first\">Human or synthetic preference comparisons</td>\n<td class=\"tg-tleft-valign-second\">Policy rollouts and rewards</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Objective</td>\n<td class=\"tg-tleft-valign-first\">Pairwise ranking loss</td>\n<td class=\"tg-tleft-valign-second\">MSE regression loss</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Usage</td>\n<td class=\"tg-tleft-valign-first\">Guides policy optimization</td>\n<td class=\"tg-tleft-valign-second\">Stabilizes training via advantage estimation</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Updates</td>\n<td class=\"tg-tleft-valign-first\">Offline (pretrained)</td>\n<td class=\"tg-tleft-valign-second\">Online (updated during RL loop)</td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Aspect</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Reward Model</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Value Model</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">Input</td>\n<td class=\"tg-tleft-valign-first\">Prompt + response</td>\n<td class=\"tg-tleft-valign-second\">Prompt (or prompt + partial response)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Output</td>\n<td class=\"tg-tleft-valign-first\">Scalar reward (human preference estimate)</td>\n<td class=\"tg-tleft-valign-second\">Expected future reward (baseline or critic)</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Training data</td>\n<td class=\"tg-tleft-valign-first\">Human or synthetic preference comparisons</td>\n<td class=\"tg-tleft-valign-second\">Policy rollouts and rewards</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Objective</td>\n<td class=\"tg-tleft-valign-first\">Pairwise ranking loss</td>\n<td class=\"tg-tleft-valign-second\">MSE regression loss</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Usage</td>\n<td class=\"tg-tleft-valign-first\">Guides policy optimization</td>\n<td class=\"tg-tleft-valign-second\">Stabilizes training via advantage estimation</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Updates</td>\n<td class=\"tg-tleft-valign-first\">Offline (pretrained)</td>\n<td class=\"tg-tleft-valign-second\">Online (updated during RL loop)</td>\n</tr>\n</tbody>\n</table>\n<ul>\n  <li>The reward model captures <em>external supervision</em>, while the value model provides <em>internal bootstrapping</em> for efficient policy learning.</li>\n</ul>\n<h5 id=\"comparative-analysis-13\">Comparative Analysis</h5>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Aspect</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Role</strong></td>\n<td class=\"tg-tleft-valign-second\">Predicts expected future reward for prompts/responses</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Function</strong></td>\n<td class=\"tg-tleft-valign-second\">Baseline and critic for policy optimization</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Architecture</strong></td>\n<td class=\"tg-tleft-valign-second\">Transformer with scalar output head</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Training Data</strong></td>\n<td class=\"tg-tleft-valign-second\">On-policy prompt‚Äìresponse‚Äìreward tuples</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Model Size</strong></td>\n<td class=\"tg-tleft-valign-second\">1B‚Äì13B parameters</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Training Objective</strong></td>\n<td class=\"tg-tleft-valign-second\">Mean-squared error on observed or bootstrapped returns</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>References</strong></td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://papers.nips.cc/paper/2000/hash/60941600aaa93c7e3de7729355a0913e-Abstract.html\">Konda &amp; Tsitsiklis, 2000</a>; <a href=\"https://arxiv.org/abs/2009.01325\">Stiennon et al., 2020</a>; <a href=\"https://arxiv.org/abs/2203.02155\">Ouyang et al., 2022</a></td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Aspect</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Description</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Role</strong></td>\n<td class=\"tg-tleft-valign-second\">Predicts expected future reward for prompts/responses</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Function</strong></td>\n<td class=\"tg-tleft-valign-second\">Baseline and critic for policy optimization</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Architecture</strong></td>\n<td class=\"tg-tleft-valign-second\">Transformer with scalar output head</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Training Data</strong></td>\n<td class=\"tg-tleft-valign-second\">On-policy prompt‚Äìresponse‚Äìreward tuples</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Model Size</strong></td>\n<td class=\"tg-tleft-valign-second\">1B‚Äì13B parameters</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Training Objective</strong></td>\n<td class=\"tg-tleft-valign-second\">Mean-squared error on observed or bootstrapped returns</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>References</strong></td>\n<td class=\"tg-tleft-valign-second\"><a href=\"https://papers.nips.cc/paper/2000/hash/60941600aaa93c7e3de7729355a0913e-Abstract.html\">Konda &amp; Tsitsiklis, 2000</a>; <a href=\"https://arxiv.org/abs/2009.01325\">Stiennon et al., 2020</a>; <a href=\"https://arxiv.org/abs/2203.02155\">Ouyang et al., 2022</a></td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"optimizing-the-policy\">Optimizing the Policy</h4>\n<ul>\n  <li>The policy refers to a strategy or a set of rules that an agent uses to make decisions in an environment. Put simply, the policy defines how the agent selects actions based on its current observations or state.</li>\n  <li>The policy optimization process involves RL techniques that iteratively refine the policy based on reward feedback. The reward model provides feedback based on human preferences, and the policy is optimized iteratively to maximize reward while maintaining a stable learning trajectory. The stability aspect is enforced by maintaining a certain level of similarity to its previous version (to prevent drastic changes that could lead to instability)</li>\n  <li>Popular policy optimization methods ‚Äì specifically applied to LLMs ‚Äì include:\n    <ul>\n      <li><strong><a href=\"#proximal-policy-optimization-ppo\">Proximal Policy Optimization (PPO)</a>:</strong> A widely-used RL algorithm that balances exploration and exploitation while maintaining training stability.</li>\n      <li><strong><a href=\"#direct-preference-optimization-dpo\">Direct Preference Optimization (DPO)</a>:</strong> An alternative approach where the policy directly optimizes the relative log probability of preferred responses using a binary cross-entropy loss, balancing human feedback alignment with KL divergence constraints.</li>\n      <li><strong><a href=\"#group-relative-preference-optimization-grpo\">Group Relative Policy Optimization (GRPO)</a>:</strong> A PPO variant that removes the critic model and estimates the baseline from group scores, improving memory efficiency and performance in complex tasks like mathematical reasoning.</li>\n    </ul>\n  </li>\n  <li>Through RLHF, models like InstructGPT and ChatGPT have achieved enhanced alignment with human expectations, producing more beneficial and contextually appropriate responses.</li>\n</ul>\n<ul>\n      <li><strong><a href=\"#proximal-policy-optimization-ppo\">Proximal Policy Optimization (PPO)</a>:</strong> A widely-used RL algorithm that balances exploration and exploitation while maintaining training stability.</li>\n      <li><strong><a href=\"#direct-preference-optimization-dpo\">Direct Preference Optimization (DPO)</a>:</strong> An alternative approach where the policy directly optimizes the relative log probability of preferred responses using a binary cross-entropy loss, balancing human feedback alignment with KL divergence constraints.</li>\n      <li><strong><a href=\"#group-relative-preference-optimization-grpo\">Group Relative Policy Optimization (GRPO)</a>:</strong> A PPO variant that removes the critic model and estimates the baseline from group scores, improving memory efficiency and performance in complex tasks like mathematical reasoning.</li>\n    </ul>\n<h4 id=\"integration-of-policy-reference-reward-and-value-models-in-rlhf\">Integration of Policy, Reference, Reward, and Value Models in RLHF</h4>\n<ul>\n  <li>\n    <p>The full RLHF pipeline integrates four central components ‚Äî the <strong>policy</strong>, <strong>reference</strong>, <strong>reward</strong>, and <strong>value</strong> models ‚Äî into a cohesive optimization framework. Together, these models implement a scalable variant of <strong>policy-gradient reinforcement learning</strong> (commonly using PPO) for large-scale language model alignment.</p>\n  </li>\n  <li>\n    <p>This section provides a complete description of how these models interact, the mathematical formulation governing their updates, and the system-level architecture of a modern RLHF pipeline.</p>\n  </li>\n</ul>\n<p>The full RLHF pipeline integrates four central components ‚Äî the <strong>policy</strong>, <strong>reference</strong>, <strong>reward</strong>, and <strong>value</strong> models ‚Äî into a cohesive optimization framework. Together, these models implement a scalable variant of <strong>policy-gradient reinforcement learning</strong> (commonly using PPO) for large-scale language model alignment.</p>\n<p>This section provides a complete description of how these models interact, the mathematical formulation governing their updates, and the system-level architecture of a modern RLHF pipeline.</p>\n<h5 id=\"overview-of-the-rlhf-process\">Overview of the RLHF Process</h5>\n<ul>\n  <li>\n    <p>RLHF transforms large pretrained language models into <em>alignment-optimized</em> conversational agents through a three-phase process:</p>\n\n    <ol>\n      <li><strong>Supervised Fine-Tuning (SFT):</strong>\n        <ul>\n          <li>The base pretrained LLM is fine-tuned on instruction‚Äìresponse data curated by humans.</li>\n          <li><strong>Output:</strong> <em>SFT model</em> (used as both the initial <strong>policy</strong> and the frozen <strong>reference model</strong>).</li>\n        </ul>\n      </li>\n      <li><strong>Reward Modeling:</strong>\n        <ul>\n          <li>Human annotators rank or compare pairs of model responses.</li>\n          <li>A separate <strong>reward model</strong> is trained on these comparisons to learn a scalar preference function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-370-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5686\" style=\"width: 3.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5687\"><span class=\"msubsup\" id=\"MathJax-Span-5688\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5689\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5690\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5691\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5692\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5693\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5694\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5695\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-370\">r_\\phi(x,y)</script>.</li>\n        </ul>\n      </li>\n      <li><strong>Reinforcement Learning (RL) Optimization:</strong>\n        <ul>\n          <li>The <strong>policy model</strong> is optimized to generate responses that maximize the learned reward signal, while staying close to the <strong>reference model</strong> through KL regularization.</li>\n          <li>The <strong>value model</strong> acts as a critic, stabilizing the gradient updates.</li>\n        </ul>\n      </li>\n    </ol>\n  </li>\n  <li>\n    <p>This procedure was first described comprehensively in <em>Training Language Models to Follow Instructions with Human Feedback</em> by <a href=\"https://arxiv.org/abs/2203.02155\">Ouyang et al. (2022)</a>, forming the backbone of systems such as <strong>InstructGPT</strong> and <strong>ChatGPT</strong>.</p>\n  </li>\n</ul>\n<p>RLHF transforms large pretrained language models into <em>alignment-optimized</em> conversational agents through a three-phase process:</p>\n<ol>\n      <li><strong>Supervised Fine-Tuning (SFT):</strong>\n        <ul>\n          <li>The base pretrained LLM is fine-tuned on instruction‚Äìresponse data curated by humans.</li>\n          <li><strong>Output:</strong> <em>SFT model</em> (used as both the initial <strong>policy</strong> and the frozen <strong>reference model</strong>).</li>\n        </ul>\n      </li>\n      <li><strong>Reward Modeling:</strong>\n        <ul>\n          <li>Human annotators rank or compare pairs of model responses.</li>\n          <li>A separate <strong>reward model</strong> is trained on these comparisons to learn a scalar preference function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-370-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5686\" style=\"width: 3.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5687\"><span class=\"msubsup\" id=\"MathJax-Span-5688\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5689\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5690\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5691\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5692\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5693\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5694\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5695\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-370\">r_\\phi(x,y)</script>.</li>\n        </ul>\n      </li>\n      <li><strong>Reinforcement Learning (RL) Optimization:</strong>\n        <ul>\n          <li>The <strong>policy model</strong> is optimized to generate responses that maximize the learned reward signal, while staying close to the <strong>reference model</strong> through KL regularization.</li>\n          <li>The <strong>value model</strong> acts as a critic, stabilizing the gradient updates.</li>\n        </ul>\n      </li>\n    </ol>\n<ul>\n          <li>The base pretrained LLM is fine-tuned on instruction‚Äìresponse data curated by humans.</li>\n          <li><strong>Output:</strong> <em>SFT model</em> (used as both the initial <strong>policy</strong> and the frozen <strong>reference model</strong>).</li>\n        </ul>\n<ul>\n          <li>Human annotators rank or compare pairs of model responses.</li>\n          <li>A separate <strong>reward model</strong> is trained on these comparisons to learn a scalar preference function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-370-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5686\" style=\"width: 3.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5687\"><span class=\"msubsup\" id=\"MathJax-Span-5688\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5689\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5690\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5691\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5692\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5693\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5694\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5695\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-370\">r_\\phi(x,y)</script>.</li>\n        </ul>\n<ul>\n          <li>The <strong>policy model</strong> is optimized to generate responses that maximize the learned reward signal, while staying close to the <strong>reference model</strong> through KL regularization.</li>\n          <li>The <strong>value model</strong> acts as a critic, stabilizing the gradient updates.</li>\n        </ul>\n<p>This procedure was first described comprehensively in <em>Training Language Models to Follow Instructions with Human Feedback</em> by <a href=\"https://arxiv.org/abs/2203.02155\">Ouyang et al. (2022)</a>, forming the backbone of systems such as <strong>InstructGPT</strong> and <strong>ChatGPT</strong>.</p>\n<h5 id=\"core-mathematical-formulation\">Core Mathematical Formulation</h5>\n<ul>\n  <li>\n    <p>The RLHF optimization problem can be expressed as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-371-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><munder><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>max</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></munder><mo>,</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>x</mi><mo>&amp;#x223C;</mo><msub><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>prompt</mtext></mrow></msub><mo>,</mo><mi>y</mi><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><mrow><mo>[</mo><mrow><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>&amp;#x03B2;</mi><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>K</mi><mi mathvariant=&quot;normal&quot;>L</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>(</mo></mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>&amp;#x2016;</mo><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>ref</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>)</mo></mrow></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5696\" style=\"width: 29.482em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 24.534em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.086em, 1024.38em, 4.117em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5697\"><span class=\"munderover\" id=\"MathJax-Span-5698\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1001.72em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-5699\" style=\"font-family: STIXGeneral-Regular;\">max</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.37em, 4.273em, -999.997em); top: -3.331em; left: 0.68em;\"><span class=\"texatom\" id=\"MathJax-Span-5700\"><span class=\"mrow\" id=\"MathJax-Span-5701\"><span class=\"mi\" id=\"MathJax-Span-5702\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5703\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5704\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 6.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-5705\"><span class=\"mrow\" id=\"MathJax-Span-5706\"><span class=\"mi\" id=\"MathJax-Span-5707\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-5708\"><span class=\"mrow\" id=\"MathJax-Span-5709\"><span class=\"mi\" id=\"MathJax-Span-5710\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5711\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"msubsup\" id=\"MathJax-Span-5712\"><span style=\"display: inline-block; position: relative; width: 2.034em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5713\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">D</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-5714\"><span class=\"mrow\" id=\"MathJax-Span-5715\"><span class=\"mtext\" id=\"MathJax-Span-5716\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">prompt</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5717\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5718\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-5719\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"msubsup\" id=\"MathJax-Span-5720\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5721\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5722\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5723\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-5724\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-5725\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-5726\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5727\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-5728\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-5729\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-5730\"><span class=\"msubsup\" id=\"MathJax-Span-5731\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5732\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5733\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5734\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5735\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5736\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5737\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-5738\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5739\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-5740\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5741\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-5742\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-5743\"><span class=\"mi\" id=\"MathJax-Span-5744\" style=\"font-family: STIXGeneral-Regular;\">K<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-5745\" style=\"font-family: STIXGeneral-Regular;\">L</span></span></span><span class=\"texatom\" id=\"MathJax-Span-5746\"><span class=\"mrow\" id=\"MathJax-Span-5747\"><span class=\"mo\" id=\"MathJax-Span-5748\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">(</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-5749\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5750\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5751\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5752\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-5753\" style=\"font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-5754\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-5755\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5756\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5757\" style=\"font-family: STIXGeneral-Regular;\">‚Äñ</span><span class=\"msubsup\" id=\"MathJax-Span-5758\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5759\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-5760\"><span class=\"mrow\" id=\"MathJax-Span-5761\"><span class=\"mtext\" id=\"MathJax-Span-5762\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">ref</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5763\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-5764\" style=\"font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-5765\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-5766\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5767\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-5768\"><span class=\"mrow\" id=\"MathJax-Span-5769\"><span class=\"mo\" id=\"MathJax-Span-5770\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">)</span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5771\" style=\"vertical-align: -0.206em;\"><span style=\"font-family: STIXSizeOneSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.997em; border-left: 0px solid; width: 0px; height: 2.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><munder><mo movablelimits=\"true\" form=\"prefix\">max</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>Œ∏</mi></mrow></munder><mo>,</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>x</mi><mo>‚àº</mo><msub><mi>D</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>prompt</mtext></mrow></msub><mo>,</mo><mi>y</mi><mo>‚àº</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></msub><mrow><mo>[</mo><mrow><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mi>Œ≤</mi><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">K</mi><mi mathvariant=\"normal\">L</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo></mrow><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo fence=\"false\" stretchy=\"false\">‚Äñ</mo><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>ref</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo></mrow></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-371\">\\max_{\\theta}, \\mathbb{E}_{x\\sim D_{\\text{prompt}},y\\sim\\pi_\\theta(\\cdot\\mid x)} \\left[ r_\\phi(x,y) - \\beta,\\mathrm{KL}\\big(\\pi_\\theta(\\cdot\\mid x)\\Vert\\pi_{\\text{ref}}(\\cdot\\mid x)\\big) \\right]</script>\n\n    <ul>\n      <li>\n        <p>where:</p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-372-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5772\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5773\"><span class=\"msubsup\" id=\"MathJax-Span-5774\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5775\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5776\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-372\">\\pi_\\theta</script> = <strong>policy model</strong> (trainable)</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-373-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>ref</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5777\" style=\"width: 1.669em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.36em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5778\"><span class=\"msubsup\" id=\"MathJax-Span-5779\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5780\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-5781\"><span class=\"mrow\" id=\"MathJax-Span-5782\"><span class=\"mtext\" id=\"MathJax-Span-5783\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">ref</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>ref</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-373\">\\pi_{\\text{ref}}</script> = <strong>reference model</strong> (frozen)</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-374-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5784\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.89em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5785\"><span class=\"msubsup\" id=\"MathJax-Span-5786\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5787\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5788\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>œï</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-374\">r_\\phi</script> = <strong>reward model</strong> (provides scalar reward)</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-375-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5789\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5790\"><span class=\"mi\" id=\"MathJax-Span-5791\" style=\"font-family: STIXGeneral-Italic;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≤</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-375\">\\beta</script> = KL penalty coefficient controlling exploration‚Äìalignment trade-off</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>The <strong>KL term</strong> prevents the policy from diverging too far from its linguistic prior, while the <strong>reward</strong> encourages behaviors that better match human preferences.</p>\n  </li>\n  <li>\n    <p>To train this objective, <strong>Proximal Policy Optimization (PPO)</strong> by <a href=\"https://arxiv.org/abs/1707.06347\">Schulman et al. (2017)</a> is typically used, which optimizes a clipped surrogate loss:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-376-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>PPO</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x223C;</mo><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;>min</mo><mrow><mo>(</mo><mrow><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>t</mi></msub><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>c</mi><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>i</mi><mi mathvariant=&quot;normal&quot;>p</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>(</mo></mrow><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>&amp;#x03F5;</mi><mo>,</mo><mn>1</mn><mo>+</mo><mi>&amp;#x03F5;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>)</mo></mrow><mo>,</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>t</mi></msub></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5792\" style=\"width: 30.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 25.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.034em, 1025.52em, 3.753em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5793\"><span class=\"msubsup\" id=\"MathJax-Span-5794\"><span style=\"display: inline-block; position: relative; width: 1.93em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5795\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-5796\"><span class=\"mrow\" id=\"MathJax-Span-5797\"><span class=\"mtext\" id=\"MathJax-Span-5798\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">PPO</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5799\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5800\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5801\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5802\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5803\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-5804\"><span class=\"mrow\" id=\"MathJax-Span-5805\"><span class=\"mi\" id=\"MathJax-Span-5806\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-5807\"><span class=\"mrow\" id=\"MathJax-Span-5808\"><span class=\"mo\" id=\"MathJax-Span-5809\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5810\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5811\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-5812\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-5813\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5814\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àº</span><span class=\"msubsup\" id=\"MathJax-Span-5815\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5816\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5817\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-5818\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-5819\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span><span class=\"mrow\" id=\"MathJax-Span-5820\"><span class=\"mo\" id=\"MathJax-Span-5821\" style=\"font-family: STIXGeneral-Regular;\">min</span><span class=\"mrow\" id=\"MathJax-Span-5822\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-5823\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">(</span></span></span><span class=\"mrow\" id=\"MathJax-Span-5824\"><span class=\"msubsup\" id=\"MathJax-Span-5825\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5826\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5827\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5828\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5829\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5830\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5831\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5832\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-5833\"><span class=\"mrow\" id=\"MathJax-Span-5834\"><span class=\"munderover\" id=\"MathJax-Span-5835\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5836\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-5837\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5838\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5839\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"texatom\" id=\"MathJax-Span-5840\" style=\"padding-left: 0.211em;\"><span class=\"mrow\" id=\"MathJax-Span-5841\"><span class=\"mi\" id=\"MathJax-Span-5842\" style=\"font-family: STIXGeneral-Regular;\">c</span><span class=\"mi\" id=\"MathJax-Span-5843\" style=\"font-family: STIXGeneral-Regular;\">l</span><span class=\"mi\" id=\"MathJax-Span-5844\" style=\"font-family: STIXGeneral-Regular;\">i</span><span class=\"mi\" id=\"MathJax-Span-5845\" style=\"font-family: STIXGeneral-Regular;\">p</span></span></span><span class=\"texatom\" id=\"MathJax-Span-5846\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-5847\"><span class=\"mo\" id=\"MathJax-Span-5848\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">(</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-5849\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5850\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5851\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5852\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5853\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5854\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5855\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-5856\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-5857\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-5858\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">œµ</span><span class=\"mo\" id=\"MathJax-Span-5859\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-5860\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-5861\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-5862\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">œµ</span><span class=\"texatom\" id=\"MathJax-Span-5863\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-5864\"><span class=\"mo\" id=\"MathJax-Span-5865\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">)</span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5866\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5867\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-5868\"><span class=\"mrow\" id=\"MathJax-Span-5869\"><span class=\"munderover\" id=\"MathJax-Span-5870\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5871\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-5872\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5873\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5874\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">)</span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5875\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>PPO</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>‚àº</mo><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></mrow></msub><mrow><mo>[</mo><mrow><mo movablelimits=\"true\" form=\"prefix\">min</mo><mrow><mo>(</mo><mrow><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>,</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>t</mi></msub><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">c</mi><mi mathvariant=\"normal\">l</mi><mi mathvariant=\"normal\">i</mi><mi mathvariant=\"normal\">p</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo></mrow><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>,</mo><mn>1</mn><mo>‚àí</mo><mi>œµ</mi><mo>,</mo><mn>1</mn><mo>+</mo><mi>œµ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo></mrow><mo>,</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>t</mi></msub></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-376\">L_{\\text{PPO}}(\\theta) =\n\\mathbb{E}_{(x,y)\\sim\\pi_\\theta}\n\\left[\n\\min\\left(\nr_t(\\theta),\\hat{A}_t,\n\\mathrm{clip}\\big(r_t(\\theta), 1-\\epsilon, 1+\\epsilon\\big),\\hat{A}_t\n\\right)\n\\right]</script>\n\n    <ul>\n      <li>\n        <p>where:</p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-377-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5876\" style=\"width: 7.763em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.461em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.94em, 1006.46em, 3.023em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5877\"><span class=\"msubsup\" id=\"MathJax-Span-5878\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5879\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5880\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5881\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5882\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5883\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5884\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-5885\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1002.29em, 4.326em, -999.997em); top: -4.581em; left: 50%; margin-left: -1.195em;\"><span class=\"mrow\" id=\"MathJax-Span-5886\"><span class=\"msubsup\" id=\"MathJax-Span-5887\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5888\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5889\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5890\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5891\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5892\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-5893\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5894\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-5895\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5896\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-5897\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5898\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1002.97em, 4.43em, -999.997em); top: -3.591em; left: 50%; margin-left: -1.508em;\"><span class=\"mrow\" id=\"MathJax-Span-5899\"><span class=\"msubsup\" id=\"MathJax-Span-5900\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5901\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-5902\"><span class=\"mrow\" id=\"MathJax-Span-5903\"><span class=\"msubsup\" id=\"MathJax-Span-5904\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5905\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-5906\"><span class=\"mrow\" id=\"MathJax-Span-5907\"><span class=\"mtext\" id=\"MathJax-Span-5908\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5909\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5910\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5911\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-5912\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5913\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-5914\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5915\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-5916\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5917\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.13em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.128em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>Œ∏</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-377\">r_t(\\theta) = \\frac{\\pi_\\theta(y_t \\mid x_t)}{\\pi_{\\theta_{\\text{old}}}(y_t \\mid x_t)}</script> is the <strong>likelihood ratio</strong>;</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-378-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>t</mi></msub><mo>,</mo><msub><mi>y</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5918\" style=\"width: 11.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.221em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1009.17em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5919\"><span class=\"msubsup\" id=\"MathJax-Span-5920\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-5921\"><span class=\"mrow\" id=\"MathJax-Span-5922\"><span class=\"munderover\" id=\"MathJax-Span-5923\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5924\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-5925\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5926\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5927\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5928\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5929\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5930\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5931\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5932\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5933\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5934\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5935\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5936\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5937\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5938\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5939\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5940\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-5941\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5942\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5943\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œà<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5944\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5945\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5946\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5947\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5948\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo>,</mo><msub><mi>y</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>V</mi><mi>œà</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-378\">\\hat{A}_t = r_\\phi(x_t,y_t) - V_\\psi(x_t)</script> is the <strong>advantage estimate</strong>;</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-379-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5949\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5950\"><span class=\"msubsup\" id=\"MathJax-Span-5951\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5952\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5953\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œà<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œà</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-379\">V_\\psi</script> = <strong>value model</strong>;</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-380-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03F5;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5954\" style=\"width: 0.523em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.42em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5955\"><span class=\"mi\" id=\"MathJax-Span-5956\" style=\"font-family: STIXGeneral-Italic;\">œµ</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œµ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-380\">\\epsilon</script> is a clipping hyperparameter (usually 0.1‚Äì0.2).</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>The advantage term ensures that updates are proportional to how much better a response is than expected, while the clipping stabilizes the step size.</p>\n  </li>\n</ul>\n<p>The RLHF optimization problem can be expressed as:</p>\n<ul>\n      <li>\n        <p>where:</p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-372-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5772\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5773\"><span class=\"msubsup\" id=\"MathJax-Span-5774\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5775\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5776\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-372\">\\pi_\\theta</script> = <strong>policy model</strong> (trainable)</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-373-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>ref</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5777\" style=\"width: 1.669em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.36em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5778\"><span class=\"msubsup\" id=\"MathJax-Span-5779\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5780\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-5781\"><span class=\"mrow\" id=\"MathJax-Span-5782\"><span class=\"mtext\" id=\"MathJax-Span-5783\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">ref</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>ref</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-373\">\\pi_{\\text{ref}}</script> = <strong>reference model</strong> (frozen)</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-374-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5784\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.89em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5785\"><span class=\"msubsup\" id=\"MathJax-Span-5786\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5787\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5788\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>œï</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-374\">r_\\phi</script> = <strong>reward model</strong> (provides scalar reward)</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-375-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5789\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5790\"><span class=\"mi\" id=\"MathJax-Span-5791\" style=\"font-family: STIXGeneral-Italic;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≤</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-375\">\\beta</script> = KL penalty coefficient controlling exploration‚Äìalignment trade-off</li>\n        </ul>\n      </li>\n    </ul>\n<p>where:</p>\n<ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-372-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5772\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5773\"><span class=\"msubsup\" id=\"MathJax-Span-5774\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5775\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-5776\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-372\">\\pi_\\theta</script> = <strong>policy model</strong> (trainable)</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-373-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>ref</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5777\" style=\"width: 1.669em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.36em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5778\"><span class=\"msubsup\" id=\"MathJax-Span-5779\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5780\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-5781\"><span class=\"mrow\" id=\"MathJax-Span-5782\"><span class=\"mtext\" id=\"MathJax-Span-5783\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">ref</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>ref</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-373\">\\pi_{\\text{ref}}</script> = <strong>reference model</strong> (frozen)</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-374-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5784\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.89em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5785\"><span class=\"msubsup\" id=\"MathJax-Span-5786\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5787\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5788\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>œï</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-374\">r_\\phi</script> = <strong>reward model</strong> (provides scalar reward)</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-375-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B2;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5789\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5790\"><span class=\"mi\" id=\"MathJax-Span-5791\" style=\"font-family: STIXGeneral-Italic;\">Œ≤<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≤</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-375\">\\beta</script> = KL penalty coefficient controlling exploration‚Äìalignment trade-off</li>\n        </ul>\n<p>The <strong>KL term</strong> prevents the policy from diverging too far from its linguistic prior, while the <strong>reward</strong> encourages behaviors that better match human preferences.</p>\n<p>To train this objective, <strong>Proximal Policy Optimization (PPO)</strong> by <a href=\"https://arxiv.org/abs/1707.06347\">Schulman et al. (2017)</a> is typically used, which optimizes a clipped surrogate loss:</p>\n<ul>\n      <li>\n        <p>where:</p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-377-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5876\" style=\"width: 7.763em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.461em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.94em, 1006.46em, 3.023em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5877\"><span class=\"msubsup\" id=\"MathJax-Span-5878\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5879\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5880\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5881\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5882\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5883\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5884\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-5885\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1002.29em, 4.326em, -999.997em); top: -4.581em; left: 50%; margin-left: -1.195em;\"><span class=\"mrow\" id=\"MathJax-Span-5886\"><span class=\"msubsup\" id=\"MathJax-Span-5887\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5888\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5889\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5890\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5891\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5892\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-5893\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5894\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-5895\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5896\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-5897\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5898\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1002.97em, 4.43em, -999.997em); top: -3.591em; left: 50%; margin-left: -1.508em;\"><span class=\"mrow\" id=\"MathJax-Span-5899\"><span class=\"msubsup\" id=\"MathJax-Span-5900\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5901\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-5902\"><span class=\"mrow\" id=\"MathJax-Span-5903\"><span class=\"msubsup\" id=\"MathJax-Span-5904\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5905\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-5906\"><span class=\"mrow\" id=\"MathJax-Span-5907\"><span class=\"mtext\" id=\"MathJax-Span-5908\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5909\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5910\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5911\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-5912\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5913\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-5914\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5915\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-5916\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5917\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.13em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.128em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>Œ∏</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-377\">r_t(\\theta) = \\frac{\\pi_\\theta(y_t \\mid x_t)}{\\pi_{\\theta_{\\text{old}}}(y_t \\mid x_t)}</script> is the <strong>likelihood ratio</strong>;</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-378-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>t</mi></msub><mo>,</mo><msub><mi>y</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5918\" style=\"width: 11.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.221em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1009.17em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5919\"><span class=\"msubsup\" id=\"MathJax-Span-5920\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-5921\"><span class=\"mrow\" id=\"MathJax-Span-5922\"><span class=\"munderover\" id=\"MathJax-Span-5923\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5924\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-5925\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5926\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5927\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5928\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5929\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5930\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5931\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5932\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5933\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5934\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5935\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5936\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5937\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5938\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5939\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5940\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-5941\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5942\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5943\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œà<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5944\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5945\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5946\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5947\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5948\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo>,</mo><msub><mi>y</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>V</mi><mi>œà</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-378\">\\hat{A}_t = r_\\phi(x_t,y_t) - V_\\psi(x_t)</script> is the <strong>advantage estimate</strong>;</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-379-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5949\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5950\"><span class=\"msubsup\" id=\"MathJax-Span-5951\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5952\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5953\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œà<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œà</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-379\">V_\\psi</script> = <strong>value model</strong>;</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-380-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03F5;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5954\" style=\"width: 0.523em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.42em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5955\"><span class=\"mi\" id=\"MathJax-Span-5956\" style=\"font-family: STIXGeneral-Italic;\">œµ</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œµ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-380\">\\epsilon</script> is a clipping hyperparameter (usually 0.1‚Äì0.2).</li>\n        </ul>\n      </li>\n    </ul>\n<p>where:</p>\n<ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-377-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>&amp;#x03B8;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>y</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5876\" style=\"width: 7.763em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.461em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.94em, 1006.46em, 3.023em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5877\"><span class=\"msubsup\" id=\"MathJax-Span-5878\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5879\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5880\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5881\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-5882\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5883\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5884\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mfrac\" id=\"MathJax-Span-5885\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.128em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.388em, 1002.29em, 4.326em, -999.997em); top: -4.581em; left: 50%; margin-left: -1.195em;\"><span class=\"mrow\" id=\"MathJax-Span-5886\"><span class=\"msubsup\" id=\"MathJax-Span-5887\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5888\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5889\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5890\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5891\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5892\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-5893\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5894\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-5895\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5896\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-5897\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5898\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1002.97em, 4.43em, -999.997em); top: -3.591em; left: 50%; margin-left: -1.508em;\"><span class=\"mrow\" id=\"MathJax-Span-5899\"><span class=\"msubsup\" id=\"MathJax-Span-5900\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5901\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-5902\"><span class=\"mrow\" id=\"MathJax-Span-5903\"><span class=\"msubsup\" id=\"MathJax-Span-5904\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.492em, 1000.26em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5905\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.263em;\"><span class=\"texatom\" id=\"MathJax-Span-5906\"><span class=\"mrow\" id=\"MathJax-Span-5907\"><span class=\"mtext\" id=\"MathJax-Span-5908\" style=\"font-size: 50%; font-family: STIXGeneral-Regular;\">old</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5909\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5910\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5911\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-5912\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5913\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-5914\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5915\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.904em; left: 0.315em;\"><span class=\"mi\" id=\"MathJax-Span-5916\" style=\"font-size: 50%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5917\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.13em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.128em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><msub><mi>œÄ</mi><mi>Œ∏</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>Œ∏</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>old</mtext></mrow></msub></mrow></msub><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-377\">r_t(\\theta) = \\frac{\\pi_\\theta(y_t \\mid x_t)}{\\pi_{\\theta_{\\text{old}}}(y_t \\mid x_t)}</script> is the <strong>likelihood ratio</strong>;</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-378-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>t</mi></msub><mo>,</mo><msub><mi>y</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5918\" style=\"width: 11.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.221em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1009.17em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5919\"><span class=\"msubsup\" id=\"MathJax-Span-5920\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-5921\"><span class=\"mrow\" id=\"MathJax-Span-5922\"><span class=\"munderover\" id=\"MathJax-Span-5923\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5924\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-5925\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5926\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5927\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-5928\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5929\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-5930\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5931\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5932\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5933\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5934\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5935\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-5936\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5937\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5938\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5939\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5940\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-5941\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5942\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5943\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œà<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5944\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-5945\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5946\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-5947\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5948\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo>,</mo><msub><mi>y</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>V</mi><mi>œà</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-378\">\\hat{A}_t = r_\\phi(x_t,y_t) - V_\\psi(x_t)</script> is the <strong>advantage estimate</strong>;</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-379-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5949\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5950\"><span class=\"msubsup\" id=\"MathJax-Span-5951\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5952\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-5953\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œà<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œà</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-379\">V_\\psi</script> = <strong>value model</strong>;</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-380-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03F5;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5954\" style=\"width: 0.523em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.42em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5955\"><span class=\"mi\" id=\"MathJax-Span-5956\" style=\"font-family: STIXGeneral-Italic;\">œµ</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œµ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-380\">\\epsilon</script> is a clipping hyperparameter (usually 0.1‚Äì0.2).</li>\n        </ul>\n<p>The advantage term ensures that updates are proportional to how much better a response is than expected, while the clipping stabilizes the step size.</p>\n<h5 id=\"role-of-each-model-in-the-loop\">Role of Each Model in the Loop</h5>\n<ul>\n  <li>\n    <p><strong>Policy Model</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-381-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5957\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5958\"><span class=\"msubsup\" id=\"MathJax-Span-5959\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5960\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-5961\"><span class=\"mrow\" id=\"MathJax-Span-5962\"><span class=\"mi\" id=\"MathJax-Span-5963\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>Œ∏</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-381\">\\pi_{\\theta}</script>:</p>\n\n    <ul>\n      <li>Generates responses <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-382-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5964\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5965\"><span class=\"mi\" id=\"MathJax-Span-5966\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-382\">y</script> to prompts <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-383-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5967\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5968\"><span class=\"mi\" id=\"MathJax-Span-5969\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-383\">x</script>.</li>\n      <li>Updated via <strong>Proximal Policy Optimization (PPO)</strong> to maximize the clipped surrogate objective.</li>\n      <li>Receives both <strong>reward signals</strong> and <strong>value-based baselines</strong> during training.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Reference Model</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-384-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>ref</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5970\" style=\"width: 1.669em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.36em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5971\"><span class=\"msubsup\" id=\"MathJax-Span-5972\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5973\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-5974\"><span class=\"mrow\" id=\"MathJax-Span-5975\"><span class=\"mtext\" id=\"MathJax-Span-5976\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">ref</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>ref</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-384\">\\pi_{\\text{ref}}</script>:</p>\n\n    <ul>\n      <li>\n        <p>Provides a baseline distribution for <strong>KL regularization</strong> to prevent over-optimization.</p>\n      </li>\n      <li>\n        <p>Frozen during training; used to compute token-wise divergence:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-385-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>KL</mtext></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>(</mo></mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>&amp;#x2016;</mo><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>ref</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>)</mo></mrow><mo>=</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>y</mi></mrow></munder><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x22C5;</mo><mi>log</mi><mo>&amp;#x2061;</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>ref</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5977\" style=\"width: 27.763em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 23.128em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.669em, 1023.13em, 4.742em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5978\"><span class=\"msubsup\" id=\"MathJax-Span-5979\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5980\" style=\"font-family: STIXGeneral-Italic;\">D</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-5981\"><span class=\"mrow\" id=\"MathJax-Span-5982\"><span class=\"mtext\" id=\"MathJax-Span-5983\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">KL</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-5984\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-5985\"><span class=\"mo\" id=\"MathJax-Span-5986\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">(</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-5987\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5988\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-5989\"><span class=\"mrow\" id=\"MathJax-Span-5990\"><span class=\"mi\" id=\"MathJax-Span-5991\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5992\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-5993\" style=\"font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-5994\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-5995\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5996\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5997\" style=\"font-family: STIXGeneral-Regular;\">‚Äñ</span><span class=\"msubsup\" id=\"MathJax-Span-5998\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5999\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-6000\"><span class=\"mrow\" id=\"MathJax-Span-6001\"><span class=\"mtext\" id=\"MathJax-Span-6002\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">ref</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6003\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-6004\" style=\"font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-6005\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-6006\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6007\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-6008\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-6009\"><span class=\"mo\" id=\"MathJax-Span-6010\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">)</span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6011\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-6012\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-6013\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.43em, -999.997em); top: -2.862em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-6014\"><span class=\"mrow\" id=\"MathJax-Span-6015\"><span class=\"mi\" id=\"MathJax-Span-6016\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-6017\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6018\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-6019\"><span class=\"mrow\" id=\"MathJax-Span-6020\"><span class=\"mi\" id=\"MathJax-Span-6021\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6022\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6023\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-6024\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-6025\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6026\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6027\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚ãÖ</span><span class=\"mi\" id=\"MathJax-Span-6028\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">log</span><span class=\"mo\" id=\"MathJax-Span-6029\"></span><span class=\"mfrac\" id=\"MathJax-Span-6030\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 3.961em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.34em, 4.378em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.664em;\"><span class=\"mrow\" id=\"MathJax-Span-6031\"><span class=\"msubsup\" id=\"MathJax-Span-6032\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6033\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-6034\"><span class=\"mrow\" id=\"MathJax-Span-6035\"><span class=\"mi\" id=\"MathJax-Span-6036\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6037\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6038\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-6039\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-6040\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6041\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1003.75em, 4.378em, -999.997em); top: -3.331em; left: 50%; margin-left: -1.924em;\"><span class=\"mrow\" id=\"MathJax-Span-6042\"><span class=\"msubsup\" id=\"MathJax-Span-6043\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6044\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-6045\"><span class=\"mrow\" id=\"MathJax-Span-6046\"><span class=\"mtext\" id=\"MathJax-Span-6047\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">ref</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6048\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6049\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-6050\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-6051\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6052\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.96em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.961em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.747em; border-left: 0px solid; width: 0px; height: 3.441em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>D</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>KL</mtext></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo></mrow><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>Œ∏</mi></mrow></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo fence=\"false\" stretchy=\"false\">‚Äñ</mo><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>ref</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo></mrow><mo>=</mo><munder><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>y</mi></mrow></munder><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>Œ∏</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>‚ãÖ</mo><mi>log</mi><mo>‚Å°</mo><mfrac><mrow><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>Œ∏</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>ref</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-385\">D_{\\text{KL}}\\big(\\pi_{\\theta}(\\cdot \\mid x) \\Vert \\pi_{\\text{ref}}(\\cdot \\mid x)\\big)\n= \\sum_{y} \\pi_{\\theta}(y \\mid x) \\cdot \\log\\frac{\\pi_{\\theta}(y \\mid x)}{\\pi_{\\text{ref}}(y \\mid x)}</script>\n      </li>\n      <li>\n        <p>Ensures linguistic stability and mitigates <strong>reward hacking</strong> by anchoring the policy to its supervised fine-tuned prior.</p>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Reward Model</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-386-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03D5;</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6053\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.89em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6054\"><span class=\"msubsup\" id=\"MathJax-Span-6055\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6056\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-6057\"><span class=\"mrow\" id=\"MathJax-Span-6058\"><span class=\"mi\" id=\"MathJax-Span-6059\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œï</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-386\">r_{\\phi}</script>:</p>\n\n    <ul>\n      <li>Maps each generated response <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-387-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6060\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6061\"><span class=\"mi\" id=\"MathJax-Span-6062\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-387\">y</script> (conditioned on prompt <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-388-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6063\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6064\"><span class=\"mi\" id=\"MathJax-Span-6065\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-388\">x</script>) to a scalar reward:\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-389-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03D5;</mi></mrow></msub><mo>:</mo><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>&amp;#x21A6;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6066\" style=\"width: 6.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.73em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6067\"><span class=\"msubsup\" id=\"MathJax-Span-6068\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6069\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-6070\"><span class=\"mrow\" id=\"MathJax-Span-6071\"><span class=\"mi\" id=\"MathJax-Span-6072\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6073\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">:</span><span class=\"mo\" id=\"MathJax-Span-6074\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"mi\" id=\"MathJax-Span-6075\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6076\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6077\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-6078\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6079\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Ü¶</span><span class=\"texatom\" id=\"MathJax-Span-6080\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-6081\"><span class=\"mi\" id=\"MathJax-Span-6082\" style=\"font-family: STIXGeneral-Regular;\">‚Ñù</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œï</mi></mrow></msub><mo>:</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">‚Ü¶</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">R</mi></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-389\">r_{\\phi}: (x, y) \\mapsto \\mathbb{R}</script>.</li>\n      <li>Trained on <strong>human preference data</strong> (pairwise or ranked comparisons), then frozen during policy optimization.</li>\n      <li>Supplies an <strong>approximation of human judgment</strong>, encouraging the policy to produce more aligned, preferred responses.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Value Model</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-390-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C8;</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6083\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6084\"><span class=\"msubsup\" id=\"MathJax-Span-6085\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6086\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-6087\"><span class=\"mrow\" id=\"MathJax-Span-6088\"><span class=\"mi\" id=\"MathJax-Span-6089\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œà<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œà</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-390\">V_{\\psi}</script>:</p>\n\n    <ul>\n      <li>Estimates the <strong>expected return</strong> for a given prompt (or state) <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-391-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6090\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6091\"><span class=\"mi\" id=\"MathJax-Span-6092\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-391\">x</script>, reducing variance in policy-gradient updates.</li>\n      <li>Trained in parallel with the policy to predict the observed or bootstrapped return:\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-392-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>R</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03D5;</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6093\" style=\"width: 8.701em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1007.19em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6094\"><span class=\"texatom\" id=\"MathJax-Span-6095\"><span class=\"mrow\" id=\"MathJax-Span-6096\"><span class=\"munderover\" id=\"MathJax-Span-6097\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6098\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-6099\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6100\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6101\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6102\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6103\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-6104\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6105\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-6106\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6107\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-6108\"><span class=\"mrow\" id=\"MathJax-Span-6109\"><span class=\"mi\" id=\"MathJax-Span-6110\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6111\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6112\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6113\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6114\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-6115\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6116\" style=\"font-family: STIXGeneral-Regular;\">,</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>R</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œï</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>,</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-392\">\\hat{R}(x, y) = r_{\\phi}(x, y),</script>\nand provides <strong>advantage estimates</strong>:\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-393-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03D5;</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C8;</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>.</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6117\" style=\"width: 12.763em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1010.58em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6118\"><span class=\"texatom\" id=\"MathJax-Span-6119\"><span class=\"mrow\" id=\"MathJax-Span-6120\"><span class=\"munderover\" id=\"MathJax-Span-6121\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6122\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-6123\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6124\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6125\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6126\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6127\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-6128\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6129\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-6130\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6131\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-6132\"><span class=\"mrow\" id=\"MathJax-Span-6133\"><span class=\"mi\" id=\"MathJax-Span-6134\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6135\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6136\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6137\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6138\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-6139\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6140\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-6141\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6142\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-6143\"><span class=\"mrow\" id=\"MathJax-Span-6144\"><span class=\"mi\" id=\"MathJax-Span-6145\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œà<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6146\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6147\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6148\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6149\" style=\"font-family: STIXGeneral-Regular;\">.</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œï</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œà</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>.</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-393\">\\hat{A}(x, y) = r_{\\phi}(x, y) - V_{\\psi}(x).</script></li>\n      <li>Serves as a <strong>critic</strong> in the actor‚Äìcritic framework, enabling stable and efficient optimization.</li>\n    </ul>\n  </li>\n</ul>\n<p><strong>Policy Model</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-381-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5957\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5958\"><span class=\"msubsup\" id=\"MathJax-Span-5959\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5960\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-5961\"><span class=\"mrow\" id=\"MathJax-Span-5962\"><span class=\"mi\" id=\"MathJax-Span-5963\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>Œ∏</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-381\">\\pi_{\\theta}</script>:</p>\n<ul>\n      <li>Generates responses <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-382-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5964\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5965\"><span class=\"mi\" id=\"MathJax-Span-5966\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-382\">y</script> to prompts <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-383-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5967\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5968\"><span class=\"mi\" id=\"MathJax-Span-5969\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-383\">x</script>.</li>\n      <li>Updated via <strong>Proximal Policy Optimization (PPO)</strong> to maximize the clipped surrogate objective.</li>\n      <li>Receives both <strong>reward signals</strong> and <strong>value-based baselines</strong> during training.</li>\n    </ul>\n<p><strong>Reference Model</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-384-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>ref</mtext></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5970\" style=\"width: 1.669em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.36em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5971\"><span class=\"msubsup\" id=\"MathJax-Span-5972\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5973\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-5974\"><span class=\"mrow\" id=\"MathJax-Span-5975\"><span class=\"mtext\" id=\"MathJax-Span-5976\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">ref</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>ref</mtext></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-384\">\\pi_{\\text{ref}}</script>:</p>\n<ul>\n      <li>\n        <p>Provides a baseline distribution for <strong>KL regularization</strong> to prevent over-optimization.</p>\n      </li>\n      <li>\n        <p>Frozen during training; used to compute token-wise divergence:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-385-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>KL</mtext></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>(</mo></mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>&amp;#x2016;</mo><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>ref</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;#x22C5;</mo><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>)</mo></mrow><mo>=</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>y</mi></mrow></munder><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x22C5;</mo><mi>log</mi><mo>&amp;#x2061;</mo><mfrac><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>ref</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo>&amp;#x2223;</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-5977\" style=\"width: 27.763em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 23.128em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.669em, 1023.13em, 4.742em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5978\"><span class=\"msubsup\" id=\"MathJax-Span-5979\"><span style=\"display: inline-block; position: relative; width: 1.721em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5980\" style=\"font-family: STIXGeneral-Italic;\">D</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-5981\"><span class=\"mrow\" id=\"MathJax-Span-5982\"><span class=\"mtext\" id=\"MathJax-Span-5983\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">KL</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-5984\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-5985\"><span class=\"mo\" id=\"MathJax-Span-5986\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">(</span></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-5987\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5988\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-5989\"><span class=\"mrow\" id=\"MathJax-Span-5990\"><span class=\"mi\" id=\"MathJax-Span-5991\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-5992\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-5993\" style=\"font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-5994\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-5995\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-5996\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-5997\" style=\"font-family: STIXGeneral-Regular;\">‚Äñ</span><span class=\"msubsup\" id=\"MathJax-Span-5998\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-5999\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-6000\"><span class=\"mrow\" id=\"MathJax-Span-6001\"><span class=\"mtext\" id=\"MathJax-Span-6002\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">ref</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6003\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mo\" id=\"MathJax-Span-6004\" style=\"font-family: STIXGeneral-Regular;\">‚ãÖ</span><span class=\"mo\" id=\"MathJax-Span-6005\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-6006\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6007\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"texatom\" id=\"MathJax-Span-6008\" style=\"\"><span class=\"mrow\" id=\"MathJax-Span-6009\"><span class=\"mo\" id=\"MathJax-Span-6010\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">)</span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6011\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-6012\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-6013\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.544em, 1000.32em, 4.43em, -999.997em); top: -2.862em; left: 0.471em;\"><span class=\"texatom\" id=\"MathJax-Span-6014\"><span class=\"mrow\" id=\"MathJax-Span-6015\"><span class=\"mi\" id=\"MathJax-Span-6016\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-6017\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6018\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-6019\"><span class=\"mrow\" id=\"MathJax-Span-6020\"><span class=\"mi\" id=\"MathJax-Span-6021\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6022\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6023\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-6024\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-6025\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6026\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6027\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚ãÖ</span><span class=\"mi\" id=\"MathJax-Span-6028\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">log</span><span class=\"mo\" id=\"MathJax-Span-6029\"></span><span class=\"mfrac\" id=\"MathJax-Span-6030\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 3.961em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.34em, 4.378em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.664em;\"><span class=\"mrow\" id=\"MathJax-Span-6031\"><span class=\"msubsup\" id=\"MathJax-Span-6032\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6033\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-6034\"><span class=\"mrow\" id=\"MathJax-Span-6035\"><span class=\"mi\" id=\"MathJax-Span-6036\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6037\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6038\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-6039\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-6040\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6041\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1003.75em, 4.378em, -999.997em); top: -3.331em; left: 50%; margin-left: -1.924em;\"><span class=\"mrow\" id=\"MathJax-Span-6042\"><span class=\"msubsup\" id=\"MathJax-Span-6043\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6044\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-6045\"><span class=\"mrow\" id=\"MathJax-Span-6046\"><span class=\"mtext\" id=\"MathJax-Span-6047\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">ref</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6048\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6049\" style=\"font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-6050\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"mi\" id=\"MathJax-Span-6051\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6052\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.96em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.961em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.747em; border-left: 0px solid; width: 0px; height: 3.441em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>D</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>KL</mtext></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo></mrow><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>Œ∏</mi></mrow></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo fence=\"false\" stretchy=\"false\">‚Äñ</mo><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>ref</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mo>‚ãÖ</mo><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo></mrow><mo>=</mo><munder><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>y</mi></mrow></munder><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>Œ∏</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>‚ãÖ</mo><mi>log</mi><mo>‚Å°</mo><mfrac><mrow><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>Œ∏</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mrow><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>ref</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>y</mi><mo>‚à£</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-385\">D_{\\text{KL}}\\big(\\pi_{\\theta}(\\cdot \\mid x) \\Vert \\pi_{\\text{ref}}(\\cdot \\mid x)\\big)\n= \\sum_{y} \\pi_{\\theta}(y \\mid x) \\cdot \\log\\frac{\\pi_{\\theta}(y \\mid x)}{\\pi_{\\text{ref}}(y \\mid x)}</script>\n      </li>\n      <li>\n        <p>Ensures linguistic stability and mitigates <strong>reward hacking</strong> by anchoring the policy to its supervised fine-tuned prior.</p>\n      </li>\n    </ul>\n<p>Provides a baseline distribution for <strong>KL regularization</strong> to prevent over-optimization.</p>\n<p>Frozen during training; used to compute token-wise divergence:</p>\n<p>Ensures linguistic stability and mitigates <strong>reward hacking</strong> by anchoring the policy to its supervised fine-tuned prior.</p>\n<p><strong>Reward Model</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-386-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03D5;</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6053\" style=\"width: 1.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.89em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6054\"><span class=\"msubsup\" id=\"MathJax-Span-6055\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6056\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-6057\"><span class=\"mrow\" id=\"MathJax-Span-6058\"><span class=\"mi\" id=\"MathJax-Span-6059\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œï</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-386\">r_{\\phi}</script>:</p>\n<ul>\n      <li>Maps each generated response <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-387-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6060\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6061\"><span class=\"mi\" id=\"MathJax-Span-6062\" style=\"font-family: STIXGeneral-Italic;\">y</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-387\">y</script> (conditioned on prompt <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-388-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6063\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6064\"><span class=\"mi\" id=\"MathJax-Span-6065\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-388\">x</script>) to a scalar reward:\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-389-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03D5;</mi></mrow></msub><mo>:</mo><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>&amp;#x21A6;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>R</mi></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6066\" style=\"width: 6.982em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.73em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6067\"><span class=\"msubsup\" id=\"MathJax-Span-6068\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6069\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-6070\"><span class=\"mrow\" id=\"MathJax-Span-6071\"><span class=\"mi\" id=\"MathJax-Span-6072\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6073\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">:</span><span class=\"mo\" id=\"MathJax-Span-6074\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">(</span><span class=\"mi\" id=\"MathJax-Span-6075\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6076\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6077\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-6078\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6079\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚Ü¶</span><span class=\"texatom\" id=\"MathJax-Span-6080\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-6081\"><span class=\"mi\" id=\"MathJax-Span-6082\" style=\"font-family: STIXGeneral-Regular;\">‚Ñù</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œï</mi></mrow></msub><mo>:</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">‚Ü¶</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">R</mi></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-389\">r_{\\phi}: (x, y) \\mapsto \\mathbb{R}</script>.</li>\n      <li>Trained on <strong>human preference data</strong> (pairwise or ranked comparisons), then frozen during policy optimization.</li>\n      <li>Supplies an <strong>approximation of human judgment</strong>, encouraging the policy to produce more aligned, preferred responses.</li>\n    </ul>\n<p><strong>Value Model</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-390-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C8;</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6083\" style=\"width: 1.409em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1001.15em, 2.607em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6084\"><span class=\"msubsup\" id=\"MathJax-Span-6085\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6086\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-6087\"><span class=\"mrow\" id=\"MathJax-Span-6088\"><span class=\"mi\" id=\"MathJax-Span-6089\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œà<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œà</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-390\">V_{\\psi}</script>:</p>\n<ul>\n      <li>Estimates the <strong>expected return</strong> for a given prompt (or state) <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-391-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6090\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6091\"><span class=\"mi\" id=\"MathJax-Span-6092\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>x</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-391\">x</script>, reducing variance in policy-gradient updates.</li>\n      <li>Trained in parallel with the policy to predict the observed or bootstrapped return:\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-392-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>R</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03D5;</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6093\" style=\"width: 8.701em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1007.19em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6094\"><span class=\"texatom\" id=\"MathJax-Span-6095\"><span class=\"mrow\" id=\"MathJax-Span-6096\"><span class=\"munderover\" id=\"MathJax-Span-6097\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6098\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-6099\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6100\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6101\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6102\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6103\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-6104\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6105\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-6106\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6107\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-6108\"><span class=\"mrow\" id=\"MathJax-Span-6109\"><span class=\"mi\" id=\"MathJax-Span-6110\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6111\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6112\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6113\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6114\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-6115\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6116\" style=\"font-family: STIXGeneral-Regular;\">,</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>R</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œï</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>,</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-392\">\\hat{R}(x, y) = r_{\\phi}(x, y),</script>\nand provides <strong>advantage estimates</strong>:\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-393-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03D5;</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C8;</mi></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>.</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6117\" style=\"width: 12.763em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1010.58em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6118\"><span class=\"texatom\" id=\"MathJax-Span-6119\"><span class=\"mrow\" id=\"MathJax-Span-6120\"><span class=\"munderover\" id=\"MathJax-Span-6121\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6122\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-6123\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6124\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6125\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6126\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6127\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-6128\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6129\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-6130\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6131\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-6132\"><span class=\"mrow\" id=\"MathJax-Span-6133\"><span class=\"mi\" id=\"MathJax-Span-6134\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6135\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6136\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6137\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6138\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-6139\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6140\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-6141\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6142\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-6143\"><span class=\"mrow\" id=\"MathJax-Span-6144\"><span class=\"mi\" id=\"MathJax-Span-6145\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œà<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6146\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6147\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6148\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6149\" style=\"font-family: STIXGeneral-Regular;\">.</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œï</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œà</mi></mrow></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>.</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-393\">\\hat{A}(x, y) = r_{\\phi}(x, y) - V_{\\psi}(x).</script></li>\n      <li>Serves as a <strong>critic</strong> in the actor‚Äìcritic framework, enabling stable and efficient optimization.</li>\n    </ul>\n<h5 id=\"full-training-loop\">Full Training Loop</h5>\n<ul>\n  <li>\n    <p><strong>Step 1: Sampling Responses</strong>:</p>\n\n    <ul>\n      <li>Draw a batch of prompts <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-394-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>x</mi><mi>i</mi></msub></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6150\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.73em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6151\"><span class=\"texatom\" id=\"MathJax-Span-6152\"><span class=\"mrow\" id=\"MathJax-Span-6153\"><span class=\"msubsup\" id=\"MathJax-Span-6154\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6155\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-6156\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>x</mi><mi>i</mi></msub></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-394\">{x_i}</script> from the dataset.</li>\n      <li>Generate responses <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-395-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>y</mi><mi>i</mi></msub></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6157\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.73em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6158\"><span class=\"texatom\" id=\"MathJax-Span-6159\"><span class=\"mrow\" id=\"MathJax-Span-6160\"><span class=\"msubsup\" id=\"MathJax-Span-6161\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6162\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-6163\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>y</mi><mi>i</mi></msub></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-395\">{y_i}</script> from the current policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-396-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6164\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6165\"><span class=\"msubsup\" id=\"MathJax-Span-6166\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6167\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6168\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-396\">\\pi_\\theta</script>.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Step 2: Reward Evaluation</strong>:</p>\n\n    <ul>\n      <li>Compute scalar rewards <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-397-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6169\" style=\"width: 4.221em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.492em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.44em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6170\"><span class=\"msubsup\" id=\"MathJax-Span-6171\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6172\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6173\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6174\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6175\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6176\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-6177\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6178\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-6179\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6180\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-6181\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6182\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-397\">r_\\phi(x_i, y_i)</script> using the reward model.</li>\n      <li>Compute KL penalties from the reference model.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Step 3: Advantage Computation</strong>:</p>\n\n    <ul>\n      <li>Use the value model to estimate baselines <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-398-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6183\" style=\"width: 3.076em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.555em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.5em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6184\"><span class=\"msubsup\" id=\"MathJax-Span-6185\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6186\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-6187\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œà<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6188\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6189\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6190\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-6191\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6192\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œà</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-398\">V_\\psi(x_i)</script>.</li>\n      <li>Compute advantages <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-399-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>i</mi></msub><mo>=</mo><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6193\" style=\"width: 11.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.221em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1009.17em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6194\"><span class=\"msubsup\" id=\"MathJax-Span-6195\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-6196\"><span class=\"mrow\" id=\"MathJax-Span-6197\"><span class=\"munderover\" id=\"MathJax-Span-6198\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6199\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-6200\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-6201\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6202\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-6203\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6204\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6205\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6206\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6207\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6208\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-6209\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6210\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-6211\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6212\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-6213\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6214\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6215\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-6216\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6217\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-6218\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œà<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6219\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6220\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6221\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-6222\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6223\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>i</mi></msub><mo>=</mo><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>V</mi><mi>œà</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-399\">\\hat{A}_i = r_\\phi(x_i, y_i) - V_\\psi(x_i)</script>.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Step 4: Policy Update (PPO)</strong>:</p>\n\n    <ul>\n      <li>Optimize <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-400-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>PPO</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6224\" style=\"width: 3.857em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.18em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.13em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6225\"><span class=\"msubsup\" id=\"MathJax-Span-6226\"><span style=\"display: inline-block; position: relative; width: 1.93em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6227\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-6228\"><span class=\"mrow\" id=\"MathJax-Span-6229\"><span class=\"mtext\" id=\"MathJax-Span-6230\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">PPO</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6231\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6232\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6233\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>PPO</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-400\">L_{\\text{PPO}}(\\theta)</script> with respect to the policy parameters.</li>\n      <li>Clip ratios and advantages to maintain stable updates.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Step 5: Value Model Update</strong>:</p>\n\n    <ul>\n      <li>Update the critic via regression:\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-401-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>L</mi></mrow><mi>V</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6234\" style=\"width: 17.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 14.326em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.086em, 1014.12em, 3.753em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6235\"><span class=\"msubsup\" id=\"MathJax-Span-6236\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-6237\"><span class=\"mrow\" id=\"MathJax-Span-6238\"><span class=\"mi\" id=\"MathJax-Span-6239\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∏</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"mi\" id=\"MathJax-Span-6240\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6241\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6242\" style=\"font-family: STIXGeneral-Italic;\">œà<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.107em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6243\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6244\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-6245\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.982em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-6246\"><span class=\"mrow\" id=\"MathJax-Span-6247\"><span class=\"mi\" id=\"MathJax-Span-6248\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-6249\"><span class=\"mrow\" id=\"MathJax-Span-6250\"><span class=\"mo\" id=\"MathJax-Span-6251\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6252\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6253\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6254\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-6255\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-6256\"><span class=\"mrow\" id=\"MathJax-Span-6257\"><span class=\"mo\" id=\"MathJax-Span-6258\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6259\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6260\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6261\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-6262\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œà<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6263\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6264\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6265\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6266\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-6267\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6268\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6269\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6270\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6271\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6272\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6273\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-6274\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-6275\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-6276\" style=\"font-family: STIXGeneral-Regular;\">)</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.315em;\"><span class=\"mn\" id=\"MathJax-Span-6277\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-6278\"><span class=\"mrow\" id=\"MathJax-Span-6279\"><span class=\"mo\" id=\"MathJax-Span-6280\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">L</mi></mrow><mi>V</mi></msub><mo stretchy=\"false\">(</mo><mi>œà</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">[</mo></mrow><mo stretchy=\"false\">(</mo><msub><mi>V</mi><mi>œà</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">]</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-401\">\\mathcal{L}_V(\\psi) = \\mathbb{E}_{(x,y)} \\big[ (V_\\psi(x) - r_\\phi(x,y))^2 \\big]</script></li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Step 6: Iteration and Rollout</strong>:</p>\n\n    <ul>\n      <li>Repeat with new samples from the updated policy.</li>\n      <li>Periodically evaluate human or synthetic preference metrics to ensure alignment progress.</li>\n    </ul>\n  </li>\n</ul>\n<p><strong>Step 1: Sampling Responses</strong>:</p>\n<ul>\n      <li>Draw a batch of prompts <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-394-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>x</mi><mi>i</mi></msub></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6150\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.73em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6151\"><span class=\"texatom\" id=\"MathJax-Span-6152\"><span class=\"mrow\" id=\"MathJax-Span-6153\"><span class=\"msubsup\" id=\"MathJax-Span-6154\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6155\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-6156\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>x</mi><mi>i</mi></msub></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-394\">{x_i}</script> from the dataset.</li>\n      <li>Generate responses <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-395-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>y</mi><mi>i</mi></msub></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6157\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.73em, 2.503em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6158\"><span class=\"texatom\" id=\"MathJax-Span-6159\"><span class=\"mrow\" id=\"MathJax-Span-6160\"><span class=\"msubsup\" id=\"MathJax-Span-6161\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6162\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-6163\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>y</mi><mi>i</mi></msub></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-395\">{y_i}</script> from the current policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-396-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6164\" style=\"width: 1.148em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.94em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6165\"><span class=\"msubsup\" id=\"MathJax-Span-6166\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6167\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6168\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-396\">\\pi_\\theta</script>.</li>\n    </ul>\n<p><strong>Step 2: Reward Evaluation</strong>:</p>\n<ul>\n      <li>Compute scalar rewards <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-397-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6169\" style=\"width: 4.221em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.492em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.44em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6170\"><span class=\"msubsup\" id=\"MathJax-Span-6171\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6172\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6173\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6174\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6175\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6176\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-6177\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6178\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-6179\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6180\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-6181\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6182\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-397\">r_\\phi(x_i, y_i)</script> using the reward model.</li>\n      <li>Compute KL penalties from the reference model.</li>\n    </ul>\n<p><strong>Step 3: Advantage Computation</strong>:</p>\n<ul>\n      <li>Use the value model to estimate baselines <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-398-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6183\" style=\"width: 3.076em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.555em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.5em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6184\"><span class=\"msubsup\" id=\"MathJax-Span-6185\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6186\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-6187\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œà<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6188\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6189\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6190\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-6191\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6192\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œà</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-398\">V_\\psi(x_i)</script>.</li>\n      <li>Compute advantages <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-399-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>A</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mi>i</mi></msub><mo>=</mo><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6193\" style=\"width: 11.096em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.221em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.044em, 1009.17em, 2.659em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6194\"><span class=\"msubsup\" id=\"MathJax-Span-6195\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-6196\"><span class=\"mrow\" id=\"MathJax-Span-6197\"><span class=\"munderover\" id=\"MathJax-Span-6198\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6199\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.32em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-6200\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-6201\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6202\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-6203\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6204\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6205\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6206\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6207\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6208\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-6209\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6210\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-6211\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6212\" style=\"font-family: STIXGeneral-Italic;\">y</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-6213\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6214\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6215\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-6216\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6217\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-6218\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œà<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6219\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6220\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6221\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.471em;\"><span class=\"mi\" id=\"MathJax-Span-6222\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6223\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.628em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>A</mi><mo stretchy=\"false\">^</mo></mover></mrow><mi>i</mi></msub><mo>=</mo><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>V</mi><mi>œà</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-399\">\\hat{A}_i = r_\\phi(x_i, y_i) - V_\\psi(x_i)</script>.</li>\n    </ul>\n<p><strong>Step 4: Policy Update (PPO)</strong>:</p>\n<ul>\n      <li>Optimize <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-400-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>PPO</mtext></mrow></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03B8;</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6224\" style=\"width: 3.857em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.18em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.13em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6225\"><span class=\"msubsup\" id=\"MathJax-Span-6226\"><span style=\"display: inline-block; position: relative; width: 1.93em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6227\" style=\"font-family: STIXGeneral-Italic;\">L<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-6228\"><span class=\"mrow\" id=\"MathJax-Span-6229\"><span class=\"mtext\" id=\"MathJax-Span-6230\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">PPO</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6231\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6232\" style=\"font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6233\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>L</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>PPO</mtext></mrow></msub><mo stretchy=\"false\">(</mo><mi>Œ∏</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-400\">L_{\\text{PPO}}(\\theta)</script> with respect to the policy parameters.</li>\n      <li>Clip ratios and advantages to maintain stable updates.</li>\n    </ul>\n<p><strong>Step 5: Value Model Update</strong>:</p>\n<ul>\n      <li>Update the critic via regression:\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-401-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>L</mi></mrow><mi>V</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C8;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>[</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;>]</mo></mrow></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6234\" style=\"width: 17.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 14.326em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.086em, 1014.12em, 3.753em, -999.997em); top: -3.174em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6235\"><span class=\"msubsup\" id=\"MathJax-Span-6236\"><span style=\"display: inline-block; position: relative; width: 1.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-6237\"><span class=\"mrow\" id=\"MathJax-Span-6238\"><span class=\"mi\" id=\"MathJax-Span-6239\" style=\"font-family: STIXNonUnicode-Italic;\">Óà∏</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.68em;\"><span class=\"mi\" id=\"MathJax-Span-6240\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6241\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6242\" style=\"font-family: STIXGeneral-Italic;\">œà<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.107em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6243\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6244\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-6245\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.982em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-6246\"><span class=\"mrow\" id=\"MathJax-Span-6247\"><span class=\"mi\" id=\"MathJax-Span-6248\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-6249\"><span class=\"mrow\" id=\"MathJax-Span-6250\"><span class=\"mo\" id=\"MathJax-Span-6251\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6252\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6253\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6254\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">y</span><span class=\"mo\" id=\"MathJax-Span-6255\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">)</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-6256\"><span class=\"mrow\" id=\"MathJax-Span-6257\"><span class=\"mo\" id=\"MathJax-Span-6258\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">[</span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6259\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6260\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6261\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-6262\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œà<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6263\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6264\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6265\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6266\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-6267\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6268\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6269\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6270\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6271\" style=\"font-family: STIXGeneral-Italic;\">x<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6272\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6273\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">y</span><span class=\"mo\" id=\"MathJax-Span-6274\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"msubsup\" id=\"MathJax-Span-6275\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.26em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-6276\" style=\"font-family: STIXGeneral-Regular;\">)</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.315em;\"><span class=\"mn\" id=\"MathJax-Span-6277\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-6278\"><span class=\"mrow\" id=\"MathJax-Span-6279\"><span class=\"mo\" id=\"MathJax-Span-6280\" style=\"vertical-align: -0.258em;\"><span><span style=\"font-size: 110%; font-family: STIXSizeOneSym;\">]</span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.18em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.559em; border-left: 0px solid; width: 0px; height: 1.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">L</mi></mrow><mi>V</mi></msub><mo stretchy=\"false\">(</mo><mi>œà</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">[</mo></mrow><mo stretchy=\"false\">(</mo><msub><mi>V</mi><mi>œà</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msub><mi>r</mi><mi>œï</mi></msub><mo stretchy=\"false\">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mrow class=\"MJX-TeXAtom-ORD\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">]</mo></mrow></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-401\">\\mathcal{L}_V(\\psi) = \\mathbb{E}_{(x,y)} \\big[ (V_\\psi(x) - r_\\phi(x,y))^2 \\big]</script></li>\n    </ul>\n<p><strong>Step 6: Iteration and Rollout</strong>:</p>\n<ul>\n      <li>Repeat with new samples from the updated policy.</li>\n      <li>Periodically evaluate human or synthetic preference metrics to ensure alignment progress.</li>\n    </ul>\n<h5 id=\"system-architecture\">System Architecture</h5>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-402-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;1.3em 0.3em&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;><mtr><mtd /><mtd><munder><mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;><munder><msub><mi>D</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>prompt</mtext></mrow></msub><mo>&amp;#x23DF;</mo></munder></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>Prompt Dataset</mtext></mrow></munder><mover><mo>&amp;#x2192;</mo><mpadded width=&quot;+0.611em&quot; lspace=&quot;0.278em&quot; voffset=&quot;.15em&quot;><mtext>sample prompts</mtext></mpadded></mover><munder><mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;><munder><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03B8;</mi></mrow></msub><mo>&amp;#x23DF;</mo></munder></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>Policy Model</mtext></mrow></munder><munderover><mo>&amp;#x2192;</mo><mpadded width=&quot;+0.611em&quot; lspace=&quot;0.278em&quot; voffset=&quot;-.24em&quot;><mtext>Generates responses</mtext></mpadded><mpadded width=&quot;+0.611em&quot; lspace=&quot;0.278em&quot; voffset=&quot;.15em&quot; /></munderover><munder><mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;><munder><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03D5;</mi></mrow></msub><mo>&amp;#x23DF;</mo></munder></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>Reward Model</mtext></mrow></munder><munderover><mo>&amp;#x2192;</mo><mpadded width=&quot;+0.611em&quot; lspace=&quot;0.278em&quot; voffset=&quot;-.24em&quot;><mtext>Computes scalar rewards</mtext></mpadded><mpadded width=&quot;+0.611em&quot; lspace=&quot;0.278em&quot; voffset=&quot;.15em&quot; /></munderover></mtd></mtr><mtr><mtd /><mtd><munder><mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;><munder><msub><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C8;</mi></mrow></msub><mo>&amp;#x23DF;</mo></munder></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>Value Model</mtext></mrow></munder><munderover><mo>&amp;#x2192;</mo><mpadded width=&quot;+0.611em&quot; lspace=&quot;0.278em&quot; voffset=&quot;-.24em&quot;><mtext>Computes baselines</mtext></mpadded><mpadded width=&quot;+0.611em&quot; lspace=&quot;0.278em&quot; voffset=&quot;.15em&quot; /></munderover><munder><mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;><munder><msub><mi>&amp;#x03C0;</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>ref</mtext></mrow></msub><mo>&amp;#x23DF;</mo></munder></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>Reference Model</mtext></mrow></munder><munderover><mo>&amp;#x2192;</mo><mpadded width=&quot;+0.611em&quot; lspace=&quot;0.278em&quot; voffset=&quot;-.24em&quot;><mtext>KL penalty computation</mtext></mpadded><mpadded width=&quot;+0.611em&quot; lspace=&quot;0.278em&quot; voffset=&quot;.15em&quot; /></munderover><munder><mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;><munder><mtext>PPO Optimization Loop</mtext><mo>&amp;#x23DF;</mo></munder></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>Policy update step</mtext></mrow></munder></mtd></mtr></mtable></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6281\" style=\"width: 40.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 33.701em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(-2.029em, 1033.54em, 5.732em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6282\"><span class=\"mtable\" id=\"MathJax-Span-6283\" style=\"padding-right: 0.159em; padding-left: 0.159em;\"><span style=\"display: inline-block; position: relative; width: 33.388em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.19em, 1000em, 6.461em, -999.997em); top: -4.945em; left: 0em;\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.857em, 1000em, 4.169em, -999.997em); top: -6.612em; right: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-6284\"><span class=\"mrow\" id=\"MathJax-Span-6285\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.857em, 1000em, 4.169em, -999.997em); top: -2.654em; right: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-6346\"><span class=\"mrow\" id=\"MathJax-Span-6347\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.951em;\"></span></span><span style=\"position: absolute; clip: rect(4.169em, 1033.39em, 11.93em, -999.997em); top: -8.331em; left: 0em;\"><span style=\"display: inline-block; position: relative; width: 33.388em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.503em, 1033.18em, 5.888em, -999.997em); top: -6.612em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-6286\"><span class=\"mrow\" id=\"MathJax-Span-6287\"><span class=\"munderover\" id=\"MathJax-Span-6288\"><span style=\"display: inline-block; position: relative; width: 4.378em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.23em, 4.951em, -999.997em); top: -4.008em; left: 0.576em;\"><span class=\"texatom\" id=\"MathJax-Span-6289\"><span class=\"mrow\" id=\"MathJax-Span-6290\"><span class=\"munderover\" id=\"MathJax-Span-6291\"><span style=\"display: inline-block; position: relative; width: 3.232em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1002.87em, 4.482em, -999.997em); top: -4.008em; left: 0.211em;\"><span class=\"msubsup\" id=\"MathJax-Span-6292\"><span style=\"display: inline-block; position: relative; width: 2.867em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6293\" style=\"font-family: STIXGeneral-Italic;\">D</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-6294\"><span class=\"mrow\" id=\"MathJax-Span-6295\"><span class=\"mtext\" id=\"MathJax-Span-6296\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">prompt</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.023em, 1003.23em, 3.596em, -999.997em); top: -2.654em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-6297\" style=\"\"><span style=\"font-family: STIXSizeFiveSym;\">‚èü</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1004.38em, 4.43em, -999.997em); top: -2.549em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-6298\"><span class=\"mrow\" id=\"MathJax-Span-6299\"><span class=\"mtext\" id=\"MathJax-Span-6300\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">Prompt Dataset</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-6301\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 5.107em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1005.11em, 4.117em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-6302\" style=\"\"><span style=\"display: inline-block; position: relative; width: 5.107em; height: 0px;\"><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: -0.049em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: 4.273em;\">‚Üí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.419em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.888em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 1.357em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 1.826em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 2.346em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 2.815em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 3.284em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 3.753em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1004.74em, 4.326em, -999.997em); top: -4.737em; left: 0.003em;\"><span class=\"mpadded\" id=\"MathJax-Span-6303\"><span style=\"display: inline-block; position: relative; width: 5.055em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1004.48em, 4.326em, -999.997em); top: -4.164em; left: 0.263em;\"><span class=\"mrow\" id=\"MathJax-Span-6304\"><span class=\"mtext\" id=\"MathJax-Span-6305\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">sample prompts</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-6306\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 3.857em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.94em, 4.742em, -999.997em); top: -4.008em; left: 1.461em;\"><span class=\"texatom\" id=\"MathJax-Span-6307\"><span class=\"mrow\" id=\"MathJax-Span-6308\"><span class=\"munderover\" id=\"MathJax-Span-6309\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.94em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"msubsup\" id=\"MathJax-Span-6310\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6311\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-6312\"><span class=\"mrow\" id=\"MathJax-Span-6313\"><span class=\"mi\" id=\"MathJax-Span-6314\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.076em, 1000.94em, 3.596em, -999.997em); top: -2.862em; left: 0.003em;\"><span class=\"mo\" id=\"MathJax-Span-6315\" style=\"\"><span style=\"font-family: STIXSizeOneSym;\">‚èü</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1003.8em, 4.43em, -999.997em); top: -2.758em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-6316\"><span class=\"mrow\" id=\"MathJax-Span-6317\"><span class=\"mtext\" id=\"MathJax-Span-6318\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">Policy Model</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-6319\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 6.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1006.36em, 4.117em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-6320\" style=\"\"><span style=\"display: inline-block; position: relative; width: 6.357em; height: 0px;\"><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: -0.049em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: 5.523em;\">‚Üí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.419em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.94em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 1.461em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 1.93em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 2.451em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 2.971em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 3.492em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 3.961em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 4.482em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 5.003em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1005.99em, 4.586em, -999.997em); top: -3.383em; left: 0.003em;\"><span class=\"mpadded\" id=\"MathJax-Span-6321\"><span style=\"display: inline-block; position: relative; width: 6.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1005.73em, 4.326em, -999.997em); top: -3.747em; left: 0.263em;\"><span class=\"mrow\" id=\"MathJax-Span-6322\"><span class=\"mtext\" id=\"MathJax-Span-6323\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">Generates responses</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.701em, 1000.26em, 4.169em, -999.997em); top: -4.685em; left: 2.919em;\"><span class=\"mpadded\" id=\"MathJax-Span-6324\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.857em, 1000em, 4.169em, -999.997em); top: -4.164em; left: 0.263em;\"><span class=\"mrow\" id=\"MathJax-Span-6325\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-6326\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 4.221em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.94em, 4.898em, -999.997em); top: -4.008em; left: 1.669em;\"><span class=\"texatom\" id=\"MathJax-Span-6327\"><span class=\"mrow\" id=\"MathJax-Span-6328\"><span class=\"munderover\" id=\"MathJax-Span-6329\"><span style=\"display: inline-block; position: relative; width: 0.94em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.89em, 4.482em, -999.997em); top: -4.008em; left: 0.003em;\"><span class=\"msubsup\" id=\"MathJax-Span-6330\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6331\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-6332\"><span class=\"mrow\" id=\"MathJax-Span-6333\"><span class=\"mi\" id=\"MathJax-Span-6334\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.076em, 1000.94em, 3.596em, -999.997em); top: -2.706em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-6335\" style=\"\"><span style=\"font-family: STIXSizeOneSym;\">‚èü</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1004.22em, 4.273em, -999.997em); top: -2.602em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-6336\"><span class=\"mrow\" id=\"MathJax-Span-6337\"><span class=\"mtext\" id=\"MathJax-Span-6338\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">Reward Model</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-6339\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 7.711em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1007.71em, 4.117em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-6340\" style=\"\"><span style=\"display: inline-block; position: relative; width: 7.711em; height: 0px;\"><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: -0.049em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: 6.878em;\">‚Üí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.419em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.888em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 1.409em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 1.878em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 2.398em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 2.867em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 3.388em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 3.909em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 4.378em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 4.898em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 5.367em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 5.888em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 6.357em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1007.35em, 4.586em, -999.997em); top: -3.383em; left: 0.003em;\"><span class=\"mpadded\" id=\"MathJax-Span-6341\"><span style=\"display: inline-block; position: relative; width: 7.711em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1007.09em, 4.326em, -999.997em); top: -3.747em; left: 0.263em;\"><span class=\"mrow\" id=\"MathJax-Span-6342\"><span class=\"mtext\" id=\"MathJax-Span-6343\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">Computes scalar rewards</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.701em, 1000.26em, 4.169em, -999.997em); top: -4.685em; left: 3.596em;\"><span class=\"mpadded\" id=\"MathJax-Span-6344\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.857em, 1000em, 4.169em, -999.997em); top: -4.164em; left: 0.263em;\"><span class=\"mrow\" id=\"MathJax-Span-6345\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.023em, 1033.39em, 6.201em, -999.997em); top: -2.654em; left: 0em;\"><span class=\"mtd\" id=\"MathJax-Span-6348\"><span class=\"mrow\" id=\"MathJax-Span-6349\"><span class=\"munderover\" id=\"MathJax-Span-6350\"><span style=\"display: inline-block; position: relative; width: 3.701em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1001.46em, 4.898em, -999.997em); top: -4.008em; left: 1.148em;\"><span class=\"texatom\" id=\"MathJax-Span-6351\"><span class=\"mrow\" id=\"MathJax-Span-6352\"><span class=\"munderover\" id=\"MathJax-Span-6353\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1001.15em, 4.482em, -999.997em); top: -4.008em; left: 0.159em;\"><span class=\"msubsup\" id=\"MathJax-Span-6354\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6355\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-6356\"><span class=\"mrow\" id=\"MathJax-Span-6357\"><span class=\"mi\" id=\"MathJax-Span-6358\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œà<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.076em, 1001.46em, 3.596em, -999.997em); top: -2.706em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-6359\" style=\"\"><span style=\"font-family: STIXSizeTwoSym;\">‚èü</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1003.7em, 4.273em, -999.997em); top: -2.602em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-6360\"><span class=\"mrow\" id=\"MathJax-Span-6361\"><span class=\"mtext\" id=\"MathJax-Span-6362\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">Value Model</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-6363\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 6.253em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1006.25em, 4.117em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-6364\" style=\"\"><span style=\"display: inline-block; position: relative; width: 6.253em; height: 0px;\"><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: -0.049em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: 5.367em;\">‚Üí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.419em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.888em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 1.409em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 1.93em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 2.398em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 2.919em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 3.388em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 3.909em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 4.378em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 4.898em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1005.89em, 4.586em, -999.997em); top: -3.383em; left: 0.003em;\"><span class=\"mpadded\" id=\"MathJax-Span-6365\"><span style=\"display: inline-block; position: relative; width: 6.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1005.63em, 4.326em, -999.997em); top: -3.747em; left: 0.263em;\"><span class=\"mrow\" id=\"MathJax-Span-6366\"><span class=\"mtext\" id=\"MathJax-Span-6367\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">Computes baselines</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.701em, 1000.26em, 4.169em, -999.997em); top: -4.685em; left: 2.815em;\"><span class=\"mpadded\" id=\"MathJax-Span-6368\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.857em, 1000em, 4.169em, -999.997em); top: -4.164em; left: 0.263em;\"><span class=\"mrow\" id=\"MathJax-Span-6369\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-6370\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 4.898em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1001.46em, 4.742em, -999.997em); top: -4.008em; left: 1.721em;\"><span class=\"texatom\" id=\"MathJax-Span-6371\"><span class=\"mrow\" id=\"MathJax-Span-6372\"><span class=\"munderover\" id=\"MathJax-Span-6373\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1001.36em, 4.326em, -999.997em); top: -4.008em; left: 0.055em;\"><span class=\"msubsup\" id=\"MathJax-Span-6374\"><span style=\"display: inline-block; position: relative; width: 1.357em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6375\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"texatom\" id=\"MathJax-Span-6376\"><span class=\"mrow\" id=\"MathJax-Span-6377\"><span class=\"mtext\" id=\"MathJax-Span-6378\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">ref</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.076em, 1001.46em, 3.596em, -999.997em); top: -2.862em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-6379\" style=\"\"><span style=\"font-family: STIXSizeTwoSym;\">‚èü</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1004.9em, 4.273em, -999.997em); top: -2.758em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-6380\"><span class=\"mrow\" id=\"MathJax-Span-6381\"><span class=\"mtext\" id=\"MathJax-Span-6382\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">Reference Model</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-6383\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 7.503em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1007.5em, 4.117em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-6384\" style=\"\"><span style=\"display: inline-block; position: relative; width: 7.503em; height: 0px;\"><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: -0.049em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXGeneral-Regular; top: -4.008em; left: 6.669em;\">‚Üí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.419em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 0.888em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 1.357em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 1.826em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 2.346em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 2.815em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 3.284em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 3.753em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 4.273em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 4.742em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 5.211em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 5.68em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXGeneral-Regular; position: absolute; top: -4.008em; left: 6.201em;\">‚àí<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1007.19em, 4.586em, -999.997em); top: -3.383em; left: 0.003em;\"><span class=\"mpadded\" id=\"MathJax-Span-6385\"><span style=\"display: inline-block; position: relative; width: 7.503em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.388em, 1006.93em, 4.326em, -999.997em); top: -3.747em; left: 0.263em;\"><span class=\"mrow\" id=\"MathJax-Span-6386\"><span class=\"mtext\" id=\"MathJax-Span-6387\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">KL penalty computation</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.701em, 1000.26em, 4.169em, -999.997em); top: -4.685em; left: 3.492em;\"><span class=\"mpadded\" id=\"MathJax-Span-6388\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.857em, 1000em, 4.169em, -999.997em); top: -4.164em; left: 0.263em;\"><span class=\"mrow\" id=\"MathJax-Span-6389\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"munderover\" id=\"MathJax-Span-6390\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 9.742em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1009.74em, 5.315em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-6391\"><span class=\"mrow\" id=\"MathJax-Span-6392\"><span class=\"munderover\" id=\"MathJax-Span-6393\"><span style=\"display: inline-block; position: relative; width: 9.742em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1009.69em, 4.378em, -999.997em); top: -4.008em; left: 0.003em;\"><span class=\"mtext\" id=\"MathJax-Span-6394\" style=\"font-family: STIXGeneral-Regular;\">PPO Optimization Loop</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.701em, 1009.74em, 4.69em, -999.997em); top: -3.383em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-6395\" style=\"\"><span style=\"display: inline-block; position: relative; width: 9.742em; height: 0px;\"><span style=\"position: absolute; font-family: STIXNonUnicode-Regular; top: -4.008em; left: 0.003em;\">ÓÑΩ<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXNonUnicode-Regular; top: -4.008em; left: 8.805em;\">ÓÑæ<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; font-family: STIXNonUnicode-Regular; top: -4.008em; left: 3.961em;\">ÓÖÅ<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 0.784em;\">ÓÖã<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 1.305em;\">ÓÖã<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 1.826em;\">ÓÖã<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 2.346em;\">ÓÖã<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 2.919em;\">ÓÖã<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 3.44em;\">ÓÖã<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 5.68em;\">ÓÖã<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 6.201em;\">ÓÖã<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 6.721em;\">ÓÖã<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 7.242em;\">ÓÖã<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 7.763em;\">ÓÖã<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"font-family: STIXNonUnicode-Regular; position: absolute; top: -4.008em; left: 8.284em;\">ÓÖã<span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1005.16em, 4.43em, -999.997em); top: -2.185em; left: 2.294em;\"><span class=\"texatom\" id=\"MathJax-Span-6396\"><span class=\"mrow\" id=\"MathJax-Span-6397\"><span class=\"mtext\" id=\"MathJax-Span-6398\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">Policy update step</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 8.336em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -4.184em; border-left: 0px solid; width: 0px; height: 8.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mtable columnalign=\"right left right left right left right left right left right left\" rowspacing=\"1.3em 0.3em\" columnspacing=\"0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em\" displaystyle=\"true\"><mtr><mtd></mtd><mtd><munder><mrow class=\"MJX-TeXAtom-OP MJX-fixedlimits\"><munder><msub><mi>D</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>prompt</mtext></mrow></msub><mo>‚èü</mo></munder></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mtext>Prompt Dataset</mtext></mrow></munder><mover><mo>‚Üí</mo><mpadded width=\"+0.611em\" lspace=\"0.278em\" voffset=\".15em\"><mtext>sample prompts</mtext></mpadded></mover><munder><mrow class=\"MJX-TeXAtom-OP MJX-fixedlimits\"><munder><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>Œ∏</mi></mrow></msub><mo>‚èü</mo></munder></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mtext>Policy Model</mtext></mrow></munder><munderover><mo>‚Üí</mo><mpadded width=\"+0.611em\" lspace=\"0.278em\" voffset=\"-.24em\"><mtext>Generates responses</mtext></mpadded><mpadded width=\"+0.611em\" lspace=\"0.278em\" voffset=\".15em\"></mpadded></munderover><munder><mrow class=\"MJX-TeXAtom-OP MJX-fixedlimits\"><munder><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œï</mi></mrow></msub><mo>‚èü</mo></munder></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mtext>Reward Model</mtext></mrow></munder><munderover><mo>‚Üí</mo><mpadded width=\"+0.611em\" lspace=\"0.278em\" voffset=\"-.24em\"><mtext>Computes scalar rewards</mtext></mpadded><mpadded width=\"+0.611em\" lspace=\"0.278em\" voffset=\".15em\"></mpadded></munderover></mtd></mtr><mtr><mtd></mtd><mtd><munder><mrow class=\"MJX-TeXAtom-OP MJX-fixedlimits\"><munder><msub><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œà</mi></mrow></msub><mo>‚èü</mo></munder></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mtext>Value Model</mtext></mrow></munder><munderover><mo>‚Üí</mo><mpadded width=\"+0.611em\" lspace=\"0.278em\" voffset=\"-.24em\"><mtext>Computes baselines</mtext></mpadded><mpadded width=\"+0.611em\" lspace=\"0.278em\" voffset=\".15em\"></mpadded></munderover><munder><mrow class=\"MJX-TeXAtom-OP MJX-fixedlimits\"><munder><msub><mi>œÄ</mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>ref</mtext></mrow></msub><mo>‚èü</mo></munder></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mtext>Reference Model</mtext></mrow></munder><munderover><mo>‚Üí</mo><mpadded width=\"+0.611em\" lspace=\"0.278em\" voffset=\"-.24em\"><mtext>KL penalty computation</mtext></mpadded><mpadded width=\"+0.611em\" lspace=\"0.278em\" voffset=\".15em\"></mpadded></munderover><munder><mrow class=\"MJX-TeXAtom-OP MJX-fixedlimits\"><munder><mtext>PPO Optimization Loop</mtext><mo>‚èü</mo></munder></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mtext>Policy update step</mtext></mrow></munder></mtd></mtr></mtable></math></span></span></div>\n<h5 id=\"computational-and-practical-considerations\">Computational and Practical Considerations</h5>\n<ul>\n  <li><strong>Training Scale:</strong>\n    <ul>\n      <li>The RLHF fine-tuning phase typically uses <strong>hundreds of thousands to millions of samples</strong>, requiring large-scale distributed training.</li>\n      <li>Compute cost is dominated by sampling (policy forward passes) and reward scoring.</li>\n    </ul>\n  </li>\n  <li><strong>Stability:</strong>\n    <ul>\n      <li>PPO‚Äôs clipping and KL regularization stabilize updates that would otherwise explode in such large parameter spaces.</li>\n    </ul>\n  </li>\n  <li><strong>Safety and Alignment:</strong>\n    <ul>\n      <li>The reward model embeds alignment objectives (helpfulness, harmlessness, honesty).</li>\n      <li>KL regularization ensures fidelity to the pretrained model‚Äôs linguistic priors.</li>\n    </ul>\n  </li>\n  <li><strong>Continuous Improvement:</strong>\n    <ul>\n      <li>Iterative retraining of reward models using newer policy outputs yields increasingly aligned systems ‚Äî a process sometimes called <em>iterative RLHF</em> or <em>alignment bootstrapping</em> (see <a href=\"https://arxiv.org/abs/1706.03741\">Christiano et al., 2017</a>).</li>\n    </ul>\n  </li>\n</ul>\n<ul>\n      <li>The RLHF fine-tuning phase typically uses <strong>hundreds of thousands to millions of samples</strong>, requiring large-scale distributed training.</li>\n      <li>Compute cost is dominated by sampling (policy forward passes) and reward scoring.</li>\n    </ul>\n<ul>\n      <li>PPO‚Äôs clipping and KL regularization stabilize updates that would otherwise explode in such large parameter spaces.</li>\n    </ul>\n<ul>\n      <li>The reward model embeds alignment objectives (helpfulness, harmlessness, honesty).</li>\n      <li>KL regularization ensures fidelity to the pretrained model‚Äôs linguistic priors.</li>\n    </ul>\n<ul>\n      <li>Iterative retraining of reward models using newer policy outputs yields increasingly aligned systems ‚Äî a process sometimes called <em>iterative RLHF</em> or <em>alignment bootstrapping</em> (see <a href=\"https://arxiv.org/abs/1706.03741\">Christiano et al., 2017</a>).</li>\n    </ul>\n<h5 id=\"comparative-analysis-14\">Comparative Analysis</h5>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Model</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Function</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Training Status</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Data Source</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Typical Size</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Policy (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-403-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6399\" style=\"width: 1.193em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.61em, 1000.96em, 2.562em, -999.997em); top: -2.199em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6400\"><span class=\"msubsup\" id=\"MathJax-Span-6401\"><span style=\"display: inline-block; position: relative; width: 0.955em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.396em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6402\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.063em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -3.807em; left: 0.479em;\"><span class=\"mi\" id=\"MathJax-Span-6403\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.205em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.861em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-403\">\\pi_\\theta</script>)</strong></td>\n<td class=\"tg-tleft-valign-first\">Generates responses; optimized for reward</td>\n<td class=\"tg-tleft-valign-first\">Trainable</td>\n<td class=\"tg-tleft-valign-first\">Prompts, synthetic rollouts</td>\n<td class=\"tg-tleft-valign-second\">7B‚Äì175B</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Reference (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-404-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mtext>ref</mtext></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6404\" style=\"width: 1.67em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.61em, 1001.37em, 2.562em, -999.997em); top: -2.199em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6405\"><span class=\"msubsup\" id=\"MathJax-Span-6406\"><span style=\"display: inline-block; position: relative; width: 1.372em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.396em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6407\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.063em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -3.807em; left: 0.479em;\"><span class=\"mtext\" id=\"MathJax-Span-6408\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">ref</span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.205em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.861em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mtext>ref</mtext></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-404\">\\pi_\\text{ref}</script>)</strong></td>\n<td class=\"tg-tleft-valign-first\">Baseline distribution for KL penalty</td>\n<td class=\"tg-tleft-valign-first\">Frozen</td>\n<td class=\"tg-tleft-valign-first\">Same as SFT model</td>\n<td class=\"tg-tleft-valign-second\">7B‚Äì175B</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Reward (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-405-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6409\" style=\"width: 1.074em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.896em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.61em, 1000.9em, 2.682em, -999.997em); top: -2.199em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6410\"><span class=\"msubsup\" id=\"MathJax-Span-6411\"><span style=\"display: inline-block; position: relative; width: 0.896em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6412\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -3.807em; left: 0.42em;\"><span class=\"mi\" id=\"MathJax-Span-6413\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.205em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>œï</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-405\">r_\\phi</script>)</strong></td>\n<td class=\"tg-tleft-valign-first\">Scores responses based on preferences</td>\n<td class=\"tg-tleft-valign-first\">Frozen</td>\n<td class=\"tg-tleft-valign-first\">Human comparisons</td>\n<td class=\"tg-tleft-valign-second\">1B‚Äì13B</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Value (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-406-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6414\" style=\"width: 1.372em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.372em, 1001.13em, 2.682em, -999.997em); top: -2.199em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6415\"><span class=\"msubsup\" id=\"MathJax-Span-6416\"><span style=\"display: inline-block; position: relative; width: 1.134em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6417\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.063em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -3.807em; left: 0.598em;\"><span class=\"mi\" id=\"MathJax-Span-6418\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œà<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.063em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.205em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œà</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-406\">V_\\psi</script>)</strong></td>\n<td class=\"tg-tleft-valign-first\">Predicts expected reward (critic)</td>\n<td class=\"tg-tleft-valign-first\">Trainable</td>\n<td class=\"tg-tleft-valign-first\">Policy rollouts with rewards</td>\n<td class=\"tg-tleft-valign-second\">1B‚Äì13B</td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Model</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Function</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Training Status</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Data Source</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Typical Size</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Policy (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-403-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mi>&amp;#x03B8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6399\" style=\"width: 1.193em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.955em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.61em, 1000.96em, 2.562em, -999.997em); top: -2.199em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6400\"><span class=\"msubsup\" id=\"MathJax-Span-6401\"><span style=\"display: inline-block; position: relative; width: 0.955em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.396em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6402\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.063em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -3.807em; left: 0.479em;\"><span class=\"mi\" id=\"MathJax-Span-6403\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">Œ∏<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.205em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.861em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mi>Œ∏</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-403\">\\pi_\\theta</script>)</strong></td>\n<td class=\"tg-tleft-valign-first\">Generates responses; optimized for reward</td>\n<td class=\"tg-tleft-valign-first\">Trainable</td>\n<td class=\"tg-tleft-valign-first\">Prompts, synthetic rollouts</td>\n<td class=\"tg-tleft-valign-second\">7B‚Äì175B</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Reference (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-404-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>&amp;#x03C0;</mi><mtext>ref</mtext></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6404\" style=\"width: 1.67em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.372em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.61em, 1001.37em, 2.562em, -999.997em); top: -2.199em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6405\"><span class=\"msubsup\" id=\"MathJax-Span-6406\"><span style=\"display: inline-block; position: relative; width: 1.372em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.396em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6407\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.063em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -3.807em; left: 0.479em;\"><span class=\"mtext\" id=\"MathJax-Span-6408\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">ref</span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.205em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.861em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>œÄ</mi><mtext>ref</mtext></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-404\">\\pi_\\text{ref}</script>)</strong></td>\n<td class=\"tg-tleft-valign-first\">Baseline distribution for KL penalty</td>\n<td class=\"tg-tleft-valign-first\">Frozen</td>\n<td class=\"tg-tleft-valign-first\">Same as SFT model</td>\n<td class=\"tg-tleft-valign-second\">7B‚Äì175B</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Reward (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-405-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>&amp;#x03D5;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6409\" style=\"width: 1.074em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.896em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.61em, 1000.9em, 2.682em, -999.997em); top: -2.199em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6410\"><span class=\"msubsup\" id=\"MathJax-Span-6411\"><span style=\"display: inline-block; position: relative; width: 0.896em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6412\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -3.807em; left: 0.42em;\"><span class=\"mi\" id=\"MathJax-Span-6413\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œï</span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.205em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>œï</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-405\">r_\\phi</script>)</strong></td>\n<td class=\"tg-tleft-valign-first\">Scores responses based on preferences</td>\n<td class=\"tg-tleft-valign-first\">Frozen</td>\n<td class=\"tg-tleft-valign-first\">Human comparisons</td>\n<td class=\"tg-tleft-valign-second\">1B‚Äì13B</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\"><strong>Value (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-406-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>V</mi><mi>&amp;#x03C8;</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6414\" style=\"width: 1.372em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.134em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.372em, 1001.13em, 2.682em, -999.997em); top: -2.199em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6415\"><span class=\"msubsup\" id=\"MathJax-Span-6416\"><span style=\"display: inline-block; position: relative; width: 1.134em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6417\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.063em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -3.807em; left: 0.598em;\"><span class=\"mi\" id=\"MathJax-Span-6418\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œà<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.063em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.205em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>V</mi><mi>œà</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-406\">V_\\psi</script>)</strong></td>\n<td class=\"tg-tleft-valign-first\">Predicts expected reward (critic)</td>\n<td class=\"tg-tleft-valign-first\">Trainable</td>\n<td class=\"tg-tleft-valign-first\">Policy rollouts with rewards</td>\n<td class=\"tg-tleft-valign-second\">1B‚Äì13B</td>\n</tr>\n</tbody>\n</table>\n<ul>\n  <li>\n    <p>In summary, RLHF operationalizes reinforcement learning at massive scale by combining:</p>\n\n    <ul>\n      <li>The <strong>policy</strong> for exploration and response generation,</li>\n      <li>The <strong>reward</strong> for human alignment,</li>\n      <li>The <strong>value</strong> for stability and variance control, and</li>\n      <li>The <strong>reference</strong> for constraint and safety.</li>\n    </ul>\n  </li>\n  <li>\n    <p>This synergy enables LLMs to internalize nuanced human feedback, forming the foundation for systems like <strong>ChatGPT</strong>, <strong>Anthropic‚Äôs Claude</strong>, and <strong>Google‚Äôs Gemini</strong>.</p>\n  </li>\n</ul>\n<p>In summary, RLHF operationalizes reinforcement learning at massive scale by combining:</p>\n<ul>\n      <li>The <strong>policy</strong> for exploration and response generation,</li>\n      <li>The <strong>reward</strong> for human alignment,</li>\n      <li>The <strong>value</strong> for stability and variance control, and</li>\n      <li>The <strong>reference</strong> for constraint and safety.</li>\n    </ul>\n<p>This synergy enables LLMs to internalize nuanced human feedback, forming the foundation for systems like <strong>ChatGPT</strong>, <strong>Anthropic‚Äôs Claude</strong>, and <strong>Google‚Äôs Gemini</strong>.</p>",
    "contentMarkdown": "*   To implement the RLHF pipeline effectively, several models are employed in distinct but interdependent roles. Each contributes to a part of the reward-driven learning loop, from generating responses to evaluating and optimizing them:\n    \n    *   **Policy model**: The main LLM we wish to optimize (parameterized by Œ∏Œ∏\\\\theta). It functions as the environment‚Äôs actor, generating responses, and is fine-tuned via policy optimization techniques (e.g., PPO).\n        \n    *   **Reference model**: A frozen or slowly-updated baseline version of the policy (or a supervised fine-tuned model) used to compute KL or likelihood penalties to ensure the optimized policy does not diverge too far from acceptable behaviours.\n        \n    *   **Value model**: A model that estimates the expected return (value) of a given prompt-response pair or sequence, often used to compute advantage estimates in actor‚Äìcritic style updates.\n        \n    *   **Reward model**: A separate model trained (often via human preference data or comparisons) to map a prompt-response pair (x,y)(x,y)(x,y) to a scalar reward r(x,y)r(x,y)r(x,y). It encapsulates human or designer preferences and drives the optimization of the policy model.\n        \n*   In typical LLM fine-tuning pipelines, the flow is:\n    \n    1.  The **policy model** generates responses.\n    2.  The **reward model** scores them.\n    3.  The **value model** estimates future return or baseline.\n    4.  A **reference model** imposes a divergence penalty or acts as a safe anchor.\n    5.  Using a policy-optimization algorithm (e.g., Proximal Policy Optimization) the policy model is updated to **increase** rewards **while constraining** divergence from the reference.\n*   Refer _Fine-Tuning Language Models with Reward Learning on Policy_ by [Lang et al. (2024)](https://arxiv.org/abs/2403.19279) for a more formal treatment.\n    \n\nTo implement the RLHF pipeline effectively, several models are employed in distinct but interdependent roles. Each contributes to a part of the reward-driven learning loop, from generating responses to evaluating and optimizing them:\n\n*   **Policy model**: The main LLM we wish to optimize (parameterized by Œ∏Œ∏\\\\theta). It functions as the environment‚Äôs actor, generating responses, and is fine-tuned via policy optimization techniques (e.g., PPO).\n    \n*   **Reference model**: A frozen or slowly-updated baseline version of the policy (or a supervised fine-tuned model) used to compute KL or likelihood penalties to ensure the optimized policy does not diverge too far from acceptable behaviours.\n    \n*   **Value model**: A model that estimates the expected return (value) of a given prompt-response pair or sequence, often used to compute advantage estimates in actor‚Äìcritic style updates.\n    \n*   **Reward model**: A separate model trained (often via human preference data or comparisons) to map a prompt-response pair (x,y)(x,y)(x,y) to a scalar reward r(x,y)r(x,y)r(x,y). It encapsulates human or designer preferences and drives the optimization of the policy model.\n    \n\n**Policy model**: The main LLM we wish to optimize (parameterized by Œ∏Œ∏\\\\theta). It functions as the environment‚Äôs actor, generating responses, and is fine-tuned via policy optimization techniques (e.g., PPO).\n\n**Reference model**: A frozen or slowly-updated baseline version of the policy (or a supervised fine-tuned model) used to compute KL or likelihood penalties to ensure the optimized policy does not diverge too far from acceptable behaviours.\n\n**Value model**: A model that estimates the expected return (value) of a given prompt-response pair or sequence, often used to compute advantage estimates in actor‚Äìcritic style updates.\n\n**Reward model**: A separate model trained (often via human preference data or comparisons) to map a prompt-response pair (x,y)(x,y)(x,y) to a scalar reward r(x,y)r(x,y)r(x,y). It encapsulates human or designer preferences and drives the optimization of the policy model.\n\nIn typical LLM fine-tuning pipelines, the flow is:\n\n1.  The **policy model** generates responses.\n2.  The **reward model** scores them.\n3.  The **value model** estimates future return or baseline.\n4.  A **reference model** imposes a divergence penalty or acts as a safe anchor.\n5.  Using a policy-optimization algorithm (e.g., Proximal Policy Optimization) the policy model is updated to **increase** rewards **while constraining** divergence from the reference.\n\nRefer _Fine-Tuning Language Models with Reward Learning on Policy_ by [Lang et al. (2024)](https://arxiv.org/abs/2403.19279) for a more formal treatment.\n\n#### Policy Model\n\n*   The **policy model** in an RLHF‚Äìstyle setup is the LLM that we treat as a policy œÄŒ∏(y‚à£x)œÄŒ∏(y‚à£x)\\\\pi\\_{\\\\theta} (y \\\\mid x), parameterized by Œ∏Œ∏\\\\theta, which given an input prompt xxx produces a response yyy. This section covers its function, typical architecture, training data, and model size considerations.\n*   The policy model is the central actor in the RLHF pipeline: it generates responses to prompts and is updated to align with human preferences. It carries the full representational capacity of a large LLM architecture, is trained in multiple phases (pretraining ‚Üí‚Üí\\\\rightarrow SFT ‚Üí‚Üí\\\\rightarrow RLHF), and must be large enough to enable high-quality responses while still being trainable. Its design must support computing log-probabilities, KL divergences, and synergy with reward/value models.\n\n##### Function\n\n*   The policy model is the **agent** that interacts with the ‚Äúenvironment‚Äù by generating outputs (responses yyy) to prompts xxx.\n*   Its objective is to maximize a **reward signal** r(x,y)r(x,y)r(x,y), subject to constraints or regularization (for example via KL-divergence to a reference policy).\n*   Formally, the objective can be written as:\n    \n    maxŒ∏;ùîºx‚àºDprompt,y‚àºœÄŒ∏(‚ãÖ‚à£x)\\[r(x,y)‚àíŒ≤KL(œÄŒ∏(‚ãÖ‚à£x)‚ÄñœÄref(‚ãÖ‚à£x))\\]maxŒ∏;Ex‚àºDprompt,y‚àºœÄŒ∏(‚ãÖ‚à£x)\\[r(x,y)‚àíŒ≤KL(œÄŒ∏(‚ãÖ‚à£x)‚ÄñœÄref(‚ãÖ‚à£x))\\]\n    \n    \\\\max\\_{\\\\theta}; \\\\mathbb{E}\\_{x\\\\sim D\\_{\\\\rm prompt},y\\\\sim\\\\pi\\_\\\\theta(\\\\cdot\\\\mid x)}\\\\Big\\[r(x,y) - \\\\beta\\\\mathrm{KL}\\\\big(\\\\pi\\_\\\\theta(\\\\cdot\\\\mid x) \\\\Vert \\\\pi\\_{\\\\rm ref}(\\\\cdot\\\\mid x)\\\\big)\\\\Big\\]\n    *   where:\n        \n        *   r(x,y)r(x,y)r(x,y): reward signal from human preference or a learned reward model\n        *   œÄrefœÄref\\\\pi\\_{\\\\rm ref}: reference (often supervised-finetuned) policy\n        *   Œ≤Œ≤\\\\beta: KL regularization coefficient balancing reward maximization and divergence from the reference policy\n*   During training, the policy model generates responses, receives reward model scores or value-model feedback, and is updated (often via algorithms like Proximal Policy Optimization). The policy model thus evolves from a ‚Äúsupervised fine-tuned‚Äù base model into a behaviour-aligned model.\n*   The policy model must balance **helpfulness**, **accuracy**, **safety**, and **alignment** (for example to human preferences). See, for example, the instruct-tuning phase described in [Ouyang et al. (2022)](https://arxiv.org/abs/2203.02155) (‚ÄúTraining language models to follow instructions with human feedback‚Äù).\n\nFormally, the objective can be written as:\n\n*   where:\n    \n    *   r(x,y)r(x,y)r(x,y): reward signal from human preference or a learned reward model\n    *   œÄrefœÄref\\\\pi\\_{\\\\rm ref}: reference (often supervised-finetuned) policy\n    *   Œ≤Œ≤\\\\beta: KL regularization coefficient balancing reward maximization and divergence from the reference policy\n\nwhere:\n\n*   r(x,y)r(x,y)r(x,y): reward signal from human preference or a learned reward model\n*   œÄrefœÄref\\\\pi\\_{\\\\rm ref}: reference (often supervised-finetuned) policy\n*   Œ≤Œ≤\\\\beta: KL regularization coefficient balancing reward maximization and divergence from the reference policy\n\n##### Architecture\n\n*   The policy model is typically a **causal (autoregressive) transformer** with large scale: e.g., dozens of layers, high hidden dimensionality, multi-head self-attention, positional embeddings, etc.\n*   Initially pretrained on massive corpora of text. Then often fine-tuned via supervised fine-tuning (SFT) on instruction‚Äìresponse pairs.\n*   For RLHF, a further head or mechanism may be added or used for value/advantage estimation, but the core remains the transformer.\n*   Recent work sometimes uses **parameter efficient tuning** (e.g., LoRA, adapters) to limit full-model updates during RL optimisation.\n*   The architecture must support sampling from œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta, computing log-probabilities logœÄŒ∏(y‚à£x)log‚Å°œÄŒ∏(y‚à£x)\\\\log \\\\pi\\_{\\\\theta} (y \\\\mid x), and computing KL divergence between œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta and œÄrefœÄref\\\\pi\\_{\\\\rm ref}.\n*   For instance, _Fine-Tuning Language Models with Reward Learning on Policy_ by [Lang et al. (2024)](https://arxiv.org/abs/2403.19279) explores how the policy model interacts with a reward model under RLHF.\n\n##### Training Data\n\n*   **Pretraining**: The policy model is first trained on large unlabeled text corpora (e.g., hundreds of billions to trillions of tokens).\n*   **Supervised Fine-Tuning (SFT)**: Instruction‚Äìresponse pairs collected from humans or human-augmented data; e.g., prompts with ‚Äúgood‚Äù responses. Many alignment pipelines begin with this stage to provide a reasonable starting policy.\n*   **RL Finetuning**: The model generates responses to prompts; responses are scored (via reward model or human ranking). This prompt‚Äìresponse‚Äìreward dataset is used in the reinforcement signal. Because the distribution of responses changes as œÄŒ∏œÄŒ∏\\\\pi\\_{\\\\theta} updates, continuing to sample from updated policy is important.\n*   **Replay / Off-Policy Data**: Some pipelines incorporate past responses and reward scores into replay buffers or datasets for stability and reuse.\n*   Training the policy model via RL typically uses batches of prompt‚Äìresponse pairs, plus log-probabilities of responses under both œÄŒ∏œÄŒ∏\\\\pi\\_{\\\\theta} and œÄrefœÄref\\\\pi\\_{\\\\rm ref}, plus the advantage estimate from a value model.\n*   **Note:** Human preference data (for reward model) is often relatively small compared to the pretraining corpus; the RL step amplifies it via policy-generated samples.\n\n##### Typical Model Size\n\n*   The policy model used in RLHF pipelines tends to be **large** (tens of billions of parameters or more) to provide strong language understanding and generation capabilities.\n*   For example, many state-of-the-art systems use models in the 7B‚Äì70B parameter range or larger (100B+).\n*   During SFT and then RLHF, often only the base model (e.g., 20B‚Äì70B) is used, to manage compute cost and stability. For example, the InstructGPT series used the GPT-3 175B model for SFT, then RLHF. (See [Ouyang et al. (2022)](https://arxiv.org/abs/2203.02155)).\n*   In practice, training or fine-tuning such large policy models via RL requires specialized distributed compute, large memory, and careful hyper-parameter tuning.\n\n#### Reference Model\n\n*   The **reference model** (also sometimes called the **anchor model**) is a fixed or slowly updated copy of the policy model used as a _baseline_ or _constraint_ in RLHF and related policy optimization setups for LLMs. Its primary purpose is to ensure that the updated policy model remains **linguistically coherent**, **safe**, and **semantically aligned** with the pre-RL distribution, while still learning to maximize the new reward signal. Put simply, the reference model plays a crucial safety and stability role in RLHF. It anchors the optimization process by maintaining linguistic and factual consistency, ensuring that policy optimization leads to meaningful alignment rather than degenerate exploration.\n\n##### Function\n\n*   The reference model œÄref(y‚à£x)œÄref(y‚à£x)\\\\pi\\_{\\\\text{ref}}(y \\\\mid x) acts as a **stability regulator** during the reinforcement learning phase.\n    *   It appears in the **KL-divergence regularization term** in the RL objective:\n        \n        J(Œ∏)\\=ùîºx,y‚àºœÄŒ∏\\[r(x,y)‚àíŒ≤KL(œÄŒ∏(‚ãÖ‚à£x)‚ÄñœÄref(‚ãÖ‚à£x))\\]J(Œ∏)\\=Ex,y‚àºœÄŒ∏\\[r(x,y)‚àíŒ≤KL(œÄŒ∏(‚ãÖ‚à£x)‚ÄñœÄref(‚ãÖ‚à£x))\\]\n        \n        J(\\\\theta) = \\\\mathbb{E}\\_{x,y \\\\sim \\\\pi\\_\\\\theta} \\\\big\\[ r(x,y) - \\\\beta \\\\mathrm{KL}(\\\\pi\\_\\\\theta(\\\\cdot \\\\mid x) \\\\Vert \\\\pi\\_{\\\\text{ref}}(\\\\cdot \\\\mid x)) \\\\big\\]\n        *   where œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta is the policy model being optimized, and Œ≤Œ≤\\\\beta is a scaling factor.\n    *   The KL term penalizes deviations from the reference model distribution, preventing **mode collapse**, **reward hacking**, or **drift** into incoherent or unfaithful responses.\n        \n*   Conceptually, the reference model anchors the optimization so that:\n    \n    *   The policy model can explore higher-reward regions of response space.\n    *   But does not diverge too far from its pretrained linguistic and factual priors.\n*   In practice, the reference model helps maintain **fluency**, **truthfulness**, and **diversity** of outputs throughout training.\n\n*   It appears in the **KL-divergence regularization term** in the RL objective:\n    \n    J(Œ∏)\\=ùîºx,y‚àºœÄŒ∏\\[r(x,y)‚àíŒ≤KL(œÄŒ∏(‚ãÖ‚à£x)‚ÄñœÄref(‚ãÖ‚à£x))\\]J(Œ∏)\\=Ex,y‚àºœÄŒ∏\\[r(x,y)‚àíŒ≤KL(œÄŒ∏(‚ãÖ‚à£x)‚ÄñœÄref(‚ãÖ‚à£x))\\]\n    \n    J(\\\\theta) = \\\\mathbb{E}\\_{x,y \\\\sim \\\\pi\\_\\\\theta} \\\\big\\[ r(x,y) - \\\\beta \\\\mathrm{KL}(\\\\pi\\_\\\\theta(\\\\cdot \\\\mid x) \\\\Vert \\\\pi\\_{\\\\text{ref}}(\\\\cdot \\\\mid x)) \\\\big\\]\n    *   where œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta is the policy model being optimized, and Œ≤Œ≤\\\\beta is a scaling factor.\n*   The KL term penalizes deviations from the reference model distribution, preventing **mode collapse**, **reward hacking**, or **drift** into incoherent or unfaithful responses.\n    \n\nIt appears in the **KL-divergence regularization term** in the RL objective:\n\n*   where œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta is the policy model being optimized, and Œ≤Œ≤\\\\beta is a scaling factor.\n\nThe KL term penalizes deviations from the reference model distribution, preventing **mode collapse**, **reward hacking**, or **drift** into incoherent or unfaithful responses.\n\nConceptually, the reference model anchors the optimization so that:\n\n*   The policy model can explore higher-reward regions of response space.\n*   But does not diverge too far from its pretrained linguistic and factual priors.\n\n##### Architecture\n\n*   The reference model is architecturally **identical** to the policy model. It is often just a **frozen copy** of the supervised fine-tuned (SFT) model.\n    \n*   Example pipeline:\n    \n    1.  Begin with a pretrained transformer (e.g., GPT-3, LLaMA, or PaLM).\n    2.  Fine-tune it with instruction data ‚Üí‚Üí\\\\rightarrow **SFT model**.\n    3.  Clone the SFT model ‚Üí‚Üí\\\\rightarrow **Reference model (frozen)**.\n    4.  Train another copy ‚Üí‚Üí\\\\rightarrow **Policy model (trainable)** with PPO or another RL optimizer, using the frozen reference for KL regularization.\n*   Since it shares weights and architecture with the policy model, the reference model uses a **causal decoder-only transformer**, typically with the same number of layers, hidden dimensions, and parameters.\n    \n*   The architectural identity ensures that **token-wise probability distributions** are directly comparable, allowing exact computation of KL(œÄŒ∏(‚ãÖ‚à£x)‚ÄñœÄref(‚ãÖ‚à£x))\\=‚àëyœÄŒ∏(y‚à£x)logœÄŒ∏(y‚à£x)œÄref(y‚à£x).KL(œÄŒ∏(‚ãÖ‚à£x)‚ÄñœÄref(‚ãÖ‚à£x))\\=‚àëyœÄŒ∏(y‚à£x)log‚Å°œÄŒ∏(y‚à£x)œÄref(y‚à£x).\\\\mathrm{KL}(\\\\pi\\_\\\\theta(\\\\cdot \\\\mid x) \\\\Vert \\\\pi\\_{\\\\text{ref}}(\\\\cdot \\\\mid x)) = \\\\sum\\_y \\\\pi\\_\\\\theta(y \\\\mid x) \\\\log\\\\frac{\\\\pi\\_\\\\theta(y \\\\mid x)}{\\\\pi\\_{\\\\text{ref}}(y \\\\mid x)}.\n    \n*   Some implementations (e.g., [Stiennon et al., 2020](https://arxiv.org/abs/2009.01325), ‚ÄúLearning to summarize with human feedback‚Äù) experimented with slowly updating the reference model, but most production pipelines freeze it entirely.\n    \n\nThe reference model is architecturally **identical** to the policy model. It is often just a **frozen copy** of the supervised fine-tuned (SFT) model.\n\nExample pipeline:\n\n1.  Begin with a pretrained transformer (e.g., GPT-3, LLaMA, or PaLM).\n2.  Fine-tune it with instruction data ‚Üí‚Üí\\\\rightarrow **SFT model**.\n3.  Clone the SFT model ‚Üí‚Üí\\\\rightarrow **Reference model (frozen)**.\n4.  Train another copy ‚Üí‚Üí\\\\rightarrow **Policy model (trainable)** with PPO or another RL optimizer, using the frozen reference for KL regularization.\n\nSince it shares weights and architecture with the policy model, the reference model uses a **causal decoder-only transformer**, typically with the same number of layers, hidden dimensions, and parameters.\n\nThe architectural identity ensures that **token-wise probability distributions** are directly comparable, allowing exact computation of KL(œÄŒ∏(‚ãÖ‚à£x)‚ÄñœÄref(‚ãÖ‚à£x))\\=‚àëyœÄŒ∏(y‚à£x)logœÄŒ∏(y‚à£x)œÄref(y‚à£x).KL(œÄŒ∏(‚ãÖ‚à£x)‚ÄñœÄref(‚ãÖ‚à£x))\\=‚àëyœÄŒ∏(y‚à£x)log‚Å°œÄŒ∏(y‚à£x)œÄref(y‚à£x).\\\\mathrm{KL}(\\\\pi\\_\\\\theta(\\\\cdot \\\\mid x) \\\\Vert \\\\pi\\_{\\\\text{ref}}(\\\\cdot \\\\mid x)) = \\\\sum\\_y \\\\pi\\_\\\\theta(y \\\\mid x) \\\\log\\\\frac{\\\\pi\\_\\\\theta(y \\\\mid x)}{\\\\pi\\_{\\\\text{ref}}(y \\\\mid x)}.\n\nSome implementations (e.g., [Stiennon et al., 2020](https://arxiv.org/abs/2009.01325), ‚ÄúLearning to summarize with human feedback‚Äù) experimented with slowly updating the reference model, but most production pipelines freeze it entirely.\n\n##### Training Data\n\n*   The reference model is not trained during the RL stage. Instead, it is a **snapshot** of the model before RLHF fine-tuning.\n    \n*   It is trained in the **supervised fine-tuning (SFT)** phase using instruction-following data such as:\n    \n    *   Prompt‚Äìresponse pairs written or rated by humans.\n    *   Curated high-quality datasets covering Q&A, summarization, code generation, reasoning, and dialog.\n*   The SFT dataset is usually **smaller** and more human-curated than pretraining data‚Äîranging from a few thousand to a few hundred thousand high-quality examples.\n    \n*   By preserving this SFT policy, the reference model embodies the **linguistic priors** and **alignment baseline** learned from human demonstrations before introducing reinforcement signals.\n    \n\nThe reference model is not trained during the RL stage. Instead, it is a **snapshot** of the model before RLHF fine-tuning.\n\nIt is trained in the **supervised fine-tuning (SFT)** phase using instruction-following data such as:\n\n*   Prompt‚Äìresponse pairs written or rated by humans.\n*   Curated high-quality datasets covering Q&A, summarization, code generation, reasoning, and dialog.\n\nThe SFT dataset is usually **smaller** and more human-curated than pretraining data‚Äîranging from a few thousand to a few hundred thousand high-quality examples.\n\nBy preserving this SFT policy, the reference model embodies the **linguistic priors** and **alignment baseline** learned from human demonstrations before introducing reinforcement signals.\n\n##### Typical Model Size\n\n*   The reference model must match the policy model in architecture and vocabulary to make KL computation meaningful. Therefore, it has the **same parameter count** as the policy model‚Äîcommonly in the range of:\n    \n    *   **7B‚Äì70B parameters** for research-grade or open-source systems (e.g., LLaMA-2, Falcon, Mistral RLHF variants).\n    *   **175B‚Äì500B+ parameters** for frontier models (e.g., GPT-3 or GPT-4 scale).\n*   Because the reference model is frozen, its storage and compute requirements are primarily for **forward passes** during KL evaluation rather than gradient updates.\n*   In distributed training pipelines (e.g., [Ouyang et al., 2022](https://arxiv.org/abs/2203.02155)), both the policy and reference models are sharded across GPUs but only the policy model receives gradient updates.\n\nThe reference model must match the policy model in architecture and vocabulary to make KL computation meaningful. Therefore, it has the **same parameter count** as the policy model‚Äîcommonly in the range of:\n\n*   **7B‚Äì70B parameters** for research-grade or open-source systems (e.g., LLaMA-2, Falcon, Mistral RLHF variants).\n*   **175B‚Äì500B+ parameters** for frontier models (e.g., GPT-3 or GPT-4 scale).\n\n##### Comparative Analysis\n\n**Aspect**\n\n**Description**\n\n**Role**\n\nBaseline distribution constraining RL updates\n\n**Function**\n\nProvides KL regularization to prevent policy drift\n\n**Architecture**\n\nIdentical to policy (decoder-only transformer)\n\n**Training Data**\n\nSFT instruction data (high-quality human responses)\n\n**Model Size**\n\nSame as policy; typically 7B‚Äì175B parameters\n\n**Status During RL**\n\nFrozen (no updates)\n\n**Aspect**\n\n**Description**\n\n**Role**\n\nBaseline distribution constraining RL updates\n\n**Function**\n\nProvides KL regularization to prevent policy drift\n\n**Architecture**\n\nIdentical to policy (decoder-only transformer)\n\n**Training Data**\n\nSFT instruction data (high-quality human responses)\n\n**Model Size**\n\nSame as policy; typically 7B‚Äì175B parameters\n\n**Status During RL**\n\nFrozen (no updates)\n\n#### Reward Model\n\n*   The **reward model (RM)** is one of the most crucial components in the RLHF pipeline.\n*   It provides the **scalar feedback signal** r(x,y)r(x,y)r(x, y) that quantifies the quality of a model‚Äôs response yyy to a prompt xxx, translating human preferences into a form usable by reinforcement learning algorithms.\n*   In modern LLM alignment, the reward model serves as the **surrogate objective** for human satisfaction, steering the policy model toward behaviors that humans find helpful, truthful, and safe.\n*   The reward model provides the **human-aligned feedback mechanism** that guides reinforcement learning updates. It bridges subjective human judgment and quantitative optimization, serving as the anchor for policy alignment and safety in LLM fine-tuning.\n\n##### Function\n\n*   The reward model approximates a **latent human preference function**. Given a prompt xxx and a response yyy, the model outputs a scalar value r(x,y)r(x,y)r(x,y) representing how much a human would prefer that response.\n    \n*   Its primary role is to act as a **critic** that scores generated text, so that the **policy model** can be optimized to produce higher-reward responses.\n    \n*   Formally, the goal is to learn a function rœï(x,y)‚âàExpected human preference score(x,y)rœï(x,y)‚âàExpected human preference score(x,y)r\\_\\\\phi(x,y) \\\\approx \\\\text{Expected human preference score}(x,y), parameterized by œïœï\\\\phi.\n    \n*   The reward model is trained using **human preference data** collected as pairwise or ranked comparisons. The reward modeling methodology ‚Äî from ranking-based supervision and cross-entropy loss to normalization ‚Äî originates from [Learning to Summarize from Human Feedback](https://arxiv.org/abs/2009.01325) by Stiennon et al. (2020) and was directly integrated into [Training Language Models to Follow instructions with Human Feedback](https://arxiv.org/abs/2203.02155) (InstructGPT) by Ouyang et al. (2022), forming the standard foundation of modern RLHF systems.\n    \n*   The image below [(source)](https://huggingface.co/blog/rlhf) illustrates how a reward model functions:\n    \n\nThe reward model approximates a **latent human preference function**. Given a prompt xxx and a response yyy, the model outputs a scalar value r(x,y)r(x,y)r(x,y) representing how much a human would prefer that response.\n\nIts primary role is to act as a **critic** that scores generated text, so that the **policy model** can be optimized to produce higher-reward responses.\n\nFormally, the goal is to learn a function rœï(x,y)‚âàExpected human preference score(x,y)rœï(x,y)‚âàExpected human preference score(x,y)r\\_\\\\phi(x,y) \\\\approx \\\\text{Expected human preference score}(x,y), parameterized by œïœï\\\\phi.\n\nThe reward model is trained using **human preference data** collected as pairwise or ranked comparisons. The reward modeling methodology ‚Äî from ranking-based supervision and cross-entropy loss to normalization ‚Äî originates from [Learning to Summarize from Human Feedback](https://arxiv.org/abs/2009.01325) by Stiennon et al. (2020) and was directly integrated into [Training Language Models to Follow instructions with Human Feedback](https://arxiv.org/abs/2203.02155) (InstructGPT) by Ouyang et al. (2022), forming the standard foundation of modern RLHF systems.\n\nThe image below [(source)](https://huggingface.co/blog/rlhf) illustrates how a reward model functions:\n\n![](/primers/ai/assets/rlhf/6.png)\n\n*   In [Stiennon et al. (2020)](https://arxiv.org/abs/2009.01325), the RM was trained on a dataset of **comparisons between two model outputs** on the same input. They used a cross-entropy loss, with the comparisons as labels‚Äîthe difference in rewards represents the log odds that one response will be preferred to the other by a human labeler. This approach was later adopted and extended in [Ouyang et al. (2022)](https://arxiv.org/abs/2203.02155), which used this same reward model formulation as the basis of their RLHF training pipeline, with the following changes to sample creation and batching strategy:\n    \n    *   In order to **speed up comparison collection** (i.e., reduce labeling effort per prompt by ranking multiple responses at once), each labeler is presented with anywhere between K\\=4K\\=4K = 4 and K\\=9K\\=9K = 9 responses to rank ‚Äî larger KKK values mean more comparisons per labeling task and richer training signal. This ranking procedure automatically generates up to K2K2K^2 pairwise comparisons per prompt (since every possible pair of completions produces one ‚Äúwin/loss‚Äù label).\n    *   However, because these K2K2K^2 comparisons are **highly correlated** within the same labeling task, simply shuffling and treating each pair as an independent datapoint led to severe **overfitting** ‚Äî the reward model quickly memorized specific completions and degraded generalization.\n    *   Specifically, if each of the K2K2K^2 comparisons is treated separately, then each completion may appear in K‚àí1K‚àí1K-1 distinct pairs, resulting in multiple redundant gradient updates per sample. The authors observed that under this setup, the model **overfit within a single epoch**, and even reusing the data within an epoch caused further overfitting.\n    *   To mitigate this, they changed the training approach to treat **all K2K2K^2 comparisons for a given prompt as a single batch element**. This ensures that every completion is processed only once per batch while still contributing to all necessary pairwise comparisons. This modification was both **computationally efficient**‚Äîrequiring only one forward pass of the reward model per completion instead of K2K2K^2‚Äîand **empirically superior**, yielding much improved **validation accuracy and log loss**. This batching strategy adopted by [Ouyang et al. (2022)](https://arxiv.org/abs/2203.02155) became a standard approach, forming a key component of modern RLHF reward model training.\n\nIn [Stiennon et al. (2020)](https://arxiv.org/abs/2009.01325), the RM was trained on a dataset of **comparisons between two model outputs** on the same input. They used a cross-entropy loss, with the comparisons as labels‚Äîthe difference in rewards represents the log odds that one response will be preferred to the other by a human labeler. This approach was later adopted and extended in [Ouyang et al. (2022)](https://arxiv.org/abs/2203.02155), which used this same reward model formulation as the basis of their RLHF training pipeline, with the following changes to sample creation and batching strategy:\n\n*   In order to **speed up comparison collection** (i.e., reduce labeling effort per prompt by ranking multiple responses at once), each labeler is presented with anywhere between K\\=4K\\=4K = 4 and K\\=9K\\=9K = 9 responses to rank ‚Äî larger KKK values mean more comparisons per labeling task and richer training signal. This ranking procedure automatically generates up to K2K2K^2 pairwise comparisons per prompt (since every possible pair of completions produces one ‚Äúwin/loss‚Äù label).\n*   However, because these K2K2K^2 comparisons are **highly correlated** within the same labeling task, simply shuffling and treating each pair as an independent datapoint led to severe **overfitting** ‚Äî the reward model quickly memorized specific completions and degraded generalization.\n*   Specifically, if each of the K2K2K^2 comparisons is treated separately, then each completion may appear in K‚àí1K‚àí1K-1 distinct pairs, resulting in multiple redundant gradient updates per sample. The authors observed that under this setup, the model **overfit within a single epoch**, and even reusing the data within an epoch caused further overfitting.\n*   To mitigate this, they changed the training approach to treat **all K2K2K^2 comparisons for a given prompt as a single batch element**. This ensures that every completion is processed only once per batch while still contributing to all necessary pairwise comparisons. This modification was both **computationally efficient**‚Äîrequiring only one forward pass of the reward model per completion instead of K2K2K^2‚Äîand **empirically superior**, yielding much improved **validation accuracy and log loss**. This batching strategy adopted by [Ouyang et al. (2022)](https://arxiv.org/abs/2203.02155) became a standard approach, forming a key component of modern RLHF reward model training.\n\n##### Architecture\n\n*   The reward model is typically a model derived from the same family as the policy model, sharing the same backbone architecture but differing in its **output head** and **training objective**. While some early or alternative setups explored encoder-based reward models, the canonical and most widely adopted approach‚Äîused in [InstructGPT](https://arxiv.org/abs/2203.02155) by Ouyang et al. (2022) and all modern large-scale RLHF pipelines‚Äîis **decoder-only**, consistent with the architecture of the policy (causal language) model. Architecturally, it‚Äôs identical to the policy model but with a **scalar regression head** added on top of the final hidden state.\n    *   In [_Training language models to follow instructions with human feedback_](https://arxiv.org/abs/2203.02155) by Ouyang et al. (2022), the reward model is based on the **GPT-3 architecture** (**specifically the 6B parameter variant**), a **decoder-only transformer** trained autoregressively. Per the paper, the RM is **initialized from the supervised fine-tuned (SFT) model**, with the **final unembedding layer removed and replaced by a new linear head** that outputs a single real-valued reward for a given prompt‚Äìcompletion pair. This added linear layer is a regression head that maps the final hidden representation to a scalar value representing the model‚Äôs predicted human preference score. Put simply, the reward model is thus architecturally identical to the base language model, except for the replacement of the next-token prediction head with a **linear head** applied to the final hidden state that outputs a scalar value.\n*   Mathematically speaking, the final token‚Äôs hidden representation hThTh\\_T (or an average over all tokens) is passed through a linear projection to output rœï(x,y)rœï(x,y)r\\_\\\\phi(x,y) a **single scalar reward** representing the model‚Äôs predicted human preference for the given prompt‚Äìcompletion pair.\n    \n    rœï(x,y)\\=w‚ä§hT+brœï(x,y)\\=w‚ä§hT+b\n    \n    r\\_\\\\phi(x,y) = w^\\\\top h\\_T + b\n    *   where w,bw,bw,b are learned parameters.\n*   The model therefore learns to encode text sequences and output a **single continuous reward value**, capturing human preference judgments.\n    \n*   In practice:\n    \n    *   The scalar head is lightweight (a single dense linear layer).\n    *   The underlying transformer backbone (6B parameters in InstructGPT) is initialized from the SFT model, preserving its linguistic and contextual knowledge.\n    *   During RM training, only the new scalar head and a subset of backbone parameters may be fine-tuned for efficiency and stability.\n*   Several architectural variants are used for reward modeling, including:\n    \n    1.  **LM Classifiers**: Language models fine-tuned as binary classifiers to score which response better aligns with human preferences.\n    2.  **Value Networks**: Regression models that predict scalar ratings representing relative human preference.\n    3.  **Critique Generators**: Language models trained to generate evaluative critiques explaining which response is better and why, used in conjunction with instruction tuning.\n\n*   In [_Training language models to follow instructions with human feedback_](https://arxiv.org/abs/2203.02155) by Ouyang et al. (2022), the reward model is based on the **GPT-3 architecture** (**specifically the 6B parameter variant**), a **decoder-only transformer** trained autoregressively. Per the paper, the RM is **initialized from the supervised fine-tuned (SFT) model**, with the **final unembedding layer removed and replaced by a new linear head** that outputs a single real-valued reward for a given prompt‚Äìcompletion pair. This added linear layer is a regression head that maps the final hidden representation to a scalar value representing the model‚Äôs predicted human preference score. Put simply, the reward model is thus architecturally identical to the base language model, except for the replacement of the next-token prediction head with a **linear head** applied to the final hidden state that outputs a scalar value.\n\nMathematically speaking, the final token‚Äôs hidden representation hThTh\\_T (or an average over all tokens) is passed through a linear projection to output rœï(x,y)rœï(x,y)r\\_\\\\phi(x,y) a **single scalar reward** representing the model‚Äôs predicted human preference for the given prompt‚Äìcompletion pair.\n\n*   where w,bw,bw,b are learned parameters.\n\nThe model therefore learns to encode text sequences and output a **single continuous reward value**, capturing human preference judgments.\n\nIn practice:\n\n*   The scalar head is lightweight (a single dense linear layer).\n*   The underlying transformer backbone (6B parameters in InstructGPT) is initialized from the SFT model, preserving its linguistic and contextual knowledge.\n*   During RM training, only the new scalar head and a subset of backbone parameters may be fine-tuned for efficiency and stability.\n\nSeveral architectural variants are used for reward modeling, including:\n\n1.  **LM Classifiers**: Language models fine-tuned as binary classifiers to score which response better aligns with human preferences.\n2.  **Value Networks**: Regression models that predict scalar ratings representing relative human preference.\n3.  **Critique Generators**: Language models trained to generate evaluative critiques explaining which response is better and why, used in conjunction with instruction tuning.\n\n##### Training Objective\n\n###### Background: Bradley-Terry Model\n\n*   The reward model is trained using ranked comparison data and assigns a scalar score to model-generated responses. A common formulation of the pairwise loss uses the **Bradley-Terry model**, where the probability that a rater prefers response ririr\\_i over rjrjr\\_j is:\n    \n    P(ri\\>rj)\\=exp(rœï(p,ri))exp(rœï(p,ri))+exp(rœï(p,rj))P(ri\\>rj)\\=exp‚Å°(rœï(p,ri))exp‚Å°(rœï(p,ri))+exp‚Å°(rœï(p,rj))\n    \n    P(r\\_i > r\\_j) = \\\\frac{\\\\exp(r\\_\\\\phi(p, r\\_i))}{\\\\exp(r\\_\\\\phi(p, r\\_i)) + \\\\exp(r\\_\\\\phi(p, r\\_j))}\n*   The corresponding loss function is:\n    \n    Óà∏(œï)\\=‚àílogœÉ(rœï(p,ri)‚àírœï(p,rj))L(œï)\\=‚àílog‚Å°œÉ(rœï(p,ri)‚àírœï(p,rj))\n    \n    \\\\mathcal{L}(\\\\phi) = -\\\\log \\\\sigma(r\\_\\\\phi(p, r\\_i) - r\\_\\\\phi(p, r\\_j))\n    *   where:\n        \n        *   œÉœÉ\\\\sigma is the sigmoid function,\n        *   rœïrœïr\\_\\\\phi is the reward model,\n        *   ppp is the prompt,\n        *   ri,rjri,rjr\\_i, r\\_j are two responses being compared.\n*   This formulation ensures that the reward model learns to assign higher scores to responses more preferred by humans. A **key implementation detail**: the reward for **partial responses** is always 0; only **complete** responses receive a non-zero scalar score. This design encourages the generation of coherent and full outputs during policy training.\n    \n\nThe reward model is trained using ranked comparison data and assigns a scalar score to model-generated responses. A common formulation of the pairwise loss uses the **Bradley-Terry model**, where the probability that a rater prefers response ririr\\_i over rjrjr\\_j is:\n\nThe corresponding loss function is:\n\n*   where:\n    \n    *   œÉœÉ\\\\sigma is the sigmoid function,\n    *   rœïrœïr\\_\\\\phi is the reward model,\n    *   ppp is the prompt,\n    *   ri,rjri,rjr\\_i, r\\_j are two responses being compared.\n\nwhere:\n\n*   œÉœÉ\\\\sigma is the sigmoid function,\n*   rœïrœïr\\_\\\\phi is the reward model,\n*   ppp is the prompt,\n*   ri,rjri,rjr\\_i, r\\_j are two responses being compared.\n\nThis formulation ensures that the reward model learns to assign higher scores to responses more preferred by humans. A **key implementation detail**: the reward for **partial responses** is always 0; only **complete** responses receive a non-zero scalar score. This design encourages the generation of coherent and full outputs during policy training.\n\n###### InstructGPT‚Äôs Pairwise Cross-entropy Ranking Loss\n\n*   [Ouyang et al. (2022)](https://arxiv.org/abs/2203.02155)‚Äôs offers a practical implementation of this formulation, the reward model is trained using a **pairwise cross-entropy ranking loss**, because it directly models the probability that one completion is preferred over another using a sigmoid over the reward difference, and optimizes this probability via a cross-entropy objective:\n    \n    Óà∏RM(Œ∏)\\=‚àí1(K2)ùîº(x,yw,yl)‚àºD\\[logœÉ(rŒ∏(x,yw)‚àírŒ∏(x,yl))\\]LRM(Œ∏)\\=‚àí1(K2)E(x,yw,yl)‚àºD\\[log‚Å°œÉ(rŒ∏(x,yw)‚àírŒ∏(x,yl))\\]\n    \n    \\\\mathcal{L}\\_{\\\\text{RM}}(\\\\theta) = -\\\\frac{1}{\\\\binom{K}{2}} \\\\mathbb{E}\\_{(x, y\\_w, y\\_l) \\\\sim D} \\\\Big\\[\\\\log \\\\sigma\\\\big(r\\_\\\\theta(x,y\\_w) - r\\_\\\\theta(x,y\\_l)\\\\big)\\\\Big\\]\n    *   where:\n        \n        *   ywywy\\_w is the **preferred** completion,\n        *   ylyly\\_l is the **dispreferred** (or losing) completion,\n        *   œÉœÉ\\\\sigma is the sigmoid function mapping the score difference to a probability of preference,\n        *   rŒ∏(x,y)rŒ∏(x,y)r\\_\\\\theta(x, y) is the reward model‚Äôs scalar output.\n        *   The **difference** rŒ∏(x,yw)‚àírŒ∏(x,yl)rŒ∏(x,yw)‚àírŒ∏(x,yl)r\\_\\\\theta(x,y\\_w) - r\\_\\\\theta(x,y\\_l) represents the **log odds** that a human would prefer ywywy\\_w over ylyly\\_l.\n*   **Normalization and Practical Notes**:\n    \n    *   Since the reward model‚Äôs loss is **invariant to additive shifts** in reward, it is normalized by adding a bias term so that **labeler demonstrations have mean score 0** before PPO training begins.\n    *   This ensures that the scale and offset of rewards remain consistent across updates, stabilizing policy learning.\n\n[Ouyang et al. (2022)](https://arxiv.org/abs/2203.02155)‚Äôs offers a practical implementation of this formulation, the reward model is trained using a **pairwise cross-entropy ranking loss**, because it directly models the probability that one completion is preferred over another using a sigmoid over the reward difference, and optimizes this probability via a cross-entropy objective:\n\n*   where:\n    \n    *   ywywy\\_w is the **preferred** completion,\n    *   ylyly\\_l is the **dispreferred** (or losing) completion,\n    *   œÉœÉ\\\\sigma is the sigmoid function mapping the score difference to a probability of preference,\n    *   rŒ∏(x,y)rŒ∏(x,y)r\\_\\\\theta(x, y) is the reward model‚Äôs scalar output.\n    *   The **difference** rŒ∏(x,yw)‚àírŒ∏(x,yl)rŒ∏(x,yw)‚àírŒ∏(x,yl)r\\_\\\\theta(x,y\\_w) - r\\_\\\\theta(x,y\\_l) represents the **log odds** that a human would prefer ywywy\\_w over ylyly\\_l.\n\nwhere:\n\n*   ywywy\\_w is the **preferred** completion,\n*   ylyly\\_l is the **dispreferred** (or losing) completion,\n*   œÉœÉ\\\\sigma is the sigmoid function mapping the score difference to a probability of preference,\n*   rŒ∏(x,y)rŒ∏(x,y)r\\_\\\\theta(x, y) is the reward model‚Äôs scalar output.\n*   The **difference** rŒ∏(x,yw)‚àírŒ∏(x,yl)rŒ∏(x,yw)‚àírŒ∏(x,yl)r\\_\\\\theta(x,y\\_w) - r\\_\\\\theta(x,y\\_l) represents the **log odds** that a human would prefer ywywy\\_w over ylyly\\_l.\n\n**Normalization and Practical Notes**:\n\n*   Since the reward model‚Äôs loss is **invariant to additive shifts** in reward, it is normalized by adding a bias term so that **labeler demonstrations have mean score 0** before PPO training begins.\n*   This ensures that the scale and offset of rewards remain consistent across updates, stabilizing policy learning.\n\n##### Training Data\n\n*   The training data for reward models comes from **human preference labeling**:\n    \n    *   A set of prompts xxx is sampled (often from SFT datasets or model-generated prompts).\n    *   Multiple responses are generated by one or more models.\n    *   Human annotators rank or choose preferred responses based on **helpfulness**, **accuracy**, **harmlessness**, or **style** criteria.\n*   The collected comparisons yield tuples (x,yw,yl)(x,yw,yl)(x, y\\_w, y\\_l), forming the basis for pairwise training.\n    \n*   Datasets of this form can range from **50,000 to several million comparisons**, depending on the scale of the deployment. For example:\n    \n    *   The **InstructGPT** reward model used approximately **30,000‚Äì40,000 labeled comparisons**.\n    *   Larger RLHF systems (e.g., Anthropic‚Äôs Constitutional AI) use **100K‚Äì1M+** pairs.\n    *   Recent work such as **RLHF on LLaMA 2** and **OpenAI‚Äôs GPT-4-turbo alignment** use data from extensive human evaluation and preference modeling pipelines.\n*   **Synthetic preference data** (generated using smaller models or heuristics) is also increasingly used to supplement limited human data, as in Self-Instruct by [Wang et al. (2022)](https://arxiv.org/abs/2212.10560).\n    \n\nThe training data for reward models comes from **human preference labeling**:\n\n*   A set of prompts xxx is sampled (often from SFT datasets or model-generated prompts).\n*   Multiple responses are generated by one or more models.\n*   Human annotators rank or choose preferred responses based on **helpfulness**, **accuracy**, **harmlessness**, or **style** criteria.\n\nThe collected comparisons yield tuples (x,yw,yl)(x,yw,yl)(x, y\\_w, y\\_l), forming the basis for pairwise training.\n\nDatasets of this form can range from **50,000 to several million comparisons**, depending on the scale of the deployment. For example:\n\n*   The **InstructGPT** reward model used approximately **30,000‚Äì40,000 labeled comparisons**.\n*   Larger RLHF systems (e.g., Anthropic‚Äôs Constitutional AI) use **100K‚Äì1M+** pairs.\n*   Recent work such as **RLHF on LLaMA 2** and **OpenAI‚Äôs GPT-4-turbo alignment** use data from extensive human evaluation and preference modeling pipelines.\n\n**Synthetic preference data** (generated using smaller models or heuristics) is also increasingly used to supplement limited human data, as in Self-Instruct by [Wang et al. (2022)](https://arxiv.org/abs/2212.10560).\n\n##### Model Size\n\n*   The reward model is usually **smaller** than the policy model (especially since it doesn‚Äôt have to incorporate the unembedding layers), since it only provides scalar evaluations and doesn‚Äôt need to generate text.\n    \n    *   Common sizes range from **1B to 13B parameters** for large-scale pipelines.\n    *   For example:\n        *   InstructGPT used reward models of **6B parameters**, while the policy model was 175B.\n        *   Open-source LLaMA 2‚ÄìChat models used reward models of **7B‚Äì13B parameters**.\n    *   Compact reward models are often used to reduce the cost of reward evaluation during RLHF training (since thousands of responses must be scored per update).\n*   Some recent methods, such as **Direct Preference Optimization (DPO)** by [Rafailov et al. (2023)](https://arxiv.org/abs/2305.18290), avoid training a separate reward model altogether, instead **implicitizing** it through log-probability ratios between the policy and reference models.\n    \n\nThe reward model is usually **smaller** than the policy model (especially since it doesn‚Äôt have to incorporate the unembedding layers), since it only provides scalar evaluations and doesn‚Äôt need to generate text.\n\n*   Common sizes range from **1B to 13B parameters** for large-scale pipelines.\n*   For example:\n    *   InstructGPT used reward models of **6B parameters**, while the policy model was 175B.\n    *   Open-source LLaMA 2‚ÄìChat models used reward models of **7B‚Äì13B parameters**.\n*   Compact reward models are often used to reduce the cost of reward evaluation during RLHF training (since thousands of responses must be scored per update).\n\n*   InstructGPT used reward models of **6B parameters**, while the policy model was 175B.\n*   Open-source LLaMA 2‚ÄìChat models used reward models of **7B‚Äì13B parameters**.\n\nSome recent methods, such as **Direct Preference Optimization (DPO)** by [Rafailov et al. (2023)](https://arxiv.org/abs/2305.18290), avoid training a separate reward model altogether, instead **implicitizing** it through log-probability ratios between the policy and reference models.\n\n##### Prevention of Over-optimization\n\n*   To prevent the fine-tuned model from overfitting or drifting too far from its pretrained distribution, **KL divergence penalties** are applied during RL:\n    \n    *   KL divergence measures the difference between the output distributions of the current policy and the original (pretrained) model.\n    *   This constraint regularizes learning and **ensures that the fine-tuned model does not deviate excessively**, preserving safety and coherence.\n*   This KL penalty is crucial for maintaining a balance between alignment and generalization.\n    \n\nTo prevent the fine-tuned model from overfitting or drifting too far from its pretrained distribution, **KL divergence penalties** are applied during RL:\n\n*   KL divergence measures the difference between the output distributions of the current policy and the original (pretrained) model.\n*   This constraint regularizes learning and **ensures that the fine-tuned model does not deviate excessively**, preserving safety and coherence.\n\nThis KL penalty is crucial for maintaining a balance between alignment and generalization.\n\n##### Evaluation and Monitoring\n\n*   Reward models are evaluated on **held-out preference sets** using accuracy metrics‚Äîhow often the model correctly predicts the human-preferred response.\n*   Typical accuracy benchmarks range between **65‚Äì80%**, depending on domain and data quality.\n*   Regular retraining and drift monitoring are essential, since the distribution of policy outputs changes as the policy improves.\n\n##### Comparative Analysis\n\n**Aspect**\n\n**Description**\n\n**Role**\n\nTranslates human preference into scalar rewards\n\n**Training Objective**\n\nPairwise ranking loss on human preference data\n\n**Architecture**\n\nTransformer with scalar reward head\n\n**Data**\n\nHuman-ranked prompt‚Äìresponse pairs (tens of thousands to millions)\n\n**Model Size**\n\nTypically 1B‚Äì13B parameters\n\n**Reference Papers**\n\n[Ouyang et al., 2022](https://arxiv.org/abs/2203.02155); [Rafailov et al., 2023](https://arxiv.org/abs/2305.18290)\n\n**Aspect**\n\n**Description**\n\n**Role**\n\nTranslates human preference into scalar rewards\n\n**Training Objective**\n\nPairwise ranking loss on human preference data\n\n**Architecture**\n\nTransformer with scalar reward head\n\n**Data**\n\nHuman-ranked prompt‚Äìresponse pairs (tens of thousands to millions)\n\n**Model Size**\n\nTypically 1B‚Äì13B parameters\n\n**Reference Papers**\n\n[Ouyang et al., 2022](https://arxiv.org/abs/2203.02155); [Rafailov et al., 2023](https://arxiv.org/abs/2305.18290)\n\n#### Value Model\n\n*   The **value model** (sometimes called the **critic model**) plays a critical but often under-discussed role in LLM reinforcement learning pipelines such as RLHF and RLAIF (Reinforcement Learning from AI Feedback).\n*   While the **reward model** provides _immediate feedback_ for a given response, the **value model** estimates the _expected future reward_ from a state (or state‚Äìprompt pair), enabling **advantage estimation**, **variance reduction**, and **stabilized policy updates**‚Äîconcepts foundational to modern policy-gradient methods like PPO.\n*   In RLHF implementations such as [**InstructGPT**](https://arxiv.org/abs/2203.02155) by Ouyang et al. (2022), a value model (critic) is initialized from the reward model and is used to compute advantages in the PPO update:\n    \n    At\\=rt‚àíV(st)At\\=rt‚àíV(st)\n    \n    A\\_t = r\\_t - V(s\\_t)\n    *   where rtrtr\\_t is the observed reward (from the **reward model**) and V(st)V(st)V(s\\_t) is the **value model‚Äôs** prediction. This follows the standard actor‚Äìcritic formulation in PPO.\n\nIn RLHF implementations such as [**InstructGPT**](https://arxiv.org/abs/2203.02155) by Ouyang et al. (2022), a value model (critic) is initialized from the reward model and is used to compute advantages in the PPO update:\n\n*   where rtrtr\\_t is the observed reward (from the **reward model**) and V(st)V(st)V(s\\_t) is the **value model‚Äôs** prediction. This follows the standard actor‚Äìcritic formulation in PPO.\n\n##### Function\n\n*   In the context of LLM alignment, the value model Vœï(x)Vœï(x)V\\_\\\\phi(x) or Vœï(x,y)Vœï(x,y)V\\_\\\\phi(x, y) predicts the **expected return** (i.e., cumulative reward) for a given prompt xxx or prompt‚Äìresponse pair (x,y)(x,y)(x,y).\n    \n*   It serves the same theoretical role as the **critic** in an actor‚Äìcritic framework, providing a learned baseline that allows the policy (actor) to improve using lower-variance gradient estimates.\n    \n*   The fundamental definition is\n    \n    Vœï(s)‚âàùîºa‚àºœÄŒ∏\\[R(s,a)\\]Vœï(s)‚âàEa‚àºœÄŒ∏\\[R(s,a)\\]\n    \n    V\\_\\\\phi(s) \\\\approx \\\\mathbb{E}\\_{a\\\\sim\\\\pi\\\\theta} \\[R(s,a)\\]\n    *   where R(s,a)R(s,a)R(s,a) is the return or scalar reward obtained when the policy œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta takes action aaa in state sss.\n*   In the language modeling context, the ‚Äústate‚Äù corresponds to the **prompt or prefix** xxx, and the ‚Äúaction‚Äù corresponds to the **generated token sequence** yyy.\n    \n*   The value model enables several key operations:\n    \n    1.  **Advantage estimation:**\n        \n        *   Used to compute a baseline-corrected signal for PPO or similar algorithms:\n        \n        AÃÇ¬†(x,y)\\=r(x,y)‚àíVœï(x)A^(x,y)\\=r(x,y)‚àíVœï(x)\n        \n        \\\\hat{A}(x,y) = r(x,y) - V\\_\\\\phi(x)\n        \n        *   ‚Ä¶ or, at a token-wise level, via temporal-difference (TD) methods:\n        \n        AÃÇ¬†t\\=Œ¥t+(Œ≥Œª)AÃÇ¬†t+1A^t\\=Œ¥t+(Œ≥Œª)A^t+1\n        \n        \\\\hat{A}\\_t = \\\\delta\\_t + (\\\\gamma \\\\lambda)\\\\hat{A}\\_{t+1}\n        \n        *   ‚Ä¶ with:\n        \n        Œ¥t\\=rt+Œ≥Vœï(st+1)‚àíVœï(st)Œ¥t\\=rt+Œ≥Vœï(st+1)‚àíVœï(st)\n        \n        \\\\delta\\_t = r\\_t + \\\\gamma V\\_\\\\phi(s\\_{t+1}) - V\\_\\\\phi(s\\_t)\n        *   In **bandit-style** settings like RLHF (prompt ‚Üí‚Üí\\\\rightarrow response ‚Üí‚Üí\\\\rightarrow single reward), this simplifies to At\\=rt‚àíV(st)At\\=rt‚àíV(st)A\\_t = r\\_t - V(s\\_t), as the episode length is one. The short-horizon ‚Äúbandit‚Äù structure still benefits from the critic, since it stabilizes training and reduces gradient variance.\n    2.  **Variance reduction:**\n        *   By learning a baseline for expected reward, Vœï(s)Vœï(s)V\\_\\\\phi(s) removes state-dependent bias and allows the policy gradient to focus on relative action quality.\n    3.  **Critic-driven generalization:**\n        *   The critic can generalize expected reward patterns across prompts, enabling continual improvement even when human preference labels are unavailable.\n    \n    *   These functions mirror classical actor‚Äìcritic frameworks, such as those in [Konda and Tsitsiklis (2000)](https://papers.nips.cc/paper/2000/hash/60941600aaa93c7e3de7729355a0913e-Abstract.html), but are adapted to the autoregressive, token-level structure of language models.\n\nIn the context of LLM alignment, the value model Vœï(x)Vœï(x)V\\_\\\\phi(x) or Vœï(x,y)Vœï(x,y)V\\_\\\\phi(x, y) predicts the **expected return** (i.e., cumulative reward) for a given prompt xxx or prompt‚Äìresponse pair (x,y)(x,y)(x,y).\n\nIt serves the same theoretical role as the **critic** in an actor‚Äìcritic framework, providing a learned baseline that allows the policy (actor) to improve using lower-variance gradient estimates.\n\nThe fundamental definition is\n\n*   where R(s,a)R(s,a)R(s,a) is the return or scalar reward obtained when the policy œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta takes action aaa in state sss.\n\nIn the language modeling context, the ‚Äústate‚Äù corresponds to the **prompt or prefix** xxx, and the ‚Äúaction‚Äù corresponds to the **generated token sequence** yyy.\n\nThe value model enables several key operations:\n\n1.  **Advantage estimation:**\n    \n    *   Used to compute a baseline-corrected signal for PPO or similar algorithms:\n    \n    AÃÇ¬†(x,y)\\=r(x,y)‚àíVœï(x)A^(x,y)\\=r(x,y)‚àíVœï(x)\n    \n    \\\\hat{A}(x,y) = r(x,y) - V\\_\\\\phi(x)\n    \n    *   ‚Ä¶ or, at a token-wise level, via temporal-difference (TD) methods:\n    \n    AÃÇ¬†t\\=Œ¥t+(Œ≥Œª)AÃÇ¬†t+1A^t\\=Œ¥t+(Œ≥Œª)A^t+1\n    \n    \\\\hat{A}\\_t = \\\\delta\\_t + (\\\\gamma \\\\lambda)\\\\hat{A}\\_{t+1}\n    \n    *   ‚Ä¶ with:\n    \n    Œ¥t\\=rt+Œ≥Vœï(st+1)‚àíVœï(st)Œ¥t\\=rt+Œ≥Vœï(st+1)‚àíVœï(st)\n    \n    \\\\delta\\_t = r\\_t + \\\\gamma V\\_\\\\phi(s\\_{t+1}) - V\\_\\\\phi(s\\_t)\n    *   In **bandit-style** settings like RLHF (prompt ‚Üí‚Üí\\\\rightarrow response ‚Üí‚Üí\\\\rightarrow single reward), this simplifies to At\\=rt‚àíV(st)At\\=rt‚àíV(st)A\\_t = r\\_t - V(s\\_t), as the episode length is one. The short-horizon ‚Äúbandit‚Äù structure still benefits from the critic, since it stabilizes training and reduces gradient variance.\n2.  **Variance reduction:**\n    *   By learning a baseline for expected reward, Vœï(s)Vœï(s)V\\_\\\\phi(s) removes state-dependent bias and allows the policy gradient to focus on relative action quality.\n3.  **Critic-driven generalization:**\n    *   The critic can generalize expected reward patterns across prompts, enabling continual improvement even when human preference labels are unavailable.\n\n*   Used to compute a baseline-corrected signal for PPO or similar algorithms:\n\n*   ‚Ä¶ or, at a token-wise level, via temporal-difference (TD) methods:\n\n*   ‚Ä¶ with:\n\n*   In **bandit-style** settings like RLHF (prompt ‚Üí‚Üí\\\\rightarrow response ‚Üí‚Üí\\\\rightarrow single reward), this simplifies to At\\=rt‚àíV(st)At\\=rt‚àíV(st)A\\_t = r\\_t - V(s\\_t), as the episode length is one. The short-horizon ‚Äúbandit‚Äù structure still benefits from the critic, since it stabilizes training and reduces gradient variance.\n\n*   By learning a baseline for expected reward, Vœï(s)Vœï(s)V\\_\\\\phi(s) removes state-dependent bias and allows the policy gradient to focus on relative action quality.\n\n*   The critic can generalize expected reward patterns across prompts, enabling continual improvement even when human preference labels are unavailable.\n\n*   These functions mirror classical actor‚Äìcritic frameworks, such as those in [Konda and Tsitsiklis (2000)](https://papers.nips.cc/paper/2000/hash/60941600aaa93c7e3de7729355a0913e-Abstract.html), but are adapted to the autoregressive, token-level structure of language models.\n\n##### Architecture\n\n*   Architecturally, the value model is typically a **decoder-only transformer**, sharing its structure with both the policy and reward models, but differing in its **output head** and **training objective**.\n    *   In the implementation described in [_Training language models to follow instructions with human feedback_](https://arxiv.org/abs/2203.02155) by Ouyang et al. (2022), all components‚Äîincluding the supervised fine-tuned (SFT) policy, the reward model, and the value model used for PPO fine-tuning‚Äîare based on the GPT-3 architecture (specifically the 6B parameter variant), a unidirectional transformer decoder trained on autoregressive language modeling. The value function is **initialized from the reward model**, which itself is **trained starting from the SFT model with the final unembedding layer removed and replaced with a new linear head** that outputs a **scalar regression value** for each prompt‚Äìcompletion pair. This added linear layer serves as a learned projection that maps the final hidden state representation of the sequence to a single scalar reward estimate. The same architectural modification is used for the value model, which learns to predict expected returns during reinforcement learning with human feedback (RLHF).\n*   Mathematically speaking, the final token‚Äôs hidden representation hThTh\\_T (or an average over all tokens) is passed through a linear projection to output rœï(x,y)rœï(x,y)r\\_\\\\phi(x,y) a **single scalar reward** representing the model‚Äôs predicted human preference for the given prompt‚Äìcompletion pair.\n    \n    rœï(x,y)\\=w‚ä§hT+brœï(x,y)\\=w‚ä§hT+b\n    \n    r\\_\\\\phi(x,y) = w^\\\\top h\\_T + b\n    *   where w,bw,bw,b are learned parameters.\n*   Put simply, the value model outputs a **single scalar estimate** Vœï(x)Vœï(x)V\\_\\\\phi(x) (or per-token estimates Vœï(xt))Vœï(xt))V\\_\\\\phi(x\\_t)), rather than next-token probabilities or pairwise reward scores.\n    \n*   **Implementation details:**\n    \n    *   The **hidden representation** of the final token (or the mean of hidden states) is passed through a **linear projection layer** to produce the scalar value prediction.\n    *   Architecturally, it may **share parameters** with the policy model up to the final projection layer, forming a multi-head actor‚Äìcritic structure.\n    *   However, many implementations, including [**InstructGPT**](https://arxiv.org/abs/2203.02155), initialize the value model **separately** from the reward model rather than sharing parameters with the policy, ensuring that the two objectives‚Äîpolicy improvement and value estimation‚Äîdo not interfere.\n    *   Some designs explicitly decouple the policy and value networks to prevent gradient interference between actor and critic signals, which helps maintain training stability.\n*   The **reason for a dedicated value model or value head** is that PPO (and more generally, actor‚Äìcritic methods) rely on (V(s)) to compute advantages:\n    \n    A(s,a)‚âàr+Œ≥V(s‚Ä≤)‚àíV(s)A(s,a)‚âàr+Œ≥V(s‚Ä≤)‚àíV(s)\n    \n    A(s,a) \\\\approx r + \\\\gamma V(s') - V(s)\n    *   or, in the short-horizon (bandit) case, A\\=r‚àíV(s)A\\=r‚àíV(s)A = r - V(s).\n        \n    *   Without a critic, the gradient estimator would have much higher variance, leading to instability.\n        \n*   Additionally, LLMs define states as (prompt + partial generation) and actions as next tokens. Having a **separate value head or model** allows for stable and interpretable gradient flow through long token sequences.\n\n*   In the implementation described in [_Training language models to follow instructions with human feedback_](https://arxiv.org/abs/2203.02155) by Ouyang et al. (2022), all components‚Äîincluding the supervised fine-tuned (SFT) policy, the reward model, and the value model used for PPO fine-tuning‚Äîare based on the GPT-3 architecture (specifically the 6B parameter variant), a unidirectional transformer decoder trained on autoregressive language modeling. The value function is **initialized from the reward model**, which itself is **trained starting from the SFT model with the final unembedding layer removed and replaced with a new linear head** that outputs a **scalar regression value** for each prompt‚Äìcompletion pair. This added linear layer serves as a learned projection that maps the final hidden state representation of the sequence to a single scalar reward estimate. The same architectural modification is used for the value model, which learns to predict expected returns during reinforcement learning with human feedback (RLHF).\n\nMathematically speaking, the final token‚Äôs hidden representation hThTh\\_T (or an average over all tokens) is passed through a linear projection to output rœï(x,y)rœï(x,y)r\\_\\\\phi(x,y) a **single scalar reward** representing the model‚Äôs predicted human preference for the given prompt‚Äìcompletion pair.\n\n*   where w,bw,bw,b are learned parameters.\n\nPut simply, the value model outputs a **single scalar estimate** Vœï(x)Vœï(x)V\\_\\\\phi(x) (or per-token estimates Vœï(xt))Vœï(xt))V\\_\\\\phi(x\\_t)), rather than next-token probabilities or pairwise reward scores.\n\n**Implementation details:**\n\n*   The **hidden representation** of the final token (or the mean of hidden states) is passed through a **linear projection layer** to produce the scalar value prediction.\n*   Architecturally, it may **share parameters** with the policy model up to the final projection layer, forming a multi-head actor‚Äìcritic structure.\n*   However, many implementations, including [**InstructGPT**](https://arxiv.org/abs/2203.02155), initialize the value model **separately** from the reward model rather than sharing parameters with the policy, ensuring that the two objectives‚Äîpolicy improvement and value estimation‚Äîdo not interfere.\n*   Some designs explicitly decouple the policy and value networks to prevent gradient interference between actor and critic signals, which helps maintain training stability.\n\nThe **reason for a dedicated value model or value head** is that PPO (and more generally, actor‚Äìcritic methods) rely on (V(s)) to compute advantages:\n\n*   or, in the short-horizon (bandit) case, A\\=r‚àíV(s)A\\=r‚àíV(s)A = r - V(s).\n    \n*   Without a critic, the gradient estimator would have much higher variance, leading to instability.\n    \n\nor, in the short-horizon (bandit) case, A\\=r‚àíV(s)A\\=r‚àíV(s)A = r - V(s).\n\nWithout a critic, the gradient estimator would have much higher variance, leading to instability.\n\n##### Training Objective\n\n*   The value model is trained via **regression** to predict observed or bootstrapped returns:\n    \n    Óà∏V(œï)\\=ùîº(x,y)‚àºD\\[(Vœï(x)‚àíRÃÇ¬†(x,y))2\\]LV(œï)\\=E(x,y)‚àºD\\[(Vœï(x)‚àíR^(x,y))2\\]\n    \n    \\\\mathcal{L}\\_V(\\\\phi) = \\\\mathbb{E}\\_{(x,y)\\\\sim D} \\\\big\\[(V\\_\\\\phi(x) - \\\\hat{R}(x,y))^2\\\\big\\]\n    *   where RÃÇ¬†(x,y)R^(x,y)\\\\hat{R}(x,y) is the observed reward‚Äîtypically obtained from the **reward model** (RM) or human feedback.\n*   The [**InstructGPT**](https://arxiv.org/abs/2203.02155) paper notes that the value function is initialized from the reward model and fine-tuned concurrently during PPO to predict reward expectations.\n    \n*   Token-level PPO variants extend this objective to **per-token values**, improving credit assignment within long completions.\n    \n*   A **target value network** Vœï‚àíVœï‚àíV\\_{\\\\phi^-} may also be used to stabilize TD targets, updated periodically as in traditional deep RL.\n    \n*   The training data consist of tuples (x,y,r(x,y))(x,y,r(x,y))(x, y, r(x,y)) where:\n    \n    *   xxx: prompt sampled from curated datasets or user queries.\n    *   yyy: response generated by the current policy œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta.\n    *   r(x,y)r(x,y)r(x,y): scalar reward from the reward model (and optional KL-penalty adjustments).\n*   In the InstructGPT PPO setup, additional techniques such as a **token-wise KL penalty** (from the supervised fine-tuned model) are applied to the reward objective to constrain the policy from drifting too far from its original distribution. They also mention **mixing pretraining gradients** into PPO (‚ÄúPPO-ptx‚Äù) to mitigate regression on NLP benchmarks. This hybrid approach blends the **language modeling loss** from pretraining with the **reinforcement objective**, ensuring that while the model learns from reward feedback, it retains its broad linguistic competence and factual grounding. By interleaving supervised and reinforcement signals, PPO-ptx effectively regularizes the optimization trajectory, preventing catastrophic forgetting of general capabilities. In practice, this technique improves both **instruction-following behavior** and **robustness across unseen prompts**, striking a balance between alignment and general language proficiency.\n    \n\nThe value model is trained via **regression** to predict observed or bootstrapped returns:\n\n*   where RÃÇ¬†(x,y)R^(x,y)\\\\hat{R}(x,y) is the observed reward‚Äîtypically obtained from the **reward model** (RM) or human feedback.\n\nThe [**InstructGPT**](https://arxiv.org/abs/2203.02155) paper notes that the value function is initialized from the reward model and fine-tuned concurrently during PPO to predict reward expectations.\n\nToken-level PPO variants extend this objective to **per-token values**, improving credit assignment within long completions.\n\nA **target value network** Vœï‚àíVœï‚àíV\\_{\\\\phi^-} may also be used to stabilize TD targets, updated periodically as in traditional deep RL.\n\nThe training data consist of tuples (x,y,r(x,y))(x,y,r(x,y))(x, y, r(x,y)) where:\n\n*   xxx: prompt sampled from curated datasets or user queries.\n*   yyy: response generated by the current policy œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta.\n*   r(x,y)r(x,y)r(x,y): scalar reward from the reward model (and optional KL-penalty adjustments).\n\nIn the InstructGPT PPO setup, additional techniques such as a **token-wise KL penalty** (from the supervised fine-tuned model) are applied to the reward objective to constrain the policy from drifting too far from its original distribution. They also mention **mixing pretraining gradients** into PPO (‚ÄúPPO-ptx‚Äù) to mitigate regression on NLP benchmarks. This hybrid approach blends the **language modeling loss** from pretraining with the **reinforcement objective**, ensuring that while the model learns from reward feedback, it retains its broad linguistic competence and factual grounding. By interleaving supervised and reinforcement signals, PPO-ptx effectively regularizes the optimization trajectory, preventing catastrophic forgetting of general capabilities. In practice, this technique improves both **instruction-following behavior** and **robustness across unseen prompts**, striking a balance between alignment and general language proficiency.\n\n##### Training Data\n\n*   **Primary source:** On-policy samples collected during RLHF fine-tuning, typically generated from curated instruction datasets.\n*   **Reward signals:** Derived from the reward model or human-preference comparisons.\n*   **Scale:** Hundreds of thousands to millions of prompt‚Äìresponse pairs per training loop.\n*   **Temporal structure:** Since LLM reward modeling is usually _bandit-like_ (single scalar per completion), the value model relies on **Monte Carlo estimates** or **generalized advantage estimation (GAE)** to stabilize learning despite sparse supervision.\n\n##### Model Size\n\n*   The value model‚Äôs size is often comparable to the reward model and smaller than the policy model.\n    \n    *   For instance, in [**InstructGPT**](https://arxiv.org/abs/2203.02155), the critic had a similar scale (~6 B parameters) to the reward model and served as a critic for a 175 B parameter policy.\n    *   In open-source frameworks such as **TRLX** or **DeepSpeed-Chat**, value heads are attached to 7 B‚Äì13 B base LLMs or trained as independent critics.\n*   When computational resources are limited, a **shared-head** architecture is used, where the value head is attached directly to the policy model‚Äôs hidden states, enabling efficient joint training of actor and critic.\n    \n\nThe value model‚Äôs size is often comparable to the reward model and smaller than the policy model.\n\n*   For instance, in [**InstructGPT**](https://arxiv.org/abs/2203.02155), the critic had a similar scale (~6 B parameters) to the reward model and served as a critic for a 175 B parameter policy.\n*   In open-source frameworks such as **TRLX** or **DeepSpeed-Chat**, value heads are attached to 7 B‚Äì13 B base LLMs or trained as independent critics.\n\nWhen computational resources are limited, a **shared-head** architecture is used, where the value head is attached directly to the policy model‚Äôs hidden states, enabling efficient joint training of actor and critic.\n\n##### Relationship to the Reward Model\n\n**Aspect**\n\n**Reward Model**\n\n**Value Model**\n\nInput\n\nPrompt + response\n\nPrompt (or prompt + partial response)\n\nOutput\n\nScalar reward (human preference estimate)\n\nExpected future reward (baseline or critic)\n\nTraining data\n\nHuman or synthetic preference comparisons\n\nPolicy rollouts and rewards\n\nObjective\n\nPairwise ranking loss\n\nMSE regression loss\n\nUsage\n\nGuides policy optimization\n\nStabilizes training via advantage estimation\n\nUpdates\n\nOffline (pretrained)\n\nOnline (updated during RL loop)\n\n**Aspect**\n\n**Reward Model**\n\n**Value Model**\n\nInput\n\nPrompt + response\n\nPrompt (or prompt + partial response)\n\nOutput\n\nScalar reward (human preference estimate)\n\nExpected future reward (baseline or critic)\n\nTraining data\n\nHuman or synthetic preference comparisons\n\nPolicy rollouts and rewards\n\nObjective\n\nPairwise ranking loss\n\nMSE regression loss\n\nUsage\n\nGuides policy optimization\n\nStabilizes training via advantage estimation\n\nUpdates\n\nOffline (pretrained)\n\nOnline (updated during RL loop)\n\n*   The reward model captures _external supervision_, while the value model provides _internal bootstrapping_ for efficient policy learning.\n\n##### Comparative Analysis\n\n**Aspect**\n\n**Description**\n\n**Role**\n\nPredicts expected future reward for prompts/responses\n\n**Function**\n\nBaseline and critic for policy optimization\n\n**Architecture**\n\nTransformer with scalar output head\n\n**Training Data**\n\nOn-policy prompt‚Äìresponse‚Äìreward tuples\n\n**Model Size**\n\n1B‚Äì13B parameters\n\n**Training Objective**\n\nMean-squared error on observed or bootstrapped returns\n\n**References**\n\n[Konda & Tsitsiklis, 2000](https://papers.nips.cc/paper/2000/hash/60941600aaa93c7e3de7729355a0913e-Abstract.html); [Stiennon et al., 2020](https://arxiv.org/abs/2009.01325); [Ouyang et al., 2022](https://arxiv.org/abs/2203.02155)\n\n**Aspect**\n\n**Description**\n\n**Role**\n\nPredicts expected future reward for prompts/responses\n\n**Function**\n\nBaseline and critic for policy optimization\n\n**Architecture**\n\nTransformer with scalar output head\n\n**Training Data**\n\nOn-policy prompt‚Äìresponse‚Äìreward tuples\n\n**Model Size**\n\n1B‚Äì13B parameters\n\n**Training Objective**\n\nMean-squared error on observed or bootstrapped returns\n\n**References**\n\n[Konda & Tsitsiklis, 2000](https://papers.nips.cc/paper/2000/hash/60941600aaa93c7e3de7729355a0913e-Abstract.html); [Stiennon et al., 2020](https://arxiv.org/abs/2009.01325); [Ouyang et al., 2022](https://arxiv.org/abs/2203.02155)\n\n#### Optimizing the Policy\n\n*   The policy refers to a strategy or a set of rules that an agent uses to make decisions in an environment. Put simply, the policy defines how the agent selects actions based on its current observations or state.\n*   The policy optimization process involves RL techniques that iteratively refine the policy based on reward feedback. The reward model provides feedback based on human preferences, and the policy is optimized iteratively to maximize reward while maintaining a stable learning trajectory. The stability aspect is enforced by maintaining a certain level of similarity to its previous version (to prevent drastic changes that could lead to instability)\n*   Popular policy optimization methods ‚Äì specifically applied to LLMs ‚Äì include:\n    *   **[Proximal Policy Optimization (PPO)](#proximal-policy-optimization-ppo):** A widely-used RL algorithm that balances exploration and exploitation while maintaining training stability.\n    *   **[Direct Preference Optimization (DPO)](#direct-preference-optimization-dpo):** An alternative approach where the policy directly optimizes the relative log probability of preferred responses using a binary cross-entropy loss, balancing human feedback alignment with KL divergence constraints.\n    *   **[Group Relative Policy Optimization (GRPO)](#group-relative-preference-optimization-grpo):** A PPO variant that removes the critic model and estimates the baseline from group scores, improving memory efficiency and performance in complex tasks like mathematical reasoning.\n*   Through RLHF, models like InstructGPT and ChatGPT have achieved enhanced alignment with human expectations, producing more beneficial and contextually appropriate responses.\n\n*   **[Proximal Policy Optimization (PPO)](#proximal-policy-optimization-ppo):** A widely-used RL algorithm that balances exploration and exploitation while maintaining training stability.\n*   **[Direct Preference Optimization (DPO)](#direct-preference-optimization-dpo):** An alternative approach where the policy directly optimizes the relative log probability of preferred responses using a binary cross-entropy loss, balancing human feedback alignment with KL divergence constraints.\n*   **[Group Relative Policy Optimization (GRPO)](#group-relative-preference-optimization-grpo):** A PPO variant that removes the critic model and estimates the baseline from group scores, improving memory efficiency and performance in complex tasks like mathematical reasoning.\n\n#### Integration of Policy, Reference, Reward, and Value Models in RLHF\n\n*   The full RLHF pipeline integrates four central components ‚Äî the **policy**, **reference**, **reward**, and **value** models ‚Äî into a cohesive optimization framework. Together, these models implement a scalable variant of **policy-gradient reinforcement learning** (commonly using PPO) for large-scale language model alignment.\n    \n*   This section provides a complete description of how these models interact, the mathematical formulation governing their updates, and the system-level architecture of a modern RLHF pipeline.\n    \n\nThe full RLHF pipeline integrates four central components ‚Äî the **policy**, **reference**, **reward**, and **value** models ‚Äî into a cohesive optimization framework. Together, these models implement a scalable variant of **policy-gradient reinforcement learning** (commonly using PPO) for large-scale language model alignment.\n\nThis section provides a complete description of how these models interact, the mathematical formulation governing their updates, and the system-level architecture of a modern RLHF pipeline.\n\n##### Overview of the RLHF Process\n\n*   RLHF transforms large pretrained language models into _alignment-optimized_ conversational agents through a three-phase process:\n    \n    1.  **Supervised Fine-Tuning (SFT):**\n        *   The base pretrained LLM is fine-tuned on instruction‚Äìresponse data curated by humans.\n        *   **Output:** _SFT model_ (used as both the initial **policy** and the frozen **reference model**).\n    2.  **Reward Modeling:**\n        *   Human annotators rank or compare pairs of model responses.\n        *   A separate **reward model** is trained on these comparisons to learn a scalar preference function rœï(x,y)rœï(x,y)r\\_\\\\phi(x,y).\n    3.  **Reinforcement Learning (RL) Optimization:**\n        *   The **policy model** is optimized to generate responses that maximize the learned reward signal, while staying close to the **reference model** through KL regularization.\n        *   The **value model** acts as a critic, stabilizing the gradient updates.\n*   This procedure was first described comprehensively in _Training Language Models to Follow Instructions with Human Feedback_ by [Ouyang et al. (2022)](https://arxiv.org/abs/2203.02155), forming the backbone of systems such as **InstructGPT** and **ChatGPT**.\n    \n\nRLHF transforms large pretrained language models into _alignment-optimized_ conversational agents through a three-phase process:\n\n1.  **Supervised Fine-Tuning (SFT):**\n    *   The base pretrained LLM is fine-tuned on instruction‚Äìresponse data curated by humans.\n    *   **Output:** _SFT model_ (used as both the initial **policy** and the frozen **reference model**).\n2.  **Reward Modeling:**\n    *   Human annotators rank or compare pairs of model responses.\n    *   A separate **reward model** is trained on these comparisons to learn a scalar preference function rœï(x,y)rœï(x,y)r\\_\\\\phi(x,y).\n3.  **Reinforcement Learning (RL) Optimization:**\n    *   The **policy model** is optimized to generate responses that maximize the learned reward signal, while staying close to the **reference model** through KL regularization.\n    *   The **value model** acts as a critic, stabilizing the gradient updates.\n\n*   The base pretrained LLM is fine-tuned on instruction‚Äìresponse data curated by humans.\n*   **Output:** _SFT model_ (used as both the initial **policy** and the frozen **reference model**).\n\n*   Human annotators rank or compare pairs of model responses.\n*   A separate **reward model** is trained on these comparisons to learn a scalar preference function rœï(x,y)rœï(x,y)r\\_\\\\phi(x,y).\n\n*   The **policy model** is optimized to generate responses that maximize the learned reward signal, while staying close to the **reference model** through KL regularization.\n*   The **value model** acts as a critic, stabilizing the gradient updates.\n\nThis procedure was first described comprehensively in _Training Language Models to Follow Instructions with Human Feedback_ by [Ouyang et al. (2022)](https://arxiv.org/abs/2203.02155), forming the backbone of systems such as **InstructGPT** and **ChatGPT**.\n\n##### Core Mathematical Formulation\n\n*   The RLHF optimization problem can be expressed as:\n    \n    maxŒ∏,ùîºx‚àºDprompt,y‚àºœÄŒ∏(‚ãÖ‚à£x)\\[rœï(x,y)‚àíŒ≤,KL(œÄŒ∏(‚ãÖ‚à£x)‚ÄñœÄref(‚ãÖ‚à£x))\\]maxŒ∏,Ex‚àºDprompt,y‚àºœÄŒ∏(‚ãÖ‚à£x)\\[rœï(x,y)‚àíŒ≤,KL(œÄŒ∏(‚ãÖ‚à£x)‚ÄñœÄref(‚ãÖ‚à£x))\\]\n    \n    \\\\max\\_{\\\\theta}, \\\\mathbb{E}\\_{x\\\\sim D\\_{\\\\text{prompt}},y\\\\sim\\\\pi\\_\\\\theta(\\\\cdot\\\\mid x)} \\\\left\\[ r\\_\\\\phi(x,y) - \\\\beta,\\\\mathrm{KL}\\\\big(\\\\pi\\_\\\\theta(\\\\cdot\\\\mid x)\\\\Vert\\\\pi\\_{\\\\text{ref}}(\\\\cdot\\\\mid x)\\\\big) \\\\right\\]\n    *   where:\n        \n        *   œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta = **policy model** (trainable)\n        *   œÄrefœÄref\\\\pi\\_{\\\\text{ref}} = **reference model** (frozen)\n        *   rœïrœïr\\_\\\\phi = **reward model** (provides scalar reward)\n        *   Œ≤Œ≤\\\\beta = KL penalty coefficient controlling exploration‚Äìalignment trade-off\n*   The **KL term** prevents the policy from diverging too far from its linguistic prior, while the **reward** encourages behaviors that better match human preferences.\n    \n*   To train this objective, **Proximal Policy Optimization (PPO)** by [Schulman et al. (2017)](https://arxiv.org/abs/1707.06347) is typically used, which optimizes a clipped surrogate loss:\n    \n    LPPO(Œ∏)\\=ùîº(x,y)‚àºœÄŒ∏\\[min(rt(Œ∏),AÃÇ¬†t,clip(rt(Œ∏),1‚àíœµ,1+œµ),AÃÇ¬†t)\\]LPPO(Œ∏)\\=E(x,y)‚àºœÄŒ∏\\[min(rt(Œ∏),A^t,clip(rt(Œ∏),1‚àíœµ,1+œµ),A^t)\\]\n    \n    L\\_{\\\\text{PPO}}(\\\\theta) = \\\\mathbb{E}\\_{(x,y)\\\\sim\\\\pi\\_\\\\theta} \\\\left\\[ \\\\min\\\\left( r\\_t(\\\\theta),\\\\hat{A}\\_t, \\\\mathrm{clip}\\\\big(r\\_t(\\\\theta), 1-\\\\epsilon, 1+\\\\epsilon\\\\big),\\\\hat{A}\\_t \\\\right) \\\\right\\]\n    *   where:\n        \n        *   rt(Œ∏)\\=œÄŒ∏(yt‚à£xt)œÄŒ∏old(yt‚à£xt)rt(Œ∏)\\=œÄŒ∏(yt‚à£xt)œÄŒ∏old(yt‚à£xt)r\\_t(\\\\theta) = \\\\frac{\\\\pi\\_\\\\theta(y\\_t \\\\mid x\\_t)}{\\\\pi\\_{\\\\theta\\_{\\\\text{old}}}(y\\_t \\\\mid x\\_t)} is the **likelihood ratio**;\n        *   AÃÇ¬†t\\=rœï(xt,yt)‚àíVœà(xt)A^t\\=rœï(xt,yt)‚àíVœà(xt)\\\\hat{A}\\_t = r\\_\\\\phi(x\\_t,y\\_t) - V\\_\\\\psi(x\\_t) is the **advantage estimate**;\n        *   VœàVœàV\\_\\\\psi = **value model**;\n        *   œµœµ\\\\epsilon is a clipping hyperparameter (usually 0.1‚Äì0.2).\n*   The advantage term ensures that updates are proportional to how much better a response is than expected, while the clipping stabilizes the step size.\n    \n\nThe RLHF optimization problem can be expressed as:\n\n*   where:\n    \n    *   œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta = **policy model** (trainable)\n    *   œÄrefœÄref\\\\pi\\_{\\\\text{ref}} = **reference model** (frozen)\n    *   rœïrœïr\\_\\\\phi = **reward model** (provides scalar reward)\n    *   Œ≤Œ≤\\\\beta = KL penalty coefficient controlling exploration‚Äìalignment trade-off\n\nwhere:\n\n*   œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta = **policy model** (trainable)\n*   œÄrefœÄref\\\\pi\\_{\\\\text{ref}} = **reference model** (frozen)\n*   rœïrœïr\\_\\\\phi = **reward model** (provides scalar reward)\n*   Œ≤Œ≤\\\\beta = KL penalty coefficient controlling exploration‚Äìalignment trade-off\n\nThe **KL term** prevents the policy from diverging too far from its linguistic prior, while the **reward** encourages behaviors that better match human preferences.\n\nTo train this objective, **Proximal Policy Optimization (PPO)** by [Schulman et al. (2017)](https://arxiv.org/abs/1707.06347) is typically used, which optimizes a clipped surrogate loss:\n\n*   where:\n    \n    *   rt(Œ∏)\\=œÄŒ∏(yt‚à£xt)œÄŒ∏old(yt‚à£xt)rt(Œ∏)\\=œÄŒ∏(yt‚à£xt)œÄŒ∏old(yt‚à£xt)r\\_t(\\\\theta) = \\\\frac{\\\\pi\\_\\\\theta(y\\_t \\\\mid x\\_t)}{\\\\pi\\_{\\\\theta\\_{\\\\text{old}}}(y\\_t \\\\mid x\\_t)} is the **likelihood ratio**;\n    *   AÃÇ¬†t\\=rœï(xt,yt)‚àíVœà(xt)A^t\\=rœï(xt,yt)‚àíVœà(xt)\\\\hat{A}\\_t = r\\_\\\\phi(x\\_t,y\\_t) - V\\_\\\\psi(x\\_t) is the **advantage estimate**;\n    *   VœàVœàV\\_\\\\psi = **value model**;\n    *   œµœµ\\\\epsilon is a clipping hyperparameter (usually 0.1‚Äì0.2).\n\nwhere:\n\n*   rt(Œ∏)\\=œÄŒ∏(yt‚à£xt)œÄŒ∏old(yt‚à£xt)rt(Œ∏)\\=œÄŒ∏(yt‚à£xt)œÄŒ∏old(yt‚à£xt)r\\_t(\\\\theta) = \\\\frac{\\\\pi\\_\\\\theta(y\\_t \\\\mid x\\_t)}{\\\\pi\\_{\\\\theta\\_{\\\\text{old}}}(y\\_t \\\\mid x\\_t)} is the **likelihood ratio**;\n*   AÃÇ¬†t\\=rœï(xt,yt)‚àíVœà(xt)A^t\\=rœï(xt,yt)‚àíVœà(xt)\\\\hat{A}\\_t = r\\_\\\\phi(x\\_t,y\\_t) - V\\_\\\\psi(x\\_t) is the **advantage estimate**;\n*   VœàVœàV\\_\\\\psi = **value model**;\n*   œµœµ\\\\epsilon is a clipping hyperparameter (usually 0.1‚Äì0.2).\n\nThe advantage term ensures that updates are proportional to how much better a response is than expected, while the clipping stabilizes the step size.\n\n##### Role of Each Model in the Loop\n\n*   **Policy Model** œÄŒ∏œÄŒ∏\\\\pi\\_{\\\\theta}:\n    \n    *   Generates responses yyy to prompts xxx.\n    *   Updated via **Proximal Policy Optimization (PPO)** to maximize the clipped surrogate objective.\n    *   Receives both **reward signals** and **value-based baselines** during training.\n*   **Reference Model** œÄrefœÄref\\\\pi\\_{\\\\text{ref}}:\n    \n    *   Provides a baseline distribution for **KL regularization** to prevent over-optimization.\n        \n    *   Frozen during training; used to compute token-wise divergence:\n        \n        DKL(œÄŒ∏(‚ãÖ‚à£x)‚ÄñœÄref(‚ãÖ‚à£x))\\=‚àëyœÄŒ∏(y‚à£x)‚ãÖlogœÄŒ∏(y‚à£x)œÄref(y‚à£x)DKL(œÄŒ∏(‚ãÖ‚à£x)‚ÄñœÄref(‚ãÖ‚à£x))\\=‚àëyœÄŒ∏(y‚à£x)‚ãÖlog‚Å°œÄŒ∏(y‚à£x)œÄref(y‚à£x)\n        \n        D\\_{\\\\text{KL}}\\\\big(\\\\pi\\_{\\\\theta}(\\\\cdot \\\\mid x) \\\\Vert \\\\pi\\_{\\\\text{ref}}(\\\\cdot \\\\mid x)\\\\big) = \\\\sum\\_{y} \\\\pi\\_{\\\\theta}(y \\\\mid x) \\\\cdot \\\\log\\\\frac{\\\\pi\\_{\\\\theta}(y \\\\mid x)}{\\\\pi\\_{\\\\text{ref}}(y \\\\mid x)}\n    *   Ensures linguistic stability and mitigates **reward hacking** by anchoring the policy to its supervised fine-tuned prior.\n        \n*   **Reward Model** rœïrœïr\\_{\\\\phi}:\n    \n    *   Maps each generated response yyy (conditioned on prompt xxx) to a scalar reward: rœï:(x,y)‚Ü¶‚Ñùrœï:(x,y)‚Ü¶Rr\\_{\\\\phi}: (x, y) \\\\mapsto \\\\mathbb{R}.\n    *   Trained on **human preference data** (pairwise or ranked comparisons), then frozen during policy optimization.\n    *   Supplies an **approximation of human judgment**, encouraging the policy to produce more aligned, preferred responses.\n*   **Value Model** VœàVœàV\\_{\\\\psi}:\n    \n    *   Estimates the **expected return** for a given prompt (or state) xxx, reducing variance in policy-gradient updates.\n    *   Trained in parallel with the policy to predict the observed or bootstrapped return: RÃÇ¬†(x,y)\\=rœï(x,y),R^(x,y)\\=rœï(x,y),\\\\hat{R}(x, y) = r\\_{\\\\phi}(x, y), and provides **advantage estimates**: AÃÇ¬†(x,y)\\=rœï(x,y)‚àíVœà(x).A^(x,y)\\=rœï(x,y)‚àíVœà(x).\\\\hat{A}(x, y) = r\\_{\\\\phi}(x, y) - V\\_{\\\\psi}(x).\n    *   Serves as a **critic** in the actor‚Äìcritic framework, enabling stable and efficient optimization.\n\n**Policy Model** œÄŒ∏œÄŒ∏\\\\pi\\_{\\\\theta}:\n\n*   Generates responses yyy to prompts xxx.\n*   Updated via **Proximal Policy Optimization (PPO)** to maximize the clipped surrogate objective.\n*   Receives both **reward signals** and **value-based baselines** during training.\n\n**Reference Model** œÄrefœÄref\\\\pi\\_{\\\\text{ref}}:\n\n*   Provides a baseline distribution for **KL regularization** to prevent over-optimization.\n    \n*   Frozen during training; used to compute token-wise divergence:\n    \n    DKL(œÄŒ∏(‚ãÖ‚à£x)‚ÄñœÄref(‚ãÖ‚à£x))\\=‚àëyœÄŒ∏(y‚à£x)‚ãÖlogœÄŒ∏(y‚à£x)œÄref(y‚à£x)DKL(œÄŒ∏(‚ãÖ‚à£x)‚ÄñœÄref(‚ãÖ‚à£x))\\=‚àëyœÄŒ∏(y‚à£x)‚ãÖlog‚Å°œÄŒ∏(y‚à£x)œÄref(y‚à£x)\n    \n    D\\_{\\\\text{KL}}\\\\big(\\\\pi\\_{\\\\theta}(\\\\cdot \\\\mid x) \\\\Vert \\\\pi\\_{\\\\text{ref}}(\\\\cdot \\\\mid x)\\\\big) = \\\\sum\\_{y} \\\\pi\\_{\\\\theta}(y \\\\mid x) \\\\cdot \\\\log\\\\frac{\\\\pi\\_{\\\\theta}(y \\\\mid x)}{\\\\pi\\_{\\\\text{ref}}(y \\\\mid x)}\n*   Ensures linguistic stability and mitigates **reward hacking** by anchoring the policy to its supervised fine-tuned prior.\n    \n\nProvides a baseline distribution for **KL regularization** to prevent over-optimization.\n\nFrozen during training; used to compute token-wise divergence:\n\nEnsures linguistic stability and mitigates **reward hacking** by anchoring the policy to its supervised fine-tuned prior.\n\n**Reward Model** rœïrœïr\\_{\\\\phi}:\n\n*   Maps each generated response yyy (conditioned on prompt xxx) to a scalar reward: rœï:(x,y)‚Ü¶‚Ñùrœï:(x,y)‚Ü¶Rr\\_{\\\\phi}: (x, y) \\\\mapsto \\\\mathbb{R}.\n*   Trained on **human preference data** (pairwise or ranked comparisons), then frozen during policy optimization.\n*   Supplies an **approximation of human judgment**, encouraging the policy to produce more aligned, preferred responses.\n\n**Value Model** VœàVœàV\\_{\\\\psi}:\n\n*   Estimates the **expected return** for a given prompt (or state) xxx, reducing variance in policy-gradient updates.\n*   Trained in parallel with the policy to predict the observed or bootstrapped return: RÃÇ¬†(x,y)\\=rœï(x,y),R^(x,y)\\=rœï(x,y),\\\\hat{R}(x, y) = r\\_{\\\\phi}(x, y), and provides **advantage estimates**: AÃÇ¬†(x,y)\\=rœï(x,y)‚àíVœà(x).A^(x,y)\\=rœï(x,y)‚àíVœà(x).\\\\hat{A}(x, y) = r\\_{\\\\phi}(x, y) - V\\_{\\\\psi}(x).\n*   Serves as a **critic** in the actor‚Äìcritic framework, enabling stable and efficient optimization.\n\n##### Full Training Loop\n\n*   **Step 1: Sampling Responses**:\n    \n    *   Draw a batch of prompts xixi{x\\_i} from the dataset.\n    *   Generate responses yiyi{y\\_i} from the current policy œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta.\n*   **Step 2: Reward Evaluation**:\n    \n    *   Compute scalar rewards rœï(xi,yi)rœï(xi,yi)r\\_\\\\phi(x\\_i, y\\_i) using the reward model.\n    *   Compute KL penalties from the reference model.\n*   **Step 3: Advantage Computation**:\n    \n    *   Use the value model to estimate baselines Vœà(xi)Vœà(xi)V\\_\\\\psi(x\\_i).\n    *   Compute advantages AÃÇ¬†i\\=rœï(xi,yi)‚àíVœà(xi)A^i\\=rœï(xi,yi)‚àíVœà(xi)\\\\hat{A}\\_i = r\\_\\\\phi(x\\_i, y\\_i) - V\\_\\\\psi(x\\_i).\n*   **Step 4: Policy Update (PPO)**:\n    \n    *   Optimize LPPO(Œ∏)LPPO(Œ∏)L\\_{\\\\text{PPO}}(\\\\theta) with respect to the policy parameters.\n    *   Clip ratios and advantages to maintain stable updates.\n*   **Step 5: Value Model Update**:\n    \n    *   Update the critic via regression: Óà∏V(œà)\\=ùîº(x,y)\\[(Vœà(x)‚àírœï(x,y))2\\]LV(œà)\\=E(x,y)\\[(Vœà(x)‚àírœï(x,y))2\\]\\\\mathcal{L}\\_V(\\\\psi) = \\\\mathbb{E}\\_{(x,y)} \\\\big\\[ (V\\_\\\\psi(x) - r\\_\\\\phi(x,y))^2 \\\\big\\]\n*   **Step 6: Iteration and Rollout**:\n    \n    *   Repeat with new samples from the updated policy.\n    *   Periodically evaluate human or synthetic preference metrics to ensure alignment progress.\n\n**Step 1: Sampling Responses**:\n\n*   Draw a batch of prompts xixi{x\\_i} from the dataset.\n*   Generate responses yiyi{y\\_i} from the current policy œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta.\n\n**Step 2: Reward Evaluation**:\n\n*   Compute scalar rewards rœï(xi,yi)rœï(xi,yi)r\\_\\\\phi(x\\_i, y\\_i) using the reward model.\n*   Compute KL penalties from the reference model.\n\n**Step 3: Advantage Computation**:\n\n*   Use the value model to estimate baselines Vœà(xi)Vœà(xi)V\\_\\\\psi(x\\_i).\n*   Compute advantages AÃÇ¬†i\\=rœï(xi,yi)‚àíVœà(xi)A^i\\=rœï(xi,yi)‚àíVœà(xi)\\\\hat{A}\\_i = r\\_\\\\phi(x\\_i, y\\_i) - V\\_\\\\psi(x\\_i).\n\n**Step 4: Policy Update (PPO)**:\n\n*   Optimize LPPO(Œ∏)LPPO(Œ∏)L\\_{\\\\text{PPO}}(\\\\theta) with respect to the policy parameters.\n*   Clip ratios and advantages to maintain stable updates.\n\n**Step 5: Value Model Update**:\n\n*   Update the critic via regression: Óà∏V(œà)\\=ùîº(x,y)\\[(Vœà(x)‚àírœï(x,y))2\\]LV(œà)\\=E(x,y)\\[(Vœà(x)‚àírœï(x,y))2\\]\\\\mathcal{L}\\_V(\\\\psi) = \\\\mathbb{E}\\_{(x,y)} \\\\big\\[ (V\\_\\\\psi(x) - r\\_\\\\phi(x,y))^2 \\\\big\\]\n\n**Step 6: Iteration and Rollout**:\n\n*   Repeat with new samples from the updated policy.\n*   Periodically evaluate human or synthetic preference metrics to ensure alignment progress.\n\n##### System Architecture\n\nDprompt‚èüPrompt Dataset‚àí‚Üí‚àí‚àí‚àí‚àí‚àí‚àí‚àí‚àísample promptsœÄŒ∏‚èüPolicy Model‚àí‚Üí‚àí‚àí‚àí‚àí‚àí‚àí‚àí‚àí‚àí‚àíGenerates responsesrœï‚èüReward Model‚àí‚Üí‚àí‚àí‚àí‚àí‚àí‚àí‚àí‚àí‚àí‚àí‚àí‚àí‚àíComputes scalar rewardsVœà‚èüValue Model‚àí‚Üí‚àí‚àí‚àí‚àí‚àí‚àí‚àí‚àí‚àí‚àíComputes baselinesœÄref‚èüReference Model‚àí‚Üí‚àí‚àí‚àí‚àí‚àí‚àí‚àí‚àí‚àí‚àí‚àí‚àí‚àíKL penalty computationPPO Optimization LoopÓÑΩÓÑæÓÖÅÓÖãÓÖãÓÖãÓÖãÓÖãÓÖãÓÖãÓÖãÓÖãÓÖãÓÖãÓÖãPolicy update stepDprompt‚èüPrompt Dataset‚Üísample promptsœÄŒ∏‚èüPolicy Model‚ÜíGenerates responsesrœï‚èüReward Model‚ÜíComputes scalar rewardsVœà‚èüValue Model‚ÜíComputes baselinesœÄref‚èüReference Model‚ÜíKL penalty computationPPO Optimization Loop‚èüPolicy update step\n\n##### Computational and Practical Considerations\n\n*   **Training Scale:**\n    *   The RLHF fine-tuning phase typically uses **hundreds of thousands to millions of samples**, requiring large-scale distributed training.\n    *   Compute cost is dominated by sampling (policy forward passes) and reward scoring.\n*   **Stability:**\n    *   PPO‚Äôs clipping and KL regularization stabilize updates that would otherwise explode in such large parameter spaces.\n*   **Safety and Alignment:**\n    *   The reward model embeds alignment objectives (helpfulness, harmlessness, honesty).\n    *   KL regularization ensures fidelity to the pretrained model‚Äôs linguistic priors.\n*   **Continuous Improvement:**\n    *   Iterative retraining of reward models using newer policy outputs yields increasingly aligned systems ‚Äî a process sometimes called _iterative RLHF_ or _alignment bootstrapping_ (see [Christiano et al., 2017](https://arxiv.org/abs/1706.03741)).\n\n*   The RLHF fine-tuning phase typically uses **hundreds of thousands to millions of samples**, requiring large-scale distributed training.\n*   Compute cost is dominated by sampling (policy forward passes) and reward scoring.\n\n*   PPO‚Äôs clipping and KL regularization stabilize updates that would otherwise explode in such large parameter spaces.\n\n*   The reward model embeds alignment objectives (helpfulness, harmlessness, honesty).\n*   KL regularization ensures fidelity to the pretrained model‚Äôs linguistic priors.\n\n*   Iterative retraining of reward models using newer policy outputs yields increasingly aligned systems ‚Äî a process sometimes called _iterative RLHF_ or _alignment bootstrapping_ (see [Christiano et al., 2017](https://arxiv.org/abs/1706.03741)).\n\n##### Comparative Analysis\n\n**Model**\n\n**Function**\n\n**Training Status**\n\n**Data Source**\n\n**Typical Size**\n\n**Policy (œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta)**\n\nGenerates responses; optimized for reward\n\nTrainable\n\nPrompts, synthetic rollouts\n\n7B‚Äì175B\n\n**Reference (œÄrefœÄref\\\\pi\\_\\\\text{ref})**\n\nBaseline distribution for KL penalty\n\nFrozen\n\nSame as SFT model\n\n7B‚Äì175B\n\n**Reward (rœïrœïr\\_\\\\phi)**\n\nScores responses based on preferences\n\nFrozen\n\nHuman comparisons\n\n1B‚Äì13B\n\n**Value (VœàVœàV\\_\\\\psi)**\n\nPredicts expected reward (critic)\n\nTrainable\n\nPolicy rollouts with rewards\n\n1B‚Äì13B\n\n**Model**\n\n**Function**\n\n**Training Status**\n\n**Data Source**\n\n**Typical Size**\n\n**Policy (œÄŒ∏œÄŒ∏\\\\pi\\_\\\\theta)**\n\nGenerates responses; optimized for reward\n\nTrainable\n\nPrompts, synthetic rollouts\n\n7B‚Äì175B\n\n**Reference (œÄrefœÄref\\\\pi\\_\\\\text{ref})**\n\nBaseline distribution for KL penalty\n\nFrozen\n\nSame as SFT model\n\n7B‚Äì175B\n\n**Reward (rœïrœïr\\_\\\\phi)**\n\nScores responses based on preferences\n\nFrozen\n\nHuman comparisons\n\n1B‚Äì13B\n\n**Value (VœàVœàV\\_\\\\psi)**\n\nPredicts expected reward (critic)\n\nTrainable\n\nPolicy rollouts with rewards\n\n1B‚Äì13B\n\n*   In summary, RLHF operationalizes reinforcement learning at massive scale by combining:\n    \n    *   The **policy** for exploration and response generation,\n    *   The **reward** for human alignment,\n    *   The **value** for stability and variance control, and\n    *   The **reference** for constraint and safety.\n*   This synergy enables LLMs to internalize nuanced human feedback, forming the foundation for systems like **ChatGPT**, **Anthropic‚Äôs Claude**, and **Google‚Äôs Gemini**.\n    \n\nIn summary, RLHF operationalizes reinforcement learning at massive scale by combining:\n\n*   The **policy** for exploration and response generation,\n*   The **reward** for human alignment,\n*   The **value** for stability and variance control, and\n*   The **reference** for constraint and safety.\n\nThis synergy enables LLMs to internalize nuanced human feedback, forming the foundation for systems like **ChatGPT**, **Anthropic‚Äôs Claude**, and **Google‚Äôs Gemini**.",
    "order": 23,
    "orderInChapter": 1,
    "difficulty": 5,
    "estimatedMinutes": 58,
    "tags": [
      "algorithmsarchitecture",
      "transformer",
      "attention",
      "embedding",
      "gpt",
      "llm",
      "nlp",
      "reinforcement learning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": true,
      "wordCount": 11430,
      "contentLength": 1022090
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#model-roles",
    "scrapedAt": "2025-12-28T11:47:08.462Z"
  },
  {
    "id": "ai-reinforcement-learning-online-policy-evaluation-24",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Policy Evaluation",
    "title": "Online Policy Evaluation",
    "subtitle": "Policy Evaluation",
    "contentHtml": "<ul>\n  <li>\n    <p>In online policy evaluation, the policy is tested in the environment to observe its real-time performance. Common metrics include:</p>\n\n    <ul>\n      <li>\n        <p><strong>Expected Return</strong>: The most common measure in RL, defined as the expected cumulative reward (discounted or undiscounted) obtained by following the policy over time. This is expressed as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-407-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6419\" style=\"width: 12.763em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1010.32em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6420\"><span class=\"mi\" id=\"MathJax-Span-6421\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6422\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6423\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6424\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6425\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-6426\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-6427\"><span class=\"mi\" id=\"MathJax-Span-6428\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span class=\"mrow\" id=\"MathJax-Span-6429\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-6430\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-6431\"><span class=\"munderover\" id=\"MathJax-Span-6432\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-6433\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-6434\"><span class=\"mrow\" id=\"MathJax-Span-6435\"><span class=\"mi\" id=\"MathJax-Span-6436\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6437\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-6438\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -5.206em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-6439\"><span class=\"mrow\" id=\"MathJax-Span-6440\"><span class=\"mi\" id=\"MathJax-Span-6441\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àû</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-6442\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6443\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6444\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-6445\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-6446\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6447\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6448\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6449\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6450\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-6451\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6452\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6453\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6454\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-6455\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>J</mi><mo stretchy=\"false\">(</mo><mi>œÄ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow><mo>[</mo><mrow><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">‚àû</mi></mrow></munderover><msup><mi>Œ≥</mi><mi>t</mi></msup><mi>R</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-407\">J(\\pi) = \\mathbb{E}\\left[\\sum_{t=0}^{\\infty} \\gamma^t R(s_t, a_t)\\right]</script>\n\n        <p>where:</p>\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-408-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6456\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6457\"><span class=\"mi\" id=\"MathJax-Span-6458\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-408\">\\pi</script> is the policy,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-409-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6459\" style=\"width: 3.961em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.284em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.23em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6460\"><span class=\"mi\" id=\"MathJax-Span-6461\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-6462\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6463\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6464\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6465\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6466\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-6467\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6468\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6469\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6470\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-409\">R(s_t, a_t)</script> is the reward obtained at time step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-410-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6471\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6472\"><span class=\"mi\" id=\"MathJax-Span-6473\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-410\">t</script>,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-411-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6474\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6475\"><span class=\"mi\" id=\"MathJax-Span-6476\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-411\">\\gamma</script> is the discount factor (0 ‚â§ Œ≥ ‚â§ 1),</li>\n          <li>and the expectation is taken over all possible trajectories the policy might follow.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Sample Efficiency</strong>: RL methods often require many interactions with the environment to train, and sample efficiency measures how well a policy performs given a limited number of interactions.</p>\n      </li>\n      <li>\n        <p><strong>Stability and Robustness</strong>: Evaluating if the policy consistently achieves good performance under different conditions or in the presence of uncertainties, such as noise in the environment or policy execution errors.</p>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p>However, real-world deployment of RL agents might come with risks. For instance, in healthcare, trying an untested policy could harm patients. Hence, the need for offline policy evaluation (OPE) arises.</p>\n  </li>\n</ul>\n<p>In online policy evaluation, the policy is tested in the environment to observe its real-time performance. Common metrics include:</p>\n<ul>\n      <li>\n        <p><strong>Expected Return</strong>: The most common measure in RL, defined as the expected cumulative reward (discounted or undiscounted) obtained by following the policy over time. This is expressed as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-407-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow><mo>[</mo><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mi>t</mi></msup><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>]</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6419\" style=\"width: 12.763em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(2.19em, 1010.32em, 5.576em, -999.997em); top: -4.112em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6420\"><span class=\"mi\" id=\"MathJax-Span-6421\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6422\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6423\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6424\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6425\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"texatom\" id=\"MathJax-Span-6426\" style=\"padding-left: 0.315em;\"><span class=\"mrow\" id=\"MathJax-Span-6427\"><span class=\"mi\" id=\"MathJax-Span-6428\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span class=\"mrow\" id=\"MathJax-Span-6429\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-6430\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">[</span></span><span class=\"mrow\" id=\"MathJax-Span-6431\"><span class=\"munderover\" id=\"MathJax-Span-6432\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-6433\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.04em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-6434\"><span class=\"mrow\" id=\"MathJax-Span-6435\"><span class=\"mi\" id=\"MathJax-Span-6436\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6437\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-6438\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -5.206em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-6439\"><span class=\"mrow\" id=\"MathJax-Span-6440\"><span class=\"mi\" id=\"MathJax-Span-6441\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àû</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-6442\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6443\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6444\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-6445\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-6446\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6447\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6448\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6449\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6450\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-6451\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6452\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6453\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6454\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-6455\" style=\"vertical-align: -0.779em;\"><span style=\"font-family: STIXSizeFourSym;\">]</span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.117em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.622em; border-left: 0px solid; width: 0px; height: 3.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>J</mi><mo stretchy=\"false\">(</mo><mi>œÄ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow><mo>[</mo><mrow><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">‚àû</mi></mrow></munderover><msup><mi>Œ≥</mi><mi>t</mi></msup><mi>R</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>]</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-407\">J(\\pi) = \\mathbb{E}\\left[\\sum_{t=0}^{\\infty} \\gamma^t R(s_t, a_t)\\right]</script>\n\n        <p>where:</p>\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-408-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6456\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6457\"><span class=\"mi\" id=\"MathJax-Span-6458\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-408\">\\pi</script> is the policy,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-409-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6459\" style=\"width: 3.961em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.284em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.23em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6460\"><span class=\"mi\" id=\"MathJax-Span-6461\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-6462\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6463\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6464\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6465\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6466\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-6467\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6468\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6469\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6470\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-409\">R(s_t, a_t)</script> is the reward obtained at time step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-410-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6471\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6472\"><span class=\"mi\" id=\"MathJax-Span-6473\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-410\">t</script>,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-411-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6474\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6475\"><span class=\"mi\" id=\"MathJax-Span-6476\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-411\">\\gamma</script> is the discount factor (0 ‚â§ Œ≥ ‚â§ 1),</li>\n          <li>and the expectation is taken over all possible trajectories the policy might follow.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Sample Efficiency</strong>: RL methods often require many interactions with the environment to train, and sample efficiency measures how well a policy performs given a limited number of interactions.</p>\n      </li>\n      <li>\n        <p><strong>Stability and Robustness</strong>: Evaluating if the policy consistently achieves good performance under different conditions or in the presence of uncertainties, such as noise in the environment or policy execution errors.</p>\n      </li>\n    </ul>\n<p><strong>Expected Return</strong>: The most common measure in RL, defined as the expected cumulative reward (discounted or undiscounted) obtained by following the policy over time. This is expressed as:</p>\n<p>where:</p>\n<ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-408-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6456\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6457\"><span class=\"mi\" id=\"MathJax-Span-6458\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-408\">\\pi</script> is the policy,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-409-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6459\" style=\"width: 3.961em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.284em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.23em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6460\"><span class=\"mi\" id=\"MathJax-Span-6461\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-6462\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6463\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6464\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6465\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6466\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-6467\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6468\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6469\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6470\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>R</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-409\">R(s_t, a_t)</script> is the reward obtained at time step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-410-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6471\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6472\"><span class=\"mi\" id=\"MathJax-Span-6473\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-410\">t</script>,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-411-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6474\" style=\"width: 0.732em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6475\"><span class=\"mi\" id=\"MathJax-Span-6476\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-411\">\\gamma</script> is the discount factor (0 ‚â§ Œ≥ ‚â§ 1),</li>\n          <li>and the expectation is taken over all possible trajectories the policy might follow.</li>\n        </ul>\n<p><strong>Sample Efficiency</strong>: RL methods often require many interactions with the environment to train, and sample efficiency measures how well a policy performs given a limited number of interactions.</p>\n<p><strong>Stability and Robustness</strong>: Evaluating if the policy consistently achieves good performance under different conditions or in the presence of uncertainties, such as noise in the environment or policy execution errors.</p>\n<p>However, real-world deployment of RL agents might come with risks. For instance, in healthcare, trying an untested policy could harm patients. Hence, the need for offline policy evaluation (OPE) arises.</p>",
    "contentMarkdown": "*   In online policy evaluation, the policy is tested in the environment to observe its real-time performance. Common metrics include:\n    \n    *   **Expected Return**: The most common measure in RL, defined as the expected cumulative reward (discounted or undiscounted) obtained by following the policy over time. This is expressed as:\n        \n        J(œÄ)\\=ùîº\\[‚àët\\=0‚àûŒ≥tR(st,at)\\]J(œÄ)\\=E\\[‚àët\\=0‚àûŒ≥tR(st,at)\\]\n        \n        J(\\\\pi) = \\\\mathbb{E}\\\\left\\[\\\\sum\\_{t=0}^{\\\\infty} \\\\gamma^t R(s\\_t, a\\_t)\\\\right\\]\n        \n        where:\n        \n        *   œÄœÄ\\\\pi is the policy,\n        *   R(st,at)R(st,at)R(s\\_t, a\\_t) is the reward obtained at time step ttt,\n        *   Œ≥Œ≥\\\\gamma is the discount factor (0 ‚â§ Œ≥ ‚â§ 1),\n        *   and the expectation is taken over all possible trajectories the policy might follow.\n    *   **Sample Efficiency**: RL methods often require many interactions with the environment to train, and sample efficiency measures how well a policy performs given a limited number of interactions.\n        \n    *   **Stability and Robustness**: Evaluating if the policy consistently achieves good performance under different conditions or in the presence of uncertainties, such as noise in the environment or policy execution errors.\n        \n*   However, real-world deployment of RL agents might come with risks. For instance, in healthcare, trying an untested policy could harm patients. Hence, the need for offline policy evaluation (OPE) arises.\n    \n\nIn online policy evaluation, the policy is tested in the environment to observe its real-time performance. Common metrics include:\n\n*   **Expected Return**: The most common measure in RL, defined as the expected cumulative reward (discounted or undiscounted) obtained by following the policy over time. This is expressed as:\n    \n    J(œÄ)\\=ùîº\\[‚àët\\=0‚àûŒ≥tR(st,at)\\]J(œÄ)\\=E\\[‚àët\\=0‚àûŒ≥tR(st,at)\\]\n    \n    J(\\\\pi) = \\\\mathbb{E}\\\\left\\[\\\\sum\\_{t=0}^{\\\\infty} \\\\gamma^t R(s\\_t, a\\_t)\\\\right\\]\n    \n    where:\n    \n    *   œÄœÄ\\\\pi is the policy,\n    *   R(st,at)R(st,at)R(s\\_t, a\\_t) is the reward obtained at time step ttt,\n    *   Œ≥Œ≥\\\\gamma is the discount factor (0 ‚â§ Œ≥ ‚â§ 1),\n    *   and the expectation is taken over all possible trajectories the policy might follow.\n*   **Sample Efficiency**: RL methods often require many interactions with the environment to train, and sample efficiency measures how well a policy performs given a limited number of interactions.\n    \n*   **Stability and Robustness**: Evaluating if the policy consistently achieves good performance under different conditions or in the presence of uncertainties, such as noise in the environment or policy execution errors.\n    \n\n**Expected Return**: The most common measure in RL, defined as the expected cumulative reward (discounted or undiscounted) obtained by following the policy over time. This is expressed as:\n\nwhere:\n\n*   œÄœÄ\\\\pi is the policy,\n*   R(st,at)R(st,at)R(s\\_t, a\\_t) is the reward obtained at time step ttt,\n*   Œ≥Œ≥\\\\gamma is the discount factor (0 ‚â§ Œ≥ ‚â§ 1),\n*   and the expectation is taken over all possible trajectories the policy might follow.\n\n**Sample Efficiency**: RL methods often require many interactions with the environment to train, and sample efficiency measures how well a policy performs given a limited number of interactions.\n\n**Stability and Robustness**: Evaluating if the policy consistently achieves good performance under different conditions or in the presence of uncertainties, such as noise in the environment or policy execution errors.\n\nHowever, real-world deployment of RL agents might come with risks. For instance, in healthcare, trying an untested policy could harm patients. Hence, the need for offline policy evaluation (OPE) arises.",
    "order": 24,
    "orderInChapter": 1,
    "difficulty": 4,
    "estimatedMinutes": 3,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 504,
      "contentLength": 41738
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#online-policy-evaluation",
    "scrapedAt": "2025-12-28T11:47:08.462Z"
  },
  {
    "id": "ai-reinforcement-learning-offline-policy-evaluation-ope-25",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Policy Evaluation",
    "title": "Offline Policy Evaluation (OPE)",
    "subtitle": "Policy Evaluation",
    "contentHtml": "<ul>\n  <li>Offline Policy Evaluation (OPE), also referred to as Off-policy Evaluation, aims to estimate the performance of a new or learned policy using data collected by some behavior policy (i.e., an earlier or different policy used for gathering data). OPE methods allow us to estimate the performance without executing the policy in the real environment.</li>\n</ul>\n<h4 id=\"key-challenges-in-ope\">Key Challenges in OPE</h4>\n<ul>\n  <li><strong>Distribution Mismatch</strong>: The behavior policy that generated the data might be very different from the target policy we are evaluating. This can cause inaccuracies because the data may not cover the state-action space sufficiently for the new policy.</li>\n  <li><strong>Confounding Bias</strong>: Logged data can introduce bias when certain actions or states are under-sampled or never seen in the dataset, which leads to poor estimation of the target policy.</li>\n</ul>\n<h4 id=\"common-ope-methods\">Common OPE Methods</h4>",
    "contentMarkdown": "*   Offline Policy Evaluation (OPE), also referred to as Off-policy Evaluation, aims to estimate the performance of a new or learned policy using data collected by some behavior policy (i.e., an earlier or different policy used for gathering data). OPE methods allow us to estimate the performance without executing the policy in the real environment.\n\n#### Key Challenges in OPE\n\n*   **Distribution Mismatch**: The behavior policy that generated the data might be very different from the target policy we are evaluating. This can cause inaccuracies because the data may not cover the state-action space sufficiently for the new policy.\n*   **Confounding Bias**: Logged data can introduce bias when certain actions or states are under-sampled or never seen in the dataset, which leads to poor estimation of the target policy.\n\n#### Common OPE Methods",
    "order": 25,
    "orderInChapter": 2,
    "difficulty": 3,
    "estimatedMinutes": 1,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 133,
      "contentLength": 975
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#offline-policy-evaluation-(ope)",
    "scrapedAt": "2025-12-28T11:47:08.462Z"
  },
  {
    "id": "ai-reinforcement-learning-direct-method-dm-26",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Policy Evaluation",
    "title": "Direct Method (DM)",
    "subtitle": "Policy Evaluation",
    "contentHtml": "<ul>\n  <li>The direct method uses a supervised learning model (such as a regression model) to estimate the expected rewards for state-action pairs based on the data from the behavior policy. Once the model is trained, it is used to predict the rewards the target policy would obtain.</li>\n  <li><strong>Steps:</strong>\n    <ul>\n      <li>Train a model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-412-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>R</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6477\" style=\"width: 3.128em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.607em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1002.55em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6478\"><span class=\"texatom\" id=\"MathJax-Span-6479\"><span class=\"mrow\" id=\"MathJax-Span-6480\"><span class=\"munderover\" id=\"MathJax-Span-6481\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6482\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-6483\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6484\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6485\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-6486\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6487\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-6488\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>R</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-412\">\\hat{R}(s,a)</script> using logged data to predict the reward for any state-action pair.</li>\n      <li>Simulate the expected return of the target policy by averaging over the predicted rewards for actions it would take under different states in the dataset.</li>\n    </ul>\n  </li>\n  <li><strong>Advantages</strong>:\n    <ul>\n      <li>Simple and easy to implement.</li>\n      <li>Can generalize to new state-action pairs not observed in the logged data.</li>\n    </ul>\n  </li>\n  <li><strong>Disadvantages</strong>:\n    <ul>\n      <li>Sensitive to model accuracy, and any modeling error can lead to incorrect estimates.</li>\n      <li>Can suffer from extrapolation errors if the target policy takes actions that are very different from the logged data.</li>\n    </ul>\n  </li>\n</ul>\n<ul>\n      <li>Train a model <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-412-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>R</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6477\" style=\"width: 3.128em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.607em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.096em, 1002.55em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6478\"><span class=\"texatom\" id=\"MathJax-Span-6479\"><span class=\"mrow\" id=\"MathJax-Span-6480\"><span class=\"munderover\" id=\"MathJax-Span-6481\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6482\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-6483\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6484\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6485\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-6486\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6487\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-6488\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.503em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>R</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-412\">\\hat{R}(s,a)</script> using logged data to predict the reward for any state-action pair.</li>\n      <li>Simulate the expected return of the target policy by averaging over the predicted rewards for actions it would take under different states in the dataset.</li>\n    </ul>\n<ul>\n      <li>Simple and easy to implement.</li>\n      <li>Can generalize to new state-action pairs not observed in the logged data.</li>\n    </ul>\n<ul>\n      <li>Sensitive to model accuracy, and any modeling error can lead to incorrect estimates.</li>\n      <li>Can suffer from extrapolation errors if the target policy takes actions that are very different from the logged data.</li>\n    </ul>",
    "contentMarkdown": "*   The direct method uses a supervised learning model (such as a regression model) to estimate the expected rewards for state-action pairs based on the data from the behavior policy. Once the model is trained, it is used to predict the rewards the target policy would obtain.\n*   **Steps:**\n    *   Train a model RÃÇ¬†(s,a)R^(s,a)\\\\hat{R}(s,a) using logged data to predict the reward for any state-action pair.\n    *   Simulate the expected return of the target policy by averaging over the predicted rewards for actions it would take under different states in the dataset.\n*   **Advantages**:\n    *   Simple and easy to implement.\n    *   Can generalize to new state-action pairs not observed in the logged data.\n*   **Disadvantages**:\n    *   Sensitive to model accuracy, and any modeling error can lead to incorrect estimates.\n    *   Can suffer from extrapolation errors if the target policy takes actions that are very different from the logged data.\n\n*   Train a model RÃÇ¬†(s,a)R^(s,a)\\\\hat{R}(s,a) using logged data to predict the reward for any state-action pair.\n*   Simulate the expected return of the target policy by averaging over the predicted rewards for actions it would take under different states in the dataset.\n\n*   Simple and easy to implement.\n*   Can generalize to new state-action pairs not observed in the logged data.\n\n*   Sensitive to model accuracy, and any modeling error can lead to incorrect estimates.\n*   Can suffer from extrapolation errors if the target policy takes actions that are very different from the logged data.",
    "order": 26,
    "orderInChapter": 3,
    "difficulty": 4,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "supervised learning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 245,
      "contentLength": 7793
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#direct-method-(dm)",
    "scrapedAt": "2025-12-28T11:47:08.462Z"
  },
  {
    "id": "ai-reinforcement-learning-importance-sampling-is-27",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Policy Evaluation",
    "title": "Importance Sampling (IS)",
    "subtitle": "Policy Evaluation",
    "contentHtml": "<ul>\n  <li>\n    <p>Importance sampling is one of the most widely used methods in OPE. It reweights the rewards in the logged data by the likelihood ratio between the target policy and the behavior policy. The intuition is that the rewards observed from the behavior policy are ‚Äúcorrected‚Äù to reflect what would have happened if the target policy had been followed.</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-413-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>J</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi></mrow></munderover><mfrac><mrow><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi>&amp;#x03BC;</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6489\" style=\"width: 13.909em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 11.565em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.263em, 1011.51em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6490\"><span class=\"texatom\" id=\"MathJax-Span-6491\"><span class=\"mrow\" id=\"MathJax-Span-6492\"><span class=\"munderover\" id=\"MathJax-Span-6493\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6494\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-6495\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6496\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6497\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6498\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6499\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-6500\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-6501\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.94em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-6502\"><span class=\"mrow\" id=\"MathJax-Span-6503\"><span class=\"mi\" id=\"MathJax-Span-6504\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-6505\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-6506\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.52em, 4.169em, -999.997em); top: -5.206em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-6507\"><span class=\"mrow\" id=\"MathJax-Span-6508\"><span class=\"mi\" id=\"MathJax-Span-6509\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mfrac\" id=\"MathJax-Span-6510\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 3.648em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.49em, 4.378em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.768em;\"><span class=\"mrow\" id=\"MathJax-Span-6511\"><span class=\"mi\" id=\"MathJax-Span-6512\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6513\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6514\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6515\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6516\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6517\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-6518\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6519\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6520\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6521\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1003.49em, 4.378em, -999.997em); top: -3.331em; left: 50%; margin-left: -1.768em;\"><span class=\"mrow\" id=\"MathJax-Span-6522\"><span class=\"mi\" id=\"MathJax-Span-6523\" style=\"font-family: STIXGeneral-Italic;\">Œº</span><span class=\"mo\" id=\"MathJax-Span-6524\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6525\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6526\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6527\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6528\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-6529\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6530\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6531\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6532\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.65em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.648em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"mi\" id=\"MathJax-Span-6533\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-6534\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6535\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6536\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6537\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6538\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-6539\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6540\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6541\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6542\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>J</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><mi>œÄ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>N</mi></mrow></munderover><mfrac><mrow><mi>œÄ</mi><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><mi>Œº</mi><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac><mi>R</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-413\">\\hat{J}(\\pi) = \\sum_{i=1}^{N} \\frac{\\pi(a_i \\mid s_i)}{\\mu(a_i \\mid s_i)} R(s_i, a_i)</script>\n\n    <ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-414-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03BC;</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>i</mi></msub><mtext>&amp;#xA0;</mtext><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6543\" style=\"width: 4.586em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.805em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.75em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6544\"><span class=\"mi\" id=\"MathJax-Span-6545\" style=\"font-family: STIXGeneral-Italic;\">Œº</span><span class=\"mo\" id=\"MathJax-Span-6546\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6547\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6548\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6549\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mtext\" id=\"MathJax-Span-6550\" style=\"font-family: STIXGeneral-Regular;\">&nbsp;</span><span class=\"mo\" id=\"MathJax-Span-6551\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-6552\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6553\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6554\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6555\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œº</mi><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>i</mi></msub><mtext>&nbsp;</mtext><mo>‚à£</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-414\">\\mu(a_i\\ \\mid s_i)</script> is the probability of the action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-415-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6556\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6557\"><span class=\"msubsup\" id=\"MathJax-Span-6558\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6559\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6560\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-415\">a_i</script> being taken under the behavior policy, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-416-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>i</mi></msub><mtext>&amp;#xA0;</mtext><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6561\" style=\"width: 4.638em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.857em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.8em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6562\"><span class=\"mi\" id=\"MathJax-Span-6563\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6564\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6565\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6566\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6567\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mtext\" id=\"MathJax-Span-6568\" style=\"font-family: STIXGeneral-Regular;\">&nbsp;</span><span class=\"mo\" id=\"MathJax-Span-6569\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-6570\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6571\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6572\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6573\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>i</mi></msub><mtext>&nbsp;</mtext><mo>‚à£</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-416\">\\pi(a_i\\ \\mid s_i)</script> is the probability under the target policy.</li>\n    </ul>\n  </li>\n  <li><strong>Advantages</strong>:\n    <ul>\n      <li>Does not require a model of the reward or transition dynamics, only knowledge of the behavior policy.</li>\n      <li>Corrects for the distribution mismatch between the behavior policy and the target policy.</li>\n    </ul>\n  </li>\n  <li><strong>Disadvantages</strong>:\n    <ul>\n      <li>High variance when the behavior and target policies differ significantly.</li>\n      <li>Prone to large importance weights that dominate the estimation, making it unstable for long horizons.</li>\n    </ul>\n  </li>\n</ul>\n<p>Importance sampling is one of the most widely used methods in OPE. It reweights the rewards in the logged data by the likelihood ratio between the target policy and the behavior policy. The intuition is that the rewards observed from the behavior policy are ‚Äúcorrected‚Äù to reflect what would have happened if the target policy had been followed.</p>\n<ul>\n      <li>where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-414-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03BC;</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>i</mi></msub><mtext>&amp;#xA0;</mtext><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6543\" style=\"width: 4.586em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.805em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.75em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6544\"><span class=\"mi\" id=\"MathJax-Span-6545\" style=\"font-family: STIXGeneral-Italic;\">Œº</span><span class=\"mo\" id=\"MathJax-Span-6546\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6547\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6548\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6549\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mtext\" id=\"MathJax-Span-6550\" style=\"font-family: STIXGeneral-Regular;\">&nbsp;</span><span class=\"mo\" id=\"MathJax-Span-6551\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-6552\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6553\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6554\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6555\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œº</mi><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>i</mi></msub><mtext>&nbsp;</mtext><mo>‚à£</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-414\">\\mu(a_i\\ \\mid s_i)</script> is the probability of the action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-415-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>a</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6556\" style=\"width: 0.94em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1000.78em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6557\"><span class=\"msubsup\" id=\"MathJax-Span-6558\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6559\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6560\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-415\">a_i</script> being taken under the behavior policy, and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-416-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>i</mi></msub><mtext>&amp;#xA0;</mtext><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6561\" style=\"width: 4.638em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.857em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.8em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6562\"><span class=\"mi\" id=\"MathJax-Span-6563\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6564\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6565\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6566\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6567\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mtext\" id=\"MathJax-Span-6568\" style=\"font-family: STIXGeneral-Regular;\">&nbsp;</span><span class=\"mo\" id=\"MathJax-Span-6569\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-6570\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6571\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6572\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6573\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>i</mi></msub><mtext>&nbsp;</mtext><mo>‚à£</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-416\">\\pi(a_i\\ \\mid s_i)</script> is the probability under the target policy.</li>\n    </ul>\n<ul>\n      <li>Does not require a model of the reward or transition dynamics, only knowledge of the behavior policy.</li>\n      <li>Corrects for the distribution mismatch between the behavior policy and the target policy.</li>\n    </ul>\n<ul>\n      <li>High variance when the behavior and target policies differ significantly.</li>\n      <li>Prone to large importance weights that dominate the estimation, making it unstable for long horizons.</li>\n    </ul>",
    "contentMarkdown": "*   Importance sampling is one of the most widely used methods in OPE. It reweights the rewards in the logged data by the likelihood ratio between the target policy and the behavior policy. The intuition is that the rewards observed from the behavior policy are ‚Äúcorrected‚Äù to reflect what would have happened if the target policy had been followed.\n    \n    JÃÇ¬†(œÄ)\\=‚àëi\\=1NœÄ(ai‚à£si)Œº(ai‚à£si)R(si,ai)J^(œÄ)\\=‚àëi\\=1NœÄ(ai‚à£si)Œº(ai‚à£si)R(si,ai)\n    \n    \\\\hat{J}(\\\\pi) = \\\\sum\\_{i=1}^{N} \\\\frac{\\\\pi(a\\_i \\\\mid s\\_i)}{\\\\mu(a\\_i \\\\mid s\\_i)} R(s\\_i, a\\_i)\n    *   where Œº(ai¬†‚à£si)Œº(ai¬†‚à£si)\\\\mu(a\\_i\\\\ \\\\mid s\\_i) is the probability of the action aiaia\\_i being taken under the behavior policy, and œÄ(ai¬†‚à£si)œÄ(ai¬†‚à£si)\\\\pi(a\\_i\\\\ \\\\mid s\\_i) is the probability under the target policy.\n*   **Advantages**:\n    *   Does not require a model of the reward or transition dynamics, only knowledge of the behavior policy.\n    *   Corrects for the distribution mismatch between the behavior policy and the target policy.\n*   **Disadvantages**:\n    *   High variance when the behavior and target policies differ significantly.\n    *   Prone to large importance weights that dominate the estimation, making it unstable for long horizons.\n\nImportance sampling is one of the most widely used methods in OPE. It reweights the rewards in the logged data by the likelihood ratio between the target policy and the behavior policy. The intuition is that the rewards observed from the behavior policy are ‚Äúcorrected‚Äù to reflect what would have happened if the target policy had been followed.\n\n*   where Œº(ai¬†‚à£si)Œº(ai¬†‚à£si)\\\\mu(a\\_i\\\\ \\\\mid s\\_i) is the probability of the action aiaia\\_i being taken under the behavior policy, and œÄ(ai¬†‚à£si)œÄ(ai¬†‚à£si)\\\\pi(a\\_i\\\\ \\\\mid s\\_i) is the probability under the target policy.\n\n*   Does not require a model of the reward or transition dynamics, only knowledge of the behavior policy.\n*   Corrects for the distribution mismatch between the behavior policy and the target policy.\n\n*   High variance when the behavior and target policies differ significantly.\n*   Prone to large importance weights that dominate the estimation, making it unstable for long horizons.",
    "order": 27,
    "orderInChapter": 4,
    "difficulty": 4,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 317,
      "contentLength": 31916
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#importance-sampling-(is)",
    "scrapedAt": "2025-12-28T11:47:08.462Z"
  },
  {
    "id": "ai-reinforcement-learning-doubly-robust-dr-28",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Policy Evaluation",
    "title": "Doubly Robust (DR)",
    "subtitle": "Policy Evaluation",
    "contentHtml": "<ul>\n  <li>The doubly robust method combines the direct method (DM) and importance sampling (IS) to leverage the strengths of both. It reduces the variance compared to IS and the bias compared to DM. The DR estimator uses a model to estimate the reward (as in DM), but it also uses importance sampling to adjust for any inaccuracies in the model.</li>\n  <li>\n    <p>The DR estimator can be expressed as:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-417-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>J</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi></mrow></munderover><mrow><mo>(</mo><mrow><mfrac><mrow><mi>&amp;#x03C0;</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mi>&amp;#x03BC;</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mo stretchy=&quot;false&quot;>(</mo><mi>R</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>R</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>R</mi><mo stretchy=&quot;false&quot;>&amp;#x005E;</mo></mover></mrow><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mo>)</mo></mrow></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6574\" style=\"width: 26.669em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 22.19em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.878em, 1022.03em, 5.211em, -999.997em); top: -3.799em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6575\"><span class=\"texatom\" id=\"MathJax-Span-6576\"><span class=\"mrow\" id=\"MathJax-Span-6577\"><span class=\"munderover\" id=\"MathJax-Span-6578\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6579\" style=\"font-family: STIXGeneral-Italic;\">J<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-6580\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6581\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6582\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6583\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6584\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-6585\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-6586\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1000.94em, 4.273em, -999.997em); top: -2.862em; left: 0.107em;\"><span class=\"texatom\" id=\"MathJax-Span-6587\"><span class=\"mrow\" id=\"MathJax-Span-6588\"><span class=\"mi\" id=\"MathJax-Span-6589\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-6590\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-6591\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.284em, 1000.52em, 4.169em, -999.997em); top: -5.206em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-6592\"><span class=\"mrow\" id=\"MathJax-Span-6593\"><span class=\"mi\" id=\"MathJax-Span-6594\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">N<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mrow\" id=\"MathJax-Span-6595\" style=\"padding-left: 0.211em;\"><span class=\"mo\" id=\"MathJax-Span-6596\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">(</span></span></span><span class=\"mrow\" id=\"MathJax-Span-6597\"><span class=\"mfrac\" id=\"MathJax-Span-6598\"><span style=\"display: inline-block; position: relative; width: 3.648em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;\"><span style=\"position: absolute; clip: rect(3.18em, 1003.49em, 4.378em, -999.997em); top: -4.685em; left: 50%; margin-left: -1.768em;\"><span class=\"mrow\" id=\"MathJax-Span-6599\"><span class=\"mi\" id=\"MathJax-Span-6600\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6601\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6602\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6603\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6604\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6605\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-6606\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6607\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6608\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6609\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.18em, 1003.49em, 4.378em, -999.997em); top: -3.331em; left: 50%; margin-left: -1.768em;\"><span class=\"mrow\" id=\"MathJax-Span-6610\"><span class=\"mi\" id=\"MathJax-Span-6611\" style=\"font-family: STIXGeneral-Italic;\">Œº</span><span class=\"mo\" id=\"MathJax-Span-6612\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6613\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6614\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6615\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6616\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-6617\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6618\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6619\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6620\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(0.836em, 1003.65em, 1.201em, -999.997em); top: -1.247em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.648em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.044em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6621\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6622\" style=\"font-family: STIXGeneral-Italic;\">R</span><span class=\"mo\" id=\"MathJax-Span-6623\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6624\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6625\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6626\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6627\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-6628\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6629\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6630\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6631\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6632\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"texatom\" id=\"MathJax-Span-6633\" style=\"padding-left: 0.263em;\"><span class=\"mrow\" id=\"MathJax-Span-6634\"><span class=\"munderover\" id=\"MathJax-Span-6635\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6636\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-6637\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6638\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6639\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6640\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6641\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6642\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-6643\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6644\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6645\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6646\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6647\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6648\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"texatom\" id=\"MathJax-Span-6649\" style=\"padding-left: 0.263em;\"><span class=\"mrow\" id=\"MathJax-Span-6650\"><span class=\"munderover\" id=\"MathJax-Span-6651\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6652\" style=\"font-family: STIXGeneral-Italic;\">R</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.268em; left: 0.159em;\"><span style=\"height: 0em; vertical-align: 0em; width: 0.367em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-6653\" style=\"font-family: STIXGeneral-Regular;\">ÃÇ&nbsp;<span style=\"height: 0em; vertical-align: 0em; margin-left: -0.258em;\"></span></span><span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0em;\"></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6654\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6655\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6656\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6657\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6658\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-6659\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6660\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6661\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6662\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span class=\"mo\" id=\"MathJax-Span-6663\" style=\"vertical-align: -0.466em;\"><span><span style=\"font-size: 111%; font-family: STIXSizeTwoSym;\">)</span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.805em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.753em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>J</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><mi>œÄ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>N</mi></mrow></munderover><mrow><mo>(</mo><mrow><mfrac><mrow><mi>œÄ</mi><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><mi>Œº</mi><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac><mo stretchy=\"false\">(</mo><mi>R</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>R</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>+</mo><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi>R</mi><mo stretchy=\"false\">^</mo></mover></mrow><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>)</mo></mrow></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-417\">\\hat{J}(\\pi) = \\sum_{i=1}^{N} \\left( \\frac{\\pi(a_i \\mid s_i)}{\\mu(a_i \\mid s_i)}(R(s_i, a_i) - \\hat{R}(s_i, a_i)) + \\hat{R}(s_i, a_i)\\right)</script>\n  </li>\n  <li><strong>Advantages</strong>:\n    <ul>\n      <li>More robust than either DM or IS alone.</li>\n      <li>Can handle both distribution mismatch and modeling errors better than individual methods.</li>\n    </ul>\n  </li>\n  <li><strong>Disadvantages</strong>:\n    <ul>\n      <li>Requires both a well-calibrated model and a reasonable importance weighting scheme.</li>\n      <li>Still sensitive to extreme weights in cases where the behavior policy is very different from the target policy.</li>\n    </ul>\n  </li>\n</ul>\n<p>The DR estimator can be expressed as:</p>\n<ul>\n      <li>More robust than either DM or IS alone.</li>\n      <li>Can handle both distribution mismatch and modeling errors better than individual methods.</li>\n    </ul>\n<ul>\n      <li>Requires both a well-calibrated model and a reasonable importance weighting scheme.</li>\n      <li>Still sensitive to extreme weights in cases where the behavior policy is very different from the target policy.</li>\n    </ul>",
    "contentMarkdown": "*   The doubly robust method combines the direct method (DM) and importance sampling (IS) to leverage the strengths of both. It reduces the variance compared to IS and the bias compared to DM. The DR estimator uses a model to estimate the reward (as in DM), but it also uses importance sampling to adjust for any inaccuracies in the model.\n*   The DR estimator can be expressed as:\n    \n    JÃÇ¬†(œÄ)\\=‚àëi\\=1N(œÄ(ai‚à£si)Œº(ai‚à£si)(R(si,ai)‚àíRÃÇ¬†(si,ai))+RÃÇ¬†(si,ai))J^(œÄ)\\=‚àëi\\=1N(œÄ(ai‚à£si)Œº(ai‚à£si)(R(si,ai)‚àíR^(si,ai))+R^(si,ai))\n    \n    \\\\hat{J}(\\\\pi) = \\\\sum\\_{i=1}^{N} \\\\left( \\\\frac{\\\\pi(a\\_i \\\\mid s\\_i)}{\\\\mu(a\\_i \\\\mid s\\_i)}(R(s\\_i, a\\_i) - \\\\hat{R}(s\\_i, a\\_i)) + \\\\hat{R}(s\\_i, a\\_i)\\\\right)\n*   **Advantages**:\n    *   More robust than either DM or IS alone.\n    *   Can handle both distribution mismatch and modeling errors better than individual methods.\n*   **Disadvantages**:\n    *   Requires both a well-calibrated model and a reasonable importance weighting scheme.\n    *   Still sensitive to extreme weights in cases where the behavior policy is very different from the target policy.\n\nThe DR estimator can be expressed as:\n\n*   More robust than either DM or IS alone.\n*   Can handle both distribution mismatch and modeling errors better than individual methods.\n\n*   Requires both a well-calibrated model and a reasonable importance weighting scheme.\n*   Still sensitive to extreme weights in cases where the behavior policy is very different from the target policy.",
    "order": 28,
    "orderInChapter": 5,
    "difficulty": 4,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 205,
      "contentLength": 21716
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#doubly-robust-(dr)",
    "scrapedAt": "2025-12-28T11:47:08.462Z"
  },
  {
    "id": "ai-reinforcement-learning-fitted-q-evaluation-fqe-29",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Policy Evaluation",
    "title": "Fitted Q-Evaluation (FQE)",
    "subtitle": "Policy Evaluation",
    "contentHtml": "<ul>\n  <li>\n    <p>FQE is a model-based OPE approach that estimates the expected return of the target policy by first learning the Q-values (state-action values) for the policy. It involves solving the Bellman equations iteratively over the logged data to approximate the value function of the policy. Once the Q-function is learned, the value of the target policy can be computed by evaluating the actions it would take at each state.</p>\n  </li>\n  <li><strong>Advantages</strong>:\n    <ul>\n      <li>Can work well when the Q-function is learned accurately from the data.</li>\n    </ul>\n  </li>\n  <li><strong>Disadvantages</strong>:\n    <ul>\n      <li>Requires solving a complex optimization problem.</li>\n      <li>May suffer from overfitting or underfitting depending on the quality of the data and the model.</li>\n    </ul>\n  </li>\n</ul>\n<p>FQE is a model-based OPE approach that estimates the expected return of the target policy by first learning the Q-values (state-action values) for the policy. It involves solving the Bellman equations iteratively over the logged data to approximate the value function of the policy. Once the Q-function is learned, the value of the target policy can be computed by evaluating the actions it would take at each state.</p>\n<ul>\n      <li>Can work well when the Q-function is learned accurately from the data.</li>\n    </ul>\n<ul>\n      <li>Requires solving a complex optimization problem.</li>\n      <li>May suffer from overfitting or underfitting depending on the quality of the data and the model.</li>\n    </ul>",
    "contentMarkdown": "*   FQE is a model-based OPE approach that estimates the expected return of the target policy by first learning the Q-values (state-action values) for the policy. It involves solving the Bellman equations iteratively over the logged data to approximate the value function of the policy. Once the Q-function is learned, the value of the target policy can be computed by evaluating the actions it would take at each state.\n    \n*   **Advantages**:\n    *   Can work well when the Q-function is learned accurately from the data.\n*   **Disadvantages**:\n    *   Requires solving a complex optimization problem.\n    *   May suffer from overfitting or underfitting depending on the quality of the data and the model.\n\nFQE is a model-based OPE approach that estimates the expected return of the target policy by first learning the Q-values (state-action values) for the policy. It involves solving the Bellman equations iteratively over the logged data to approximate the value function of the policy. Once the Q-function is learned, the value of the target policy can be computed by evaluating the actions it would take at each state.\n\n*   Can work well when the Q-function is learned accurately from the data.\n\n*   Requires solving a complex optimization problem.\n*   May suffer from overfitting or underfitting depending on the quality of the data and the model.",
    "order": 29,
    "orderInChapter": 6,
    "difficulty": 3,
    "estimatedMinutes": 2,
    "tags": [
      "algorithmsarchitecture",
      "llm",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 215,
      "contentLength": 1556
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#fitted-q-evaluation-(fqe)",
    "scrapedAt": "2025-12-28T11:47:08.462Z"
  },
  {
    "id": "ai-reinforcement-learning-model-based-evaluation-30",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Policy Evaluation",
    "title": "Model-based Evaluation",
    "subtitle": "Policy Evaluation",
    "contentHtml": "<ul>\n  <li>This involves constructing a model of the environment (i.e., transition dynamics and reward function) based on the logged data. The performance of a policy is then simulated within this learned model. A model-based evaluation can give insights into how the policy performs over a wide range of scenarios. However, it can be highly sensitive to inaccuracies in the model.</li>\n</ul>",
    "contentMarkdown": "*   This involves constructing a model of the environment (i.e., transition dynamics and reward function) based on the logged data. The performance of a policy is then simulated within this learned model. A model-based evaluation can give insights into how the policy performs over a wide range of scenarios. However, it can be highly sensitive to inaccuracies in the model.",
    "order": 30,
    "orderInChapter": 7,
    "difficulty": 3,
    "estimatedMinutes": 1,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 60,
      "contentLength": 392
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#model-based-evaluation",
    "scrapedAt": "2025-12-28T11:47:08.462Z"
  },
  {
    "id": "ai-reinforcement-learning-challenges-of-reinforcement-learning-31",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Policy Evaluation",
    "title": "Challenges of Reinforcement Learning",
    "subtitle": "Policy Evaluation",
    "contentHtml": "<p>While Reinforcement Learning (RL) has shown remarkable successes, particularly when combined with deep learning, it also faces several challenges that limit its widespread application in real-world settings. These challenges include issues related to exploration, sample efficiency, stability, scalability, and safety.</p>",
    "contentMarkdown": "While Reinforcement Learning (RL) has shown remarkable successes, particularly when combined with deep learning, it also faces several challenges that limit its widespread application in real-world settings. These challenges include issues related to exploration, sample efficiency, stability, scalability, and safety.",
    "order": 31,
    "orderInChapter": 8,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "algorithmsarchitecture",
      "deep learning",
      "reinforcement learning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 40,
      "contentLength": 325
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#challenges-of-reinforcement-learning",
    "scrapedAt": "2025-12-28T11:47:08.462Z"
  },
  {
    "id": "ai-reinforcement-learning-exploration-vs-exploitation-dilemma-32",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Challenges of Reinforcement Learning",
    "title": "Exploration vs. Exploitation Dilemma",
    "subtitle": "Challenges of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>One of the most fundamental challenges in RL is the balance between exploration and exploitation. The agent must explore new actions and strategies to discover potentially higher rewards, but it must also exploit known strategies that provide good rewards. Striking the right balance between exploring the environment and exploiting accumulated knowledge is a non-trivial problem, especially in environments where exploration may be costly, dangerous, or inefficient.</li>\n  <li><strong>Potential issues:</strong>\n    <ul>\n      <li>Over-exploration: Wasting time on actions that do not yield significant rewards.</li>\n      <li>Under-exploration: Missing better strategies because the agent sticks to known, sub-optimal actions.</li>\n    </ul>\n  </li>\n  <li>Solutions like <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-418-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03F5;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6664\" style=\"width: 0.523em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.419em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.42em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6665\"><span class=\"mi\" id=\"MathJax-Span-6666\" style=\"font-family: STIXGeneral-Italic;\">œµ</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œµ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-418\">\\epsilon</script>-greedy policies, upper-confidence-bound (UCB) algorithms, and Thompson sampling attempt to address this dilemma, but optimal balancing remains an open problem.</li>\n</ul>\n<ul>\n      <li>Over-exploration: Wasting time on actions that do not yield significant rewards.</li>\n      <li>Under-exploration: Missing better strategies because the agent sticks to known, sub-optimal actions.</li>\n    </ul>",
    "contentMarkdown": "*   One of the most fundamental challenges in RL is the balance between exploration and exploitation. The agent must explore new actions and strategies to discover potentially higher rewards, but it must also exploit known strategies that provide good rewards. Striking the right balance between exploring the environment and exploiting accumulated knowledge is a non-trivial problem, especially in environments where exploration may be costly, dangerous, or inefficient.\n*   **Potential issues:**\n    *   Over-exploration: Wasting time on actions that do not yield significant rewards.\n    *   Under-exploration: Missing better strategies because the agent sticks to known, sub-optimal actions.\n*   Solutions like œµœµ\\\\epsilon\\-greedy policies, upper-confidence-bound (UCB) algorithms, and Thompson sampling attempt to address this dilemma, but optimal balancing remains an open problem.\n\n*   Over-exploration: Wasting time on actions that do not yield significant rewards.\n*   Under-exploration: Missing better strategies because the agent sticks to known, sub-optimal actions.",
    "order": 32,
    "orderInChapter": 1,
    "difficulty": 5,
    "estimatedMinutes": 1,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 143,
      "contentLength": 2385
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#exploration-vs.-exploitation-dilemma",
    "scrapedAt": "2025-12-28T11:47:08.462Z"
  },
  {
    "id": "ai-reinforcement-learning-sample-inefficiency-33",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Challenges of Reinforcement Learning",
    "title": "Sample Inefficiency",
    "subtitle": "Challenges of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>RL algorithms often require vast amounts of data to learn effective policies. This is particularly problematic in environments where data collection is expensive, slow, or impractical (e.g., robotics, healthcare, or autonomous driving). For instance, training an RL agent to control a physical robot requires many iterations, and any missteps can damage hardware or cause safety risks.</li>\n  <li>Deep RL algorithms, such as DQN and PPO, have somewhat mitigated this by utilizing techniques like experience replay, but achieving sample efficiency remains a major challenge. Even state-of-the-art methods can require millions of interactions with the environment to converge on effective policies.</li>\n</ul>",
    "contentMarkdown": "*   RL algorithms often require vast amounts of data to learn effective policies. This is particularly problematic in environments where data collection is expensive, slow, or impractical (e.g., robotics, healthcare, or autonomous driving). For instance, training an RL agent to control a physical robot requires many iterations, and any missteps can damage hardware or cause safety risks.\n*   Deep RL algorithms, such as DQN and PPO, have somewhat mitigated this by utilizing techniques like experience replay, but achieving sample efficiency remains a major challenge. Even state-of-the-art methods can require millions of interactions with the environment to converge on effective policies.",
    "order": 33,
    "orderInChapter": 2,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 100,
      "contentLength": 718
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#sample-inefficiency",
    "scrapedAt": "2025-12-28T11:47:08.462Z"
  },
  {
    "id": "ai-reinforcement-learning-sparse-and-delayed-rewards-34",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Challenges of Reinforcement Learning",
    "title": "Sparse and Delayed Rewards",
    "subtitle": "Challenges of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>Many real-world RL problems involve sparse or delayed rewards, where the agent does not receive immediate feedback for its actions. For example, in a game or task where success is only achieved after many steps, the agent may struggle to learn the relationship between early actions and eventual rewards.</li>\n  <li><strong>Potential issues:</strong>\n    <ul>\n      <li>Difficulty in credit assignment: Identifying which actions were responsible for receiving a reward when the reward signal is delayed over many time steps.</li>\n      <li>Inefficient learning: The agent may require many trials to stumble upon the sequence of actions that lead to reward, prolonging the learning process.</li>\n    </ul>\n  </li>\n  <li>Techniques like reward shaping, where intermediate rewards are designed to guide the agent, and temporal credit assignment mechanisms, like eligibility traces, aim to alleviate this issue, but general solutions are still lacking.</li>\n</ul>\n<ul>\n      <li>Difficulty in credit assignment: Identifying which actions were responsible for receiving a reward when the reward signal is delayed over many time steps.</li>\n      <li>Inefficient learning: The agent may require many trials to stumble upon the sequence of actions that lead to reward, prolonging the learning process.</li>\n    </ul>",
    "contentMarkdown": "*   Many real-world RL problems involve sparse or delayed rewards, where the agent does not receive immediate feedback for its actions. For example, in a game or task where success is only achieved after many steps, the agent may struggle to learn the relationship between early actions and eventual rewards.\n*   **Potential issues:**\n    *   Difficulty in credit assignment: Identifying which actions were responsible for receiving a reward when the reward signal is delayed over many time steps.\n    *   Inefficient learning: The agent may require many trials to stumble upon the sequence of actions that lead to reward, prolonging the learning process.\n*   Techniques like reward shaping, where intermediate rewards are designed to guide the agent, and temporal credit assignment mechanisms, like eligibility traces, aim to alleviate this issue, but general solutions are still lacking.\n\n*   Difficulty in credit assignment: Identifying which actions were responsible for receiving a reward when the reward signal is delayed over many time steps.\n*   Inefficient learning: The agent may require many trials to stumble upon the sequence of actions that lead to reward, prolonging the learning process.",
    "order": 34,
    "orderInChapter": 3,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 182,
      "contentLength": 1320
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#sparse-and-delayed-rewards",
    "scrapedAt": "2025-12-28T11:47:08.462Z"
  },
  {
    "id": "ai-reinforcement-learning-high-dimensional-state-and-action-spaces-35",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Challenges of Reinforcement Learning",
    "title": "High-Dimensional State and Action Spaces",
    "subtitle": "Challenges of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>Real-world environments often have high-dimensional state and action spaces, making it difficult for traditional RL algorithms to scale effectively. For example, controlling a humanoid robot involves learning in a vast continuous action space with many degrees of freedom.</li>\n  <li><strong>Challenges:</strong>\n    <ul>\n      <li>Computational Complexity: Searching through high-dimensional spaces exponentially increases the difficulty of finding optimal policies.</li>\n      <li>Generalization: Policies learned in one high-dimensional environment often fail to generalize to similar tasks, necessitating retraining for even minor changes in the task or environment.</li>\n    </ul>\n  </li>\n  <li>Deep RL approaches using neural networks have been instrumental in tackling high-dimensional problems, but scalability and generalization across different tasks remain challenging.</li>\n</ul>\n<ul>\n      <li>Computational Complexity: Searching through high-dimensional spaces exponentially increases the difficulty of finding optimal policies.</li>\n      <li>Generalization: Policies learned in one high-dimensional environment often fail to generalize to similar tasks, necessitating retraining for even minor changes in the task or environment.</li>\n    </ul>",
    "contentMarkdown": "*   Real-world environments often have high-dimensional state and action spaces, making it difficult for traditional RL algorithms to scale effectively. For example, controlling a humanoid robot involves learning in a vast continuous action space with many degrees of freedom.\n*   **Challenges:**\n    *   Computational Complexity: Searching through high-dimensional spaces exponentially increases the difficulty of finding optimal policies.\n    *   Generalization: Policies learned in one high-dimensional environment often fail to generalize to similar tasks, necessitating retraining for even minor changes in the task or environment.\n*   Deep RL approaches using neural networks have been instrumental in tackling high-dimensional problems, but scalability and generalization across different tasks remain challenging.\n\n*   Computational Complexity: Searching through high-dimensional spaces exponentially increases the difficulty of finding optimal policies.\n*   Generalization: Policies learned in one high-dimensional environment often fail to generalize to similar tasks, necessitating retraining for even minor changes in the task or environment.",
    "order": 35,
    "orderInChapter": 4,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "algorithmsarchitecture",
      "neural network"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 146,
      "contentLength": 1271
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#high-dimensional-state-and-action-spaces",
    "scrapedAt": "2025-12-28T11:47:08.462Z"
  },
  {
    "id": "ai-reinforcement-learning-long-term-dependencies-and-credit-assignment-36",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Challenges of Reinforcement Learning",
    "title": "Long-Term Dependencies and Credit Assignment",
    "subtitle": "Challenges of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>Many RL tasks involve long-term dependencies, where actions taken early in an episode affect outcomes far into the future. Identifying which actions were beneficial or detrimental over extended time horizons is difficult due to the complexity of the temporal credit assignment.</li>\n  <li><strong>Potential issues:</strong>\n    <ul>\n      <li>Vanishing gradients in policy gradient methods can make it hard to propagate the influence of early actions on long-term rewards.</li>\n      <li>In many practical applications, this can lead to sub-optimal policies that favor immediate rewards over delayed but more substantial rewards.</li>\n    </ul>\n  </li>\n  <li>Solutions like temporal difference (TD) learning, which bootstraps from future rewards, help address this issue, but they still struggle in environments with long-term dependencies.</li>\n</ul>\n<ul>\n      <li>Vanishing gradients in policy gradient methods can make it hard to propagate the influence of early actions on long-term rewards.</li>\n      <li>In many practical applications, this can lead to sub-optimal policies that favor immediate rewards over delayed but more substantial rewards.</li>\n    </ul>",
    "contentMarkdown": "*   Many RL tasks involve long-term dependencies, where actions taken early in an episode affect outcomes far into the future. Identifying which actions were beneficial or detrimental over extended time horizons is difficult due to the complexity of the temporal credit assignment.\n*   **Potential issues:**\n    *   Vanishing gradients in policy gradient methods can make it hard to propagate the influence of early actions on long-term rewards.\n    *   In many practical applications, this can lead to sub-optimal policies that favor immediate rewards over delayed but more substantial rewards.\n*   Solutions like temporal difference (TD) learning, which bootstraps from future rewards, help address this issue, but they still struggle in environments with long-term dependencies.\n\n*   Vanishing gradients in policy gradient methods can make it hard to propagate the influence of early actions on long-term rewards.\n*   In many practical applications, this can lead to sub-optimal policies that favor immediate rewards over delayed but more substantial rewards.",
    "order": 36,
    "orderInChapter": 5,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 154,
      "contentLength": 1179
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#long-term-dependencies-and-credit-assignment",
    "scrapedAt": "2025-12-28T11:47:08.462Z"
  },
  {
    "id": "ai-reinforcement-learning-stability-and-convergence-37",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Challenges of Reinforcement Learning",
    "title": "Stability and Convergence",
    "subtitle": "Challenges of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>RL algorithms can be unstable during training, particularly when combining them with neural networks in Deep RL. This instability often arises from non-stationary data distributions, overestimation of Q-values, or large updates to the policy.</li>\n  <li><strong>Potential issues:</strong>\n    <ul>\n      <li>Divergence: In some cases, the algorithm may fail to converge at all, especially in more complex environments with high variability.</li>\n      <li>Sensitivity to Hyperparameters: Many RL algorithms are highly sensitive to hyperparameter settings like learning rate, discount factor, and exploration-exploitation trade-offs. Tuning these parameters requires extensive experimentation, which may be impractical in many domains.</li>\n    </ul>\n  </li>\n  <li>Techniques like target networks (in DQN) and trust region methods (in PPO and TRPO) have been developed to address instability, but robustness across different tasks and environments is still not fully guaranteed.</li>\n</ul>\n<ul>\n      <li>Divergence: In some cases, the algorithm may fail to converge at all, especially in more complex environments with high variability.</li>\n      <li>Sensitivity to Hyperparameters: Many RL algorithms are highly sensitive to hyperparameter settings like learning rate, discount factor, and exploration-exploitation trade-offs. Tuning these parameters requires extensive experimentation, which may be impractical in many domains.</li>\n    </ul>",
    "contentMarkdown": "*   RL algorithms can be unstable during training, particularly when combining them with neural networks in Deep RL. This instability often arises from non-stationary data distributions, overestimation of Q-values, or large updates to the policy.\n*   **Potential issues:**\n    *   Divergence: In some cases, the algorithm may fail to converge at all, especially in more complex environments with high variability.\n    *   Sensitivity to Hyperparameters: Many RL algorithms are highly sensitive to hyperparameter settings like learning rate, discount factor, and exploration-exploitation trade-offs. Tuning these parameters requires extensive experimentation, which may be impractical in many domains.\n*   Techniques like target networks (in DQN) and trust region methods (in PPO and TRPO) have been developed to address instability, but robustness across different tasks and environments is still not fully guaranteed.\n\n*   Divergence: In some cases, the algorithm may fail to converge at all, especially in more complex environments with high variability.\n*   Sensitivity to Hyperparameters: Many RL algorithms are highly sensitive to hyperparameter settings like learning rate, discount factor, and exploration-exploitation trade-offs. Tuning these parameters requires extensive experimentation, which may be impractical in many domains.",
    "order": 37,
    "orderInChapter": 6,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "algorithmsarchitecture",
      "neural network"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 181,
      "contentLength": 1456
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#stability-and-convergence",
    "scrapedAt": "2025-12-28T11:47:08.462Z"
  },
  {
    "id": "ai-reinforcement-learning-safety-and-ethical-concerns-38",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Challenges of Reinforcement Learning",
    "title": "Safety and Ethical Concerns",
    "subtitle": "Challenges of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>In certain applications, the exploration required for RL may introduce safety risks. For example, in autonomous vehicles, allowing the agent to explore dangerous or unknown actions could result in harmful accidents. Similarly, in healthcare, deploying untested policies can have severe consequences.</li>\n  <li><strong>Ethical challenges</strong>:\n    <ul>\n      <li>Balancing exploration without causing harm or incurring excessive cost.</li>\n      <li>Ensuring fairness and avoiding biased decisions when RL algorithms interact with people or sensitive systems.</li>\n    </ul>\n  </li>\n  <li>Safe RL, which aims to ensure that agents operate within predefined safety constraints, is an active area of research. However, designing algorithms that guarantee safe behavior while still learning effectively is a difficult challenge.</li>\n</ul>\n<ul>\n      <li>Balancing exploration without causing harm or incurring excessive cost.</li>\n      <li>Ensuring fairness and avoiding biased decisions when RL algorithms interact with people or sensitive systems.</li>\n    </ul>",
    "contentMarkdown": "*   In certain applications, the exploration required for RL may introduce safety risks. For example, in autonomous vehicles, allowing the agent to explore dangerous or unknown actions could result in harmful accidents. Similarly, in healthcare, deploying untested policies can have severe consequences.\n*   **Ethical challenges**:\n    *   Balancing exploration without causing harm or incurring excessive cost.\n    *   Ensuring fairness and avoiding biased decisions when RL algorithms interact with people or sensitive systems.\n*   Safe RL, which aims to ensure that agents operate within predefined safety constraints, is an active area of research. However, designing algorithms that guarantee safe behavior while still learning effectively is a difficult challenge.\n\n*   Balancing exploration without causing harm or incurring excessive cost.\n*   Ensuring fairness and avoiding biased decisions when RL algorithms interact with people or sensitive systems.",
    "order": 38,
    "orderInChapter": 7,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "algorithmsarchitecture"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 132,
      "contentLength": 1078
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#safety-and-ethical-concerns",
    "scrapedAt": "2025-12-28T11:47:08.463Z"
  },
  {
    "id": "ai-reinforcement-learning-generalization-and-transfer-learning-39",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Challenges of Reinforcement Learning",
    "title": "Generalization and Transfer Learning",
    "subtitle": "Challenges of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>One of the significant hurdles in RL is that agents trained in one environment often struggle to generalize to new or slightly different environments. For example, an agent trained to play one level of a video game may perform poorly when confronted with a new level with a similar structure.</li>\n  <li><strong>Challenges:</strong>\n    <ul>\n      <li>Domain adaptation: Policies learned in one domain often fail to generalize to related domains without extensive retraining.</li>\n      <li>Transfer learning: While transfer learning has shown promise in supervised learning, applying it effectively in RL is still challenging due to the unique structure of RL tasks.</li>\n    </ul>\n  </li>\n  <li>Research into transfer RL and meta-RL aims to develop agents that can quickly adapt to new environments or learn general policies that apply across multiple tasks, but this remains an evolving area.</li>\n</ul>\n<ul>\n      <li>Domain adaptation: Policies learned in one domain often fail to generalize to related domains without extensive retraining.</li>\n      <li>Transfer learning: While transfer learning has shown promise in supervised learning, applying it effectively in RL is still challenging due to the unique structure of RL tasks.</li>\n    </ul>",
    "contentMarkdown": "*   One of the significant hurdles in RL is that agents trained in one environment often struggle to generalize to new or slightly different environments. For example, an agent trained to play one level of a video game may perform poorly when confronted with a new level with a similar structure.\n*   **Challenges:**\n    *   Domain adaptation: Policies learned in one domain often fail to generalize to related domains without extensive retraining.\n    *   Transfer learning: While transfer learning has shown promise in supervised learning, applying it effectively in RL is still challenging due to the unique structure of RL tasks.\n*   Research into transfer RL and meta-RL aims to develop agents that can quickly adapt to new environments or learn general policies that apply across multiple tasks, but this remains an evolving area.\n\n*   Domain adaptation: Policies learned in one domain often fail to generalize to related domains without extensive retraining.\n*   Transfer learning: While transfer learning has shown promise in supervised learning, applying it effectively in RL is still challenging due to the unique structure of RL tasks.",
    "order": 39,
    "orderInChapter": 8,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "algorithmsarchitecture",
      "supervised learning",
      "transfer learning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 178,
      "contentLength": 1263
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#generalization-and-transfer-learning",
    "scrapedAt": "2025-12-28T11:47:08.463Z"
  },
  {
    "id": "ai-reinforcement-learning-computational-resources-and-scalability-40",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Challenges of Reinforcement Learning",
    "title": "Computational Resources and Scalability",
    "subtitle": "Challenges of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>Training RL models, especially deep RL models, can be computationally expensive. The training process often requires significant computational power, including the use of GPUs or TPUs for large-scale simulations and experiments.</li>\n  <li><strong>Challenges:</strong>\n    <ul>\n      <li>Hardware Requirements: Training sophisticated RL agents in complex environments, such as 3D simulations or high-resolution video games, demands substantial computational resources.</li>\n      <li>Parallelization: While parallelizing environment interactions can speed up learning, many RL algorithms do not naturally parallelize well, limiting their scalability.</li>\n    </ul>\n  </li>\n  <li>Tools like OpenAI‚Äôs Distributed Proximal Policy Optimization (DPPO) and Ray RLlib aim to address these issues by enabling scalable, distributed RL, but efficient use of resources remains a challenge.</li>\n</ul>\n<ul>\n      <li>Hardware Requirements: Training sophisticated RL agents in complex environments, such as 3D simulations or high-resolution video games, demands substantial computational resources.</li>\n      <li>Parallelization: While parallelizing environment interactions can speed up learning, many RL algorithms do not naturally parallelize well, limiting their scalability.</li>\n    </ul>",
    "contentMarkdown": "*   Training RL models, especially deep RL models, can be computationally expensive. The training process often requires significant computational power, including the use of GPUs or TPUs for large-scale simulations and experiments.\n*   **Challenges:**\n    *   Hardware Requirements: Training sophisticated RL agents in complex environments, such as 3D simulations or high-resolution video games, demands substantial computational resources.\n    *   Parallelization: While parallelizing environment interactions can speed up learning, many RL algorithms do not naturally parallelize well, limiting their scalability.\n*   Tools like OpenAI‚Äôs Distributed Proximal Policy Optimization (DPPO) and Ray RLlib aim to address these issues by enabling scalable, distributed RL, but efficient use of resources remains a challenge.\n\n*   Hardware Requirements: Training sophisticated RL agents in complex environments, such as 3D simulations or high-resolution video games, demands substantial computational resources.\n*   Parallelization: While parallelizing environment interactions can speed up learning, many RL algorithms do not naturally parallelize well, limiting their scalability.",
    "order": 40,
    "orderInChapter": 9,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "algorithmsarchitecture",
      "optimization"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 150,
      "contentLength": 1294
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#computational-resources-and-scalability",
    "scrapedAt": "2025-12-28T11:47:08.463Z"
  },
  {
    "id": "ai-reinforcement-learning-reward-function-design-41",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "Challenges of Reinforcement Learning",
    "title": "Reward Function Design",
    "subtitle": "Challenges of Reinforcement Learning",
    "contentHtml": "<ul>\n  <li>Designing the reward function is a crucial and challenging part of RL. An improperly designed reward function can lead to unintended behavior, where the agent optimizes for a reward that doesn‚Äôt align with the true objective.</li>\n  <li><strong>Challenges:</strong>\n    <ul>\n      <li>Reward Hacking: Agents may exploit loopholes in the reward function to achieve high rewards without performing the intended task correctly.</li>\n      <li>Misaligned Objectives: In complex tasks, defining a reward that accurately captures the desired behavior can be extremely difficult.</li>\n    </ul>\n  </li>\n  <li>Approaches such as inverse reinforcement learning (IRL), where the agent learns the reward function from expert demonstrations, and reward shaping are used to mitigate these issues, but finding robust solutions remains difficult.</li>\n</ul>\n<ul>\n      <li>Reward Hacking: Agents may exploit loopholes in the reward function to achieve high rewards without performing the intended task correctly.</li>\n      <li>Misaligned Objectives: In complex tasks, defining a reward that accurately captures the desired behavior can be extremely difficult.</li>\n    </ul>",
    "contentMarkdown": "*   Designing the reward function is a crucial and challenging part of RL. An improperly designed reward function can lead to unintended behavior, where the agent optimizes for a reward that doesn‚Äôt align with the true objective.\n*   **Challenges:**\n    *   Reward Hacking: Agents may exploit loopholes in the reward function to achieve high rewards without performing the intended task correctly.\n    *   Misaligned Objectives: In complex tasks, defining a reward that accurately captures the desired behavior can be extremely difficult.\n*   Approaches such as inverse reinforcement learning (IRL), where the agent learns the reward function from expert demonstrations, and reward shaping are used to mitigate these issues, but finding robust solutions remains difficult.\n\n*   Reward Hacking: Agents may exploit loopholes in the reward function to achieve high rewards without performing the intended task correctly.\n*   Misaligned Objectives: In complex tasks, defining a reward that accurately captures the desired behavior can be extremely difficult.",
    "order": 41,
    "orderInChapter": 10,
    "difficulty": 4,
    "estimatedMinutes": 1,
    "tags": [
      "algorithmsarchitecture",
      "reinforcement learning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": false,
      "hasImages": false,
      "wordCount": 152,
      "contentLength": 1171
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#reward-function-design",
    "scrapedAt": "2025-12-28T11:47:08.463Z"
  },
  {
    "id": "ai-reinforcement-learning-what-are-the-differences-between-the-value-return--42",
    "domain": "ai_primers",
    "category": "Algorithms/Architecture",
    "article": "Reinforcement Learning",
    "articleSlug": "reinforcement-learning",
    "chapter": "FAQs",
    "title": "What are the Differences Between the Value, Return, and Advantage Function?",
    "subtitle": "FAQs",
    "contentHtml": "<ul>\n  <li>Here‚Äôs a detailed explanation of the <strong>differences between the Value function, Return, and Advantage function</strong> in reinforcement learning, including their definitions, mathematical forms, and conceptual distinctions.</li>\n</ul>\n<h4 id=\"return-g\">Return (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-419-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6667\" style=\"width: 0.877em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.71em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.377em, 1000.71em, 2.294em, -999.998em); top: -2.165em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6668\"><span class=\"mi\" id=\"MathJax-Span-6669\" style=\"font-family: STIXGeneral-Italic;\">G</span></span><span style=\"display: inline-block; width: 0px; height: 2.169em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.903em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>G</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-419\">G</script>)</h4>\n<ul>\n  <li><strong>Definition:</strong>\n    <ul>\n      <li>The <strong>return</strong> represents the observed <strong>total accumulated reward</strong> (often discounted) that an agent receives after a certain time step within a <em>single trajectory</em>.</li>\n      <li>It quantifies the actual outcome of one specific episode or rollout.</li>\n      <li>\n        <p>It is the foundational quantity from which value and advantage functions are derived.</p>\n      </li>\n      <li>\n        <p>Mathematically, for time step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-420-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6670\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6671\"><span class=\"mi\" id=\"MathJax-Span-6672\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-420\">t</script>:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-421-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mi>k</mi></msup><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>k</mi></mrow></msub></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6673\" style=\"width: 7.294em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.044em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.419em, 1006.04em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6674\"><span class=\"msubsup\" id=\"MathJax-Span-6675\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6676\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-6677\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6678\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-6679\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-6680\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.15em, 4.273em, -999.997em); top: -2.862em; left: 0.055em;\"><span class=\"texatom\" id=\"MathJax-Span-6681\"><span class=\"mrow\" id=\"MathJax-Span-6682\"><span class=\"mi\" id=\"MathJax-Span-6683\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6684\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-6685\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -5.206em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-6686\"><span class=\"mrow\" id=\"MathJax-Span-6687\"><span class=\"mi\" id=\"MathJax-Span-6688\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àû</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-6689\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6690\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6691\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-6692\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6693\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-6694\"><span class=\"mrow\" id=\"MathJax-Span-6695\"><span class=\"mi\" id=\"MathJax-Span-6696\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6697\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-6698\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">‚àû</mi></mrow></munderover><msup><mi>Œ≥</mi><mi>k</mi></msup><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mi>k</mi></mrow></msub></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-421\">G_t = \\sum_{k=0}^{\\infty} \\gamma^k r_{t+k}</script>\n      </li>\n      <li>\n        <p>where:</p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-422-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>k</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6699\" style=\"width: 1.773em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.46em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6700\"><span class=\"msubsup\" id=\"MathJax-Span-6701\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6702\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-6703\"><span class=\"mrow\" id=\"MathJax-Span-6704\"><span class=\"mi\" id=\"MathJax-Span-6705\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6706\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-6707\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mi>k</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-422\">r_{t+k}</script> is the reward received <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-423-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6708\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6709\"><span class=\"mi\" id=\"MathJax-Span-6710\" style=\"font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>k</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-423\">k</script> steps after time <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-424-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6711\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6712\"><span class=\"mi\" id=\"MathJax-Span-6713\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-424\">t</script>,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-425-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi><mo>&amp;#x2208;</mo><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6714\" style=\"width: 4.69em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.909em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.86em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6715\"><span class=\"mi\" id=\"MathJax-Span-6716\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6717\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àà</span><span class=\"mo\" id=\"MathJax-Span-6718\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">[</span><span class=\"mn\" id=\"MathJax-Span-6719\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-6720\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-6721\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-6722\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi><mo>‚àà</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-425\">\\gamma \\in [0,1)</script> is the <strong>discount factor</strong>, weighting immediate rewards more heavily than distant ones.</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Intuition:</strong></p>\n\n    <ul>\n      <li>The return quantifies <em>‚Äúhow much total reward the agent will get from now on.‚Äù</em></li>\n      <li>It depends directly on the actual sequence of rewards received and not on any expectation or policy.</li>\n      <li>The return <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-426-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6723\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.99em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6724\"><span class=\"msubsup\" id=\"MathJax-Span-6725\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6726\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-6727\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>G</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-426\">G_t</script> is a <strong>realized quantity</strong>, computed from one sampled trajectory of states, actions, and rewards.</li>\n      <li>Different rollouts can produce different returns even from the same state, because the environment and policy may be stochastic.</li>\n    </ul>\n  </li>\n  <li><strong>Example:</strong>\n    <ul>\n      <li>If the agent receives rewards <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-427-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6728\" style=\"width: 3.701em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.076em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6729\"><span class=\"mo\" id=\"MathJax-Span-6730\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mn\" id=\"MathJax-Span-6731\" style=\"font-family: STIXGeneral-Regular;\">2</span><span class=\"mo\" id=\"MathJax-Span-6732\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-6733\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">3</span><span class=\"mo\" id=\"MathJax-Span-6734\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-6735\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-6736\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-427\">[2, 3, 1]</script> over three time steps and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-428-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi><mo>=</mo><mn>0.9</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6737\" style=\"width: 3.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6738\"><span class=\"mi\" id=\"MathJax-Span-6739\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6740\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-6741\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">0.9</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi><mo>=</mo><mn>0.9</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-428\">\\gamma = 0.9</script>, then <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-429-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mn>0</mn></msub><mo>=</mo><mn>2</mn><mo>+</mo><mn>0.9</mn><mo stretchy=&quot;false&quot;>(</mo><mn>3</mn><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><msup><mn>0.9</mn><mn>2</mn></msup><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>2</mn><mo>+</mo><mn>2.7</mn><mo>+</mo><mn>0.81</mn><mo>=</mo><mn>5.51</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6742\" style=\"width: 24.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 20.107em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1020em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6743\"><span class=\"msubsup\" id=\"MathJax-Span-6744\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6745\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mn\" id=\"MathJax-Span-6746\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6747\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-6748\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">2</span><span class=\"mo\" id=\"MathJax-Span-6749\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mn\" id=\"MathJax-Span-6750\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">0.9</span><span class=\"mo\" id=\"MathJax-Span-6751\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mn\" id=\"MathJax-Span-6752\" style=\"font-family: STIXGeneral-Regular;\">3</span><span class=\"mo\" id=\"MathJax-Span-6753\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6754\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"msubsup\" id=\"MathJax-Span-6755\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.669em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1001.2em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-6756\" style=\"font-family: STIXGeneral-Regular;\">0.9</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 1.253em;\"><span class=\"mn\" id=\"MathJax-Span-6757\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6758\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mn\" id=\"MathJax-Span-6759\" style=\"font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-6760\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6761\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-6762\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">2</span><span class=\"mo\" id=\"MathJax-Span-6763\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mn\" id=\"MathJax-Span-6764\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">2.7</span><span class=\"mo\" id=\"MathJax-Span-6765\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mn\" id=\"MathJax-Span-6766\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">0.81</span><span class=\"mo\" id=\"MathJax-Span-6767\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-6768\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">5.51</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>G</mi><mn>0</mn></msub><mo>=</mo><mn>2</mn><mo>+</mo><mn>0.9</mn><mo stretchy=\"false\">(</mo><mn>3</mn><mo stretchy=\"false\">)</mo><mo>+</mo><msup><mn>0.9</mn><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>2</mn><mo>+</mo><mn>2.7</mn><mo>+</mo><mn>0.81</mn><mo>=</mo><mn>5.51</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-429\">G_0 = 2 + 0.9(3) + 0.9^2(1) = 2 + 2.7 + 0.81 = 5.51</script>.</li>\n    </ul>\n  </li>\n</ul>\n<ul>\n      <li>The <strong>return</strong> represents the observed <strong>total accumulated reward</strong> (often discounted) that an agent receives after a certain time step within a <em>single trajectory</em>.</li>\n      <li>It quantifies the actual outcome of one specific episode or rollout.</li>\n      <li>\n        <p>It is the foundational quantity from which value and advantage functions are derived.</p>\n      </li>\n      <li>\n        <p>Mathematically, for time step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-420-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6670\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6671\"><span class=\"mi\" id=\"MathJax-Span-6672\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-420\">t</script>:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-421-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>&amp;#x221E;</mi></mrow></munderover><msup><mi>&amp;#x03B3;</mi><mi>k</mi></msup><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>k</mi></mrow></msub></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6673\" style=\"width: 7.294em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.044em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(0.419em, 1006.04em, 3.596em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6674\"><span class=\"msubsup\" id=\"MathJax-Span-6675\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6676\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-6677\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6678\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"munderover\" id=\"MathJax-Span-6679\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.305em; height: 0px;\"><span style=\"position: absolute; clip: rect(2.867em, 1001.2em, 4.638em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-6680\" style=\"font-family: STIXSizeOneSym; vertical-align: -0.518em;\">‚àë</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.388em, 1001.15em, 4.273em, -999.997em); top: -2.862em; left: 0.055em;\"><span class=\"texatom\" id=\"MathJax-Span-6681\"><span class=\"mrow\" id=\"MathJax-Span-6682\"><span class=\"mi\" id=\"MathJax-Span-6683\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6684\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">=</span><span class=\"mn\" id=\"MathJax-Span-6685\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; clip: rect(3.44em, 1000.63em, 4.169em, -999.997em); top: -5.206em; left: 0.315em;\"><span class=\"texatom\" id=\"MathJax-Span-6686\"><span class=\"mrow\" id=\"MathJax-Span-6687\"><span class=\"mi\" id=\"MathJax-Span-6688\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">‚àû</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-6689\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.378em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6690\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6691\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-6692\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6693\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-6694\"><span class=\"mrow\" id=\"MathJax-Span-6695\"><span class=\"mi\" id=\"MathJax-Span-6696\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6697\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-6698\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.559em; border-left: 0px solid; width: 0px; height: 3.566em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><munderover><mo>‚àë</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>0</mn></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"normal\">‚àû</mi></mrow></munderover><msup><mi>Œ≥</mi><mi>k</mi></msup><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mi>k</mi></mrow></msub></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-421\">G_t = \\sum_{k=0}^{\\infty} \\gamma^k r_{t+k}</script>\n      </li>\n      <li>\n        <p>where:</p>\n\n        <ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-422-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>k</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6699\" style=\"width: 1.773em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.46em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6700\"><span class=\"msubsup\" id=\"MathJax-Span-6701\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6702\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-6703\"><span class=\"mrow\" id=\"MathJax-Span-6704\"><span class=\"mi\" id=\"MathJax-Span-6705\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6706\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-6707\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mi>k</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-422\">r_{t+k}</script> is the reward received <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-423-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6708\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6709\"><span class=\"mi\" id=\"MathJax-Span-6710\" style=\"font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>k</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-423\">k</script> steps after time <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-424-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6711\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6712\"><span class=\"mi\" id=\"MathJax-Span-6713\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-424\">t</script>,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-425-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi><mo>&amp;#x2208;</mo><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6714\" style=\"width: 4.69em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.909em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.86em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6715\"><span class=\"mi\" id=\"MathJax-Span-6716\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6717\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àà</span><span class=\"mo\" id=\"MathJax-Span-6718\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">[</span><span class=\"mn\" id=\"MathJax-Span-6719\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-6720\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-6721\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-6722\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi><mo>‚àà</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-425\">\\gamma \\in [0,1)</script> is the <strong>discount factor</strong>, weighting immediate rewards more heavily than distant ones.</li>\n        </ul>\n      </li>\n    </ul>\n<p>It is the foundational quantity from which value and advantage functions are derived.</p>\n<p>Mathematically, for time step <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-420-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6670\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6671\"><span class=\"mi\" id=\"MathJax-Span-6672\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-420\">t</script>:</p>\n<p>where:</p>\n<ul>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-422-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mi>k</mi></mrow></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6699\" style=\"width: 1.773em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.565em, 1001.46em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6700\"><span class=\"msubsup\" id=\"MathJax-Span-6701\"><span style=\"display: inline-block; position: relative; width: 1.461em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6702\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-6703\"><span class=\"mrow\" id=\"MathJax-Span-6704\"><span class=\"mi\" id=\"MathJax-Span-6705\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6706\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mi\" id=\"MathJax-Span-6707\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mi>k</mi></mrow></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-422\">r_{t+k}</script> is the reward received <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-423-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6708\" style=\"width: 0.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.523em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.52em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6709\"><span class=\"mi\" id=\"MathJax-Span-6710\" style=\"font-family: STIXGeneral-Italic;\">k<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>k</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-423\">k</script> steps after time <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-424-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>t</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6711\" style=\"width: 0.315em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.513em, 1000.26em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6712\"><span class=\"mi\" id=\"MathJax-Span-6713\" style=\"font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-424\">t</script>,</li>\n          <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-425-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi><mo>&amp;#x2208;</mo><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6714\" style=\"width: 4.69em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.909em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.409em, 1003.86em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6715\"><span class=\"mi\" id=\"MathJax-Span-6716\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6717\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚àà</span><span class=\"mo\" id=\"MathJax-Span-6718\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">[</span><span class=\"mn\" id=\"MathJax-Span-6719\" style=\"font-family: STIXGeneral-Regular;\">0</span><span class=\"mo\" id=\"MathJax-Span-6720\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-6721\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-6722\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi><mo>‚àà</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-425\">\\gamma \\in [0,1)</script> is the <strong>discount factor</strong>, weighting immediate rewards more heavily than distant ones.</li>\n        </ul>\n<p><strong>Intuition:</strong></p>\n<ul>\n      <li>The return quantifies <em>‚Äúhow much total reward the agent will get from now on.‚Äù</em></li>\n      <li>It depends directly on the actual sequence of rewards received and not on any expectation or policy.</li>\n      <li>The return <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-426-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6723\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.99em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6724\"><span class=\"msubsup\" id=\"MathJax-Span-6725\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6726\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-6727\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>G</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-426\">G_t</script> is a <strong>realized quantity</strong>, computed from one sampled trajectory of states, actions, and rewards.</li>\n      <li>Different rollouts can produce different returns even from the same state, because the environment and policy may be stochastic.</li>\n    </ul>\n<ul>\n      <li>If the agent receives rewards <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-427-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6728\" style=\"width: 3.701em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.076em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6729\"><span class=\"mo\" id=\"MathJax-Span-6730\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"mn\" id=\"MathJax-Span-6731\" style=\"font-family: STIXGeneral-Regular;\">2</span><span class=\"mo\" id=\"MathJax-Span-6732\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-6733\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">3</span><span class=\"mo\" id=\"MathJax-Span-6734\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mn\" id=\"MathJax-Span-6735\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.211em;\">1</span><span class=\"mo\" id=\"MathJax-Span-6736\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-427\">[2, 3, 1]</script> over three time steps and <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-428-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03B3;</mi><mo>=</mo><mn>0.9</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6737\" style=\"width: 3.648em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.023em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.97em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6738\"><span class=\"mi\" id=\"MathJax-Span-6739\" style=\"font-family: STIXGeneral-Italic;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6740\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-6741\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">0.9</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Œ≥</mi><mo>=</mo><mn>0.9</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-428\">\\gamma = 0.9</script>, then <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-429-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mn>0</mn></msub><mo>=</mo><mn>2</mn><mo>+</mo><mn>0.9</mn><mo stretchy=&quot;false&quot;>(</mo><mn>3</mn><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><msup><mn>0.9</mn><mn>2</mn></msup><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>2</mn><mo>+</mo><mn>2.7</mn><mo>+</mo><mn>0.81</mn><mo>=</mo><mn>5.51</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6742\" style=\"width: 24.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 20.107em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.148em, 1020em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6743\"><span class=\"msubsup\" id=\"MathJax-Span-6744\"><span style=\"display: inline-block; position: relative; width: 1.148em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6745\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mn\" id=\"MathJax-Span-6746\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">0</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6747\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-6748\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">2</span><span class=\"mo\" id=\"MathJax-Span-6749\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mn\" id=\"MathJax-Span-6750\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">0.9</span><span class=\"mo\" id=\"MathJax-Span-6751\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mn\" id=\"MathJax-Span-6752\" style=\"font-family: STIXGeneral-Regular;\">3</span><span class=\"mo\" id=\"MathJax-Span-6753\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6754\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"msubsup\" id=\"MathJax-Span-6755\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.669em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1001.2em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-6756\" style=\"font-family: STIXGeneral-Regular;\">0.9</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 1.253em;\"><span class=\"mn\" id=\"MathJax-Span-6757\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6758\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mn\" id=\"MathJax-Span-6759\" style=\"font-family: STIXGeneral-Regular;\">1</span><span class=\"mo\" id=\"MathJax-Span-6760\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6761\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-6762\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">2</span><span class=\"mo\" id=\"MathJax-Span-6763\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mn\" id=\"MathJax-Span-6764\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">2.7</span><span class=\"mo\" id=\"MathJax-Span-6765\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mn\" id=\"MathJax-Span-6766\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">0.81</span><span class=\"mo\" id=\"MathJax-Span-6767\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-6768\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">5.51</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.378em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>G</mi><mn>0</mn></msub><mo>=</mo><mn>2</mn><mo>+</mo><mn>0.9</mn><mo stretchy=\"false\">(</mo><mn>3</mn><mo stretchy=\"false\">)</mo><mo>+</mo><msup><mn>0.9</mn><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>2</mn><mo>+</mo><mn>2.7</mn><mo>+</mo><mn>0.81</mn><mo>=</mo><mn>5.51</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-429\">G_0 = 2 + 0.9(3) + 0.9^2(1) = 2 + 2.7 + 0.81 = 5.51</script>.</li>\n    </ul>\n<h4 id=\"value-function-v-or-q\">Value Function (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-430-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6769\" style=\"width: 0.96em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.794em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.377em, 1000.79em, 2.294em, -999.998em); top: -2.165em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6770\"><span class=\"mi\" id=\"MathJax-Span-6771\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.085em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.169em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.903em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-430\">V</script> or <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-431-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6772\" style=\"width: 0.877em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.71em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.377em, 1000.67em, 2.46em, -999.998em); top: -2.165em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6773\"><span class=\"mi\" id=\"MathJax-Span-6774\" style=\"font-family: STIXGeneral-Italic;\">Q</span></span><span style=\"display: inline-block; width: 0px; height: 2.169em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.103em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-431\">Q</script>)</h4>\n<ul>\n  <li><strong>Definition:</strong>\n    <ul>\n      <li>The <strong>value function</strong> predicts the <strong>expected return</strong> ‚Äî that is, the <em>average total future reward</em> an agent can expect to receive from a given state (or state‚Äìaction pair), averaged over all possible future trajectories induced by the policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-432-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6775\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6776\"><span class=\"mi\" id=\"MathJax-Span-6777\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-432\">\\pi</script>.</li>\n      <li>It generalizes over many possible trajectories rather than a single one.</li>\n      <li>\n        <p>There are two common types:</p>\n      </li>\n      <li>\n        <p><strong>State-value function:</strong></p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-433-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><msub><mi>G</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6778\" style=\"width: 11.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.326em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1009.22em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6779\"><span class=\"msubsup\" id=\"MathJax-Span-6780\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6781\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-6782\"><span class=\"mrow\" id=\"MathJax-Span-6783\"><span class=\"mi\" id=\"MathJax-Span-6784\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6785\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6786\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-6787\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6788\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-6789\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-6790\"><span class=\"mrow\" id=\"MathJax-Span-6791\"><span class=\"mi\" id=\"MathJax-Span-6792\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-6793\"><span class=\"mrow\" id=\"MathJax-Span-6794\"><span class=\"mi\" id=\"MathJax-Span-6795\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6796\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-6797\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6798\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-6799\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6800\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-6801\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6802\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6803\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6804\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-6805\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-6806\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msub><mo stretchy=\"false\">[</mo><msub><mi>G</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi><mo stretchy=\"false\">]</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-433\">V^{\\pi}(s) = \\mathbb{E}_{\\pi} [G_t \\mid s_t = s]</script>\n\n        <ul>\n          <li>Measures how good it is to <em>be</em> in a given state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-434-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6807\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6808\"><span class=\"mi\" id=\"MathJax-Span-6809\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-434\">s</script> under policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-435-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6810\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6811\"><span class=\"mi\" id=\"MathJax-Span-6812\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-435\">\\pi</script>.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Action-value function:</strong></p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-436-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><msub><mi>G</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>=</mo><mi>a</mi><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6813\" style=\"width: 15.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 13.128em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1013.02em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6814\"><span class=\"msubsup\" id=\"MathJax-Span-6815\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6816\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-6817\"><span class=\"mrow\" id=\"MathJax-Span-6818\"><span class=\"mi\" id=\"MathJax-Span-6819\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6820\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6821\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-6822\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6823\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-6824\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6825\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-6826\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-6827\"><span class=\"mrow\" id=\"MathJax-Span-6828\"><span class=\"mi\" id=\"MathJax-Span-6829\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-6830\"><span class=\"mrow\" id=\"MathJax-Span-6831\"><span class=\"mi\" id=\"MathJax-Span-6832\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6833\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-6834\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6835\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-6836\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6837\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-6838\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6839\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6840\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6841\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-6842\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-6843\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-6844\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6845\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6846\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6847\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-6848\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">a</span><span class=\"mo\" id=\"MathJax-Span-6849\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msub><mo stretchy=\"false\">[</mo><msub><mi>G</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>=</mo><mi>a</mi><mo stretchy=\"false\">]</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-436\">Q^{\\pi}(s, a) = \\mathbb{E}_{\\pi} [G_t \\mid s_t = s, a_t = a]</script>\n\n        <ul>\n          <li>Measures how good it is to <em>take action</em> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-437-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6850\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6851\"><span class=\"mi\" id=\"MathJax-Span-6852\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-437\">a</script> in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-438-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6853\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6854\"><span class=\"mi\" id=\"MathJax-Span-6855\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-438\">s</script> and then follow policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-439-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6856\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6857\"><span class=\"mi\" id=\"MathJax-Span-6858\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-439\">\\pi</script>.</li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Intuition:</strong></p>\n\n    <ul>\n      <li>The value function provides an <em>expected future outlook</em> rather than a realized one.</li>\n      <li>It maps a state (or state‚Äìaction pair) to how desirable that situation is in the long run under a specific policy.</li>\n      <li>While the <strong>return</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-440-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6859\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.99em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6860\"><span class=\"msubsup\" id=\"MathJax-Span-6861\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6862\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-6863\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>G</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-440\">G_t</script> is computed for a single trajectory, the <strong>value function</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-441-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6864\" style=\"width: 2.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.19em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6865\"><span class=\"msubsup\" id=\"MathJax-Span-6866\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6867\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-6868\"><span class=\"mrow\" id=\"MathJax-Span-6869\"><span class=\"mi\" id=\"MathJax-Span-6870\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6871\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6872\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-6873\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-441\">V^{\\pi}(s)</script> or <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-442-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6874\" style=\"width: 3.857em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.18em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.13em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6875\"><span class=\"msubsup\" id=\"MathJax-Span-6876\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6877\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-6878\"><span class=\"mrow\" id=\"MathJax-Span-6879\"><span class=\"mi\" id=\"MathJax-Span-6880\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6881\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6882\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-6883\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6884\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-6885\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-442\">Q^{\\pi}(s, a)</script> takes the <em>expectation over many such trajectories</em>.</li>\n      <li>It captures the <strong>average long-term desirability</strong> of a state or action under a policy.</li>\n    </ul>\n  </li>\n  <li><strong>Example:</strong>\n    <ul>\n      <li>If the agent expects, on average, to receive total rewards of 5.5 whenever it‚Äôs in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-443-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6886\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6887\"><span class=\"mi\" id=\"MathJax-Span-6888\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-443\">s</script>, then <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-444-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>5.5</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6889\" style=\"width: 5.159em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.273em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1004.22em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6890\"><span class=\"mi\" id=\"MathJax-Span-6891\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6892\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6893\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-6894\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6895\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-6896\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">5.5</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>5.5</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-444\">V(s) = 5.5</script>.</li>\n    </ul>\n  </li>\n</ul>\n<ul>\n      <li>The <strong>value function</strong> predicts the <strong>expected return</strong> ‚Äî that is, the <em>average total future reward</em> an agent can expect to receive from a given state (or state‚Äìaction pair), averaged over all possible future trajectories induced by the policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-432-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6775\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6776\"><span class=\"mi\" id=\"MathJax-Span-6777\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-432\">\\pi</script>.</li>\n      <li>It generalizes over many possible trajectories rather than a single one.</li>\n      <li>\n        <p>There are two common types:</p>\n      </li>\n      <li>\n        <p><strong>State-value function:</strong></p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-433-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><msub><mi>G</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6778\" style=\"width: 11.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.326em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1009.22em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6779\"><span class=\"msubsup\" id=\"MathJax-Span-6780\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6781\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-6782\"><span class=\"mrow\" id=\"MathJax-Span-6783\"><span class=\"mi\" id=\"MathJax-Span-6784\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6785\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6786\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-6787\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6788\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-6789\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-6790\"><span class=\"mrow\" id=\"MathJax-Span-6791\"><span class=\"mi\" id=\"MathJax-Span-6792\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-6793\"><span class=\"mrow\" id=\"MathJax-Span-6794\"><span class=\"mi\" id=\"MathJax-Span-6795\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6796\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-6797\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6798\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-6799\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6800\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-6801\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6802\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6803\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6804\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-6805\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-6806\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msub><mo stretchy=\"false\">[</mo><msub><mi>G</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi><mo stretchy=\"false\">]</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-433\">V^{\\pi}(s) = \\mathbb{E}_{\\pi} [G_t \\mid s_t = s]</script>\n\n        <ul>\n          <li>Measures how good it is to <em>be</em> in a given state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-434-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6807\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6808\"><span class=\"mi\" id=\"MathJax-Span-6809\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-434\">s</script> under policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-435-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6810\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6811\"><span class=\"mi\" id=\"MathJax-Span-6812\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-435\">\\pi</script>.</li>\n        </ul>\n      </li>\n      <li>\n        <p><strong>Action-value function:</strong></p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-436-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><msub><mi>G</mi><mi>t</mi></msub><mo>&amp;#x2223;</mo><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>=</mo><mi>a</mi><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6813\" style=\"width: 15.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 13.128em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1013.02em, 2.607em, -999.997em); top: -2.237em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6814\"><span class=\"msubsup\" id=\"MathJax-Span-6815\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6816\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-6817\"><span class=\"mrow\" id=\"MathJax-Span-6818\"><span class=\"mi\" id=\"MathJax-Span-6819\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6820\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6821\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-6822\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6823\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-6824\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6825\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-6826\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-6827\"><span class=\"mrow\" id=\"MathJax-Span-6828\"><span class=\"mi\" id=\"MathJax-Span-6829\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-6830\"><span class=\"mrow\" id=\"MathJax-Span-6831\"><span class=\"mi\" id=\"MathJax-Span-6832\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6833\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-6834\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6835\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-6836\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6837\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚à£</span><span class=\"msubsup\" id=\"MathJax-Span-6838\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6839\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6840\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6841\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-6842\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-6843\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-6844\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6845\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6846\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6847\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-6848\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">a</span><span class=\"mo\" id=\"MathJax-Span-6849\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.242em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msub><mo stretchy=\"false\">[</mo><msub><mi>G</mi><mi>t</mi></msub><mo>‚à£</mo><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>=</mo><mi>a</mi><mo stretchy=\"false\">]</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-436\">Q^{\\pi}(s, a) = \\mathbb{E}_{\\pi} [G_t \\mid s_t = s, a_t = a]</script>\n\n        <ul>\n          <li>Measures how good it is to <em>take action</em> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-437-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6850\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6851\"><span class=\"mi\" id=\"MathJax-Span-6852\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-437\">a</script> in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-438-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6853\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6854\"><span class=\"mi\" id=\"MathJax-Span-6855\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-438\">s</script> and then follow policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-439-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6856\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6857\"><span class=\"mi\" id=\"MathJax-Span-6858\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-439\">\\pi</script>.</li>\n        </ul>\n      </li>\n    </ul>\n<p>There are two common types:</p>\n<p><strong>State-value function:</strong></p>\n<ul>\n          <li>Measures how good it is to <em>be</em> in a given state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-434-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6807\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6808\"><span class=\"mi\" id=\"MathJax-Span-6809\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-434\">s</script> under policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-435-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6810\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6811\"><span class=\"mi\" id=\"MathJax-Span-6812\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-435\">\\pi</script>.</li>\n        </ul>\n<p><strong>Action-value function:</strong></p>\n<ul>\n          <li>Measures how good it is to <em>take action</em> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-437-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6850\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6851\"><span class=\"mi\" id=\"MathJax-Span-6852\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-437\">a</script> in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-438-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6853\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6854\"><span class=\"mi\" id=\"MathJax-Span-6855\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-438\">s</script> and then follow policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-439-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6856\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6857\"><span class=\"mi\" id=\"MathJax-Span-6858\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-439\">\\pi</script>.</li>\n        </ul>\n<p><strong>Intuition:</strong></p>\n<ul>\n      <li>The value function provides an <em>expected future outlook</em> rather than a realized one.</li>\n      <li>It maps a state (or state‚Äìaction pair) to how desirable that situation is in the long run under a specific policy.</li>\n      <li>While the <strong>return</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-440-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6859\" style=\"width: 1.201em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1000.99em, 2.451em, -999.997em); top: -2.133em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6860\"><span class=\"msubsup\" id=\"MathJax-Span-6861\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6862\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-6863\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.138em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>G</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-440\">G_t</script> is computed for a single trajectory, the <strong>value function</strong> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-441-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6864\" style=\"width: 2.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.242em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1002.19em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6865\"><span class=\"msubsup\" id=\"MathJax-Span-6866\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6867\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-6868\"><span class=\"mrow\" id=\"MathJax-Span-6869\"><span class=\"mi\" id=\"MathJax-Span-6870\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6871\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6872\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-6873\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-441\">V^{\\pi}(s)</script> or <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-442-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6874\" style=\"width: 3.857em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.18em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.13em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6875\"><span class=\"msubsup\" id=\"MathJax-Span-6876\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6877\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-6878\"><span class=\"mrow\" id=\"MathJax-Span-6879\"><span class=\"mi\" id=\"MathJax-Span-6880\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6881\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6882\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-6883\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6884\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-6885\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-442\">Q^{\\pi}(s, a)</script> takes the <em>expectation over many such trajectories</em>.</li>\n      <li>It captures the <strong>average long-term desirability</strong> of a state or action under a policy.</li>\n    </ul>\n<ul>\n      <li>If the agent expects, on average, to receive total rewards of 5.5 whenever it‚Äôs in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-443-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6886\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6887\"><span class=\"mi\" id=\"MathJax-Span-6888\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-443\">s</script>, then <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-444-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>5.5</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6889\" style=\"width: 5.159em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.273em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1004.22em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6890\"><span class=\"mi\" id=\"MathJax-Span-6891\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6892\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6893\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-6894\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6895\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-6896\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">5.5</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>V</mi><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>5.5</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-444\">V(s) = 5.5</script>.</li>\n    </ul>\n<h4 id=\"advantage-function-a\">Advantage Function (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-445-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6897\" style=\"width: 0.877em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.71em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.377em, 1000.67em, 2.294em, -999.998em); top: -2.165em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6898\"><span class=\"mi\" id=\"MathJax-Span-6899\" style=\"font-family: STIXGeneral-Italic;\">A</span></span><span style=\"display: inline-block; width: 0px; height: 2.169em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.903em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>A</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-445\">A</script>)</h4>\n<ul>\n  <li>\n    <p><strong>Definition:</strong></p>\n\n    <ul>\n      <li>The <strong>advantage function</strong> quantifies how much <em>better (or worse)</em> a particular action is compared to the average action at a given state under the current policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-446-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6900\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6901\"><span class=\"mi\" id=\"MathJax-Span-6902\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-446\">\\pi</script>.</li>\n      <li>It is formally defined as:</li>\n    </ul>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-447-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6903\" style=\"width: 12.919em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1010.68em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6904\"><span class=\"msubsup\" id=\"MathJax-Span-6905\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6906\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-6907\"><span class=\"mrow\" id=\"MathJax-Span-6908\"><span class=\"mi\" id=\"MathJax-Span-6909\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6910\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6911\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-6912\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6913\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-6914\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6915\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-6916\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6917\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-6918\"><span class=\"mrow\" id=\"MathJax-Span-6919\"><span class=\"mi\" id=\"MathJax-Span-6920\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6921\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6922\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-6923\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6924\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-6925\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6926\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-6927\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6928\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-6929\"><span class=\"mrow\" id=\"MathJax-Span-6930\"><span class=\"mi\" id=\"MathJax-Span-6931\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6932\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6933\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-6934\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>A</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-447\">A^{\\pi}(s, a) = Q^{\\pi}(s, a) - V^{\\pi}(s)</script>\n\n    <p>This makes it an <strong>action-level</strong> function, since it depends on both the state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-448-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6935\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6936\"><span class=\"mi\" id=\"MathJax-Span-6937\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-448\">s</script> and the action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-449-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6938\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6939\"><span class=\"mi\" id=\"MathJax-Span-6940\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-449\">a</script>.</p>\n  </li>\n  <li>\n    <p><strong>Practical usage:</strong></p>\n\n    <ul>\n      <li>\n        <p>In most real-world settings (e.g., PPO or actor‚Äìcritic methods), we rarely have direct access to the action-value function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-450-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6941\" style=\"width: 3.857em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.18em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.13em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6942\"><span class=\"msubsup\" id=\"MathJax-Span-6943\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6944\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-6945\"><span class=\"mrow\" id=\"MathJax-Span-6946\"><span class=\"mi\" id=\"MathJax-Span-6947\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6948\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6949\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-6950\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6951\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-6952\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-450\">Q^{\\pi}(s,a)</script>.</p>\n      </li>\n      <li>\n        <p>The only exceptions are small <strong>tabular</strong> or <strong>discrete environments</strong>‚Äîlike those used in DQN or Monte Carlo policy evaluation‚Äîwhere <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-451-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6953\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.73em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6954\"><span class=\"mi\" id=\"MathJax-Span-6955\" style=\"font-family: STIXGeneral-Italic;\">Q</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-451\">Q</script> can be explicitly estimated from replay or full trajectories.</p>\n      </li>\n      <li>\n        <p>For high-dimensional or continuous policies (such as large language models in RLHF), <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-452-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6956\" style=\"width: 3.857em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.18em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.13em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6957\"><span class=\"msubsup\" id=\"MathJax-Span-6958\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6959\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-6960\"><span class=\"mrow\" id=\"MathJax-Span-6961\"><span class=\"mi\" id=\"MathJax-Span-6962\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6963\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6964\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-6965\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6966\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-6967\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-452\">Q^{\\pi}(s,a)</script> is <strong>approximated from rollouts</strong> as</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-453-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2248;</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B3;</mi><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6968\" style=\"width: 12.346em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1010.21em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6969\"><span class=\"msubsup\" id=\"MathJax-Span-6970\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6971\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-6972\"><span class=\"mrow\" id=\"MathJax-Span-6973\"><span class=\"mi\" id=\"MathJax-Span-6974\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6975\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6976\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6977\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6978\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6979\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-6980\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6981\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6982\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6983\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6984\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚âà</span><span class=\"msubsup\" id=\"MathJax-Span-6985\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6986\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6987\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6988\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-6989\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-6990\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6991\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6992\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6993\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-6994\"><span class=\"mrow\" id=\"MathJax-Span-6995\"><span class=\"mi\" id=\"MathJax-Span-6996\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6997\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-6998\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6999\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>‚âà</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>Œ≥</mi><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-453\">Q^{\\pi}(s_t,a_t) \\approx r_t + \\gamma V(s_{t+1})</script>\n      </li>\n      <li>\n        <p>Substituting this into the definition yields the empirical advantage estimate:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-454-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>A</mi><mi>t</mi></msub><mo>&amp;#x2248;</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B3;</mi><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7000\" style=\"width: 12.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1010.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7001\"><span class=\"msubsup\" id=\"MathJax-Span-7002\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7003\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-7004\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7005\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚âà</span><span class=\"msubsup\" id=\"MathJax-Span-7006\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7007\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-7008\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7009\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-7010\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-7011\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-7012\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-7013\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7014\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-7015\"><span class=\"mrow\" id=\"MathJax-Span-7016\"><span class=\"mi\" id=\"MathJax-Span-7017\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-7018\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-7019\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7020\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-7021\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-7022\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-7023\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-7024\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7025\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-7026\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7027\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>A</mi><mi>t</mi></msub><mo>‚âà</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>Œ≥</mi><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-454\">A_t \\approx r_t + \\gamma V(s_{t+1}) - V(s_t)</script>\n      </li>\n      <li>\n        <p>In one-step or bandit-style tasks (such as RLHF with a single scalar reward per response), this simplifies further to</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-455-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7028\" style=\"width: 7.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.94em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7029\"><span class=\"msubsup\" id=\"MathJax-Span-7030\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7031\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-7032\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7033\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-7034\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7035\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-7036\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7037\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-7038\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-7039\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-7040\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7041\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-7042\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7043\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>‚àí</mo><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-455\">A_t = r_t - V(s_t)</script>\n      </li>\n    </ul>\n\n    <p>Thus, while the advantage is <strong>defined</strong> at the action level, in practice it is <strong>computed via state-value approximations</strong>, except in domains where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-456-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7044\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.73em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7045\"><span class=\"mi\" id=\"MathJax-Span-7046\" style=\"font-family: STIXGeneral-Italic;\">Q</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-456\">Q</script> can be directly learned.</p>\n  </li>\n  <li>\n    <p><strong>Interpretation:</strong></p>\n\n    <ul>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-457-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;gt;</mo><mn>0</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7047\" style=\"width: 5.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.69em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1004.69em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7048\"><span class=\"msubsup\" id=\"MathJax-Span-7049\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7050\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-7051\"><span class=\"mrow\" id=\"MathJax-Span-7052\"><span class=\"mi\" id=\"MathJax-Span-7053\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7054\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-7055\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-7056\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-7057\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-7058\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-7059\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">&gt;</span><span class=\"mn\" id=\"MathJax-Span-7060\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">0</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>A</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>&gt;</mo><mn>0</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-457\">A^{\\pi}(s, a) > 0</script>: Action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-458-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7061\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7062\"><span class=\"mi\" id=\"MathJax-Span-7063\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-458\">a</script> is better than the average action in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-459-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7064\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7065\"><span class=\"mi\" id=\"MathJax-Span-7066\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-459\">s</script>.</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-460-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;lt;</mo><mn>0</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7067\" style=\"width: 5.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.69em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1004.69em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7068\"><span class=\"msubsup\" id=\"MathJax-Span-7069\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7070\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-7071\"><span class=\"mrow\" id=\"MathJax-Span-7072\"><span class=\"mi\" id=\"MathJax-Span-7073\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7074\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-7075\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-7076\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-7077\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-7078\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-7079\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">&lt;</span><span class=\"mn\" id=\"MathJax-Span-7080\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">0</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>A</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>&lt;</mo><mn>0</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-460\">A^{\\pi}(s, a) < 0</script>: Action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-461-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7081\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7082\"><span class=\"mi\" id=\"MathJax-Span-7083\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-461\">a</script> is worse than average.</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-462-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>0</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7084\" style=\"width: 5.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.69em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1004.69em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7085\"><span class=\"msubsup\" id=\"MathJax-Span-7086\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7087\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-7088\"><span class=\"mrow\" id=\"MathJax-Span-7089\"><span class=\"mi\" id=\"MathJax-Span-7090\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7091\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-7092\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-7093\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-7094\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-7095\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-7096\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-7097\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">0</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>A</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-462\">A^{\\pi}(s, a) = 0</script>: Action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-463-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7098\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7099\"><span class=\"mi\" id=\"MathJax-Span-7100\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-463\">a</script> is equally as good as the expected average behavior of the policy.</li>\n    </ul>\n  </li>\n  <li>\n    <p><strong>Why it‚Äôs useful:</strong></p>\n\n    <ul>\n      <li>The advantage function is crucial in policy gradient methods (e.g., PPO, A2C) because it <strong>reduces variance</strong> in gradient estimation‚Äîfocusing updates on actions that performed better or worse than expected, rather than on absolute returns.</li>\n    </ul>\n  </li>\n</ul>\n<p><strong>Definition:</strong></p>\n<ul>\n      <li>The <strong>advantage function</strong> quantifies how much <em>better (or worse)</em> a particular action is compared to the average action at a given state under the current policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-446-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6900\" style=\"width: 0.784em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.63em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6901\"><span class=\"mi\" id=\"MathJax-Span-6902\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-446\">\\pi</script>.</li>\n      <li>It is formally defined as:</li>\n    </ul>\n<p>This makes it an <strong>action-level</strong> function, since it depends on both the state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-448-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6935\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6936\"><span class=\"mi\" id=\"MathJax-Span-6937\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-448\">s</script> and the action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-449-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6938\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6939\"><span class=\"mi\" id=\"MathJax-Span-6940\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-449\">a</script>.</p>\n<p><strong>Practical usage:</strong></p>\n<ul>\n      <li>\n        <p>In most real-world settings (e.g., PPO or actor‚Äìcritic methods), we rarely have direct access to the action-value function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-450-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6941\" style=\"width: 3.857em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.18em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.13em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6942\"><span class=\"msubsup\" id=\"MathJax-Span-6943\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6944\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-6945\"><span class=\"mrow\" id=\"MathJax-Span-6946\"><span class=\"mi\" id=\"MathJax-Span-6947\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6948\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6949\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-6950\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6951\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-6952\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-450\">Q^{\\pi}(s,a)</script>.</p>\n      </li>\n      <li>\n        <p>The only exceptions are small <strong>tabular</strong> or <strong>discrete environments</strong>‚Äîlike those used in DQN or Monte Carlo policy evaluation‚Äîwhere <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-451-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6953\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.73em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6954\"><span class=\"mi\" id=\"MathJax-Span-6955\" style=\"font-family: STIXGeneral-Italic;\">Q</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-451\">Q</script> can be explicitly estimated from replay or full trajectories.</p>\n      </li>\n      <li>\n        <p>For high-dimensional or continuous policies (such as large language models in RLHF), <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-452-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6956\" style=\"width: 3.857em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.18em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.13em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6957\"><span class=\"msubsup\" id=\"MathJax-Span-6958\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6959\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-6960\"><span class=\"mrow\" id=\"MathJax-Span-6961\"><span class=\"mi\" id=\"MathJax-Span-6962\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6963\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6964\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-6965\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6966\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-6967\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-452\">Q^{\\pi}(s,a)</script> is <strong>approximated from rollouts</strong> as</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-453-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2248;</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B3;</mi><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6968\" style=\"width: 12.346em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.263em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1010.21em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6969\"><span class=\"msubsup\" id=\"MathJax-Span-6970\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6971\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-6972\"><span class=\"mrow\" id=\"MathJax-Span-6973\"><span class=\"mi\" id=\"MathJax-Span-6974\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6975\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6976\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6977\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6978\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6979\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-6980\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6981\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-6982\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6983\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-6984\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚âà</span><span class=\"msubsup\" id=\"MathJax-Span-6985\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6986\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-6987\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6988\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-6989\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-6990\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6991\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-6992\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6993\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-6994\"><span class=\"mrow\" id=\"MathJax-Span-6995\"><span class=\"mi\" id=\"MathJax-Span-6996\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-6997\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-6998\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6999\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo><mo>‚âà</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>Œ≥</mi><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-453\">Q^{\\pi}(s_t,a_t) \\approx r_t + \\gamma V(s_{t+1})</script>\n      </li>\n      <li>\n        <p>Substituting this into the definition yields the empirical advantage estimate:</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-454-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>A</mi><mi>t</mi></msub><mo>&amp;#x2248;</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>&amp;#x03B3;</mi><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7000\" style=\"width: 12.711em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.576em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1010.52em, 2.555em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7001\"><span class=\"msubsup\" id=\"MathJax-Span-7002\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7003\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-7004\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7005\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">‚âà</span><span class=\"msubsup\" id=\"MathJax-Span-7006\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7007\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-7008\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7009\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">+</span><span class=\"mi\" id=\"MathJax-Span-7010\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">Œ≥<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-7011\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-7012\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-7013\"><span style=\"display: inline-block; position: relative; width: 1.513em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7014\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"texatom\" id=\"MathJax-Span-7015\"><span class=\"mrow\" id=\"MathJax-Span-7016\"><span class=\"mi\" id=\"MathJax-Span-7017\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-7018\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">+</span><span class=\"mn\" id=\"MathJax-Span-7019\" style=\"font-size: 70.7%; font-family: STIXGeneral-Regular;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7020\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-7021\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-7022\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-7023\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-7024\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7025\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-7026\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7027\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>A</mi><mi>t</mi></msub><mo>‚âà</mo><msub><mi>r</mi><mi>t</mi></msub><mo>+</mo><mi>Œ≥</mi><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mo>‚àí</mo><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-454\">A_t \\approx r_t + \\gamma V(s_{t+1}) - V(s_t)</script>\n      </li>\n      <li>\n        <p>In one-step or bandit-style tasks (such as RLHF with a single scalar reward per response), this simplifies further to</p>\n\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-455-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7028\" style=\"width: 7.19em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.992em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1005.94em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7029\"><span class=\"msubsup\" id=\"MathJax-Span-7030\"><span style=\"display: inline-block; position: relative; width: 0.888em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7031\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"mi\" id=\"MathJax-Span-7032\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7033\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-7034\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.42em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7035\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-7036\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7037\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"mi\" id=\"MathJax-Span-7038\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.263em;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-7039\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-7040\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7041\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-7042\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7043\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><msub><mi>r</mi><mi>t</mi></msub><mo>‚àí</mo><mi>V</mi><mo stretchy=\"false\">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-455\">A_t = r_t - V(s_t)</script>\n      </li>\n    </ul>\n<p>In most real-world settings (e.g., PPO or actor‚Äìcritic methods), we rarely have direct access to the action-value function <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-450-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6941\" style=\"width: 3.857em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.18em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.13em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6942\"><span class=\"msubsup\" id=\"MathJax-Span-6943\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6944\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-6945\"><span class=\"mrow\" id=\"MathJax-Span-6946\"><span class=\"mi\" id=\"MathJax-Span-6947\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6948\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6949\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-6950\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6951\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-6952\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-450\">Q^{\\pi}(s,a)</script>.</p>\n<p>The only exceptions are small <strong>tabular</strong> or <strong>discrete environments</strong>‚Äîlike those used in DQN or Monte Carlo policy evaluation‚Äîwhere <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-451-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6953\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.73em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6954\"><span class=\"mi\" id=\"MathJax-Span-6955\" style=\"font-family: STIXGeneral-Italic;\">Q</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-451\">Q</script> can be explicitly estimated from replay or full trajectories.</p>\n<p>For high-dimensional or continuous policies (such as large language models in RLHF), <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-452-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6956\" style=\"width: 3.857em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.18em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1003.13em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-6957\"><span class=\"msubsup\" id=\"MathJax-Span-6958\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-6959\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-6960\"><span class=\"mrow\" id=\"MathJax-Span-6961\"><span class=\"mi\" id=\"MathJax-Span-6962\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-6963\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-6964\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-6965\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-6966\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-6967\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-452\">Q^{\\pi}(s,a)</script> is <strong>approximated from rollouts</strong> as</p>\n<p>Substituting this into the definition yields the empirical advantage estimate:</p>\n<p>In one-step or bandit-style tasks (such as RLHF with a single scalar reward per response), this simplifies further to</p>\n<p>Thus, while the advantage is <strong>defined</strong> at the action level, in practice it is <strong>computed via state-value approximations</strong>, except in domains where <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-456-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7044\" style=\"width: 0.888em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1000.73em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7045\"><span class=\"mi\" id=\"MathJax-Span-7046\" style=\"font-family: STIXGeneral-Italic;\">Q</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>Q</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-456\">Q</script> can be directly learned.</p>\n<p><strong>Interpretation:</strong></p>\n<ul>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-457-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;gt;</mo><mn>0</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7047\" style=\"width: 5.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.69em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1004.69em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7048\"><span class=\"msubsup\" id=\"MathJax-Span-7049\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7050\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-7051\"><span class=\"mrow\" id=\"MathJax-Span-7052\"><span class=\"mi\" id=\"MathJax-Span-7053\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7054\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-7055\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-7056\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-7057\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-7058\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-7059\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">&gt;</span><span class=\"mn\" id=\"MathJax-Span-7060\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">0</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>A</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>&gt;</mo><mn>0</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-457\">A^{\\pi}(s, a) > 0</script>: Action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-458-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7061\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7062\"><span class=\"mi\" id=\"MathJax-Span-7063\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-458\">a</script> is better than the average action in state <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-459-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7064\" style=\"width: 0.471em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.37em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7065\"><span class=\"mi\" id=\"MathJax-Span-7066\" style=\"font-family: STIXGeneral-Italic;\">s</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>s</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-459\">s</script>.</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-460-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;lt;</mo><mn>0</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7067\" style=\"width: 5.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.69em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1004.69em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7068\"><span class=\"msubsup\" id=\"MathJax-Span-7069\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7070\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-7071\"><span class=\"mrow\" id=\"MathJax-Span-7072\"><span class=\"mi\" id=\"MathJax-Span-7073\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7074\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-7075\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-7076\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-7077\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-7078\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-7079\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">&lt;</span><span class=\"mn\" id=\"MathJax-Span-7080\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">0</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>A</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>&lt;</mo><mn>0</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-460\">A^{\\pi}(s, a) < 0</script>: Action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-461-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7081\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7082\"><span class=\"mi\" id=\"MathJax-Span-7083\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-461\">a</script> is worse than average.</li>\n      <li><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-462-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mn>0</mn></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7084\" style=\"width: 5.628em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.69em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1004.69em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7085\"><span class=\"msubsup\" id=\"MathJax-Span-7086\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7087\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.372em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-7088\"><span class=\"mrow\" id=\"MathJax-Span-7089\"><span class=\"mi\" id=\"MathJax-Span-7090\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7091\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-7092\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-7093\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-7094\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-7095\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-7096\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mn\" id=\"MathJax-Span-7097\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">0</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>A</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-462\">A^{\\pi}(s, a) = 0</script>: Action <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-463-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7098\" style=\"width: 0.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.471em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1000.47em, 2.346em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7099\"><span class=\"mi\" id=\"MathJax-Span-7100\" style=\"font-family: STIXGeneral-Italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-463\">a</script> is equally as good as the expected average behavior of the policy.</li>\n    </ul>\n<p><strong>Why it‚Äôs useful:</strong></p>\n<ul>\n      <li>The advantage function is crucial in policy gradient methods (e.g., PPO, A2C) because it <strong>reduces variance</strong> in gradient estimation‚Äîfocusing updates on actions that performed better or worse than expected, rather than on absolute returns.</li>\n    </ul>\n<h4 id=\"comparative-analysis-15\">Comparative Analysis</h4>\n<div align=\"center\">\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Concept</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Symbol</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Definition</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Depends on</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Meaning</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">Return</td>\n<td class=\"tg-tleft-valign-first\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-464-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7101\" style=\"width: 1.253em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.015em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.372em, 1001.01em, 2.562em, -999.997em); top: -2.199em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7102\"><span class=\"msubsup\" id=\"MathJax-Span-7103\"><span style=\"display: inline-block; position: relative; width: 1.015em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7104\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -3.807em; left: 0.717em;\"><span class=\"mi\" id=\"MathJax-Span-7105\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.205em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>G</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-464\">G_t</script></td>\n<td class=\"tg-tleft-valign-first\">Actual total (discounted) future reward</td>\n<td class=\"tg-tleft-valign-first\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-465-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7106\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.658em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.61em, 1000.66em, 2.562em, -999.997em); top: -2.199em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7107\"><span class=\"msubsup\" id=\"MathJax-Span-7108\"><span style=\"display: inline-block; position: relative; width: 0.658em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7109\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -3.807em; left: 0.42em;\"><span class=\"mi\" id=\"MathJax-Span-7110\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.205em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.861em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-465\">r_t</script></td>\n<td class=\"tg-tleft-valign-second\">Realized outcome of a trajectory</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Value Function</td>\n<td class=\"tg-tleft-valign-first\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-466-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mtext>&amp;#xA0;</mtext><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7111\" style=\"width: 7.324em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.074em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.432em, 1006.01em, 2.622em, -999.997em); top: -2.259em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7112\"><span class=\"msubsup\" id=\"MathJax-Span-7113\"><span style=\"display: inline-block; position: relative; width: 1.193em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7114\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.063em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -4.342em; left: 0.777em;\"><span class=\"texatom\" id=\"MathJax-Span-7115\"><span class=\"mrow\" id=\"MathJax-Span-7116\"><span class=\"mi\" id=\"MathJax-Span-7117\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7118\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-7119\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-7120\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-7121\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mtext\" id=\"MathJax-Span-7122\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.182em;\">&nbsp;</span><span class=\"msubsup\" id=\"MathJax-Span-7123\"><span style=\"display: inline-block; position: relative; width: 1.193em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.158em, 1000.72em, 4.348em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7124\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -4.342em; left: 0.717em;\"><span class=\"texatom\" id=\"MathJax-Span-7125\"><span class=\"mrow\" id=\"MathJax-Span-7126\"><span class=\"mi\" id=\"MathJax-Span-7127\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7128\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-7129\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-7130\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-7131\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.182em;\">a</span><span class=\"mo\" id=\"MathJax-Span-7132\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.265em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>,</mo><mtext>&nbsp;</mtext><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-466\">V^{\\pi}(s),\\ Q^{\\pi}(s,a)</script></td>\n<td class=\"tg-tleft-valign-first\">Expected return under policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-467-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7133\" style=\"width: 0.717em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.67em, 1000.6em, 2.443em, -999.997em); top: -2.259em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7134\"><span class=\"mi\" id=\"MathJax-Span-7135\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.063em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.265em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.646em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-467\">\\pi</script></td>\n<td class=\"tg-tleft-valign-first\">Policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-468-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7136\" style=\"width: 0.717em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.67em, 1000.6em, 2.443em, -999.997em); top: -2.259em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7137\"><span class=\"mi\" id=\"MathJax-Span-7138\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.063em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.265em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.646em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-468\">\\pi</script> and environment dynamics</td>\n<td class=\"tg-tleft-valign-second\">Expected future return from a state or state‚Äìaction pair</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Advantage Function</td>\n<td class=\"tg-tleft-valign-first\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-469-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7139\" style=\"width: 9.051em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.503em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(3.158em, 1007.44em, 5.717em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7140\"><span style=\"display: inline-block; position: relative; width: 7.503em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.158em, 1007.44em, 4.348em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"msubsup\" id=\"MathJax-Span-7141\"><span style=\"display: inline-block; position: relative; width: 1.074em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.158em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7142\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -4.342em; left: 0.598em;\"><span class=\"texatom\" id=\"MathJax-Span-7143\"><span class=\"mrow\" id=\"MathJax-Span-7144\"><span class=\"mi\" id=\"MathJax-Span-7145\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7146\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-7147\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-7148\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-7149\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.182em;\">a</span><span class=\"mo\" id=\"MathJax-Span-7150\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-7151\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.301em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-7152\" style=\"padding-left: 0.301em;\"><span style=\"display: inline-block; position: relative; width: 1.193em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.158em, 1000.72em, 4.348em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7153\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -4.342em; left: 0.717em;\"><span class=\"texatom\" id=\"MathJax-Span-7154\"><span class=\"mrow\" id=\"MathJax-Span-7155\"><span class=\"mi\" id=\"MathJax-Span-7156\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7157\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-7158\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-7159\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-7160\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.182em;\">a</span><span class=\"mo\" id=\"MathJax-Span-7161\" style=\"font-family: STIXGeneral-Regular;\">)</span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; clip: rect(3.158em, 1003.16em, 4.348em, -999.997em); top: -2.616em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-7162\" style=\"font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-7163\" style=\"padding-left: 0.241em;\"><span style=\"display: inline-block; position: relative; width: 1.193em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7164\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.063em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -4.342em; left: 0.777em;\"><span class=\"texatom\" id=\"MathJax-Span-7165\"><span class=\"mrow\" id=\"MathJax-Span-7166\"><span class=\"mi\" id=\"MathJax-Span-7167\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7168\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-7169\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-7170\" style=\"font-family: STIXGeneral-Regular;\">)</span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.925em; border-left: 0px solid; width: 0px; height: 2.789em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>A</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-469\">A^{\\pi}(s,a) = Q^{\\pi}(s,a) - V^{\\pi}(s)</script></td>\n<td class=\"tg-tleft-valign-first\">Relative benefit of an action vs. average action</td>\n<td class=\"tg-tleft-valign-first\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-470-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo>,</mo><mtext>&amp;#xA0;</mtext><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7171\" style=\"width: 3.753em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.098em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.432em, 1003.1em, 2.622em, -999.997em); top: -2.259em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7172\"><span class=\"msubsup\" id=\"MathJax-Span-7173\"><span style=\"display: inline-block; position: relative; width: 1.193em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.158em, 1000.72em, 4.348em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7174\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -4.342em; left: 0.717em;\"><span class=\"texatom\" id=\"MathJax-Span-7175\"><span class=\"mrow\" id=\"MathJax-Span-7176\"><span class=\"mi\" id=\"MathJax-Span-7177\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7178\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mtext\" id=\"MathJax-Span-7179\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.182em;\">&nbsp;</span><span class=\"msubsup\" id=\"MathJax-Span-7180\"><span style=\"display: inline-block; position: relative; width: 1.193em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7181\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.063em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -4.342em; left: 0.777em;\"><span class=\"texatom\" id=\"MathJax-Span-7182\"><span class=\"mrow\" id=\"MathJax-Span-7183\"><span class=\"mi\" id=\"MathJax-Span-7184\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.265em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo>,</mo><mtext>&nbsp;</mtext><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-470\">Q^{\\pi},\\ V^{\\pi}</script></td>\n<td class=\"tg-tleft-valign-second\">Measures how much better or worse an action is than expected</td>\n</tr>\n</tbody>\n</table>\n</div>\n<table class=\"tg\">\n<thead>\n<tr>\n<th class=\"tg-hcenter-valign-first\"><strong>Concept</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Symbol</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Definition</strong></th>\n<th class=\"tg-hcenter-valign-first\"><strong>Depends on</strong></th>\n<th class=\"tg-hcenter-valign-second\"><strong>Meaning</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tg-tleft-valign-first\">Return</td>\n<td class=\"tg-tleft-valign-first\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-464-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>G</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7101\" style=\"width: 1.253em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.015em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.372em, 1001.01em, 2.562em, -999.997em); top: -2.199em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7102\"><span class=\"msubsup\" id=\"MathJax-Span-7103\"><span style=\"display: inline-block; position: relative; width: 1.015em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7104\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -3.807em; left: 0.717em;\"><span class=\"mi\" id=\"MathJax-Span-7105\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.205em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>G</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-464\">G_t</script></td>\n<td class=\"tg-tleft-valign-first\">Actual total (discounted) future reward</td>\n<td class=\"tg-tleft-valign-first\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-465-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>r</mi><mi>t</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7106\" style=\"width: 0.836em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.658em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.61em, 1000.66em, 2.562em, -999.997em); top: -2.199em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7107\"><span class=\"msubsup\" id=\"MathJax-Span-7108\"><span style=\"display: inline-block; position: relative; width: 0.658em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.396em, 1000.42em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7109\" style=\"font-family: STIXGeneral-Italic;\">r<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -3.807em; left: 0.42em;\"><span class=\"mi\" id=\"MathJax-Span-7110\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.205em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.861em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>t</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-465\">r_t</script></td>\n<td class=\"tg-tleft-valign-second\">Realized outcome of a trajectory</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Value Function</td>\n<td class=\"tg-tleft-valign-first\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-466-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mtext>&amp;#xA0;</mtext><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7111\" style=\"width: 7.324em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.074em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.432em, 1006.01em, 2.622em, -999.997em); top: -2.259em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7112\"><span class=\"msubsup\" id=\"MathJax-Span-7113\"><span style=\"display: inline-block; position: relative; width: 1.193em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7114\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.063em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -4.342em; left: 0.777em;\"><span class=\"texatom\" id=\"MathJax-Span-7115\"><span class=\"mrow\" id=\"MathJax-Span-7116\"><span class=\"mi\" id=\"MathJax-Span-7117\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7118\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-7119\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-7120\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-7121\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mtext\" id=\"MathJax-Span-7122\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.182em;\">&nbsp;</span><span class=\"msubsup\" id=\"MathJax-Span-7123\"><span style=\"display: inline-block; position: relative; width: 1.193em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.158em, 1000.72em, 4.348em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7124\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -4.342em; left: 0.717em;\"><span class=\"texatom\" id=\"MathJax-Span-7125\"><span class=\"mrow\" id=\"MathJax-Span-7126\"><span class=\"mi\" id=\"MathJax-Span-7127\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7128\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-7129\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-7130\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-7131\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.182em;\">a</span><span class=\"mo\" id=\"MathJax-Span-7132\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.265em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>,</mo><mtext>&nbsp;</mtext><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-466\">V^{\\pi}(s),\\ Q^{\\pi}(s,a)</script></td>\n<td class=\"tg-tleft-valign-first\">Expected return under policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-467-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7133\" style=\"width: 0.717em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.67em, 1000.6em, 2.443em, -999.997em); top: -2.259em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7134\"><span class=\"mi\" id=\"MathJax-Span-7135\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.063em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.265em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.646em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-467\">\\pi</script></td>\n<td class=\"tg-tleft-valign-first\">Policy <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-468-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C0;</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7136\" style=\"width: 0.717em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.67em, 1000.6em, 2.443em, -999.997em); top: -2.259em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7137\"><span class=\"mi\" id=\"MathJax-Span-7138\" style=\"font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.063em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.265em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.646em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>œÄ</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-468\">\\pi</script> and environment dynamics</td>\n<td class=\"tg-tleft-valign-second\">Expected future return from a state or state‚Äìaction pair</td>\n</tr>\n<tr>\n<td class=\"tg-tleft-valign-first\">Advantage Function</td>\n<td class=\"tg-tleft-valign-first\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-469-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7139\" style=\"width: 9.051em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.503em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(3.158em, 1007.44em, 5.717em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7140\"><span style=\"display: inline-block; position: relative; width: 7.503em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.158em, 1007.44em, 4.348em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"msubsup\" id=\"MathJax-Span-7141\"><span style=\"display: inline-block; position: relative; width: 1.074em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.158em, 1000.54em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7142\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -4.342em; left: 0.598em;\"><span class=\"texatom\" id=\"MathJax-Span-7143\"><span class=\"mrow\" id=\"MathJax-Span-7144\"><span class=\"mi\" id=\"MathJax-Span-7145\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7146\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-7147\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-7148\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-7149\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.182em;\">a</span><span class=\"mo\" id=\"MathJax-Span-7150\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-7151\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.301em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-7152\" style=\"padding-left: 0.301em;\"><span style=\"display: inline-block; position: relative; width: 1.193em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.158em, 1000.72em, 4.348em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7153\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -4.342em; left: 0.717em;\"><span class=\"texatom\" id=\"MathJax-Span-7154\"><span class=\"mrow\" id=\"MathJax-Span-7155\"><span class=\"mi\" id=\"MathJax-Span-7156\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7157\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-7158\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-7159\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-7160\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.182em;\">a</span><span class=\"mo\" id=\"MathJax-Span-7161\" style=\"font-family: STIXGeneral-Regular;\">)</span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; clip: rect(3.158em, 1003.16em, 4.348em, -999.997em); top: -2.616em; left: 0em;\"><span class=\"mo\" id=\"MathJax-Span-7162\" style=\"font-family: STIXGeneral-Regular;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-7163\" style=\"padding-left: 0.241em;\"><span style=\"display: inline-block; position: relative; width: 1.193em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7164\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.063em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -4.342em; left: 0.777em;\"><span class=\"texatom\" id=\"MathJax-Span-7165\"><span class=\"mrow\" id=\"MathJax-Span-7166\"><span class=\"mi\" id=\"MathJax-Span-7167\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7168\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-7169\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-7170\" style=\"font-family: STIXGeneral-Regular;\">)</span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.925em; border-left: 0px solid; width: 0px; height: 2.789em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>A</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-469\">A^{\\pi}(s,a) = Q^{\\pi}(s,a) - V^{\\pi}(s)</script></td>\n<td class=\"tg-tleft-valign-first\">Relative benefit of an action vs. average action</td>\n<td class=\"tg-tleft-valign-first\"><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"MathJax\" id=\"MathJax-Element-470-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo>,</mo><mtext>&amp;#xA0;</mtext><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7171\" style=\"width: 3.753em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.098em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.432em, 1003.1em, 2.622em, -999.997em); top: -2.259em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7172\"><span class=\"msubsup\" id=\"MathJax-Span-7173\"><span style=\"display: inline-block; position: relative; width: 1.193em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.158em, 1000.72em, 4.348em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7174\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -4.342em; left: 0.717em;\"><span class=\"texatom\" id=\"MathJax-Span-7175\"><span class=\"mrow\" id=\"MathJax-Span-7176\"><span class=\"mi\" id=\"MathJax-Span-7177\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7178\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mtext\" id=\"MathJax-Span-7179\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.182em;\">&nbsp;</span><span class=\"msubsup\" id=\"MathJax-Span-7180\"><span style=\"display: inline-block; position: relative; width: 1.193em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.158em, 1000.72em, 4.17em, -999.997em); top: -3.985em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7181\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.063em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span><span style=\"position: absolute; top: -4.342em; left: 0.777em;\"><span class=\"texatom\" id=\"MathJax-Span-7182\"><span class=\"mrow\" id=\"MathJax-Span-7183\"><span class=\"mi\" id=\"MathJax-Span-7184\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 3.991em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.265em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo>,</mo><mtext>&nbsp;</mtext><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-470\">Q^{\\pi},\\ V^{\\pi}</script></td>\n<td class=\"tg-tleft-valign-second\">Measures how much better or worse an action is than expected</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"intuitive-analogy\">Intuitive Analogy</h4>\n<ul>\n  <li>\n    <p>Imagine you‚Äôre a chess player analyzing positions and moves:</p>\n\n    <ul>\n      <li><strong>Return</strong>: The total score you actually get from a game after playing all moves.</li>\n      <li><strong>Value function</strong>: The expected score (based on experience) you think you‚Äôll get from a given position.</li>\n      <li><strong>Advantage function</strong>: How much a particular move improves or worsens your position compared to the average move you would make from that position.</li>\n    </ul>\n  </li>\n</ul>\n<p>Imagine you‚Äôre a chess player analyzing positions and moves:</p>\n<ul>\n      <li><strong>Return</strong>: The total score you actually get from a game after playing all moves.</li>\n      <li><strong>Value function</strong>: The expected score (based on experience) you think you‚Äôll get from a given position.</li>\n      <li><strong>Advantage function</strong>: How much a particular move improves or worsens your position compared to the average move you would make from that position.</li>\n    </ul>\n<h4 id=\"relationship-summary\">Relationship Summary</h4>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-471-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><mtext>Actual discounted sum of rewards</mtext></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7185\" style=\"width: 19.013em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 15.836em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.357em, 1015.78em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7186\"><span class=\"msubsup\" id=\"MathJax-Span-7187\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7188\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-7189\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7190\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mtext\" id=\"MathJax-Span-7191\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">Actual discounted sum of rewards</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msub><mi>G</mi><mi>t</mi></msub><mo>=</mo><mtext>Actual discounted sum of rewards</mtext></math></span></span></div>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-472-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><msub><mi>G</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7192\" style=\"width: 10.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 8.805em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1008.7em, 2.867em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7193\"><span class=\"msubsup\" id=\"MathJax-Span-7194\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7195\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-7196\"><span class=\"mrow\" id=\"MathJax-Span-7197\"><span class=\"mi\" id=\"MathJax-Span-7198\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7199\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-7200\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-7201\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-7202\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-7203\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-7204\"><span class=\"mrow\" id=\"MathJax-Span-7205\"><span class=\"mi\" id=\"MathJax-Span-7206\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-7207\"><span class=\"mrow\" id=\"MathJax-Span-7208\"><span class=\"mi\" id=\"MathJax-Span-7209\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7210\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-7211\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7212\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-7213\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-7214\"><span class=\"mrow\" id=\"MathJax-Span-7215\"><span class=\"mo\" id=\"MathJax-Span-7216\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-7217\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7218\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-7219\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7220\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-7221\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-7222\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msub><mo stretchy=\"false\">[</mo><msub><mi>G</mi><mi>t</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi><mo stretchy=\"false\">]</mo></math></span></span></div>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-473-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><msub><mi>G</mi><mi>t</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>=</mo><mi>a</mi><mo stretchy=&quot;false&quot;>]</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7223\" style=\"width: 15.159em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 12.607em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.617em, 1012.5em, 2.867em, -999.997em); top: -2.497em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7224\"><span class=\"msubsup\" id=\"MathJax-Span-7225\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7226\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-7227\"><span class=\"mrow\" id=\"MathJax-Span-7228\"><span class=\"mi\" id=\"MathJax-Span-7229\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7230\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-7231\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-7232\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-7233\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-7234\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-7235\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-7236\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.096em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-7237\"><span class=\"mrow\" id=\"MathJax-Span-7238\"><span class=\"mi\" id=\"MathJax-Span-7239\" style=\"font-family: STIXGeneral-Regular;\">ùîº</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-7240\"><span class=\"mrow\" id=\"MathJax-Span-7241\"><span class=\"mi\" id=\"MathJax-Span-7242\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7243\" style=\"font-family: STIXGeneral-Regular;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-7244\"><span style=\"display: inline-block; position: relative; width: 0.992em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.73em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7245\" style=\"font-family: STIXGeneral-Italic;\">G</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.732em;\"><span class=\"mi\" id=\"MathJax-Span-7246\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"texatom\" id=\"MathJax-Span-7247\"><span class=\"mrow\" id=\"MathJax-Span-7248\"><span class=\"mo\" id=\"MathJax-Span-7249\" style=\"font-family: STIXVariants;\">|</span></span></span><span class=\"msubsup\" id=\"MathJax-Span-7250\"><span style=\"display: inline-block; position: relative; width: 0.68em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.37em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7251\" style=\"font-family: STIXGeneral-Italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.367em;\"><span class=\"mi\" id=\"MathJax-Span-7252\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7253\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-7254\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">s</span><span class=\"mo\" id=\"MathJax-Span-7255\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-7256\" style=\"padding-left: 0.211em;\"><span style=\"display: inline-block; position: relative; width: 0.784em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.44em, 1000.47em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7257\" style=\"font-family: STIXGeneral-Italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -3.852em; left: 0.523em;\"><span class=\"mi\" id=\"MathJax-Span-7258\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">t<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7259\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"mi\" id=\"MathJax-Span-7260\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.315em;\">a</span><span class=\"mo\" id=\"MathJax-Span-7261\" style=\"font-family: STIXGeneral-Regular;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.503em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">E</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msub><mo stretchy=\"false\">[</mo><msub><mi>G</mi><mi>t</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mi>s</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi><mo>,</mo><msub><mi>a</mi><mi>t</mi></msub><mo>=</mo><mi>a</mi><mo stretchy=\"false\">]</mo></math></span></span></div>\n<div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-474-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><msup><mi>Q</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><msup><mi>V</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>&amp;#x03C0;</mi></mrow></msup><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7262\" style=\"width: 12.919em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.732em; height: 0px; font-size: 120%;\"><span style=\"position: absolute; clip: rect(1.305em, 1010.68em, 2.503em, -999.997em); top: -2.185em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7263\"><span class=\"msubsup\" id=\"MathJax-Span-7264\"><span style=\"display: inline-block; position: relative; width: 1.044em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7265\" style=\"font-family: STIXGeneral-Italic;\">A</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.628em;\"><span class=\"texatom\" id=\"MathJax-Span-7266\"><span class=\"mrow\" id=\"MathJax-Span-7267\"><span class=\"mi\" id=\"MathJax-Span-7268\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7269\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-7270\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-7271\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-7272\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-7273\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-7274\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.315em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-7275\" style=\"padding-left: 0.315em;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.326em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7276\" style=\"font-family: STIXGeneral-Italic;\">Q</span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.732em;\"><span class=\"texatom\" id=\"MathJax-Span-7277\"><span class=\"mrow\" id=\"MathJax-Span-7278\"><span class=\"mi\" id=\"MathJax-Span-7279\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7280\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-7281\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-7282\" style=\"font-family: STIXGeneral-Regular;\">,</span><span class=\"mi\" id=\"MathJax-Span-7283\" style=\"font-family: STIXGeneral-Italic; padding-left: 0.211em;\">a</span><span class=\"mo\" id=\"MathJax-Span-7284\" style=\"font-family: STIXGeneral-Regular;\">)</span><span class=\"mo\" id=\"MathJax-Span-7285\" style=\"font-family: STIXGeneral-Regular; padding-left: 0.263em;\">‚àí</span><span class=\"msubsup\" id=\"MathJax-Span-7286\" style=\"padding-left: 0.263em;\"><span style=\"display: inline-block; position: relative; width: 1.201em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.18em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7287\" style=\"font-family: STIXGeneral-Italic;\">V<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.055em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span><span style=\"position: absolute; top: -4.424em; left: 0.784em;\"><span class=\"texatom\" id=\"MathJax-Span-7288\"><span class=\"mrow\" id=\"MathJax-Span-7289\"><span class=\"mi\" id=\"MathJax-Span-7290\" style=\"font-size: 70.7%; font-family: STIXGeneral-Italic;\">œÄ<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.013em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-7291\" style=\"font-family: STIXGeneral-Regular;\">(</span><span class=\"mi\" id=\"MathJax-Span-7292\" style=\"font-family: STIXGeneral-Italic;\">s</span><span class=\"mo\" id=\"MathJax-Span-7293\" style=\"font-family: STIXGeneral-Regular;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.19em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><msup><mi>A</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>Q</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>‚àí</mo><msup><mi>V</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>œÄ</mi></mrow></msup><mo stretchy=\"false\">(</mo><mi>s</mi><mo stretchy=\"false\">)</mo></math></span></span></div>\n<p><strong>In short:</strong></p>\n<ul>\n  <li><strong>Return</strong> is what actually happened (realized reward sequence).</li>\n  <li><strong>Value function</strong> is the expected return under a policy.</li>\n  <li><strong>Advantage function</strong> measures how much better or worse an action is compared to the average action expected by that policy.</li>\n</ul>",
    "contentMarkdown": "*   Here‚Äôs a detailed explanation of the **differences between the Value function, Return, and Advantage function** in reinforcement learning, including their definitions, mathematical forms, and conceptual distinctions.\n\n#### Return (GGG)\n\n*   **Definition:**\n    *   The **return** represents the observed **total accumulated reward** (often discounted) that an agent receives after a certain time step within a _single trajectory_.\n    *   It quantifies the actual outcome of one specific episode or rollout.\n    *   It is the foundational quantity from which value and advantage functions are derived.\n        \n    *   Mathematically, for time step ttt:\n        \n        Gt\\=‚àëk\\=0‚àûŒ≥krt+kGt\\=‚àëk\\=0‚àûŒ≥krt+k\n        \n        G\\_t = \\\\sum\\_{k=0}^{\\\\infty} \\\\gamma^k r\\_{t+k}\n    *   where:\n        \n        *   rt+krt+kr\\_{t+k} is the reward received kkk steps after time ttt,\n        *   Œ≥‚àà\\[0,1)Œ≥‚àà\\[0,1)\\\\gamma \\\\in \\[0,1) is the **discount factor**, weighting immediate rewards more heavily than distant ones.\n*   **Intuition:**\n    \n    *   The return quantifies _‚Äúhow much total reward the agent will get from now on.‚Äù_\n    *   It depends directly on the actual sequence of rewards received and not on any expectation or policy.\n    *   The return GtGtG\\_t is a **realized quantity**, computed from one sampled trajectory of states, actions, and rewards.\n    *   Different rollouts can produce different returns even from the same state, because the environment and policy may be stochastic.\n*   **Example:**\n    *   If the agent receives rewards \\[2,3,1\\]\\[2,3,1\\]\\[2, 3, 1\\] over three time steps and Œ≥\\=0.9Œ≥\\=0.9\\\\gamma = 0.9, then G0\\=2+0.9(3)+0.92(1)\\=2+2.7+0.81\\=5.51G0\\=2+0.9(3)+0.92(1)\\=2+2.7+0.81\\=5.51G\\_0 = 2 + 0.9(3) + 0.9^2(1) = 2 + 2.7 + 0.81 = 5.51.\n\n*   The **return** represents the observed **total accumulated reward** (often discounted) that an agent receives after a certain time step within a _single trajectory_.\n*   It quantifies the actual outcome of one specific episode or rollout.\n*   It is the foundational quantity from which value and advantage functions are derived.\n    \n*   Mathematically, for time step ttt:\n    \n    Gt\\=‚àëk\\=0‚àûŒ≥krt+kGt\\=‚àëk\\=0‚àûŒ≥krt+k\n    \n    G\\_t = \\\\sum\\_{k=0}^{\\\\infty} \\\\gamma^k r\\_{t+k}\n*   where:\n    \n    *   rt+krt+kr\\_{t+k} is the reward received kkk steps after time ttt,\n    *   Œ≥‚àà\\[0,1)Œ≥‚àà\\[0,1)\\\\gamma \\\\in \\[0,1) is the **discount factor**, weighting immediate rewards more heavily than distant ones.\n\nIt is the foundational quantity from which value and advantage functions are derived.\n\nMathematically, for time step ttt:\n\nwhere:\n\n*   rt+krt+kr\\_{t+k} is the reward received kkk steps after time ttt,\n*   Œ≥‚àà\\[0,1)Œ≥‚àà\\[0,1)\\\\gamma \\\\in \\[0,1) is the **discount factor**, weighting immediate rewards more heavily than distant ones.\n\n**Intuition:**\n\n*   The return quantifies _‚Äúhow much total reward the agent will get from now on.‚Äù_\n*   It depends directly on the actual sequence of rewards received and not on any expectation or policy.\n*   The return GtGtG\\_t is a **realized quantity**, computed from one sampled trajectory of states, actions, and rewards.\n*   Different rollouts can produce different returns even from the same state, because the environment and policy may be stochastic.\n\n*   If the agent receives rewards \\[2,3,1\\]\\[2,3,1\\]\\[2, 3, 1\\] over three time steps and Œ≥\\=0.9Œ≥\\=0.9\\\\gamma = 0.9, then G0\\=2+0.9(3)+0.92(1)\\=2+2.7+0.81\\=5.51G0\\=2+0.9(3)+0.92(1)\\=2+2.7+0.81\\=5.51G\\_0 = 2 + 0.9(3) + 0.9^2(1) = 2 + 2.7 + 0.81 = 5.51.\n\n#### Value Function (VVV or QQQ)\n\n*   **Definition:**\n    *   The **value function** predicts the **expected return** ‚Äî that is, the _average total future reward_ an agent can expect to receive from a given state (or state‚Äìaction pair), averaged over all possible future trajectories induced by the policy œÄœÄ\\\\pi.\n    *   It generalizes over many possible trajectories rather than a single one.\n    *   There are two common types:\n        \n    *   **State-value function:**\n        \n        VœÄ(s)\\=ùîºœÄ\\[Gt‚à£st\\=s\\]VœÄ(s)\\=EœÄ\\[Gt‚à£st\\=s\\]\n        \n        V^{\\\\pi}(s) = \\\\mathbb{E}\\_{\\\\pi} \\[G\\_t \\\\mid s\\_t = s\\]\n        *   Measures how good it is to _be_ in a given state sss under policy œÄœÄ\\\\pi.\n    *   **Action-value function:**\n        \n        QœÄ(s,a)\\=ùîºœÄ\\[Gt‚à£st\\=s,at\\=a\\]QœÄ(s,a)\\=EœÄ\\[Gt‚à£st\\=s,at\\=a\\]\n        \n        Q^{\\\\pi}(s, a) = \\\\mathbb{E}\\_{\\\\pi} \\[G\\_t \\\\mid s\\_t = s, a\\_t = a\\]\n        *   Measures how good it is to _take action_ aaa in state sss and then follow policy œÄœÄ\\\\pi.\n*   **Intuition:**\n    \n    *   The value function provides an _expected future outlook_ rather than a realized one.\n    *   It maps a state (or state‚Äìaction pair) to how desirable that situation is in the long run under a specific policy.\n    *   While the **return** GtGtG\\_t is computed for a single trajectory, the **value function** VœÄ(s)VœÄ(s)V^{\\\\pi}(s) or QœÄ(s,a)QœÄ(s,a)Q^{\\\\pi}(s, a) takes the _expectation over many such trajectories_.\n    *   It captures the **average long-term desirability** of a state or action under a policy.\n*   **Example:**\n    *   If the agent expects, on average, to receive total rewards of 5.5 whenever it‚Äôs in state sss, then V(s)\\=5.5V(s)\\=5.5V(s) = 5.5.\n\n*   The **value function** predicts the **expected return** ‚Äî that is, the _average total future reward_ an agent can expect to receive from a given state (or state‚Äìaction pair), averaged over all possible future trajectories induced by the policy œÄœÄ\\\\pi.\n*   It generalizes over many possible trajectories rather than a single one.\n*   There are two common types:\n    \n*   **State-value function:**\n    \n    VœÄ(s)\\=ùîºœÄ\\[Gt‚à£st\\=s\\]VœÄ(s)\\=EœÄ\\[Gt‚à£st\\=s\\]\n    \n    V^{\\\\pi}(s) = \\\\mathbb{E}\\_{\\\\pi} \\[G\\_t \\\\mid s\\_t = s\\]\n    *   Measures how good it is to _be_ in a given state sss under policy œÄœÄ\\\\pi.\n*   **Action-value function:**\n    \n    QœÄ(s,a)\\=ùîºœÄ\\[Gt‚à£st\\=s,at\\=a\\]QœÄ(s,a)\\=EœÄ\\[Gt‚à£st\\=s,at\\=a\\]\n    \n    Q^{\\\\pi}(s, a) = \\\\mathbb{E}\\_{\\\\pi} \\[G\\_t \\\\mid s\\_t = s, a\\_t = a\\]\n    *   Measures how good it is to _take action_ aaa in state sss and then follow policy œÄœÄ\\\\pi.\n\nThere are two common types:\n\n**State-value function:**\n\n*   Measures how good it is to _be_ in a given state sss under policy œÄœÄ\\\\pi.\n\n**Action-value function:**\n\n*   Measures how good it is to _take action_ aaa in state sss and then follow policy œÄœÄ\\\\pi.\n\n**Intuition:**\n\n*   The value function provides an _expected future outlook_ rather than a realized one.\n*   It maps a state (or state‚Äìaction pair) to how desirable that situation is in the long run under a specific policy.\n*   While the **return** GtGtG\\_t is computed for a single trajectory, the **value function** VœÄ(s)VœÄ(s)V^{\\\\pi}(s) or QœÄ(s,a)QœÄ(s,a)Q^{\\\\pi}(s, a) takes the _expectation over many such trajectories_.\n*   It captures the **average long-term desirability** of a state or action under a policy.\n\n*   If the agent expects, on average, to receive total rewards of 5.5 whenever it‚Äôs in state sss, then V(s)\\=5.5V(s)\\=5.5V(s) = 5.5.\n\n#### Advantage Function (AAA)\n\n*   **Definition:**\n    \n    *   The **advantage function** quantifies how much _better (or worse)_ a particular action is compared to the average action at a given state under the current policy œÄœÄ\\\\pi.\n    *   It is formally defined as:\n    \n    AœÄ(s,a)\\=QœÄ(s,a)‚àíVœÄ(s)AœÄ(s,a)\\=QœÄ(s,a)‚àíVœÄ(s)\n    \n    A^{\\\\pi}(s, a) = Q^{\\\\pi}(s, a) - V^{\\\\pi}(s)\n    \n    This makes it an **action-level** function, since it depends on both the state sss and the action aaa.\n    \n*   **Practical usage:**\n    \n    *   In most real-world settings (e.g., PPO or actor‚Äìcritic methods), we rarely have direct access to the action-value function QœÄ(s,a)QœÄ(s,a)Q^{\\\\pi}(s,a).\n        \n    *   The only exceptions are small **tabular** or **discrete environments**‚Äîlike those used in DQN or Monte Carlo policy evaluation‚Äîwhere QQQ can be explicitly estimated from replay or full trajectories.\n        \n    *   For high-dimensional or continuous policies (such as large language models in RLHF), QœÄ(s,a)QœÄ(s,a)Q^{\\\\pi}(s,a) is **approximated from rollouts** as\n        \n        QœÄ(st,at)‚âàrt+Œ≥V(st+1)QœÄ(st,at)‚âàrt+Œ≥V(st+1)\n        \n        Q^{\\\\pi}(s\\_t,a\\_t) \\\\approx r\\_t + \\\\gamma V(s\\_{t+1})\n    *   Substituting this into the definition yields the empirical advantage estimate:\n        \n        At‚âàrt+Œ≥V(st+1)‚àíV(st)At‚âàrt+Œ≥V(st+1)‚àíV(st)\n        \n        A\\_t \\\\approx r\\_t + \\\\gamma V(s\\_{t+1}) - V(s\\_t)\n    *   In one-step or bandit-style tasks (such as RLHF with a single scalar reward per response), this simplifies further to\n        \n        At\\=rt‚àíV(st)At\\=rt‚àíV(st)\n        \n        A\\_t = r\\_t - V(s\\_t)\n    \n    Thus, while the advantage is **defined** at the action level, in practice it is **computed via state-value approximations**, except in domains where QQQ can be directly learned.\n    \n*   **Interpretation:**\n    \n    *   AœÄ(s,a)\\>0AœÄ(s,a)\\>0A^{\\\\pi}(s, a) > 0: Action aaa is better than the average action in state sss.\n    *   AœÄ(s,a)<0AœÄ(s,a)<0A^{\\\\pi}(s, a) < 0: Action aaa is worse than average.\n    *   AœÄ(s,a)\\=0AœÄ(s,a)\\=0A^{\\\\pi}(s, a) = 0: Action aaa is equally as good as the expected average behavior of the policy.\n*   **Why it‚Äôs useful:**\n    \n    *   The advantage function is crucial in policy gradient methods (e.g., PPO, A2C) because it **reduces variance** in gradient estimation‚Äîfocusing updates on actions that performed better or worse than expected, rather than on absolute returns.\n\n**Definition:**\n\n*   The **advantage function** quantifies how much _better (or worse)_ a particular action is compared to the average action at a given state under the current policy œÄœÄ\\\\pi.\n*   It is formally defined as:\n\nThis makes it an **action-level** function, since it depends on both the state sss and the action aaa.\n\n**Practical usage:**\n\n*   In most real-world settings (e.g., PPO or actor‚Äìcritic methods), we rarely have direct access to the action-value function QœÄ(s,a)QœÄ(s,a)Q^{\\\\pi}(s,a).\n    \n*   The only exceptions are small **tabular** or **discrete environments**‚Äîlike those used in DQN or Monte Carlo policy evaluation‚Äîwhere QQQ can be explicitly estimated from replay or full trajectories.\n    \n*   For high-dimensional or continuous policies (such as large language models in RLHF), QœÄ(s,a)QœÄ(s,a)Q^{\\\\pi}(s,a) is **approximated from rollouts** as\n    \n    QœÄ(st,at)‚âàrt+Œ≥V(st+1)QœÄ(st,at)‚âàrt+Œ≥V(st+1)\n    \n    Q^{\\\\pi}(s\\_t,a\\_t) \\\\approx r\\_t + \\\\gamma V(s\\_{t+1})\n*   Substituting this into the definition yields the empirical advantage estimate:\n    \n    At‚âàrt+Œ≥V(st+1)‚àíV(st)At‚âàrt+Œ≥V(st+1)‚àíV(st)\n    \n    A\\_t \\\\approx r\\_t + \\\\gamma V(s\\_{t+1}) - V(s\\_t)\n*   In one-step or bandit-style tasks (such as RLHF with a single scalar reward per response), this simplifies further to\n    \n    At\\=rt‚àíV(st)At\\=rt‚àíV(st)\n    \n    A\\_t = r\\_t - V(s\\_t)\n\nIn most real-world settings (e.g., PPO or actor‚Äìcritic methods), we rarely have direct access to the action-value function QœÄ(s,a)QœÄ(s,a)Q^{\\\\pi}(s,a).\n\nThe only exceptions are small **tabular** or **discrete environments**‚Äîlike those used in DQN or Monte Carlo policy evaluation‚Äîwhere QQQ can be explicitly estimated from replay or full trajectories.\n\nFor high-dimensional or continuous policies (such as large language models in RLHF), QœÄ(s,a)QœÄ(s,a)Q^{\\\\pi}(s,a) is **approximated from rollouts** as\n\nSubstituting this into the definition yields the empirical advantage estimate:\n\nIn one-step or bandit-style tasks (such as RLHF with a single scalar reward per response), this simplifies further to\n\nThus, while the advantage is **defined** at the action level, in practice it is **computed via state-value approximations**, except in domains where QQQ can be directly learned.\n\n**Interpretation:**\n\n*   AœÄ(s,a)\\>0AœÄ(s,a)\\>0A^{\\\\pi}(s, a) > 0: Action aaa is better than the average action in state sss.\n*   AœÄ(s,a)<0AœÄ(s,a)<0A^{\\\\pi}(s, a) < 0: Action aaa is worse than average.\n*   AœÄ(s,a)\\=0AœÄ(s,a)\\=0A^{\\\\pi}(s, a) = 0: Action aaa is equally as good as the expected average behavior of the policy.\n\n**Why it‚Äôs useful:**\n\n*   The advantage function is crucial in policy gradient methods (e.g., PPO, A2C) because it **reduces variance** in gradient estimation‚Äîfocusing updates on actions that performed better or worse than expected, rather than on absolute returns.\n\n#### Comparative Analysis\n\n**Concept**\n\n**Symbol**\n\n**Definition**\n\n**Depends on**\n\n**Meaning**\n\nReturn\n\nGtGtG\\_t\n\nActual total (discounted) future reward\n\nrtrtr\\_t\n\nRealized outcome of a trajectory\n\nValue Function\n\nVœÄ(s),¬†QœÄ(s,a)VœÄ(s),¬†QœÄ(s,a)V^{\\\\pi}(s),\\\\ Q^{\\\\pi}(s,a)\n\nExpected return under policy œÄœÄ\\\\pi\n\nPolicy œÄœÄ\\\\pi and environment dynamics\n\nExpected future return from a state or state‚Äìaction pair\n\nAdvantage Function\n\nAœÄ(s,a)\\=QœÄ(s,a)‚àíVœÄ(s)AœÄ(s,a)\\=QœÄ(s,a)‚àíVœÄ(s)A^{\\\\pi}(s,a) = Q^{\\\\pi}(s,a) - V^{\\\\pi}(s)\n\nRelative benefit of an action vs. average action\n\nQœÄ,¬†VœÄQœÄ,¬†VœÄQ^{\\\\pi},\\\\ V^{\\\\pi}\n\nMeasures how much better or worse an action is than expected\n\n**Concept**\n\n**Symbol**\n\n**Definition**\n\n**Depends on**\n\n**Meaning**\n\nReturn\n\nGtGtG\\_t\n\nActual total (discounted) future reward\n\nrtrtr\\_t\n\nRealized outcome of a trajectory\n\nValue Function\n\nVœÄ(s),¬†QœÄ(s,a)VœÄ(s),¬†QœÄ(s,a)V^{\\\\pi}(s),\\\\ Q^{\\\\pi}(s,a)\n\nExpected return under policy œÄœÄ\\\\pi\n\nPolicy œÄœÄ\\\\pi and environment dynamics\n\nExpected future return from a state or state‚Äìaction pair\n\nAdvantage Function\n\nAœÄ(s,a)\\=QœÄ(s,a)‚àíVœÄ(s)AœÄ(s,a)\\=QœÄ(s,a)‚àíVœÄ(s)A^{\\\\pi}(s,a) = Q^{\\\\pi}(s,a) - V^{\\\\pi}(s)\n\nRelative benefit of an action vs. average action\n\nQœÄ,¬†VœÄQœÄ,¬†VœÄQ^{\\\\pi},\\\\ V^{\\\\pi}\n\nMeasures how much better or worse an action is than expected\n\n#### Intuitive Analogy\n\n*   Imagine you‚Äôre a chess player analyzing positions and moves:\n    \n    *   **Return**: The total score you actually get from a game after playing all moves.\n    *   **Value function**: The expected score (based on experience) you think you‚Äôll get from a given position.\n    *   **Advantage function**: How much a particular move improves or worsens your position compared to the average move you would make from that position.\n\nImagine you‚Äôre a chess player analyzing positions and moves:\n\n*   **Return**: The total score you actually get from a game after playing all moves.\n*   **Value function**: The expected score (based on experience) you think you‚Äôll get from a given position.\n*   **Advantage function**: How much a particular move improves or worsens your position compared to the average move you would make from that position.\n\n#### Relationship Summary\n\nGt\\=Actual discounted sum of rewardsGt\\=Actual discounted sum of rewards\n\nVœÄ(s)\\=ùîºœÄ\\[Gt|st\\=s\\]VœÄ(s)\\=EœÄ\\[Gt|st\\=s\\]\n\nQœÄ(s,a)\\=ùîºœÄ\\[Gt|st\\=s,at\\=a\\]QœÄ(s,a)\\=EœÄ\\[Gt|st\\=s,at\\=a\\]\n\nAœÄ(s,a)\\=QœÄ(s,a)‚àíVœÄ(s)AœÄ(s,a)\\=QœÄ(s,a)‚àíVœÄ(s)\n\n**In short:**\n\n*   **Return** is what actually happened (realized reward sequence).\n*   **Value function** is the expected return under a policy.\n*   **Advantage function** measures how much better or worse an action is compared to the average action expected by that policy.",
    "order": 42,
    "orderInChapter": 1,
    "difficulty": 5,
    "estimatedMinutes": 10,
    "tags": [
      "algorithmsarchitecture",
      "reinforcement learning"
    ],
    "metadata": {
      "hasCode": false,
      "hasMath": true,
      "hasImages": false,
      "wordCount": 1993,
      "contentLength": 322280
    },
    "nextCards": [],
    "relatedCards": [],
    "prerequisites": [],
    "sourceUrl": "https://aman.ai/primers/ai/reinforcement-learning/#what-are-the-differences-between-the-value,-return,-and-advantage-function?",
    "scrapedAt": "2025-12-28T11:47:08.463Z"
  }
]