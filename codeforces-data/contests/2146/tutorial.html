<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tutorial</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
      color: #333;
      background: #fafafa;
    }
    .ttypography {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    h3 {
      color: #1a1a1a;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }
    h3 a {
      color: #0066cc;
      text-decoration: none;
    }
    h3 a:hover {
      text-decoration: underline;
    }
    .spoiler {
      margin: 15px 0;
      border: 1px solid #ddd;
      border-radius: 6px;
      overflow: hidden;
    }
    .spoiler-title {
      display: block;
      padding: 12px 15px;
      background: #f0f0f0;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
      border-bottom: 1px solid #ddd;
    }
    .spoiler-title:hover {
      background: #e8e8e8;
    }
    .spoiler-title::before {
      content: '▶ ';
      font-size: 0.8em;
      transition: transform 0.2s;
      display: inline-block;
    }
    .spoiler.open .spoiler-title::before {
      content: '▼ ';
    }
    .spoiler-content {
      padding: 15px;
      background: #fff;
      display: none;
    }
    .spoiler.open .spoiler-content {
      display: block;
    }
    pre, code {
      background: #f5f5f5;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 0.85em;
    }
    pre {
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
    code {
      padding: 2px 5px;
      border-radius: 3px;
    }
    p {
      margin: 10px 0;
    }
    .MathJax {
      font-size: 1.1em;
    }
  </style>
</head>
<body>
  <h1>Editorial</h1>
  <p><a href="https://codeforces.com/blog/entry/146648" target="_blank">View on Codeforces →</a></p>
  
  <div class="ttypography"><p><a href="https://codeforces.com/contest/2146/problem/A" title="Codeforces Round 1052 (Div. 2)">2146A - Equal Occurrences</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Let's focus on the number of occurrences of each element: let <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 1.031em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.76em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="msubsup" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-4" style="font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-5" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>c</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-1">c_i</script> be the number of time that element <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-7"><span class="mi" id="MathJax-Span-8" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">i</script> occurs in the array. To keep a subsequence is to decrease each <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-9" style="width: 1.031em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.76em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-10"><span class="msubsup" id="MathJax-Span-11"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-13" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>c</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-3">c_i</script> by a non-negative integer. We need to make all the non-zero elements in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-14" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-15"><span class="mi" id="MathJax-Span-16" style="font-family: MathJax_Math-italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">c</script> the same while maximizing the sum of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-17" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-18"><span class="mi" id="MathJax-Span-19" style="font-family: MathJax_Math-italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-5">c</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>For each integer <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-20" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-21"><span class="mi" id="MathJax-Span-22" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">x</script>: suppose the value of all non-zero elements in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-23" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-24"><span class="mi" id="MathJax-Span-25" style="font-family: MathJax_Math-italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">c</script> is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-26" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-27"><span class="mi" id="MathJax-Span-28" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">x</script>, what is the length of the longest subsequence?</p> <div class="spoiler"><b class="spoiler-title">Answer</b><div class="spoiler-content" style="display: block;"><p>For those <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-29" style="width: 3.52em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.654em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.464em, 1002.6em, 2.492em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-30"><span class="msubsup" id="MathJax-Span-31"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-32" style="font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-33" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-34" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="mi" id="MathJax-Span-35" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">x</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>c</mi><mi>i</mi></msub><mo>&lt;</mo><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">c_i<x</script>, we decrease it to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-36" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-37"><span class="mn" id="MathJax-Span-38" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-10">0</script>; for those <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-39" style="width: 3.52em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.654em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1002.6em, 2.492em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-40"><span class="msubsup" id="MathJax-Span-41"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-42" style="font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-43" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-44" style="font-family: MathJax_Main; padding-left: 0.273em;">≥</span><span class="mi" id="MathJax-Span-45" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">x</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>c</mi><mi>i</mi></msub><mo>≥</mo><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">c_i\ge x</script>, we decrease it to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-46" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-47"><span class="mi" id="MathJax-Span-48" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">x</script>.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2146/problem/A" title="Codeforces Round 1052 (Div. 2)">2146A - Equal Occurrences</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-777"><span class="MJXp-msubsup" id="MJXp-Span-778"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-780" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-160">c_i</script> be the number of occurrences of element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-781"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782">i</span></span></span><script type="math/tex" id="MathJax-Element-161">i</script> in the array. Let the final number of occurrences of each number be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-783"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-784">x</span></span></span><script type="math/tex" id="MathJax-Element-162">x</script>. For integers <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-785"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786">i</span></span></span><script type="math/tex" id="MathJax-Element-163">i</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-787"><span class="MJXp-msubsup" id="MJXp-Span-788"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-790" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-791" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">x</span></span></span><script type="math/tex" id="MathJax-Element-164">c_i\ge x</script>, we should keep <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-793"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-794">x</span></span></span><script type="math/tex" id="MathJax-Element-165">x</script> occurrences of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-795"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-796">i</span></span></span><script type="math/tex" id="MathJax-Element-166">i</script>; for those <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-797"><span class="MJXp-msubsup" id="MJXp-Span-798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-800" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-801" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-802">x</span></span></span><script type="math/tex" id="MathJax-Element-167">c_i<x</script>, we should keep no occurrences of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-803"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-804">i</span></span></span><script type="math/tex" id="MathJax-Element-168">i</script>. Thus, the length of the subsequence will be the number of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-805"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-806">i</span></span></span><script type="math/tex" id="MathJax-Element-169">i</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-807"><span class="MJXp-msubsup" id="MJXp-Span-808"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-810" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-811" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">x</span></span></span><script type="math/tex" id="MathJax-Element-170">c_i\ge x</script> times <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-813"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814">x</span></span></span><script type="math/tex" id="MathJax-Element-171">x</script>.</p><p>Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-815"><span class="MJXp-mn" id="MJXp-Span-816">0</span><span class="MJXp-mo" id="MJXp-Span-817" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-818">x</span><span class="MJXp-mo" id="MJXp-Span-819" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-820">n</span></span></span><script type="math/tex" id="MathJax-Element-172">0\le x\le n</script>, you can simulate all possible <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-821"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-822">x</span></span></span><script type="math/tex" id="MathJax-Element-173">x</script> and calculate the answer.</p><p>If you sort <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-823"><span class="MJXp-msubsup" id="MJXp-Span-824"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-825" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-826" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-174">c_i</script> in decreasing order, you can observe that the answer is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-827"><span class="MJXp-msubsup" id="MJXp-Span-828"><span class="MJXp-mo" id="MJXp-Span-829" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-830" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-831">1</span><span class="MJXp-mo" id="MJXp-Span-832">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833">i</span><span class="MJXp-mo" id="MJXp-Span-834">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-835">n</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-836"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-838" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-839" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840">i</span></span></span><script type="math/tex" id="MathJax-Element-175">\max_{1\le i\le n}c_i\cdot i</script>. That's because when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-841"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842">x</span><span class="MJXp-mo" id="MJXp-Span-843" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-844"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-846" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-176">x=c_i</script>, there are at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-847"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-848">i</span></span></span><script type="math/tex" id="MathJax-Element-177">i</script> elements that occur at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-849"><span class="MJXp-msubsup" id="MJXp-Span-850"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-851" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-852" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-178">c_i</script> times.</p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-853"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854">O</span><span class="MJXp-mo" id="MJXp-Span-855" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-856">n</span><span class="MJXp-mo" id="MJXp-Span-857" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-179">O(n)</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-858"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-859">O</span><span class="MJXp-mo" id="MJXp-Span-860" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861">n</span><span class="MJXp-mi" id="MJXp-Span-862">log</span><span class="MJXp-mo" id="MJXp-Span-863" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-864">n</span><span class="MJXp-mo" id="MJXp-Span-865" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-180">O(n\log n)</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-866"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867">O</span><span class="MJXp-mo" id="MJXp-Span-868" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-869"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-870" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-871" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-872" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-181">O(n^2)</script>.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><p>By <a class="rated-user user-orange" href="https://codeforces.com/profile/Caylex" title="Master Caylex">Caylex</a>.</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">def</span><span class="pln"> solve</span><span class="pun">():</span><span class="pln">
    n </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
    ls </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">(</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">()))</span><span class="pln">
    a </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n
    </span><span class="kwd">for</span><span class="pln"> x </span><span class="kwd">in</span><span class="pln"> ls</span><span class="pun">:</span><span class="pln">
        a</span><span class="pun">[</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    a </span><span class="pun">=</span><span class="pln"> sorted</span><span class="pun">(</span><span class="pln">a</span><span class="pun">)</span><span class="pln">
    s </span><span class="pun">=</span><span class="pln"> sum</span><span class="pun">(</span><span class="pln">a</span><span class="pun">)</span><span class="pln">
    ans </span><span class="pun">=</span><span class="pln"> s
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
        ans </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">,</span><span class="pln"> s </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> ans</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln">
 
 
t </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">t</span><span class="pun">):</span><span class="pln">
    solve</span><span class="pun">()</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2146/problem/B" title="Codeforces Round 1052 (Div. 2)">2146B - Merging the Sets</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>How to check if there is at least one way to choose the sets?</p> <div class="spoiler"><b class="spoiler-title">Answer</b><div class="spoiler-content" style="display: block;"><p>Obviously, we should choose all the sets.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>How to greedily find two more solutions to choose the sets?</p> <div class="spoiler"><b class="spoiler-title">Answer</b><div class="spoiler-content" style="display: block;"><p>We should choose all the sets but one.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2146/problem/B" title="Codeforces Round 1052 (Div. 2)">2146B - Merging the Sets</a></h3><div class="ttypography"><div class="problem-statement"><div><p>First, all the numbers should occur in at least one given set, or there will be no solutions. And so choosing all the sets is a possible solution.</p><p>Then, we can always try to choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-873"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">n</span><span class="MJXp-mo" id="MJXp-Span-875" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-876">1</span></span></span><script type="math/tex" id="MathJax-Element-182">n-1</script> sets. If there are at least two ways to choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-877"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-878">n</span><span class="MJXp-mo" id="MJXp-Span-879" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-880">1</span></span></span><script type="math/tex" id="MathJax-Element-183">n-1</script> sets to cover all the numbers, the answer is "Yes". Otherwise, there should be no way to choose less than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-881"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">n</span><span class="MJXp-mo" id="MJXp-Span-883" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-884">1</span></span></span><script type="math/tex" id="MathJax-Element-184">n-1</script> sets to cover all the numbers (suppose not, then there should be at least two ways to choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-885"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-886">n</span><span class="MJXp-mo" id="MJXp-Span-887" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-888">1</span></span></span><script type="math/tex" id="MathJax-Element-185">n-1</script> sets), so the answer is "No".</p><p>We can use a bucket to store the number of occurrences of each element. When trying not to choose the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-889"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">i</span></span></span><script type="math/tex" id="MathJax-Element-186">i</script>-th set, just iterate over the set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-891"><span class="MJXp-msubsup" id="MJXp-Span-892"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-893" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-894" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-187">S_i</script>, delete the number of occurrences of elements in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-895"><span class="MJXp-msubsup" id="MJXp-Span-896"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-898" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-188">S_i</script>, and it's easy to check if any element of the bucket turns into zero.</p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-899"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-900">O</span><span class="MJXp-mo" id="MJXp-Span-901" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-902">n</span><span class="MJXp-mo" id="MJXp-Span-903" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-904">m</span><span class="MJXp-mo" id="MJXp-Span-905" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-906" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-msubsup" id="MJXp-Span-907"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-908" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-909" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-910" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-189">O(n+m+\sum l_i)</script>.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><p>By <a class="rated-user user-orange" href="https://codeforces.com/profile/Caylex" title="Master Caylex">Caylex</a>.</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">def</span><span class="pln"> solve</span><span class="pun">():</span><span class="pln">
    n</span><span class="pun">,</span><span class="pln"> m </span><span class="pun">=</span><span class="pln"> map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">())</span><span class="pln">
    cnt </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> m
    t </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    v </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
        v</span><span class="pun">.</span><span class="pln">append</span><span class="pun">([])</span><span class="pln">
        inp </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">(</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">()))</span><span class="pln">
        l </span><span class="pun">=</span><span class="pln"> inp</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> j </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> l </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">):</span><span class="pln">
            x </span><span class="pun">=</span><span class="pln"> inp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln">
            x </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            t </span><span class="pun">+=</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln">
            cnt</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            v</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">append</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln">
    ans </span><span class="pun">=</span><span class="pln"> t </span><span class="pun">==</span><span class="pln"> m
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> x </span><span class="kwd">in</span><span class="pln"> v</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]:</span><span class="pln">
            cnt</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            t </span><span class="pun">-=</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln">
        ans </span><span class="pun">+=</span><span class="pln"> t </span><span class="pun">==</span><span class="pln"> m
        </span><span class="kwd">for</span><span class="pln"> x </span><span class="kwd">in</span><span class="pln"> v</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]:</span><span class="pln">
            t </span><span class="pun">+=</span><span class="pln"> </span><span class="kwd">not</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln">
            cnt</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"YES"</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> ans </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="str">"NO"</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln">


t </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">t</span><span class="pun">):</span><span class="pln">
    solve</span><span class="pun">()</span><span class="pln">
</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2146/problem/C" title="Codeforces Round 1052 (Div. 2)">2146C - Wrong Binary Search</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>How to check if an element <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-49" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-50"><span class="mi" id="MathJax-Span-51" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">x</script> is stable? For an element <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-52" style="width: 1.085em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.814em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.81em, 2.492em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-53"><span class="msubsup" id="MathJax-Span-54"><span style="display: inline-block; position: relative; width: 0.814em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-55" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-56" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-14">p_i</script>, we only care about whether <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-57" style="width: 3.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.708em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.464em, 1002.65em, 2.546em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-58"><span class="msubsup" id="MathJax-Span-59"><span style="display: inline-block; position: relative; width: 0.814em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-60" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-61" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-62" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="mi" id="MathJax-Span-63" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">x</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>i</mi></msub><mo>&lt;</mo><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">p_i<x</script>, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-64" style="width: 3.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.708em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.572em, 1002.65em, 2.546em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-65"><span class="msubsup" id="MathJax-Span-66"><span style="display: inline-block; position: relative; width: 0.814em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-67" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-68" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-69" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">x</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>i</mi></msub><mo>=</mo><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">p_i=x</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-71" style="width: 3.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.708em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.464em, 1002.65em, 2.546em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-72"><span class="msubsup" id="MathJax-Span-73"><span style="display: inline-block; position: relative; width: 0.814em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-74" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-75" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-76" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="mi" id="MathJax-Span-77" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">x</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>i</mi></msub><mo>&gt;</mo><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-17">p_i>x</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>If an element is not stable, we can choose <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-78" style="width: 1.139em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.87em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-79"><span class="mi" id="MathJax-Span-80" style="font-family: MathJax_Math-italic;">m</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi></math></span></span><script type="math/tex" id="MathJax-Element-18">m</script> correctly in the first step to exclude <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-81" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-82"><span class="mi" id="MathJax-Span-83" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">x</script> from interval <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-84" style="width: 2.33em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.734em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1001.63em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-85"><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-87" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-88" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">r</span><span class="mo" id="MathJax-Span-90" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>l</mi><mo>,</mo><mi>r</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-20">[l,r]</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2146/problem/C" title="Codeforces Round 1052 (Div. 2)">2146C - Wrong Binary Search</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Let's consider checking if the value <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-911"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-912">x</span></span></span><script type="math/tex" id="MathJax-Element-190">x</script> is <span class="tex-font-style-it">stable</span>:</p><ul><li> Let's denote the elements <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-913"><span class="MJXp-mo" id="MJXp-Span-914" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">x</span></span></span><script type="math/tex" id="MathJax-Element-191"><x</script> as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-916"><span class="MJXp-mo" id="MJXp-Span-917" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-918">1</span></span></span><script type="math/tex" id="MathJax-Element-192">-1</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-919"><span class="MJXp-mo" id="MJXp-Span-920" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-921">x</span></span></span><script type="math/tex" id="MathJax-Element-193">=x</script> as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-922"><span class="MJXp-mn" id="MJXp-Span-923">0</span></span></span><script type="math/tex" id="MathJax-Element-194">0</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-924"><span class="MJXp-mo" id="MJXp-Span-925" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">x</span></span></span><script type="math/tex" id="MathJax-Element-195">>x</script> as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-927"><span class="MJXp-mn" id="MJXp-Span-928">1</span></span></span><script type="math/tex" id="MathJax-Element-196">1</script>. This turns the permutation into an array of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-929"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-930">x</span><span class="MJXp-mo" id="MJXp-Span-931" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-932">1</span></span></span><script type="math/tex" id="MathJax-Element-197">x-1</script> times of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-933"><span class="MJXp-mo" id="MJXp-Span-934" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-935">1</span></span></span><script type="math/tex" id="MathJax-Element-198">-1</script>s, one <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-936"><span class="MJXp-mn" id="MJXp-Span-937">0</span></span></span><script type="math/tex" id="MathJax-Element-199">0</script>, and the rest are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-938"><span class="MJXp-mn" id="MJXp-Span-939">1</span></span></span><script type="math/tex" id="MathJax-Element-200">1</script>. For example, for permutation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-940"><span class="MJXp-mo" id="MJXp-Span-941" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-942">3</span><span class="MJXp-mo" id="MJXp-Span-943" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-944">5</span><span class="MJXp-mo" id="MJXp-Span-945" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-946">1</span><span class="MJXp-mo" id="MJXp-Span-947" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-948">4</span><span class="MJXp-mo" id="MJXp-Span-949" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-950">2</span><span class="MJXp-mo" id="MJXp-Span-951" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-201">[3,5,1,4,2]</script> and element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-952"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953">x</span><span class="MJXp-mo" id="MJXp-Span-954" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-955">4</span></span></span><script type="math/tex" id="MathJax-Element-202">x=4</script>, let the new array be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-956"><span class="MJXp-mo" id="MJXp-Span-957" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mo" id="MJXp-Span-958" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-959">1</span><span class="MJXp-mo" id="MJXp-Span-960" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-961">1</span><span class="MJXp-mo" id="MJXp-Span-962" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-963" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-964">1</span><span class="MJXp-mo" id="MJXp-Span-965" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-966">0</span><span class="MJXp-mo" id="MJXp-Span-967" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-968" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-969">1</span><span class="MJXp-mo" id="MJXp-Span-970" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-203">[-1,1,-1,0,-1]</script>. It can be proved that doing binary search on element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-971"><span class="MJXp-mn" id="MJXp-Span-972">0</span></span></span><script type="math/tex" id="MathJax-Element-204">0</script> on this array is the same as doing binary search on element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-973"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">x</span></span></span><script type="math/tex" id="MathJax-Element-205">x</script> in the permutation.</li><li> One necessary condition is that all the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-975"><span class="MJXp-mo" id="MJXp-Span-976" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-977">1</span></span></span><script type="math/tex" id="MathJax-Element-206">-1</script>s occur before the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-978"><span class="MJXp-mn" id="MJXp-Span-979">0</span></span></span><script type="math/tex" id="MathJax-Element-207">0</script>. Otherwise, if we choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-980"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-981">m</span></span></span><script type="math/tex" id="MathJax-Element-208">m</script> as the position of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-982"><span class="MJXp-mo" id="MJXp-Span-983" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-984">1</span></span></span><script type="math/tex" id="MathJax-Element-209">-1</script> at first, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-985"><span class="MJXp-msubsup" id="MJXp-Span-986"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-988" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-989" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990">x</span></span></span><script type="math/tex" id="MathJax-Element-210">a_m<x</script> will be judged, and then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-991"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-992">l</span></span></span><script type="math/tex" id="MathJax-Element-211">l</script> becomes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-993"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994">m</span><span class="MJXp-mo" id="MJXp-Span-995" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-996">1</span></span></span><script type="math/tex" id="MathJax-Element-212">m+1</script>, where element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-997"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998">x</span></span></span><script type="math/tex" id="MathJax-Element-213">x</script> will be outside the range.</li><li> Similarly, all the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-999"><span class="MJXp-mn" id="MJXp-Span-1000">1</span></span></span><script type="math/tex" id="MathJax-Element-214">1</script>s should occur after the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1001"><span class="MJXp-mn" id="MJXp-Span-1002">0</span></span></span><script type="math/tex" id="MathJax-Element-215">0</script>. Otherwise, we can choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1003"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1004">m</span></span></span><script type="math/tex" id="MathJax-Element-216">m</script> as the position of that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1005"><span class="MJXp-mn" id="MJXp-Span-1006">1</span></span></span><script type="math/tex" id="MathJax-Element-217">1</script> at first.</li><li> We can prove that the two conditions above are sufficient. That is because the array of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1007"><span class="MJXp-mo" id="MJXp-Span-1008" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1009">1</span><span class="MJXp-mo" id="MJXp-Span-1010" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1011">0</span><span class="MJXp-mo" id="MJXp-Span-1012" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1013">1</span></span></span><script type="math/tex" id="MathJax-Element-218">-1,0,1</script> is already sorted, and you can always find the correct position of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1014"><span class="MJXp-mn" id="MJXp-Span-1015">0</span></span></span><script type="math/tex" id="MathJax-Element-219">0</script> on a sorted array.</li></ul><p>In all, the condition that element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1016"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">x</span></span></span><script type="math/tex" id="MathJax-Element-220">x</script> is <span class="tex-font-style-it">stable</span> is that: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1018"><span class="MJXp-msubsup" id="MJXp-Span-1019"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1021" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-1022" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">x</span></span></span><script type="math/tex" id="MathJax-Element-221">a_x=x</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1024"><span class="MJXp-msubsup" id="MJXp-Span-1025"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1027" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1028" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029">x</span></span></span><script type="math/tex" id="MathJax-Element-222">a_i<x</script> if and only if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1030"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031">i</span><span class="MJXp-mo" id="MJXp-Span-1032" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033">x</span></span></span><script type="math/tex" id="MathJax-Element-223">i<x</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1034"><span class="MJXp-msubsup" id="MJXp-Span-1035"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1036" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1037" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1038" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1039">x</span></span></span><script type="math/tex" id="MathJax-Element-224">a_i>x</script> if and only if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1040"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041">i</span><span class="MJXp-mo" id="MJXp-Span-1042" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043">x</span></span></span><script type="math/tex" id="MathJax-Element-225">i>x</script>.</p><p>Consider constructing a permutation. If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1044"><span class="MJXp-msubsup" id="MJXp-Span-1045"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1046" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1047" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1048" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn MJXp-mono" id="MJXp-Span-1049">0</span></span></span><script type="math/tex" id="MathJax-Element-226">s_i=\tt 0</script>, we can construct anything that does not satisfy the conditions above, such as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1050"><span class="MJXp-mo" id="MJXp-Span-1051" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1052">2</span><span class="MJXp-mo" id="MJXp-Span-1053" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1054">3</span><span class="MJXp-mo" id="MJXp-Span-1055" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1056" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1057" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058">n</span><span class="MJXp-mo" id="MJXp-Span-1059" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1060">1</span><span class="MJXp-mo" id="MJXp-Span-1061" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1062" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1063" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">n</span><span class="MJXp-mo" id="MJXp-Span-1065" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1066">n</span><span class="MJXp-mo" id="MJXp-Span-1067" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1068">1</span><span class="MJXp-mo" id="MJXp-Span-1069" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1070">n</span><span class="MJXp-mo" id="MJXp-Span-1071" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1072">2</span><span class="MJXp-mo" id="MJXp-Span-1073" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1074" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1075" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1076">2</span><span class="MJXp-mo" id="MJXp-Span-1077" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1078">1</span><span class="MJXp-mo" id="MJXp-Span-1079" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-227">[2,3,\dots,n,1],[n,n-1,n-2,\dots,2,1]</script>. Note that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1080"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081">n</span></span></span><script type="math/tex" id="MathJax-Element-228">n</script> should not be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1082"><span class="MJXp-mn" id="MJXp-Span-1083">1</span></span></span><script type="math/tex" id="MathJax-Element-229">1</script>.</p><p>The positions that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1084"><span class="MJXp-msubsup" id="MJXp-Span-1085"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1087" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1088" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn MJXp-mono" id="MJXp-Span-1089">1</span></span></span><script type="math/tex" id="MathJax-Element-230">s_i=\tt 1</script> must be filled with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1090"><span class="MJXp-msubsup" id="MJXp-Span-1091"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1093" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1094" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1095">i</span></span></span><script type="math/tex" id="MathJax-Element-231">p_i=i</script>. For each segment of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1096"><span class="MJXp-mn MJXp-mono" id="MJXp-Span-1097">0</span></span></span><script type="math/tex" id="MathJax-Element-232">\tt 0</script> (an interval <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1098"><span class="MJXp-mo" id="MJXp-Span-1099" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100">l</span><span class="MJXp-mo" id="MJXp-Span-1101" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1102">r</span><span class="MJXp-mo" id="MJXp-Span-1103" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-233">[l,r]</script> that is filled with all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1104"><span class="MJXp-mrow" id="MJXp-Span-1105"><span class="MJXp-mn MJXp-mono" id="MJXp-Span-1106">0</span></span></span></span><script type="math/tex" id="MathJax-Element-234">\tt{0}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1108">l</span><span class="MJXp-mo" id="MJXp-Span-1109" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1110">1</span></span></span><script type="math/tex" id="MathJax-Element-235">l-1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1112">r</span><span class="MJXp-mo" id="MJXp-Span-1113" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1114">1</span></span></span><script type="math/tex" id="MathJax-Element-236">r+1</script> are either boundary or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1115"><span class="MJXp-mn MJXp-mono" id="MJXp-Span-1116">1</span></span></span><script type="math/tex" id="MathJax-Element-237">\tt 1</script>), we still need to fill the values <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1117"><span class="MJXp-mo" id="MJXp-Span-1118" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1119">l</span><span class="MJXp-mo" id="MJXp-Span-1120" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121">r</span><span class="MJXp-mo" id="MJXp-Span-1122" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-238">[l,r]</script> into the indices <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1123"><span class="MJXp-msubsup" id="MJXp-Span-1124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1126" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-1127" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1128" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1129" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1130"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1131" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1132" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-239">p_l,\dots,p_r</script>. Similar as the case when all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1133"><span class="MJXp-msubsup" id="MJXp-Span-1134"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1135" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1136" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1137" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1138"><span class="MJXp-mn MJXp-mono" id="MJXp-Span-1139">0</span></span></span></span><script type="math/tex" id="MathJax-Element-240">s_i=\tt{0}</script>, we can simply reverse or cyclic shift the subsegment <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1140"><span class="MJXp-mo" id="MJXp-Span-1141" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142">l</span><span class="MJXp-mo" id="MJXp-Span-1143" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">r</span><span class="MJXp-mo" id="MJXp-Span-1145" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-241">[l,r]</script>. There's no solution if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147">l</span><span class="MJXp-mo" id="MJXp-Span-1148" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149">r</span></span></span><script type="math/tex" id="MathJax-Element-242">l=r</script> here.</p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1150"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151">O</span><span class="MJXp-mo" id="MJXp-Span-1152" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">n</span><span class="MJXp-mo" id="MJXp-Span-1154" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-243">O(n)</script>.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><p>By <a class="rated-user user-orange" href="https://codeforces.com/profile/Caylex" title="Master Caylex">Caylex</a>.</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">def</span><span class="pln"> solve</span><span class="pun">():</span><span class="pln">
    n </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
    s </span><span class="pun">=</span><span class="pln"> str</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
    l </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    p </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
        p</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> l </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">l</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">"1"</span><span class="pun">:</span><span class="pln">
            l </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            </span><span class="kwd">continue</span><span class="pln">
        r </span><span class="pun">=</span><span class="pln"> l
        </span><span class="kwd">while</span><span class="pln"> r </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> n </span><span class="kwd">and</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">r </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">"0"</span><span class="pun">:</span><span class="pln">
            r </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> r </span><span class="pun">-</span><span class="pln"> l </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"NO"</span><span class="pun">)</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln">
        ok </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">):</span><span class="pln">
            p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
        p</span><span class="pun">[</span><span class="pln">r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> l </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        l </span><span class="pun">=</span><span class="pln"> r </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"YES"</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> </span><span class="kwd">end</span><span class="pun">=</span><span class="str">" "</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln">


t </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">t</span><span class="pun">):</span><span class="pln">
    solve</span><span class="pun">()</span><span class="pln">
</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2146/problem/D1" title="Codeforces Round 1052 (Div. 2)">2146D1 - Max Sum OR (Easy Version)</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Try a few cases by hand or guess by the samples, what's the maximized answer for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-91" style="width: 6.496em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.927em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1004.93em, 2.546em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-92"><span class="mi" id="MathJax-Span-93" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-94" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mn" id="MathJax-Span-95" style="font-family: MathJax_Main; padding-left: 0.273em;">0</span><span class="mo" id="MathJax-Span-96" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-97" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">r</span><span class="mo" id="MathJax-Span-98" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-99" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">n</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mo>=</mo><mn>0</mn><mo>,</mo><mi>r</mi><mo>=</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-21">l=0,r=n</script>?</p> <div class="spoiler"><b class="spoiler-title">Answer</b><div class="spoiler-content" style="display: block;"><p>The answer is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-100" style="width: 4.873em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.682em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1003.57em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-101"><span class="mi" id="MathJax-Span-102" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-103" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-104" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-105" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-106" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-107" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-22">n(n+1)</script>. Actually, as <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2223;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-108" style="width: 7.254em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.468em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1005.47em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-109"><span class="mi" id="MathJax-Span-110" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-111" style="font-family: MathJax_Main; padding-left: 0.273em;">∣</span><span class="mi" id="MathJax-Span-112" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-113" style="font-family: MathJax_Main; padding-left: 0.273em;">≤</span><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">x</span><span class="mo" id="MathJax-Span-115" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mi" id="MathJax-Span-116" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>∣</mo><mi>y</mi><mo>≤</mo><mi>x</mi><mo>+</mo><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">x\mid y\le x+y</script>, so the upper bound for the answer is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-117" style="width: 12.827em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.689em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1009.58em, 2.654em, -999.997em); top: -2.216em; left: 0em;"><span class="mrow" id="MathJax-Span-118"><span class="mo" id="MathJax-Span-119" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span class="mo" id="MathJax-Span-120" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-121"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-122" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-123" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-124" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="msubsup" id="MathJax-Span-125" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-126" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-127" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-128" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-129" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-130" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">n</span><span class="mo" id="MathJax-Span-131" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-132" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-133" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-134" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-135" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.221em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>∑</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-24">\sum (a_i+b_i)=n(n+1)</script>. And we are going to reach the upper bound.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>We need to make the bitwise AND of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-136" style="width: 1.139em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.87em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-137"><span class="msubsup" id="MathJax-Span-138"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-139" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-140" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-25">a_i</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-141" style="width: 1.031em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.76em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-142"><span class="msubsup" id="MathJax-Span-143"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-144" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-145" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-26">b_i</script> all equal to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-146" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-147"><span class="mn" id="MathJax-Span-148" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-27">0</script>. Let's remind you that the bitwise AND of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-149" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-150"><span class="mi" id="MathJax-Span-151" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-28">x</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-152" style="width: 5.901em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.44em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.139em, 1004.39em, 2.438em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-153"><span class="msubsup" id="MathJax-Span-154"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-155" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="mi" id="MathJax-Span-156" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-157" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-158" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-159" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mi" id="MathJax-Span-160" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">x</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mi>k</mi></msup><mo>−</mo><mn>1</mn><mo>−</mo><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-29">2^k-1-x</script> is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-161" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-162"><span class="mn" id="MathJax-Span-163" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-30">0</script> for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-164" style="width: 6.172em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.656em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.139em, 1004.66em, 2.492em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-165"><span class="mn" id="MathJax-Span-166" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-167" style="font-family: MathJax_Main; padding-left: 0.273em;">≤</span><span class="mi" id="MathJax-Span-168" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">x</span><span class="mo" id="MathJax-Span-169" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="msubsup" id="MathJax-Span-170" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-171" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="mi" id="MathJax-Span-172" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.504em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn><mo>≤</mo><mi>x</mi><mo>&lt;</mo><msup><mn>2</mn><mi>k</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-31">0\le x<2^k</script>. We can try to pair integers <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-173" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-174"><span class="mi" id="MathJax-Span-175" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-32">x</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-176" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.49em, 2.492em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-177"><span class="mi" id="MathJax-Span-178" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">y</script> by letting <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-179" style="width: 8.174em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.172em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.572em, 1006.12em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-180"><span class="msubsup" id="MathJax-Span-181"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-182" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-183" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-184" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-185" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-186" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-187" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-188" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-189" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-190" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-191" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">x</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>x</mi></msub><mo>=</mo><mi>y</mi><mo>,</mo><msub><mi>a</mi><mi>y</mi></msub><mo>=</mo><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-34">a_x=y,a_y=x</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>Construct from the back.</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2146/problem/D1" title="Codeforces Round 1052 (Div. 2)">2146D1 - Max Sum OR (Easy Version)</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Try a few cases or guess by the samples that the answer is always <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1155"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1156">n</span><span class="MJXp-mo" id="MJXp-Span-1157" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158">n</span><span class="MJXp-mo" id="MJXp-Span-1159" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1160">1</span><span class="MJXp-mo" id="MJXp-Span-1161" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-244">n(n+1)</script>.</p><p>Actually, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1162"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163">x</span><span class="MJXp-mtext" id="MJXp-Span-1164">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1165"><span class="MJXp-mo" id="MJXp-Span-1166" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1167">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1168">y</span><span class="MJXp-mo" id="MJXp-Span-1169" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1170" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1171">x</span><span class="MJXp-mo" id="MJXp-Span-1172" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1173">y</span><span class="MJXp-mo" id="MJXp-Span-1174" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1175" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-1176" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177">x</span><span class="MJXp-mi" id="MJXp-Span-1178">&amp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1179">y</span><span class="MJXp-mo" id="MJXp-Span-1180" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1181" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182">x</span><span class="MJXp-mo" id="MJXp-Span-1183" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184">y</span></span></span><script type="math/tex" id="MathJax-Element-245">x~|~y=(x+y)-(x\&y)\le x+y</script>. So the clear upper bound of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1185"><span class="MJXp-msubsup" id="MJXp-Span-1186"><span class="MJXp-mo" id="MJXp-Span-1187" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1188" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1189" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1190"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1191" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1192" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mtext" id="MJXp-Span-1193">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1194"><span class="MJXp-mo" id="MJXp-Span-1195" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1196">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1197"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1198" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1199" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1200" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-246">\sum_i(a_i~|~b_i)</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1201"><span class="MJXp-mo" id="MJXp-Span-1202" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-msubsup" id="MJXp-Span-1203"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1204" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1205" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1206" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1208" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1209" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1210" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1211">n</span><span class="MJXp-mo" id="MJXp-Span-1212" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213">n</span><span class="MJXp-mo" id="MJXp-Span-1214" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1215">1</span><span class="MJXp-mo" id="MJXp-Span-1216" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-247">\sum a_i+b_i=n(n+1)</script>. Let's construct the array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1217"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1218">a</span></span></span><script type="math/tex" id="MathJax-Element-248">a</script> as follows to prove that the upper bound can always be reached:</p><ul><li> Our target is to make <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1219"><span class="MJXp-msubsup" id="MJXp-Span-1220"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1221" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1222" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mi" id="MJXp-Span-1223">&amp;</span><span class="MJXp-msubsup" id="MJXp-Span-1224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1225" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1226" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1227" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1228">0</span></span></span><script type="math/tex" id="MathJax-Element-249">a_i\&b_i=0</script> for every <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1230">i</span></span></span><script type="math/tex" id="MathJax-Element-250">i</script>. Let the indices be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1231"><span class="MJXp-mn" id="MJXp-Span-1232">0</span><span class="MJXp-mo" id="MJXp-Span-1233" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1234">n</span></span></span><script type="math/tex" id="MathJax-Element-251">0\sim n</script>.</li><li> Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1235"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236">k</span></span></span><script type="math/tex" id="MathJax-Element-252">k</script> be the smallest integer such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1237"><span class="MJXp-msubsup" id="MJXp-Span-1238"><span class="MJXp-mn" id="MJXp-Span-1239" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1240" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1241" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1242">n</span></span></span><script type="math/tex" id="MathJax-Element-253">2^k>n</script>. Clearly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1243"><span class="MJXp-mn" id="MJXp-Span-1244">0</span><span class="MJXp-mo" id="MJXp-Span-1245" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-1246"><span class="MJXp-mn" id="MJXp-Span-1247" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1248" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1249">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1250" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1251">1</span><span class="MJXp-mo" id="MJXp-Span-1252" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1253">n</span><span class="MJXp-mo" id="MJXp-Span-1254" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1255">n</span></span></span><script type="math/tex" id="MathJax-Element-254">0\le 2^{k}-1-n\le n</script>, otherwise <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1256"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1257">k</span></span></span><script type="math/tex" id="MathJax-Element-255">k</script> can be smaller. Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1258"><span class="MJXp-msubsup" id="MJXp-Span-1259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1261" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1262" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1263"><span class="MJXp-mn" id="MJXp-Span-1264" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1265" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1266" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1267">1</span><span class="MJXp-mo" id="MJXp-Span-1268" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269">i</span></span></span><script type="math/tex" id="MathJax-Element-256">a_i=2^k-1-i</script> for integers <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271">i</span><span class="MJXp-mo" id="MJXp-Span-1272" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-1273" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1274"><span class="MJXp-mn" id="MJXp-Span-1275" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1276" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1277" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1278">1</span><span class="MJXp-mo" id="MJXp-Span-1279" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1280">n</span><span class="MJXp-mo" id="MJXp-Span-1281" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282">n</span><span class="MJXp-mo" id="MJXp-Span-1283" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-257">i\in[2^k-1-n,n]</script>. Clearly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1284"><span class="MJXp-msubsup" id="MJXp-Span-1285"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1286" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1287" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mi" id="MJXp-Span-1288">&amp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1289">i</span><span class="MJXp-mo" id="MJXp-Span-1290" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1291">0</span></span></span><script type="math/tex" id="MathJax-Element-258">a_i\&i=0</script>. Then delete the suffix and let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1292"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1293">n</span></span></span><script type="math/tex" id="MathJax-Element-259">n</script> become <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1294"><span class="MJXp-msubsup" id="MJXp-Span-1295"><span class="MJXp-mn" id="MJXp-Span-1296" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1297" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1298" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1299">2</span><span class="MJXp-mo" id="MJXp-Span-1300" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1301">n</span></span></span><script type="math/tex" id="MathJax-Element-260">2^k-2-n</script>. Continue the process until <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1302"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1303">n</span></span></span><script type="math/tex" id="MathJax-Element-261">n</script> becomes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1304"><span class="MJXp-mo" id="MJXp-Span-1305" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1306">1</span></span></span><script type="math/tex" id="MathJax-Element-262">-1</script> (That is, when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1307"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1308">n</span><span class="MJXp-mo" id="MJXp-Span-1309" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1310"><span class="MJXp-mn" id="MJXp-Span-1311" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1312" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1313">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1314" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1315">1</span></span></span><script type="math/tex" id="MathJax-Element-263">n=2^{k}-1</script>, let's reverse the array and end the process).</li><li> It can be seen that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1317">n</span></span></span><script type="math/tex" id="MathJax-Element-264">n</script> decreases by at least one each time, so the process always ends.</li></ul><p>For example, the construction for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1318"><span class="MJXp-mo" id="MJXp-Span-1319" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1320">l</span><span class="MJXp-mo" id="MJXp-Span-1321" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322">r</span><span class="MJXp-mo" id="MJXp-Span-1323" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1324" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1325" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1326">0</span><span class="MJXp-mo" id="MJXp-Span-1327" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1328">10</span><span class="MJXp-mo" id="MJXp-Span-1329" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-265">[l,r]=[0,10]</script> is: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1330"><span class="MJXp-mo" id="MJXp-Span-1331" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1332">0</span><span class="MJXp-mo" id="MJXp-Span-1333" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1334">2</span><span class="MJXp-mo" id="MJXp-Span-1335" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1336">1</span><span class="MJXp-mo" id="MJXp-Span-1337" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1338">4</span><span class="MJXp-mo" id="MJXp-Span-1339" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1340">3</span><span class="MJXp-mo" id="MJXp-Span-1341" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1342">10</span><span class="MJXp-mo" id="MJXp-Span-1343" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1344">9</span><span class="MJXp-mo" id="MJXp-Span-1345" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1346">8</span><span class="MJXp-mo" id="MJXp-Span-1347" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1348">7</span><span class="MJXp-mo" id="MJXp-Span-1349" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1350">6</span><span class="MJXp-mo" id="MJXp-Span-1351" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1352">5</span><span class="MJXp-mo" id="MJXp-Span-1353" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-266">[0,2,1,4,3,10,9,8,7,6,5]</script>.</p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1354"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1355">O</span><span class="MJXp-mo" id="MJXp-Span-1356" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1357">n</span><span class="MJXp-mo" id="MJXp-Span-1358" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-267">O(n)</script>.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><p>By <a class="rated-user user-orange" href="https://codeforces.com/profile/Caylex" title="Master Caylex">Caylex</a>.</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">def</span><span class="pln"> solve</span><span class="pun">():</span><span class="pln">
    l</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">=</span><span class="pln"> map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">())</span><span class="pln">
    pw </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> pw </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">:</span><span class="pln">
        pw </span><span class="pun">=</span><span class="pln"> pw </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    s </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">set</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">):</span><span class="pln">
        s</span><span class="pun">.</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
    a </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> l </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">while</span><span class="pln"> pw </span><span class="pun">-</span><span class="pln"> i </span><span class="kwd">not</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> s</span><span class="pun">:</span><span class="pln">
            pw </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> pw </span><span class="pun">-</span><span class="pln"> i
        ans </span><span class="pun">+=</span><span class="pln"> i </span><span class="pun">|</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln">
        s</span><span class="pun">.</span><span class="kwd">remove</span><span class="pun">(</span><span class="pln">pw </span><span class="pun">-</span><span class="pln"> i</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(*</span><span class="pln">a</span><span class="pun">[</span><span class="pln">l </span><span class="pun">:</span><span class="pln"> r </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">])</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln">


t </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">t</span><span class="pun">):</span><span class="pln">
    solve</span><span class="pun">()</span><span class="pln">
</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2146/problem/D2" title="Codeforces Round 1052 (Div. 2)">2146D2 - Max Sum OR (Hard Version)</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Let's consider from the highest bits to the lowest bits. If the highest bits of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-192" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-193"><span class="mi" id="MathJax-Span-194" style="font-family: MathJax_Math-italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-35">l</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-195" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-196"><span class="mi" id="MathJax-Span-197" style="font-family: MathJax_Math-italic;">r</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-36">r</script> are the same, we can just ignore this bit and go on to a lower bit. We can still try to pair integers <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-198" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-199"><span class="mi" id="MathJax-Span-200" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-37">x</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-201" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.49em, 2.492em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-202"><span class="mi" id="MathJax-Span-203" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-38">y</script> by letting <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-204" style="width: 8.174em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.172em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.572em, 1006.12em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-205"><span class="msubsup" id="MathJax-Span-206"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-207" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-208" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-209" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-210" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-211" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-212" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-213" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-214" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-215" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-216" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">x</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>x</mi></msub><mo>=</mo><mi>y</mi><mo>,</mo><msub><mi>a</mi><mi>y</mi></msub><mo>=</mo><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-39">a_x=y,a_y=x</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Consider the highest bit that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-217" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-218"><span class="mi" id="MathJax-Span-219" style="font-family: MathJax_Math-italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-40">l</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-220" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-221"><span class="mi" id="MathJax-Span-222" style="font-family: MathJax_Math-italic;">r</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-41">r</script> differs. There exist an integer <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-223" style="width: 0.544em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.381em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1000.33em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-224"><span class="mi" id="MathJax-Span-225" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-42">t</script> that this bit of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-226" style="width: 5.143em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.899em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1003.85em, 2.438em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-227"><span class="mi" id="MathJax-Span-228" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-229" style="font-family: MathJax_Main; padding-left: 0.165em;">…</span><span class="mi" id="MathJax-Span-230" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">t</span><span class="mo" id="MathJax-Span-231" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-232" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mo>…</mo><mi>t</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-43">l\ldots t-1</script> are <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-233" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-234"><span class="mn" id="MathJax-Span-235" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-44">0</script> and this bit of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-236" style="width: 3.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.33em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1002.33em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-237"><span class="mi" id="MathJax-Span-238" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-239" style="font-family: MathJax_Main; padding-left: 0.165em;">…</span><span class="mi" id="MathJax-Span-240" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">r</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi><mo>…</mo><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-45">t\ldots r</script> are <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-241" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-242"><span class="mn" id="MathJax-Span-243" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-46">1</script>. We need to pair a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-244" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-245"><span class="mn" id="MathJax-Span-246" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-47">0</script> with a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-247" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-248"><span class="mn" id="MathJax-Span-249" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-48">1</script> as more as possible while keeping the bitwise AND of lower bits small. Can we turn it into a smaller subproblem?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>In D1, it is optimal to pair <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-250" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-251"><span class="mi" id="MathJax-Span-252" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-49">x</script> with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-253" style="width: 5.901em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.44em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.139em, 1004.39em, 2.438em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-254"><span class="msubsup" id="MathJax-Span-255"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-256" style="font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.49em;"><span class="mi" id="MathJax-Span-257" style="font-size: 70.7%; font-family: MathJax_Math-italic;">k</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-258" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-259" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-260" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mi" id="MathJax-Span-261" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">x</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mi>k</mi></msup><mo>−</mo><mn>1</mn><mo>−</mo><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-50">2^k-1-x</script>. Here, for interval <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-262" style="width: 2.33em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.734em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1001.63em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-263"><span class="mo" id="MathJax-Span-264" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-265" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-266" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-267" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">r</span><span class="mo" id="MathJax-Span-268" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>l</mi><mo>,</mo><mi>r</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-51">[l,r]</script> and integer <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-269" style="width: 0.544em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.381em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1000.33em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-270"><span class="mi" id="MathJax-Span-271" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-52">t</script> defined in Hint2, it is optimal to pair <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-272" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-273"><span class="mi" id="MathJax-Span-274" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-53">x</script> with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-275" style="width: 5.793em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.386em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1004.33em, 2.438em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-276"><span class="mn" id="MathJax-Span-277" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-278" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-279" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-280" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-281" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mi" id="MathJax-Span-282" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">x</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>t</mi><mo>−</mo><mn>1</mn><mo>−</mo><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-54">2t-1-x</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2146/problem/D2" title="Codeforces Round 1052 (Div. 2)">2146D2 - Max Sum OR (Hard Version)</a></h3><div class="ttypography"><div class="problem-statement"><div><p>The answer won't simply be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1359"><span class="MJXp-mo" id="MJXp-Span-1360" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1361">r</span><span class="MJXp-mo" id="MJXp-Span-1362" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1363">l</span><span class="MJXp-mo" id="MJXp-Span-1364" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1365">1</span><span class="MJXp-mo" id="MJXp-Span-1366" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1367" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1368">r</span><span class="MJXp-mo" id="MJXp-Span-1369" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1370">l</span><span class="MJXp-mo" id="MJXp-Span-1371" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-268">(r-l+1)(r+l)</script>. However, if you consider the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1372"><span class="MJXp-mn" id="MJXp-Span-1373">30</span></span></span><script type="math/tex" id="MathJax-Element-269">30</script> bits separately, this will be the correct upper bound of the answer.</p><p>Let the indices be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1374"><span class="MJXp-mo" id="MJXp-Span-1375" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1376">l</span><span class="MJXp-mo" id="MJXp-Span-1377" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1378">r</span><span class="MJXp-mo" id="MJXp-Span-1379" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-270">[l,r]</script>. Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1380"><span class="MJXp-msubsup" id="MJXp-Span-1381"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1382" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1383" style="vertical-align: 0.5em;">x</span></span></span></span><script type="math/tex" id="MathJax-Element-271">l^x</script> denote the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1384"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385">x</span></span></span><script type="math/tex" id="MathJax-Element-272">x</script>-th bit of non-negative integer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1386"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1387">l</span></span></span><script type="math/tex" id="MathJax-Element-273">l</script>. Let's construct from the highest bit to the lowest:</p><ul><li> Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389">x</span></span></span><script type="math/tex" id="MathJax-Element-274">x</script> be the highest bit such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1390"><span class="MJXp-msubsup" id="MJXp-Span-1391"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1392" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1393" style="vertical-align: 0.5em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-1394" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-msubsup" id="MJXp-Span-1395"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1396" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1397" style="vertical-align: 0.5em;">x</span></span></span></span><script type="math/tex" id="MathJax-Element-275">l^x\neq r^x</script>. For the higher bits, they clearly don't affect the results. Now <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1398"><span class="MJXp-msubsup" id="MJXp-Span-1399"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1400" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1401" style="vertical-align: 0.5em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-1402" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1403">0</span></span></span><script type="math/tex" id="MathJax-Element-276">l^x=0</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1404"><span class="MJXp-msubsup" id="MJXp-Span-1405"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1406" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1407" style="vertical-align: 0.5em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-1408" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1409">1</span></span></span><script type="math/tex" id="MathJax-Element-277">r^x=1</script>. Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1410"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1411">t</span></span></span><script type="math/tex" id="MathJax-Element-278">t</script> be the smallest integer that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1412"><span class="MJXp-mo" id="MJXp-Span-1413" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414">l</span><span class="MJXp-mo" id="MJXp-Span-1415" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1416">t</span><span class="MJXp-mo" id="MJXp-Span-1417" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1418">r</span><span class="MJXp-mo" id="MJXp-Span-1419" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-279">[l\le t\le r]</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1420"><span class="MJXp-msubsup" id="MJXp-Span-1421"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1422" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1423" style="vertical-align: 0.5em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1424" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1425">0</span></span></span><script type="math/tex" id="MathJax-Element-280">t^i=0</script> for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1426"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1427">i</span><span class="MJXp-mo" id="MJXp-Span-1428" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1429">x</span></span></span><script type="math/tex" id="MathJax-Element-281">i<x</script>. That is, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1430"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431">t</span></span></span><script type="math/tex" id="MathJax-Element-282">t</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1432"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433">r</span></span></span><script type="math/tex" id="MathJax-Element-283">r</script> when the bits lower than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1435">x</span></span></span><script type="math/tex" id="MathJax-Element-284">x</script> are changed to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1436"><span class="MJXp-mn" id="MJXp-Span-1437">0</span></span></span><script type="math/tex" id="MathJax-Element-285">0</script>. For example, when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1438"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1439">l</span><span class="MJXp-mo" id="MJXp-Span-1440" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1441">9</span><span class="MJXp-mo" id="MJXp-Span-1442" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1443" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1444">1001</span><span class="MJXp-msubsup" id="MJXp-Span-1445"><span class="MJXp-mo" id="MJXp-Span-1446" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1447" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1448" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1449">r</span><span class="MJXp-mo" id="MJXp-Span-1450" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1451">13</span><span class="MJXp-mo" id="MJXp-Span-1452" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1453" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1454">1101</span><span class="MJXp-msubsup" id="MJXp-Span-1455"><span class="MJXp-mo" id="MJXp-Span-1456" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1457" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-286">l=9=(1001)_2,r=13=(1101)_2</script>, here <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1458"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1459">x</span><span class="MJXp-mo" id="MJXp-Span-1460" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1461">2</span></span></span><script type="math/tex" id="MathJax-Element-287">x=2</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1462"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1463">t</span><span class="MJXp-mo" id="MJXp-Span-1464" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1465">12</span><span class="MJXp-mo" id="MJXp-Span-1466" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1467" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1468">1100</span><span class="MJXp-msubsup" id="MJXp-Span-1469"><span class="MJXp-mo" id="MJXp-Span-1470" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1471" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-288">t=12=(1100)_2</script>. We can see that when the sum of two paired integers is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1472"><span class="MJXp-mn" id="MJXp-Span-1473">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474">t</span><span class="MJXp-mo" id="MJXp-Span-1475" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1476">1</span></span></span><script type="math/tex" id="MathJax-Element-289">2t-1</script>, it always seems optimal. Here are two cases:</li><li> When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1478">t</span><span class="MJXp-mo" id="MJXp-Span-1479" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480">l</span><span class="MJXp-mo" id="MJXp-Span-1481" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482">r</span><span class="MJXp-mo" id="MJXp-Span-1483" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1484">t</span><span class="MJXp-mo" id="MJXp-Span-1485" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1486">1</span></span></span><script type="math/tex" id="MathJax-Element-290">t-l\le r-t+1</script>, that is, the length of the left part that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1487"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1488">l</span><span class="MJXp-mo" id="MJXp-Span-1489" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490">i</span><span class="MJXp-mo" id="MJXp-Span-1491" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1492">t</span></span></span><script type="math/tex" id="MathJax-Element-291">l\le i<t</script> is smaller than the length of the right part that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1493"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1494">t</span><span class="MJXp-mo" id="MJXp-Span-1495" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1496">i</span><span class="MJXp-mo" id="MJXp-Span-1497" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1498">r</span></span></span><script type="math/tex" id="MathJax-Element-292">t\le i\le r</script>. We can pair each number <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1499"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500">x</span></span></span><script type="math/tex" id="MathJax-Element-293">x</script> in the left part with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1501"><span class="MJXp-msubsup" id="MJXp-Span-1502"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1503" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1504" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-1505" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1506">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1507">t</span><span class="MJXp-mo" id="MJXp-Span-1508" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1509">1</span><span class="MJXp-mo" id="MJXp-Span-1510" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1511">x</span></span></span><script type="math/tex" id="MathJax-Element-294">a_x=2t-1-x</script> in the right part. That is, reverse the interval <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1512"><span class="MJXp-mo" id="MJXp-Span-1513" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1514">l</span><span class="MJXp-mo" id="MJXp-Span-1515" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1516">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1517">t</span><span class="MJXp-mo" id="MJXp-Span-1518" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1519">1</span><span class="MJXp-mo" id="MJXp-Span-1520" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521">l</span><span class="MJXp-mo" id="MJXp-Span-1522" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-295">[l,2t-1-l]</script> and turn the interval into <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1523"><span class="MJXp-mo" id="MJXp-Span-1524" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1525">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1526">t</span><span class="MJXp-mo" id="MJXp-Span-1527" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1528">l</span><span class="MJXp-mo" id="MJXp-Span-1529" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1530">r</span><span class="MJXp-mo" id="MJXp-Span-1531" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-296">[2t-l,r]</script>. Here, for all the paired integers <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1532"><span class="MJXp-mo" id="MJXp-Span-1533" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1534">x</span><span class="MJXp-mo" id="MJXp-Span-1535" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1536">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537">t</span><span class="MJXp-mo" id="MJXp-Span-1538" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1539">1</span><span class="MJXp-mo" id="MJXp-Span-1540" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1541">x</span><span class="MJXp-mo" id="MJXp-Span-1542" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-297">(x,2t-1-x)</script>, ignoring the bits higher than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1544">x</span></span></span><script type="math/tex" id="MathJax-Element-298">x</script>, the bitwise and of them is zero, which is clearly optimal.</li><li> Similarly, when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1546">t</span><span class="MJXp-mo" id="MJXp-Span-1547" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548">l</span><span class="MJXp-mo" id="MJXp-Span-1549" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1550">r</span><span class="MJXp-mo" id="MJXp-Span-1551" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1552">t</span><span class="MJXp-mo" id="MJXp-Span-1553" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1554">1</span></span></span><script type="math/tex" id="MathJax-Element-299">t-l>r-t+1</script>, that is, the length of the left part is greater than the length of the right part. We can pair each number <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1555"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1556">x</span></span></span><script type="math/tex" id="MathJax-Element-300">x</script> in the right part with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1557"><span class="MJXp-msubsup" id="MJXp-Span-1558"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1559" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1560" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-1561" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1562">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1563">t</span><span class="MJXp-mo" id="MJXp-Span-1564" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1565">1</span><span class="MJXp-mo" id="MJXp-Span-1566" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1567">x</span></span></span><script type="math/tex" id="MathJax-Element-301">a_x=2t-1-x</script> in the left part. That is, reverse the interval <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1568"><span class="MJXp-mo" id="MJXp-Span-1569" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1570">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1571">t</span><span class="MJXp-mo" id="MJXp-Span-1572" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1573">1</span><span class="MJXp-mo" id="MJXp-Span-1574" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575">r</span><span class="MJXp-mo" id="MJXp-Span-1576" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1577">r</span><span class="MJXp-mo" id="MJXp-Span-1578" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-302">[2t-1-r,r]</script> and turn the interval into <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1579"><span class="MJXp-mo" id="MJXp-Span-1580" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1581">l</span><span class="MJXp-mo" id="MJXp-Span-1582" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1583">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1584">t</span><span class="MJXp-mo" id="MJXp-Span-1585" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1586">2</span><span class="MJXp-mo" id="MJXp-Span-1587" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1588">r</span><span class="MJXp-mo" id="MJXp-Span-1589" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-303">[l,2t-2-r]</script>. Here, for all the paired integers <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1590"><span class="MJXp-mo" id="MJXp-Span-1591" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1592">x</span><span class="MJXp-mo" id="MJXp-Span-1593" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1594">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1595">t</span><span class="MJXp-mo" id="MJXp-Span-1596" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1597">1</span><span class="MJXp-mo" id="MJXp-Span-1598" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1599">x</span><span class="MJXp-mo" id="MJXp-Span-1600" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-304">(x,2t-1-x)</script>, ignoring the bits higher than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1601"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1602">x</span></span></span><script type="math/tex" id="MathJax-Element-305">x</script>, the bitwise and of them is zero, which is clearly optimal.</li><li> Continue the process until the interval <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1603"><span class="MJXp-mo" id="MJXp-Span-1604" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1605">l</span><span class="MJXp-mo" id="MJXp-Span-1606" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1607">r</span><span class="MJXp-mo" id="MJXp-Span-1608" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-306">[l,r]</script> becomes empty. You can feel from the process or prove by separating each bit to prove that the constructed array above is optimal.</li></ul><p>Here is an example when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1609"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1610">l</span><span class="MJXp-mo" id="MJXp-Span-1611" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1612">3</span><span class="MJXp-mo" id="MJXp-Span-1613" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1614">r</span><span class="MJXp-mo" id="MJXp-Span-1615" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1616">9</span></span></span><script type="math/tex" id="MathJax-Element-307">l=3,r=9</script>:</p><ul><li> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1617"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1618">x</span><span class="MJXp-mo" id="MJXp-Span-1619" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1620">3</span></span></span><script type="math/tex" id="MathJax-Element-308">x=3</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1621"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1622">t</span><span class="MJXp-mo" id="MJXp-Span-1623" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1624">8</span></span></span><script type="math/tex" id="MathJax-Element-309">t=8</script>. The left part is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1625"><span class="MJXp-mo" id="MJXp-Span-1626" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1627">3</span><span class="MJXp-mo" id="MJXp-Span-1628" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1629">4</span><span class="MJXp-mo" id="MJXp-Span-1630" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1631">5</span><span class="MJXp-mo" id="MJXp-Span-1632" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1633">6</span><span class="MJXp-mo" id="MJXp-Span-1634" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1635">7</span><span class="MJXp-mo" id="MJXp-Span-1636" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-310">[3,4,5,6,7]</script> and the right part is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1637"><span class="MJXp-mo" id="MJXp-Span-1638" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1639">8</span><span class="MJXp-mo" id="MJXp-Span-1640" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1641">9</span><span class="MJXp-mo" id="MJXp-Span-1642" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-311">[8,9]</script>. Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1643"><span class="MJXp-mn" id="MJXp-Span-1644">7</span><span class="MJXp-mo" id="MJXp-Span-1645" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1646">6</span></span></span><script type="math/tex" id="MathJax-Element-312">7,6</script> be paired with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1647"><span class="MJXp-mn" id="MJXp-Span-1648">8</span><span class="MJXp-mo" id="MJXp-Span-1649" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1650">9</span></span></span><script type="math/tex" id="MathJax-Element-313">8,9</script> in the order: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1651"><span class="MJXp-msubsup" id="MJXp-Span-1652"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1653" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1654" style="vertical-align: -0.4em;">6</span></span><span class="MJXp-mo" id="MJXp-Span-1655" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1656">9</span><span class="MJXp-mo" id="MJXp-Span-1657" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1658"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1659" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1660" style="vertical-align: -0.4em;">7</span></span><span class="MJXp-mo" id="MJXp-Span-1661" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1662">8</span><span class="MJXp-mo" id="MJXp-Span-1663" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1664"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1665" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1666" style="vertical-align: -0.4em;">8</span></span><span class="MJXp-mo" id="MJXp-Span-1667" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1668">7</span><span class="MJXp-mo" id="MJXp-Span-1669" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1670"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1671" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1672" style="vertical-align: -0.4em;">9</span></span><span class="MJXp-mo" id="MJXp-Span-1673" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1674">6</span></span></span><script type="math/tex" id="MathJax-Element-314">a_6=9,a_7=8,a_8=7,a_9=6</script>. Now the interval becomes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1675"><span class="MJXp-mo" id="MJXp-Span-1676" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1677">3</span><span class="MJXp-mo" id="MJXp-Span-1678" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1679">4</span><span class="MJXp-mo" id="MJXp-Span-1680" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1681">5</span><span class="MJXp-mo" id="MJXp-Span-1682" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-315">[3,4,5]</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1683"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1684">l</span><span class="MJXp-mo" id="MJXp-Span-1685" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1686">3</span><span class="MJXp-mo" id="MJXp-Span-1687" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1688">r</span><span class="MJXp-mo" id="MJXp-Span-1689" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1690">5</span></span></span><script type="math/tex" id="MathJax-Element-316">l=3,r=5</script>.</li><li> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1691"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1692">x</span><span class="MJXp-mo" id="MJXp-Span-1693" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1694">2</span></span></span><script type="math/tex" id="MathJax-Element-317">x=2</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1695"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696">t</span><span class="MJXp-mo" id="MJXp-Span-1697" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1698">4</span></span></span><script type="math/tex" id="MathJax-Element-318">t=4</script>. The left part is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1699"><span class="MJXp-mo" id="MJXp-Span-1700" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1701">3</span><span class="MJXp-mo" id="MJXp-Span-1702" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-319">[3]</script> and the right part is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1703"><span class="MJXp-mo" id="MJXp-Span-1704" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1705">4</span><span class="MJXp-mo" id="MJXp-Span-1706" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1707">5</span><span class="MJXp-mo" id="MJXp-Span-1708" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-320">[4,5]</script>. Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1709"><span class="MJXp-mn" id="MJXp-Span-1710">3</span></span></span><script type="math/tex" id="MathJax-Element-321">3</script> be paired with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1711"><span class="MJXp-mn" id="MJXp-Span-1712">4</span></span></span><script type="math/tex" id="MathJax-Element-322">4</script>: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1713"><span class="MJXp-msubsup" id="MJXp-Span-1714"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1715" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1716" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1717" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1718">4</span><span class="MJXp-mo" id="MJXp-Span-1719" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1720"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1721" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1722" style="vertical-align: -0.4em;">4</span></span><span class="MJXp-mo" id="MJXp-Span-1723" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1724">3</span></span></span><script type="math/tex" id="MathJax-Element-323">a_3=4,a_4=3</script>. Now the interval becomes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1725"><span class="MJXp-mo" id="MJXp-Span-1726" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1727">5</span><span class="MJXp-mo" id="MJXp-Span-1728" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-324">[5]</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1729"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1730">l</span><span class="MJXp-mo" id="MJXp-Span-1731" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1732">r</span><span class="MJXp-mo" id="MJXp-Span-1733" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1734">5</span></span></span><script type="math/tex" id="MathJax-Element-325">l=r=5</script>. Let's simply let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1735"><span class="MJXp-msubsup" id="MJXp-Span-1736"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1737" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1738" style="vertical-align: -0.4em;">5</span></span><span class="MJXp-mo" id="MJXp-Span-1739" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1740">5</span></span></span><script type="math/tex" id="MathJax-Element-326">a_5=5</script>. So the constructed array is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1741"><span class="MJXp-mo" id="MJXp-Span-1742" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1743">4</span><span class="MJXp-mo" id="MJXp-Span-1744" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1745">3</span><span class="MJXp-mo" id="MJXp-Span-1746" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1747">5</span><span class="MJXp-mo" id="MJXp-Span-1748" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1749">9</span><span class="MJXp-mo" id="MJXp-Span-1750" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1751">8</span><span class="MJXp-mo" id="MJXp-Span-1752" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1753">7</span><span class="MJXp-mo" id="MJXp-Span-1754" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1755">6</span><span class="MJXp-mo" id="MJXp-Span-1756" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-327">[4,3,5,9,8,7,6]</script>.</li></ul><p>Here are some other examples for you to understand better: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1757"><span class="MJXp-mo" id="MJXp-Span-1758" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1759">4</span><span class="MJXp-mo" id="MJXp-Span-1760" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1761">7</span><span class="MJXp-mo" id="MJXp-Span-1762" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1763" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mo" id="MJXp-Span-1764" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1765">7</span><span class="MJXp-mo" id="MJXp-Span-1766" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1767">6</span><span class="MJXp-mo" id="MJXp-Span-1768" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1769">5</span><span class="MJXp-mo" id="MJXp-Span-1770" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1771">4</span><span class="MJXp-mo" id="MJXp-Span-1772" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-328">[4,7]:[7,6,5,4]</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1773"><span class="MJXp-mo" id="MJXp-Span-1774" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1775">11</span><span class="MJXp-mo" id="MJXp-Span-1776" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1777">16</span><span class="MJXp-mo" id="MJXp-Span-1778" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1779" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mo" id="MJXp-Span-1780" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1781">12</span><span class="MJXp-mo" id="MJXp-Span-1782" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1783">11</span><span class="MJXp-mo" id="MJXp-Span-1784" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1785">14</span><span class="MJXp-mo" id="MJXp-Span-1786" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1787">13</span><span class="MJXp-mo" id="MJXp-Span-1788" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1789">16</span><span class="MJXp-mo" id="MJXp-Span-1790" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1791">15</span><span class="MJXp-mo" id="MJXp-Span-1792" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-329">[11,16]:[12,11,14,13,16,15]</script>.</p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1793"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1794">O</span><span class="MJXp-mo" id="MJXp-Span-1795" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1796">n</span><span class="MJXp-mo" id="MJXp-Span-1797" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-330">O(n)</script>.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><p>By <a class="rated-user user-orange" href="https://codeforces.com/profile/Caylex" title="Master Caylex">Caylex</a>.</p> <pre><code class="prettyprint prettyprinted" style=""><span class="kwd">def</span><span class="pln"> g</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> j</span><span class="pun">):</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> x </span><span class="pun">&gt;&gt;</span><span class="pln"> j </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pln">


</span><span class="kwd">def</span><span class="pln"> solve</span><span class="pun">():</span><span class="pln">
    L</span><span class="pun">,</span><span class="pln"> R </span><span class="pun">=</span><span class="pln"> map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">())</span><span class="pln">
    a </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">R </span><span class="pun">-</span><span class="pln"> L </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">

    </span><span class="kwd">def</span><span class="pln"> solve</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> j</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> l </span><span class="pun">&gt;</span><span class="pln"> r</span><span class="pun">:</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> l </span><span class="pun">==</span><span class="pln"> r</span><span class="pun">:</span><span class="pln">
            a</span><span class="pun">[</span><span class="pln">l </span><span class="pun">-</span><span class="pln"> L</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> r
            </span><span class="kwd">return</span><span class="pln">
        mid </span><span class="pun">=</span><span class="pln"> l
        </span><span class="kwd">while</span><span class="pln"> mid </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> r </span><span class="kwd">and</span><span class="pln"> g</span><span class="pun">(</span><span class="pln">mid </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> j</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> g</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> j</span><span class="pun">):</span><span class="pln">
            mid </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> mid </span><span class="pun">==</span><span class="pln"> r</span><span class="pun">:</span><span class="pln">
            solve</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> j </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln">
        tl </span><span class="pun">=</span><span class="pln"> mid </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        tr </span><span class="pun">=</span><span class="pln"> mid
        </span><span class="kwd">while</span><span class="pln"> tl </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> l </span><span class="kwd">and</span><span class="pln"> tr </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> r</span><span class="pun">:</span><span class="pln">
            tl </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            tr </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            a</span><span class="pun">[</span><span class="pln">tl </span><span class="pun">-</span><span class="pln"> L</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tr
            a</span><span class="pun">[</span><span class="pln">tr </span><span class="pun">-</span><span class="pln"> L</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tl
        solve</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> tl </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> j </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        solve</span><span class="pun">(</span><span class="pln">tr </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> j </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln">

    solve</span><span class="pun">(</span><span class="pln">L</span><span class="pun">,</span><span class="pln"> R</span><span class="pun">,</span><span class="pln"> </span><span class="lit">29</span><span class="pun">)</span><span class="pln">
    ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">L</span><span class="pun">,</span><span class="pln"> R </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">):</span><span class="pln">
        ans </span><span class="pun">+=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> L</span><span class="pun">]</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> i
    </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(*</span><span class="pln">a</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln">


t </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">t</span><span class="pun">):</span><span class="pln">
    solve</span><span class="pun">()</span><span class="pln">
</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Another solution using greedy on trie</b><div class="spoiler-content" style="display: block;"><p>It turns out that we can solve it greedily from the lowest bit to the highest bit. For each element in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-283" style="width: 2.33em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.734em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1001.63em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-284"><span class="mo" id="MathJax-Span-285" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-286" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-287" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-288" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">r</span><span class="mo" id="MathJax-Span-289" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>l</mi><mo>,</mo><mi>r</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-55">[l,r]</script>, let's reverse its binary representation and insert it into a 01-trie. Then for each index <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-290" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-291"><span class="mi" id="MathJax-Span-292" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-56">i</script>, we can do <code class="tt">dfs</code> on the trie while trying to keep every bit different with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-293" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-294"><span class="mi" id="MathJax-Span-295" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-57">i</script>. Formally, each step we try to go to the opposite side of each bit of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-296" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-297"><span class="mi" id="MathJax-Span-298" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-58">i</script>, and go on the other side if that subtree is empty.</p><p>We can prove that this gives the same construction with the other method constructing from the higher bits. You can read the implementation for better understanding.</p></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">int</span><span class="pln">         </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> pb          push_back
</span><span class="com">#define</span><span class="pln"> REP</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">b</span><span class="pun">,</span><span class="pln">e</span><span class="pun">)</span><span class="pln">  </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=(</span><span class="pln">b</span><span class="pun">);</span><span class="pln">i</span><span class="pun">&lt;(</span><span class="kwd">int</span><span class="pun">)(</span><span class="pln">e</span><span class="pun">);++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln">r</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> tot</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> son</span><span class="pun">[</span><span class="lit">6000005</span><span class="pun">][</span><span class="lit">2</span><span class="pun">],</span><span class="pln">cnt</span><span class="pun">[</span><span class="lit">6000005</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	cin</span><span class="pun">&gt;&gt;</span><span class="pln">l</span><span class="pun">&gt;&gt;</span><span class="pln">r</span><span class="pun">;</span><span class="pln">
	tot</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	son</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]=</span><span class="pln">son</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]=-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	REP</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">l</span><span class="pun">,</span><span class="pln">r</span><span class="pun">+</span><span class="lit">1</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		REP</span><span class="pun">(</span><span class="pln">j</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="lit">30</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">int</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">p</span><span class="pun">=</span><span class="pln">son</span><span class="pun">[</span><span class="pln">x</span><span class="pun">][(</span><span class="pln">i</span><span class="pun">&gt;&gt;</span><span class="pln">j</span><span class="pun">)&amp;</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">p</span><span class="pun">==-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">p</span><span class="pun">=</span><span class="pln">tot</span><span class="pun">++,</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">son</span><span class="pun">[</span><span class="pln">p</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]=</span><span class="pln">son</span><span class="pun">[</span><span class="pln">p</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]=-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			x</span><span class="pun">=</span><span class="pln">p</span><span class="pun">;++</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">x</span><span class="pun">];</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> ans</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	vector</span><span class="str">&lt;int&gt;</span><span class="pln">res</span><span class="pun">;</span><span class="pln">
	REP</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">l</span><span class="pun">,</span><span class="pln">r</span><span class="pun">+</span><span class="lit">1</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">t</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		REP</span><span class="pun">(</span><span class="pln">j</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="lit">30</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">int</span><span class="pln"> o</span><span class="pun">=!((</span><span class="pln">i</span><span class="pun">&gt;&gt;</span><span class="pln">j</span><span class="pun">)&amp;</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">son</span><span class="pun">[</span><span class="pln">x</span><span class="pun">][</span><span class="pln">o</span><span class="pun">]==-</span><span class="lit">1</span><span class="pun">||!</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">son</span><span class="pun">[</span><span class="pln">x</span><span class="pun">][</span><span class="pln">o</span><span class="pun">]])</span><span class="pln">o</span><span class="pun">=!</span><span class="pln">o</span><span class="pun">;</span><span class="pln">
			t</span><span class="pun">|=</span><span class="pln">o</span><span class="pun">&lt;&lt;</span><span class="pln">j</span><span class="pun">;</span><span class="pln">
			x</span><span class="pun">=</span><span class="pln">son</span><span class="pun">[</span><span class="pln">x</span><span class="pun">][</span><span class="pln">o</span><span class="pun">];--</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">x</span><span class="pun">];</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		res</span><span class="pun">.</span><span class="pln">pb</span><span class="pun">(</span><span class="pln">t</span><span class="pun">);</span><span class="pln">ans</span><span class="pun">+=</span><span class="pln">i</span><span class="pun">|</span><span class="pln">t</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	cout</span><span class="pun">&lt;&lt;</span><span class="pln">ans</span><span class="pun">&lt;&lt;</span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> i</span><span class="pun">:</span><span class="pln">res</span><span class="pun">)</span><span class="pln">cout</span><span class="pun">&lt;&lt;</span><span class="pln">i</span><span class="pun">&lt;&lt;</span><span class="str">' '</span><span class="pun">;</span><span class="pln">
	cout</span><span class="pun">&lt;&lt;</span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> TC</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> tc</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    cin</span><span class="pun">&gt;&gt;</span><span class="pln">tc</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">tc</span><span class="pun">--){</span><span class="pln">
		</span><span class="typ">Main</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">),</span><span class="pln">cout</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">),</span><span class="pln">ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="lit">0</span><span class="pun">),</span><span class="pln">TC</span><span class="pun">(),</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="com">/*
1. CLEAR the arrays (ESPECIALLY multitests)
2. DELETE useless output
 */</span><span class="pln">
</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2146/problem/E" title="Codeforces Round 1052 (Div. 2)">2146E - Yet Another MEX Problem</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>For an array <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-299" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-300"><span class="mi" id="MathJax-Span-301" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-59">b</script> and an integer <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-302" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-303"><span class="mi" id="MathJax-Span-304" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-60">x</script> that <strong>does not appear in</strong> <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-305" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-306"><span class="mi" id="MathJax-Span-307" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-61">b</script>, let <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-308" style="width: 3.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.708em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1002.6em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-309"><span class="mi" id="MathJax-Span-310" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-311" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-312" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-313" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-314" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">x</span><span class="mo" id="MathJax-Span-315" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mi>b</mi><mo>,</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-62">g(b,x)</script> be the number of elements in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-316" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-317"><span class="mi" id="MathJax-Span-318" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-63">b</script> that is greater than <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-319" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-320"><span class="mi" id="MathJax-Span-321" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-64">x</script>. Then the weight of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-322" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-323"><span class="mi" id="MathJax-Span-324" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-65">b</script> equals to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-325" style="width: 6.929em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.252em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1005.14em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-326"><span class="mi" id="MathJax-Span-327" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-328" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-329" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-330" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-331" style="padding-left: 0.165em;"><span class="mrow" id="MathJax-Span-332"><span class="mi" id="MathJax-Span-333" style="font-family: MathJax_Main;">m</span><span class="mi" id="MathJax-Span-334" style="font-family: MathJax_Main;">e</span><span class="mi" id="MathJax-Span-335" style="font-family: MathJax_Main;">x</span></span></span><span class="mo" id="MathJax-Span-336" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-337" style="font-family: MathJax_Main;">b</span><span class="mo" id="MathJax-Span-338" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-339" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mi>b</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi></mrow><mo stretchy="false">(</mo><mi mathvariant="normal">b</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-66">g(b,\rm{mex}(b))</script>. However, when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-340" style="width: 6.659em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.035em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1004.93em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-341"><span class="mi" id="MathJax-Span-342" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-343" style="font-family: MathJax_Main; padding-left: 0.273em;">≠</span><span class="texatom" id="MathJax-Span-344" style="padding-left: 0.273em;"><span class="mrow" id="MathJax-Span-345"><span class="mi" id="MathJax-Span-346" style="font-family: MathJax_Main;">m</span><span class="mi" id="MathJax-Span-347" style="font-family: MathJax_Main;">e</span><span class="mi" id="MathJax-Span-348" style="font-family: MathJax_Main;">x</span></span></span><span class="mo" id="MathJax-Span-349" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-350" style="font-family: MathJax_Main;">b</span><span class="mo" id="MathJax-Span-351" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>≠</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi></mrow><mo stretchy="false">(</mo><mi mathvariant="normal">b</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-67">x\neq \rm{mex}(b)</script>, what will happen to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-352" style="width: 3.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.708em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1002.6em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-353"><span class="mi" id="MathJax-Span-354" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-355" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-356" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-357" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-358" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">x</span><span class="mo" id="MathJax-Span-359" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mi>b</mi><mo>,</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-68">g(b,x)</script>?</p> <div class="spoiler"><b class="spoiler-title">Answer</b><div class="spoiler-content" style="display: block;"><p>The value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-360" style="width: 3.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.708em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1002.6em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-361"><span class="mi" id="MathJax-Span-362" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-363" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-364" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-365" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-366" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">x</span><span class="mo" id="MathJax-Span-367" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mi>b</mi><mo>,</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-69">g(b,x)</script> is always smaller than or equal to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-368" style="width: 6.929em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.252em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1005.14em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-369"><span class="mi" id="MathJax-Span-370" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-371" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-372" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-373" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-374" style="padding-left: 0.165em;"><span class="mrow" id="MathJax-Span-375"><span class="mi" id="MathJax-Span-376" style="font-family: MathJax_Main;">m</span><span class="mi" id="MathJax-Span-377" style="font-family: MathJax_Main;">e</span><span class="mi" id="MathJax-Span-378" style="font-family: MathJax_Main;">x</span></span></span><span class="mo" id="MathJax-Span-379" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-380" style="font-family: MathJax_Main;">b</span><span class="mo" id="MathJax-Span-381" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-382" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mi>b</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi></mrow><mo stretchy="false">(</mo><mi mathvariant="normal">b</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-70">g(b,\rm{mex}(b))</script>, because when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-383" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-384"><span class="mi" id="MathJax-Span-385" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-71">x</script> <strong>does not appear in</strong> <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-386" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-387"><span class="mi" id="MathJax-Span-388" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-72">b</script>, letting <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;m&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-389" style="width: 6.659em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.035em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1004.93em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-390"><span class="mi" id="MathJax-Span-391" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-392" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="texatom" id="MathJax-Span-393" style="padding-left: 0.273em;"><span class="mrow" id="MathJax-Span-394"><span class="mi" id="MathJax-Span-395" style="font-family: MathJax_Main;">m</span><span class="mi" id="MathJax-Span-396" style="font-family: MathJax_Main;">e</span><span class="mi" id="MathJax-Span-397" style="font-family: MathJax_Main;">x</span></span></span><span class="mo" id="MathJax-Span-398" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-399" style="font-family: MathJax_Main;">b</span><span class="mo" id="MathJax-Span-400" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">x</mi></mrow><mo stretchy="false">(</mo><mi mathvariant="normal">b</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-73">x=\rm{mex}(b)</script> is optimal to maximize <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-401" style="width: 3.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.708em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1002.6em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-402"><span class="mi" id="MathJax-Span-403" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-404" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-405" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-406" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-407" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">x</span><span class="mo" id="MathJax-Span-408" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mi>b</mi><mo>,</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-74">g(b,x)</script>.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>For a fixed right endpoint <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-409" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-410"><span class="mi" id="MathJax-Span-411" style="font-family: MathJax_Math-italic;">r</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-75">r</script>, let's enumerate over all the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-412" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-413"><span class="mi" id="MathJax-Span-414" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-76">x</script> and maximize <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-415" style="width: 7.47em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.63em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1005.52em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-416"><span class="mi" id="MathJax-Span-417" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-418" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-419" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-420" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-421" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-422" style="font-family: MathJax_Main; padding-left: 0.165em;">…</span><span class="mi" id="MathJax-Span-423" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">r</span><span class="mo" id="MathJax-Span-424" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-425" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-426" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">x</span><span class="mo" id="MathJax-Span-427" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">[</mo><mi>l</mi><mo>…</mo><mi>r</mi><mo stretchy="false">]</mo><mo>,</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-77">g(a[l\dots r],x)</script> while keeping <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-428" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-429"><span class="mi" id="MathJax-Span-430" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-78">x</script> no occurred in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-431" style="width: 4.44em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.358em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1003.25em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-432"><span class="mi" id="MathJax-Span-433" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-434" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-435" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-436" style="font-family: MathJax_Main; padding-left: 0.165em;">…</span><span class="mi" id="MathJax-Span-437" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">r</span><span class="mo" id="MathJax-Span-438" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo stretchy="false">[</mo><mi>l</mi><mo>…</mo><mi>r</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-79">a[l\dots r]</script>. It's clear that the value is maximized for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-439" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-440"><span class="mi" id="MathJax-Span-441" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-80">x</script> if <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-442" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-443"><span class="mi" id="MathJax-Span-444" style="font-family: MathJax_Math-italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-81">l</script> equals the last occurrence of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-445" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-446"><span class="mi" id="MathJax-Span-447" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-82">x</script> plus <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-448" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-449"><span class="mn" id="MathJax-Span-450" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-83">1</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>Use a segment tree to maintain the answer for each <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-451" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-452"><span class="mi" id="MathJax-Span-453" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-84">x</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2146/problem/E" title="Codeforces Round 1052 (Div. 2)">2146E - Yet Another MEX Problem</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Let's calculate the <span class="tex-font-style-it">weight</span> of an array without calculating its mex: For each integer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1799">x</span></span></span><script type="math/tex" id="MathJax-Element-331">x</script> that <span class="tex-font-style-bf">does not occur in the array</span>, calculate the number of elements <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1800"><span class="MJXp-msubsup" id="MJXp-Span-1801"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1802" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1803" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1804" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1805">x</span></span></span><script type="math/tex" id="MathJax-Element-332">a_i>x</script> and compare it to the answer. Note that we have weakened the conditions from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1806"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1807">x</span></span></span><script type="math/tex" id="MathJax-Element-333">x</script> being the mex to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1808"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1809">x</span></span></span><script type="math/tex" id="MathJax-Element-334">x</script> not occurring. This will not change the answer because the answer is always maximized when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1810"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1811">x</span></span></span><script type="math/tex" id="MathJax-Element-335">x</script> is equal to the mex.</p><p>Then, to calculate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1812"><span class="MJXp-msubsup" id="MJXp-Span-1813"><span class="MJXp-mo" id="MJXp-Span-1814" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1815" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1816">1</span><span class="MJXp-mo" id="MJXp-Span-1817">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1818">l</span><span class="MJXp-mo" id="MJXp-Span-1819">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1820">r</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1821">w</span><span class="MJXp-mo" id="MJXp-Span-1822" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1823">l</span><span class="MJXp-mo" id="MJXp-Span-1824" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1825">r</span><span class="MJXp-mo" id="MJXp-Span-1826" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-336">\max_{1\le l\le r}w(l,r)</script>, we can iterate over all integers <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1827"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1828">x</span></span></span><script type="math/tex" id="MathJax-Element-337">x</script> that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1829"><span class="MJXp-mn" id="MJXp-Span-1830">0</span><span class="MJXp-mo" id="MJXp-Span-1831" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1832">x</span><span class="MJXp-mo" id="MJXp-Span-1833" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1834">n</span></span></span><script type="math/tex" id="MathJax-Element-338">0\le x\le n</script>, find its last occurrence <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1835"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1836">p</span></span></span><script type="math/tex" id="MathJax-Element-339">p</script> (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1837"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1838">p</span><span class="MJXp-mo" id="MJXp-Span-1839" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1840">0</span></span></span><script type="math/tex" id="MathJax-Element-340">p=0</script> if it never occurred), and use this <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1841"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1842">x</span></span></span><script type="math/tex" id="MathJax-Element-341">x</script> to calculate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1843"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1844">w</span><span class="MJXp-mo" id="MJXp-Span-1845" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1846">p</span><span class="MJXp-mo" id="MJXp-Span-1847" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1848">1</span><span class="MJXp-mo" id="MJXp-Span-1849" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1850">r</span><span class="MJXp-mo" id="MJXp-Span-1851" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-342">w(p+1,r)</script> and compare it to the answer. That is, the number of integers <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1852"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1853">i</span></span></span><script type="math/tex" id="MathJax-Element-343">i</script> that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1854"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1855">p</span><span class="MJXp-mo" id="MJXp-Span-1856" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1857">i</span><span class="MJXp-mo" id="MJXp-Span-1858" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1859">r</span></span></span><script type="math/tex" id="MathJax-Element-344">p<i\le r</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1860"><span class="MJXp-msubsup" id="MJXp-Span-1861"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1862" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1863" style="vertical-align: -0.4em;">p</span></span><span class="MJXp-mo" id="MJXp-Span-1864" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1865">x</span></span></span><script type="math/tex" id="MathJax-Element-345">a_p>x</script>.</p><p>Let's iterate over all integers <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1866"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1867">r</span></span></span><script type="math/tex" id="MathJax-Element-346">r</script> and use a segment tree to maintain the answer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1868"><span class="MJXp-msubsup" id="MJXp-Span-1869"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1870" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1871" style="vertical-align: -0.4em;">x</span></span></span></span><script type="math/tex" id="MathJax-Element-347">b_x</script> for each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1872"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1873">x</span></span></span><script type="math/tex" id="MathJax-Element-348">x</script>. Initially <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1874"><span class="MJXp-msubsup" id="MJXp-Span-1875"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1876" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1877" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-1878" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1879">0</span></span></span><script type="math/tex" id="MathJax-Element-349">b_x=0</script>. When you add <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1880"><span class="MJXp-mn" id="MJXp-Span-1881">1</span></span></span><script type="math/tex" id="MathJax-Element-350">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1882"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1883">r</span></span></span><script type="math/tex" id="MathJax-Element-351">r</script> and add a new integer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1884"><span class="MJXp-msubsup" id="MJXp-Span-1885"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1886" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1887" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-352">a_r</script> to the array, we should set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1888"><span class="MJXp-msubsup" id="MJXp-Span-1889"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1890" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1891" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1892"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1893" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1894" style="vertical-align: -0.4em;">r</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1895" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1896">0</span></span></span><script type="math/tex" id="MathJax-Element-353">b_{a_r}=0</script> and then increase <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1897"><span class="MJXp-msubsup" id="MJXp-Span-1898"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1899" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1900" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-354">b_i</script> by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1901"><span class="MJXp-mn" id="MJXp-Span-1902">1</span></span></span><script type="math/tex" id="MathJax-Element-355">1</script> for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1903"><span class="MJXp-mn" id="MJXp-Span-1904">0</span><span class="MJXp-mo" id="MJXp-Span-1905" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1906">i</span><span class="MJXp-mo" id="MJXp-Span-1907" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-1908"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1909" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1910" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-356">0\le i<a_r</script>. And then the maximum of array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1911"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1912">b</span></span></span><script type="math/tex" id="MathJax-Element-357">b</script> will be the answer.</p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1913"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1914">O</span><span class="MJXp-mo" id="MJXp-Span-1915" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1916">n</span><span class="MJXp-mi" id="MJXp-Span-1917">log</span><span class="MJXp-mo" id="MJXp-Span-1918" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1919">n</span><span class="MJXp-mo" id="MJXp-Span-1920" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-358">O(n\log n)</script>. </p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><p>By <a class="rated-user user-red" href="https://codeforces.com/profile/LMydd0225" title="International Grandmaster LMydd0225">LMydd0225</a>.</p> <pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> all</span><span class="pun">(</span><span class="pln">v</span><span class="pun">)</span><span class="pln">      v</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln">v</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">()</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> pb          push_back
</span><span class="com">#define</span><span class="pln"> REP</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">b</span><span class="pun">,</span><span class="pln">e</span><span class="pun">)</span><span class="pln">  </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=(</span><span class="pln">b</span><span class="pun">);</span><span class="pln">i</span><span class="pun">&lt;(</span><span class="kwd">int</span><span class="pun">)(</span><span class="pln">e</span><span class="pun">);++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">300005</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">struct</span><span class="pln"> ds</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> seg</span><span class="pun">[</span><span class="lit">1200005</span><span class="pun">],</span><span class="pln">tag</span><span class="pun">[</span><span class="lit">1200005</span><span class="pun">];</span><span class="pln">
	</span><span class="kwd">void</span><span class="pln"> build</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">){</span><span class="pln">
		seg</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]=</span><span class="pln">tag</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">l</span><span class="pun">==</span><span class="pln">r</span><span class="pun">)</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> m</span><span class="pun">=(</span><span class="pln">l</span><span class="pun">+</span><span class="pln">r</span><span class="pun">)&gt;&gt;</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		build</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln">m</span><span class="pun">,</span><span class="pln">p</span><span class="pun">*</span><span class="lit">2</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">build</span><span class="pun">(</span><span class="pln">m</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">r</span><span class="pun">,</span><span class="pln">p</span><span class="pun">*</span><span class="lit">2</span><span class="pun">+</span><span class="lit">2</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">void</span><span class="pln"> update</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> s</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">l</span><span class="pun">&lt;=</span><span class="pln">s</span><span class="pun">&amp;&amp;</span><span class="pln">t</span><span class="pun">&lt;=</span><span class="pln">r</span><span class="pun">){</span><span class="pln">
			</span><span class="pun">++</span><span class="pln">seg</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];++</span><span class="pln">tag</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
			</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> m</span><span class="pun">=(</span><span class="pln">s</span><span class="pun">+</span><span class="pln">t</span><span class="pun">)&gt;&gt;</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">m</span><span class="pun">&gt;=</span><span class="pln">l</span><span class="pun">)</span><span class="pln">update</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln">r</span><span class="pun">,</span><span class="pln">s</span><span class="pun">,</span><span class="pln">m</span><span class="pun">,</span><span class="pln">p</span><span class="pun">*</span><span class="lit">2</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">m</span><span class="pun">&lt;</span><span class="pln">r</span><span class="pun">)</span><span class="pln">update</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln">r</span><span class="pun">,</span><span class="pln">m</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">t</span><span class="pun">,</span><span class="pln">p</span><span class="pun">*</span><span class="lit">2</span><span class="pun">+</span><span class="lit">2</span><span class="pun">);</span><span class="pln">
		seg</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]=</span><span class="pln">max</span><span class="pun">(</span><span class="pln">seg</span><span class="pun">[</span><span class="pln">p</span><span class="pun">*</span><span class="lit">2</span><span class="pun">+</span><span class="lit">1</span><span class="pun">],</span><span class="pln">seg</span><span class="pun">[</span><span class="pln">p</span><span class="pun">*</span><span class="lit">2</span><span class="pun">+</span><span class="lit">2</span><span class="pun">])+</span><span class="pln">tag</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">void</span><span class="pln"> point</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> pos</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> val</span><span class="pun">=</span><span class="lit">0</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">l</span><span class="pun">==</span><span class="pln">r</span><span class="pun">)</span><span class="kwd">return</span><span class="pln"> seg</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]=-</span><span class="pln">val</span><span class="pun">,</span><span class="kwd">void</span><span class="pun">();</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> m</span><span class="pun">=(</span><span class="pln">l</span><span class="pun">+</span><span class="pln">r</span><span class="pun">)&gt;&gt;</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		val</span><span class="pun">+=</span><span class="pln">tag</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">m</span><span class="pun">&gt;=</span><span class="pln">pos</span><span class="pun">)</span><span class="pln">point</span><span class="pun">(</span><span class="pln">pos</span><span class="pun">,</span><span class="pln">l</span><span class="pun">,</span><span class="pln">m</span><span class="pun">,</span><span class="pln">p</span><span class="pun">*</span><span class="lit">2</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">val</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">else</span><span class="pln"> point</span><span class="pun">(</span><span class="pln">pos</span><span class="pun">,</span><span class="pln">m</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">r</span><span class="pun">,</span><span class="pln">p</span><span class="pun">*</span><span class="lit">2</span><span class="pun">+</span><span class="lit">2</span><span class="pun">,</span><span class="pln">val</span><span class="pun">);</span><span class="pln">
		seg</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]=</span><span class="pln">max</span><span class="pun">(</span><span class="pln">seg</span><span class="pun">[</span><span class="pln">p</span><span class="pun">*</span><span class="lit">2</span><span class="pun">+</span><span class="lit">1</span><span class="pun">],</span><span class="pln">seg</span><span class="pun">[</span><span class="pln">p</span><span class="pun">*</span><span class="lit">2</span><span class="pun">+</span><span class="lit">2</span><span class="pun">])+</span><span class="pln">tag</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">seg</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	cin</span><span class="pun">&gt;&gt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
	REP</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="pln">n</span><span class="pun">)</span><span class="pln">cin</span><span class="pun">&gt;&gt;</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
	seg</span><span class="pun">.</span><span class="pln">build</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	REP</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="pln">n</span><span class="pun">){</span><span class="pln">
		seg</span><span class="pun">.</span><span class="pln">update</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="lit">0</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
		seg</span><span class="pun">.</span><span class="pln">point</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="lit">0</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
		cout</span><span class="pun">&lt;&lt;</span><span class="pln">seg</span><span class="pun">.</span><span class="pln">seg</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]&lt;&lt;</span><span class="str">' '</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	cout</span><span class="pun">&lt;&lt;</span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> TC</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> tc</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    cin</span><span class="pun">&gt;&gt;</span><span class="pln">tc</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">tc</span><span class="pun">--){</span><span class="pln">
		</span><span class="typ">Main</span><span class="pun">();</span><span class="pln">
		cout</span><span class="pun">.</span><span class="pln">flush</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">),</span><span class="pln">cout</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">),</span><span class="pln">ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="lit">0</span><span class="pun">),</span><span class="pln">TC</span><span class="pun">(),</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="com">/*
1. CLEAR the arrays (ESPECIALLY multitests)
2. DELETE useless output
 */</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Bonus</b><div class="spoiler-content" style="display: block;"><p>There's a harder version of the problem. Can you solve it?</p><p>There're <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-454" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.44em, 2.492em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-455"><span class="mi" id="MathJax-Span-456" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></span></span><script type="math/tex" id="MathJax-Element-85">q</script> queries: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-457" style="width: 2.005em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.518em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.572em, 1001.52em, 2.546em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-458"><span class="mi" id="MathJax-Span-459" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-460" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-461" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>,</mo><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-86">x,y</script>. Find <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;munder&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-462" style="width: 10.23em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.741em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1007.63em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-463"><span class="munderover" id="MathJax-Span-464"><span style="display: inline-block; position: relative; width: 4.873em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1001.84em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-465" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 1.843em;"><span class="texatom" id="MathJax-Span-466"><span class="mrow" id="MathJax-Span-467"><span class="mi" id="MathJax-Span-468" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-469" style="font-size: 70.7%; font-family: MathJax_Main;">≤</span><span class="mi" id="MathJax-Span-470" style="font-size: 70.7%; font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-471" style="font-size: 70.7%; font-family: MathJax_Main;">≤</span><span class="mi" id="MathJax-Span-472" style="font-size: 70.7%; font-family: MathJax_Math-italic;">r</span><span class="mo" id="MathJax-Span-473" style="font-size: 70.7%; font-family: MathJax_Main;">≤</span><span class="mi" id="MathJax-Span-474" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mi" id="MathJax-Span-475" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">w</span><span class="mo" id="MathJax-Span-476" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-477" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-478" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-479" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">r</span><span class="mo" id="MathJax-Span-480" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.504em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><munder><mo movablelimits="true" form="prefix">max</mo><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>≤</mo><mi>l</mi><mo>≤</mo><mi>r</mi><mo>≤</mo><mi>y</mi></mrow></munder><mi>w</mi><mo stretchy="false">(</mo><mi>l</mi><mo>,</mo><mi>r</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-87">\max_{x\le l\le r\le y}w(l,r)</script>. <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-481" style="width: 7.254em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.468em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.139em, 1005.47em, 2.546em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-482"><span class="mi" id="MathJax-Span-483" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-484" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-485" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-486" style="font-family: MathJax_Main; padding-left: 0.273em;">≤</span><span class="mn" id="MathJax-Span-487" style="font-family: MathJax_Main; padding-left: 0.273em;">3</span><span class="mo" id="MathJax-Span-488" style="font-family: MathJax_Main; padding-left: 0.219em;">⋅</span><span class="msubsup" id="MathJax-Span-489" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 1.41em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mn" id="MathJax-Span-490" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.977em;"><span class="mn" id="MathJax-Span-491" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>,</mo><mi>q</mi><mo>≤</mo><mn>3</mn><mo>⋅</mo><msup><mn>10</mn><mn>5</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-88">n,q\le 3\cdot 10^5</script>.</p></div></div><p><a href="https://codeforces.com/contest/2146/problem/F" title="Codeforces Round 1052 (Div. 2)">2146F - Bubble Sort</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Let's focus on bubble sort first. For an element <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-492" style="width: 1.301em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.98em, 2.492em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-493"><span class="msubsup" id="MathJax-Span-494"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-495" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-496" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>x</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-89">p_x</script>, how many rounds does it take to make all the numbers before the position small than <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-497" style="width: 1.301em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.98em, 2.492em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-498"><span class="msubsup" id="MathJax-Span-499"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-500" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-501" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>x</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-90">p_x</script>?</p> <div class="spoiler"><b class="spoiler-title">Answer</b><div class="spoiler-content" style="display: block;"><p>Count the number of integers <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-502" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-503"><span class="mi" id="MathJax-Span-504" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-91">i</script> such that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-505" style="width: 2.925em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.221em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1002.17em, 2.384em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-506"><span class="mi" id="MathJax-Span-507" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-508" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="mi" id="MathJax-Span-509" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">x</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.139em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>&lt;</mo><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-92">i<x</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-510" style="width: 4.169em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.141em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.464em, 1003.14em, 2.546em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-511"><span class="msubsup" id="MathJax-Span-512"><span style="display: inline-block; position: relative; width: 0.814em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-513" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-514" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-515" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="msubsup" id="MathJax-Span-516" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-517" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-518" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>i</mi></msub><mo>&gt;</mo><msub><mi>p</mi><mi>x</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-93">p_i>p_x</script>. In one round of bubble sort, exactly one of that sort of element will be moved to the right of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-519" style="width: 1.301em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.98em, 2.492em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-520"><span class="msubsup" id="MathJax-Span-521"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-522" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-523" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>x</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-94">p_x</script>.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Try to count something else instead of permutations <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-524" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.49em, 2.492em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-525"><span class="mi" id="MathJax-Span-526" style="font-family: MathJax_Math-italic;">p</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-95">p</script>. Can you come up with an <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-527" style="width: 3.466em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.6em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.193em, 1002.49em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-528"><span class="mi" id="MathJax-Span-529" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-530" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-531"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.6em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-532" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.598em;"><span class="mn" id="MathJax-Span-533" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-534" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-96">O(n^2)</script> dynamic programming method?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>The number of restrictions is small (<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;1000&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-535" style="width: 5.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.223em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1004.17em, 2.492em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-536"><span class="mi" id="MathJax-Span-537" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-538" style="font-family: MathJax_Main; padding-left: 0.273em;">≤</span><span class="mn" id="MathJax-Span-539" style="font-family: MathJax_Main; padding-left: 0.273em;">1000</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mo>≤</mo><mn>1000</mn></math></span></span><script type="math/tex" id="MathJax-Element-97">m\le 1000</script>). Can we decrease the number of states from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-98-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-540" style="width: 3.466em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.6em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.193em, 1002.49em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-541"><span class="mi" id="MathJax-Span-542" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-543" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-544"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.6em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-545" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.598em;"><span class="mn" id="MathJax-Span-546" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-547" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-98">O(n^2)</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-548" style="width: 4.007em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.033em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1002.92em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-549"><span class="mi" id="MathJax-Span-550" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-551" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-552" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-553" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-554" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>m</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-99">O(nm)</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-100-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-555" style="width: 3.791em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.871em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.193em, 1002.76em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-556"><span class="mi" id="MathJax-Span-557" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-558" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-559"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.87em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-560" style="font-family: MathJax_Math-italic;">m</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.869em;"><span class="mn" id="MathJax-Span-561" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-562" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>m</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-100">O(m^2)</script>? How to calculate the coefficients then?</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2146/problem/F" title="Codeforces Round 1052 (Div. 2)">2146F - Bubble Sort</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Let's simulate the process of bubble sort. For an element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1921"><span class="MJXp-msubsup" id="MJXp-Span-1922"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1923" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1924" style="vertical-align: -0.4em;">x</span></span></span></span><script type="math/tex" id="MathJax-Element-359">a_x</script>, one necessary condition of the array being sorted is: for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1925"><span class="MJXp-mn" id="MJXp-Span-1926">1</span><span class="MJXp-mo" id="MJXp-Span-1927" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1928">i</span><span class="MJXp-mo" id="MJXp-Span-1929" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1930">x</span></span></span><script type="math/tex" id="MathJax-Element-360">1\le i<x</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1931"><span class="MJXp-msubsup" id="MJXp-Span-1932"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1933" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1934" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1935" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-1936"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1937" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1938" style="vertical-align: -0.4em;">x</span></span></span></span><script type="math/tex" id="MathJax-Element-361">a_i<a_x</script>. And if the condition is held for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1939"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1940">x</span></span></span><script type="math/tex" id="MathJax-Element-362">x</script>, the array will be sorted.</p><p>Let's consider the elements <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1941"><span class="MJXp-msubsup" id="MJXp-Span-1942"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1943" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1944" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-363">a_i</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1945"><span class="MJXp-mn" id="MJXp-Span-1946">1</span><span class="MJXp-mo" id="MJXp-Span-1947" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1948">i</span><span class="MJXp-mo" id="MJXp-Span-1949" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1950">x</span></span></span><script type="math/tex" id="MathJax-Element-364">1\le i<x</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1951"><span class="MJXp-msubsup" id="MJXp-Span-1952"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1953" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1954" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1955" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-1956"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1957" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1958" style="vertical-align: -0.4em;">x</span></span></span></span><script type="math/tex" id="MathJax-Element-365">a_i>a_x</script>. In one round of bubble sort, the largest element before <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1959"><span class="MJXp-msubsup" id="MJXp-Span-1960"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1961" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1962" style="vertical-align: -0.4em;">x</span></span></span></span><script type="math/tex" id="MathJax-Element-366">a_x</script> will occur on the position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1963"><span class="MJXp-msubsup" id="MJXp-Span-1964"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1965" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1966" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1967">x</span><span class="MJXp-mo" id="MJXp-Span-1968">−</span><span class="MJXp-mn" id="MJXp-Span-1969">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-367">a_{x-1}</script>, and then swapped with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1970"><span class="MJXp-msubsup" id="MJXp-Span-1971"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1972" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1973" style="vertical-align: -0.4em;">x</span></span></span></span><script type="math/tex" id="MathJax-Element-368">a_x</script>. So the number of such elements <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1974"><span class="MJXp-msubsup" id="MJXp-Span-1975"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1976" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1977" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-369">a_i</script> (before and greater than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1978"><span class="MJXp-msubsup" id="MJXp-Span-1979"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1980" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1981" style="vertical-align: -0.4em;">x</span></span></span></span><script type="math/tex" id="MathJax-Element-370">a_x</script>) will decrease by exactly one. Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1982"><span class="MJXp-msubsup" id="MJXp-Span-1983"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1984" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1985" style="vertical-align: -0.4em;">x</span></span></span></span><script type="math/tex" id="MathJax-Element-371">c_x</script> be the number of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1986"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1987">i</span></span></span><script type="math/tex" id="MathJax-Element-372">i</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1988"><span class="MJXp-mn" id="MJXp-Span-1989">1</span><span class="MJXp-mo" id="MJXp-Span-1990" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1991">i</span><span class="MJXp-mo" id="MJXp-Span-1992" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1993">x</span></span></span><script type="math/tex" id="MathJax-Element-373">1\le i<x</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1994"><span class="MJXp-msubsup" id="MJXp-Span-1995"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1996" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1997" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1998" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-1999"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2000" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2001" style="vertical-align: -0.4em;">x</span></span></span></span><script type="math/tex" id="MathJax-Element-374">a_i>a_x</script> before the sorting, we can see that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2002"><span class="MJXp-mtext" id="MJXp-Span-2003">sort</span><span class="MJXp-mo" id="MJXp-Span-2004" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2005">a</span><span class="MJXp-mo" id="MJXp-Span-2006" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2007" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2008"><span class="MJXp-mo" id="MJXp-Span-2009" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2010" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2011">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2012"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2013" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2014" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-375">\text{sort}(a)=\max_{i}c_i</script>. Moreover, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2015"><span class="MJXp-msubsup" id="MJXp-Span-2016"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2017" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2018" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-376">b_i</script> in the statement equals <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2019"><span class="MJXp-mtext" id="MJXp-Span-2020">sort</span><span class="MJXp-mo" id="MJXp-Span-2021" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-2022" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-2023"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2024" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2025" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2026" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2027"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2028" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2029" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2030" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2031" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2032" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2033"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2034" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2035" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2036" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-2037" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2038" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2039"><span class="MJXp-mo" id="MJXp-Span-2040" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2041" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2042">1</span><span class="MJXp-mo" id="MJXp-Span-2043">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2044">j</span><span class="MJXp-mo" id="MJXp-Span-2045">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2046">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2047"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2048" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2049" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-377">\text{sort}([a_1,a_2,\dots,a_i])=\max_{1\le j\le i} c_j</script>, which is the prefix maximum of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2050"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2051">c</span></span></span><script type="math/tex" id="MathJax-Element-378">c</script>.</p><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2052"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2053">a</span></span></span><script type="math/tex" id="MathJax-Element-379">a</script> be a permutation. From the definition of array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2054"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2055">c</span></span></span><script type="math/tex" id="MathJax-Element-380">c</script>, we can see that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2056"><span class="MJXp-mn" id="MJXp-Span-2057">0</span><span class="MJXp-mo" id="MJXp-Span-2058" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-2059"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2060" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2061" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2062" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2063">i</span><span class="MJXp-mo" id="MJXp-Span-2064" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2065">1</span></span></span><script type="math/tex" id="MathJax-Element-381">0\le c_i\le i-1</script>, and the number of possible array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2066"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2067">c</span></span></span><script type="math/tex" id="MathJax-Element-382">c</script> is exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2068"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2069">n</span><span class="MJXp-mo" id="MJXp-Span-2070" style="margin-left: 0.111em; margin-right: 0em;">!</span></span></span><script type="math/tex" id="MathJax-Element-383">n!</script>. We can prove by construction that array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2071"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2072">c</span></span></span><script type="math/tex" id="MathJax-Element-384">c</script> and permutation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2073"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2074">a</span></span></span><script type="math/tex" id="MathJax-Element-385">a</script> form a bijection. Let's just count the number of arrays <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2075"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2076">c</span></span></span><script type="math/tex" id="MathJax-Element-386">c</script> such that: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2077"><span class="MJXp-mn" id="MJXp-Span-2078">0</span><span class="MJXp-mo" id="MJXp-Span-2079" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-2080"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2081" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2082" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2083" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2084">i</span></span></span><script type="math/tex" id="MathJax-Element-387">0\le c_i<i</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2085"><span class="MJXp-msubsup" id="MJXp-Span-2086"><span class="MJXp-mo" id="MJXp-Span-2087" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2092"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2093">l</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2088"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2089">i</span><span class="MJXp-mo" id="MJXp-Span-2090">=</span><span class="MJXp-mn" id="MJXp-Span-2091">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2094"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2095" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2096" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2097" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2098">k</span></span></span><script type="math/tex" id="MathJax-Element-388">\max_{i=1}^{l}c_i\le k</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2099"><span class="MJXp-msubsup" id="MJXp-Span-2100"><span class="MJXp-mo" id="MJXp-Span-2101" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2106"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2107">r</span><span class="MJXp-mo" id="MJXp-Span-2108">+</span><span class="MJXp-mn" id="MJXp-Span-2109">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2102"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2103">i</span><span class="MJXp-mo" id="MJXp-Span-2104">=</span><span class="MJXp-mn" id="MJXp-Span-2105">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2111" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2112" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2113" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2114">k</span></span></span><script type="math/tex" id="MathJax-Element-389">\max_{i=1}^{r+1}c_i\gt k</script>.</p><p>Here is an <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2115"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2116">O</span><span class="MJXp-mo" id="MJXp-Span-2117" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2119" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2120" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2121" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-390">O(n^2)</script> dynamic programming method: Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2122"><span class="MJXp-msubsup" id="MJXp-Span-2123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2124" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2125" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2126">i</span><span class="MJXp-mo" id="MJXp-Span-2127">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2128">j</span></span></span></span></span><script type="math/tex" id="MathJax-Element-391">f_{i,j}</script> be the number of ways to fill the first <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2130">i</span></span></span><script type="math/tex" id="MathJax-Element-392">i</script> elements of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2132">c</span></span></span><script type="math/tex" id="MathJax-Element-393">c</script>, and the current maximum is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2134">j</span></span></span><script type="math/tex" id="MathJax-Element-394">j</script>. We can use prefix sum to optimize it to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2136">O</span><span class="MJXp-mo" id="MJXp-Span-2137" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2138"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2139" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2140" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2141" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-395">O(n^2)</script>.</p><p>We need to notice that the number of restrictions is small (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2143">m</span><span class="MJXp-mo" id="MJXp-Span-2144" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-2145">1000</span></span></span><script type="math/tex" id="MathJax-Element-396">m\le 1000</script>). There're only <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2146"><span class="MJXp-mn" id="MJXp-Span-2147">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2148">m</span></span></span><script type="math/tex" id="MathJax-Element-397">2m</script> points that have restrictions. Let the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2149"><span class="MJXp-mn" id="MJXp-Span-2150">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2151">m</span></span></span><script type="math/tex" id="MathJax-Element-398">2m</script> points split the array of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2153">n</span></span></span><script type="math/tex" id="MathJax-Element-399">n</script> into <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2154"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2155">O</span><span class="MJXp-mo" id="MJXp-Span-2156" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2157">m</span><span class="MJXp-mo" id="MJXp-Span-2158" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-400">O(m)</script> intervals, and we can each time fill a whole interval. Similarly, the range of values can be split into <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2159"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2160">O</span><span class="MJXp-mo" id="MJXp-Span-2161" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2162">m</span><span class="MJXp-mo" id="MJXp-Span-2163" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-401">O(m)</script> intervals. Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2164"><span class="MJXp-msubsup" id="MJXp-Span-2165"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2166" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2167" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2168">i</span><span class="MJXp-mo" id="MJXp-Span-2169">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2170">j</span></span></span></span></span><script type="math/tex" id="MathJax-Element-402">g_{i,j}</script> be the number of ways to fill the first <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2172">i</span></span></span><script type="math/tex" id="MathJax-Element-403">i</script> intervals and the current maximum is in the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2173"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2174">j</span></span></span><script type="math/tex" id="MathJax-Element-404">j</script>-th interval. </p><p>There are two types of transitions: </p><ul><li> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2175"><span class="MJXp-msubsup" id="MJXp-Span-2176"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2177" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2178" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2179">i</span><span class="MJXp-mo" id="MJXp-Span-2180">−</span><span class="MJXp-mn" id="MJXp-Span-2181">1</span><span class="MJXp-mo" id="MJXp-Span-2182">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2183">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-2184" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2185">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2186">o</span><span class="MJXp-mo" id="MJXp-Span-2187" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-msubsup" id="MJXp-Span-2188"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2189" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2190" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2191">i</span><span class="MJXp-mo" id="MJXp-Span-2192">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2193">j</span></span></span></span></span><script type="math/tex" id="MathJax-Element-405">g_{i-1,j}\times co\rightarrow g_{i,j}</script>. The coefficient here refers to: for the numbers in the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2194"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2195">i</span></span></span><script type="math/tex" id="MathJax-Element-406">i</script>-th interval, the maximum does not exceed the upper bound of the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2196"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2197">j</span></span></span><script type="math/tex" id="MathJax-Element-407">j</script>-th value interval. Let's call the coefficient <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2198"><span class="MJXp-mtext" id="MJXp-Span-2199">calc</span><span class="MJXp-mo" id="MJXp-Span-2200" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2201">l</span><span class="MJXp-mo" id="MJXp-Span-2202" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2203">r</span><span class="MJXp-mo" id="MJXp-Span-2204" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2205">t</span><span class="MJXp-mo" id="MJXp-Span-2206" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-408">\text{calc}(l,r,t)</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2208">l</span><span class="MJXp-mo" id="MJXp-Span-2209" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2210">r</span></span></span><script type="math/tex" id="MathJax-Element-409">l,r</script> represents the index interval and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2211"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2212">t</span></span></span><script type="math/tex" id="MathJax-Element-410">t</script> represents the upper bound of the value.</li><li> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2213"><span class="MJXp-msubsup" id="MJXp-Span-2214"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2215" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2216" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2217">i</span><span class="MJXp-mo" id="MJXp-Span-2218">−</span><span class="MJXp-mn" id="MJXp-Span-2219">1</span><span class="MJXp-mo" id="MJXp-Span-2220">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2221">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-2222" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2223">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2224">o</span><span class="MJXp-mo" id="MJXp-Span-2225" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-msubsup" id="MJXp-Span-2226"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2227" style="margin-right: 0.05em;">g</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2228" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2229">i</span><span class="MJXp-mo" id="MJXp-Span-2230">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2231">k</span></span></span></span></span><script type="math/tex" id="MathJax-Element-411">g_{i-1,j}\times co\rightarrow g_{i,k}</script>. Here, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2232"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2233">j</span><span class="MJXp-mo" id="MJXp-Span-2234" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2235">k</span></span></span><script type="math/tex" id="MathJax-Element-412">j<k</script>. Here, for the numbers in the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2236"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2237">i</span></span></span><script type="math/tex" id="MathJax-Element-413">i</script>-th interval, the maximum is exactly in the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2238"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2239">j</span></span></span><script type="math/tex" id="MathJax-Element-414">j</script>-th value interval (call it <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2240"><span class="MJXp-mo" id="MJXp-Span-2241" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-2242"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2243" style="margin-right: 0.05em;">v</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2244" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-2245" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2246"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2247" style="margin-right: 0.05em;">v</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2248" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-2249" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-415">[v_l,v_r]</script>). The coefficient is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2250"><span class="MJXp-mtext" id="MJXp-Span-2251">calc</span><span class="MJXp-mo" id="MJXp-Span-2252" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2253">l</span><span class="MJXp-mo" id="MJXp-Span-2254" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2255">r</span><span class="MJXp-mo" id="MJXp-Span-2256" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2257"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2258" style="margin-right: 0.05em;">v</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2259" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-2260" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2261" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-2262">calc</span><span class="MJXp-mo" id="MJXp-Span-2263" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2264">l</span><span class="MJXp-mo" id="MJXp-Span-2265" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2266">r</span><span class="MJXp-mo" id="MJXp-Span-2267" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2268"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2269" style="margin-right: 0.05em;">v</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2270" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-2271" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2272">1</span><span class="MJXp-mo" id="MJXp-Span-2273" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-416">\text{calc}(l,r,v_r)-\text{calc}(l,r,v_l-1)</script>.</li></ul><p>So we need to calculate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2274"><span class="MJXp-mtext" id="MJXp-Span-2275">calc</span><span class="MJXp-mo" id="MJXp-Span-2276" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2277">l</span><span class="MJXp-mo" id="MJXp-Span-2278" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2279">r</span><span class="MJXp-mo" id="MJXp-Span-2280" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2281">t</span><span class="MJXp-mo" id="MJXp-Span-2282" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-417">\text{calc}(l,r,t)</script>: fill the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2283"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2284">l</span></span></span><script type="math/tex" id="MathJax-Element-418">l</script>-th to the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2285"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2286">r</span></span></span><script type="math/tex" id="MathJax-Element-419">r</script>-th element of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2288">c</span></span></span><script type="math/tex" id="MathJax-Element-420">c</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2289"><span class="MJXp-mn" id="MJXp-Span-2290">0</span><span class="MJXp-mo" id="MJXp-Span-2291" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-2292"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2293" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2294" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2295" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2296">i</span></span></span><script type="math/tex" id="MathJax-Element-421">0\le c_i<i</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2297"><span class="MJXp-msubsup" id="MJXp-Span-2298"><span class="MJXp-mo" id="MJXp-Span-2299" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2300" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2301">i</span><span class="MJXp-mo" id="MJXp-Span-2302">∈</span><span class="MJXp-mo" id="MJXp-Span-2303">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2304">l</span><span class="MJXp-mo" id="MJXp-Span-2305">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2306">r</span><span class="MJXp-mo" id="MJXp-Span-2307">]</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2308"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2309" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2310" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2311" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2312">t</span></span></span><script type="math/tex" id="MathJax-Element-422">\max_{i\in[l,r]}c_i\le t</script>. Here <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2313"><span class="MJXp-mn" id="MJXp-Span-2314">0</span><span class="MJXp-mo" id="MJXp-Span-2315" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-2316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2317" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2318" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2319" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mo" id="MJXp-Span-2320" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-2321" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2322">i</span><span class="MJXp-mo" id="MJXp-Span-2323" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2324">1</span><span class="MJXp-mo" id="MJXp-Span-2325" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2326">t</span><span class="MJXp-mo" id="MJXp-Span-2327" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-423">0\le c_i\le \min(i-1,t)</script>. There's a prefix that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2328"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2329">i</span><span class="MJXp-mo" id="MJXp-Span-2330" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2331">1</span><span class="MJXp-mo" id="MJXp-Span-2332" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2333">t</span></span></span><script type="math/tex" id="MathJax-Element-424">i-1\le t</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2334"><span class="MJXp-mn" id="MJXp-Span-2335">0</span><span class="MJXp-mo" id="MJXp-Span-2336" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-2337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2338" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2339" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2340" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2341">i</span><span class="MJXp-mo" id="MJXp-Span-2342" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2343">1</span></span></span><script type="math/tex" id="MathJax-Element-425">0\le c_i\le i-1</script>, and the coefficient can be calculated using factorials and inverse of factorials. For the suffix part that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2344"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2345">i</span><span class="MJXp-mo" id="MJXp-Span-2346" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2347">1</span><span class="MJXp-mo" id="MJXp-Span-2348" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2349">t</span></span></span><script type="math/tex" id="MathJax-Element-426">i-1>t</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2350"><span class="MJXp-mn" id="MJXp-Span-2351">0</span><span class="MJXp-mo" id="MJXp-Span-2352" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-2353"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2354" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2355" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2356" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2357">t</span></span></span><script type="math/tex" id="MathJax-Element-427">0\le c_i\le t</script>, and this can be calculated using quick pow. </p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2358"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2359">O</span><span class="MJXp-mo" id="MJXp-Span-2360" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2361"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2362" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2363" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi" id="MJXp-Span-2364">log</span><span class="MJXp-mo" id="MJXp-Span-2365" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2366">n</span><span class="MJXp-mo" id="MJXp-Span-2367" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-428">O(m^2\log n)</script>. The <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2368"><span class="MJXp-mi" id="MJXp-Span-2369">log</span></span></span><script type="math/tex" id="MathJax-Element-429">\log</script> refers to quick pow.</p><p>Proof for permutation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2371">a</span></span></span><script type="math/tex" id="MathJax-Element-430">a</script> and array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2372"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2373">c</span></span></span><script type="math/tex" id="MathJax-Element-431">c</script> form a bijection:</p><ul><li> Given a permutation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2375">a</span></span></span><script type="math/tex" id="MathJax-Element-432">a</script>, you can uniquely determine array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2376"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2377">c</span></span></span><script type="math/tex" id="MathJax-Element-433">c</script>.</li><li> Given array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2379">c</span></span></span><script type="math/tex" id="MathJax-Element-434">c</script>, let's recover the permutation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2381">a</span></span></span><script type="math/tex" id="MathJax-Element-435">a</script> from back to front: There're <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2382"><span class="MJXp-msubsup" id="MJXp-Span-2383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2384" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2385" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-436">c_n</script> numbers in all that are greater than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2386"><span class="MJXp-msubsup" id="MJXp-Span-2387"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2388" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2389" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-437">a_n</script>, so <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2390"><span class="MJXp-msubsup" id="MJXp-Span-2391"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2392" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2393" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-2394" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2395">n</span><span class="MJXp-mo" id="MJXp-Span-2396" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2397"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2398" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2399" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-438">a_n=n-c_n</script>, and then delete <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2400"><span class="MJXp-msubsup" id="MJXp-Span-2401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2402" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2403" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-439">a_n</script> from the possible values. Similarly, when you have determined a suffix, you should find the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2404"><span class="MJXp-mo" id="MJXp-Span-2405" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2407" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2408" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2409" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2410">1</span><span class="MJXp-mo" id="MJXp-Span-2411" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-440">(c_i+1)</script>-th greatest number in those you have not used.</li></ul><p>In all, you can uniquely determine another if you know one of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2412"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2413">a</span></span></span><script type="math/tex" id="MathJax-Element-441">a</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2414"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2415">c</span></span></span><script type="math/tex" id="MathJax-Element-442">c</script>. So this forms a bijection.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><p>By <a class="rated-user user-red" href="https://codeforces.com/profile/LMydd0225" title="International Grandmaster LMydd0225">LMydd0225</a>.</p> <pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> MOD         </span><span class="lit">998244353</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> speMOD      </span><span class="lit">2933256077ll</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">int</span><span class="pln">         </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> pii         pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> all</span><span class="pun">(</span><span class="pln">v</span><span class="pun">)</span><span class="pln">      v</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln">v</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">()</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> pb          push_back
</span><span class="com">#define</span><span class="pln"> REP</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">b</span><span class="pun">,</span><span class="pln">e</span><span class="pun">)</span><span class="pln">  </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=(</span><span class="pln">b</span><span class="pun">);</span><span class="pln">i</span><span class="pun">&lt;(</span><span class="kwd">int</span><span class="pun">)(</span><span class="pln">e</span><span class="pun">);++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> over</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln">     </span><span class="pun">{</span><span class="pln">cout</span><span class="pun">&lt;&lt;(</span><span class="pln">x</span><span class="pun">)&lt;&lt;</span><span class="pln">endl</span><span class="pun">;</span><span class="kwd">return</span><span class="pun">;}</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> lowbit</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln">   </span><span class="pun">((</span><span class="pln">x</span><span class="pun">)&amp;(-(</span><span class="pln">x</span><span class="pun">)))</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> cntbit</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln">   __builtin_popcount</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> rf</span><span class="pun">(</span><span class="pln">v</span><span class="pun">)</span><span class="pln">       shuffle</span><span class="pun">(</span><span class="pln">all</span><span class="pun">(</span><span class="pln">v</span><span class="pun">),</span><span class="pln">sd</span><span class="pun">);</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> deal</span><span class="pun">(</span><span class="pln">v</span><span class="pun">)</span><span class="pln">     sort</span><span class="pun">(</span><span class="pln">all</span><span class="pun">(</span><span class="pln">v</span><span class="pun">));</span><span class="pln">v</span><span class="pun">.</span><span class="pln">erase</span><span class="pun">(</span><span class="pln">unique</span><span class="pun">(</span><span class="pln">v</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln">v</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">()),</span><span class="pln">v</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">())</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> lbound</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> lower_bound</span><span class="pun">(</span><span class="pln">all</span><span class="pun">(</span><span class="pln">v</span><span class="pun">),</span><span class="pln">x</span><span class="pun">)-</span><span class="pln">v</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">()</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> qpow</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> b</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> m</span><span class="pun">=</span><span class="pln">MOD</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> res</span><span class="pun">=</span><span class="lit">1</span><span class="pun">){</span><span class="pln">
	a</span><span class="pun">%=</span><span class="pln">m</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">b</span><span class="pun">&gt;</span><span class="lit">0</span><span class="pun">)</span><span class="pln">res</span><span class="pun">=(</span><span class="pln">b</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)?(</span><span class="pln">res</span><span class="pun">*</span><span class="pln">a</span><span class="pun">%</span><span class="pln">m</span><span class="pun">):(</span><span class="pln">res</span><span class="pun">),</span><span class="pln">a</span><span class="pun">=</span><span class="pln">a</span><span class="pun">*</span><span class="pln">a</span><span class="pun">%</span><span class="pln">m</span><span class="pun">,</span><span class="pln">b</span><span class="pun">&gt;&gt;=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> fac</span><span class="pun">[</span><span class="lit">2000005</span><span class="pun">],</span><span class="pln">inv</span><span class="pun">[</span><span class="lit">2000005</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> init</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">){</span><span class="pln">
	fac</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]=</span><span class="pln">inv</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	REP</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="lit">1</span><span class="pun">,</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)</span><span class="pln">fac</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">fac</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]*</span><span class="pln">i</span><span class="pun">%</span><span class="pln">MOD</span><span class="pun">;</span><span class="pln">
	inv</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]=</span><span class="pln">qpow</span><span class="pun">(</span><span class="pln">fac</span><span class="pun">[</span><span class="pln">n</span><span class="pun">],</span><span class="pln">MOD</span><span class="pun">-</span><span class="lit">2</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&gt;=</span><span class="lit">1</span><span class="pun">;--</span><span class="pln">i</span><span class="pun">)</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]*(</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)%</span><span class="pln">MOD</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> binom</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> x</span><span class="pun">&lt;</span><span class="pln">y</span><span class="pun">||</span><span class="pln">y</span><span class="pun">&lt;</span><span class="lit">0</span><span class="pun">?</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">fac</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]*</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">y</span><span class="pun">]%</span><span class="pln">MOD</span><span class="pun">*</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">x</span><span class="pun">-</span><span class="pln">y</span><span class="pun">]%</span><span class="pln">MOD</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">struct</span><span class="pln"> restr</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln">r</span><span class="pun">,</span><span class="pln">k</span><span class="pun">;</span><span class="pln">
</span><span class="pun">};</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln">m</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> r1</span><span class="pun">[</span><span class="lit">1000005</span><span class="pun">],</span><span class="pln">r2</span><span class="pun">[</span><span class="lit">1000005</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> dp</span><span class="pun">[</span><span class="lit">10005</span><span class="pun">],</span><span class="pln">sum</span><span class="pun">[</span><span class="lit">10005</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> qry1</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">k</span><span class="pun">&lt;</span><span class="pln">l</span><span class="pun">)</span><span class="kwd">return</span><span class="pln"> qpow</span><span class="pun">(</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">r</span><span class="pun">-</span><span class="pln">l</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">k</span><span class="pun">&gt;</span><span class="pln">r</span><span class="pun">)</span><span class="kwd">return</span><span class="pln"> fac</span><span class="pun">[</span><span class="pln">r</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]*</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">l</span><span class="pun">]%</span><span class="pln">MOD</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> fac</span><span class="pun">[</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]*</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">l</span><span class="pun">]%</span><span class="pln">MOD</span><span class="pun">*</span><span class="pln">qpow</span><span class="pun">(</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">r</span><span class="pun">-</span><span class="pln">k</span><span class="pun">)%</span><span class="pln">MOD</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> qry2</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="pln">qry1</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln">r</span><span class="pun">,</span><span class="pln">k</span><span class="pun">)+</span><span class="pln">MOD</span><span class="pun">-</span><span class="pln">qry1</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln">r</span><span class="pun">,</span><span class="pln">x</span><span class="pun">))%</span><span class="pln">MOD</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	cin</span><span class="pun">&gt;&gt;</span><span class="pln">n</span><span class="pun">&gt;&gt;</span><span class="pln">m</span><span class="pun">;</span><span class="pln">
	vector</span><span class="str">&lt;int&gt;</span><span class="pln">v</span><span class="pun">;</span><span class="pln">vector</span><span class="str">&lt;restr&gt;</span><span class="pln">a</span><span class="pun">;</span><span class="pln">
	vector</span><span class="str">&lt;int&gt;</span><span class="pln">t</span><span class="pun">;</span><span class="pln">
	REP</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="pln">m</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">,</span><span class="pln">l</span><span class="pun">,</span><span class="pln">r</span><span class="pun">;</span><span class="pln">
		cin</span><span class="pun">&gt;&gt;</span><span class="pln">k</span><span class="pun">&gt;&gt;</span><span class="pln">l</span><span class="pun">&gt;&gt;</span><span class="pln">r</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">--</span><span class="pln">l</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">l</span><span class="pun">&gt;=</span><span class="lit">0</span><span class="pun">)</span><span class="pln">v</span><span class="pun">.</span><span class="pln">pb</span><span class="pun">(</span><span class="pln">l</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">r</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">)</span><span class="pln">v</span><span class="pun">.</span><span class="pln">pb</span><span class="pun">(</span><span class="pln">r</span><span class="pun">);</span><span class="pln">
		t</span><span class="pun">.</span><span class="pln">pb</span><span class="pun">(</span><span class="pln">k</span><span class="pun">);</span><span class="pln">
		a</span><span class="pun">.</span><span class="pln">pb</span><span class="pun">({</span><span class="pln">l</span><span class="pun">,</span><span class="pln">r</span><span class="pun">,</span><span class="pln">k</span><span class="pun">});</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	v</span><span class="pun">.</span><span class="pln">pb</span><span class="pun">(</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">t</span><span class="pun">.</span><span class="pln">pb</span><span class="pun">(-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">t</span><span class="pun">.</span><span class="pln">pb</span><span class="pun">(</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
	deal</span><span class="pun">(</span><span class="pln">v</span><span class="pun">);</span><span class="pln">deal</span><span class="pun">(</span><span class="pln">t</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> i</span><span class="pun">:</span><span class="pln">v</span><span class="pun">)</span><span class="pln">r1</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">t</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()-</span><span class="lit">1</span><span class="pun">,</span><span class="pln">r2</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> i</span><span class="pun">:</span><span class="pln">a</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">i</span><span class="pun">.</span><span class="pln">k</span><span class="pun">==</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">&amp;&amp;</span><span class="pln">i</span><span class="pun">.</span><span class="pln">r</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">over</span><span class="pun">(</span><span class="lit">0</span><span class="pun">)</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">i</span><span class="pun">.</span><span class="pln">l</span><span class="pun">&gt;=</span><span class="lit">0</span><span class="pun">)</span><span class="pln">r1</span><span class="pun">[</span><span class="pln">i</span><span class="pun">.</span><span class="pln">l</span><span class="pun">]=</span><span class="pln">min</span><span class="pun">(</span><span class="pln">r1</span><span class="pun">[</span><span class="pln">i</span><span class="pun">.</span><span class="pln">l</span><span class="pun">],</span><span class="pln">lbound</span><span class="pun">(</span><span class="pln">t</span><span class="pun">,</span><span class="pln">i</span><span class="pun">.</span><span class="pln">k</span><span class="pun">));</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">i</span><span class="pun">.</span><span class="pln">r</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">)</span><span class="pln">r2</span><span class="pun">[</span><span class="pln">i</span><span class="pun">.</span><span class="pln">r</span><span class="pun">]=</span><span class="pln">max</span><span class="pun">(</span><span class="pln">r2</span><span class="pun">[</span><span class="pln">i</span><span class="pun">.</span><span class="pln">r</span><span class="pun">],</span><span class="pln">lbound</span><span class="pun">(</span><span class="pln">t</span><span class="pun">,</span><span class="pln">i</span><span class="pun">.</span><span class="pln">k</span><span class="pun">));</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> lst</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">m</span><span class="pun">=</span><span class="pln">t</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln">dp</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">REP</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="lit">2</span><span class="pun">,</span><span class="pln">m</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> i</span><span class="pun">:</span><span class="pln">v</span><span class="pun">){</span><span class="pln">
		REP</span><span class="pun">(</span><span class="pln">j</span><span class="pun">,</span><span class="lit">1</span><span class="pun">,</span><span class="pln">m</span><span class="pun">)</span><span class="pln">sum</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]=</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">];</span><span class="pln">
		REP</span><span class="pun">(</span><span class="pln">j</span><span class="pun">,</span><span class="lit">2</span><span class="pun">,</span><span class="pln">m</span><span class="pun">)(</span><span class="pln">sum</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]+=</span><span class="pln">sum</span><span class="pun">[</span><span class="pln">j</span><span class="pun">-</span><span class="lit">1</span><span class="pun">])%=</span><span class="pln">MOD</span><span class="pun">;</span><span class="pln">
		REP</span><span class="pun">(</span><span class="pln">j</span><span class="pun">,</span><span class="lit">1</span><span class="pun">,</span><span class="pln">m</span><span class="pun">)</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">j</span><span class="pun">&gt;</span><span class="pln">r2</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]&amp;&amp;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">r1</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]){</span><span class="pln">
			dp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]=(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]*</span><span class="pln">qry1</span><span class="pun">(</span><span class="pln">lst</span><span class="pun">,</span><span class="pln">i</span><span class="pun">,</span><span class="pln">t</span><span class="pun">[</span><span class="pln">j</span><span class="pun">])+</span><span class="pln">sum</span><span class="pun">[</span><span class="pln">j</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]*</span><span class="pln">qry2</span><span class="pun">(</span><span class="pln">lst</span><span class="pun">,</span><span class="pln">i</span><span class="pun">,</span><span class="pln">t</span><span class="pun">[</span><span class="pln">j</span><span class="pun">],</span><span class="pln">t</span><span class="pun">[</span><span class="pln">j</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]))%</span><span class="pln">MOD</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="kwd">else</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		lst</span><span class="pun">=</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> res</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	REP</span><span class="pun">(</span><span class="pln">j</span><span class="pun">,</span><span class="lit">1</span><span class="pun">,</span><span class="pln">m</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)(</span><span class="pln">res</span><span class="pun">+=</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">])%=</span><span class="pln">MOD</span><span class="pun">;</span><span class="pln">
	cout</span><span class="pun">&lt;&lt;</span><span class="pln">res</span><span class="pun">&lt;&lt;</span><span class="pln">endl</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> TC</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	init</span><span class="pun">(</span><span class="lit">1000000</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> tc</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    cin</span><span class="pun">&gt;&gt;</span><span class="pln">tc</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">tc</span><span class="pun">--){</span><span class="pln">
		</span><span class="typ">Main</span><span class="pun">();</span><span class="pln">
		cout</span><span class="pun">.</span><span class="pln">flush</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">),</span><span class="pln">cout</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">),</span><span class="pln">ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="lit">0</span><span class="pun">),</span><span class="pln">TC</span><span class="pun">(),</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="com">/*
1. CLEAR the arrays (ESPECIALLY multitests)
2. DELETE useless output
 */</span><span class="pln">
</span></code></pre></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2146" class="notice" style="text-decoration: none;">Codeforces Round 1052 (Div. 2)</a> </span>
        </div>
        
            

  <script>
    // Make all spoilers toggleable
    document.querySelectorAll('.spoiler-title').forEach(title => {
      title.addEventListener('click', function() {
        const spoiler = this.closest('.spoiler');
        spoiler.classList.toggle('open');
      });
    });
    
    // Open all spoilers by default for easier reading
    document.querySelectorAll('.spoiler').forEach(spoiler => {
      spoiler.classList.add('open');
    });
  </script>
</body>
</html>