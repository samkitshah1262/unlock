{
  "contestId": 2146,
  "index": "F",
  "title": "Bubble Sort",
  "timeLimit": "2 seconds",
  "memoryLimit": "512 megabytes",
  "rating": 2900,
  "tags": [
    "brute force",
    "combinatorics",
    "dp"
  ],
  "statementHtml": "<p>  </p>\n<p>You have just learned the algorithm <span class=\"tex-font-style-it\">bubble sort</span>, which is able to sort an array in non-descending order. Let's define the function <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-1-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;sort&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1\" style=\"width: 3.953em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.979em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1002.87em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2\"><span class=\"mtext\" id=\"MathJax-Span-3\" style=\"font-family: MathJax_Main;\">sort</span><span class=\"mo\" id=\"MathJax-Span-4\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-5\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-6\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>sort</mtext><mo stretchy=\"false\">(</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-1\">\\text{sort}(a)</script> as in the following pseudocode:</p>\n<p>As it is shown, the return value of <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-2-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;sort&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7\" style=\"width: 3.953em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.979em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1002.87em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-8\"><span class=\"mtext\" id=\"MathJax-Span-9\" style=\"font-family: MathJax_Main;\">sort</span><span class=\"mo\" id=\"MathJax-Span-10\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-11\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-12\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>sort</mtext><mo stretchy=\"false\">(</mo><mi>a</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-2\">\\text{sort}(a)</script> represents the number of rounds needed to make array <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-3-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-13\" style=\"width: 0.76em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-14\"><span class=\"mi\" id=\"MathJax-Span-15\" style=\"font-family: MathJax_Math-italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-3\">a</script> sorted in non-descending order by using <span class=\"tex-font-style-it\">bubble sort</span>.</p>\n<p>You are given an integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-4-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-16\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-17\"><span class=\"mi\" id=\"MathJax-Span-18\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-4\">n</script>, as well as <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-5-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-19\" style=\"width: 1.139em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.87em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-20\"><span class=\"mi\" id=\"MathJax-Span-21\" style=\"font-family: MathJax_Math-italic;\">m</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>m</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-5\">m</script> integer tuples <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-6-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-22\" style=\"width: 5.143em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.899em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1003.79em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-23\"><span class=\"mo\" id=\"MathJax-Span-24\" style=\"font-family: MathJax_Main;\">(</span><span class=\"msubsup\" id=\"MathJax-Span-25\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-26\" style=\"font-family: MathJax_Math-italic;\">k</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-27\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-28\" style=\"font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-29\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-30\" style=\"font-family: MathJax_Math-italic;\">l</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.327em;\"><span class=\"mi\" id=\"MathJax-Span-31\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-32\" style=\"font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-33\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-34\" style=\"font-family: MathJax_Math-italic;\">r</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mi\" id=\"MathJax-Span-35\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-36\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><msub><mi>k</mi><mi>i</mi></msub><mo>,</mo><msub><mi>l</mi><mi>i</mi></msub><mo>,</mo><msub><mi>r</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-6\">(k_i,l_i,r_i)</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-7-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-37\" style=\"width: 5.793em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.386em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1004.39em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-38\"><span class=\"mn\" id=\"MathJax-Span-39\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-40\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-41\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">i</span><span class=\"mo\" id=\"MathJax-Span-42\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-43\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">m</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>m</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-7\">1\\le i\\le m</script>). Count the number of permutations<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-8-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;&amp;#x2217;&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-44\" style=\"width: 0.598em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-45\"><span class=\"msubsup\" id=\"MathJax-Span-46\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.845em, 1000em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-47\"></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-48\"><span class=\"mrow\" id=\"MathJax-Span-49\"><span class=\"mtext\" id=\"MathJax-Span-50\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">∗</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi></mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>∗</mtext></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-8\">^{\\text{∗}}</script> <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-51\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.49em, 2.492em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-52\"><span class=\"mi\" id=\"MathJax-Span-53\" style=\"font-family: MathJax_Math-italic;\">p</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>p</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-9\">p</script> of length <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-10-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-54\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-55\"><span class=\"mi\" id=\"MathJax-Span-56\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-10\">n</script>, modulo <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-11-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;998&lt;/mn&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mn&gt;244&lt;/mn&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mn&gt;353&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-57\" style=\"width: 6.388em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.819em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1004.76em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-58\"><span class=\"mn\" id=\"MathJax-Span-59\" style=\"font-family: MathJax_Main;\">998</span><span class=\"mspace\" id=\"MathJax-Span-60\" style=\"height: 0em; vertical-align: 0em; width: 0.165em; display: inline-block; overflow: hidden;\"></span><span class=\"mn\" id=\"MathJax-Span-61\" style=\"font-family: MathJax_Main;\">244</span><span class=\"mspace\" id=\"MathJax-Span-62\" style=\"height: 0em; vertical-align: 0em; width: 0.165em; display: inline-block; overflow: hidden;\"></span><span class=\"mn\" id=\"MathJax-Span-63\" style=\"font-family: MathJax_Main;\">353</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>998</mn><mspace width=\"thinmathspace\"></mspace><mn>244</mn><mspace width=\"thinmathspace\"></mspace><mn>353</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-11\">998\\,244\\,353</script>, so that the following restrictions are satisfied:</p>\n<p><span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;&amp;#x2217;&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-137\" style=\"width: 0.621em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 136%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.44em, 2.351em, -999.997em); top: -2.16em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-138\"><span class=\"msubsup\" id=\"MathJax-Span-139\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.834em, 1000em, 4.205em, -999.997em); top: -4.013em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-140\"></span><span style=\"display: inline-block; width: 0px; height: 4.019em;\"></span></span><span style=\"position: absolute; top: -4.384em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-141\"><span class=\"mrow\" id=\"MathJax-Span-142\"><span class=\"mtext\" id=\"MathJax-Span-143\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">∗</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.019em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.166em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1.097em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi></mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>∗</mtext></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-20\">^{\\text{∗}}</script>A permutation of length <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-144\" style=\"width: 0.868em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.621em; height: 0px; font-size: 136%;\"><span style=\"position: absolute; clip: rect(1.548em, 1000.62em, 2.351em, -999.997em); top: -2.16em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-145\"><span class=\"mi\" id=\"MathJax-Span-146\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.166em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 0.761em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-21\">n</script> is an array consisting of <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-147\" style=\"width: 0.868em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.621em; height: 0px; font-size: 136%;\"><span style=\"position: absolute; clip: rect(1.548em, 1000.62em, 2.351em, -999.997em); top: -2.16em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-148\"><span class=\"mi\" id=\"MathJax-Span-149\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.166em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 0.761em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-22\">n</script> distinct integers from <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-23-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-150\" style=\"width: 0.683em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.497em; height: 0px; font-size: 136%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.44em, 2.351em, -999.997em); top: -2.16em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-151\"><span class=\"mn\" id=\"MathJax-Span-152\" style=\"font-family: MathJax_Main;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.166em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1.097em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-23\">1</script> to <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-24-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-153\" style=\"width: 0.868em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.621em; height: 0px; font-size: 136%;\"><span style=\"position: absolute; clip: rect(1.548em, 1000.62em, 2.351em, -999.997em); top: -2.16em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-154\"><span class=\"mi\" id=\"MathJax-Span-155\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.166em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 0.761em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-24\">n</script> in arbitrary order. For example, <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-25-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-156\" style=\"width: 6.738em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.946em; height: 0px; font-size: 136%;\"><span style=\"position: absolute; clip: rect(1.239em, 1004.82em, 2.598em, -999.997em); top: -2.16em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-157\"><span class=\"mo\" id=\"MathJax-Span-158\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-159\" style=\"font-family: MathJax_Main;\">2</span><span class=\"mo\" id=\"MathJax-Span-160\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-161\" style=\"font-family: MathJax_Main; padding-left: 0.188em;\">3</span><span class=\"mo\" id=\"MathJax-Span-162\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-163\" style=\"font-family: MathJax_Main; padding-left: 0.188em;\">1</span><span class=\"mo\" id=\"MathJax-Span-164\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-165\" style=\"font-family: MathJax_Main; padding-left: 0.188em;\">5</span><span class=\"mo\" id=\"MathJax-Span-166\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-167\" style=\"font-family: MathJax_Main; padding-left: 0.188em;\">4</span><span class=\"mo\" id=\"MathJax-Span-168\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.166em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.517em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>4</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-25\">[2,3,1,5,4]</script> is a permutation, but <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-26-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-169\" style=\"width: 4.081em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.969em; height: 0px; font-size: 136%;\"><span style=\"position: absolute; clip: rect(1.239em, 1002.85em, 2.598em, -999.997em); top: -2.16em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-170\"><span class=\"mo\" id=\"MathJax-Span-171\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-172\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-173\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-174\" style=\"font-family: MathJax_Main; padding-left: 0.188em;\">2</span><span class=\"mo\" id=\"MathJax-Span-175\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-176\" style=\"font-family: MathJax_Main; padding-left: 0.188em;\">2</span><span class=\"mo\" id=\"MathJax-Span-177\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.166em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.517em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>2</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-26\">[1,2,2]</script> is not a permutation (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-27-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-178\" style=\"width: 0.683em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.497em; height: 0px; font-size: 136%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.44em, 2.351em, -999.997em); top: -2.16em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-179\"><span class=\"mn\" id=\"MathJax-Span-180\" style=\"font-family: MathJax_Main;\">2</span></span><span style=\"display: inline-block; width: 0px; height: 2.166em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1.097em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>2</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-27\">2</script> appears twice in the array), and <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-181\" style=\"width: 4.081em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.969em; height: 0px; font-size: 136%;\"><span style=\"position: absolute; clip: rect(1.239em, 1002.85em, 2.598em, -999.997em); top: -2.16em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-182\"><span class=\"mo\" id=\"MathJax-Span-183\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-184\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-185\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-186\" style=\"font-family: MathJax_Main; padding-left: 0.188em;\">3</span><span class=\"mo\" id=\"MathJax-Span-187\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-188\" style=\"font-family: MathJax_Main; padding-left: 0.188em;\">4</span><span class=\"mo\" id=\"MathJax-Span-189\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.166em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.416em; border-left: 0px solid; width: 0px; height: 1.517em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>1</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-28\">[1,3,4]</script> is also not a permutation (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-29-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-190\" style=\"width: 3.216em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.351em; height: 0px; font-size: 136%;\"><span style=\"position: absolute; clip: rect(1.301em, 1002.29em, 2.351em, -999.997em); top: -2.16em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-191\"><span class=\"mi\" id=\"MathJax-Span-192\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-193\" style=\"font-family: MathJax_Main; padding-left: 0.25em;\">=</span><span class=\"mn\" id=\"MathJax-Span-194\" style=\"font-family: MathJax_Main; padding-left: 0.25em;\">3</span></span><span style=\"display: inline-block; width: 0px; height: 2.166em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1.097em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi><mo>=</mo><mn>3</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-29\">n=3</script> but there is <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-30-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-195\" style=\"width: 0.683em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.497em; height: 0px; font-size: 136%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.5em, 2.351em, -999.997em); top: -2.16em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-196\"><span class=\"mn\" id=\"MathJax-Span-197\" style=\"font-family: MathJax_Main;\">4</span></span><span style=\"display: inline-block; width: 0px; height: 2.166em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1.097em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>4</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-30\">4</script> in the array). </p>",
  "inputSpecHtml": "<p>Each test contains multiple test cases. The first line contains the number of test cases <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-31-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-198\" style=\"width: 0.544em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.381em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.33em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-199\"><span class=\"mi\" id=\"MathJax-Span-200\" style=\"font-family: MathJax_Math-italic;\">t</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-31\">t</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-32-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-201\" style=\"width: 6.496em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.927em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1004.93em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-202\"><span class=\"mn\" id=\"MathJax-Span-203\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-204\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-205\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">t</span><span class=\"mo\" id=\"MathJax-Span-206\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-207\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-208\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"mn\" id=\"MathJax-Span-209\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">4</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><msup><mn>10</mn><mn>4</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-32\">1 \\le t \\le 10^4</script>). The description of the test cases follows. </p><p>The first line of each test case contains two integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-33-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-210\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-211\"><span class=\"mi\" id=\"MathJax-Span-212\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-33\">n</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-34-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-213\" style=\"width: 1.139em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.87em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-214\"><span class=\"mi\" id=\"MathJax-Span-215\" style=\"font-family: MathJax_Math-italic;\">m</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>m</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-34\">m</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-35-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-216\" style=\"width: 6.821em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.143em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1005.14em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-217\"><span class=\"mn\" id=\"MathJax-Span-218\" style=\"font-family: MathJax_Main;\">2</span><span class=\"mo\" id=\"MathJax-Span-219\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-220\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span><span class=\"mo\" id=\"MathJax-Span-221\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-222\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-223\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"mn\" id=\"MathJax-Span-224\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">6</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>2</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><msup><mn>10</mn><mn>6</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-35\">2\\leq n\\leq 10^6</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-36-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;1000&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-225\" style=\"width: 7.957em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.009em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1005.96em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-226\"><span class=\"mn\" id=\"MathJax-Span-227\" style=\"font-family: MathJax_Main;\">0</span><span class=\"mo\" id=\"MathJax-Span-228\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-229\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">m</span><span class=\"mo\" id=\"MathJax-Span-230\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mn\" id=\"MathJax-Span-231\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">1000</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>0</mn><mo>≤</mo><mi>m</mi><mo>≤</mo><mn>1000</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-36\">0\\leq m\\leq 1000</script>).</p><p>Then <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-37-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-232\" style=\"width: 1.139em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.87em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-233\"><span class=\"mi\" id=\"MathJax-Span-234\" style=\"font-family: MathJax_Math-italic;\">m</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>m</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-37\">m</script> lines follow, the <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-38-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-235\" style=\"width: 0.436em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-236\"><span class=\"mi\" id=\"MathJax-Span-237\" style=\"font-family: MathJax_Math-italic;\">i</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>i</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-38\">i</script>-th line containing three integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-39-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-238\" style=\"width: 1.139em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.87em, 2.438em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-239\"><span class=\"msubsup\" id=\"MathJax-Span-240\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-241\" style=\"font-family: MathJax_Math-italic;\">k</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-242\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>k</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-39\">k_i</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-40-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-243\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.6em, 2.438em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-244\"><span class=\"msubsup\" id=\"MathJax-Span-245\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-246\" style=\"font-family: MathJax_Math-italic;\">l</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.327em;\"><span class=\"mi\" id=\"MathJax-Span-247\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>l</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-40\">l_i</script>, and <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-41-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-248\" style=\"width: 1.031em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.76em, 2.438em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-249\"><span class=\"msubsup\" id=\"MathJax-Span-250\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-251\" style=\"font-family: MathJax_Math-italic;\">r</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mi\" id=\"MathJax-Span-252\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-41\">r_i</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-42-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-253\" style=\"width: 8.39em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.334em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1006.28em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-254\"><span class=\"mn\" id=\"MathJax-Span-255\" style=\"font-family: MathJax_Main;\">0</span><span class=\"mo\" id=\"MathJax-Span-256\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-257\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-258\" style=\"font-family: MathJax_Math-italic;\">k</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-259\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-260\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-261\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span><span class=\"mo\" id=\"MathJax-Span-262\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mn\" id=\"MathJax-Span-263\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>0</mn><mo>≤</mo><msub><mi>k</mi><mi>i</mi></msub><mo>≤</mo><mi>n</mi><mo>−</mo><mn>1</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-42\">0\\le k_i\\le n - 1</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-43-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-264\" style=\"width: 8.498em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.442em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1006.44em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-265\"><span class=\"mn\" id=\"MathJax-Span-266\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-267\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-268\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-269\" style=\"font-family: MathJax_Math-italic;\">l</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.327em;\"><span class=\"mi\" id=\"MathJax-Span-270\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-271\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-272\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-273\" style=\"font-family: MathJax_Math-italic;\">r</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mi\" id=\"MathJax-Span-274\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-275\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-276\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn><mo>≤</mo><msub><mi>l</mi><mi>i</mi></msub><mo>≤</mo><msub><mi>r</mi><mi>i</mi></msub><mo>≤</mo><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-43\">1\\le l_i\\le r_i\\le n</script>) — the restrictions.</p><p>It is guaranteed that the sum of <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-44-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-277\" style=\"width: 1.734em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.301em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1001.3em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-278\"><span class=\"msubsup\" id=\"MathJax-Span-279\"><span style=\"display: inline-block; position: relative; width: 1.301em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.87em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-280\" style=\"font-family: MathJax_Math-italic;\">m</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.869em;\"><span class=\"mn\" id=\"MathJax-Span-281\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi>m</mi><mn>2</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-44\">m^2</script> over all test cases does not exceed <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-45-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-282\" style=\"width: 1.897em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.085em, 1001.41em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-283\"><span class=\"msubsup\" id=\"MathJax-Span-284\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-285\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"mn\" id=\"MathJax-Span-286\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">6</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mn>10</mn><mn>6</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-45\">10^6</script>. </p>",
  "outputSpecHtml": "<p>For each test case, output a single integer — the number of possible permutations, modulo <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-46-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;998&lt;/mn&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mn&gt;244&lt;/mn&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mn&gt;353&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-287\" style=\"width: 6.388em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.819em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1004.76em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-288\"><span class=\"mn\" id=\"MathJax-Span-289\" style=\"font-family: MathJax_Main;\">998</span><span class=\"mspace\" id=\"MathJax-Span-290\" style=\"height: 0em; vertical-align: 0em; width: 0.165em; display: inline-block; overflow: hidden;\"></span><span class=\"mn\" id=\"MathJax-Span-291\" style=\"font-family: MathJax_Main;\">244</span><span class=\"mspace\" id=\"MathJax-Span-292\" style=\"height: 0em; vertical-align: 0em; width: 0.165em; display: inline-block; overflow: hidden;\"></span><span class=\"mn\" id=\"MathJax-Span-293\" style=\"font-family: MathJax_Main;\">353</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>998</mn><mspace width=\"thinmathspace\"></mspace><mn>244</mn><mspace width=\"thinmathspace\"></mspace><mn>353</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-46\">998\\,244\\,353</script>.</p>",
  "noteHtml": "<p>In the first test case, only permutations <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-47-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-294\" style=\"width: 5.143em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.899em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1003.79em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-295\"><span class=\"mo\" id=\"MathJax-Span-296\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-297\" style=\"font-family: MathJax_Main;\">3</span><span class=\"mo\" id=\"MathJax-Span-298\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-299\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-300\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-301\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">4</span><span class=\"mo\" id=\"MathJax-Span-302\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-303\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">2</span><span class=\"mo\" id=\"MathJax-Span-304\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>3</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>2</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-47\">[3,1,4,2]</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-48-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-305\" style=\"width: 5.143em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.899em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1003.79em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-306\"><span class=\"mo\" id=\"MathJax-Span-307\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-308\" style=\"font-family: MathJax_Main;\">4</span><span class=\"mo\" id=\"MathJax-Span-309\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-310\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-311\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-312\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">3</span><span class=\"mo\" id=\"MathJax-Span-313\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-314\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">2</span><span class=\"mo\" id=\"MathJax-Span-315\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>4</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>2</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-48\">[4,1,3,2]</script> satisfy the restrictions. Take <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-49-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-316\" style=\"width: 5.143em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.899em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1003.79em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-317\"><span class=\"mo\" id=\"MathJax-Span-318\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-319\" style=\"font-family: MathJax_Main;\">3</span><span class=\"mo\" id=\"MathJax-Span-320\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-321\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-322\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-323\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">4</span><span class=\"mo\" id=\"MathJax-Span-324\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-325\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">2</span><span class=\"mo\" id=\"MathJax-Span-326\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>3</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>2</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-49\">[3,1,4,2]</script> as an example. Let's calculate the array <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-50-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-327\" style=\"width: 0.598em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-328\"><span class=\"mi\" id=\"MathJax-Span-329\" style=\"font-family: MathJax_Math-italic;\">b</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>b</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-50\">b</script>:</p><ul> <li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-51-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;sort&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-330\" style=\"width: 7.091em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.36em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1005.31em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-331\"><span class=\"mtext\" id=\"MathJax-Span-332\" style=\"font-family: MathJax_Main;\">sort</span><span class=\"mo\" id=\"MathJax-Span-333\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mo\" id=\"MathJax-Span-334\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-335\" style=\"font-family: MathJax_Main;\">3</span><span class=\"mo\" id=\"MathJax-Span-336\" style=\"font-family: MathJax_Main;\">]</span><span class=\"mo\" id=\"MathJax-Span-337\" style=\"font-family: MathJax_Main;\">)</span><span class=\"mo\" id=\"MathJax-Span-338\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-339\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">0</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>sort</mtext><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">[</mo><mn>3</mn><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo><mo>=</mo><mn>0</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-51\">\\text{sort}([3])=0</script>; </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-52-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;sort&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-340\" style=\"width: 8.282em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.28em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1006.23em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-341\"><span class=\"mtext\" id=\"MathJax-Span-342\" style=\"font-family: MathJax_Main;\">sort</span><span class=\"mo\" id=\"MathJax-Span-343\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mo\" id=\"MathJax-Span-344\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-345\" style=\"font-family: MathJax_Main;\">3</span><span class=\"mo\" id=\"MathJax-Span-346\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-347\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-348\" style=\"font-family: MathJax_Main;\">]</span><span class=\"mo\" id=\"MathJax-Span-349\" style=\"font-family: MathJax_Main;\">)</span><span class=\"mo\" id=\"MathJax-Span-350\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-351\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>sort</mtext><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">[</mo><mn>3</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-52\">\\text{sort}([3,1])=1</script>; </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-53-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;sort&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-352\" style=\"width: 9.527em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.2em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1007.15em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-353\"><span class=\"mtext\" id=\"MathJax-Span-354\" style=\"font-family: MathJax_Main;\">sort</span><span class=\"mo\" id=\"MathJax-Span-355\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mo\" id=\"MathJax-Span-356\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-357\" style=\"font-family: MathJax_Main;\">3</span><span class=\"mo\" id=\"MathJax-Span-358\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-359\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-360\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-361\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">4</span><span class=\"mo\" id=\"MathJax-Span-362\" style=\"font-family: MathJax_Main;\">]</span><span class=\"mo\" id=\"MathJax-Span-363\" style=\"font-family: MathJax_Main;\">)</span><span class=\"mo\" id=\"MathJax-Span-364\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-365\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>sort</mtext><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">[</mo><mn>3</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>4</mn><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-53\">\\text{sort}([3,1,4])=1</script>; </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-54-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;sort&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-366\" style=\"width: 10.825em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 8.174em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1008.12em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-367\"><span class=\"mtext\" id=\"MathJax-Span-368\" style=\"font-family: MathJax_Main;\">sort</span><span class=\"mo\" id=\"MathJax-Span-369\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mo\" id=\"MathJax-Span-370\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-371\" style=\"font-family: MathJax_Main;\">3</span><span class=\"mo\" id=\"MathJax-Span-372\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-373\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-374\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-375\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">4</span><span class=\"mo\" id=\"MathJax-Span-376\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-377\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">2</span><span class=\"mo\" id=\"MathJax-Span-378\" style=\"font-family: MathJax_Main;\">]</span><span class=\"mo\" id=\"MathJax-Span-379\" style=\"font-family: MathJax_Main;\">)</span><span class=\"mo\" id=\"MathJax-Span-380\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-381\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">2</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>sort</mtext><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">[</mo><mn>3</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>2</mn><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo><mo>=</mo><mn>2</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-54\">\\text{sort}([3,1,4,2])=2</script>. </li></ul><p>Thus, <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-55-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-382\" style=\"width: 7.47em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.63em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1005.52em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-383\"><span class=\"mi\" id=\"MathJax-Span-384\" style=\"font-family: MathJax_Math-italic;\">b</span><span class=\"mo\" id=\"MathJax-Span-385\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mo\" id=\"MathJax-Span-386\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">[</span><span class=\"mn\" id=\"MathJax-Span-387\" style=\"font-family: MathJax_Main;\">0</span><span class=\"mo\" id=\"MathJax-Span-388\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-389\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-390\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-391\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-392\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-393\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">2</span><span class=\"mo\" id=\"MathJax-Span-394\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>b</mi><mo>=</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-55\">b=[0,1,1,2]</script>. It is easy to show that it satisfies all the restrictions.</p><p>In the second test case, only permutation <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-56-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-395\" style=\"width: 3.899em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.925em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1002.82em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-396\"><span class=\"mo\" id=\"MathJax-Span-397\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-398\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-399\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-400\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">2</span><span class=\"mo\" id=\"MathJax-Span-401\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-402\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">3</span><span class=\"mo\" id=\"MathJax-Span-403\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-56\">[1,2,3]</script> satisfies the restrictions.</p><p>In the third test case, the following <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-57-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;8&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-404\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-405\"><span class=\"mn\" id=\"MathJax-Span-406\" style=\"font-family: MathJax_Main;\">8</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>8</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-57\">8</script> permutations satisfy the restrictions: </p><ul><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-58-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-407\" style=\"width: 5.143em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.899em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1003.79em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-408\"><span class=\"mo\" id=\"MathJax-Span-409\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-410\" style=\"font-family: MathJax_Main;\">2</span><span class=\"mo\" id=\"MathJax-Span-411\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-412\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">3</span><span class=\"mo\" id=\"MathJax-Span-413\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-414\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-415\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-416\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">4</span><span class=\"mo\" id=\"MathJax-Span-417\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>4</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-58\">[2,3,1,4]</script>; </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-59-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-418\" style=\"width: 5.143em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.899em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1003.79em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-419\"><span class=\"mo\" id=\"MathJax-Span-420\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-421\" style=\"font-family: MathJax_Main;\">2</span><span class=\"mo\" id=\"MathJax-Span-422\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-423\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">4</span><span class=\"mo\" id=\"MathJax-Span-424\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-425\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-426\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-427\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">3</span><span class=\"mo\" id=\"MathJax-Span-428\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>2</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>3</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-59\">[2,4,1,3]</script>; </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-60-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-429\" style=\"width: 5.143em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.899em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1003.79em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-430\"><span class=\"mo\" id=\"MathJax-Span-431\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-432\" style=\"font-family: MathJax_Main;\">3</span><span class=\"mo\" id=\"MathJax-Span-433\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-434\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">2</span><span class=\"mo\" id=\"MathJax-Span-435\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-436\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-437\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-438\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">4</span><span class=\"mo\" id=\"MathJax-Span-439\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>3</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>4</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-60\">[3,2,1,4]</script>; </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-61-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-440\" style=\"width: 5.143em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.899em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1003.79em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-441\"><span class=\"mo\" id=\"MathJax-Span-442\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-443\" style=\"font-family: MathJax_Main;\">3</span><span class=\"mo\" id=\"MathJax-Span-444\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-445\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">4</span><span class=\"mo\" id=\"MathJax-Span-446\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-447\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-448\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-449\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">2</span><span class=\"mo\" id=\"MathJax-Span-450\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-61\">[3,4,1,2]</script>; </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-62-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-451\" style=\"width: 5.143em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.899em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1003.79em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-452\"><span class=\"mo\" id=\"MathJax-Span-453\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-454\" style=\"font-family: MathJax_Main;\">3</span><span class=\"mo\" id=\"MathJax-Span-455\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-456\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">4</span><span class=\"mo\" id=\"MathJax-Span-457\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-458\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">2</span><span class=\"mo\" id=\"MathJax-Span-459\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-460\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-461\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-62\">[3,4,2,1]</script>; </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-63-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-462\" style=\"width: 5.143em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.899em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1003.79em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-463\"><span class=\"mo\" id=\"MathJax-Span-464\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-465\" style=\"font-family: MathJax_Main;\">4</span><span class=\"mo\" id=\"MathJax-Span-466\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-467\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">2</span><span class=\"mo\" id=\"MathJax-Span-468\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-469\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-470\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-471\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">3</span><span class=\"mo\" id=\"MathJax-Span-472\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>4</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>3</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-63\">[4,2,1,3]</script>; </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-64-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-473\" style=\"width: 5.143em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.899em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1003.79em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-474\"><span class=\"mo\" id=\"MathJax-Span-475\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-476\" style=\"font-family: MathJax_Main;\">4</span><span class=\"mo\" id=\"MathJax-Span-477\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-478\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">3</span><span class=\"mo\" id=\"MathJax-Span-479\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-480\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-481\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-482\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">2</span><span class=\"mo\" id=\"MathJax-Span-483\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>4</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-64\">[4,3,1,2]</script>; </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-65-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-484\" style=\"width: 5.143em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.899em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1003.79em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-485\"><span class=\"mo\" id=\"MathJax-Span-486\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-487\" style=\"font-family: MathJax_Main;\">4</span><span class=\"mo\" id=\"MathJax-Span-488\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-489\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">3</span><span class=\"mo\" id=\"MathJax-Span-490\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-491\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">2</span><span class=\"mo\" id=\"MathJax-Span-492\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-493\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-494\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>4</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-65\">[4,3,2,1]</script>.</li></ul>",
  "samples": [
    {
      "input": "64 30 1 11 3 32 4 43 20 3 31 2 34 31 2 22 3 40 1 25 31 1 43 5 54 5 510 51 2 32 3 43 4 54 5 65 6 71000000 0",
      "output": "21880192600373341033"
    }
  ],
  "images": [],
  "url": "https://codeforces.com/contest/2146/problem/F",
  "tutorialHtml": "<div><div class=\"ttypography\"><div class=\"problem-statement\"><div><p>Let's simulate the process of bubble sort. For an element <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1921\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1922\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1923\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1924\" style=\"vertical-align: -0.4em;\">x</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-359\">a_x</script>, one necessary condition of the array being sorted is: for all <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1925\"><span class=\"MJXp-mn\" id=\"MJXp-Span-1926\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1927\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1928\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1929\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1930\">x</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-360\">1\\le i<x</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1931\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1932\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1933\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1934\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1935\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1936\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1937\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1938\" style=\"vertical-align: -0.4em;\">x</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-361\">a_i<a_x</script>. And if the condition is held for all <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1939\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1940\">x</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-362\">x</script>, the array will be sorted.</p><p>Let's consider the elements <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1941\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1942\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1943\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1944\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-363\">a_i</script> such that <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1945\"><span class=\"MJXp-mn\" id=\"MJXp-Span-1946\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1947\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1948\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1949\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1950\">x</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-364\">1\\le i<x</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1951\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1952\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1953\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1954\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1955\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&gt;</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1956\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1957\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1958\" style=\"vertical-align: -0.4em;\">x</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-365\">a_i>a_x</script>. In one round of bubble sort, the largest element before <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1959\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1960\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1961\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1962\" style=\"vertical-align: -0.4em;\">x</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-366\">a_x</script> will occur on the position <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1963\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1964\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1965\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1966\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1967\">x</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1968\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1969\">1</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-367\">a_{x-1}</script>, and then swapped with <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1970\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1971\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1972\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1973\" style=\"vertical-align: -0.4em;\">x</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-368\">a_x</script>. So the number of such elements <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1974\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1975\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1976\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1977\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-369\">a_i</script> (before and greater than <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1978\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1979\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1980\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1981\" style=\"vertical-align: -0.4em;\">x</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-370\">a_x</script>) will decrease by exactly one. Let <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1982\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1983\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1984\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1985\" style=\"vertical-align: -0.4em;\">x</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-371\">c_x</script> be the number of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1986\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1987\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-372\">i</script> such that <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1988\"><span class=\"MJXp-mn\" id=\"MJXp-Span-1989\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1990\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1991\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1992\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1993\">x</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-373\">1\\le i<x</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1994\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1995\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1996\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-1997\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1998\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&gt;</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1999\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2000\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2001\" style=\"vertical-align: -0.4em;\">x</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-374\">a_i>a_x</script> before the sorting, we can see that <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2002\"><span class=\"MJXp-mtext\" id=\"MJXp-Span-2003\">sort</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2004\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2005\">a</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2006\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2007\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2008\"><span class=\"MJXp-mo\" id=\"MJXp-Span-2009\" style=\"margin-left: 0.333em; margin-right: 0.05em;\">max</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-2010\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2011\">i</span></span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2012\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2013\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2014\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-375\">\\text{sort}(a)=\\max_{i}c_i</script>. Moreover, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2015\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2016\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2017\" style=\"margin-right: 0.05em;\">b</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2018\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-376\">b_i</script> in the statement equals <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2019\"><span class=\"MJXp-mtext\" id=\"MJXp-Span-2020\">sort</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2021\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2022\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2023\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2024\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-2025\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2026\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2027\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2028\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-2029\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2030\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2031\" style=\"margin-left: 0em; margin-right: 0em;\">…</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2032\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2033\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2034\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2035\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2036\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2037\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2038\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2039\"><span class=\"MJXp-mo\" id=\"MJXp-Span-2040\" style=\"margin-left: 0.333em; margin-right: 0.05em;\">max</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-2041\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-2042\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2043\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2044\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2045\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2046\">i</span></span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2047\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2048\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2049\" style=\"vertical-align: -0.4em;\">j</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-377\">\\text{sort}([a_1,a_2,\\dots,a_i])=\\max_{1\\le j\\le i} c_j</script>, which is the prefix maximum of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2050\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2051\">c</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-378\">c</script>.</p><p>Let <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2052\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2053\">a</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-379\">a</script> be a permutation. From the definition of array <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2054\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2055\">c</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-380\">c</script>, we can see that <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2056\"><span class=\"MJXp-mn\" id=\"MJXp-Span-2057\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2058\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2059\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2060\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2061\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2062\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2063\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2064\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2065\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-381\">0\\le c_i\\le i-1</script>, and the number of possible array <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2066\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2067\">c</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-382\">c</script> is exactly <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2068\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2069\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2070\" style=\"margin-left: 0.111em; margin-right: 0em;\">!</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-383\">n!</script>. We can prove by construction that array <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2071\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2072\">c</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-384\">c</script> and permutation <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2073\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2074\">a</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-385\">a</script> form a bijection. Let's just count the number of arrays <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2075\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2076\">c</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-386\">c</script> such that: <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2077\"><span class=\"MJXp-mn\" id=\"MJXp-Span-2078\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2079\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2080\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2081\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2082\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2083\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2084\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-387\">0\\le c_i<i</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2085\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2086\"><span class=\"MJXp-mo\" id=\"MJXp-Span-2087\" style=\"margin-left: 0.333em; margin-right: 0.05em;\">max</span><span class=\"MJXp-script-box\" style=\"height: 1.86em; vertical-align: -0.64em;\"><span class=\" MJXp-script\"><span><span style=\"margin-bottom: -0.25em;\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-2092\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2093\">l</span></span></span></span></span><span class=\" MJXp-script\"><span><span style=\"margin-top: -0.85em;\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-2088\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2089\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2090\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2091\">1</span></span></span></span></span></span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2094\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2095\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2096\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2097\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2098\">k</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-388\">\\max_{i=1}^{l}c_i\\le k</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2099\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2100\"><span class=\"MJXp-mo\" id=\"MJXp-Span-2101\" style=\"margin-left: 0.333em; margin-right: 0.05em;\">max</span><span class=\"MJXp-script-box\" style=\"height: 1.86em; vertical-align: -0.64em;\"><span class=\" MJXp-script\"><span><span style=\"margin-bottom: -0.25em;\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-2106\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2107\">r</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2108\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2109\">1</span></span></span></span></span><span class=\" MJXp-script\"><span><span style=\"margin-top: -0.85em;\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-2102\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2103\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2104\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2105\">1</span></span></span></span></span></span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2110\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2111\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2112\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2113\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&gt;</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2114\">k</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-389\">\\max_{i=1}^{r+1}c_i\\gt k</script>.</p><p>Here is an <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2115\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2116\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2117\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2118\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2119\" style=\"margin-right: 0.05em;\">n</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-2120\" style=\"vertical-align: 0.5em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2121\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-390\">O(n^2)</script> dynamic programming method: Let <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2122\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2123\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2124\" style=\"margin-right: 0.05em;\">f</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-2125\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2126\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2127\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2128\">j</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-391\">f_{i,j}</script> be the number of ways to fill the first <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2129\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2130\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-392\">i</script> elements of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2131\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2132\">c</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-393\">c</script>, and the current maximum is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2133\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2134\">j</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-394\">j</script>. We can use prefix sum to optimize it to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2135\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2136\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2137\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2138\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2139\" style=\"margin-right: 0.05em;\">n</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-2140\" style=\"vertical-align: 0.5em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2141\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-395\">O(n^2)</script>.</p><p>We need to notice that the number of restrictions is small (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2142\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2143\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2144\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2145\">1000</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-396\">m\\le 1000</script>). There're only <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2146\"><span class=\"MJXp-mn\" id=\"MJXp-Span-2147\">2</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2148\">m</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-397\">2m</script> points that have restrictions. Let the <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2149\"><span class=\"MJXp-mn\" id=\"MJXp-Span-2150\">2</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2151\">m</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-398\">2m</script> points split the array of length <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2152\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2153\">n</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-399\">n</script> into <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2154\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2155\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2156\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2157\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2158\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-400\">O(m)</script> intervals, and we can each time fill a whole interval. Similarly, the range of values can be split into <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2159\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2160\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2161\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2162\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2163\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-401\">O(m)</script> intervals. Let <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2164\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2165\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2166\" style=\"margin-right: 0.05em;\">g</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-2167\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2168\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2169\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2170\">j</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-402\">g_{i,j}</script> be the number of ways to fill the first <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2171\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2172\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-403\">i</script> intervals and the current maximum is in the <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2173\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2174\">j</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-404\">j</script>-th interval. </p><p>There are two types of transitions: </p><ul><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2175\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2176\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2177\" style=\"margin-right: 0.05em;\">g</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-2178\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2179\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2180\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2181\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2182\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2183\">j</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2184\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">×</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2185\">c</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2186\">o</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2187\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">→</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2188\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2189\" style=\"margin-right: 0.05em;\">g</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-2190\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2191\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2192\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2193\">j</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-405\">g_{i-1,j}\\times co\\rightarrow g_{i,j}</script>. The coefficient here refers to: for the numbers in the <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2194\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2195\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-406\">i</script>-th interval, the maximum does not exceed the upper bound of the <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2196\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2197\">j</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-407\">j</script>-th value interval. Let's call the coefficient <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2198\"><span class=\"MJXp-mtext\" id=\"MJXp-Span-2199\">calc</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2200\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2201\">l</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2202\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2203\">r</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2204\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2205\">t</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2206\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-408\">\\text{calc}(l,r,t)</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2207\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2208\">l</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2209\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2210\">r</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-409\">l,r</script> represents the index interval and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2211\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2212\">t</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-410\">t</script> represents the upper bound of the value.</li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2213\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2214\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2215\" style=\"margin-right: 0.05em;\">g</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-2216\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2217\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2218\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2219\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2220\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2221\">j</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2222\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">×</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2223\">c</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2224\">o</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2225\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">→</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2226\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2227\" style=\"margin-right: 0.05em;\">g</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-2228\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2229\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2230\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2231\">k</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-411\">g_{i-1,j}\\times co\\rightarrow g_{i,k}</script>. Here, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2232\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2233\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2234\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2235\">k</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-412\">j<k</script>. Here, for the numbers in the <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2236\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2237\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-413\">i</script>-th interval, the maximum is exactly in the <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2238\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2239\">j</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-414\">j</script>-th value interval (call it <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2240\"><span class=\"MJXp-mo\" id=\"MJXp-Span-2241\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2242\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2243\" style=\"margin-right: 0.05em;\">v</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2244\" style=\"vertical-align: -0.4em;\">l</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2245\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2246\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2247\" style=\"margin-right: 0.05em;\">v</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2248\" style=\"vertical-align: -0.4em;\">r</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2249\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-415\">[v_l,v_r]</script>). The coefficient is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2250\"><span class=\"MJXp-mtext\" id=\"MJXp-Span-2251\">calc</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2252\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2253\">l</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2254\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2255\">r</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2256\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2257\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2258\" style=\"margin-right: 0.05em;\">v</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2259\" style=\"vertical-align: -0.4em;\">r</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2260\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2261\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mtext\" id=\"MJXp-Span-2262\">calc</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2263\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2264\">l</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2265\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2266\">r</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2267\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2268\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2269\" style=\"margin-right: 0.05em;\">v</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2270\" style=\"vertical-align: -0.4em;\">l</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2271\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2272\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2273\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-416\">\\text{calc}(l,r,v_r)-\\text{calc}(l,r,v_l-1)</script>.</li></ul><p>So we need to calculate <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2274\"><span class=\"MJXp-mtext\" id=\"MJXp-Span-2275\">calc</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2276\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2277\">l</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2278\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2279\">r</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2280\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2281\">t</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2282\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-417\">\\text{calc}(l,r,t)</script>: fill the <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2283\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2284\">l</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-418\">l</script>-th to the <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2285\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2286\">r</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-419\">r</script>-th element of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2287\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2288\">c</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-420\">c</script> such that <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2289\"><span class=\"MJXp-mn\" id=\"MJXp-Span-2290\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2291\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2292\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2293\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2294\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2295\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2296\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-421\">0\\le c_i<i</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2297\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2298\"><span class=\"MJXp-mo\" id=\"MJXp-Span-2299\" style=\"margin-left: 0.333em; margin-right: 0.05em;\">max</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-2300\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2301\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2302\">∈</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2303\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2304\">l</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2305\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2306\">r</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2307\">]</span></span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2308\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2309\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2310\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2311\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2312\">t</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-422\">\\max_{i\\in[l,r]}c_i\\le t</script>. Here <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2313\"><span class=\"MJXp-mn\" id=\"MJXp-Span-2314\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2315\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2316\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2317\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2318\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2319\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2320\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">min</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2321\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2322\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2323\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2324\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2325\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2326\">t</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2327\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-423\">0\\le c_i\\le \\min(i-1,t)</script>. There's a prefix that <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2328\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2329\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2330\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2331\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2332\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2333\">t</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-424\">i-1\\le t</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2334\"><span class=\"MJXp-mn\" id=\"MJXp-Span-2335\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2336\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2337\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2338\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2339\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2340\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2341\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2342\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2343\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-425\">0\\le c_i\\le i-1</script>, and the coefficient can be calculated using factorials and inverse of factorials. For the suffix part that <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2344\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2345\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2346\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2347\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2348\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&gt;</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2349\">t</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-426\">i-1>t</script>, then <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2350\"><span class=\"MJXp-mn\" id=\"MJXp-Span-2351\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2352\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2353\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2354\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2355\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2356\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2357\">t</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-427\">0\\le c_i\\le t</script>, and this can be calculated using quick pow. </p><p>The time complexity is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2358\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2359\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2360\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2361\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2362\" style=\"margin-right: 0.05em;\">m</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-2363\" style=\"vertical-align: 0.5em;\">2</span></span><span class=\"MJXp-mi\" id=\"MJXp-Span-2364\">log</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2365\" style=\"margin-left: 0em; margin-right: 0em;\"></span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2366\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2367\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-428\">O(m^2\\log n)</script>. The <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2368\"><span class=\"MJXp-mi\" id=\"MJXp-Span-2369\">log</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-429\">\\log</script> refers to quick pow.</p><p>Proof for permutation <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2370\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2371\">a</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-430\">a</script> and array <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2372\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2373\">c</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-431\">c</script> form a bijection:</p><ul><li> Given a permutation <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2374\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2375\">a</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-432\">a</script>, you can uniquely determine array <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2376\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2377\">c</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-433\">c</script>.</li><li> Given array <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2378\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2379\">c</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-434\">c</script>, let's recover the permutation <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2380\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2381\">a</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-435\">a</script> from back to front: There're <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2382\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2383\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2384\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2385\" style=\"vertical-align: -0.4em;\">n</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-436\">c_n</script> numbers in all that are greater than <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2386\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2387\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2388\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2389\" style=\"vertical-align: -0.4em;\">n</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-437\">a_n</script>, so <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2390\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2391\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2392\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2393\" style=\"vertical-align: -0.4em;\">n</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2394\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2395\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2396\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2397\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2398\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2399\" style=\"vertical-align: -0.4em;\">n</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-438\">a_n=n-c_n</script>, and then delete <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2400\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2401\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2402\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2403\" style=\"vertical-align: -0.4em;\">n</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-439\">a_n</script> from the possible values. Similarly, when you have determined a suffix, you should find the <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2404\"><span class=\"MJXp-mo\" id=\"MJXp-Span-2405\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2406\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2407\" style=\"margin-right: 0.05em;\">c</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2408\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2409\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2410\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2411\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-440\">(c_i+1)</script>-th greatest number in those you have not used.</li></ul><p>In all, you can uniquely determine another if you know one of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2412\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2413\">a</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-441\">a</script> or <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2414\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2415\">c</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-442\">c</script>. So this forms a bijection.</p></div></div></div></div>"
}