<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tutorial</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
      color: #333;
      background: #fafafa;
    }
    .ttypography {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    h3 {
      color: #1a1a1a;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }
    h3 a {
      color: #0066cc;
      text-decoration: none;
    }
    h3 a:hover {
      text-decoration: underline;
    }
    .spoiler {
      margin: 15px 0;
      border: 1px solid #ddd;
      border-radius: 6px;
      overflow: hidden;
    }
    .spoiler-title {
      display: block;
      padding: 12px 15px;
      background: #f0f0f0;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
      border-bottom: 1px solid #ddd;
    }
    .spoiler-title:hover {
      background: #e8e8e8;
    }
    .spoiler-title::before {
      content: '▶ ';
      font-size: 0.8em;
      transition: transform 0.2s;
      display: inline-block;
    }
    .spoiler.open .spoiler-title::before {
      content: '▼ ';
    }
    .spoiler-content {
      padding: 15px;
      background: #fff;
      display: none;
    }
    .spoiler.open .spoiler-content {
      display: block;
    }
    pre, code {
      background: #f5f5f5;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 0.85em;
    }
    pre {
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
    code {
      padding: 2px 5px;
      border-radius: 3px;
    }
    p {
      margin: 10px 0;
    }
    .MathJax {
      font-size: 1.1em;
    }
  </style>
</head>
<body>
  <h1>Editorial</h1>
  <p><a href="https://codeforces.com/blog/entry/145152" target="_blank">View on Codeforces →</a></p>
  
  <div class="ttypography"><p>Thank you for participation and we hope you enjoy this round :)</p> <div class="spoiler"><b class="spoiler-title">How did you find the contest?</b><div class="spoiler-content" style="display: block;"><ul>   <li>Great: 
<style data-nocturne="true" type="text/css">

</style>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11099">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="415">415</span>
            </i>
        </a>
    </span>

    <script>
        $(function() {
            const likeFormUtil = {};
            likeFormUtil.getCount = function ($count) {
                return Number($count.attr("data-value"));
            };
            likeFormUtil.setCount = function ($count, value) {
                $count.attr("data-value", value);
                $count.text(value);
            };
            likeFormUtil.like = function ($likeForm) {
                $likeForm.find(".likeState").addClass("liked");
                const $likeCount = $likeForm.find(".likeCount");
                likeFormUtil.setCount($likeCount, likeFormUtil.getCount($likeCount) + 1);
            };
            likeFormUtil.unLike = function ($likeForm) {
                if ($likeForm.find(".likeState").hasClass("liked")) {
                    $likeForm.find(".likeState").removeClass("liked");
                    const $likeCount = $likeForm.find(".likeCount");
                    likeFormUtil.setCount($likeCount, likeFormUtil.getCount($likeCount) - 1);
                }
            };
            likeFormUtil.dislike = function ($likeForm) {
                $likeForm.find(".dislikeState").addClass("disliked");
                const $dislikeCount = $likeForm.find(".dislikeCount");
                likeFormUtil.setCount($dislikeCount, likeFormUtil.getCount($dislikeCount) + 1);
            };
            likeFormUtil.unDislike = function ($likeForm) {
                if ($likeForm.find(".dislikeState").hasClass("disliked")) {
                    $likeForm.find(".dislikeState").removeClass("disliked");
                    const $dislikeCount = $likeForm.find(".dislikeCount");
                    likeFormUtil.setCount($dislikeCount, likeFormUtil.getCount($dislikeCount) - 1);
                }
            };
            likeFormUtil.disable = function ($likeForm) {
                $likeForm.find(".likeActionLink").off("click");
                $likeForm.find(".likeActionLink").on("click", function () {
                    return false;
                });
                $likeForm.find(".dislikeActionLink").off("click");
                $likeForm.find(".dislikeActionLink").on("click", function () {
                    return false;
                });
            };
            likeFormUtil.enable = function ($likeForm) {
                $likeForm.find(".likeActionLink").off("click");
                $likeForm.find(".likeActionLink").on("click", onLike);
                $likeForm.find(".dislikeActionLink").off("click");
                $likeForm.find(".dislikeActionLink").on("click", onDislike);
            };
            likeFormUtil.applyLikeableInformation = function(likeableInformation) {
                const id = likeableInformation.likeable.id;
                console.log(id);
                const $likeForm = $(".likeActionLink[data-likeableId='" + id + "']").closest(".likeForm");
                console.log($likeForm);
                likeFormUtil.setCount($likeForm.find(".likeCount"), likeableInformation.likeCount);
                likeFormUtil.setCount($likeForm.find(".dislikeCount"), likeableInformation.dislikeCount);
                if (likeableInformation.liked) {
                    $likeForm.find(".likeState").addClass("liked");
                } else {
                    $likeForm.find(".likeState").removeClass("liked");
                }
                if (likeableInformation.disliked) {
                    $likeForm.find(".likeState").addClass("disliked");
                } else {
                    $likeForm.find(".likeState").removeClass("disliked");
                }
            }
            likeFormUtil.applyLikeableInformations = function(likeableInformations) {
                likeableInformations.forEach((applyLikeableInformation) => {
                    likeFormUtil.applyLikeableInformation(applyLikeableInformation);
                });
            }

            function onLike() {
                const $likeActionLink = $(this);
                const likeableId = $likeActionLink.attr("data-likeableId");
                const $likeForm = $likeActionLink.parent();

                likeFormUtil.disable($likeForm);
                $.post("/data/like", {
                    action: "like",
                    likeableId: likeableId
                }, function (data) {
                    if (data["success"] === true) {
                        if (data["liked"]) {
                            Codeforces.showMessage('Added to liked');
                        } else {
                            Codeforces.showMessage('Removed from liked');
                        }
                        likeFormUtil.applyLikeableInformations(data["likeableInformations"]);
                    } else {
                        Codeforces.showMessage(data["message"] || "Error");
                    }
                    likeFormUtil.enable($likeForm);
                }, "json");
                return false;
            }

            function onDislike() {
                const $dislikeActionLink = $(this);
                const likeableId = $dislikeActionLink.attr("data-likeableId");
                const $likeForm = $dislikeActionLink.parent();

                likeFormUtil.disable($likeForm);
                $.post("/data/like", {
                    action: "dislike",
                    likeableId: likeableId
                }, function (data) {
                    if (data["success"] === true) {
                        if (data["disliked"]) {
                            Codeforces.showMessage('Added to disliked');
                        } else {
                            Codeforces.showMessage('Removed from disliked');
                        }
                        likeFormUtil.applyLikeableInformations(data["likeableInformations"]);
                    } else {
                        Codeforces.showMessage(data["message"] || "Error");
                    }
                    likeFormUtil.enable($likeForm);
                }, "json");
                return false;
            }

            $(".likeActionLink").click(onLike);
            $(".dislikeActionLink").click(onDislike);

            $(".likeCount").add(".dislikeCount").each(function () {
                const $count = $(this);
                likeFormUtil.setCount($count, likeFormUtil.getCount($count));
            });
        });
    </script>

<script data-nocturne="true"> $(function () {
}); </script>

</li>   <li>Good: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11100">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="186">186</span>
            </i>
        </a>
    </span>


</li>   <li>Average: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11101">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="65">65</span>
            </i>
        </a>
    </span>


</li>   <li>Bad: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11102">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="23">23</span>
            </i>
        </a>
    </span>


</li>   <li>Trash: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11103">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="62">62</span>
            </i>
        </a>
    </span>


</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Which problem is your most favourite?</b><div class="spoiler-content" style="display: block;"><ul>   <li>D2A: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11104">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="15">15</span>
            </i>
        </a>
    </span>


</li>   <li>D2B: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11105">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="31">31</span>
            </i>
        </a>
    </span>


</li>   <li>D1A: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11126">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="72">72</span>
            </i>
        </a>
    </span>


</li>   <li>D1B: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11108">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="55">55</span>
            </i>
        </a>
    </span>


</li>   <li>D1C1: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11127">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="43">43</span>
            </i>
        </a>
    </span>


</li>   <li>D1C2: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11128">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="8">8</span>
            </i>
        </a>
    </span>


</li>   <li>D1C3: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11129">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="71">71</span>
            </i>
        </a>
    </span>


</li>   <li>D1D: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11130">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="8">8</span>
            </i>
        </a>
    </span>


</li>   <li>D1E: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11112">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="7">7</span>
            </i>
        </a>
    </span>


</li>   <li>D1F1: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11110">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="1">1</span>
            </i>
        </a>
    </span>


</li>   <li>D1F2: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11111">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="2">2</span>
            </i>
        </a>
    </span>


</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Which problem you hate the most?</b><div class="spoiler-content" style="display: block;"><ul>   <li>D2A: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11131">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="17">17</span>
            </i>
        </a>
    </span>


</li>   <li>D2B: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11132">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="142">142</span>
            </i>
        </a>
    </span>


</li>   <li>D1A: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11133">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="23">23</span>
            </i>
        </a>
    </span>


</li>   <li>D1B: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11134">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="153">153</span>
            </i>
        </a>
    </span>


</li>   <li>D1C1: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11135">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="23">23</span>
            </i>
        </a>
    </span>


</li>   <li>D1C2: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11136">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="3">3</span>
            </i>
        </a>
    </span>


</li>   <li>D1C3: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11137">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="14">14</span>
            </i>
        </a>
    </span>


</li>   <li>D1D: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11138">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="17">17</span>
            </i>
        </a>
    </span>


</li>   <li>D1E: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11139">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="14">14</span>
            </i>
        </a>
    </span>


</li>   <li>D1F1: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11140">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="3">3</span>
            </i>
        </a>
    </span>


</li>   <li>D1F2: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11141">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="3">3</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><h4><a href="https://codeforces.com/contest/2130/problem/A">D2A Submission is All You Need</a></h4> <div class="spoiler"><b class="spoiler-title">Fun</b><div class="spoiler-content" style="display: block;"><p>Do you know the source of the title?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Assuming that choosing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mtext" id="MJXp-Span-2">mex(S')</span></span></span><script type="math/tex" id="MathJax-Element-1">\text{mex(S')}</script> is optimal, what conditions does <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-msup" id="MJXp-Span-4"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5" style="margin-right: 0.05em;">S</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-6" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-2">S'</script> need to satisfy?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Are there duplicate numbers in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7"><span class="MJXp-msup" id="MJXp-Span-8"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9" style="margin-right: 0.05em;">S</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-10" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-3">S'</script>? Is there a number greater than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-11"><span class="MJXp-mtext" id="MJXp-Span-12">mex(S')</span></span></span><script type="math/tex" id="MathJax-Element-4">\text{mex(S')}</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-13"><span class="MJXp-msup" id="MJXp-Span-14"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15" style="margin-right: 0.05em;">S</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-16" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-5">S'</script>?</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><p>Assuming that choosing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-17"><span class="MJXp-mtext" id="MJXp-Span-18">mex(S')</span></span></span><script type="math/tex" id="MathJax-Element-6">\text{mex(S')}</script> is optimal, there are no duplicate numbers in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-19"><span class="MJXp-msup" id="MJXp-Span-20"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21" style="margin-right: 0.05em;">S</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-22" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-7">S'</script>. And thers is not a number greater than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-23"><span class="MJXp-mtext" id="MJXp-Span-24">mex(S')</span></span></span><script type="math/tex" id="MathJax-Element-8">\text{mex(S')}</script>. Otherwise, we can easily construct a better answer.</p><p>Consider <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-25"><span class="MJXp-mtext" id="MJXp-Span-26">S={0,1,...,x}</span></span></span><script type="math/tex" id="MathJax-Element-9">\text{S={0,1,...,x}}</script>. We can see <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-27"><span class="MJXp-mtext" id="MJXp-Span-28">mex(S')</span><span class="MJXp-mo" id="MJXp-Span-29" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mtext" id="MJXp-Span-30">max(S')</span></span></span><script type="math/tex" id="MathJax-Element-10">\text{mex(S')}>\text{max(S')}</script> when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-31"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32">x</span></span></span><script type="math/tex" id="MathJax-Element-11">x</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-33"><span class="MJXp-mn" id="MJXp-Span-34">0</span></span></span><script type="math/tex" id="MathJax-Element-12">0</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-35"><span class="MJXp-mn" id="MJXp-Span-36">1</span></span></span><script type="math/tex" id="MathJax-Element-13">1</script>. And <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-37"><span class="MJXp-mtext" id="MJXp-Span-38">mex({0,1})</span><span class="MJXp-mo" id="MJXp-Span-39" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-40">mex({0})</span><span class="MJXp-mo" id="MJXp-Span-41" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-42">sum({1})</span></span></span><script type="math/tex" id="MathJax-Element-14">\text{mex({0,1})}=\text{mex({0})}+\text{sum({1})}</script>. Thus, we only use <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-43"><span class="MJXp-mtext" id="MJXp-Span-44">mex</span></span></span><script type="math/tex" id="MathJax-Element-15">\text{mex}</script> operation for each single <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-45"><span class="MJXp-mn" id="MJXp-Span-46">0</span></span></span><script type="math/tex" id="MathJax-Element-16">0</script>.</p><p>The answer is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-47"><span class="MJXp-mtext" id="MJXp-Span-48">sum(S)</span></span></span><script type="math/tex" id="MathJax-Element-17">\text{sum(S)}</script> add the number of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-49"><span class="MJXp-mn" id="MJXp-Span-50">0</span></span></span><script type="math/tex" id="MathJax-Element-18">0</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-51"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">S</span></span></span><script type="math/tex" id="MathJax-Element-19">S</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">solution</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> tmp</span><span class="pun">,</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">cin </span><span class="pun">&gt;&gt;</span><span class="pln"> tmp</span><span class="pun">;</span><span class="pln"> ans </span><span class="pun">+=</span><span class="pln"> tmp </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tmp </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);}</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="pln">NULL</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate the Problem</b><div class="spoiler-content" style="display: block;"><p>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11059">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="60">60</span>
            </i>
        </a>
    </span>


</p><p>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11060">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="237">237</span>
            </i>
        </a>
    </span>


</p><p>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11061">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="17">17</span>
            </i>
        </a>
    </span>


</p><p>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11062">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="26">26</span>
            </i>
        </a>
    </span>


</p><p>Didn't solve: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11063">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="23">23</span>
            </i>
        </a>
    </span>


</p></div></div><h4><a href="https://codeforces.com/contest/2130/problem/B">D2B Pathless</a></h4> <div class="spoiler"><b class="spoiler-title">Hint1</b><div class="spoiler-content" style="display: block;"><p>Casework. Consider two easy cases first: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-53"><span class="MJXp-mi" id="MJXp-Span-54">Σ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">a</span><span class="MJXp-mo" id="MJXp-Span-56" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">s</span></span></span><script type="math/tex" id="MathJax-Element-20">\Sigma a>s</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-58"><span class="MJXp-mi" id="MJXp-Span-59">Σ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">a</span><span class="MJXp-mo" id="MJXp-Span-61" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">s</span></span></span><script type="math/tex" id="MathJax-Element-21">\Sigma a=s</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint2</b><div class="spoiler-content" style="display: block;"><p>What if there is an index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-63"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">i</span></span></span><script type="math/tex" id="MathJax-Element-22">i</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-65"><span class="MJXp-msubsup" id="MJXp-Span-66"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-68" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-69" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-70"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-72" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73">i</span><span class="MJXp-mo" id="MJXp-Span-74">+</span><span class="MJXp-mn" id="MJXp-Span-75">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-76" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-77">1</span></span></span><script type="math/tex" id="MathJax-Element-23">a_i+a_{i+1}=1</script>?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint3</b><div class="spoiler-content" style="display: block;"><p>To "block" <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-78"><span class="MJXp-msubsup" id="MJXp-Span-79"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-81" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-82" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-83"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-85" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">i</span><span class="MJXp-mo" id="MJXp-Span-87">+</span><span class="MJXp-mn" id="MJXp-Span-88">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-89" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-90">1</span></span></span><script type="math/tex" id="MathJax-Element-24">a_i+a_{i+1}=1</script>, what should Bob do?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint4</b><div class="spoiler-content" style="display: block;"><p>Consider cases of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-91"><span class="MJXp-mi" id="MJXp-Span-92">Σ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">a</span><span class="MJXp-mo" id="MJXp-Span-94" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95">s</span><span class="MJXp-mo" id="MJXp-Span-96" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-97">1</span></span></span><script type="math/tex" id="MathJax-Element-25">\Sigma a=s+1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-98"><span class="MJXp-mi" id="MJXp-Span-99">Σ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">a</span><span class="MJXp-mo" id="MJXp-Span-101" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">s</span><span class="MJXp-mo" id="MJXp-Span-103" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-104">1</span></span></span><script type="math/tex" id="MathJax-Element-26">\Sigma a>s+1</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><p>The minimum path sum is the sum of the simple path from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-105"><span class="MJXp-mn" id="MJXp-Span-106">1</span></span></span><script type="math/tex" id="MathJax-Element-27">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">n</span></span></span><script type="math/tex" id="MathJax-Element-28">n</script> (i.e., <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-109"><span class="MJXp-mn" id="MJXp-Span-110">1</span><span class="MJXp-mo" id="MJXp-Span-111" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mn" id="MJXp-Span-112">2</span><span class="MJXp-mo" id="MJXp-Span-113" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mo" id="MJXp-Span-114" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-115" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">n</span></span></span><script type="math/tex" id="MathJax-Element-29">1 \rightarrow 2 \rightarrow \dots \rightarrow n</script>), denoted as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-117"><span class="MJXp-mtext" id="MJXp-Span-118">base_sum</span><span class="MJXp-mo" id="MJXp-Span-119" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-120"><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-122"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">i</span><span class="MJXp-mo" id="MJXp-Span-124">=</span><span class="MJXp-mn" id="MJXp-Span-125">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-128"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-130" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-30">\text{base_sum} = \sum_{i=1}^{n} a_i</script>.</p><p>The path can include back-and-forth movements (e.g., from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">i</span></span></span><script type="math/tex" id="MathJax-Element-31">i</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">i</span><span class="MJXp-mo" id="MJXp-Span-135" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-136">1</span></span></span><script type="math/tex" id="MathJax-Element-32">i+1</script> and back to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138">i</span></span></span><script type="math/tex" id="MathJax-Element-33">i</script>), which increases the path length and the path sum. Specifically, each back-and-forth movement between adjacent positions <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-139"><span class="MJXp-mo" id="MJXp-Span-140" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">i</span><span class="MJXp-mo" id="MJXp-Span-142" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">i</span><span class="MJXp-mo" id="MJXp-Span-144" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-145">1</span><span class="MJXp-mo" id="MJXp-Span-146" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-34">(i, i+1)</script> adds <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-147"><span class="MJXp-msubsup" id="MJXp-Span-148"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-150" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-151" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-154" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">i</span><span class="MJXp-mo" id="MJXp-Span-156">+</span><span class="MJXp-mn" id="MJXp-Span-157">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-35">a_i + a_{i+1}</script> to the path sum.</p><p>Thus, the total path sum can be expressed as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-158"><span class="MJXp-mtext" id="MJXp-Span-159">base_sum</span><span class="MJXp-mo" id="MJXp-Span-160" style="margin-left: 0em; margin-right: 0.111em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">d</span></span></span><script type="math/tex" id="MathJax-Element-36">\text{base_sum} + d</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-162"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">d</span></span></span><script type="math/tex" id="MathJax-Element-37">d</script> is the additional sum contributed by zero or more back-and-forth movements. Here, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-164"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">d</span></span></span><script type="math/tex" id="MathJax-Element-38">d</script> can be represented as a non-negative integer linear combination of the sums of adjacent pairs.</p><p>Casework:</p> <ul>   <li><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-166"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">s</span><span class="MJXp-mo" id="MJXp-Span-168" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mtext" id="MJXp-Span-169">base_sum</span></span></span><script type="math/tex" id="MathJax-Element-39">s < \text{base_sum}</script>, no path sum can equal <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-170"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">s</span></span></span><script type="math/tex" id="MathJax-Element-40">s</script> (since the base sum already exceeds <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-172"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">k</span></span></span><script type="math/tex" id="MathJax-Element-41">k</script>, and any additional movements will further increase the sum).</p></li>   <li><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-174"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">s</span><span class="MJXp-mo" id="MJXp-Span-176" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-177">base_sum</span></span></span><script type="math/tex" id="MathJax-Element-42">s = \text{base_sum}</script>, the simple path (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-178"><span class="MJXp-mn" id="MJXp-Span-179">1</span><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mn" id="MJXp-Span-181">2</span><span class="MJXp-mo" id="MJXp-Span-182" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mo" id="MJXp-Span-183" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-184" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">n</span></span></span><script type="math/tex" id="MathJax-Element-43">1 \rightarrow 2 \rightarrow \dots \rightarrow n</script>) already satisfies the condition, so Alice cannot be stopped.</p></li>   <li><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-186"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">s</span><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mtext" id="MJXp-Span-189">base_sum</span></span></span><script type="math/tex" id="MathJax-Element-44">s > \text{base_sum}</script>, let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-190"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">d</span><span class="MJXp-mo" id="MJXp-Span-192" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">s</span><span class="MJXp-mo" id="MJXp-Span-194" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-195">base_sum</span></span></span><script type="math/tex" id="MathJax-Element-45">d = s - \text{base_sum}</script>:</p>   <ul>     <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-196"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">d</span><span class="MJXp-mo" id="MJXp-Span-198" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-199">1</span></span></span><script type="math/tex" id="MathJax-Element-46">d = 1</script>, we can rearrange the array to avoid adjacent pairs summing to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-200"><span class="MJXp-mn" id="MJXp-Span-201">1</span></span></span><script type="math/tex" id="MathJax-Element-47">1</script> (i.e., avoid <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-202"><span class="MJXp-mn" id="MJXp-Span-203">0</span></span></span><script type="math/tex" id="MathJax-Element-48">0</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-204"><span class="MJXp-mn" id="MJXp-Span-205">1</span></span></span><script type="math/tex" id="MathJax-Element-49">1</script> being adjacent). Specifically, place all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-206"><span class="MJXp-mn" id="MJXp-Span-207">0</span></span></span><script type="math/tex" id="MathJax-Element-50">0</script>s first, followed by all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-208"><span class="MJXp-mn" id="MJXp-Span-209">2</span></span></span><script type="math/tex" id="MathJax-Element-51">2</script>s, and then all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-210"><span class="MJXp-mn" id="MJXp-Span-211">1</span></span></span><script type="math/tex" id="MathJax-Element-52">1</script>s (e.g., <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-212"><span class="MJXp-mo" id="MJXp-Span-213" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-214">0</span><span class="MJXp-mo" id="MJXp-Span-215" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-216">0</span><span class="MJXp-mo" id="MJXp-Span-217" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-218" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-219" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-220">0</span><span class="MJXp-mo" id="MJXp-Span-221" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-222">2</span><span class="MJXp-mo" id="MJXp-Span-223" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-224">2</span><span class="MJXp-mo" id="MJXp-Span-225" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-226" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-227" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-228">2</span><span class="MJXp-mo" id="MJXp-Span-229" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-230">1</span><span class="MJXp-mo" id="MJXp-Span-231" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-232">1</span><span class="MJXp-mo" id="MJXp-Span-233" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-234" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-235" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-236">1</span><span class="MJXp-mo" id="MJXp-Span-237" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-53">[0, 0, \dots, 0, 2, 2, \dots, 2, 1, 1, \dots, 1]</script>). This ensures no adjacent pair sums to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-238"><span class="MJXp-mn" id="MJXp-Span-239">1</span></span></span><script type="math/tex" id="MathJax-Element-54">1</script>, making <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-240"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">d</span><span class="MJXp-mo" id="MJXp-Span-242" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-243">1</span></span></span><script type="math/tex" id="MathJax-Element-55">d = 1</script> unachievable.</li>   </ul>   <ul>     <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-244"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">d</span><span class="MJXp-mo" id="MJXp-Span-246" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mn" id="MJXp-Span-247">1</span></span></span><script type="math/tex" id="MathJax-Element-56">d \neq 1</script>, no rearrangement can prevent Alice from achieving the path sum <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-248"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">s</span></span></span><script type="math/tex" id="MathJax-Element-57">s</script> (since sums of adjacent pairs can cover all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-250"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">T</span><span class="MJXp-mo" id="MJXp-Span-252" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-253">2</span></span></span><script type="math/tex" id="MathJax-Element-58">T \geq 2</script> through linear combinations).</li>   </ul></li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">solution</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">,</span><span class="pln"> tmp</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="lit">3</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">cin </span><span class="pun">&gt;&gt;</span><span class="pln"> tmp</span><span class="pun">;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">tmp</span><span class="pun">]++;}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">k </span><span class="pun">==</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">*</span><span class="pln">a</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> k </span><span class="pun">&gt;=</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">*</span><span class="pln">a</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">){</span><span class="pln">cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">return</span><span class="pun">;}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">a</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">a</span><span class="pun">[</span><span class="lit">2</span><span class="pun">];</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">a</span><span class="pun">[</span><span class="lit">1</span><span class="pun">];</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="pln">NULL</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate the Problem</b><div class="spoiler-content" style="display: block;"><p>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11064">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="228">228</span>
            </i>
        </a>
    </span>


</p><p>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11065">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="75">75</span>
            </i>
        </a>
    </span>


</p><p>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11066">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="16">16</span>
            </i>
        </a>
    </span>


</p><p>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11067">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="123">123</span>
            </i>
        </a>
    </span>


</p><p>Didn't solve: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11068">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="53">53</span>
            </i>
        </a>
    </span>


</p></div></div><h4><a href="https://codeforces.com/contest/2129/problem/A">D1A Double Perspective</a></h4> <div class="spoiler"><b class="spoiler-title">Hint1</b><div class="spoiler-content" style="display: block;"><p>Assuming that choosing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-254"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">S</span></span></span><script type="math/tex" id="MathJax-Element-59">S</script> is optimal, what is the value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-256"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">g</span><span class="MJXp-mo" id="MJXp-Span-258" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">S</span><span class="MJXp-mo" id="MJXp-Span-260" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-60">g(S)</script>?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint2</b><div class="spoiler-content" style="display: block;"><p>In the case of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-261"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">g</span><span class="MJXp-mo" id="MJXp-Span-263" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">S</span><span class="MJXp-mo" id="MJXp-Span-265" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-267">0</span></span></span><script type="math/tex" id="MathJax-Element-61">g(S)=0</script>, make <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-268"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269">f</span><span class="MJXp-mo" id="MJXp-Span-270" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">S</span><span class="MJXp-mo" id="MJXp-Span-272" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-62">f(S)</script> the length of the union of the entire set.</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><p>Assuming that choosing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-273"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274">S</span></span></span><script type="math/tex" id="MathJax-Element-63">S</script> is optimal, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-275"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">g</span><span class="MJXp-mo" id="MJXp-Span-277" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">S</span><span class="MJXp-mo" id="MJXp-Span-279" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-64">g(S)</script> must be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-280"><span class="MJXp-mn" id="MJXp-Span-281">0</span></span></span><script type="math/tex" id="MathJax-Element-65">0</script> because removing an edge on the cycle will not change <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-282"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">f</span><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">S</span><span class="MJXp-mo" id="MJXp-Span-286" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-66">f(S)</script>.</p><p>In the case of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">g</span><span class="MJXp-mo" id="MJXp-Span-289" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">S</span><span class="MJXp-mo" id="MJXp-Span-291" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-292" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-293">0</span></span></span><script type="math/tex" id="MathJax-Element-67">g(S)=0</script>, we need to make <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-294"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">f</span><span class="MJXp-mo" id="MJXp-Span-296" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">S</span><span class="MJXp-mo" id="MJXp-Span-298" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-68">f(S)</script> the length of the union of the entire set. There are many approaches. </p><p>An easiest <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">O</span><span class="MJXp-mo" id="MJXp-Span-301" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-302"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-304" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-305" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-69">O(n^2)</script> approach is to remove all segments contained by other segments. Afterwards, it can be proven that there are no cycles with a length greater than or equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-306"><span class="MJXp-mn" id="MJXp-Span-307">3</span></span></span><script type="math/tex" id="MathJax-Element-70">3</script> in the graph. If there is a cycle, note it as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-308"><span class="MJXp-msubsup" id="MJXp-Span-309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-311" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-312" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-msubsup" id="MJXp-Span-313"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-315" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-316" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-msubsup" id="MJXp-Span-317"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-319" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-320" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mo" id="MJXp-Span-321" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-322" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-323" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-324" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-msubsup" id="MJXp-Span-325"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-327" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-71">x_1 \rightarrow x_2 \rightarrow x_3 \rightarrow ... \rightarrow x_1</script>, we can always find <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-328"><span class="MJXp-msubsup" id="MJXp-Span-329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-331" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332">i</span><span class="MJXp-mo" id="MJXp-Span-333">−</span><span class="MJXp-mn" id="MJXp-Span-334">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-335" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-336"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-338" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-339" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-342" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">i</span><span class="MJXp-mo" id="MJXp-Span-344">+</span><span class="MJXp-mn" id="MJXp-Span-345">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-72">x_{i-1}<x_i>x_{i+1}</script>, where either <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-346"><span class="MJXp-mo" id="MJXp-Span-347" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-348"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-350" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351">i</span><span class="MJXp-mo" id="MJXp-Span-352">−</span><span class="MJXp-mn" id="MJXp-Span-353">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-354" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-355"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-357" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-358" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-359" style="margin-left: 0.333em; margin-right: 0.333em;">⊆</span><span class="MJXp-mo" id="MJXp-Span-360" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-361"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-363" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-364" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-365"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-367" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368">i</span><span class="MJXp-mo" id="MJXp-Span-369">+</span><span class="MJXp-mn" id="MJXp-Span-370">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-371" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-73">[x_{i-1},x_i] \subseteq [x_i,x_{i+1}]</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-372"><span class="MJXp-mo" id="MJXp-Span-373" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-376" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-377" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-380" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">i</span><span class="MJXp-mo" id="MJXp-Span-382">+</span><span class="MJXp-mn" id="MJXp-Span-383">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-384" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-385" style="margin-left: 0.333em; margin-right: 0.333em;">⊆</span><span class="MJXp-mo" id="MJXp-Span-386" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-387"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-389" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390">i</span><span class="MJXp-mo" id="MJXp-Span-391">−</span><span class="MJXp-mn" id="MJXp-Span-392">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-393" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-394"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-396" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-397" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-74">[x_i,x_{i+1}] \subseteq [x_{i-1},x_i]</script>. At this point, we have deduced the contradiction, so there are no cycles with a length greater than or equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-398"><span class="MJXp-mn" id="MJXp-Span-399">3</span></span></span><script type="math/tex" id="MathJax-Element-75">3</script> in the graph.</p><p>Another approach is to use DSU to maintain the generate forest.</p></div></div> <div class="spoiler"><b class="spoiler-title">solution</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><br><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;map&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;set&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cmath&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;ctime&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;queue&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;stack&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstdio&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstdlib&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;vector&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstring&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;algorithm&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;iostream&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;bitset&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;unordered_map&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> fastio ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">cout</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">double</span><span class="pln"> db</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ull</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N</span><span class="pun">=</span><span class="lit">1000010</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln">b</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> init</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    cin</span><span class="pun">&gt;&gt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
        cin</span><span class="pun">&gt;&gt;</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]&gt;&gt;</span><span class="pln">b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> tag</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">4</span><span class="pun">,</span><span class="lit">1</span><span class="pun">),</span><span class="pln">ans</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
        </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">i</span><span class="pun">==</span><span class="pln">j</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]&lt;=</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]&amp;&amp;</span><span class="pln">b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]&lt;=</span><span class="pln">b</span><span class="pun">[</span><span class="pln">j</span><span class="pun">])</span><span class="pln"> tag</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">tag</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> ans</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    cout</span><span class="pun">&lt;&lt;</span><span class="pln">ans</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()&lt;&lt;</span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">ans</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
        cout</span><span class="pun">&lt;&lt;</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]&lt;&lt;(</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">==</span><span class="pln">ans</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()?</span><span class="str">"\n"</span><span class="pun">:</span><span class="str">" "</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    fastio</span><span class="pun">;</span><span class="pln">

    cin</span><span class="pun">&gt;&gt;</span><span class="pln">T</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		init</span><span class="pun">();</span><span class="pln">
		solve</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">


</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate the Problem</b><div class="spoiler-content" style="display: block;"><p>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11069">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="109">109</span>
            </i>
        </a>
    </span>


</p><p>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11070">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="169">169</span>
            </i>
        </a>
    </span>


</p><p>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11071">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="31">31</span>
            </i>
        </a>
    </span>


</p><p>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11072">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="63">63</span>
            </i>
        </a>
    </span>


</p><p>Didn't solve: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11073">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="18">18</span>
            </i>
        </a>
    </span>


</p></div></div><h4><a href="https://codeforces.com/contest/2129/problem/B">D1B Stay or Mirror</a></h4> <div class="spoiler"><b class="spoiler-title">Hint1</b><div class="spoiler-content" style="display: block;"><p>Consider <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-400"><span class="MJXp-msubsup" id="MJXp-Span-401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-403" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-404" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-405">1</span></span></span><script type="math/tex" id="MathJax-Element-76">p_i=1</script>. If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-406"><span class="MJXp-msubsup" id="MJXp-Span-407"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-408" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-409" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-410" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-411">1</span></span></span><script type="math/tex" id="MathJax-Element-77">a_i=1</script>, what are inversions containing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-412"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413">i</span></span></span><script type="math/tex" id="MathJax-Element-78">i</script>? If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-414"><span class="MJXp-msubsup" id="MJXp-Span-415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-417" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-418" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-419">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420">n</span><span class="MJXp-mo" id="MJXp-Span-421" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-422">1</span></span></span><script type="math/tex" id="MathJax-Element-79">a_i=2n-1</script>, what are inversions containing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-423"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">i</span></span></span><script type="math/tex" id="MathJax-Element-80">i</script>?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint2</b><div class="spoiler-content" style="display: block;"><p>Attempt to generalize the conclusion to any pair <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-425"><span class="MJXp-mo" id="MJXp-Span-426" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427">i</span><span class="MJXp-mo" id="MJXp-Span-428" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429">j</span><span class="MJXp-mo" id="MJXp-Span-430" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-81">(i, j)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><p>Consider <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-431"><span class="MJXp-msubsup" id="MJXp-Span-432"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-434" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-435" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-436">1</span></span></span><script type="math/tex" id="MathJax-Element-82">p_i=1</script> and inversions containing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-437"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438">i</span></span></span><script type="math/tex" id="MathJax-Element-83">i</script>. If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-439"><span class="MJXp-msubsup" id="MJXp-Span-440"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-441" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-442" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-443" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-444">1</span></span></span><script type="math/tex" id="MathJax-Element-84">a_i=1</script>, it is the minimum value, and the inversions containing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-445"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-446">i</span></span></span><script type="math/tex" id="MathJax-Element-85">i</script> are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-447"><span class="MJXp-mo" id="MJXp-Span-448" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-449">1</span><span class="MJXp-mo" id="MJXp-Span-450" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">i</span><span class="MJXp-mo" id="MJXp-Span-452" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-453" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-454" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-455">2</span><span class="MJXp-mo" id="MJXp-Span-456" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457">i</span><span class="MJXp-mo" id="MJXp-Span-458" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-459" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-460" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-461" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-462" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-463" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464">i</span><span class="MJXp-mo" id="MJXp-Span-465" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-466">1</span><span class="MJXp-mo" id="MJXp-Span-467" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468">i</span><span class="MJXp-mo" id="MJXp-Span-469" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-86">(1, i), (2, i),... (i-1, i)</script>; If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-470"><span class="MJXp-msubsup" id="MJXp-Span-471"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-472" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-473" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-474" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-475">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">n</span><span class="MJXp-mo" id="MJXp-Span-477" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-478">1</span></span></span><script type="math/tex" id="MathJax-Element-87">a_i=2n-1</script>, it is the maximum value, and the inversions containing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-479"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">i</span></span></span><script type="math/tex" id="MathJax-Element-88">i</script> are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-481"><span class="MJXp-mo" id="MJXp-Span-482" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483">i</span><span class="MJXp-mo" id="MJXp-Span-484" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485">i</span><span class="MJXp-mo" id="MJXp-Span-486" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-487">1</span><span class="MJXp-mo" id="MJXp-Span-488" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-489" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-490" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-491" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-492" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-493" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">i</span><span class="MJXp-mo" id="MJXp-Span-495" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496">n</span><span class="MJXp-mo" id="MJXp-Span-497" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-89">(i, i+1),... (i, n)</script>. The key observation is the number of inversions containing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499">i</span></span></span><script type="math/tex" id="MathJax-Element-90">i</script> is only related to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-500"><span class="MJXp-msubsup" id="MJXp-Span-501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-503" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-91">a_i</script>, and completely unrelated to other elements.</p><p>At this point, the problem has actually been solved. We can greedily choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-506"><span class="MJXp-mo" id="MJXp-Span-507" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-508" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-509">i</span><span class="MJXp-mo" id="MJXp-Span-510" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-511">1</span><span class="MJXp-mo" id="MJXp-Span-512" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">n</span><span class="MJXp-mo" id="MJXp-Span-514" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515">i</span><span class="MJXp-mo" id="MJXp-Span-516" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-92">\min(i-1,n-i)</script> and remove <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-517"><span class="MJXp-mn" id="MJXp-Span-518">1</span></span></span><script type="math/tex" id="MathJax-Element-93">1</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-519"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-520">p</span></span></span><script type="math/tex" id="MathJax-Element-94">p</script>, and the remaining part is a completely identical subproblem with a size of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-521"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-522">n</span><span class="MJXp-mo" id="MJXp-Span-523" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-524">1</span></span></span><script type="math/tex" id="MathJax-Element-95">n-1</script>.</p><p>It can be implemented as follows: for each index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-525"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-526">i</span></span></span><script type="math/tex" id="MathJax-Element-96">i</script>, calculate the number of elements to the left that are bigger than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-527"><span class="MJXp-msubsup" id="MJXp-Span-528"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-530" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-97">p_i</script> (note it as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-531"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-532">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">r</span></span></span><script type="math/tex" id="MathJax-Element-98">lbigger</script>), and the number of elements to the right that are bigger than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-539"><span class="MJXp-msubsup" id="MJXp-Span-540"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-542" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-99">p_i</script> (note it as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-547">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-548">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-549">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-550">r</span></span></span><script type="math/tex" id="MathJax-Element-100">rbigger</script>). Then greedily add <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-551"><span class="MJXp-mo" id="MJXp-Span-552" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-553" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-556">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560">r</span><span class="MJXp-mo" id="MJXp-Span-561" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-562">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-568">r</span><span class="MJXp-mo" id="MJXp-Span-569" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-101">\min(lbigger,rbigger)</script> to the answer.</p></div></div> <div class="spoiler"><b class="spoiler-title">solution</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><br><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> p</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> left </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> right </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">&lt;</span><span class="pln">i</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> left</span><span class="pun">++;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> right</span><span class="pun">++;</span><span class="pln">
        ans </span><span class="pun">+=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">left</span><span class="pun">,</span><span class="pln"> right</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="pln">NULL</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate the Problem</b><div class="spoiler-content" style="display: block;"><p>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11074">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="334">334</span>
            </i>
        </a>
    </span>


</p><p>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11075">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="40">40</span>
            </i>
        </a>
    </span>


</p><p>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11076">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="27">27</span>
            </i>
        </a>
    </span>


</p><p>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11077">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="126">126</span>
            </i>
        </a>
    </span>


</p><p>Didn't solve: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11078">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="32">32</span>
            </i>
        </a>
    </span>


</p></div></div><h4><a href="https://codeforces.com/contest/2129/problem/C1">D1C1 Interactive RBS (Easy Version)</a>, <a href="https://codeforces.com/contest/2129/problem/C2">D1C2 Interactive RBS (Medium Version)</a> and <a href="https://codeforces.com/contest/2129/problem/C3">D1C3 Interactive RBS (Hard Version)</a></h4> <div class="spoiler"><b class="spoiler-title">Hint1</b><div class="spoiler-content" style="display: block;"><p>Try to Perform binary search to find a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-570"><span class="MJXp-mrow" id="MJXp-Span-571"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-572">'('</span></span></span></span><script type="math/tex" id="MathJax-Element-102">\texttt{'('}</script> and a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-573"><span class="MJXp-mrow" id="MJXp-Span-574"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-575">')'</span></span></span></span><script type="math/tex" id="MathJax-Element-103">\texttt{')'}</script> using <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-576"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">O</span><span class="MJXp-mo" id="MJXp-Span-578" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-579">log</span><span class="MJXp-mo" id="MJXp-Span-580" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581">n</span><span class="MJXp-mo" id="MJXp-Span-582" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-104">O(\log n)</script> queries. It is best to complete it within <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-583"><span class="MJXp-mn" id="MJXp-Span-584">10</span></span></span><script type="math/tex" id="MathJax-Element-105">10</script> operations (to pass the hard version).</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint2</b><div class="spoiler-content" style="display: block;"><p>Consider the easy version. Constraint implies that we use one query to determine <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-585"><span class="MJXp-mn" id="MJXp-Span-586">2</span></span></span><script type="math/tex" id="MathJax-Element-106">2</script> characters.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint3</b><div class="spoiler-content" style="display: block;"><p>Construct a string <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-587"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-588">x</span></span></span><script type="math/tex" id="MathJax-Element-107">x</script>, insert <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-589"><span class="MJXp-msubsup" id="MJXp-Span-590"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-591" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-592" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-108">s_i</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-593"><span class="MJXp-msubsup" id="MJXp-Span-594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-596" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-109">s_j</script> into certain positions of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-597"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-598">x</span></span></span><script type="math/tex" id="MathJax-Element-110">x</script> to obtain string <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-599"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600">y</span></span></span><script type="math/tex" id="MathJax-Element-111">y</script>, so that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-601"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602">f</span><span class="MJXp-mo" id="MJXp-Span-603" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-604">y</span><span class="MJXp-mo" id="MJXp-Span-605" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-112">f(y)</script> can produce <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-606"><span class="MJXp-mn" id="MJXp-Span-607">4</span></span></span><script type="math/tex" id="MathJax-Element-113">4</script> different values.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint4</b><div class="spoiler-content" style="display: block;"><p>Consider the medium version. Effectively utilizing the conditions of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-608"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609">k</span><span class="MJXp-mo" id="MJXp-Span-610" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-611">1000</span></span></span><script type="math/tex" id="MathJax-Element-114">k \le 1000</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint5</b><div class="spoiler-content" style="display: block;"><p>Consider binary code.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint6</b><div class="spoiler-content" style="display: block;"><p>Consider the hard version. The number of substrings in a string of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-612"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613">l</span></span></span><script type="math/tex" id="MathJax-Element-115">l</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-614"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-615">O</span><span class="MJXp-mo" id="MJXp-Span-616" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-617"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618" style="margin-right: 0.05em;">l</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-619" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-620" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-116">O(l ^ 2)</script>. How to utilize this?</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial (easy version)</b><div class="spoiler-content" style="display: block;"><p>At first, we need to find <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-621"><span class="MJXp-msubsup" id="MJXp-Span-622"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-624" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-625" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-626"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-627">’(’</span></span></span></span><script type="math/tex" id="MathJax-Element-117">s_x=\texttt{’(’}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-628"><span class="MJXp-msubsup" id="MJXp-Span-629"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-630" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-631" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-632" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-633"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-634">’)’</span></span></span></span><script type="math/tex" id="MathJax-Element-118">s_y=\texttt{’)’}</script>. Do binary search to find the smallest <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-635"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-636">i</span></span></span><script type="math/tex" id="MathJax-Element-119">i</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-637"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-638">f</span><span class="MJXp-mo" id="MJXp-Span-639" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-640"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-642" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-msubsup" id="MJXp-Span-643"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-645" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-646" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-647" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-648" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-msubsup" id="MJXp-Span-649"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-650" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-651" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-652" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-653" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-654">0</span></span></span><script type="math/tex" id="MathJax-Element-120">f(s_1s_2...s_i)>0</script>. Then we get <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-655"><span class="MJXp-msubsup" id="MJXp-Span-656"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-658" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-659">i</span><span class="MJXp-mo" id="MJXp-Span-660">−</span><span class="MJXp-mn" id="MJXp-Span-661">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-662" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-663"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-664">’(’</span></span></span></span><script type="math/tex" id="MathJax-Element-121">s_{i-1}=\texttt{’(’}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-665"><span class="MJXp-msubsup" id="MJXp-Span-666"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-668" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-669" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-670"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-671">’)’</span></span></span></span><script type="math/tex" id="MathJax-Element-122">s_i=\texttt{’)’}</script>. A corner case is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-672"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-673">f</span><span class="MJXp-mo" id="MJXp-Span-674" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">s</span><span class="MJXp-mo" id="MJXp-Span-676" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-677" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-678">0</span></span></span><script type="math/tex" id="MathJax-Element-123">f(s)=0</script>. In this case, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-679"><span class="MJXp-msubsup" id="MJXp-Span-680"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-682" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-683" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-684"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-685">’(’</span></span></span></span><script type="math/tex" id="MathJax-Element-124">s_n=\texttt{’(’}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-686"><span class="MJXp-msubsup" id="MJXp-Span-687"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-689" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-690" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-691"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-692">’)’</span></span></span></span><script type="math/tex" id="MathJax-Element-125">s_1=\texttt{’)’}</script>.</p><p>Ask <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-693"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694">f</span><span class="MJXp-mo" id="MJXp-Span-695" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-696"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-697">"s1)s2)()"</span></span><span class="MJXp-mo" id="MJXp-Span-698" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-126">f(\texttt{"s1)s2)()"})</script>:</p> <ul>   <li><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-699"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-700">f</span><span class="MJXp-mo" id="MJXp-Span-701" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-702"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-703">"s1)s2)()"</span></span><span class="MJXp-mo" id="MJXp-Span-704" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-705" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-706">6</span></span></span><script type="math/tex" id="MathJax-Element-127">f(\texttt{"s1)s2)()"})=6</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-707"><span class="MJXp-msubsup" id="MJXp-Span-708"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-710" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-711" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><script type="math/tex" id="MathJax-Element-128">s_1=</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-712"><span class="MJXp-mrow" id="MJXp-Span-713"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-714">'('</span></span></span></span><script type="math/tex" id="MathJax-Element-129">\texttt{'('}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-715"><span class="MJXp-msubsup" id="MJXp-Span-716"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-718" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-719" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><script type="math/tex" id="MathJax-Element-130">s_2=</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-720"><span class="MJXp-mrow" id="MJXp-Span-721"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-722">'('</span></span></span></span><script type="math/tex" id="MathJax-Element-131">\texttt{'('}</script>.</p></li>   <li><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-723"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724">f</span><span class="MJXp-mo" id="MJXp-Span-725" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-726"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-727">"s1)s2)()"</span></span><span class="MJXp-mo" id="MJXp-Span-728" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-729" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-730">2</span></span></span><script type="math/tex" id="MathJax-Element-132">f(\texttt{"s1)s2)()"})=2</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-731"><span class="MJXp-msubsup" id="MJXp-Span-732"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-734" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-735" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><script type="math/tex" id="MathJax-Element-133">s_1=</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-736"><span class="MJXp-mrow" id="MJXp-Span-737"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-738">'('</span></span></span></span><script type="math/tex" id="MathJax-Element-134">\texttt{'('}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-739"><span class="MJXp-msubsup" id="MJXp-Span-740"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-741" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-742" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-743" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><script type="math/tex" id="MathJax-Element-135">s_2=</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-744"><span class="MJXp-mrow" id="MJXp-Span-745"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-746">')'</span></span></span></span><script type="math/tex" id="MathJax-Element-136">\texttt{')'}</script>.</p></li>   <li><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-747"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-748">f</span><span class="MJXp-mo" id="MJXp-Span-749" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-750"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-751">"s1)s2)()"</span></span><span class="MJXp-mo" id="MJXp-Span-752" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-753" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-754">3</span></span></span><script type="math/tex" id="MathJax-Element-137">f(\texttt{"s1)s2)()"})=3</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-755"><span class="MJXp-msubsup" id="MJXp-Span-756"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-758" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-759" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><script type="math/tex" id="MathJax-Element-138">s_1=</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-760"><span class="MJXp-mrow" id="MJXp-Span-761"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-762">')'</span></span></span></span><script type="math/tex" id="MathJax-Element-139">\texttt{')'}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-763"><span class="MJXp-msubsup" id="MJXp-Span-764"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-765" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-766" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-767" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><script type="math/tex" id="MathJax-Element-140">s_2=</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-768"><span class="MJXp-mrow" id="MJXp-Span-769"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-770">'('</span></span></span></span><script type="math/tex" id="MathJax-Element-141">\texttt{'('}</script>.</p></li>   <li><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-771"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-772">f</span><span class="MJXp-mo" id="MJXp-Span-773" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-774"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-775">"s1)s2)()"</span></span><span class="MJXp-mo" id="MJXp-Span-776" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-777" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-778">1</span></span></span><script type="math/tex" id="MathJax-Element-142">f(\texttt{"s1)s2)()"})=1</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-779"><span class="MJXp-msubsup" id="MJXp-Span-780"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-781" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-782" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-783" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><script type="math/tex" id="MathJax-Element-143">s_1=</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-784"><span class="MJXp-mrow" id="MJXp-Span-785"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-786">')'</span></span></span></span><script type="math/tex" id="MathJax-Element-144">\texttt{')'}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-787"><span class="MJXp-msubsup" id="MJXp-Span-788"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-790" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-791" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><script type="math/tex" id="MathJax-Element-145">s_2=</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-792"><span class="MJXp-mrow" id="MJXp-Span-793"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-794">')'</span></span></span></span><script type="math/tex" id="MathJax-Element-146">\texttt{')'}</script>.</p></li> </ul><p>In this way, we can determine two characters with one query.</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial (medium version)</b><div class="spoiler-content" style="display: block;"><p>Read the tutorial in easy version first.</p><p>Note <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-795"><span class="MJXp-msubsup" id="MJXp-Span-796"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-797" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-798" style="vertical-align: -0.4em;">0</span></span></span></span><script type="math/tex" id="MathJax-Element-147">f_0</script> as the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-799"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-800">f</span></span></span><script type="math/tex" id="MathJax-Element-148">f</script> value of the following string:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-801"><span class="MJXp-munderover" id="MJXp-Span-802"><span class=""><span class="MJXp-mrow" id="MJXp-Span-803"><span class="MJXp-munderover" id="MJXp-Span-804"><span class=""><span class="MJXp-mo" id="MJXp-Span-805" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-806" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-807" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-808" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-809" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-810" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-811" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-812" style="margin-left: 0px; margin-right: 0em;">⏟</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-813" style="margin-left: 0px;"><span class="MJXp-mn" id="MJXp-Span-814">128</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-815">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-818">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819">s</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-149">\underbrace{()()\ldots()}_{128 pairs}</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-820"><span class="MJXp-mo" id="MJXp-Span-821" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-150">)</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-822"><span class="MJXp-munderover" id="MJXp-Span-823"><span class=""><span class="MJXp-mrow" id="MJXp-Span-824"><span class="MJXp-munderover" id="MJXp-Span-825"><span class=""><span class="MJXp-mo" id="MJXp-Span-826" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-827" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-828" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-829" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-830" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-831" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-832" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-833" style="margin-left: 0px; margin-right: 0em;">⏟</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-834" style="margin-left: 0px;"><span class="MJXp-mn" id="MJXp-Span-835">64</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-838">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840">s</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-151">\underbrace{()()\ldots()}_{64 pairs}</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-841"><span class="MJXp-mo" id="MJXp-Span-842" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-152">)</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-843"><span class="MJXp-mo" id="MJXp-Span-844" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex" id="MathJax-Element-153">\dots</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-845"><span class="MJXp-mo" id="MJXp-Span-846" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-847" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-848" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-154">)()</script></p><p>Then ask for the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-849"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-850">f</span></span></span><script type="math/tex" id="MathJax-Element-155">f</script> value of the following string (note it as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-851"><span class="MJXp-msubsup" id="MJXp-Span-852"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-853" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-854" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-156">f_1</script>):</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-855"><span class="MJXp-munderover" id="MJXp-Span-856"><span class=""><span class="MJXp-mrow" id="MJXp-Span-857"><span class="MJXp-munderover" id="MJXp-Span-858"><span class=""><span class="MJXp-msubsup" id="MJXp-Span-859"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-860" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-861" style="vertical-align: -0.4em;">8</span></span><span class="MJXp-mo" id="MJXp-Span-862" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-863" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-864" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-865" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-866" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-867" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-868" style="margin-left: 0px; margin-right: 0em;">⏟</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-869" style="margin-left: 0px;"><span class="MJXp-mn" id="MJXp-Span-870">128</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-872">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-873">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875">s</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-157">\underbrace{s_8)()\ldots()}_{128 pairs}</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-876"><span class="MJXp-mo" id="MJXp-Span-877" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-158">)</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-878"><span class="MJXp-munderover" id="MJXp-Span-879"><span class=""><span class="MJXp-mrow" id="MJXp-Span-880"><span class="MJXp-munderover" id="MJXp-Span-881"><span class=""><span class="MJXp-msubsup" id="MJXp-Span-882"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-883" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-884" style="vertical-align: -0.4em;">7</span></span><span class="MJXp-mo" id="MJXp-Span-885" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-886" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-887" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-888" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-889" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-890" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-891" style="margin-left: 0px; margin-right: 0em;">⏟</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-892" style="margin-left: 0px;"><span class="MJXp-mn" id="MJXp-Span-893">64</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-895">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">s</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-159">\underbrace{s_7)()\ldots()}_{64 pairs}</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-899"><span class="MJXp-mo" id="MJXp-Span-900" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-160">)</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-901"><span class="MJXp-mo" id="MJXp-Span-902" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex" id="MathJax-Element-161">\dots</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-903"><span class="MJXp-mo" id="MJXp-Span-904" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-905"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-906" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-907" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-908" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-162">)s_1)</script></p><p>By checking the binary bits of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-909"><span class="MJXp-msubsup" id="MJXp-Span-910"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-912" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-913" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-914"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-916" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-163">f_0-f_1</script>, we can determine <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-917"><span class="MJXp-mn" id="MJXp-Span-918">8</span></span></span><script type="math/tex" id="MathJax-Element-164">8</script> positions with one query. For example, if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-919"><span class="MJXp-msubsup" id="MJXp-Span-920"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-921" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-922" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-923" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-924"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-926" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-927" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-928" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-929">10000101</span><span class="MJXp-msubsup" id="MJXp-Span-930"><span class="MJXp-mo" id="MJXp-Span-931" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-932" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-165">f_0-f_1=(10000101)_2</script>, we can get <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-933"><span class="MJXp-msubsup" id="MJXp-Span-934"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-935" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-936" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-937" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-938"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-940" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-941" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-942"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-943" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-944" style="vertical-align: -0.4em;">8</span></span><span class="MJXp-msup" id="MJXp-Span-945"><span class="MJXp-mo" id="MJXp-Span-946" style="margin-left: 0.333em; margin-right: 0.05em;">=</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-947" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-msup" id="MJXp-Span-948"><span class="MJXp-mo" id="MJXp-Span-949" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-950" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-166">s_1=s_3=s_8=')'</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial (hard version)</b><div class="spoiler-content" style="display: block;"><p>Read the tutorial of the medium version first.</p><p>We can optimize</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-951"><span class="MJXp-munderover" id="MJXp-Span-952"><span class=""><span class="MJXp-mrow" id="MJXp-Span-953"><span class="MJXp-munderover" id="MJXp-Span-954"><span class=""><span class="MJXp-msubsup" id="MJXp-Span-955"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-956" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-957" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-958" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-959" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-960" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-961" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-962" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-963" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-964" style="margin-left: 0px; margin-right: 0em;">⏟</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-965" style="margin-left: 0px;"><span class="MJXp-msubsup" id="MJXp-Span-966"><span class="MJXp-mn" id="MJXp-Span-967" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-968" style="vertical-align: 0.5em;">k</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-971">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973">s</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-167">\underbrace{s_i)()\ldots()}_{2^k pairs}</script></p><p>to</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-974"><span class="MJXp-munderover" id="MJXp-Span-975"><span class=""><span class="MJXp-mrow" id="MJXp-Span-976"><span class="MJXp-munderover" id="MJXp-Span-977"><span class=""><span class="MJXp-mo" id="MJXp-Span-978" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-979" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-980" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-981" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-982" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-983" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-984" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-985" style="margin-left: 0px; margin-right: 0em;">⏟</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-986" style="margin-left: 0px;"><span class="MJXp-msubsup" id="MJXp-Span-987"><span class="MJXp-mn" id="MJXp-Span-988" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-989" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-990">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-991" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-992">k</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-993">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-994">⌋</span></span></span><span class="MJXp-mo" id="MJXp-Span-995">−</span><span class="MJXp-mn" id="MJXp-Span-996">1</span><span class="MJXp-mtext" id="MJXp-Span-997">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1000">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002">s</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-168">\underbrace{()()\ldots()}_{2^{\lfloor \frac{k}{2} \rfloor}-1\ pairs}</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1003"><span class="MJXp-msubsup" id="MJXp-Span-1004"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1005" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1006" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1007" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-169">s_i)</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1008"><span class="MJXp-munderover" id="MJXp-Span-1009"><span class=""><span class="MJXp-mrow" id="MJXp-Span-1010"><span class="MJXp-munderover" id="MJXp-Span-1011"><span class=""><span class="MJXp-mo" id="MJXp-Span-1012" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1013" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1014" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1015" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1016" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1017" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1018" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1019" style="margin-left: 0px; margin-right: 0em;">⏟</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1020" style="margin-left: 0px;"><span class="MJXp-msubsup" id="MJXp-Span-1021"><span class="MJXp-mn" id="MJXp-Span-1022" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1023" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1024">⌈</span><span class="MJXp-mfrac" id="MJXp-Span-1025" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026">k</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1027">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1028">⌉</span></span></span><span class="MJXp-mo" id="MJXp-Span-1029">−</span><span class="MJXp-mn" id="MJXp-Span-1030">1</span><span class="MJXp-mtext" id="MJXp-Span-1031">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1035">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1036">s</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-170">\underbrace{()()\ldots()}_{2^{\lceil \frac{k}{2} \rceil}-1\ pairs}</script></p><p>With this optimization, we can determine <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1037"><span class="MJXp-mn" id="MJXp-Span-1038">12</span></span></span><script type="math/tex" id="MathJax-Element-171">12</script> locations in one query.</p><p>Another construction also works:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1039"><span class="MJXp-munderover" id="MJXp-Span-1040"><span class=""><span class="MJXp-mrow" id="MJXp-Span-1041"><span class="MJXp-munderover" id="MJXp-Span-1042"><span class=""><span class="MJXp-msubsup" id="MJXp-Span-1043"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1045" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1046" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1047"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1048" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1049" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1050" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1051" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-msubsup" id="MJXp-Span-1052"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1054" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1055" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1056" style="margin-left: 0px; margin-right: 0em;">⏟</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1057" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058">g</span><span class="MJXp-mo" id="MJXp-Span-1059">(</span><span class="MJXp-mn" id="MJXp-Span-1060">1</span><span class="MJXp-mo" id="MJXp-Span-1061">)</span><span class="MJXp-mtext" id="MJXp-Span-1062">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1066">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067">s</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-172">\underbrace{s_1)s_1)\ldots s_1)}_{g(1)\ pairs}</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1068"><span class="MJXp-mo" id="MJXp-Span-1069" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-173">)</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1070"><span class="MJXp-munderover" id="MJXp-Span-1071"><span class=""><span class="MJXp-mrow" id="MJXp-Span-1072"><span class="MJXp-munderover" id="MJXp-Span-1073"><span class=""><span class="MJXp-msubsup" id="MJXp-Span-1074"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1076" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1077" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1078"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1079" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1080" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1081" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1082" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-msubsup" id="MJXp-Span-1083"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1085" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1086" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1087" style="margin-left: 0px; margin-right: 0em;">⏟</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1088" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1089">g</span><span class="MJXp-mo" id="MJXp-Span-1090">(</span><span class="MJXp-mn" id="MJXp-Span-1091">2</span><span class="MJXp-mo" id="MJXp-Span-1092">)</span><span class="MJXp-mtext" id="MJXp-Span-1093">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1095">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1096">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098">s</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-174">\underbrace{s_2)s_2)\ldots s_2)}_{g(2)\ pairs}</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1099"><span class="MJXp-mo" id="MJXp-Span-1100" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-175">)</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1101"><span class="MJXp-munderover" id="MJXp-Span-1102"><span class=""><span class="MJXp-mrow" id="MJXp-Span-1103"><span class="MJXp-munderover" id="MJXp-Span-1104"><span class=""><span class="MJXp-msubsup" id="MJXp-Span-1105"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1107" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1108" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1110" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1111" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1112" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1113" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-msubsup" id="MJXp-Span-1114"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1116" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1117" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1118" style="margin-left: 0px; margin-right: 0em;">⏟</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1119" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120">g</span><span class="MJXp-mo" id="MJXp-Span-1121">(</span><span class="MJXp-mn" id="MJXp-Span-1122">3</span><span class="MJXp-mo" id="MJXp-Span-1123">)</span><span class="MJXp-mtext" id="MJXp-Span-1124">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1126">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1127">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129">s</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-176">\underbrace{s_3)s_3)\ldots s_3)}_{g(3)\ pairs}</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1130"><span class="MJXp-mo" id="MJXp-Span-1131" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-177">)</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1132"><span class="MJXp-mo" id="MJXp-Span-1133" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex" id="MathJax-Element-178">\ldots</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1134"><span class="MJXp-munderover" id="MJXp-Span-1135"><span class=""><span class="MJXp-mrow" id="MJXp-Span-1136"><span class="MJXp-munderover" id="MJXp-Span-1137"><span class=""><span class="MJXp-msubsup" id="MJXp-Span-1138"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1139" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1140" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1141">12</span></span></span><span class="MJXp-mo" id="MJXp-Span-1142" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1143"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1145" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1146">12</span></span></span><span class="MJXp-mo" id="MJXp-Span-1147" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1148" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-msubsup" id="MJXp-Span-1149"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1150" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1151" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1152">12</span></span></span><span class="MJXp-mo" id="MJXp-Span-1153" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1154" style="margin-left: 0px; margin-right: 0em;">⏟</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1155" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1156">g</span><span class="MJXp-mo" id="MJXp-Span-1157">(</span><span class="MJXp-mn" id="MJXp-Span-1158">12</span><span class="MJXp-mo" id="MJXp-Span-1159">)</span><span class="MJXp-mtext" id="MJXp-Span-1160">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1161">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1164">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">s</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-179">\underbrace{s_{12})s_{12})\ldots s_{12})}_{g(12)\ pairs}</script></p><p>where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1166"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167">g</span><span class="MJXp-mo" id="MJXp-Span-1168" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1169">1</span><span class="MJXp-mo" id="MJXp-Span-1170" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1171" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1172">1</span></span></span><script type="math/tex" id="MathJax-Element-180">g(1)=1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1173"><span class="MJXp-mfrac" id="MJXp-Span-1174" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1175">g</span><span class="MJXp-mo" id="MJXp-Span-1176">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177">i</span><span class="MJXp-mo" id="MJXp-Span-1178">+</span><span class="MJXp-mn" id="MJXp-Span-1179">1</span><span class="MJXp-mo" id="MJXp-Span-1180">)</span><span class="MJXp-mo" id="MJXp-Span-1181">⋅</span><span class="MJXp-mo" id="MJXp-Span-1182">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1183">g</span><span class="MJXp-mo" id="MJXp-Span-1184">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1185">i</span><span class="MJXp-mo" id="MJXp-Span-1186">+</span><span class="MJXp-mn" id="MJXp-Span-1187">1</span><span class="MJXp-mo" id="MJXp-Span-1188">)</span><span class="MJXp-mo" id="MJXp-Span-1189">+</span><span class="MJXp-mn" id="MJXp-Span-1190">1</span><span class="MJXp-mo" id="MJXp-Span-1191">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1192">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1193" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mfrac" id="MJXp-Span-1194" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1195">g</span><span class="MJXp-mo" id="MJXp-Span-1196">(</span><span class="MJXp-mn" id="MJXp-Span-1197">1</span><span class="MJXp-mo" id="MJXp-Span-1198">)</span><span class="MJXp-mo" id="MJXp-Span-1199">⋅</span><span class="MJXp-mo" id="MJXp-Span-1200">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1201">g</span><span class="MJXp-mo" id="MJXp-Span-1202">(</span><span class="MJXp-mn" id="MJXp-Span-1203">1</span><span class="MJXp-mo" id="MJXp-Span-1204">)</span><span class="MJXp-mo" id="MJXp-Span-1205">+</span><span class="MJXp-mn" id="MJXp-Span-1206">1</span><span class="MJXp-mo" id="MJXp-Span-1207">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1208">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1209" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-1210" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1211">g</span><span class="MJXp-mo" id="MJXp-Span-1212">(</span><span class="MJXp-mn" id="MJXp-Span-1213">2</span><span class="MJXp-mo" id="MJXp-Span-1214">)</span><span class="MJXp-mo" id="MJXp-Span-1215">⋅</span><span class="MJXp-mo" id="MJXp-Span-1216">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217">g</span><span class="MJXp-mo" id="MJXp-Span-1218">(</span><span class="MJXp-mn" id="MJXp-Span-1219">2</span><span class="MJXp-mo" id="MJXp-Span-1220">)</span><span class="MJXp-mo" id="MJXp-Span-1221">+</span><span class="MJXp-mn" id="MJXp-Span-1222">1</span><span class="MJXp-mo" id="MJXp-Span-1223">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1224">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1225" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1226" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1227" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-1228" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1229">g</span><span class="MJXp-mo" id="MJXp-Span-1230">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1231">i</span><span class="MJXp-mo" id="MJXp-Span-1232">)</span><span class="MJXp-mo" id="MJXp-Span-1233">⋅</span><span class="MJXp-mo" id="MJXp-Span-1234">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1235">g</span><span class="MJXp-mo" id="MJXp-Span-1236">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237">i</span><span class="MJXp-mo" id="MJXp-Span-1238">)</span><span class="MJXp-mo" id="MJXp-Span-1239">+</span><span class="MJXp-mn" id="MJXp-Span-1240">1</span><span class="MJXp-mo" id="MJXp-Span-1241">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1242">2</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-181">\frac{g(i+1) \cdot (g(i+1)+1)}{2}>\frac{g(1) \cdot (g(1)+1)}{2}+\frac{g(2) \cdot (g(2)+1)}{2}+\ldots+\frac{g(i) \cdot (g(i)+1)}{2}</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">solution (easy version)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><br><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">       ll</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">double</span><span class="pln">     ld</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> pair</span><span class="pun">&lt;</span><span class="pln">ll</span><span class="pun">,</span><span class="pln"> ll</span><span class="pun">&gt;</span><span class="pln">   pll</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> pii</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> vector</span><span class="str">&lt;int&gt;</span><span class="pln"> vi</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> vector</span><span class="str">&lt;ll&gt;</span><span class="pln"> vll</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> kk </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1000</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ml </span><span class="pun">=</span><span class="pln"> kk </span><span class="pun">*</span><span class="pln"> kk</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> mod </span><span class="pun">=</span><span class="pln"> ml </span><span class="pun">*</span><span class="pln"> kk </span><span class="pun">+</span><span class="pln"> </span><span class="lit">7</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> inf </span><span class="pun">=</span><span class="pln"> ml </span><span class="pun">*</span><span class="pln"> ml </span><span class="pun">*</span><span class="pln"> ml </span><span class="pun">+</span><span class="pln"> </span><span class="lit">7</span><span class="pun">;</span><span class="pln">

</span><span class="com">#define</span><span class="pln"> T</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> i</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">get</span><span class="str">&lt;i&gt;</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> F first
</span><span class="com">#define</span><span class="pln"> S second
</span><span class="com">#define</span><span class="pln"> all</span><span class="pun">(</span><span class="pln">v</span><span class="pun">)</span><span class="pln"> v</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> v</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">()</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">forn</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">

</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">class</span><span class="pln"> T</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> U</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">inline</span><span class="pln"> istream</span><span class="pun">&amp;</span><span class="pln"> </span><span class="kwd">operator</span><span class="pun">&gt;&gt;(</span><span class="pln">istream</span><span class="pun">&amp;</span><span class="pln"> str</span><span class="pun">,</span><span class="pln"> pair</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">,</span><span class="pln"> U</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">p</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> str </span><span class="pun">&gt;&gt;</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">F </span><span class="pun">&gt;&gt;</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">S</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">class</span><span class="pln"> T</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> U</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">inline</span><span class="pln"> ostream</span><span class="pun">&amp;</span><span class="pln"> </span><span class="kwd">operator</span><span class="pun">&lt;&lt;(</span><span class="pln">ostream</span><span class="pun">&amp;</span><span class="pln"> str</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> pair</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">,</span><span class="pln"> U</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">p</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> str </span><span class="pun">&lt;&lt;</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">F </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">S </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> str</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">class</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">inline</span><span class="pln"> istream</span><span class="pun">&amp;</span><span class="pln"> </span><span class="kwd">operator</span><span class="pun">&gt;&gt;(</span><span class="pln">istream</span><span class="pun">&amp;</span><span class="pln"> str</span><span class="pun">,</span><span class="pln"> vector</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">a</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">i </span><span class="pun">:</span><span class="pln"> a</span><span class="pun">)</span><span class="pln"> str </span><span class="pun">&gt;&gt;</span><span class="pln"> i</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> str</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">class</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">inline</span><span class="pln"> ostream</span><span class="pun">&amp;</span><span class="pln"> </span><span class="kwd">operator</span><span class="pun">&lt;&lt;(</span><span class="pln">ostream</span><span class="pun">&amp;</span><span class="pln"> str</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> vector</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">a</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">i </span><span class="pun">:</span><span class="pln"> a</span><span class="pun">)</span><span class="pln"> str </span><span class="pun">&lt;&lt;</span><span class="pln"> i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> str</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> flush</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> cout </span><span class="pun">&lt;&lt;</span><span class="pln"> flush</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> flushln</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> cout </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">class</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> read</span><span class="pun">(</span><span class="pln">T </span><span class="pun">&amp;</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> x</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">class</span><span class="pln"> T</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="pun">...</span><span class="pln">U</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> read</span><span class="pun">(</span><span class="pln">T </span><span class="pun">&amp;</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> U</span><span class="pun">&amp;...</span><span class="pln"> u</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> read</span><span class="pun">(</span><span class="pln">x</span><span class="pun">);</span><span class="pln"> read</span><span class="pun">(</span><span class="pln">u</span><span class="pun">...);</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">class</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> T </span><span class="pun">&amp;</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> cout </span><span class="pun">&lt;&lt;</span><span class="pln"> x</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">class</span><span class="pln"> T</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="pun">...</span><span class="pln">U</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> T </span><span class="pun">&amp;</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> U</span><span class="pun">&amp;...</span><span class="pln"> u</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">x</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">u</span><span class="pun">...);</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">class</span><span class="pln"> </span><span class="pun">...</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> println</span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> T</span><span class="pun">&amp;...</span><span class="pln"> u</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">u</span><span class="pun">...,</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">);</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">class</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> eprint</span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> T </span><span class="pun">&amp;</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> cerr </span><span class="pun">&lt;&lt;</span><span class="pln"> x</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">class</span><span class="pln"> T</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="pun">...</span><span class="pln">U</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> eprint</span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> T </span><span class="pun">&amp;</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> U</span><span class="pun">&amp;...</span><span class="pln"> u</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> eprint</span><span class="pun">(</span><span class="pln">x</span><span class="pun">);</span><span class="pln"> eprint</span><span class="pun">(</span><span class="pln">u</span><span class="pun">...);</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">class</span><span class="pln"> </span><span class="pun">...</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> eprintln</span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> T</span><span class="pun">&amp;...</span><span class="pln"> u</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> eprint</span><span class="pun">(</span><span class="pln">u</span><span class="pun">...,</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">);</span><span class="pln"> </span><span class="pun">}</span><span class="pln">

</span><span class="com">#ifdef</span><span class="pln"> DEBUG
	mt19937 rng</span><span class="pun">(</span><span class="lit">1033</span><span class="pun">);</span><span class="pln">
	</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">var</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> cerr </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="com">#x &lt;&lt; ": " &lt;&lt; x &lt;&lt; '\n';</span><span class="pln">
	</span><span class="com">#define</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln"> b</span><span class="pun">)</span><span class="pln"> cerr </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="com">#a &lt;&lt; ", " &lt;&lt; #b &lt;&lt; ": "; for (auto _it = a; _it != b; ++_it) cerr &lt;&lt; *_it &lt;&lt; ' '; cerr &lt;&lt; '\n';</span><span class="pln">
</span><span class="com">#else</span><span class="pln">
	mt19937 rng</span><span class="pun">(</span><span class="pln">chrono</span><span class="pun">::</span><span class="pln">steady_clock</span><span class="pun">::</span><span class="pln">now</span><span class="pun">().</span><span class="pln">time_since_epoch</span><span class="pun">().</span><span class="pln">count</span><span class="pun">());</span><span class="pln">
	</span><span class="com">#define</span><span class="pln"> cerr </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">false</span><span class="pun">)</span><span class="pln"> cerr
	</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">var</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln">
	</span><span class="com">#define</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln"> b</span><span class="pun">)</span><span class="pln">
	</span><span class="com">#define</span><span class="pln"> eprintln </span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">)</span><span class="pln">eprintln
	</span><span class="com">#define</span><span class="pln"> eprint </span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">)</span><span class="pln">eprint
</span><span class="com">#endif</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> rnd</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> mod</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> uniform_int_distribution</span><span class="str">&lt;int&gt;</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> mod </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)(</span><span class="pln">rng</span><span class="pun">);</span><span class="pln"> </span><span class="pun">}</span><span class="pln">


</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">

map</span><span class="pun">&lt;</span><span class="pln">vector</span><span class="str">&lt;int&gt;</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> mem</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> ask</span><span class="pun">(</span><span class="pln">vector</span><span class="str">&lt;int&gt;</span><span class="pln"> ind</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">mem</span><span class="pun">.</span><span class="pln">count</span><span class="pun">(</span><span class="pln">ind</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"? "</span><span class="pun">;</span><span class="pln">
		cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ind</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> i </span><span class="pun">:</span><span class="pln"> ind</span><span class="pun">)</span><span class="pln">
			cout </span><span class="pun">&lt;&lt;</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">
		cout </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">

		</span><span class="kwd">int</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
		cin </span><span class="pun">&gt;&gt;</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
		mem</span><span class="pun">[</span><span class="pln">ind</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="kwd">return</span><span class="pln"> mem</span><span class="pun">[</span><span class="pln">ind</span><span class="pun">];</span><span class="pln">
</span><span class="pun">}</span><span class="pln">


</span><span class="kwd">bool</span><span class="pln"> same</span><span class="pun">(</span><span class="pln">vector</span><span class="str">&lt;int&gt;</span><span class="pln"> ind</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ask</span><span class="pun">(</span><span class="pln">ind</span><span class="pun">))</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
	ind</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">ind</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]);</span><span class="pln">
	ind</span><span class="pun">.</span><span class="pln">erase</span><span class="pun">(</span><span class="pln">ind</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">());</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ask</span><span class="pun">(</span><span class="pln">ind</span><span class="pun">))</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

pii search</span><span class="pun">(</span><span class="pln">vector</span><span class="str">&lt;int&gt;</span><span class="pln"> ind</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ind</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ask</span><span class="pun">(</span><span class="pln">ind</span><span class="pun">))</span><span class="pln">
			</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">ind</span><span class="pun">[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> ind</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]};</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">ind</span><span class="pun">[</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> ind</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]};</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	vector</span><span class="str">&lt;int&gt;</span><span class="pln"> inda</span><span class="pun">,</span><span class="pln"> indb</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> sz </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ind</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> sz</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		inda</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">ind</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
		indb</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">ind</span><span class="pun">[</span><span class="pln">ind</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> i</span><span class="pun">]);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">same</span><span class="pun">(</span><span class="pln">inda</span><span class="pun">))</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> search</span><span class="pun">(</span><span class="pln">inda</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">same</span><span class="pun">(</span><span class="pln">indb</span><span class="pun">))</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> search</span><span class="pun">(</span><span class="pln">indb</span><span class="pun">);</span><span class="pln">
	inda</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">indb</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]);</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> search</span><span class="pun">(</span><span class="pln">inda</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

pii find_reg2</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	vector</span><span class="str">&lt;int&gt;</span><span class="pln"> ind</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
	iota</span><span class="pun">(</span><span class="pln">all</span><span class="pun">(</span><span class="pln">ind</span><span class="pun">),</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	shuffle</span><span class="pun">(</span><span class="pln">all</span><span class="pun">(</span><span class="pln">ind</span><span class="pun">),</span><span class="pln"> rng</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> search</span><span class="pun">(</span><span class="pln">ind</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	mem</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">po</span><span class="pun">,</span><span class="pln"> pc</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> find_reg2</span><span class="pun">();</span><span class="pln">

	vector</span><span class="str">&lt;int&gt;</span><span class="pln"> to_ask</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
	iota</span><span class="pun">(</span><span class="pln">all</span><span class="pun">(</span><span class="pln">to_ask</span><span class="pun">),</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">to_ask</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
		to_ask</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">


	</span><span class="kwd">string</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">string</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="str">'.'</span><span class="pun">);</span><span class="pln">
	ans</span><span class="pun">[</span><span class="pln">po</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">'('</span><span class="pun">;</span><span class="pln">
	ans</span><span class="pun">[</span><span class="pln">pc</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">')'</span><span class="pun">;</span><span class="pln">
		
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> to_ask</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln"> i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> a </span><span class="pun">=</span><span class="pln"> to_ask</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> b </span><span class="pun">=</span><span class="pln"> to_ask</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">

		vector</span><span class="str">&lt;int&gt;</span><span class="pln"> q </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">po</span><span class="pun">,</span><span class="pln"> pc</span><span class="pun">,</span><span class="pln"> po</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">,</span><span class="pln"> b</span><span class="pun">,</span><span class="pln"> pc</span><span class="pun">};</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> ask</span><span class="pun">(</span><span class="pln">q</span><span class="pun">);</span><span class="pln">

		</span><span class="com">// ()(ab) - x ab</span><span class="pln">
		</span><span class="com">// ()(()) - 4 ()</span><span class="pln">
		</span><span class="com">// ()((() - 2 ((</span><span class="pln">
		</span><span class="com">// ()())) - 3 ))</span><span class="pln">
		</span><span class="com">// ()()() - 6 )(</span><span class="pln">
		map</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> pair</span><span class="pun">&lt;</span><span class="kwd">char</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">&gt;&gt;</span><span class="pln"> results </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			</span><span class="pun">{</span><span class="lit">4</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="str">'('</span><span class="pun">,</span><span class="pln"> </span><span class="str">')'</span><span class="pun">}},</span><span class="pln">
			</span><span class="pun">{</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="str">'('</span><span class="pun">,</span><span class="pln"> </span><span class="str">'('</span><span class="pun">}},</span><span class="pln">
			</span><span class="pun">{</span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="str">')'</span><span class="pun">,</span><span class="pln"> </span><span class="str">')'</span><span class="pun">}},</span><span class="pln">
			</span><span class="pun">{</span><span class="lit">6</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="str">')'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'('</span><span class="pun">}},</span><span class="pln">
		</span><span class="pun">};</span><span class="pln">

		</span><span class="kwd">assert</span><span class="pun">(</span><span class="pln">results</span><span class="pun">.</span><span class="pln">count</span><span class="pun">(</span><span class="pln">res</span><span class="pun">));</span><span class="pln">
		</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">resa</span><span class="pun">,</span><span class="pln"> resb</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> results</span><span class="pun">[</span><span class="pln">res</span><span class="pun">];</span><span class="pln">
		ans</span><span class="pun">[</span><span class="pln">a</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> resa</span><span class="pun">;</span><span class="pln">
		ans</span><span class="pun">[</span><span class="pln">b</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> resb</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"! "</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> ans </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="com">#ifdef</span><span class="pln"> DEBUG
	</span><span class="com">// freopen("input.txt", "r", stdin);</span><span class="pln">
	</span><span class="com">// freopen("output.txt", "w", stdout);</span><span class="pln">
	</span><span class="com">#endif</span><span class="pln">
	ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"> cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="kwd">fixed</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> setprecision</span><span class="pun">(</span><span class="lit">20</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> t </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
		solve</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="com">#ifdef</span><span class="pln"> DEBUG
		cerr </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"Runtime is: "</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> clock</span><span class="pun">()</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">1.0</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> CLOCKS_PER_SEC </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
	</span><span class="com">#endif</span><span class="pln">
</span><span class="pun">}</span><span class="pln">


</span><span class="com">/*


()(ab)
()(()) - 4 ()
()((() - 2 ((
()())) - 3 ))
()()() - 6 )(

2
3
)((
2
()


*/</span><span class="pln">



</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">solution (medium version)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><br><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;vector&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;list&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;map&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;set&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;deque&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;vector&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;list&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;map&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;set&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;deque&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;queue&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;stack&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;bitset&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;algorithm&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;functional&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;numeric&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;utility&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;sstream&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;iostream&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;iomanip&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstdio&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cmath&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstdlib&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cctype&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;string&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstring&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;ctime&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;random&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;chrono&gt;</span><span class="pln">
 
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="com">#define</span><span class="pln"> _int64 </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> mo </span><span class="lit">998244353</span><span class="pln">

</span><span class="kwd">char</span><span class="pln"> tar</span><span class="pun">[</span><span class="lit">110000</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> cnt</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> doask</span><span class="pun">(</span><span class="pln">vector</span><span class="str">&lt;int&gt;</span><span class="pun">&amp;</span><span class="pln"> a</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">,</span><span class="pln">ret</span><span class="pun">;</span><span class="pln">
	</span><span class="com">/*
	{
		int v,tmp,j;
		string ss;
		cnt++;
		ss="";
		for (i=0;i&lt;a.size();i++)
		{
			ss.push_back(tar[a[i]]);
		}
		tmp=0;
		for (i=0;i&lt;ss.length();i++)
		{
			v=0;
			for (j=i;j&lt;ss.length();j++)
			{
				if (ss[j]=='(') v++;
				else v--;
				if (v&lt;0) break;
				if (v==0) tmp++;
			}
		}
		return tmp;
	}
	*/</span><span class="pln">
	
	printf</span><span class="pun">(</span><span class="str">"? %d"</span><span class="pun">,(</span><span class="kwd">int</span><span class="pun">)</span><span class="pln">a</span><span class="pun">.</span><span class="pln">size</span><span class="pun">());</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">a</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">" %d"</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
	printf</span><span class="pun">(</span><span class="str">"\n"</span><span class="pun">);</span><span class="pln">
	fflush</span><span class="pun">(</span><span class="pln">stdout</span><span class="pun">);</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,&amp;</span><span class="pln">ret</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> ret</span><span class="pun">;</span><span class="pln">
	
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">char</span><span class="pln"> ans</span><span class="pun">[</span><span class="lit">1100</span><span class="pun">];</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> doanswer</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	printf</span><span class="pun">(</span><span class="str">"! %s\n"</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">);</span><span class="pln">
	cerr</span><span class="pun">&lt;&lt;</span><span class="str">"T "</span><span class="pun">&lt;&lt;</span><span class="pln">tar</span><span class="pun">&lt;&lt;</span><span class="pln">endl</span><span class="pun">;</span><span class="pln">
	cerr</span><span class="pun">&lt;&lt;</span><span class="str">"cnt:"</span><span class="pun">&lt;&lt;</span><span class="pln">cnt</span><span class="pun">&lt;&lt;</span><span class="pln">endl</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">string</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">)==</span><span class="kwd">string</span><span class="pun">(</span><span class="pln">tar</span><span class="pun">))</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		cerr</span><span class="pun">&lt;&lt;</span><span class="str">"good"</span><span class="pun">&lt;&lt;</span><span class="pln">endl</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">else</span><span class="pln"> cerr</span><span class="pun">&lt;&lt;</span><span class="str">"bad"</span><span class="pun">&lt;&lt;</span><span class="pln">endl</span><span class="pun">;</span><span class="pln">
	fflush</span><span class="pun">(</span><span class="pln">stdout</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">,</span><span class="pln">j</span><span class="pun">,</span><span class="pln">k</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="pln">l</span><span class="pun">,</span><span class="pln">t</span><span class="pun">,</span><span class="pln">m</span><span class="pun">,</span><span class="pln">x</span><span class="pun">,</span><span class="pln">y</span><span class="pun">,</span><span class="pln">o</span><span class="pun">,</span><span class="pln">b1</span><span class="pun">,</span><span class="pln">indl</span><span class="pun">,</span><span class="pln">indr</span><span class="pun">,</span><span class="pln">ll</span><span class="pun">,</span><span class="pln">rr</span><span class="pun">,</span><span class="pln">mid</span><span class="pun">,</span><span class="pln">tmp</span><span class="pun">,</span><span class="pln">v</span><span class="pun">,</span><span class="pln">st</span><span class="pun">;</span><span class="pln">
	vector</span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">;</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,&amp;</span><span class="pln">t</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">l</span><span class="pun">&lt;</span><span class="pln">t</span><span class="pun">;</span><span class="pln">l</span><span class="pun">++)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,&amp;</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			x</span><span class="pun">=</span><span class="pln">rand</span><span class="pun">()%</span><span class="lit">2</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">==</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> tar</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="str">'('</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">else</span><span class="pln"> tar</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="str">')'</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		tar</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]=</span><span class="str">'\0'</span><span class="pun">;</span><span class="pln">
		cnt</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		st</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]=</span><span class="str">'\0'</span><span class="pun">;</span><span class="pln">
		indl</span><span class="pun">=-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		indr</span><span class="pun">=-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="com">// while (st&lt;n)</span><span class="pln">
		</span><span class="com">// {</span><span class="pln">
			ll</span><span class="pun">=</span><span class="pln">st</span><span class="pun">;</span><span class="pln">rr</span><span class="pun">=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">rr</span><span class="pun">-</span><span class="pln">ll</span><span class="pun">&gt;</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				mid</span><span class="pun">=(</span><span class="pln">ll</span><span class="pun">+</span><span class="pln">rr</span><span class="pun">)/</span><span class="lit">2</span><span class="pun">;</span><span class="pln">
				a</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
				</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="pln">st</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">mid</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
					a</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
				tmp</span><span class="pun">=</span><span class="pln">doask</span><span class="pun">(</span><span class="pln">a</span><span class="pun">);</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tmp</span><span class="pun">==</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> ll</span><span class="pun">=</span><span class="pln">mid</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">else</span><span class="pln"> rr</span><span class="pun">=</span><span class="pln">mid</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">rr</span><span class="pun">==</span><span class="pln">n</span><span class="pun">)</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				indr</span><span class="pun">=</span><span class="pln">st</span><span class="pun">;</span><span class="pln">
				</span><span class="com">/*
				if ((indl==-1)&amp;&amp;(indr==-1))
				{
					indr=st;
				}
				ll=st-1;rr=n;
				while (rr-ll&gt;1)
				{
					mid=(ll+rr)/2;
					a.clear();
					a.push_back(mid);
					a.push_back(indr);
					tmp=doask(a);
					if (tmp==0) ll=mid;
					else rr=mid;
				}
				for (i=st;i&lt;=ll;i++)
					ans[i]=')';
				for (i=rr;i&lt;n;i++)
					ans[i]='(';
				st=n;
				break;
				*/</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">else</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				indr</span><span class="pun">=</span><span class="pln">rr</span><span class="pun">;</span><span class="pln">
				</span><span class="com">/*
				v=rr;
				ans[v]=')';
				ll=st-1;rr=v-1;
				while (rr-ll&gt;1)
				{
					mid=(ll+rr)/2;
					a.clear();
					a.push_back(mid);
					a.push_back(v);
					tmp=doask(a);
					if (tmp==0) ll=mid;
					else rr=mid;
				}
				for (i=st;i&lt;=ll;i++)
					ans[i]=')';
				for (i=rr;i&lt;v;i++)
					ans[i]='(';
				st=v+1;
				indl=v-1;
				indr=v;
				*/</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="com">// }</span><span class="pln">
		</span><span class="com">//cerr&lt;&lt;"indr:"&lt;&lt;indr&lt;&lt;endl;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">+=</span><span class="lit">8</span><span class="pun">)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			a</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;</span><span class="lit">8</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i</span><span class="pun">+</span><span class="pln">j</span><span class="pun">&gt;=</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">k</span><span class="pun">&lt;(</span><span class="lit">1</span><span class="pun">&lt;&lt;</span><span class="pln">j</span><span class="pun">);</span><span class="pln">k</span><span class="pun">++)</span><span class="pln">
				</span><span class="pun">{</span><span class="pln">
					a</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">+</span><span class="pln">j</span><span class="pun">);</span><span class="pln">
					a</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">indr</span><span class="pun">);</span><span class="pln">
					a</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">indr</span><span class="pun">);</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			tmp</span><span class="pun">=</span><span class="pln">doask</span><span class="pun">(</span><span class="pln">a</span><span class="pun">);</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;</span><span class="lit">8</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i</span><span class="pun">+</span><span class="pln">j</span><span class="pun">&gt;=</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(((</span><span class="lit">1</span><span class="pun">&lt;&lt;</span><span class="pln">j</span><span class="pun">)&amp;</span><span class="pln">tmp</span><span class="pun">)!=</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="pln">j</span><span class="pun">]=</span><span class="str">'('</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">else</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="pln">j</span><span class="pun">]=</span><span class="str">')'</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">

		doanswer</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">solution (hard version)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><br><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;vector&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;list&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;map&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;set&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;deque&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;vector&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;list&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;map&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;set&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;deque&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;queue&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;stack&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;bitset&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;algorithm&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;functional&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;numeric&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;utility&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;sstream&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;iostream&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;iomanip&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstdio&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cmath&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstdlib&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cctype&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;string&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstring&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;ctime&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;random&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;chrono&gt;</span><span class="pln">
 
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="com">#define</span><span class="pln"> _int64 </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> mo </span><span class="lit">998244353</span><span class="pln">

</span><span class="kwd">char</span><span class="pln"> tar</span><span class="pun">[</span><span class="lit">110000</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> cnt</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> doask</span><span class="pun">(</span><span class="pln">vector</span><span class="str">&lt;int&gt;</span><span class="pun">&amp;</span><span class="pln"> a</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">,</span><span class="pln">ret</span><span class="pun">;</span><span class="pln">
	</span><span class="com">/*
	{
		int v,tmp,j;
		string ss;
		cnt++;
		ss="";
		for (i=0;i&lt;a.size();i++)
		{
			ss.push_back(tar[a[i]]);
		}
		tmp=0;
		for (i=0;i&lt;ss.length();i++)
		{
			v=0;
			for (j=i;j&lt;ss.length();j++)
			{
				if (ss[j]=='(') v++;
				else v--;
				if (v&lt;0) break;
				if (v==0) tmp++;
			}
		}
		return tmp;
	}
	*/</span><span class="pln">
	
	printf</span><span class="pun">(</span><span class="str">"? %d"</span><span class="pun">,(</span><span class="kwd">int</span><span class="pun">)</span><span class="pln">a</span><span class="pun">.</span><span class="pln">size</span><span class="pun">());</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">a</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">" %d"</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
	printf</span><span class="pun">(</span><span class="str">"\n"</span><span class="pun">);</span><span class="pln">
	fflush</span><span class="pun">(</span><span class="pln">stdout</span><span class="pun">);</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,&amp;</span><span class="pln">ret</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> ret</span><span class="pun">;</span><span class="pln">
	
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">char</span><span class="pln"> ans</span><span class="pun">[</span><span class="lit">1100</span><span class="pun">];</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> doanswer</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	printf</span><span class="pun">(</span><span class="str">"! %s\n"</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">);</span><span class="pln">
	cerr</span><span class="pun">&lt;&lt;</span><span class="str">"T "</span><span class="pun">&lt;&lt;</span><span class="pln">tar</span><span class="pun">&lt;&lt;</span><span class="pln">endl</span><span class="pun">;</span><span class="pln">
	cerr</span><span class="pun">&lt;&lt;</span><span class="str">"cnt:"</span><span class="pun">&lt;&lt;</span><span class="pln">cnt</span><span class="pun">&lt;&lt;</span><span class="pln">endl</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">string</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">)==</span><span class="kwd">string</span><span class="pun">(</span><span class="pln">tar</span><span class="pun">))</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		cerr</span><span class="pun">&lt;&lt;</span><span class="str">"good"</span><span class="pun">&lt;&lt;</span><span class="pln">endl</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">else</span><span class="pln"> cerr</span><span class="pun">&lt;&lt;</span><span class="str">"bad"</span><span class="pun">&lt;&lt;</span><span class="pln">endl</span><span class="pun">;</span><span class="pln">
	fflush</span><span class="pun">(</span><span class="pln">stdout</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">,</span><span class="pln">j</span><span class="pun">,</span><span class="pln">k</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="pln">l</span><span class="pun">,</span><span class="pln">t</span><span class="pun">,</span><span class="pln">m</span><span class="pun">,</span><span class="pln">x</span><span class="pun">,</span><span class="pln">y</span><span class="pun">,</span><span class="pln">o</span><span class="pun">,</span><span class="pln">b1</span><span class="pun">,</span><span class="pln">indl</span><span class="pun">,</span><span class="pln">indr</span><span class="pun">,</span><span class="pln">ll</span><span class="pun">,</span><span class="pln">rr</span><span class="pun">,</span><span class="pln">mid</span><span class="pun">,</span><span class="pln">tmp</span><span class="pun">,</span><span class="pln">v</span><span class="pun">,</span><span class="pln">st</span><span class="pun">,</span><span class="pln">sum</span><span class="pun">,</span><span class="pln">len</span><span class="pun">;</span><span class="pln">
	vector</span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">;</span><span class="pln">
	vector</span><span class="str">&lt;int&gt;</span><span class="pln"> p</span><span class="pun">;</span><span class="pln">
	sum</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">len</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="lit">130</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		tmp</span><span class="pun">=</span><span class="pln">i</span><span class="pun">*(</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)/</span><span class="lit">2</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tmp</span><span class="pun">&gt;</span><span class="pln">sum</span><span class="pun">)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			p</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
			</span><span class="com">//cerr&lt;&lt;"i:"&lt;&lt;i&lt;&lt;endl;</span><span class="pln">
			sum</span><span class="pun">+=</span><span class="pln">tmp</span><span class="pun">;</span><span class="pln">
			len</span><span class="pun">+=</span><span class="pln">i</span><span class="pun">+</span><span class="pln">i</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="com">//cerr&lt;&lt;"p.sz:"&lt;&lt;p.size()&lt;&lt;" "&lt;&lt;len&lt;&lt;endl;</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,&amp;</span><span class="pln">t</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">l</span><span class="pun">&lt;</span><span class="pln">t</span><span class="pun">;</span><span class="pln">l</span><span class="pun">++)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,&amp;</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			x</span><span class="pun">=</span><span class="pln">rand</span><span class="pun">()%</span><span class="lit">2</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x</span><span class="pun">==</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> tar</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="str">'('</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">else</span><span class="pln"> tar</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="str">')'</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		tar</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]=</span><span class="str">'\0'</span><span class="pun">;</span><span class="pln">
		cnt</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		st</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]=</span><span class="str">'\0'</span><span class="pun">;</span><span class="pln">
		indl</span><span class="pun">=-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		indr</span><span class="pun">=-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="com">// while (st&lt;n)</span><span class="pln">
		</span><span class="com">// {</span><span class="pln">
			ll</span><span class="pun">=</span><span class="pln">st</span><span class="pun">;</span><span class="pln">rr</span><span class="pun">=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">rr</span><span class="pun">-</span><span class="pln">ll</span><span class="pun">&gt;</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				mid</span><span class="pun">=(</span><span class="pln">ll</span><span class="pun">+</span><span class="pln">rr</span><span class="pun">)/</span><span class="lit">2</span><span class="pun">;</span><span class="pln">
				a</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
				</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="pln">st</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">mid</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
					a</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
				tmp</span><span class="pun">=</span><span class="pln">doask</span><span class="pun">(</span><span class="pln">a</span><span class="pun">);</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tmp</span><span class="pun">==</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> ll</span><span class="pun">=</span><span class="pln">mid</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">else</span><span class="pln"> rr</span><span class="pun">=</span><span class="pln">mid</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">rr</span><span class="pun">==</span><span class="pln">n</span><span class="pun">)</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				indr</span><span class="pun">=</span><span class="pln">st</span><span class="pun">;</span><span class="pln">
				</span><span class="com">/*
				if ((indl==-1)&amp;&amp;(indr==-1))
				{
					indr=st;
				}
				ll=st-1;rr=n;
				while (rr-ll&gt;1)
				{
					mid=(ll+rr)/2;
					a.clear();
					a.push_back(mid);
					a.push_back(indr);
					tmp=doask(a);
					if (tmp==0) ll=mid;
					else rr=mid;
				}
				for (i=st;i&lt;=ll;i++)
					ans[i]=')';
				for (i=rr;i&lt;n;i++)
					ans[i]='(';
				st=n;
				break;
				*/</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">else</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				indr</span><span class="pun">=</span><span class="pln">rr</span><span class="pun">;</span><span class="pln">
				</span><span class="com">/*
				v=rr;
				ans[v]=')';
				ll=st-1;rr=v-1;
				while (rr-ll&gt;1)
				{
					mid=(ll+rr)/2;
					a.clear();
					a.push_back(mid);
					a.push_back(v);
					tmp=doask(a);
					if (tmp==0) ll=mid;
					else rr=mid;
				}
				for (i=st;i&lt;=ll;i++)
					ans[i]=')';
				for (i=rr;i&lt;v;i++)
					ans[i]='(';
				st=v+1;
				indl=v-1;
				indr=v;
				*/</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="com">// }</span><span class="pln">
		</span><span class="com">//cerr&lt;&lt;"indr:"&lt;&lt;indr&lt;&lt;endl;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">+=</span><span class="pln">p</span><span class="pun">.</span><span class="pln">size</span><span class="pun">())</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			a</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;</span><span class="pln">p</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i</span><span class="pun">+</span><span class="pln">j</span><span class="pun">&gt;=</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">k</span><span class="pun">&lt;</span><span class="pln">p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">];</span><span class="pln">k</span><span class="pun">++)</span><span class="pln">
				</span><span class="pun">{</span><span class="pln">
					a</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">+</span><span class="pln">j</span><span class="pun">);</span><span class="pln">
					a</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">indr</span><span class="pun">);</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				a</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">indr</span><span class="pun">);</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			tmp</span><span class="pun">=</span><span class="pln">doask</span><span class="pun">(</span><span class="pln">a</span><span class="pun">);</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j</span><span class="pun">=</span><span class="pln">p</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&gt;=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j</span><span class="pun">--)</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i</span><span class="pun">+</span><span class="pln">j</span><span class="pun">&gt;=</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
				v</span><span class="pun">=</span><span class="pln">p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]*(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]+</span><span class="lit">1</span><span class="pun">)/</span><span class="lit">2</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tmp</span><span class="pun">&gt;=</span><span class="pln">v</span><span class="pun">)</span><span class="pln">
				</span><span class="pun">{</span><span class="pln">
					tmp</span><span class="pun">-=</span><span class="pln">v</span><span class="pun">;</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="pln">j</span><span class="pun">]=</span><span class="str">'('</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">else</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="pln">j</span><span class="pun">]=</span><span class="str">')'</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">

		doanswer</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate the Problem</b><div class="spoiler-content" style="display: block;"><p>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11079">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="350">350</span>
            </i>
        </a>
    </span>


</p><p>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11080">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="16">16</span>
            </i>
        </a>
    </span>


</p><p>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11081">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="3">3</span>
            </i>
        </a>
    </span>


</p><p>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11082">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="46">46</span>
            </i>
        </a>
    </span>


</p><p>Didn't solve: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11083">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="17">17</span>
            </i>
        </a>
    </span>


</p></div></div><h4><a href="https://codeforces.com/contest/2129/problem/D">D1D Permutation Blackhole</a></h4> <div class="spoiler"><b class="spoiler-title">Hint1</b><div class="spoiler-content" style="display: block;"><p>Consider enumerating <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1243"><span class="MJXp-msubsup" id="MJXp-Span-1244"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1246" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1247" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1248">1</span></span></span><script type="math/tex" id="MathJax-Element-182">p_i = 1</script>. After that, will the cells to the left of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1249"><span class="MJXp-msubsup" id="MJXp-Span-1250"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1251" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1252" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-183">p_i</script> affect the cells to the right of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1253"><span class="MJXp-msubsup" id="MJXp-Span-1254"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1255" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1256" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-184">p_i</script>?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint2</b><div class="spoiler-content" style="display: block;"><p>Consider range DP.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint3</b><div class="spoiler-content" style="display: block;"><p>Can you find the upper bound of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1257"><span class="MJXp-msubsup" id="MJXp-Span-1258"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1259" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1260" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-185">s_i</script>?</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><p>Consider range DP.</p><p>Note <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1261"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1262">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263">p</span><span class="MJXp-mo" id="MJXp-Span-1264" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">l</span><span class="MJXp-mo" id="MJXp-Span-1266" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1267" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1268">r</span><span class="MJXp-mo" id="MJXp-Span-1269" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1270" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271">x</span><span class="MJXp-mo" id="MJXp-Span-1272" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1273" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1274">y</span><span class="MJXp-mo" id="MJXp-Span-1275" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-186">dp[l][r][x][y]</script> as the number of scheme ensureing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1276"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277">s</span><span class="MJXp-mo" id="MJXp-Span-1278" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279">l</span><span class="MJXp-mo" id="MJXp-Span-1280" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1281">1</span><span class="MJXp-mo" id="MJXp-Span-1282" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1283" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1284" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1285">x</span></span></span><script type="math/tex" id="MathJax-Element-187">s[l-1]+=x</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1286"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1287">s</span><span class="MJXp-mo" id="MJXp-Span-1288" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1289">r</span><span class="MJXp-mo" id="MJXp-Span-1290" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1291">1</span><span class="MJXp-mo" id="MJXp-Span-1292" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1293" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1294" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1295">y</span></span></span><script type="math/tex" id="MathJax-Element-188">s[r+1]+=y</script>.</p><p>Transform:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1296"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1298">p</span><span class="MJXp-mo" id="MJXp-Span-1299" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">l</span><span class="MJXp-mo" id="MJXp-Span-1301" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1302" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1303">r</span><span class="MJXp-mo" id="MJXp-Span-1304" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1305" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1306">x</span><span class="MJXp-mo" id="MJXp-Span-1307" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1308" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1309">y</span><span class="MJXp-mo" id="MJXp-Span-1310" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1311" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1312"><span class="MJXp-mo" id="MJXp-Span-1313" style="margin-left: 0em; margin-right: 0em; vertical-align: -2.861em;"><span class="MJXp-right MJXp-scale2" style="font-size: 12.444em; margin-left: -0.394em;">{</span></span><span class="MJXp-mtable" id="MJXp-Span-1314"><span><span class="MJXp-mtr" id="MJXp-Span-1315" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1316" style="text-align: left;"><span class="MJXp-msubsup" id="MJXp-Span-1317"><span class="MJXp-mi" id="MJXp-Span-1318" style="margin-right: 0.05em;">Σ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1319" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1320">i is nearer to l</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1321"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1322"><span class="MJXp-mstyle" id="MJXp-Span-1323"><span class="MJXp-mrow" id="MJXp-Span-1324"><span class="MJXp-mo" id="MJXp-Span-1325" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1326"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1327">r</span><span class="MJXp-mo" id="MJXp-Span-1328">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1329">l</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330">i</span><span class="MJXp-mo" id="MJXp-Span-1331">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332">l</span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1333"><span class="MJXp-mstyle" id="MJXp-Span-1334"><span class="MJXp-mrow" id="MJXp-Span-1335"><span class="MJXp-mo" id="MJXp-Span-1336" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1337" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1339">p</span><span class="MJXp-mo" id="MJXp-Span-1340" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341">l</span><span class="MJXp-mo" id="MJXp-Span-1342" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1343" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1344">i</span><span class="MJXp-mo" id="MJXp-Span-1345" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1346">1</span><span class="MJXp-mo" id="MJXp-Span-1347" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1348" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1349">x</span><span class="MJXp-mo" id="MJXp-Span-1350" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1351">1</span><span class="MJXp-mo" id="MJXp-Span-1352" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1353" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1354">j</span><span class="MJXp-mo" id="MJXp-Span-1355" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1356" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1357">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1358">p</span><span class="MJXp-mo" id="MJXp-Span-1359" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1360">i</span><span class="MJXp-mo" id="MJXp-Span-1361" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1362">1</span><span class="MJXp-mo" id="MJXp-Span-1363" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1364" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1365">r</span><span class="MJXp-mo" id="MJXp-Span-1366" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1367" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1368">k</span><span class="MJXp-mo" id="MJXp-Span-1369" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1370" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1371">y</span><span class="MJXp-mo" id="MJXp-Span-1372" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MJXp-mtr" id="MJXp-Span-1373" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1374" style="padding-top: 0.4em; text-align: left;"><span class="MJXp-mo" id="MJXp-Span-1375" style="margin-left: 0em; margin-right: 0.111em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1376"><span class="MJXp-mi" id="MJXp-Span-1377" style="margin-right: 0.05em;">Σ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1378" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1379">i is nearer to r</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1380"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1381"><span class="MJXp-mstyle" id="MJXp-Span-1382"><span class="MJXp-mrow" id="MJXp-Span-1383"><span class="MJXp-mo" id="MJXp-Span-1384" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1385"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1386">r</span><span class="MJXp-mo" id="MJXp-Span-1387">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1388">l</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389">i</span><span class="MJXp-mo" id="MJXp-Span-1390">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1391">l</span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1392"><span class="MJXp-mstyle" id="MJXp-Span-1393"><span class="MJXp-mrow" id="MJXp-Span-1394"><span class="MJXp-mo" id="MJXp-Span-1395" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1396" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1397">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398">p</span><span class="MJXp-mo" id="MJXp-Span-1399" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1400">l</span><span class="MJXp-mo" id="MJXp-Span-1401" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1402" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1403">i</span><span class="MJXp-mo" id="MJXp-Span-1404" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1405">1</span><span class="MJXp-mo" id="MJXp-Span-1406" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1407" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1408">x</span><span class="MJXp-mo" id="MJXp-Span-1409" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1410" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1411">j</span><span class="MJXp-mo" id="MJXp-Span-1412" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1413" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1415">p</span><span class="MJXp-mo" id="MJXp-Span-1416" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1417">i</span><span class="MJXp-mo" id="MJXp-Span-1418" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1419">1</span><span class="MJXp-mo" id="MJXp-Span-1420" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1421" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1422">r</span><span class="MJXp-mo" id="MJXp-Span-1423" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1424" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1425">k</span><span class="MJXp-mo" id="MJXp-Span-1426" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1427" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1428">y</span><span class="MJXp-mo" id="MJXp-Span-1429" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1430">1</span><span class="MJXp-mo" id="MJXp-Span-1431" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mtext" id="MJXp-Span-1432">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-1433" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1435" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1436" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1437" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1438" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1439">1</span><span class="MJXp-mo" id="MJXp-Span-1440" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mtr" id="MJXp-Span-1441" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1442" style="padding-top: 0.4em; text-align: left;"><span class="MJXp-msubsup" id="MJXp-Span-1443"><span class="MJXp-mi" id="MJXp-Span-1444" style="margin-right: 0.05em;">Σ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1445" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1446">i is nearer to l</span><span class="MJXp-mo" id="MJXp-Span-1447">,</span><span class="MJXp-mtext" id="MJXp-Span-1448">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1449">j</span><span class="MJXp-mo" id="MJXp-Span-1450">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451">k</span><span class="MJXp-mo" id="MJXp-Span-1452">=</span><span class="MJXp-msubsup" id="MJXp-Span-1453"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1454" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1455" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1456"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1457"><span class="MJXp-mstyle" id="MJXp-Span-1458"><span class="MJXp-mrow" id="MJXp-Span-1459"><span class="MJXp-mo" id="MJXp-Span-1460" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1461"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1462">r</span><span class="MJXp-mo" id="MJXp-Span-1463">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464">l</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465">i</span><span class="MJXp-mo" id="MJXp-Span-1466">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1467">l</span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1468"><span class="MJXp-mstyle" id="MJXp-Span-1469"><span class="MJXp-mrow" id="MJXp-Span-1470"><span class="MJXp-mo" id="MJXp-Span-1471" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1472" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1473">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474">p</span><span class="MJXp-mo" id="MJXp-Span-1475" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1476">l</span><span class="MJXp-mo" id="MJXp-Span-1477" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1478" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1479">i</span><span class="MJXp-mo" id="MJXp-Span-1480" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1481">1</span><span class="MJXp-mo" id="MJXp-Span-1482" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1483" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1484">x</span><span class="MJXp-mo" id="MJXp-Span-1485" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1486">1</span><span class="MJXp-mo" id="MJXp-Span-1487" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1488" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1489">j</span><span class="MJXp-mo" id="MJXp-Span-1490" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1491" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1492">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1493">p</span><span class="MJXp-mo" id="MJXp-Span-1494" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1495">i</span><span class="MJXp-mo" id="MJXp-Span-1496" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1497">1</span><span class="MJXp-mo" id="MJXp-Span-1498" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1499" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500">r</span><span class="MJXp-mo" id="MJXp-Span-1501" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1502" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1503">k</span><span class="MJXp-mo" id="MJXp-Span-1504" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1505" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1506">y</span><span class="MJXp-mo" id="MJXp-Span-1507" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MJXp-mtr" id="MJXp-Span-1508" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1509" style="padding-top: 0.4em; text-align: left;"><span class="MJXp-mo" id="MJXp-Span-1510" style="margin-left: 0em; margin-right: 0.111em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1511"><span class="MJXp-mi" id="MJXp-Span-1512" style="margin-right: 0.05em;">Σ</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1513" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1514">i is nearer to r</span><span class="MJXp-mo" id="MJXp-Span-1515">,</span><span class="MJXp-mtext" id="MJXp-Span-1516">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1517">j</span><span class="MJXp-mo" id="MJXp-Span-1518">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1519">k</span><span class="MJXp-mo" id="MJXp-Span-1520">=</span><span class="MJXp-msubsup" id="MJXp-Span-1521"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1522" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1523" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1524"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1525"><span class="MJXp-mstyle" id="MJXp-Span-1526"><span class="MJXp-mrow" id="MJXp-Span-1527"><span class="MJXp-mo" id="MJXp-Span-1528" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1529"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1530">r</span><span class="MJXp-mo" id="MJXp-Span-1531">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1532">l</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1533">i</span><span class="MJXp-mo" id="MJXp-Span-1534">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1535">l</span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1536"><span class="MJXp-mstyle" id="MJXp-Span-1537"><span class="MJXp-mrow" id="MJXp-Span-1538"><span class="MJXp-mo" id="MJXp-Span-1539" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1540" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1541">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1542">p</span><span class="MJXp-mo" id="MJXp-Span-1543" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1544">l</span><span class="MJXp-mo" id="MJXp-Span-1545" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1546" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1547">i</span><span class="MJXp-mo" id="MJXp-Span-1548" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1549">1</span><span class="MJXp-mo" id="MJXp-Span-1550" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1551" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1552">x</span><span class="MJXp-mo" id="MJXp-Span-1553" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1554" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1555">j</span><span class="MJXp-mo" id="MJXp-Span-1556" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1557" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1558">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1559">p</span><span class="MJXp-mo" id="MJXp-Span-1560" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1561">i</span><span class="MJXp-mo" id="MJXp-Span-1562" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1563">1</span><span class="MJXp-mo" id="MJXp-Span-1564" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1565" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1566">r</span><span class="MJXp-mo" id="MJXp-Span-1567" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1568" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1569">k</span><span class="MJXp-mo" id="MJXp-Span-1570" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1571" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1572">y</span><span class="MJXp-mo" id="MJXp-Span-1573" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1574">1</span><span class="MJXp-mo" id="MJXp-Span-1575" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mtext" id="MJXp-Span-1576">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-1577" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1578"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1579" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1580" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1581" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mo" id="MJXp-Span-1582" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1583">1</span><span class="MJXp-mo" id="MJXp-Span-1584" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1585" style="margin-left: 0em; margin-right: 0em;"></span></span></span></span><script type="math/tex" id="MathJax-Element-189">  dp[l][r][x][y] = \left\{ \begin{array}{l} \Sigma_{\text{i is nearer to l}} \binom{r-l}{i-l} \cdot dp[l][i-1][x-1][j] \cdot dp[i+1][r][k][y] \\ + \Sigma_{\text{i is nearer to r}} \binom{r-l}{i-l} \cdot dp[l][i-1][x][j] \cdot dp[i+1][r][k][y-1]\ (s_i = -1) \\ \Sigma_{\text{i is nearer to l},\ j+k=s_i} \binom{r-l}{i-l}\cdot dp[l][i-1][x-1][j] \cdot dp[i+1][r][k][y] \\ + \Sigma_{ \text{i is nearer to r},\ j+k=s_i} \binom{r-l}{i-l}\cdot dp[l][i-1][x][j] \cdot dp[i+1][r][k][y-1]\ (s_i \neq -1) \end{array} \right.   </script></center><p>For simplicity, this formula omits some edge cases. Readers are encouraged to fill in the details themselves.</p><p>The complexity seems high, but the problem can be solved with one key observation: the upper bound of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1586"><span class="MJXp-msubsup" id="MJXp-Span-1587"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1588" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1589" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-190">s_i</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1590"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1591">O</span><span class="MJXp-mo" id="MJXp-Span-1592" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-1593">log</span><span class="MJXp-mo" id="MJXp-Span-1594" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1595">n</span><span class="MJXp-mo" id="MJXp-Span-1596" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-191">O( \log n)</script>.</p><p>Proof: let's fix a position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1597"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1598">i</span></span></span><script type="math/tex" id="MathJax-Element-192">i</script> and only consider the cells <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1599"><span class="MJXp-msubsup" id="MJXp-Span-1600"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1601" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1602" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1603" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1605" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1606" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1607" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1608" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1609" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1610" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1611" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1612"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1613" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1614" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-193">c_1, c_2, ..., c_k</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1615"><span class="MJXp-mo" id="MJXp-Span-1616" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1617"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1618" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1619" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1620" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-1621"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1622" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1623" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1624" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mo" id="MJXp-Span-1625" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1626" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1627" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1628" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-1629"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1630" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1631" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1632" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-194">(c_1 < c_2 < ... < c_k)</script> to the left of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1633"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1634">i</span></span></span><script type="math/tex" id="MathJax-Element-195">i</script> that cause <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1635"><span class="MJXp-msubsup" id="MJXp-Span-1636"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1637" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1638" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-196">s_i</script> to increase. We can see that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1639"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1640">i</span><span class="MJXp-mo" id="MJXp-Span-1641" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1642"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1643" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1644" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1645" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-1646">2</span><span class="MJXp-mo" id="MJXp-Span-1647" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1648">i</span><span class="MJXp-mo" id="MJXp-Span-1649" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1650"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1651" style="margin-right: 0.05em;">c</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1652" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1653">j</span><span class="MJXp-mo" id="MJXp-Span-1654">+</span><span class="MJXp-mn" id="MJXp-Span-1655">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1656" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-197">i - c_j > 2(i - c_{j+1})</script>. Otherwise, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1657"><span class="MJXp-msubsup" id="MJXp-Span-1658"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1659" style="margin-right: 0.05em;">c</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1660" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1661">j</span><span class="MJXp-mo" id="MJXp-Span-1662">+</span><span class="MJXp-mn" id="MJXp-Span-1663">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-198">c_{j+1}</script> would cause <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1664"><span class="MJXp-msubsup" id="MJXp-Span-1665"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1666" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1667" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1668"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1669" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1670" style="vertical-align: -0.4em;">j</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-199">s_{c_j}</script> to increase by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1671"><span class="MJXp-mn" id="MJXp-Span-1672">1</span></span></span><script type="math/tex" id="MathJax-Element-200">1</script> instead of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1673"><span class="MJXp-msubsup" id="MJXp-Span-1674"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1675" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1676" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-201">s_i</script>. Thus, We can get <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1677"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1678">k</span></span></span><script type="math/tex" id="MathJax-Element-202">k</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1679"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1680">O</span><span class="MJXp-mo" id="MJXp-Span-1681" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-1682">log</span><span class="MJXp-mo" id="MJXp-Span-1683" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1684">n</span><span class="MJXp-mo" id="MJXp-Span-1685" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-203">O( \log n)</script>.</p><p>Complexity: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1686"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1687">O</span><span class="MJXp-mo" id="MJXp-Span-1688" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1689"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1690" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1691" style="vertical-align: 0.5em;">3</span></span><span class="MJXp-msubsup" id="MJXp-Span-1692"><span class="MJXp-mi" id="MJXp-Span-1693" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1694" style="vertical-align: 0.5em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1695" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696">n</span><span class="MJXp-mo" id="MJXp-Span-1697" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-204">O(n^3 \log^3n)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">solution</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;map&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;set&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cmath&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;ctime&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;queue&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;stack&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstdio&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstdlib&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;vector&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstring&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;algorithm&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;iostream&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;bitset&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;unordered_map&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> fastio ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">cout</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">double</span><span class="pln"> db</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ull</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N</span><span class="pun">=</span><span class="lit">110</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> LOGN</span><span class="pun">=</span><span class="lit">10</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> ll  TMD</span><span class="pun">=</span><span class="lit">998244353</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> ll  INF</span><span class="pun">=</span><span class="lit">2147483647</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
ll s</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln">fac</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
ll dp</span><span class="pun">[</span><span class="pln">N</span><span class="pun">][</span><span class="pln">N</span><span class="pun">][</span><span class="pln">LOGN</span><span class="pun">][</span><span class="pln">LOGN</span><span class="pun">];</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> init_C</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	fac</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">N</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln"> fac</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=(</span><span class="pln">fac</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]*</span><span class="pln">i</span><span class="pun">)%</span><span class="pln">TMD</span><span class="pun">;</span><span class="pln">
	inv</span><span class="pun">[</span><span class="pln">N</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]=</span><span class="pln">pw</span><span class="pun">(</span><span class="pln">fac</span><span class="pun">[</span><span class="pln">N</span><span class="pun">-</span><span class="lit">1</span><span class="pun">],</span><span class="pln">TMD</span><span class="pun">-</span><span class="lit">2</span><span class="pun">);</span><span class="pln">
 	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">N</span><span class="pun">-</span><span class="lit">2</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&gt;=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">--)</span><span class="pln"> inv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=(</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]*(</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">))%</span><span class="pln">TMD</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

ll C</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> m</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">n</span><span class="pun">&lt;</span><span class="pln">m</span><span class="pun">||</span><span class="pln">n</span><span class="pun">&lt;</span><span class="lit">0</span><span class="pun">||</span><span class="pln">m</span><span class="pun">&lt;</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> fac</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]*</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">m</span><span class="pun">]%</span><span class="pln">TMD</span><span class="pun">*</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">n</span><span class="pun">-</span><span class="pln">m</span><span class="pun">]%</span><span class="pln">TMD</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> init</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    cin</span><span class="pun">&gt;&gt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln"> cin</span><span class="pun">&gt;&gt;</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">+</span><span class="lit">4</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">+</span><span class="lit">4</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> ii</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">ii</span><span class="pun">&lt;</span><span class="pln">LOGN</span><span class="pun">;</span><span class="pln">ii</span><span class="pun">++)</span><span class="pln">
                </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> jj</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">jj</span><span class="pun">&lt;</span><span class="pln">LOGN</span><span class="pun">;</span><span class="pln">jj</span><span class="pun">++)</span><span class="pln">
                    dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">ii</span><span class="pun">][</span><span class="pln">jj</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    dp</span><span class="pun">[</span><span class="lit">1</span><span class="pun">][</span><span class="lit">1</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]=(</span><span class="pln">s</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]&lt;</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">2</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
        dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]=(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]&lt;</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">   </span><span class="com">//auxiliary value</span><span class="pln">
        dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]=</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> ABS</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> x</span><span class="pun">&lt;</span><span class="lit">0</span><span class="pun">?-</span><span class="pln">x</span><span class="pun">:</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">2</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">+</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
        </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> ii</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">ii</span><span class="pun">&lt;</span><span class="pln">LOGN</span><span class="pun">;</span><span class="pln">ii</span><span class="pun">++)</span><span class="pln">
            </span><span class="pun">{</span><span class="pln">
                </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> jj</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">jj</span><span class="pun">&lt;</span><span class="pln">LOGN</span><span class="pun">;</span><span class="pln">jj</span><span class="pun">++)</span><span class="pln">
                </span><span class="pun">{</span><span class="pln">
                     </span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">=</span><span class="pln">j</span><span class="pun">,</span><span class="pln">r</span><span class="pun">=</span><span class="pln">j</span><span class="pun">+</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
                     </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">=</span><span class="pln">l</span><span class="pun">;</span><span class="pln">k</span><span class="pun">&lt;=</span><span class="pln">r</span><span class="pun">;</span><span class="pln">k</span><span class="pun">++)</span><span class="pln">
                     </span><span class="pun">{</span><span class="pln">
                         </span><span class="kwd">int</span><span class="pln"> tagl</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">tagr</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
                         </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">l</span><span class="pun">==</span><span class="lit">1</span><span class="pun">&amp;&amp;</span><span class="pln">r</span><span class="pun">==</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> tagl</span><span class="pun">=</span><span class="pln">tagr</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
                         </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">l</span><span class="pun">==</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> tagr</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
                         </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">r</span><span class="pun">==</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> tagl</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
                         </span><span class="kwd">else</span><span class="pln">
                         </span><span class="pun">{</span><span class="pln">
                             </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">ABS</span><span class="pun">(</span><span class="pln">l</span><span class="pun">-</span><span class="lit">1</span><span class="pun">-</span><span class="pln">k</span><span class="pun">)&lt;=</span><span class="pln">ABS</span><span class="pun">(</span><span class="pln">k</span><span class="pun">-(</span><span class="pln">r</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)))</span><span class="pln"> tagl</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
                             </span><span class="kwd">else</span><span class="pln"> tagr</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
                         </span><span class="pun">}</span><span class="pln">
                         </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">ii</span><span class="pun">-</span><span class="pln">tagl</span><span class="pun">&lt;</span><span class="lit">0</span><span class="pun">||</span><span class="pln">jj</span><span class="pun">-</span><span class="pln">tagr</span><span class="pun">&lt;</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
                         </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]==-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
                         </span><span class="pun">{</span><span class="pln">
                             ll suml</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">sumr</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
                             </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> kk</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">kk</span><span class="pun">&lt;</span><span class="pln">LOGN</span><span class="pun">;</span><span class="pln">kk</span><span class="pun">++)</span><span class="pln"> suml</span><span class="pun">=(</span><span class="pln">suml</span><span class="pun">+</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">l</span><span class="pun">][</span><span class="pln">k</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="pln">ii</span><span class="pun">-</span><span class="pln">tagl</span><span class="pun">][</span><span class="pln">kk</span><span class="pun">])%</span><span class="pln">TMD</span><span class="pun">;</span><span class="pln">
                             </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> kk</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">kk</span><span class="pun">&lt;</span><span class="pln">LOGN</span><span class="pun">;</span><span class="pln">kk</span><span class="pun">++)</span><span class="pln"> sumr</span><span class="pun">=(</span><span class="pln">sumr</span><span class="pun">+</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">][</span><span class="pln">r</span><span class="pun">][</span><span class="pln">kk</span><span class="pun">][</span><span class="pln">jj</span><span class="pun">-</span><span class="pln">tagr</span><span class="pun">])%</span><span class="pln">TMD</span><span class="pun">;</span><span class="pln">
                            dp</span><span class="pun">[</span><span class="pln">l</span><span class="pun">][</span><span class="pln">r</span><span class="pun">][</span><span class="pln">ii</span><span class="pun">][</span><span class="pln">jj</span><span class="pun">]=(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">l</span><span class="pun">][</span><span class="pln">r</span><span class="pun">][</span><span class="pln">ii</span><span class="pun">][</span><span class="pln">jj</span><span class="pun">]+</span><span class="pln">suml</span><span class="pun">*</span><span class="pln">sumr</span><span class="pun">%</span><span class="pln">TMD</span><span class="pun">*</span><span class="pln">C</span><span class="pun">(</span><span class="pln">r</span><span class="pun">-</span><span class="pln">l</span><span class="pun">,</span><span class="pln">k</span><span class="pun">-</span><span class="pln">l</span><span class="pun">))%</span><span class="pln">TMD</span><span class="pun">;</span><span class="pln">
                        </span><span class="pun">}</span><span class="pln">
                         </span><span class="kwd">else</span><span class="pln">
                         </span><span class="pun">{</span><span class="pln">
                             </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> kk</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">kk</span><span class="pun">&lt;</span><span class="pln">LOGN</span><span class="pun">;</span><span class="pln">kk</span><span class="pun">++)</span><span class="pln">
                             </span><span class="pun">{</span><span class="pln">
                                 </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]-</span><span class="pln">kk</span><span class="pun">&lt;</span><span class="lit">0</span><span class="pun">||</span><span class="pln">s</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]-</span><span class="pln">kk</span><span class="pun">&gt;=</span><span class="pln">LOGN</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
                                 dp</span><span class="pun">[</span><span class="pln">l</span><span class="pun">][</span><span class="pln">r</span><span class="pun">][</span><span class="pln">ii</span><span class="pun">][</span><span class="pln">jj</span><span class="pun">]=(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">l</span><span class="pun">][</span><span class="pln">r</span><span class="pun">][</span><span class="pln">ii</span><span class="pun">][</span><span class="pln">jj</span><span class="pun">]+</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">l</span><span class="pun">][</span><span class="pln">k</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="pln">ii</span><span class="pun">-</span><span class="pln">tagl</span><span class="pun">][</span><span class="pln">kk</span><span class="pun">]*</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">][</span><span class="pln">r</span><span class="pun">][</span><span class="pln">s</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]-</span><span class="pln">kk</span><span class="pun">][</span><span class="pln">jj</span><span class="pun">-</span><span class="pln">tagr</span><span class="pun">]%</span><span class="pln">TMD</span><span class="pun">*</span><span class="pln">C</span><span class="pun">(</span><span class="pln">r</span><span class="pun">-</span><span class="pln">l</span><span class="pun">,</span><span class="pln">k</span><span class="pun">-</span><span class="pln">l</span><span class="pun">))%</span><span class="pln">TMD</span><span class="pun">;</span><span class="pln">
                             </span><span class="pun">}</span><span class="pln">
                         </span><span class="pun">}</span><span class="pln">
                     </span><span class="pun">}</span><span class="pln">
                </span><span class="pun">}</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    cout</span><span class="pun">&lt;&lt;</span><span class="pln">dp</span><span class="pun">[</span><span class="lit">1</span><span class="pun">][</span><span class="pln">n</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]&lt;&lt;</span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    fastio</span><span class="pun">;</span><span class="pln">

    init_C</span><span class="pun">();</span><span class="pln">

    cin</span><span class="pun">&gt;&gt;</span><span class="pln">T</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		init</span><span class="pun">();</span><span class="pln">
		solve</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate the Problem</b><div class="spoiler-content" style="display: block;"><p>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11084">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="20">20</span>
            </i>
        </a>
    </span>


</p><p>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11085">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="25">25</span>
            </i>
        </a>
    </span>


</p><p>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11086">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="13">13</span>
            </i>
        </a>
    </span>


</p><p>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11087">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="66">66</span>
            </i>
        </a>
    </span>


</p><p>Didn't solve: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11088">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="15">15</span>
            </i>
        </a>
    </span>


</p></div></div><h4><a href="https://codeforces.com/contest/2129/problem/E">D1E Induced Graph Queries</a></h4> <div class="spoiler"><b class="spoiler-title">Fun</b><div class="spoiler-content" style="display: block;"><p><span style="text-decoration: line-through;">Come up with an O(n log^4 n) solution using a persistent multidimensional segment tree with Trie that supports rectangle update XOR.</span></p></div></div> <div class="spoiler"><b class="spoiler-title">Hint1</b><div class="spoiler-content" style="display: block;"><p>Find the nature of the problem and recall the data structures and algorithms learned. What can we utilize?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint2</b><div class="spoiler-content" style="display: block;"><p>Consider a standard Mo's algorithm. Why it doesn't work in this problem?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint3</b><div class="spoiler-content" style="display: block;"><p>Recalling the Handshake Theorem: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1698"><span class="MJXp-msubsup" id="MJXp-Span-1699"><span class="MJXp-mi" id="MJXp-Span-1700" style="margin-right: 0.05em;">Σ</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1705">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1701"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1702">i</span><span class="MJXp-mo" id="MJXp-Span-1703">=</span><span class="MJXp-mn" id="MJXp-Span-1704">1</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1706">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1707">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1708">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1709">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1710">e</span><span class="MJXp-msubsup" id="MJXp-Span-1711"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1712" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1713" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1714" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1715">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1716">m</span></span></span><script type="math/tex" id="MathJax-Element-205">\Sigma_{i=1}^n degree_i=2m</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint4</b><div class="spoiler-content" style="display: block;"><p>Consider a variation of Mo's algorithm.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint5</b><div class="spoiler-content" style="display: block;"><p>How to find the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1717"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1718">k</span></span></span><script type="math/tex" id="MathJax-Element-206">k</script>-th smallest value without <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1719"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1720">O</span><span class="MJXp-mo" id="MJXp-Span-1721" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-1722">log</span><span class="MJXp-mo" id="MJXp-Span-1723" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1724">n</span><span class="MJXp-mo" id="MJXp-Span-1725" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-207">O( \log n)</script> complexity?</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><p>We found that merging the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1726"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727">f</span></span></span><script type="math/tex" id="MathJax-Element-208">f</script> values of two intervals is a bit difficult. However, if we want to add a single node to the graph, it is relatively easy to update the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1729">f</span></span></span><script type="math/tex" id="MathJax-Element-209">f</script> value using brute force. This inspires us to use the Mo's algorithm.</p><p>If we use the standard Mo's Algorithm, when expanding the interval from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1730"><span class="MJXp-mo" id="MJXp-Span-1731" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1732">l</span><span class="MJXp-mo" id="MJXp-Span-1733" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1734">r</span><span class="MJXp-mo" id="MJXp-Span-1735" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-210">[l, r]</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1736"><span class="MJXp-mo" id="MJXp-Span-1737" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1738">l</span><span class="MJXp-mo" id="MJXp-Span-1739" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1740">r</span><span class="MJXp-mo" id="MJXp-Span-1741" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1742">1</span><span class="MJXp-mo" id="MJXp-Span-1743" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-211">[l, r+1]</script>, we need to examine all edges connected to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1744"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1745">r</span><span class="MJXp-mo" id="MJXp-Span-1746" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1747">1</span></span></span><script type="math/tex" id="MathJax-Element-212">r+1</script> and update the node degrees accordingly. We define a cost array: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1748"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1749">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1750">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1751">s</span><span class="MJXp-msubsup" id="MJXp-Span-1752"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1753" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1754" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1755" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1756">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1757">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1758">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1759">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1760">e</span><span class="MJXp-msubsup" id="MJXp-Span-1761"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1762" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1763" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1764" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1765">1</span></span></span><script type="math/tex" id="MathJax-Element-213">cost_i=degree_i+1</script>. The cost of update node <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1766"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1767">r</span><span class="MJXp-mo" id="MJXp-Span-1768" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1769">1</span></span></span><script type="math/tex" id="MathJax-Element-214">r+1</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1770"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1771">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1772">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1773">s</span><span class="MJXp-msubsup" id="MJXp-Span-1774"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1775" style="margin-right: 0.05em;">t</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1776" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1777">r</span><span class="MJXp-mo" id="MJXp-Span-1778">+</span><span class="MJXp-mn" id="MJXp-Span-1779">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-215">cost_{r+1}</script>.</p><p>However, if a node has a high degree, repeatedly processing it in Mo's Algorithm could lead to big time complexity.</p><p>We leverage the Handshaking Lemma to use modified Mo's Algorithm to efficiently handle the queries.</p><p>Recall that the Mo's algorithm relatively evenly divides array indices into blocks according to array length and assigns block numbers. Here, our dividinging strategy is different: we "relatively evenly" divide the array into blocks based on the prefix sum value of the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1780"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1781">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1782">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1783">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1784">t</span></span></span><script type="math/tex" id="MathJax-Element-216">cost</script> array. Specifically, we calculate the prefix sum of the cost array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1785"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1786">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1787">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1788">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1789">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1790">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1791">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1792">t</span></span></span><script type="math/tex" id="MathJax-Element-217">precost</script>, using <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1793"><span class="MJXp-mfrac" id="MJXp-Span-1794" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1795">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1796">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1797">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1798">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1799">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1800">s</span><span class="MJXp-msubsup" id="MJXp-Span-1801"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1802" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1803" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1804">B</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-218">\frac{precost_i}{B}</script> as the block number of node <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1805"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1806">i</span></span></span><script type="math/tex" id="MathJax-Element-219">i</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1807"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1808">B</span></span></span><script type="math/tex" id="MathJax-Element-220">B</script> is the block length parameter.</p><p>Assuming we have a data structure that can maintain the value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1809"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1810">k</span></span></span><script type="math/tex" id="MathJax-Element-221">k</script>-th smallest value in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1811"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1812">O</span><span class="MJXp-mo" id="MJXp-Span-1813" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1814">1</span><span class="MJXp-mo" id="MJXp-Span-1815" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-222">O(1)</script>, using the same analysis method as standard Mo's algorithm, we can get the complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1816"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1817">O</span><span class="MJXp-mo" id="MJXp-Span-1818" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1819" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1820">n</span><span class="MJXp-mo" id="MJXp-Span-1821" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1822">m</span><span class="MJXp-mo" id="MJXp-Span-1823" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1824">q</span><span class="MJXp-mo" id="MJXp-Span-1825" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msqrt" id="MJXp-Span-1826"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1827">n</span><span class="MJXp-mo" id="MJXp-Span-1828" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1829">m</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1830" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-223">O((n+m+q)\sqrt{n+m})</script>.</p><p>To find the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1831"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1832">k</span></span></span><script type="math/tex" id="MathJax-Element-224">k</script>-th smallest value without <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1833"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1834">O</span><span class="MJXp-mo" id="MJXp-Span-1835" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-1836">log</span><span class="MJXp-mo" id="MJXp-Span-1837" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1838">n</span><span class="MJXp-mo" id="MJXp-Span-1839" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-225">O( \log n)</script> complexity, we only need to maintain two arrays <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1840"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1841">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1842">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1843">t</span></span></span><script type="math/tex" id="MathJax-Element-226">cnt</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1844"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1845">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1846">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1847">m</span></span></span><script type="math/tex" id="MathJax-Element-227">sum</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1848"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1849">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1850">n</span><span class="MJXp-msubsup" id="MJXp-Span-1851"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1852" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1853" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-228">cnt_i</script> is the occurrence of value <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1854"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1855">i</span></span></span><script type="math/tex" id="MathJax-Element-229">i</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1856"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1857">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1858">u</span><span class="MJXp-msubsup" id="MJXp-Span-1859"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1860" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1861" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1862" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1863"><span class="MJXp-mi" id="MJXp-Span-1864" style="margin-right: 0.05em;">Σ</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1876"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1877">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1878">B</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1865"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1866">j</span><span class="MJXp-mo" id="MJXp-Span-1867">=</span><span class="MJXp-mo" id="MJXp-Span-1868">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1869">i</span><span class="MJXp-mo" id="MJXp-Span-1870">−</span><span class="MJXp-mn" id="MJXp-Span-1871">1</span><span class="MJXp-mo" id="MJXp-Span-1872">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1873">B</span><span class="MJXp-mo" id="MJXp-Span-1874">+</span><span class="MJXp-mn" id="MJXp-Span-1875">1</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1879">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1880">n</span><span class="MJXp-msubsup" id="MJXp-Span-1881"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1882" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1883" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-230">sum_i=\Sigma_{j=(i-1)B+1}^{iB}cnt_j</script> (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1884"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1885">B</span></span></span><script type="math/tex" id="MathJax-Element-231">B</script> is the block length parameter). We can perform modification in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1886"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1887">O</span><span class="MJXp-mo" id="MJXp-Span-1888" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1889">1</span><span class="MJXp-mo" id="MJXp-Span-1890" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-232">O(1)</script> and query in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1891"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1892">O</span><span class="MJXp-mo" id="MJXp-Span-1893" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msqrt" id="MJXp-Span-1894"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1895">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1896" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-233">O(\sqrt{n})</script>. The complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1897"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1898">O</span><span class="MJXp-mo" id="MJXp-Span-1899" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1900" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1901">n</span><span class="MJXp-mo" id="MJXp-Span-1902" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1903">q</span><span class="MJXp-mo" id="MJXp-Span-1904" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msqrt" id="MJXp-Span-1905"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1906">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1907" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-234">O((n+q)\sqrt{n})</script>.</p><p>Regarding implementation, you need to pay attention to two common pitfalls: </p> <ul>   <li><p>If you use <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1908"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1909">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1910">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1911">s</span><span class="MJXp-msubsup" id="MJXp-Span-1912"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1913" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1914" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1915" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1916">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1917">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1918">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1919">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1920">e</span><span class="MJXp-msubsup" id="MJXp-Span-1921"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1922" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1923" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-235">cost_i=degree_i</script> instead of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1924"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1925">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1926">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1927">s</span><span class="MJXp-msubsup" id="MJXp-Span-1928"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1929" style="margin-right: 0.05em;">t</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1930" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1931" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1932">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1933">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1934">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1935">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1936">e</span><span class="MJXp-msubsup" id="MJXp-Span-1937"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1938" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1939" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1940" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1941">1</span></span></span><script type="math/tex" id="MathJax-Element-236">cost_i=degree_i+1</script>, the dividing algorithm doesn't work for the graph with many nodes with degree <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1942"><span class="MJXp-mn" id="MJXp-Span-1943">0</span></span></span><script type="math/tex" id="MathJax-Element-237">0</script>.</p></li>   <li><p>Similarly, you can not set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1944"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1945">B</span><span class="MJXp-mo" id="MJXp-Span-1946" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msqrt" id="MJXp-Span-1947"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1948">m</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-238">B=\sqrt{m}</script>. </p></li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">solution</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="com">#define</span><span class="pln"> all</span><span class="pun">(</span><span class="pln">a</span><span class="pun">)</span><span class="pln"> a</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln">a</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">()</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> pb push_back
</span><span class="com">#define</span><span class="pln"> sz</span><span class="pun">(</span><span class="pln">a</span><span class="pun">)</span><span class="pln"> </span><span class="pun">((</span><span class="kwd">int</span><span class="pun">)</span><span class="pln">a</span><span class="pun">.</span><span class="pln">size</span><span class="pun">())</span><span class="pln">

</span><span class="kwd">using</span><span class="pln"> ll</span><span class="pun">=</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> u32</span><span class="pun">=</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> u64</span><span class="pun">=</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> i128</span><span class="pun">=</span><span class="pln">__int128</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> u128</span><span class="pun">=</span><span class="kwd">unsigned</span><span class="pln"> __int128</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> f128</span><span class="pun">=</span><span class="pln">__float128</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">using</span><span class="pln"> pii</span><span class="pun">=</span><span class="pln">pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="kwd">int</span><span class="pun">&gt;;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> pll</span><span class="pun">=</span><span class="pln">pair</span><span class="pun">&lt;</span><span class="pln">ll</span><span class="pun">,</span><span class="pln">ll</span><span class="pun">&gt;;</span><span class="pln">

</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">using</span><span class="pln"> vc</span><span class="pun">=</span><span class="pln">vector</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;;</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">using</span><span class="pln"> vvc</span><span class="pun">=</span><span class="pln">vc</span><span class="pun">&lt;</span><span class="pln">vc</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;&gt;;</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">using</span><span class="pln"> vvvc</span><span class="pun">=</span><span class="pln">vc</span><span class="pun">&lt;</span><span class="pln">vvc</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;&gt;;</span><span class="pln">

</span><span class="kwd">using</span><span class="pln"> vi</span><span class="pun">=</span><span class="pln">vc</span><span class="str">&lt;int&gt;</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> vll</span><span class="pun">=</span><span class="pln">vc</span><span class="str">&lt;ll&gt;</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> vvi</span><span class="pun">=</span><span class="pln">vc</span><span class="str">&lt;vi&gt;</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> vvll</span><span class="pun">=</span><span class="pln">vc</span><span class="str">&lt;vll&gt;</span><span class="pun">;</span><span class="pln">

</span><span class="com">#define</span><span class="pln"> vv</span><span class="pun">(</span><span class="pln">type</span><span class="pun">,</span><span class="pln">name</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,...)</span><span class="pln"> \
    vector</span><span class="pun">&lt;</span><span class="pln">vector</span><span class="str">&lt;type&gt;</span><span class="pun">&gt;</span><span class="pln"> name</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">vector</span><span class="str">&lt;type&gt;</span><span class="pun">(</span><span class="pln">__VA_ARGS__</span><span class="pun">))</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> vvv</span><span class="pun">(</span><span class="pln">type</span><span class="pun">,</span><span class="pln">name</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="pln">m</span><span class="pun">,...)</span><span class="pln"> \
    vector</span><span class="pun">&lt;</span><span class="pln">vector</span><span class="pun">&lt;</span><span class="pln">vector</span><span class="str">&lt;type&gt;</span><span class="pun">&gt;&gt;</span><span class="pln"> name</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">vector</span><span class="pun">&lt;</span><span class="pln">vector</span><span class="str">&lt;type&gt;</span><span class="pun">&gt;(</span><span class="pln">m</span><span class="pun">,</span><span class="pln">vector</span><span class="str">&lt;type&gt;</span><span class="pun">(</span><span class="pln">__VA_ARGS__</span><span class="pun">)))</span><span class="pln">

</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">using</span><span class="pln"> min_heap</span><span class="pun">=</span><span class="pln">priority_queue</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">,</span><span class="pln">vector</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;,</span><span class="pln">greater</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;&gt;;</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">using</span><span class="pln"> max_heap</span><span class="pun">=</span><span class="pln">priority_queue</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;;</span><span class="pln">

</span><span class="com">// https://trap.jp/post/1224/</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> rep1</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">ll i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;(</span><span class="pln">ll</span><span class="pun">)(</span><span class="pln">n</span><span class="pun">);</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> rep2</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">ll i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;(</span><span class="pln">ll</span><span class="pun">)(</span><span class="pln">n</span><span class="pun">);</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> rep3</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">a</span><span class="pun">,</span><span class="pln">b</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">ll i</span><span class="pun">=(</span><span class="pln">ll</span><span class="pun">)(</span><span class="pln">a</span><span class="pun">);</span><span class="pln"> i</span><span class="pun">&lt;(</span><span class="pln">ll</span><span class="pun">)(</span><span class="pln">b</span><span class="pun">);</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> rep4</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">a</span><span class="pun">,</span><span class="pln">b</span><span class="pun">,</span><span class="pln">c</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">ll i</span><span class="pun">=(</span><span class="pln">ll</span><span class="pun">)(</span><span class="pln">a</span><span class="pun">);</span><span class="pln"> i</span><span class="pun">&lt;(</span><span class="pln">ll</span><span class="pun">)(</span><span class="pln">b</span><span class="pun">);</span><span class="pln"> i</span><span class="pun">+=(</span><span class="pln">c</span><span class="pun">))</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> cut4</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln">b</span><span class="pun">,</span><span class="pln">c</span><span class="pun">,</span><span class="pln">d</span><span class="pun">,</span><span class="pln">e</span><span class="pun">,...)</span><span class="pln"> e
</span><span class="com">#define</span><span class="pln"> rep</span><span class="pun">(...)</span><span class="pln"> cut4</span><span class="pun">(</span><span class="pln">__VA_ARGS__</span><span class="pun">,</span><span class="pln">rep4</span><span class="pun">,</span><span class="pln">rep3</span><span class="pun">,</span><span class="pln">rep2</span><span class="pun">,</span><span class="pln">rep1</span><span class="pun">)(</span><span class="pln">__VA_ARGS__</span><span class="pun">)</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> per1</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">ll i</span><span class="pun">=((</span><span class="pln">ll</span><span class="pun">)</span><span class="pln">n</span><span class="pun">)-</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&gt;=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="pun">--</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> per2</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">ll i</span><span class="pun">=((</span><span class="pln">ll</span><span class="pun">)</span><span class="pln">n</span><span class="pun">)-</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&gt;=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="pun">--</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> per3</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">a</span><span class="pun">,</span><span class="pln">b</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">ll i</span><span class="pun">=((</span><span class="pln">ll</span><span class="pun">)</span><span class="pln">a</span><span class="pun">)-</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&gt;=(</span><span class="pln">ll</span><span class="pun">)(</span><span class="pln">b</span><span class="pun">);</span><span class="pln"> </span><span class="pun">--</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> per4</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">a</span><span class="pun">,</span><span class="pln">b</span><span class="pun">,</span><span class="pln">c</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">ll i</span><span class="pun">=((</span><span class="pln">ll</span><span class="pun">)</span><span class="pln">a</span><span class="pun">)-</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&gt;=(</span><span class="pln">ll</span><span class="pun">)(</span><span class="pln">b</span><span class="pun">);</span><span class="pln"> i</span><span class="pun">-=(</span><span class="pln">c</span><span class="pun">))</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> per</span><span class="pun">(...)</span><span class="pln"> cut4</span><span class="pun">(</span><span class="pln">__VA_ARGS__</span><span class="pun">,</span><span class="pln">per4</span><span class="pun">,</span><span class="pln">per3</span><span class="pun">,</span><span class="pln">per2</span><span class="pun">,</span><span class="pln">per1</span><span class="pun">)(</span><span class="pln">__VA_ARGS__</span><span class="pun">)</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> rep_subset</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">s</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">ll i</span><span class="pun">=(</span><span class="pln">s</span><span class="pun">);</span><span class="pln"> i</span><span class="pun">&gt;=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">=(</span><span class="pln">i</span><span class="pun">==</span><span class="lit">0</span><span class="pun">?-</span><span class="lit">1</span><span class="pun">:(</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)&amp;(</span><span class="pln">s</span><span class="pun">)))</span><span class="pln">

</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">typename</span><span class="pln"> S</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">constexpr</span><span class="pln"> T ifloor</span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> T a</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> S b</span><span class="pun">){</span><span class="kwd">return</span><span class="pln"> a</span><span class="pun">/</span><span class="pln">b</span><span class="pun">-(</span><span class="pln">a</span><span class="pun">%</span><span class="pln">b</span><span class="pun">&amp;&amp;(</span><span class="pln">a</span><span class="pun">^</span><span class="pln">b</span><span class="pun">)&lt;</span><span class="lit">0</span><span class="pun">);}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">typename</span><span class="pln"> S</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">constexpr</span><span class="pln"> T iceil</span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> T a</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> S b</span><span class="pun">){</span><span class="kwd">return</span><span class="pln"> ifloor</span><span class="pun">(</span><span class="pln">a</span><span class="pun">+</span><span class="pln">b</span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln">b</span><span class="pun">);}</span><span class="pln">

</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> sort_unique</span><span class="pun">(</span><span class="pln">vector</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">vec</span><span class="pun">){</span><span class="pln">
    sort</span><span class="pun">(</span><span class="pln">vec</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln">vec</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">());</span><span class="pln">
    vec</span><span class="pun">.</span><span class="pln">resize</span><span class="pun">(</span><span class="pln">unique</span><span class="pun">(</span><span class="pln">vec</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln">vec</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">())-</span><span class="pln">vec</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">());</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">typename</span><span class="pln"> S</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">constexpr</span><span class="pln"> </span><span class="kwd">bool</span><span class="pln"> chmin</span><span class="pun">(</span><span class="pln">T </span><span class="pun">&amp;</span><span class="pln">a</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> S b</span><span class="pun">){</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">a</span><span class="pun">&gt;</span><span class="pln">b</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> a</span><span class="pun">=</span><span class="pln">b</span><span class="pun">,</span><span class="kwd">true</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">typename</span><span class="pln"> S</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">constexpr</span><span class="pln"> </span><span class="kwd">bool</span><span class="pln"> chmax</span><span class="pun">(</span><span class="pln">T </span><span class="pun">&amp;</span><span class="pln">a</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> S b</span><span class="pun">){</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">a</span><span class="pun">&lt;</span><span class="pln">b</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> a</span><span class="pun">=</span><span class="pln">b</span><span class="pun">,</span><span class="kwd">true</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;}</span><span class="pln">

</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">typename</span><span class="pln"> S</span><span class="pun">&gt;</span><span class="pln"> istream</span><span class="pun">&amp;</span><span class="pln"> </span><span class="kwd">operator</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">istream</span><span class="pun">&amp;</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> pair</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">,</span><span class="pln">S</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">p</span><span class="pun">){</span><span class="kwd">return</span><span class="pln"> i </span><span class="pun">&gt;&gt;</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">first </span><span class="pun">&gt;&gt;</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">second</span><span class="pun">;}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">typename</span><span class="pln"> S</span><span class="pun">&gt;</span><span class="pln"> ostream</span><span class="pun">&amp;</span><span class="pln"> </span><span class="kwd">operator</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ostream</span><span class="pun">&amp;</span><span class="pln"> o</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> pair</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">,</span><span class="pln">S</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">p</span><span class="pun">){</span><span class="kwd">return</span><span class="pln"> o </span><span class="pun">&lt;&lt;</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">first </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">second</span><span class="pun">;}</span><span class="pln">

</span><span class="com">#ifdef</span><span class="pln"> i_am_noob
</span><span class="com">#define</span><span class="pln"> bug</span><span class="pun">(...)</span><span class="pln"> cerr </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"#"</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> __LINE__ </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="com">#__VA_ARGS__ &lt;&lt; "- ", _do(__VA_ARGS__)</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> _do</span><span class="pun">(</span><span class="pln">vector</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> x</span><span class="pun">){</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> i</span><span class="pun">:</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> cerr </span><span class="pun">&lt;&lt;</span><span class="pln"> i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">cerr </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> _do</span><span class="pun">(</span><span class="kwd">set</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> x</span><span class="pun">){</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> i</span><span class="pun">:</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> cerr </span><span class="pun">&lt;&lt;</span><span class="pln"> i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">cerr </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> _do</span><span class="pun">(</span><span class="pln">unordered_set</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> x</span><span class="pun">){</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> i</span><span class="pun">:</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> cerr </span><span class="pun">&lt;&lt;</span><span class="pln"> i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">cerr </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> _do</span><span class="pun">(</span><span class="pln">T </span><span class="pun">&amp;&amp;</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">cerr </span><span class="pun">&lt;&lt;</span><span class="pln"> x </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">typename</span><span class="pln"> </span><span class="pun">...</span><span class="pln">S</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> _do</span><span class="pun">(</span><span class="pln">T </span><span class="pun">&amp;&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> S</span><span class="pun">&amp;&amp;...</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">cerr </span><span class="pun">&lt;&lt;</span><span class="pln"> x </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">", "</span><span class="pun">;</span><span class="pln"> _do</span><span class="pun">(</span><span class="pln">y</span><span class="pun">...);}</span><span class="pln">
</span><span class="com">#else</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> bug</span><span class="pun">(...)</span><span class="pln"> </span><span class="lit">777771449</span><span class="pln">
</span><span class="com">#endif</span><span class="pln">

</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">vector</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> x</span><span class="pun">){</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> i</span><span class="pun">:</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> cout </span><span class="pun">&lt;&lt;</span><span class="pln"> i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="kwd">set</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> x</span><span class="pun">){</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> i</span><span class="pun">:</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> cout </span><span class="pun">&lt;&lt;</span><span class="pln"> i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">unordered_set</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> x</span><span class="pun">){</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> i</span><span class="pun">:</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> cout </span><span class="pun">&lt;&lt;</span><span class="pln"> i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">T </span><span class="pun">&amp;&amp;</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">cout </span><span class="pun">&lt;&lt;</span><span class="pln"> x </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">typename</span><span class="pun">...</span><span class="pln"> S</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">T </span><span class="pun">&amp;&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> S</span><span class="pun">&amp;&amp;...</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">cout </span><span class="pun">&lt;&lt;</span><span class="pln"> x </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">y</span><span class="pun">...);}</span><span class="pln">

</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln"> istream</span><span class="pun">&amp;</span><span class="pln"> </span><span class="kwd">operator</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">istream</span><span class="pun">&amp;</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> vector</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">vec</span><span class="pun">){</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">x</span><span class="pun">:</span><span class="pln"> vec</span><span class="pun">)</span><span class="pln"> i </span><span class="pun">&gt;&gt;</span><span class="pln"> x</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> i</span><span class="pun">;}</span><span class="pln">

vvi read_graph</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> m</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">base</span><span class="pun">=</span><span class="lit">1</span><span class="pun">){</span><span class="pln">
    vvi adj</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">u</span><span class="pun">,</span><span class="pln">v</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">m</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> u </span><span class="pun">&gt;&gt;</span><span class="pln"> v</span><span class="pun">,</span><span class="pln">u</span><span class="pun">-=</span><span class="kwd">base</span><span class="pun">,</span><span class="pln">v</span><span class="pun">-=</span><span class="kwd">base</span><span class="pun">;</span><span class="pln">
        adj</span><span class="pun">[</span><span class="pln">u</span><span class="pun">].</span><span class="pln">pb</span><span class="pun">(</span><span class="pln">v</span><span class="pun">),</span><span class="pln">adj</span><span class="pun">[</span><span class="pln">v</span><span class="pun">].</span><span class="pln">pb</span><span class="pun">(</span><span class="pln">u</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> adj</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

vvi read_tree</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">base</span><span class="pun">=</span><span class="lit">1</span><span class="pun">){</span><span class="kwd">return</span><span class="pln"> read_graph</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="kwd">base</span><span class="pun">);}</span><span class="pln">

</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">typename</span><span class="pln"> S</span><span class="pun">&gt;</span><span class="pln"> pair</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">,</span><span class="pln">S</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">operator</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> pair</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">,</span><span class="pln">S</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">a</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> pair</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">,</span><span class="pln">S</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">b</span><span class="pun">){</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln">a</span><span class="pun">.</span><span class="pln">first</span><span class="pun">+</span><span class="pln">b</span><span class="pun">.</span><span class="pln">first</span><span class="pun">,</span><span class="pln">a</span><span class="pun">.</span><span class="pln">second</span><span class="pun">+</span><span class="pln">b</span><span class="pun">.</span><span class="pln">second</span><span class="pun">};}</span><span class="pln">

</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">constexpr</span><span class="pln"> T inf</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;&gt;</span><span class="pln"> </span><span class="kwd">constexpr</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> inf</span><span class="str">&lt;int&gt;</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0x3f3f3f3f</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;&gt;</span><span class="pln"> </span><span class="kwd">constexpr</span><span class="pln"> ll inf</span><span class="str">&lt;ll&gt;</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0x3f3f3f3f3f3f3f3f</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln"> vector</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">operator</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">vector</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">a</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> val</span><span class="pun">){</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">i</span><span class="pun">:</span><span class="pln"> a</span><span class="pun">)</span><span class="pln"> i</span><span class="pun">+=</span><span class="pln">val</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> a</span><span class="pun">;}</span><span class="pln">

</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln"> T isqrt</span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> T </span><span class="pun">&amp;</span><span class="pln">x</span><span class="pun">){</span><span class="pln">T y</span><span class="pun">=</span><span class="pln">sqrt</span><span class="pun">(</span><span class="pln">x</span><span class="pun">+</span><span class="lit">2</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">y</span><span class="pun">*</span><span class="pln">y</span><span class="pun">&gt;</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> y</span><span class="pun">--;</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> y</span><span class="pun">;}</span><span class="pln">

</span><span class="com">#define</span><span class="pln"> ykh mt19937 rng</span><span class="pun">(</span><span class="pln">chrono</span><span class="pun">::</span><span class="pln">steady_clock</span><span class="pun">::</span><span class="pln">now</span><span class="pun">().</span><span class="pln">time_since_epoch</span><span class="pun">().</span><span class="pln">count</span><span class="pun">())</span><span class="pln">

</span><span class="com">//#include&lt;atcoder/all&gt;</span><span class="pln">
</span><span class="com">//using namespace atcoder;</span><span class="pln">

</span><span class="com">//using mint=modint998244353;</span><span class="pln">
</span><span class="com">//using mint=modint1000000007;</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N</span><span class="pun">=</span><span class="lit">1</span><span class="pun">&lt;&lt;</span><span class="lit">18</span><span class="pun">,</span><span class="pln">K</span><span class="pun">=</span><span class="lit">1</span><span class="pun">&lt;&lt;</span><span class="lit">10</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">struct</span><span class="pln"> DS</span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> big</span><span class="pun">[</span><span class="pln">N</span><span class="pun">/</span><span class="pln">K</span><span class="pun">],</span><span class="pln">small</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">void</span><span class="pln"> ins</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">){</span><span class="pln">
        small</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]++;</span><span class="pln">
        big</span><span class="pun">[</span><span class="pln">x</span><span class="pun">&gt;&gt;</span><span class="lit">10</span><span class="pun">]++;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">void</span><span class="pln"> </span><span class="kwd">del</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">){</span><span class="pln">
        small</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]--;</span><span class="pln">
        big</span><span class="pun">[</span><span class="pln">x</span><span class="pun">&gt;&gt;</span><span class="lit">10</span><span class="pun">]--;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> kth</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">){</span><span class="pln">
        k</span><span class="pun">--;</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> cur</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">big</span><span class="pun">[</span><span class="pln">cur</span><span class="pun">]&lt;=</span><span class="pln">k</span><span class="pun">)</span><span class="pln"> k</span><span class="pun">-=</span><span class="pln">big</span><span class="pun">[</span><span class="pln">cur</span><span class="pun">++];</span><span class="pln">
        cur</span><span class="pun">&lt;&lt;=</span><span class="lit">10</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">small</span><span class="pun">[</span><span class="pln">cur</span><span class="pun">]&lt;=</span><span class="pln">k</span><span class="pun">)</span><span class="pln"> k</span><span class="pun">-=</span><span class="pln">small</span><span class="pun">[</span><span class="pln">cur</span><span class="pun">++];</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> cur</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">ds</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> ahcorz</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln">m</span><span class="pun">;</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">
    vvi adj</span><span class="pun">=</span><span class="pln">read_graph</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="pln">m</span><span class="pun">);</span><span class="pln">
    vi block</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> cur</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    rep</span><span class="pun">(</span><span class="pln">n</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">cur</span><span class="pun">&gt;=</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> tot</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">cur</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">&amp;&amp;</span><span class="pln">tot</span><span class="pun">&lt;</span><span class="pln">K</span><span class="pun">){</span><span class="pln">
            tot</span><span class="pun">+=</span><span class="pln">sz</span><span class="pun">(</span><span class="pln">adj</span><span class="pun">[</span><span class="pln">cur</span><span class="pun">])+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
            block</span><span class="pun">[</span><span class="pln">cur</span><span class="pun">++]=</span><span class="pln">i</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> q</span><span class="pun">;</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
    vc</span><span class="pun">&lt;</span><span class="pln">array</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="lit">4</span><span class="pun">&gt;&gt;</span><span class="pln"> qq</span><span class="pun">(</span><span class="pln">q</span><span class="pun">);</span><span class="pln">
    vi res</span><span class="pun">(</span><span class="pln">q</span><span class="pun">);</span><span class="pln">
    rep</span><span class="pun">(</span><span class="pln">q</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln">r</span><span class="pun">,</span><span class="pln">k</span><span class="pun">;</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> l </span><span class="pun">&gt;&gt;</span><span class="pln"> r </span><span class="pun">&gt;&gt;</span><span class="pln"> k</span><span class="pun">;</span><span class="pln"> l</span><span class="pun">--,</span><span class="pln">r</span><span class="pun">--;</span><span class="pln">
        qq</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]={</span><span class="pln">l</span><span class="pun">,</span><span class="pln">r</span><span class="pun">,</span><span class="pln">k</span><span class="pun">,</span><span class="pln">i</span><span class="pun">};</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    sort</span><span class="pun">(</span><span class="pln">all</span><span class="pun">(</span><span class="pln">qq</span><span class="pun">),[&amp;](</span><span class="pln">array</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="lit">4</span><span class="pun">&gt;</span><span class="pln"> arr1</span><span class="pun">,</span><span class="pln"> array</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="lit">4</span><span class="pun">&gt;</span><span class="pln"> arr2</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">block</span><span class="pun">[</span><span class="pln">arr1</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]]!=</span><span class="pln">block</span><span class="pun">[</span><span class="pln">arr2</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]])</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> block</span><span class="pun">[</span><span class="pln">arr1</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]]&lt;</span><span class="pln">block</span><span class="pun">[</span><span class="pln">arr2</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]];</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">block</span><span class="pun">[</span><span class="pln">arr1</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]]&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> arr1</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]&gt;</span><span class="pln">arr2</span><span class="pun">[</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> arr1</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]&lt;</span><span class="pln">arr2</span><span class="pun">[</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">});</span><span class="pln">
    vi val</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">r</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    ds</span><span class="pun">.</span><span class="pln">ins</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">auto</span><span class="pln"> ins</span><span class="pun">=[&amp;](</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> j</span><span class="pun">:</span><span class="pln"> adj</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]){</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">j</span><span class="pun">&gt;=</span><span class="pln">l</span><span class="pun">&amp;&amp;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">r</span><span class="pun">){</span><span class="pln">
                ds</span><span class="pun">.</span><span class="kwd">del</span><span class="pun">(</span><span class="pln">val</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]);</span><span class="pln">
                val</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]^=</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">val</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]^=</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
                ds</span><span class="pun">.</span><span class="pln">ins</span><span class="pun">(</span><span class="pln">val</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]);</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        ds</span><span class="pun">.</span><span class="pln">ins</span><span class="pun">(</span><span class="pln">val</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">
    </span><span class="kwd">auto</span><span class="pln"> </span><span class="kwd">del</span><span class="pun">=[&amp;](</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">){</span><span class="pln">
        ds</span><span class="pun">.</span><span class="kwd">del</span><span class="pun">(</span><span class="pln">val</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> j</span><span class="pun">:</span><span class="pln"> adj</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]){</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">j</span><span class="pun">&gt;=</span><span class="pln">l</span><span class="pun">&amp;&amp;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">r</span><span class="pun">){</span><span class="pln">
                ds</span><span class="pun">.</span><span class="kwd">del</span><span class="pun">(</span><span class="pln">val</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]);</span><span class="pln">
                val</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]^=</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">val</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]^=</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
                ds</span><span class="pun">.</span><span class="pln">ins</span><span class="pun">(</span><span class="pln">val</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]);</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">
    </span><span class="kwd">auto</span><span class="pln"> gogo</span><span class="pun">=[&amp;](</span><span class="kwd">int</span><span class="pln"> l2</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r2</span><span class="pun">){</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">l</span><span class="pun">&gt;</span><span class="pln">l2</span><span class="pun">){</span><span class="pln">
            ins</span><span class="pun">(</span><span class="pln">l</span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
            l</span><span class="pun">--;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">r</span><span class="pun">&lt;</span><span class="pln">r2</span><span class="pun">){</span><span class="pln">
            ins</span><span class="pun">(</span><span class="pln">r</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
            r</span><span class="pun">++;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">l</span><span class="pun">&lt;</span><span class="pln">l2</span><span class="pun">){</span><span class="pln">
            l</span><span class="pun">++;</span><span class="pln">
            </span><span class="kwd">del</span><span class="pun">(</span><span class="pln">l</span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">r</span><span class="pun">&gt;</span><span class="pln">r2</span><span class="pun">){</span><span class="pln">
            r</span><span class="pun">--;</span><span class="pln">
            </span><span class="kwd">del</span><span class="pun">(</span><span class="pln">r</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">l2</span><span class="pun">,</span><span class="pln">r2</span><span class="pun">,</span><span class="pln">k</span><span class="pun">,</span><span class="pln">i</span><span class="pun">]:</span><span class="pln"> qq</span><span class="pun">){</span><span class="pln">
        gogo</span><span class="pun">(</span><span class="pln">l2</span><span class="pun">,</span><span class="pln">r2</span><span class="pun">);</span><span class="pln">
        res</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">ds</span><span class="pun">.</span><span class="pln">kth</span><span class="pun">(</span><span class="pln">k</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    rep</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln">l</span><span class="pun">,</span><span class="pln">r</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> ds</span><span class="pun">.</span><span class="kwd">del</span><span class="pun">(</span><span class="pln">val</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
    rep</span><span class="pun">(</span><span class="pln">q</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">res</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="lit">0</span><span class="pun">),</span><span class="pln">cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="kwd">fixed</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> setprecision</span><span class="pun">(</span><span class="lit">20</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> ahcorz</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate the Problem</b><div class="spoiler-content" style="display: block;"><p>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11089">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="17">17</span>
            </i>
        </a>
    </span>


</p><p>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11090">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="6">6</span>
            </i>
        </a>
    </span>


</p><p>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11091">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="4">4</span>
            </i>
        </a>
    </span>


</p><p>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11092">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="59">59</span>
            </i>
        </a>
    </span>


</p><p>Didn't solve: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11093">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="6">6</span>
            </i>
        </a>
    </span>


</p></div></div><h4><a href="https://codeforces.com/contest/2129/problem/F1">D1F1 Top-K Tracker (Easy Version)</a> and <a href="https://codeforces.com/contest/2129/problem/F2">D1F2 Top-K Tracker (Hard Version)</a></h4> <div class="spoiler"><b class="spoiler-title">Fun</b><div class="spoiler-content" style="display: block;"><p>Did you notice the double meaning of the title?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint1</b><div class="spoiler-content" style="display: block;"><p>Consider easy version. Try to use only operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1949"><span class="MJXp-mn" id="MJXp-Span-1950">1</span></span></span><script type="math/tex" id="MathJax-Element-239">1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1951"><span class="MJXp-mn" id="MJXp-Span-1952">3</span></span></span><script type="math/tex" id="MathJax-Element-240">3</script> (Due to symmetry, using operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1953"><span class="MJXp-mn" id="MJXp-Span-1954">2</span></span></span><script type="math/tex" id="MathJax-Element-241">2</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1955"><span class="MJXp-mn" id="MJXp-Span-1956">4</span></span></span><script type="math/tex" id="MathJax-Element-242">4</script> is the same), and only use <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1957"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1958">m</span><span class="MJXp-mo" id="MJXp-Span-1959" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1960">30</span></span></span><script type="math/tex" id="MathJax-Element-243">m=30</script> in operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1961"><span class="MJXp-mn" id="MJXp-Span-1962">1</span></span></span><script type="math/tex" id="MathJax-Element-244">1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1963"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1964">m</span><span class="MJXp-mo" id="MJXp-Span-1965" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1966">300</span></span></span><script type="math/tex" id="MathJax-Element-245">m=300</script> in operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1967"><span class="MJXp-mn" id="MJXp-Span-1968">3</span></span></span><script type="math/tex" id="MathJax-Element-246">3</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint2</b><div class="spoiler-content" style="display: block;"><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1969"><span class="MJXp-msubsup" id="MJXp-Span-1970"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1971" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1972" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-247">S_i</script> represent the set in which queries element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1973"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1974">i</span></span></span><script type="math/tex" id="MathJax-Element-248">i</script> is accessed. Make all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1975"><span class="MJXp-msubsup" id="MJXp-Span-1976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1977" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1978" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-249">S_i</script> different to distinguish all elements.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint3</b><div class="spoiler-content" style="display: block;"><p>Greedily choose all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1979"><span class="MJXp-msubsup" id="MJXp-Span-1980"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1981" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1982" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-250">S_i</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1983"><span class="MJXp-mrow" id="MJXp-Span-1984"><span class="MJXp-mo" id="MJXp-Span-1985" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1986"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1987" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1988" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mrow" id="MJXp-Span-1989"><span class="MJXp-mo" id="MJXp-Span-1990" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1991" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-1992">3</span></span></span><script type="math/tex" id="MathJax-Element-251">|S_i|<3</script>. Afterwards, carefully construct a set of size <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1993"><span class="MJXp-mn" id="MJXp-Span-1994">3</span></span></span><script type="math/tex" id="MathJax-Element-252">3</script> to reach the upper bound. </p></div></div> <div class="spoiler"><b class="spoiler-title">Hint4</b><div class="spoiler-content" style="display: block;"><p>Suppose there are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1995"><span class="MJXp-mn" id="MJXp-Span-1996">30</span></span></span><script type="math/tex" id="MathJax-Element-253">30</script> numbers <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1997"><span class="MJXp-mn" id="MJXp-Span-1998">1</span><span class="MJXp-mo" id="MJXp-Span-1999" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2000">2</span><span class="MJXp-mo" id="MJXp-Span-2001" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2002" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2003" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2004">30</span></span></span><script type="math/tex" id="MathJax-Element-254">1, 2, …, 30</script>, and each number can be used up to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2005"><span class="MJXp-mn" id="MJXp-Span-2006">30</span></span></span><script type="math/tex" id="MathJax-Element-255">30</script> times. Can you construct <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2007"><span class="MJXp-mn" id="MJXp-Span-2008">900</span></span></span><script type="math/tex" id="MathJax-Element-256">900</script> distinct triplets?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint5</b><div class="spoiler-content" style="display: block;"><p>Consider hard version. How to efficiently utilize the four operations, and the condition <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2009"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2010">m</span><span class="MJXp-mo" id="MJXp-Span-2011" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2012">k</span></span></span><script type="math/tex" id="MathJax-Element-257">m > k</script>?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint6</b><div class="spoiler-content" style="display: block;"><p>Using operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2013"><span class="MJXp-mn" id="MJXp-Span-2014">1</span></span></span><script type="math/tex" id="MathJax-Element-258">1</script> and operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2015"><span class="MJXp-mn" id="MJXp-Span-2016">4</span></span></span><script type="math/tex" id="MathJax-Element-259">4</script> is enough. Due to symmetry, using operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2017"><span class="MJXp-mn" id="MJXp-Span-2018">2</span></span></span><script type="math/tex" id="MathJax-Element-260">2</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2019"><span class="MJXp-mn" id="MJXp-Span-2020">3</span></span></span><script type="math/tex" id="MathJax-Element-261">3</script> is the same.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint7</b><div class="spoiler-content" style="display: block;"><p>Recall the bottleneck of the easy version. We used too many sets of size <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2021"><span class="MJXp-mn" id="MJXp-Span-2022">3</span></span></span><script type="math/tex" id="MathJax-Element-262">3</script>. Let’s say it another way — too many elements were determined at the cost of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2023"><span class="MJXp-mn" id="MJXp-Span-2024">3</span></span></span><script type="math/tex" id="MathJax-Element-263">3</script>. How to optimize it?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint8</b><div class="spoiler-content" style="display: block;"><p>Consider <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2025"><span class="MJXp-msubsup" id="MJXp-Span-2026"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2027" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2028" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2029" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2030"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2031" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2032" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-264">S_i=S_j</script>. This actually provides an unordered pair. In other words, we know unordered pair <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2033"><span class="MJXp-mo" id="MJXp-Span-2034" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2035"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2036" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2037" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2038" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2039"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2040" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2041" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-2042" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2043" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2044" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2045">x</span><span class="MJXp-mo" id="MJXp-Span-2046" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2047">y</span><span class="MJXp-mo" id="MJXp-Span-2048" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-265">(p_i,p_j)=(x,y)</script>, but we can not determine whether <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2049"><span class="MJXp-msubsup" id="MJXp-Span-2050"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2051" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2052" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2053" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2054">x</span></span></span><script type="math/tex" id="MathJax-Element-266">p_i=x</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2055"><span class="MJXp-msubsup" id="MJXp-Span-2056"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2057" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2058" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-2059" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2060">x</span></span></span><script type="math/tex" id="MathJax-Element-267">p_j=x</script>. To determine it, we can add one of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2061"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2062">x</span></span></span><script type="math/tex" id="MathJax-Element-268">x</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2063"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2064">y</span></span></span><script type="math/tex" id="MathJax-Element-269">y</script> to the query of type <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2065"><span class="MJXp-mn" id="MJXp-Span-2066">4</span></span></span><script type="math/tex" id="MathJax-Element-270">4</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint9</b><div class="spoiler-content" style="display: block;"><p>Suppose there are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2067"><span class="MJXp-mn" id="MJXp-Span-2068">300</span></span></span><script type="math/tex" id="MathJax-Element-271">300</script> unordered pairs <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2069"><span class="MJXp-mo" id="MJXp-Span-2070" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2071"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2072" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2073" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2074" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2075"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2076" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2077" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2078" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2079" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2080" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2081"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2082" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2083" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2084" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2085"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2086" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2087" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2088" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2089" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2090" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2091" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2092" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2093"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2094" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2095" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2096">300</span></span></span><span class="MJXp-mo" id="MJXp-Span-2097" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2098"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2099" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2100" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2101">300</span></span></span><span class="MJXp-mo" id="MJXp-Span-2102" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-272">(x_1, y_1), (x_2, y_2), …, (x_{300}, y_{300})</script>. We can add one element of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2103"><span class="MJXp-mo" id="MJXp-Span-2104" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2105"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2106" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2107" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2108" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2110" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2111" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2112" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-273">(x_i, y_i)</script> into query <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2113"><span class="MJXp-mn" id="MJXp-Span-2114">4</span></span></span><script type="math/tex" id="MathJax-Element-274">4</script>, then query to determine all unordered pairs. However, the average cost is still near to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2115"><span class="MJXp-mn" id="MJXp-Span-2116">3</span></span></span><script type="math/tex" id="MathJax-Element-275">3</script>, which is no better than the easy version.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint10</b><div class="spoiler-content" style="display: block;"><p>Try to determine <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2117"><span class="MJXp-mn" id="MJXp-Span-2118">435</span></span></span><script type="math/tex" id="MathJax-Element-276">435</script> unordered pairs using single query <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2119"><span class="MJXp-mn" id="MJXp-Span-2120">4</span></span></span><script type="math/tex" id="MathJax-Element-277">4</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial (easy version)</b><div class="spoiler-content" style="display: block;"><p>Use only operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2121"><span class="MJXp-mn" id="MJXp-Span-2122">1</span></span></span><script type="math/tex" id="MathJax-Element-278">1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2123"><span class="MJXp-mn" id="MJXp-Span-2124">3</span></span></span><script type="math/tex" id="MathJax-Element-279">3</script>, with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2125"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2126">m</span><span class="MJXp-mo" id="MJXp-Span-2127" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2128">30</span></span></span><script type="math/tex" id="MathJax-Element-280">m=30</script> in operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2129"><span class="MJXp-mn" id="MJXp-Span-2130">1</span></span></span><script type="math/tex" id="MathJax-Element-281">1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2132">m</span><span class="MJXp-mo" id="MJXp-Span-2133" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2134">300</span></span></span><script type="math/tex" id="MathJax-Element-282">m=300</script> in operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2135"><span class="MJXp-mn" id="MJXp-Span-2136">3</span></span></span><script type="math/tex" id="MathJax-Element-283">3</script>. </p><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2137"><span class="MJXp-msubsup" id="MJXp-Span-2138"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2139" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2140" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-284">S_i</script> represent the set accessed by query element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2141"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2142">i</span></span></span><script type="math/tex" id="MathJax-Element-285">i</script>. To distinguish all elements, we need to ensure that all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2143"><span class="MJXp-msubsup" id="MJXp-Span-2144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2145" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2146" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-286">S_i</script> (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2147"><span class="MJXp-mn" id="MJXp-Span-2148">1</span><span class="MJXp-mo" id="MJXp-Span-2149" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2150">i</span><span class="MJXp-mo" id="MJXp-Span-2151" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2152">n</span></span></span><script type="math/tex" id="MathJax-Element-287">1 \le i \le n</script>) are distinct. </p><p>After selecting all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2153"><span class="MJXp-msubsup" id="MJXp-Span-2154"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2155" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2156" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-288">S_i</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2157"><span class="MJXp-mrow" id="MJXp-Span-2158"><span class="MJXp-mo" id="MJXp-Span-2159" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-2160"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2161" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2162" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mrow" id="MJXp-Span-2163"><span class="MJXp-mo" id="MJXp-Span-2164" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2165" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-2166">3</span></span></span><script type="math/tex" id="MathJax-Element-289">|S_i| < 3</script>, we must also construct a set of size <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2167"><span class="MJXp-mn" id="MJXp-Span-2168">3</span></span></span><script type="math/tex" id="MathJax-Element-290">3</script> to reach the upper bound. </p><p>Another way to phrase this: We have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2169"><span class="MJXp-mn" id="MJXp-Span-2170">30</span></span></span><script type="math/tex" id="MathJax-Element-291">30</script> numbers <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2171"><span class="MJXp-mn" id="MJXp-Span-2172">1</span><span class="MJXp-mo" id="MJXp-Span-2173" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2174">2</span><span class="MJXp-mo" id="MJXp-Span-2175" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2176" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2177" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2178">30</span></span></span><script type="math/tex" id="MathJax-Element-292">1, 2, \ldots, 30</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2179"><span class="MJXp-mn" id="MJXp-Span-2180">1</span></span></span><script type="math/tex" id="MathJax-Element-293">1</script> through <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2181"><span class="MJXp-mn" id="MJXp-Span-2182">29</span></span></span><script type="math/tex" id="MathJax-Element-294">29</script> can each be used <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2183"><span class="MJXp-mn" id="MJXp-Span-2184">30</span></span></span><script type="math/tex" id="MathJax-Element-295">30</script> times, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2185"><span class="MJXp-mn" id="MJXp-Span-2186">30</span></span></span><script type="math/tex" id="MathJax-Element-296">30</script> can be used <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2187"><span class="MJXp-mn" id="MJXp-Span-2188">270</span></span></span><script type="math/tex" id="MathJax-Element-297">270</script> times. The goal is to construct as many distinct triplets as possible to maximize the count. </p><p>A natural approach is to prioritize consuming the usage count of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2189"><span class="MJXp-mn" id="MJXp-Span-2190">30</span></span></span><script type="math/tex" id="MathJax-Element-298">30</script>. Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2191"><span class="MJXp-mn" id="MJXp-Span-2192">29</span></span></span><script type="math/tex" id="MathJax-Element-299">29</script> is prime, the sequence <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2193"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2194">x</span><span class="MJXp-mo" id="MJXp-Span-2195" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2196" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-2197">1</span><span class="MJXp-mo" id="MJXp-Span-2198" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2199">k</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-2200"><span class="MJXp-mspace" id="MJXp-Span-2201" style="width: 0.667em; height: 0em;"></span></span><span class="MJXp-mi" id="MJXp-Span-2202">mod</span><span class="MJXp-mspace" id="MJXp-Span-2203" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-2204" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-2205">29</span><span class="MJXp-mo" id="MJXp-Span-2206" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2207">1</span><span class="MJXp-mo" id="MJXp-Span-2208" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2209">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2210">k</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-2211"><span class="MJXp-mspace" id="MJXp-Span-2212" style="width: 0.667em; height: 0em;"></span></span><span class="MJXp-mi" id="MJXp-Span-2213">mod</span><span class="MJXp-mspace" id="MJXp-Span-2214" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-2215" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-2216">29</span><span class="MJXp-mo" id="MJXp-Span-2217" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2218">1</span><span class="MJXp-mo" id="MJXp-Span-2219" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2220" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2221" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2222">28</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2223">k</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-2224"><span class="MJXp-mspace" id="MJXp-Span-2225" style="width: 0.667em; height: 0em;"></span></span><span class="MJXp-mi" id="MJXp-Span-2226">mod</span><span class="MJXp-mspace" id="MJXp-Span-2227" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-2228" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-2229">29</span><span class="MJXp-mo" id="MJXp-Span-2230" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2231">1</span><span class="MJXp-mo" id="MJXp-Span-2232" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-300">x = [1, k \mod 29 + 1, 2k \mod 29 + 1, \ldots, 28k \mod 29 + 1]</script> ensures all elements are distinct. For <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2233"><span class="MJXp-mn" id="MJXp-Span-2234">1</span><span class="MJXp-mo" id="MJXp-Span-2235" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2236">k</span><span class="MJXp-mo" id="MJXp-Span-2237" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-2238">9</span></span></span><script type="math/tex" id="MathJax-Element-301">1 \le k \le 9</script>, we can construct triplets <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2239"><span class="MJXp-mo" id="MJXp-Span-2240" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2241"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2242" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2243" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2244" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2245"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2246" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2247" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2248" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2249">30</span><span class="MJXp-mo" id="MJXp-Span-2250" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2251" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2252" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2253"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2254" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2255" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2256" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2257"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2258" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2259" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-2260" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2261">30</span><span class="MJXp-mo" id="MJXp-Span-2262" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2263" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2264" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2265" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2266" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2267"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2268" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2269" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2270">29</span></span></span><span class="MJXp-mo" id="MJXp-Span-2271" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2273" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2274" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2275" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2276">30</span><span class="MJXp-mo" id="MJXp-Span-2277" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-302">(x_1, x_2, 30), (x_2, x_3, 30), \ldots, (x_{29}, x_1, 30)</script>. </p><p>After this, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2278"><span class="MJXp-mn" id="MJXp-Span-2279">1</span></span></span><script type="math/tex" id="MathJax-Element-303">1</script> through <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2280"><span class="MJXp-mn" id="MJXp-Span-2281">29</span></span></span><script type="math/tex" id="MathJax-Element-304">29</script> will each have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2282"><span class="MJXp-mn" id="MJXp-Span-2283">12</span></span></span><script type="math/tex" id="MathJax-Element-305">12</script> remaining uses, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2284"><span class="MJXp-mn" id="MJXp-Span-2285">30</span></span></span><script type="math/tex" id="MathJax-Element-306">30</script> will have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2286"><span class="MJXp-mn" id="MJXp-Span-2287">9</span></span></span><script type="math/tex" id="MathJax-Element-307">9</script> remaining uses. This distribution is not ideal. Instead, we can use <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2288"><span class="MJXp-mo" id="MJXp-Span-2289" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2290">1</span><span class="MJXp-mo" id="MJXp-Span-2291" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2292">2</span><span class="MJXp-mo" id="MJXp-Span-2293" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2294">3</span><span class="MJXp-mo" id="MJXp-Span-2295" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-308">(1, 2, 3)</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2296"><span class="MJXp-mo" id="MJXp-Span-2297" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2298">4</span><span class="MJXp-mo" id="MJXp-Span-2299" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2300">5</span><span class="MJXp-mo" id="MJXp-Span-2301" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2302">6</span><span class="MJXp-mo" id="MJXp-Span-2303" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-309">(4, 5, 6)</script> in place of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2304"><span class="MJXp-mo" id="MJXp-Span-2305" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2306">1</span><span class="MJXp-mo" id="MJXp-Span-2307" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2308">2</span><span class="MJXp-mo" id="MJXp-Span-2309" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2310">30</span><span class="MJXp-mo" id="MJXp-Span-2311" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2312" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2313" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2314">3</span><span class="MJXp-mo" id="MJXp-Span-2315" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2316">4</span><span class="MJXp-mo" id="MJXp-Span-2317" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2318">30</span><span class="MJXp-mo" id="MJXp-Span-2319" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2320" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span><script type="math/tex" id="MathJax-Element-310">(1, 2, 30), (3, 4, 30),</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2321"><span class="MJXp-mo" id="MJXp-Span-2322" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2323">5</span><span class="MJXp-mo" id="MJXp-Span-2324" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2325">6</span><span class="MJXp-mo" id="MJXp-Span-2326" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2327">30</span><span class="MJXp-mo" id="MJXp-Span-2328" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-311">(5, 6, 30)</script>. This adjustment ensures that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2329"><span class="MJXp-mn" id="MJXp-Span-2330">1</span></span></span><script type="math/tex" id="MathJax-Element-312">1</script> through <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2331"><span class="MJXp-mn" id="MJXp-Span-2332">30</span></span></span><script type="math/tex" id="MathJax-Element-313">30</script> each have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2333"><span class="MJXp-mn" id="MJXp-Span-2334">12</span></span></span><script type="math/tex" id="MathJax-Element-314">12</script> remaining uses. </p><p>Define a <strong>perfect set</strong> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2335"><span class="MJXp-msubsup" id="MJXp-Span-2336"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2337" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2338" style="vertical-align: -0.4em;">x</span></span></span></span><script type="math/tex" id="MathJax-Element-315">S_x</script> as a set of triplets where each number from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2339"><span class="MJXp-mn" id="MJXp-Span-2340">1</span></span></span><script type="math/tex" id="MathJax-Element-316">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2341"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2342">x</span></span></span><script type="math/tex" id="MathJax-Element-317">x</script> appears exactly once. </p><p>For numbers <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2343"><span class="MJXp-mn" id="MJXp-Span-2344">1</span><span class="MJXp-mo" id="MJXp-Span-2345" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2346">2</span><span class="MJXp-mo" id="MJXp-Span-2347" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2348" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2349" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2350">3</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2351">l</span></span></span><script type="math/tex" id="MathJax-Element-318">1, 2, \ldots, 3l</script>, define: </p> <ul>   <li><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2352"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2353">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2354">l</span><span class="MJXp-mo" id="MJXp-Span-2355" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2356" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-2357">1</span><span class="MJXp-mo" id="MJXp-Span-2358" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2359">2</span><span class="MJXp-mo" id="MJXp-Span-2360" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2361" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2362" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2363">l</span><span class="MJXp-mo" id="MJXp-Span-2364" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-319">al = [1, 2, \ldots, l]</script>,</p></li>   <li><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2365"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2366">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2367">m</span><span class="MJXp-mo" id="MJXp-Span-2368" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2369" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2370">l</span><span class="MJXp-mo" id="MJXp-Span-2371" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2372">1</span><span class="MJXp-mo" id="MJXp-Span-2373" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2374">l</span><span class="MJXp-mo" id="MJXp-Span-2375" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2376">2</span><span class="MJXp-mo" id="MJXp-Span-2377" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2378" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2379" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2380">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2381">l</span><span class="MJXp-mo" id="MJXp-Span-2382" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-320">am = [l+1, l+2, \ldots, 2l]</script>, </p></li>   <li><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2384">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2385">r</span><span class="MJXp-mo" id="MJXp-Span-2386" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2387" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-2388">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2389">l</span><span class="MJXp-mo" id="MJXp-Span-2390" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2391">1</span><span class="MJXp-mo" id="MJXp-Span-2392" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2393">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2394">l</span><span class="MJXp-mo" id="MJXp-Span-2395" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2396">2</span><span class="MJXp-mo" id="MJXp-Span-2397" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2398" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2399" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2400">3</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2401">l</span><span class="MJXp-mo" id="MJXp-Span-2402" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-321">ar = [2l+1, 2l+2, \ldots, 3l]</script>. </p></li> </ul><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2403"><span class="MJXp-mtext" id="MJXp-Span-2404">lshift</span><span class="MJXp-mo" id="MJXp-Span-2405" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2406">a</span><span class="MJXp-mo" id="MJXp-Span-2407" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2408">i</span><span class="MJXp-mo" id="MJXp-Span-2409" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2410" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2411" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-2412"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2413" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2414" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2415">1</span><span class="MJXp-mo" id="MJXp-Span-2416">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2417">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-2418" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2419"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2420" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2421" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2422">2</span><span class="MJXp-mo" id="MJXp-Span-2423">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2424">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-2425" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2426" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2427" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2428"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2429" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2430" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-2431">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2432">n</span><span class="MJXp-mo" id="MJXp-Span-2433">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2434">i</span><span class="MJXp-mo" id="MJXp-Span-2435">−</span><span class="MJXp-mn" id="MJXp-Span-2436">1</span><span class="MJXp-mo" id="MJXp-Span-2437">)</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-2438"><span class="MJXp-mspace" id="MJXp-Span-2439" style="width: 0.667em; height: 0em;"></span></span><span class="MJXp-mi" id="MJXp-Span-2440">mod</span><span class="MJXp-mspace" id="MJXp-Span-2441" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-2442" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2443">n</span><span class="MJXp-mo" id="MJXp-Span-2444">+</span><span class="MJXp-mn" id="MJXp-Span-2445">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2446" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-322">\text{lshift}(a, i) = [a_{1+i}, a_{2+i}, \ldots, a_{(n+i-1) \mod n + 1}]</script>. Then, define: </p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2447"><span class="MJXp-msubsup" id="MJXp-Span-2448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2449" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2450" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-2451" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-2452">al</span><span class="MJXp-mo" id="MJXp-Span-2453" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-2454">am</span><span class="MJXp-mo" id="MJXp-Span-2455" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-2456">ar</span><span class="MJXp-mo" id="MJXp-Span-2457" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2458" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2459" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mo" id="MJXp-Span-2460" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2461"><span class="MJXp-mtext" id="MJXp-Span-2462" style="margin-right: 0.05em;">al</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2463" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2464" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2465"><span class="MJXp-mtext" id="MJXp-Span-2466" style="margin-right: 0.05em;">am</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2467" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2468" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2469"><span class="MJXp-mtext" id="MJXp-Span-2470" style="margin-right: 0.05em;">ar</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2471" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2472" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2473" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2474" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2475"><span class="MJXp-mtext" id="MJXp-Span-2476" style="margin-right: 0.05em;">al</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2477" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2478" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2479"><span class="MJXp-mtext" id="MJXp-Span-2480" style="margin-right: 0.05em;">am</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2481" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2482" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2483"><span class="MJXp-mtext" id="MJXp-Span-2484" style="margin-right: 0.05em;">ar</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2485" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2486" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2487" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2488" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2489" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2490" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2491"><span class="MJXp-mtext" id="MJXp-Span-2492" style="margin-right: 0.05em;">al</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2493" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-2494" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2495"><span class="MJXp-mtext" id="MJXp-Span-2496" style="margin-right: 0.05em;">am</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2497" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-2498" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2499"><span class="MJXp-mtext" id="MJXp-Span-2500" style="margin-right: 0.05em;">ar</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2501" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-2502" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2503" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><script type="math/tex" id="MathJax-Element-323"> S_l(\text{al}, \text{am}, \text{ar}) = \{(\text{al}_1, \text{am}_1, \text{ar}_1), (\text{al}_2, \text{am}_2, \text{ar}_2), \ldots, (\text{al}_l, \text{am}_l, \text{ar}_l)\} </script></center><p>We can generate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2504"><span class="MJXp-msubsup" id="MJXp-Span-2505"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2506" style="margin-right: 0.05em;">l</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2507" style="vertical-align: 0.5em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-324">l^2</script> distinct perfect sets of the form <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2508"><span class="MJXp-msubsup" id="MJXp-Span-2509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2510" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2511" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-2512" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2513">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2514">l</span><span class="MJXp-mo" id="MJXp-Span-2515" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-2516">lshift</span><span class="MJXp-mo" id="MJXp-Span-2517" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2518">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2519">m</span><span class="MJXp-mo" id="MJXp-Span-2520" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2521">i</span><span class="MJXp-mo" id="MJXp-Span-2522" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2523" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-2524">lshift</span><span class="MJXp-mo" id="MJXp-Span-2525" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2526">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2527">r</span><span class="MJXp-mo" id="MJXp-Span-2528" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2529">j</span><span class="MJXp-mo" id="MJXp-Span-2530" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2531" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-325">S_l(al, \text{lshift}(am, i), \text{lshift}(ar, j))</script> for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2532"><span class="MJXp-mn" id="MJXp-Span-2533">0</span><span class="MJXp-mo" id="MJXp-Span-2534" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2535">i</span><span class="MJXp-mo" id="MJXp-Span-2536" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2537">j</span><span class="MJXp-mo" id="MJXp-Span-2538" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2539">l</span></span></span><script type="math/tex" id="MathJax-Element-326">0 \le i, j \le l</script>. </p><p>Now that all numbers have equal remaining usage counts, we can apply the above construction. </p><p>Using the above construction, there are many different approaches.</p><p>Overall, we can construct a total of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2540"><span class="MJXp-mn" id="MJXp-Span-2541">846</span></span></span><script type="math/tex" id="MathJax-Element-327">846</script> distinct sets, which is sufficient to pass the easy version.</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial (hard version)</b><div class="spoiler-content" style="display: block;"><p>The hard version differs significantly from the easy version in its approach, particularly in utilizing the concept of distinguishing elements through <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2542"><span class="MJXp-msubsup" id="MJXp-Span-2543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2544" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2545" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-328">S_i</script>.</p><p>We need to efficiently utilize the four operations, and the condition <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2546"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2547">m</span><span class="MJXp-mo" id="MJXp-Span-2548" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2549">k</span></span></span><script type="math/tex" id="MathJax-Element-329">m>k</script>.</p><p>In this solution, use operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2550"><span class="MJXp-mn" id="MJXp-Span-2551">2</span></span></span><script type="math/tex" id="MathJax-Element-330">2</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2552"><span class="MJXp-mn" id="MJXp-Span-2553">29</span></span></span><script type="math/tex" id="MathJax-Element-331">29</script> times and operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2554"><span class="MJXp-mn" id="MJXp-Span-2555">3</span></span></span><script type="math/tex" id="MathJax-Element-332">3</script> once.</p><p>Consider all sets <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2556"><span class="MJXp-msubsup" id="MJXp-Span-2557"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2558" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2559" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-333">S_i</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2560"><span class="MJXp-mrow" id="MJXp-Span-2561"><span class="MJXp-mo" id="MJXp-Span-2562" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-2563"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2564" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2565" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mrow" id="MJXp-Span-2566"><span class="MJXp-mo" id="MJXp-Span-2567" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2568" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-2569">3</span></span></span><script type="math/tex" id="MathJax-Element-334">|S_i|<3</script> and elements in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2570"><span class="MJXp-mo" id="MJXp-Span-2571" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-2572">1</span><span class="MJXp-mo" id="MJXp-Span-2573" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2574">29</span><span class="MJXp-mo" id="MJXp-Span-2575" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-335">[1,29]</script>, assigning each to exactly two indices, yielding <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2576"><span class="MJXp-mn" id="MJXp-Span-2577">2</span><span class="MJXp-mo" id="MJXp-Span-2578" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mo" id="MJXp-Span-2579" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2580">1</span><span class="MJXp-mo" id="MJXp-Span-2581" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2582">29</span><span class="MJXp-mo" id="MJXp-Span-2583" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-2584" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2585">29</span><span class="MJXp-mo" id="MJXp-Span-2586">×</span><span class="MJXp-mn" id="MJXp-Span-2587">28</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2588">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2589" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2590" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2591">872</span></span></span><script type="math/tex" id="MathJax-Element-336">2×(1+29+\frac{29×28}{2})=872</script> sets forming 436 unordered pairs where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2592"><span class="MJXp-msubsup" id="MJXp-Span-2593"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2594" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2595" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2596" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2597"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2598" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2599" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-337">S_i=S_j</script>, where we cannot initially determine whether <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2600"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2601">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2602">o</span><span class="MJXp-msubsup" id="MJXp-Span-2603"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2604" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2605" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2606" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2607">x</span></span></span><script type="math/tex" id="MathJax-Element-338">pos_i = x</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2608"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2609">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2610">o</span><span class="MJXp-msubsup" id="MJXp-Span-2611"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2612" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2613" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-2614" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2615">x</span></span></span><script type="math/tex" id="MathJax-Element-339">pos_j = x</script>.</p><p>Consider <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2616"><span class="MJXp-msubsup" id="MJXp-Span-2617"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2618" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2619" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2620" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2621"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2622" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2623" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-340">S_i = S_j</script>. This actually provides an unordered pair <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2624"><span class="MJXp-mo" id="MJXp-Span-2625" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2626">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2627">o</span><span class="MJXp-msubsup" id="MJXp-Span-2628"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2629" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2630" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2631" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2632">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2633">o</span><span class="MJXp-msubsup" id="MJXp-Span-2634"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2635" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2636" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-2637" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2638" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2639" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2640">x</span><span class="MJXp-mo" id="MJXp-Span-2641" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2642">y</span><span class="MJXp-mo" id="MJXp-Span-2643" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-341">(pos_i, pos_j) = (x, y)</script>, where we know the pair of positions but cannot determine whether <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2644"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2645">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2646">o</span><span class="MJXp-msubsup" id="MJXp-Span-2647"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2648" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2649" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2650" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2651">x</span></span></span><script type="math/tex" id="MathJax-Element-342">pos_i = x</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2652"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2653">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2654">o</span><span class="MJXp-msubsup" id="MJXp-Span-2655"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2656" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2657" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-2658" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2659">y</span></span></span><script type="math/tex" id="MathJax-Element-343">pos_j = y</script>, or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2660"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2661">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2662">o</span><span class="MJXp-msubsup" id="MJXp-Span-2663"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2664" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2665" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2666" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2667">y</span></span></span><script type="math/tex" id="MathJax-Element-344">pos_i = y</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2668"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2669">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2670">o</span><span class="MJXp-msubsup" id="MJXp-Span-2671"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2672" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2673" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-2674" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2675">x</span></span></span><script type="math/tex" id="MathJax-Element-345">pos_j = x</script>.</p><p>Let these <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2676"><span class="MJXp-mfrac" id="MJXp-Span-2677" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2678">872</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2679">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2680" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2681">436</span></span></span><script type="math/tex" id="MathJax-Element-346">\frac{872}{2} = 436</script> pairs be denoted as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2682"><span class="MJXp-mo" id="MJXp-Span-2683" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2684">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2685">o</span><span class="MJXp-msubsup" id="MJXp-Span-2686"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2687" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2688" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2689" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2690">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2691">o</span><span class="MJXp-msubsup" id="MJXp-Span-2692"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2693" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2694" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-2695" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2696" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2697" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2698">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2699">o</span><span class="MJXp-msubsup" id="MJXp-Span-2700"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2701" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2702" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2703" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2704">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2705">o</span><span class="MJXp-msubsup" id="MJXp-Span-2706"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2707" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2708" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2709">n</span><span class="MJXp-mo" id="MJXp-Span-2710">−</span><span class="MJXp-mn" id="MJXp-Span-2711">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2712" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2713" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2714" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2715" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2716" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2717">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2718">o</span><span class="MJXp-msubsup" id="MJXp-Span-2719"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2720" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2721" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2722">436</span></span></span><span class="MJXp-mo" id="MJXp-Span-2723" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2724">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2725">o</span><span class="MJXp-msubsup" id="MJXp-Span-2726"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2727" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2728" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2729">n</span><span class="MJXp-mo" id="MJXp-Span-2730">−</span><span class="MJXp-mn" id="MJXp-Span-2731">435</span></span></span><span class="MJXp-mo" id="MJXp-Span-2732" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-347">(pos_1, pos_n), (pos_2, pos_{n-1}), \ldots, (pos_{436}, pos_{n-435})</script> (for convenience, we assume <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2733"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2734">n</span><span class="MJXp-mo" id="MJXp-Span-2735" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2736">890</span></span></span><script type="math/tex" id="MathJax-Element-348">n = 890</script>). Then, randomly select exactly one <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2737"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2738">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2739">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2740">s</span></span></span><script type="math/tex" id="MathJax-Element-349">pos</script> from each of these pairs, and query the maximum value (considering only one maximum for now) among <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2741"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2742">p</span><span class="MJXp-mo" id="MJXp-Span-2743" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2744">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2745">o</span><span class="MJXp-msubsup" id="MJXp-Span-2746"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2747" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2748" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mtext" id="MJXp-Span-2749">&nbsp;or&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2750">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2751">o</span><span class="MJXp-msubsup" id="MJXp-Span-2752"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2753" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2754" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-2755" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-2756" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2757">p</span><span class="MJXp-mo" id="MJXp-Span-2758" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2759">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2760">o</span><span class="MJXp-msubsup" id="MJXp-Span-2761"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2762" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2763" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-2764">&nbsp;or&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2765">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2766">o</span><span class="MJXp-msubsup" id="MJXp-Span-2767"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2768" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2769" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2770">n</span><span class="MJXp-mo" id="MJXp-Span-2771">−</span><span class="MJXp-mn" id="MJXp-Span-2772">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2773" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-2774" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2775" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex" id="MathJax-Element-350">p[pos_1 \text{ or } pos_n], p[pos_2 \text{ or } pos_{n-1}], \ldots</script>.</p><p>Let us analyze what will happen:</p> <table class="bordertable">   <thead>     <tr>       <th>Return Value </th>       <th>Pairs Determined </th>       <th>Probability </th>     </tr>   </thead>   <tbody>     <tr>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2776"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2777">n</span></span></span><script type="math/tex" id="MathJax-Element-351">n</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2778"><span class="MJXp-mn" id="MJXp-Span-2779">1</span></span></span><script type="math/tex" id="MathJax-Element-352">1</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2780"><span class="MJXp-mfrac" id="MJXp-Span-2781" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2782">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2783">2</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-353">\frac{1}{2}</script> </td>     </tr>     <tr>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2784"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2785">n</span><span class="MJXp-mo" id="MJXp-Span-2786" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2787">1</span></span></span><script type="math/tex" id="MathJax-Element-354">n-1</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2788"><span class="MJXp-mn" id="MJXp-Span-2789">2</span></span></span><script type="math/tex" id="MathJax-Element-355">2</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2790"><span class="MJXp-mfrac" id="MJXp-Span-2791" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2792">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2793">4</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-356">\frac{1}{4}</script> </td>     </tr>     <tr>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2794"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2795">n</span><span class="MJXp-mo" id="MJXp-Span-2796" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2797">2</span></span></span><script type="math/tex" id="MathJax-Element-357">n-2</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2798"><span class="MJXp-mn" id="MJXp-Span-2799">3</span></span></span><script type="math/tex" id="MathJax-Element-358">3</script> </td>       <td><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2800"><span class="MJXp-mfrac" id="MJXp-Span-2801" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2802">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2803">8</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-359">\frac{1}{8}</script> </td>     </tr>     <tr>       <td>... </td>       <td>... </td>       <td>... </td>     </tr>   </tbody> </table><p>We can see ehe expected number of resolved pairs per query:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2804"><span class="MJXp-mn" id="MJXp-Span-2805">1</span><span class="MJXp-mo" id="MJXp-Span-2806" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mfrac" id="MJXp-Span-2807" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2808">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2809">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2810" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2811">2</span><span class="MJXp-mo" id="MJXp-Span-2812" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mfrac" id="MJXp-Span-2813" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2814">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2815">4</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2816" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2817">3</span><span class="MJXp-mo" id="MJXp-Span-2818" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mfrac" id="MJXp-Span-2819" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2820">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2821">8</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2822" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-2823" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-2824" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-mn" id="MJXp-Span-2825">2</span></span></span><script type="math/tex" id="MathJax-Element-360">1 \times \frac{1}{2} + 2 \times \frac{1}{4} + 3 \times \frac{1}{8} + \dots \approx 2</script></center><p>With an expectation value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2826"><span class="MJXp-mn" id="MJXp-Span-2827">2</span></span></span><script type="math/tex" id="MathJax-Element-361">2</script>, we can estimate that performing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2828"><span class="MJXp-mtext" id="MJXp-Span-2829">max</span></span></span><script type="math/tex" id="MathJax-Element-362">\text{max}</script> query <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2830"><span class="MJXp-mn" id="MJXp-Span-2831">300</span></span></span><script type="math/tex" id="MathJax-Element-363">300</script> times yields a high probability <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2832"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2833">P</span><span class="MJXp-mo" id="MJXp-Span-2834" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-mn" id="MJXp-Span-2835">1</span></span></span><script type="math/tex" id="MathJax-Element-364">P \approx 1</script> of determining all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2836"><span class="MJXp-mn" id="MJXp-Span-2837">436</span></span></span><script type="math/tex" id="MathJax-Element-365">436</script> unordered pairs <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2838"><span class="MJXp-mo" id="MJXp-Span-2839" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2840">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2841">o</span><span class="MJXp-msubsup" id="MJXp-Span-2842"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2843" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2844" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2845" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2846">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2847">o</span><span class="MJXp-msubsup" id="MJXp-Span-2848"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2849" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2850" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-2851" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-366">(pos_i, pos_j)</script>. This implies that a single application of operation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2852"><span class="MJXp-mn" id="MJXp-Span-2853">3</span></span></span><script type="math/tex" id="MathJax-Element-367">3</script> suffices to resolve all such pairs.</p><p>Through this methodology, we successfully determine <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2854"><span class="MJXp-mn" id="MJXp-Span-2855">872</span></span></span><script type="math/tex" id="MathJax-Element-368">872</script> elements of the permutation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2856"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2857">p</span></span></span><script type="math/tex" id="MathJax-Element-369">p</script>. At this stage, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2858"><span class="MJXp-mn" id="MJXp-Span-2859">29</span></span></span><script type="math/tex" id="MathJax-Element-370">29</script> query operations remain available (with exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2860"><span class="MJXp-mn" id="MJXp-Span-2861">2</span></span></span><script type="math/tex" id="MathJax-Element-371">2</script> uses permitted), and the determination of all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2862"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2863">n</span><span class="MJXp-mo" id="MJXp-Span-2864" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2865">890</span></span></span><script type="math/tex" id="MathJax-Element-372">n=890</script> elements becomes computationally tractable.</p> <div class="spoiler"><b class="spoiler-title">Failure probability analysis</b><div class="spoiler-content" style="display: block;"><p>Mathematically, this follows a geometric distribution with success probability <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2866"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2867">p</span><span class="MJXp-mo" id="MJXp-Span-2868" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2869" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2870">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2871">2</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-373">p = \frac{1}{2}</script> where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2872"><span class="MJXp-mrow" id="MJXp-Span-2873"><span class="MJXp-mi undefined" id="MJXp-Span-2874">P</span></span><span class="MJXp-mo" id="MJXp-Span-2875" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2876">X</span><span class="MJXp-mo" id="MJXp-Span-2877" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2878">i</span><span class="MJXp-mo" id="MJXp-Span-2879" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2880" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2881"><span class="MJXp-mn" id="MJXp-Span-2882" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2883" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2884">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2885">i</span></span></span></span></span><script type="math/tex" id="MathJax-Element-374">\mathbb{P}(X = i) = 2^{-i}</script>, and the sum of such geometric random variables yields a negative binomial distribution <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2886"><span class="MJXp-mtext" id="MJXp-Span-2887">NB</span><span class="MJXp-mo" id="MJXp-Span-2888" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2889">r</span><span class="MJXp-mo" id="MJXp-Span-2890" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2891">p</span><span class="MJXp-mo" id="MJXp-Span-2892" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-375">\text{NB}(r,p)</script>. For large <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2893"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2894">n</span></span></span><script type="math/tex" id="MathJax-Element-376">n</script>, this can be approximated by a normal distribution <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2895"><span class="MJXp-mrow" id="MJXp-Span-2896"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2897">N</span></span><span class="MJXp-mo" id="MJXp-Span-2898" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2899">μ</span><span class="MJXp-mo" id="MJXp-Span-2900" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2901"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2902" style="margin-right: 0.05em;">σ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2903" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2904" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-377">\mathcal{N}(\mu, \sigma^2)</script> via the Central Limit Theorem, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2905"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2906">μ</span><span class="MJXp-mo" id="MJXp-Span-2907" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2908" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2909">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2910">p</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2911" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2912">2</span></span></span><script type="math/tex" id="MathJax-Element-378">\mu = \frac{1}{p} = 2</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2913"><span class="MJXp-msubsup" id="MJXp-Span-2914"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2915" style="margin-right: 0.05em;">σ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2916" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2917" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2918" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2919">1</span><span class="MJXp-mo" id="MJXp-Span-2920">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2921">p</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-2922"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2923" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2924" style="vertical-align: 0.5em;">2</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2925" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2926">2</span></span></span><script type="math/tex" id="MathJax-Element-379">\sigma^2 = \frac{1-p}{p^2} = 2</script>.</p><h2>Probability that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2927"><span class="MJXp-msubsup" id="MJXp-Span-2928"><span class="MJXp-mo" id="MJXp-Span-2929" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2934"><span class="MJXp-mn" id="MJXp-Span-2935">300</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2930"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2931">i</span><span class="MJXp-mo" id="MJXp-Span-2932">=</span><span class="MJXp-mn" id="MJXp-Span-2933">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2936"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2937" style="margin-right: 0.05em;">X</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2938" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2939" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-2940">435</span></span></span><script type="math/tex" id="MathJax-Element-380">\sum_{i=1}^{300} X_i \le 435</script></h2><p><strong>Given.</strong> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2941"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2942">X</span></span></span><script type="math/tex" id="MathJax-Element-381">X</script> is discrete with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2943"><span class="MJXp-mrow" id="MJXp-Span-2944"><span class="MJXp-mi undefined" id="MJXp-Span-2945">P</span></span><span class="MJXp-mo" id="MJXp-Span-2946" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2947">X</span><span class="MJXp-mo" id="MJXp-Span-2948" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2949">k</span><span class="MJXp-mo" id="MJXp-Span-2950" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2951" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2952"><span class="MJXp-mn" id="MJXp-Span-2953" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2954" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2955">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2956">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2957" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-2958" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2959">k</span><span class="MJXp-mo" id="MJXp-Span-2960" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2961">1</span><span class="MJXp-mo" id="MJXp-Span-2962" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2963">2</span><span class="MJXp-mo" id="MJXp-Span-2964" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2965" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex" id="MathJax-Element-382"> \mathbb{P}(X=k)=2^{-k},\; k=1,2,\dots</script>. Thus <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2966"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2967">X</span><span class="MJXp-mo" id="MJXp-Span-2968" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mrow" id="MJXp-Span-2969"><span class="MJXp-mi" id="MJXp-Span-2970">G</span><span class="MJXp-mi" id="MJXp-Span-2971">e</span><span class="MJXp-mi" id="MJXp-Span-2972">o</span><span class="MJXp-mi" id="MJXp-Span-2973">m</span></span><span class="MJXp-mo" id="MJXp-Span-2974" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2975">p</span><span class="MJXp-mo" id="MJXp-Span-2976" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mstyle" id="MJXp-Span-2977"><span class="MJXp-mfrac" id="MJXp-Span-2978" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2979">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-2980">2</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2981" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-383">X\sim\mathrm{Geom}(p=\tfrac12)</script> on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2982"><span class="MJXp-mrow" id="MJXp-Span-2983"><span class="MJXp-mn" id="MJXp-Span-2984">1</span><span class="MJXp-mo" id="MJXp-Span-2985" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2986">2</span><span class="MJXp-mo" id="MJXp-Span-2987" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2988" style="margin-left: 0em; margin-right: 0em;">…</span></span></span></span><script type="math/tex" id="MathJax-Element-384">{1,2,\dots}</script> with mean <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2989"><span class="MJXp-mn" id="MJXp-Span-2990">1</span><span class="MJXp-mrow" id="MJXp-Span-2991"><span class="MJXp-mo" id="MJXp-Span-2992" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2993">p</span><span class="MJXp-mo" id="MJXp-Span-2994" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2995">2</span></span></span><script type="math/tex" id="MathJax-Element-385">1/p=2</script>.</p><h3>1) Sum–negative-binomial connection</h3><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2996"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2997">S</span><span class="MJXp-mo" id="MJXp-Span-2998" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2999"><span class="MJXp-mo" id="MJXp-Span-3000" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3005"><span class="MJXp-mn" id="MJXp-Span-3006">300</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3001"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3002">i</span><span class="MJXp-mo" id="MJXp-Span-3003">=</span><span class="MJXp-mn" id="MJXp-Span-3004">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3007"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3008" style="margin-right: 0.05em;">X</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3009" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-386">S=\sum_{i=1}^{300} X_i</script>. The sum of i.i.d. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3010"><span class="MJXp-mrow" id="MJXp-Span-3011"><span class="MJXp-mi" id="MJXp-Span-3012">G</span><span class="MJXp-mi" id="MJXp-Span-3013">e</span><span class="MJXp-mi" id="MJXp-Span-3014">o</span><span class="MJXp-mi" id="MJXp-Span-3015">m</span></span><span class="MJXp-mo" id="MJXp-Span-3016" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3017">p</span><span class="MJXp-mo" id="MJXp-Span-3018" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-387">\mathrm{Geom}(p)</script> variables is negative binomial:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3019"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3020">S</span><span class="MJXp-mo" id="MJXp-Span-3021" style="margin-left: 0.333em; margin-right: 0.333em;">∼</span><span class="MJXp-mrow" id="MJXp-Span-3022"><span class="MJXp-mi" id="MJXp-Span-3023">N</span><span class="MJXp-mi" id="MJXp-Span-3024">B</span></span><span class="MJXp-mo" id="MJXp-Span-3025" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3026">r</span><span class="MJXp-mo" id="MJXp-Span-3027" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3028">300</span><span class="MJXp-mo" id="MJXp-Span-3029" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-3030" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3031">p</span><span class="MJXp-mo" id="MJXp-Span-3032" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mstyle" id="MJXp-Span-3033"><span class="MJXp-mfrac" id="MJXp-Span-3034" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3035">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3036">2</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3037" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3038" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span><script type="math/tex" id="MathJax-Element-388"> S \sim \mathrm{NB}(r=300,\;p=\tfrac12), </script></center><p>i.e., <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3039"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3040">S</span></span></span><script type="math/tex" id="MathJax-Element-389">S</script> is the number of Bernoulli$(\tfrac12)</p><p>Unable to parse markup [type=CF_MATHJAX]</p> successes.<h3>2) Convert to a binomial tail</h3> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3041"><span class="MJXp-mrow" id="MJXp-Span-3042"><span class="MJXp-mi undefined" id="MJXp-Span-3043">P</span></span><span class="MJXp-mo" id="MJXp-Span-3044" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3045">S</span><span class="MJXp-mo" id="MJXp-Span-3046" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-3047">435</span><span class="MJXp-mo" id="MJXp-Span-3048" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3049" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3050"><span class="MJXp-mi undefined" id="MJXp-Span-3051">P</span></span><span class="MJXp-mstyle" id="MJXp-Span-3052"><span class="MJXp-mrow" id="MJXp-Span-3053"><span class="MJXp-mo" id="MJXp-Span-3054" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-3055">300th success occurs by time&nbsp;</span><span class="MJXp-mn" id="MJXp-Span-3056">435</span><span class="MJXp-mstyle" id="MJXp-Span-3057"><span class="MJXp-mrow" id="MJXp-Span-3058"><span class="MJXp-mo" id="MJXp-Span-3059" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3060" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3061"><span class="MJXp-mi undefined" id="MJXp-Span-3062">P</span></span><span class="MJXp-mstyle" id="MJXp-Span-3063"><span class="MJXp-mrow" id="MJXp-Span-3064"><span class="MJXp-mo" id="MJXp-Span-3065" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-3066"><span class="MJXp-mi" id="MJXp-Span-3067">B</span><span class="MJXp-mi" id="MJXp-Span-3068">i</span><span class="MJXp-mi" id="MJXp-Span-3069">n</span></span><span class="MJXp-mo" id="MJXp-Span-3070" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3071">n</span><span class="MJXp-mo" id="MJXp-Span-3072" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3073">435</span><span class="MJXp-mo" id="MJXp-Span-3074" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3075">p</span><span class="MJXp-mo" id="MJXp-Span-3076" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mstyle" id="MJXp-Span-3077"><span class="MJXp-mfrac" id="MJXp-Span-3078" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3079">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3080">2</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3081" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3082" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-3083">300</span><span class="MJXp-mstyle" id="MJXp-Span-3084"><span class="MJXp-mrow" id="MJXp-Span-3085"><span class="MJXp-mo" id="MJXp-Span-3086" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3087" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><script type="math/tex" id="MathJax-Element-390"> \mathbb{P}(S \le 435) = \mathbb{P}\big(\text{300th success occurs by time }435\big) = \mathbb{P}\big(\mathrm{Bin}(n=435,p=\tfrac12)\ge 300\big). </script></center><h3>3) Exact expression</h3><p>By symmetry of the binomial with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3088"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3089">p</span><span class="MJXp-mo" id="MJXp-Span-3090" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mstyle" id="MJXp-Span-3091"><span class="MJXp-mfrac" id="MJXp-Span-3092" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3093">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3094">2</span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-391">p=\tfrac12</script>,</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3095"><span class="MJXp-mrow" id="MJXp-Span-3096"><span class="MJXp-mi undefined" id="MJXp-Span-3097">P</span></span><span class="MJXp-mstyle" id="MJXp-Span-3098"><span class="MJXp-mrow" id="MJXp-Span-3099"><span class="MJXp-mo" id="MJXp-Span-3100" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-3101"><span class="MJXp-mi" id="MJXp-Span-3102">B</span><span class="MJXp-mi" id="MJXp-Span-3103">i</span><span class="MJXp-mi" id="MJXp-Span-3104">n</span></span><span class="MJXp-mo" id="MJXp-Span-3105" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3106">435</span><span class="MJXp-mo" id="MJXp-Span-3107" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mstyle" id="MJXp-Span-3108"><span class="MJXp-mfrac" id="MJXp-Span-3109" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3110">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3111">2</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3112" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3113" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-3114">300</span><span class="MJXp-mstyle" id="MJXp-Span-3115"><span class="MJXp-mrow" id="MJXp-Span-3116"><span class="MJXp-mo" id="MJXp-Span-3117" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3118" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3119"><span class="MJXp-mo" id="MJXp-Span-3120" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3125"><span class="MJXp-mn" id="MJXp-Span-3126">435</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3121"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3122">k</span><span class="MJXp-mo" id="MJXp-Span-3123">=</span><span class="MJXp-mn" id="MJXp-Span-3124">300</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-3127"><span class="MJXp-TeXmathchoice" id="MJXp-Span-3128"><span class="MJXp-mstyle" id="MJXp-Span-3129"><span class="MJXp-mrow" id="MJXp-Span-3130"><span class="MJXp-mo" id="MJXp-Span-3131" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-3132"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3133">435</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3134">k</span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-3135"><span class="MJXp-mstyle" id="MJXp-Span-3136"><span class="MJXp-mrow" id="MJXp-Span-3137"><span class="MJXp-mo" id="MJXp-Span-3138" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3139"><span class="MJXp-mn" id="MJXp-Span-3140" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3141" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3142">−</span><span class="MJXp-mn" id="MJXp-Span-3143">435</span></span></span><span class="MJXp-mo" id="MJXp-Span-3144" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3145"><span class="MJXp-mo" id="MJXp-Span-3146" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3151"><span class="MJXp-mn" id="MJXp-Span-3152">135</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3147"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3148">k</span><span class="MJXp-mo" id="MJXp-Span-3149">=</span><span class="MJXp-mn" id="MJXp-Span-3150">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-3153"><span class="MJXp-TeXmathchoice" id="MJXp-Span-3154"><span class="MJXp-mstyle" id="MJXp-Span-3155"><span class="MJXp-mrow" id="MJXp-Span-3156"><span class="MJXp-mo" id="MJXp-Span-3157" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-3158"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3159">435</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3160">k</span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-3161"><span class="MJXp-mstyle" id="MJXp-Span-3162"><span class="MJXp-mrow" id="MJXp-Span-3163"><span class="MJXp-mo" id="MJXp-Span-3164" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3165"><span class="MJXp-mn" id="MJXp-Span-3166" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3167" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3168">−</span><span class="MJXp-mn" id="MJXp-Span-3169">435</span></span></span><span class="MJXp-mo" id="MJXp-Span-3170" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><script type="math/tex" id="MathJax-Element-392"> \mathbb{P}\big(\mathrm{Bin}(435,\tfrac12)\ge 300\big) = \sum_{k=300}^{435} \binom{435}{k} 2^{-435} = \sum_{k=0}^{135} \binom{435}{k} 2^{-435}. </script></center><h3>4) Numerical value</h3> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3171"><span class="MJXp-menclose" id="MJXp-Span-3172"><span class="MJXp-mrow" id="MJXp-Span-3173"><span class="MJXp-mstyle" id="MJXp-Span-3174"><span class="MJXp-mrow" id="MJXp-Span-3175"><span class="MJXp-mspace" id="MJXp-Span-3176" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-3177"><span class="MJXp-mi undefined" id="MJXp-Span-3178">P</span></span><span class="MJXp-mspace" id="MJXp-Span-3179" style="margin-left: -0.167em; width: 0em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-3180"><span class="MJXp-mo" id="MJXp-Span-3181" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.744em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.978em; margin-left: -0.17em;">(</span></span><span class="MJXp-munderover" id="MJXp-Span-3182"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3188" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mn" id="MJXp-Span-3189">300</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-3183" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3184" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3185">i</span><span class="MJXp-mo" id="MJXp-Span-3186">=</span><span class="MJXp-mn" id="MJXp-Span-3187">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3190"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3191" style="margin-right: 0.05em;">X</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3192" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3193" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-3194">435</span><span class="MJXp-mo" id="MJXp-Span-3195" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.744em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.978em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mspace" id="MJXp-Span-3196" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3197" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-mspace" id="MJXp-Span-3198" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-3199">8.61</span><span class="MJXp-mo" id="MJXp-Span-3200" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-msubsup" id="MJXp-Span-3201"><span class="MJXp-mn" id="MJXp-Span-3202" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3203" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3204">−</span><span class="MJXp-mn" id="MJXp-Span-3205">16</span></span></span><span class="MJXp-mspace" id="MJXp-Span-3206" style="width: 0.278em; height: 0em;"></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-393"> \boxed{\;\mathbb{P}\!\left(\sum_{i=1}^{300} X_i \le 435\right) \;\approx\; 8.61\times 10^{-16}\;} </script></center><h3>5) Sanity check (normal approximation to the binomial)</h3><p>With <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3208">μ</span><span class="MJXp-mo" id="MJXp-Span-3209" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3210">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3211">p</span><span class="MJXp-mo" id="MJXp-Span-3212" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-3213">217.5</span></span></span><script type="math/tex" id="MathJax-Element-394">\mu = np = 217.5</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3214"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3215">σ</span><span class="MJXp-mo" id="MJXp-Span-3216" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msqrt" id="MJXp-Span-3217"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3218">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3219">p</span><span class="MJXp-mo" id="MJXp-Span-3220" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3221">1</span><span class="MJXp-mo" id="MJXp-Span-3222" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3223">p</span><span class="MJXp-mo" id="MJXp-Span-3224" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3225" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msqrt" id="MJXp-Span-3226"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-3227">108.75</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3228" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-mn" id="MJXp-Span-3229">10.428</span></span></span><script type="math/tex" id="MathJax-Element-395">\sigma=\sqrt{np(1-p)}=\sqrt{108.75}\approx 10.428</script>, and continuity correction,</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3231">z</span><span class="MJXp-mo" id="MJXp-Span-3232" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-3233" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-3234">299.5</span><span class="MJXp-mo" id="MJXp-Span-3235">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3236">μ</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3237">σ</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3238" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-mn" id="MJXp-Span-3239">7.86</span><span class="MJXp-mspace" id="MJXp-Span-3240" style="width: 1em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3241" style="margin-left: 0.333em; margin-right: 0.333em;">⇒</span><span class="MJXp-mspace" id="MJXp-Span-3242" style="width: 1em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-3243"><span class="MJXp-mi undefined" id="MJXp-Span-3244">P</span></span><span class="MJXp-mo" id="MJXp-Span-3245" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3246">Z</span><span class="MJXp-mo" id="MJXp-Span-3247" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3248">z</span><span class="MJXp-mo" id="MJXp-Span-3249" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3250" style="margin-left: 0.333em; margin-right: 0.333em;">≈</span><span class="MJXp-mn" id="MJXp-Span-3251">1.87</span><span class="MJXp-mo" id="MJXp-Span-3252" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-msubsup" id="MJXp-Span-3253"><span class="MJXp-mn" id="MJXp-Span-3254" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3255" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3256">−</span><span class="MJXp-mn" id="MJXp-Span-3257">15</span></span></span><span class="MJXp-mo" id="MJXp-Span-3258" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span><script type="math/tex" id="MathJax-Element-396"> z=\frac{299.5-\mu}{\sigma}\approx 7.86 \quad\Rightarrow\quad \mathbb{P}(Z\ge z)\approx 1.87\times 10^{-15}, </script></center><p>which is of the same (tiny) order as the exact value above.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">solution (easy version)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><br><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;map&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;set&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cmath&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;ctime&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;queue&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;stack&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstdio&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstdlib&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;vector&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstring&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;algorithm&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;iostream&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;bitset&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;unordered_map&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> fastio ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">cout</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">double</span><span class="pln"> db</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ull</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N</span><span class="pun">=</span><span class="lit">1010</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
vector</span><span class="str">&lt;int&gt;</span><span class="pln"> </span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="typ">Sp</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> init</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    cin</span><span class="pun">&gt;&gt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">N</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
        </span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">(),</span><span class="typ">Sp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

vector</span><span class="str">&lt;int&gt;</span><span class="pln"> ask</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> ty</span><span class="pun">,</span><span class="pln">vector</span><span class="str">&lt;int&gt;</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">v</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    cout</span><span class="pun">&lt;&lt;</span><span class="pln">ty</span><span class="pun">&lt;&lt;</span><span class="str">" "</span><span class="pun">&lt;&lt;</span><span class="pln">v</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">v</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
        cout</span><span class="pun">&lt;&lt;</span><span class="str">" "</span><span class="pun">&lt;&lt;</span><span class="pln">v</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    cout</span><span class="pun">&lt;&lt;</span><span class="str">"\n"</span><span class="pun">&lt;&lt;</span><span class="pln">flush</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">ty</span><span class="pun">&lt;</span><span class="lit">3</span><span class="pun">)</span><span class="pln"> k</span><span class="pun">=</span><span class="pln">min</span><span class="pun">(</span><span class="lit">60</span><span class="pun">,(</span><span class="kwd">int</span><span class="pun">)</span><span class="pln">v</span><span class="pun">.</span><span class="pln">size</span><span class="pun">());</span><span class="pln">
    </span><span class="kwd">else</span><span class="pln"> k</span><span class="pun">=</span><span class="pln">min</span><span class="pun">(</span><span class="lit">300</span><span class="pun">,(</span><span class="kwd">int</span><span class="pun">)</span><span class="pln">v</span><span class="pun">.</span><span class="pln">size</span><span class="pun">());</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">k</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
        cin</span><span class="pun">&gt;&gt;</span><span class="pln">t</span><span class="pun">;</span><span class="pln">
        res</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">t</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> cnt</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> p</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">4</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="lit">30</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
        </span><span class="typ">Sv</span><span class="pun">[++</span><span class="pln">cnt</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="lit">30</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="lit">30</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
        </span><span class="pun">{</span><span class="pln">
            cnt</span><span class="pun">++;</span><span class="pln">
            </span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">cnt</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">),</span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">cnt</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">j</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="lit">9</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> cur</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
        </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> nxt</span><span class="pun">=</span><span class="pln">cur</span><span class="pun">+</span><span class="pln">i</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">nxt</span><span class="pun">&gt;</span><span class="lit">29</span><span class="pun">)</span><span class="pln"> nxt</span><span class="pun">-=</span><span class="lit">29</span><span class="pun">;</span><span class="pln">
            cnt</span><span class="pun">++;</span><span class="pln">
            </span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">cnt</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="lit">30</span><span class="pun">);</span><span class="pln">
            </span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">cnt</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">cur</span><span class="pun">);</span><span class="pln">
            </span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">cnt</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">nxt</span><span class="pun">);</span><span class="pln">
            cur</span><span class="pun">=</span><span class="pln">nxt</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">nxt</span><span class="pun">==</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> vl</span><span class="pun">(</span><span class="lit">11</span><span class="pun">),</span><span class="pln">vm</span><span class="pun">(</span><span class="lit">11</span><span class="pun">),</span><span class="pln">vr</span><span class="pun">(</span><span class="lit">11</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="lit">10</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
        vl</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">i</span><span class="pun">,</span><span class="pln">vm</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">10</span><span class="pun">+</span><span class="pln">i</span><span class="pun">,</span><span class="pln">vr</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">20</span><span class="pun">+</span><span class="pln">i</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="lit">9</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="lit">10</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
        </span><span class="pun">{</span><span class="pln">
            cnt</span><span class="pun">++;</span><span class="pln">
            </span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">cnt</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">vl</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]);</span><span class="pln">
            </span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">cnt</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">vm</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]);</span><span class="pln">
            </span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">cnt</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">vr</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;</span><span class="lit">10</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
            vr</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]=</span><span class="pln">vr</span><span class="pun">[</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
        vr</span><span class="pun">[</span><span class="lit">10</span><span class="pun">]=</span><span class="pln">vr</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">cur</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="lit">29</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">=</span><span class="pln">cur</span><span class="pun">,</span><span class="pln">y</span><span class="pun">=</span><span class="pln">cur</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">z</span><span class="pun">=</span><span class="pln">cur</span><span class="pun">+</span><span class="lit">2</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="lit">29</span><span class="pun">)</span><span class="pln"> x</span><span class="pun">-=</span><span class="lit">29</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">y</span><span class="pun">&gt;</span><span class="lit">29</span><span class="pun">)</span><span class="pln"> y</span><span class="pun">-=</span><span class="lit">29</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">z</span><span class="pun">&gt;</span><span class="lit">29</span><span class="pun">)</span><span class="pln"> z</span><span class="pun">-=</span><span class="lit">29</span><span class="pun">;</span><span class="pln">
        cnt</span><span class="pun">++;</span><span class="pln">
        </span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">cnt</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">x</span><span class="pun">);</span><span class="pln">
        </span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">cnt</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
        </span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">cnt</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">z</span><span class="pun">);</span><span class="pln">
        cur</span><span class="pun">+=</span><span class="lit">3</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="lit">30</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        vector</span><span class="str">&lt;int&gt;</span><span class="pln"> v</span><span class="pun">,</span><span class="pln">t</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">find</span><span class="pun">(</span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="kwd">begin</span><span class="pun">(),</span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="kwd">end</span><span class="pun">(),</span><span class="pln">i</span><span class="pun">)!=</span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="kwd">end</span><span class="pun">())</span><span class="pln">
                v</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">j</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">v</span><span class="pun">.</span><span class="pln">empty</span><span class="pun">())</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">i</span><span class="pun">&lt;</span><span class="lit">30</span><span class="pun">)</span><span class="pln"> t</span><span class="pun">=</span><span class="pln">ask</span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> t</span><span class="pun">=</span><span class="pln">ask</span><span class="pun">(</span><span class="lit">4</span><span class="pun">,</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;</span><span class="pln">t</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
            </span><span class="typ">Sp</span><span class="pun">[</span><span class="pln">t</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
         sort</span><span class="pun">(</span><span class="typ">Sp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="kwd">begin</span><span class="pun">(),</span><span class="typ">Sp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="kwd">end</span><span class="pun">()),</span><span class="pln"> sort</span><span class="pun">(</span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="kwd">begin</span><span class="pun">(),</span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="kwd">end</span><span class="pun">());</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">((!</span><span class="typ">Sp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">empty</span><span class="pun">())&amp;&amp;</span><span class="typ">Sp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]==</span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">j</span><span class="pun">])</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">j</span><span class="pun">;</span><span class="pln">
    cout</span><span class="pun">&lt;&lt;</span><span class="str">"! "</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
        cout</span><span class="pun">&lt;&lt;</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]&lt;&lt;(</span><span class="pln">i</span><span class="pun">==</span><span class="pln">n</span><span class="pun">?</span><span class="str">'\n'</span><span class="pun">:</span><span class="str">' '</span><span class="pun">);</span><span class="pln">
    cout</span><span class="pun">&lt;&lt;</span><span class="pln">flush</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    fastio</span><span class="pun">;</span><span class="pln">

    cin</span><span class="pun">&gt;&gt;</span><span class="pln">T</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		init</span><span class="pun">();</span><span class="pln">
		solve</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">solution (hard version)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;map&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;set&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cmath&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;ctime&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;queue&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;stack&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstdio&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstdlib&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;vector&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstring&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;algorithm&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;iostream&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;bitset&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;unordered_map&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> fastio ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">cout</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">double</span><span class="pln"> db</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ull</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N</span><span class="pun">=</span><span class="lit">1010</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
vector</span><span class="str">&lt;int&gt;</span><span class="pln"> </span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="typ">Sp</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln">prv</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln">prp</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> init</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    srand</span><span class="pun">(</span><span class="pln">time</span><span class="pun">(</span><span class="lit">0</span><span class="pun">));</span><span class="pln">
    cin</span><span class="pun">&gt;&gt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">N</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
        </span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">(),</span><span class="typ">Sp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">(),</span><span class="pln">prv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">(),</span><span class="pln">prp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

vector</span><span class="str">&lt;int&gt;</span><span class="pln"> ask</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> ty</span><span class="pun">,</span><span class="pln">vector</span><span class="str">&lt;int&gt;</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">v</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    cout</span><span class="pun">&lt;&lt;</span><span class="pln">ty</span><span class="pun">&lt;&lt;</span><span class="str">" "</span><span class="pun">&lt;&lt;</span><span class="pln">v</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">v</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
        cout</span><span class="pun">&lt;&lt;</span><span class="str">" "</span><span class="pun">&lt;&lt;</span><span class="pln">v</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    cout</span><span class="pun">&lt;&lt;</span><span class="str">"\n"</span><span class="pun">&lt;&lt;</span><span class="pln">flush</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">ty</span><span class="pun">&lt;</span><span class="lit">3</span><span class="pun">)</span><span class="pln"> k</span><span class="pun">=</span><span class="pln">min</span><span class="pun">(</span><span class="lit">60</span><span class="pun">,(</span><span class="kwd">int</span><span class="pun">)</span><span class="pln">v</span><span class="pun">.</span><span class="pln">size</span><span class="pun">());</span><span class="pln">
    </span><span class="kwd">else</span><span class="pln"> k</span><span class="pun">=</span><span class="pln">min</span><span class="pun">(</span><span class="lit">300</span><span class="pun">,(</span><span class="kwd">int</span><span class="pun">)</span><span class="pln">v</span><span class="pun">.</span><span class="pln">size</span><span class="pun">());</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">k</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
        cin</span><span class="pun">&gt;&gt;</span><span class="pln">t</span><span class="pun">;</span><span class="pln">
        res</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">t</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> cnt</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">cntr</span><span class="pun">=</span><span class="lit">871</span><span class="pun">,</span><span class="pln">cntpr</span><span class="pun">=</span><span class="lit">30</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> p</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">4</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="lit">29</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        cnt</span><span class="pun">++;</span><span class="pln">
        </span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">cnt</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
        cntr</span><span class="pun">--;</span><span class="pln">
        </span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">cntr</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="lit">29</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="lit">29</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
        </span><span class="pun">{</span><span class="pln">
            cnt</span><span class="pun">++;</span><span class="pln">
            </span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">cnt</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">),</span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">cnt</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">j</span><span class="pun">);</span><span class="pln">
            cntr</span><span class="pun">--;</span><span class="pln">
            </span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">cntr</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">),</span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">cntr</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">j</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">871</span><span class="pun">,</span><span class="pln">hd</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="lit">890</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++,</span><span class="pln">hd</span><span class="pun">+=</span><span class="lit">3</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">=</span><span class="pln">hd</span><span class="pun">,</span><span class="pln">y</span><span class="pun">=</span><span class="pln">hd</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">z</span><span class="pun">=</span><span class="pln">hd</span><span class="pun">+</span><span class="lit">2</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="lit">29</span><span class="pun">)</span><span class="pln"> x</span><span class="pun">-=</span><span class="lit">29</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">y</span><span class="pun">&gt;</span><span class="lit">29</span><span class="pun">)</span><span class="pln"> y</span><span class="pun">-=</span><span class="lit">29</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">z</span><span class="pun">&gt;</span><span class="lit">29</span><span class="pun">)</span><span class="pln"> z</span><span class="pun">-=</span><span class="lit">29</span><span class="pun">;</span><span class="pln">
        </span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">x</span><span class="pun">),</span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">y</span><span class="pun">),</span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">z</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="lit">29</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        vector</span><span class="str">&lt;int&gt;</span><span class="pln"> v</span><span class="pun">,</span><span class="pln">t</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">find</span><span class="pun">(</span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="kwd">begin</span><span class="pun">(),</span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="kwd">end</span><span class="pun">(),</span><span class="pln">i</span><span class="pun">)!=</span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="kwd">end</span><span class="pun">())</span><span class="pln">
                v</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">j</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">v</span><span class="pun">.</span><span class="pln">empty</span><span class="pun">())</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
        t</span><span class="pun">=</span><span class="pln">ask</span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;</span><span class="pln">t</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
            </span><span class="typ">Sp</span><span class="pun">[</span><span class="pln">t</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
         sort</span><span class="pun">(</span><span class="typ">Sp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="kwd">begin</span><span class="pun">(),</span><span class="typ">Sp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="kwd">end</span><span class="pun">()),</span><span class="pln"> sort</span><span class="pun">(</span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="kwd">begin</span><span class="pun">(),</span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="kwd">end</span><span class="pun">());</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">871</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="typ">Sp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]==</span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">j</span><span class="pun">])</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">j</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="typ">Sp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()==</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> prp</span><span class="pun">[</span><span class="typ">Sp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="typ">Sp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()==</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> prp</span><span class="pun">[</span><span class="lit">30</span><span class="pun">*</span><span class="typ">Sp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]+</span><span class="typ">Sp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">    </span><span class="com">//hash the set</span><span class="pln">
        </span><span class="com">//|S|&gt;2 and empty set are ignored</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()==</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> prv</span><span class="pun">[</span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()==</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> prv</span><span class="pun">[</span><span class="lit">30</span><span class="pun">*</span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]+</span><span class="typ">Sv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">    </span><span class="com">//hash the set</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="com">//necessary shuffle</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">N</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">prp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()&lt;</span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">rand</span><span class="pun">()&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> swap</span><span class="pun">(</span><span class="pln">prp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">],</span><span class="pln">prp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        vector</span><span class="str">&lt;int&gt;</span><span class="pln"> v</span><span class="pun">,</span><span class="pln">t</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;</span><span class="pln">N</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
        </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">prp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">empty</span><span class="pun">())</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">prp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()==</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
            </span><span class="pun">{</span><span class="pln">
                p</span><span class="pun">[</span><span class="pln">prp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]]=</span><span class="pln">prv</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
                prp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
                prv</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
                </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            v</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">prp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">v</span><span class="pun">.</span><span class="pln">empty</span><span class="pun">())</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
        t</span><span class="pun">=</span><span class="pln">ask</span><span class="pun">(</span><span class="lit">3</span><span class="pun">,</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;</span><span class="pln">N</span><span class="pun">;</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
        </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">prp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">empty</span><span class="pun">())</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">t</span><span class="pun">.</span><span class="pln">empty</span><span class="pun">())</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">prv</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]==</span><span class="pln">t</span><span class="pun">.</span><span class="pln">back</span><span class="pun">())</span><span class="pln">
            </span><span class="pun">{</span><span class="pln">
                t</span><span class="pun">.</span><span class="pln">pop_back</span><span class="pun">();</span><span class="pln">
                p</span><span class="pun">[</span><span class="pln">prp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]]=</span><span class="pln">prv</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
                p</span><span class="pun">[</span><span class="pln">prp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]]=</span><span class="pln">prv</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">else</span><span class="pln">
            </span><span class="pun">{</span><span class="pln">
                p</span><span class="pun">[</span><span class="pln">prp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]]=</span><span class="pln">prv</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
                p</span><span class="pun">[</span><span class="pln">prp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]]=</span><span class="pln">prv</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            prp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
            prv</span><span class="pun">[</span><span class="pln">j</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    cout</span><span class="pun">&lt;&lt;</span><span class="str">"! "</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
        cout</span><span class="pun">&lt;&lt;</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]&lt;&lt;(</span><span class="pln">i</span><span class="pun">==</span><span class="pln">n</span><span class="pun">?</span><span class="str">'\n'</span><span class="pun">:</span><span class="str">' '</span><span class="pun">);</span><span class="pln">
    cout</span><span class="pun">&lt;&lt;</span><span class="pln">flush</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    fastio</span><span class="pun">;</span><span class="pln">

    cin</span><span class="pun">&gt;&gt;</span><span class="pln">T</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		init</span><span class="pun">();</span><span class="pln">
		solve</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">

	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate the Problem</b><div class="spoiler-content" style="display: block;"><p>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11094">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="17">17</span>
            </i>
        </a>
    </span>


</p><p>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11095">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="0">0</span>
            </i>
        </a>
    </span>


</p><p>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11096">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="2">2</span>
            </i>
        </a>
    </span>


</p><p>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11097">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="3">3</span>
            </i>
        </a>
    </span>


</p><p>Didn't solve: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11098">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="28">28</span>
            </i>
        </a>
    </span>


</p></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2129" class="notice" style="text-decoration: none;">Codeforces Round 1040 (Div. 1)</a> </span>
        </div>
        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2130" class="notice" style="text-decoration: none;">Codeforces Round 1040 (Div. 2)</a> </span>
        </div>
        
            

  <script>
    // Make all spoilers toggleable
    document.querySelectorAll('.spoiler-title').forEach(title => {
      title.addEventListener('click', function() {
        const spoiler = this.closest('.spoiler');
        spoiler.classList.toggle('open');
      });
    });
    
    // Open all spoilers by default for easier reading
    document.querySelectorAll('.spoiler').forEach(spoiler => {
      spoiler.classList.add('open');
    });
  </script>
</body>
</html>