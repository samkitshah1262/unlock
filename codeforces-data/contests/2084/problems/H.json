{
  "contestId": 2084,
  "index": "H",
  "title": "Turtle and Nediam 2",
  "timeLimit": "2 seconds",
  "memoryLimit": "512 megabytes",
  "rating": 3500,
  "tags": [
    "dp",
    "greedy"
  ],
  "statementHtml": "<p> </p>\n<p>You are given a binary sequence <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2\">s</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-1-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-2\"><span class=\"mi\" id=\"MathJax-Span-3\" style=\"font-family: MathJax_Math-italic;\">s</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-1\">s</script> of length <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-4\">n</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-2-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-4\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-5\"><span class=\"mi\" id=\"MathJax-Span-6\" style=\"font-family: MathJax_Math-italic;\">n</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-2\">n</script> which only consists of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-5\"><span class=\"MJXp-mn\" id=\"MJXp-Span-6\">0</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-3-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-7\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-8\"><span class=\"mn\" id=\"MathJax-Span-9\" style=\"font-family: MathJax_Main;\">0</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-3\">0</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-7\"><span class=\"MJXp-mn\" id=\"MJXp-Span-8\">1</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-4-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-10\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-11\"><span class=\"mn\" id=\"MathJax-Span-12\" style=\"font-family: MathJax_Main;\">1</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-4\">1</script>.</p>\n<p>You can do the following operation <span class=\"tex-font-style-bf\">at most <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-9\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-10\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-11\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-12\">2</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-5-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-13\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-14\"><span class=\"mi\" id=\"MathJax-Span-15\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-16\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mn\" id=\"MathJax-Span-17\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">2</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-5\">n - 2</script> times</span> (possibly zero):</p>\n<p>Note that after every operation, the length of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-111\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-112\">s</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-135\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-136\"><span class=\"mi\" id=\"MathJax-Span-137\" style=\"font-family: MathJax_Math-italic;\">s</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-19\">s</script> decreases by <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-113\"><span class=\"MJXp-mn\" id=\"MJXp-Span-114\">1</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-138\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-139\"><span class=\"mn\" id=\"MathJax-Span-140\" style=\"font-family: MathJax_Main;\">1</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-20\">1</script>.</p>\n<p>Find how many different binary sequences can be obtained after performing the operation, modulo <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-115\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-116\"><span class=\"MJXp-mn\" id=\"MJXp-Span-117\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-118\" style=\"vertical-align: 0.5em;\">9</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-119\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-120\">7</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-141\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-142\"><span class=\"msubsup\" id=\"MathJax-Span-143\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-144\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"mn\" id=\"MathJax-Span-145\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">9</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-146\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">+</span><span class=\"mn\" id=\"MathJax-Span-147\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">7</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-21\">10^9 + 7</script>.</p>\n<p><span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-121\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-122\"><span class=\"MJXp-mi\" id=\"MJXp-Span-123\" style=\"margin-right: 0.05em;\"></span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-124\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-mtext\" id=\"MJXp-Span-125\">∗</span></span></span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-148\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 136%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-149\"><span class=\"msubsup\" id=\"MathJax-Span-150\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.834em, 1000em, 4.205em, -999.997em); top: -4.013em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-151\"></span><span style=\"display: inline-block; width: 0px; height: 4.019em;\"></span></span><span style=\"position: absolute; top: -4.384em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-152\"><span class=\"mrow\" id=\"MathJax-Span-153\"><span class=\"mtext\" id=\"MathJax-Span-154\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">∗</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.019em;\"></span></span></span></span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-22\">^{\\text{∗}}</script>The median of an array of odd length <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-126\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-127\">k</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-23-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-155\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 136%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-156\"><span class=\"mi\" id=\"MathJax-Span-157\" style=\"font-family: MathJax_Math-italic;\">k</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-23\">k</script> is the <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-128\"><span class=\"MJXp-mfrac\" id=\"MJXp-Span-129\" style=\"vertical-align: 0.25em;\"><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-130\">k</span><span class=\"MJXp-mo\" id=\"MJXp-Span-131\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-132\">1</span></span><span class=\"MJXp-box\" style=\"margin-top: -0.9em;\"><span class=\"MJXp-denom\"><span><span class=\"MJXp-rule\" style=\"height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;\"></span></span><span><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mn\" id=\"MJXp-Span-133\">2</span></span></span></span></span></span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-24-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-158\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 136%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-159\"><span class=\"mfrac\" id=\"MathJax-Span-160\"><span style=\"display: inline-block; position: relative; width: 1.424em; height: 0px; margin-right: 0.127em; margin-left: 0.127em;\"><span style=\"position: absolute; clip: rect(3.34em, 1001.24em, 4.267em, -999.997em); top: -4.508em; left: 50%; margin-left: -0.615em;\"><span class=\"mrow\" id=\"MathJax-Span-161\"><span class=\"mi\" id=\"MathJax-Span-162\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">k</span><span class=\"mo\" id=\"MathJax-Span-163\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">+</span><span class=\"mn\" id=\"MathJax-Span-164\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 4.019em;\"></span></span><span style=\"position: absolute; clip: rect(3.34em, 1000.31em, 4.205em, -999.997em); top: -3.642em; left: 50%; margin-left: -0.182em;\"><span class=\"mn\" id=\"MathJax-Span-165\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.019em;\"></span></span><span style=\"position: absolute; clip: rect(0.806em, 1001.42em, 1.239em, -999.997em); top: -1.294em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.424em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.054em;\"></span></span></span></span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-24\">\\frac{k + 1}{2}</script>-th element when sorted.</p>",
  "inputSpecHtml": "<p>Each test contains multiple test cases. The first line contains the number of test cases <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-134\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-135\">t</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-25-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-166\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-167\"><span class=\"mi\" id=\"MathJax-Span-168\" style=\"font-family: MathJax_Math-italic;\">t</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-25\">t</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-136\"><span class=\"MJXp-mn\" id=\"MJXp-Span-137\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-138\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-139\">t</span><span class=\"MJXp-mo\" id=\"MJXp-Span-140\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-141\"><span class=\"MJXp-mn\" id=\"MJXp-Span-142\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-143\" style=\"vertical-align: 0.5em;\">4</span></span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-26-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-169\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-170\"><span class=\"mn\" id=\"MathJax-Span-171\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-172\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-173\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">t</span><span class=\"mo\" id=\"MathJax-Span-174\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-175\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-176\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"mn\" id=\"MathJax-Span-177\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">4</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-26\">1 \\le t \\le 10^4</script>). The description of the test cases follows. </p><p>The first line of each test case contains a single integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-144\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-145\">n</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-27-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-178\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-179\"><span class=\"mi\" id=\"MathJax-Span-180\" style=\"font-family: MathJax_Math-italic;\">n</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-27\">n</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-146\"><span class=\"MJXp-mn\" id=\"MJXp-Span-147\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-148\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-149\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-150\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mn\" id=\"MJXp-Span-151\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-152\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⋅</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-153\"><span class=\"MJXp-mn\" id=\"MJXp-Span-154\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-155\" style=\"vertical-align: 0.5em;\">6</span></span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-181\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-182\"><span class=\"mn\" id=\"MathJax-Span-183\" style=\"font-family: MathJax_Main;\">3</span><span class=\"mo\" id=\"MathJax-Span-184\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-185\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span><span class=\"mo\" id=\"MathJax-Span-186\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mn\" id=\"MathJax-Span-187\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">2</span><span class=\"mo\" id=\"MathJax-Span-188\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">⋅</span><span class=\"msubsup\" id=\"MathJax-Span-189\" style=\"padding-left: 0.219em;\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-190\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"mn\" id=\"MathJax-Span-191\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">6</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-28\">3 \\le n \\le 2 \\cdot 10^6</script>) — the length of the binary sequence.</p><p>The second line of each test case contains a string <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-156\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-157\">s</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-29-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-192\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-193\"><span class=\"mi\" id=\"MathJax-Span-194\" style=\"font-family: MathJax_Math-italic;\">s</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-29\">s</script> of length <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-158\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-159\">n</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-30-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-195\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-196\"><span class=\"mi\" id=\"MathJax-Span-197\" style=\"font-family: MathJax_Math-italic;\">n</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-30\">n</script>, consisting of only <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-160\"><span class=\"MJXp-mn\" id=\"MJXp-Span-161\">0</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-31-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-198\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-199\"><span class=\"mn\" id=\"MathJax-Span-200\" style=\"font-family: MathJax_Main;\">0</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-31\">0</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-162\"><span class=\"MJXp-mn\" id=\"MJXp-Span-163\">1</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-32-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-201\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-202\"><span class=\"mn\" id=\"MathJax-Span-203\" style=\"font-family: MathJax_Main;\">1</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-32\">1</script>.</p><p>It is guaranteed that the sum of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-164\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-165\">n</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-33-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-204\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-205\"><span class=\"mi\" id=\"MathJax-Span-206\" style=\"font-family: MathJax_Math-italic;\">n</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-33\">n</script> over all test cases does not exceed <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-166\"><span class=\"MJXp-mn\" id=\"MJXp-Span-167\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-168\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⋅</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-169\"><span class=\"MJXp-mn\" id=\"MJXp-Span-170\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-171\" style=\"vertical-align: 0.5em;\">6</span></span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-34-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-207\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-208\"><span class=\"mn\" id=\"MathJax-Span-209\" style=\"font-family: MathJax_Main;\">2</span><span class=\"mo\" id=\"MathJax-Span-210\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">⋅</span><span class=\"msubsup\" id=\"MathJax-Span-211\" style=\"padding-left: 0.219em;\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-212\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"mn\" id=\"MathJax-Span-213\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">6</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-34\">2 \\cdot 10^6</script>. </p>",
  "outputSpecHtml": "<p>For each test case, output a single integer — the number of binary sequences that can be obtained, modulo <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-172\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-173\"><span class=\"MJXp-mn\" id=\"MJXp-Span-174\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-175\" style=\"vertical-align: 0.5em;\">9</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-176\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-177\">7</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-35-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-214\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-215\"><span class=\"msubsup\" id=\"MathJax-Span-216\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-217\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"mn\" id=\"MathJax-Span-218\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">9</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-219\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">+</span><span class=\"mn\" id=\"MathJax-Span-220\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">7</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-35\">10^9 + 7</script>.</p>",
  "noteHtml": "<p>In the first test case, the following binary sequences can be obtained: <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-178\"><span class=\"MJXp-mo\" id=\"MJXp-Span-179\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-180\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-181\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-182\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-183\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-36-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-221\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-222\"><span class=\"mo\" id=\"MathJax-Span-223\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-224\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-225\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-226\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-227\" style=\"font-family: MathJax_Main;\">]</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-36\">[1, 1]</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-184\"><span class=\"MJXp-mo\" id=\"MJXp-Span-185\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-186\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-187\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-188\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-189\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-190\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-191\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-37-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-228\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-229\"><span class=\"mo\" id=\"MathJax-Span-230\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-231\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-232\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-233\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-234\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-235\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-236\" style=\"font-family: MathJax_Main;\">]</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-37\">[1, 1, 1]</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-192\"><span class=\"MJXp-mo\" id=\"MJXp-Span-193\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-194\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-195\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-196\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-197\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-198\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-199\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-200\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-201\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-38-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-237\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-238\"><span class=\"mo\" id=\"MathJax-Span-239\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-240\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-241\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-242\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-243\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-244\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-245\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-246\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-247\" style=\"font-family: MathJax_Main;\">]</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-38\">[1, 1, 1, 1]</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-202\"><span class=\"MJXp-mo\" id=\"MJXp-Span-203\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-204\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-205\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-206\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-207\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-208\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-209\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-210\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-211\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-212\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-213\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-39-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-248\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-249\"><span class=\"mo\" id=\"MathJax-Span-250\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-251\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-252\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-253\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-254\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-255\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-256\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-257\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-258\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-259\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-260\" style=\"font-family: MathJax_Main;\">]</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-39\">[1, 1, 1, 1, 1]</script>.</p><p>In the second test case, the following binary sequences can be obtained: <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-214\"><span class=\"MJXp-mo\" id=\"MJXp-Span-215\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-216\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-217\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-218\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-219\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-40-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-261\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-262\"><span class=\"mo\" id=\"MathJax-Span-263\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-264\" style=\"font-family: MathJax_Main;\">0</span><span class=\"mo\" id=\"MathJax-Span-265\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-266\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-267\" style=\"font-family: MathJax_Main;\">]</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-40\">[0, 1]</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-220\"><span class=\"MJXp-mo\" id=\"MJXp-Span-221\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-222\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-223\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-224\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-225\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-226\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-227\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-41-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-268\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-269\"><span class=\"mo\" id=\"MathJax-Span-270\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-271\" style=\"font-family: MathJax_Main;\">0</span><span class=\"mo\" id=\"MathJax-Span-272\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-273\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-274\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-275\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-276\" style=\"font-family: MathJax_Main;\">]</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-41\">[0, 1, 1]</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-228\"><span class=\"MJXp-mo\" id=\"MJXp-Span-229\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-230\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-231\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-232\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-233\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-234\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-235\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-42-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-277\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-278\"><span class=\"mo\" id=\"MathJax-Span-279\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-280\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-281\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-282\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">0</span><span class=\"mo\" id=\"MathJax-Span-283\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-284\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-285\" style=\"font-family: MathJax_Main;\">]</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-42\">[1, 0, 1]</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-236\"><span class=\"MJXp-mo\" id=\"MJXp-Span-237\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-238\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-239\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-240\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-241\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-242\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-243\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-244\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-245\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-43-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-286\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-287\"><span class=\"mo\" id=\"MathJax-Span-288\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-289\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-290\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-291\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">0</span><span class=\"mo\" id=\"MathJax-Span-292\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-293\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">0</span><span class=\"mo\" id=\"MathJax-Span-294\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-295\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-296\" style=\"font-family: MathJax_Main;\">]</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-43\">[1, 0, 0, 1]</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-246\"><span class=\"MJXp-mo\" id=\"MJXp-Span-247\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-248\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-249\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-250\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-251\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-252\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-253\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-254\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-255\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-44-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-297\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-298\"><span class=\"mo\" id=\"MathJax-Span-299\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-300\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-301\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-302\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">0</span><span class=\"mo\" id=\"MathJax-Span-303\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-304\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-305\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-306\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-307\" style=\"font-family: MathJax_Main;\">]</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-44\">[1, 0, 1, 1]</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-256\"><span class=\"MJXp-mo\" id=\"MJXp-Span-257\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-258\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-259\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-260\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-261\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-262\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-263\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-264\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-265\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-266\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-267\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-45-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-308\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-309\"><span class=\"mo\" id=\"MathJax-Span-310\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-311\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-312\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-313\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">0</span><span class=\"mo\" id=\"MathJax-Span-314\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-315\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">0</span><span class=\"mo\" id=\"MathJax-Span-316\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-317\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">0</span><span class=\"mo\" id=\"MathJax-Span-318\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-319\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-320\" style=\"font-family: MathJax_Main;\">]</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-45\">[1, 0, 0, 0, 1]</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-268\"><span class=\"MJXp-mo\" id=\"MJXp-Span-269\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-270\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-271\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-272\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-273\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-274\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-275\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-276\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-277\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-278\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-279\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-46-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-321\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-322\"><span class=\"mo\" id=\"MathJax-Span-323\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-324\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-325\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-326\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">0</span><span class=\"mo\" id=\"MathJax-Span-327\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-328\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">0</span><span class=\"mo\" id=\"MathJax-Span-329\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-330\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-331\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-332\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-333\" style=\"font-family: MathJax_Main;\">]</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-46\">[1, 0, 0, 1, 1]</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-280\"><span class=\"MJXp-mo\" id=\"MJXp-Span-281\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-282\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-283\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-284\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-285\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-286\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-287\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-288\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-289\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-290\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-291\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-292\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-293\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-47-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-334\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-335\"><span class=\"mo\" id=\"MathJax-Span-336\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-337\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-338\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-339\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">0</span><span class=\"mo\" id=\"MathJax-Span-340\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-341\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">0</span><span class=\"mo\" id=\"MathJax-Span-342\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-343\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">0</span><span class=\"mo\" id=\"MathJax-Span-344\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-345\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-346\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-347\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-348\" style=\"font-family: MathJax_Main;\">]</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-47\">[1, 0, 0, 0, 1, 1]</script>. For example, to obtain <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-294\"><span class=\"MJXp-mo\" id=\"MJXp-Span-295\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-296\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-297\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-298\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-299\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-300\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-301\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-48-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-349\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-350\"><span class=\"mo\" id=\"MathJax-Span-351\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-352\" style=\"font-family: MathJax_Main;\">0</span><span class=\"mo\" id=\"MathJax-Span-353\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-354\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-355\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-356\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-357\" style=\"font-family: MathJax_Main;\">]</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-48\">[0, 1, 1]</script>, you can:</p><ul> <li> Choose <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-302\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-303\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-304\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-305\">2</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-49-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-358\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-359\"><span class=\"mi\" id=\"MathJax-Span-360\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-361\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-362\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">2</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-49\">i = 2</script>. The median of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-306\"><span class=\"MJXp-mo\" id=\"MJXp-Span-307\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-308\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-309\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-310\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-311\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-312\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-313\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-50-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-363\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-364\"><span class=\"mo\" id=\"MathJax-Span-365\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-366\" style=\"font-family: MathJax_Main;\">0</span><span class=\"mo\" id=\"MathJax-Span-367\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-368\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">0</span><span class=\"mo\" id=\"MathJax-Span-369\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-370\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">0</span><span class=\"mo\" id=\"MathJax-Span-371\" style=\"font-family: MathJax_Main;\">]</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-50\">[0, 0, 0]</script> is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-314\"><span class=\"MJXp-mn\" id=\"MJXp-Span-315\">0</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-51-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-372\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-373\"><span class=\"mn\" id=\"MathJax-Span-374\" style=\"font-family: MathJax_Main;\">0</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-51\">0</script>. Remove <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-316\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-317\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-318\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-319\" style=\"vertical-align: -0.4em;\">2</span></span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-52-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-375\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-376\"><span class=\"msubsup\" id=\"MathJax-Span-377\"><span style=\"display: inline-block; position: relative; width: 0.923em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-378\" style=\"font-family: MathJax_Math-italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.49em;\"><span class=\"mn\" id=\"MathJax-Span-379\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-52\">s_2</script>. The sequence becomes <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-320\"><span class=\"MJXp-mo\" id=\"MJXp-Span-321\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-322\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-323\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-324\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-325\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-326\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-327\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-328\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-329\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-330\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-331\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-53-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-380\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-381\"><span class=\"mo\" id=\"MathJax-Span-382\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-383\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-384\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-385\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">0</span><span class=\"mo\" id=\"MathJax-Span-386\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-387\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">0</span><span class=\"mo\" id=\"MathJax-Span-388\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-389\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-390\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-391\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-392\" style=\"font-family: MathJax_Main;\">]</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-53\">[1, 0, 0, 1, 1]</script>. </li><li> Choose <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-332\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-333\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-334\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-335\">1</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-54-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-393\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-394\"><span class=\"mi\" id=\"MathJax-Span-395\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-396\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-397\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">1</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-54\">i = 1</script>. The median of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-336\"><span class=\"MJXp-mo\" id=\"MJXp-Span-337\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-338\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-339\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-340\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-341\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-342\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-343\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-55-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-398\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-399\"><span class=\"mo\" id=\"MathJax-Span-400\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-401\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-402\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-403\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">0</span><span class=\"mo\" id=\"MathJax-Span-404\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-405\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">0</span><span class=\"mo\" id=\"MathJax-Span-406\" style=\"font-family: MathJax_Main;\">]</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-55\">[1, 0, 0]</script> is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-344\"><span class=\"MJXp-mn\" id=\"MJXp-Span-345\">0</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-56-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-407\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-408\"><span class=\"mn\" id=\"MathJax-Span-409\" style=\"font-family: MathJax_Main;\">0</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-56\">0</script>. Remove <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-346\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-347\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-348\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-349\" style=\"vertical-align: -0.4em;\">2</span></span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-57-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-410\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-411\"><span class=\"msubsup\" id=\"MathJax-Span-412\"><span style=\"display: inline-block; position: relative; width: 0.923em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-413\" style=\"font-family: MathJax_Math-italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.49em;\"><span class=\"mn\" id=\"MathJax-Span-414\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-57\">s_2</script>. The sequence becomes <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-350\"><span class=\"MJXp-mo\" id=\"MJXp-Span-351\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-352\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-353\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-354\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-355\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-356\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-357\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-358\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-359\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-58-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-415\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-416\"><span class=\"mo\" id=\"MathJax-Span-417\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-418\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-419\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-420\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">0</span><span class=\"mo\" id=\"MathJax-Span-421\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-422\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-423\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-424\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-425\" style=\"font-family: MathJax_Main;\">]</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-58\">[1, 0, 1, 1]</script>. </li><li> Choose <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-360\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-361\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-362\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-363\">1</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-59-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-426\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-427\"><span class=\"mi\" id=\"MathJax-Span-428\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-429\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-430\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">1</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-59\">i = 1</script>. The median of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-364\"><span class=\"MJXp-mo\" id=\"MJXp-Span-365\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-366\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-367\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-368\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-369\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-370\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-371\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-60-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-431\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-432\"><span class=\"mo\" id=\"MathJax-Span-433\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-434\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-435\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-436\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">0</span><span class=\"mo\" id=\"MathJax-Span-437\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-438\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-439\" style=\"font-family: MathJax_Main;\">]</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-60\">[1, 0, 1]</script> is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-372\"><span class=\"MJXp-mn\" id=\"MJXp-Span-373\">1</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-61-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-440\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-441\"><span class=\"mn\" id=\"MathJax-Span-442\" style=\"font-family: MathJax_Main;\">1</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-61\">1</script>. Remove <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-374\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-375\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-376\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-377\" style=\"vertical-align: -0.4em;\">1</span></span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-62-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-443\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-444\"><span class=\"msubsup\" id=\"MathJax-Span-445\"><span style=\"display: inline-block; position: relative; width: 0.923em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-446\" style=\"font-family: MathJax_Math-italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.49em;\"><span class=\"mn\" id=\"MathJax-Span-447\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-62\">s_1</script>. The sequence becomes <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-378\"><span class=\"MJXp-mo\" id=\"MJXp-Span-379\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-380\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-381\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-382\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-383\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-384\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-385\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-63-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-448\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-449\"><span class=\"mo\" id=\"MathJax-Span-450\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-451\" style=\"font-family: MathJax_Main;\">0</span><span class=\"mo\" id=\"MathJax-Span-452\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-453\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-454\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-455\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-456\" style=\"font-family: MathJax_Main;\">]</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-63\">[0, 1, 1]</script>. </li></ul>",
  "samples": [
    {
      "input": "5511111610001190001110001411001111111000160010000110100011",
      "output": "4\n8\n30\n114\n514"
    }
  ],
  "images": [],
  "url": "https://codeforces.com/contest/2084/problem/H",
  "tutorialHtml": "<div><div class=\"ttypography\"><div class=\"problem-statement\"><div><p>First, extract the longest contiguous segments in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2738\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2739\">s</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-387\">s</script> where the values remain the same. Suppose there are <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2740\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2741\">m</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-388\">m</script> such segments with lengths <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2742\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2743\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2744\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-2745\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2746\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2747\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2748\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-2749\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2750\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2751\" style=\"margin-left: 0em; margin-right: 0em;\">…</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2752\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2753\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2754\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2755\" style=\"vertical-align: -0.4em;\">m</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-389\">a_1, a_2, \\dots, a_m</script>. Then, the operations can be described as follows:</p><ul> <li> Choose an index <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2756\"><span class=\"MJXp-mn\" id=\"MJXp-Span-2757\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2758\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2759\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2760\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mrow\" id=\"MJXp-Span-2761\"><span class=\"MJXp-mo\" id=\"MJXp-Span-2762\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2763\">a</span><span class=\"MJXp-mrow\" id=\"MJXp-Span-2764\"><span class=\"MJXp-mo\" id=\"MJXp-Span-2765\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-390\">1 \\leq i \\leq |a|</script> such that <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2766\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2767\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2768\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2769\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2770\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≥</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2771\">2</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-391\">a_i \\geq 2</script> and decrease <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2772\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2773\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2774\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2775\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-392\">a_i</script> by 1. </li><li> Choose an index <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2776\"><span class=\"MJXp-mn\" id=\"MJXp-Span-2777\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2778\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2779\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2780\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-mrow\" id=\"MJXp-Span-2781\"><span class=\"MJXp-mo\" id=\"MJXp-Span-2782\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2783\">a</span><span class=\"MJXp-mrow\" id=\"MJXp-Span-2784\"><span class=\"MJXp-mo\" id=\"MJXp-Span-2785\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-393\">2 \\leq i < |a|</script> such that <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2786\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2787\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2788\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-2789\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2790\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2791\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2792\">1</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2793\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2794\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2795\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2796\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2797\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2798\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-394\">a_{i-1} = a_i = 1</script>. Remove <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2799\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2800\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2801\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-2802\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2803\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2804\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2805\">1</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-395\">a_{i-1}</script>. If <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2806\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2807\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2808\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≥</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2809\">3</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-396\">i \\geq 3</script>, then merge <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2810\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2811\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2812\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-2813\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2814\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2815\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2816\">2</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-397\">a_{i-2}</script> with <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2817\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2818\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2819\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2820\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-398\">a_i</script> and remove <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2821\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2822\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2823\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2824\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-399\">a_i</script>. </li></ul><p>First handle the corner case when <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2825\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2826\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2827\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2828\">2</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-400\">m \\leq 2</script>. It can be observed that the length of the last segment never increases, and it is independent of the preceding segments. Thus, we only need to consider the strings that can be generated from <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2829\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2830\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2831\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-2832\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2833\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2834\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2835\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-2836\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2837\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2838\" style=\"margin-left: 0em; margin-right: 0em;\">…</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2839\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2840\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2841\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-2842\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2843\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2844\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2845\">1</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-401\">a_1, a_2, \\ldots, a_{m-1}</script>, and the final answer is multiplied by <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2846\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2847\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2848\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2849\" style=\"vertical-align: -0.4em;\">m</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-402\">a_m</script>.</p><p>Now, consider counting the strings that begin with the same character as <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2850\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2851\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2852\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-2853\" style=\"vertical-align: -0.4em;\">1</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-403\">s_1</script>. For a generated sequence of contiguous segments <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2854\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2855\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2856\" style=\"margin-right: 0.05em;\">b</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-2857\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2858\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2859\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2860\" style=\"margin-right: 0.05em;\">b</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-2861\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2862\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2863\" style=\"margin-left: 0em; margin-right: 0em;\">…</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2864\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2865\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2866\" style=\"margin-right: 0.05em;\">b</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2867\" style=\"vertical-align: -0.4em;\">k</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-404\">b_1, b_2, \\dots, b_k</script>, we greedily find the shortest prefix in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2868\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2869\">a</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-405\">a</script> that can generate <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2870\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2871\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2872\" style=\"margin-right: 0.05em;\">b</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-2873\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2874\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2875\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2876\" style=\"margin-right: 0.05em;\">b</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-2877\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2878\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2879\" style=\"margin-left: 0em; margin-right: 0em;\">…</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2880\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2881\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2882\" style=\"margin-right: 0.05em;\">b</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2883\" style=\"vertical-align: -0.4em;\">k</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-406\">b_1, b_2, \\dots, b_k</script>.</p><p>Define <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2884\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2885\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2886\" style=\"margin-right: 0.05em;\">f</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2887\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-407\">f_i</script> as the number of strings that can match <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2888\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2889\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2890\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2891\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-408\">a_i</script>.</p><p>For the transition when adding a new segment <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2892\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2893\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2894\" style=\"margin-right: 0.05em;\">b</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-2895\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2896\">k</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2897\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2898\">1</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-409\">b_{k+1}</script>, iterate over indices <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2899\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2900\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2901\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&gt;</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2902\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-410\">j > i</script> such that <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2903\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2904\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2905\" style=\"margin-left: 0.278em; margin-right: 0.278em;\">mod</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2906\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2907\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≠</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2908\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2909\" style=\"margin-left: 0.278em; margin-right: 0.278em;\">mod</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2910\">2</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-411\">j \\bmod 2 \\neq i \\bmod 2</script>. Let <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2911\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2912\">x</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-412\">x</script> be the maximum value of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2913\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2914\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2915\" style=\"margin-right: 0.05em;\">b</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-2916\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2917\">k</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2918\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2919\">1</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-413\">b_{k+1}</script> that can be generated by the previous <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2920\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2921\">j</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-414\">j</script>. Then, the maximum value that <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2922\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2923\">j</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-415\">j</script> can generate for <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2924\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2925\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2926\" style=\"margin-right: 0.05em;\">b</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-2927\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2928\">k</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2929\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2930\">1</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-416\">b_{k+1}</script> is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2931\"><span class=\"MJXp-mo\" id=\"MJXp-Span-2932\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">max</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2933\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2934\">x</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2935\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2936\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2937\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2938\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2939\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2940\" style=\"vertical-align: -0.4em;\">j</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2941\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-417\">\\max(x+1, a_j)</script>. Thus, if <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2942\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2943\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2944\" style=\"margin-right: 0.05em;\">b</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-2945\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2946\">k</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2947\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2948\">1</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-418\">b_{k+1}</script> is matched at position <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2949\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2950\">j</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-419\">j</script>, we have <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2951\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2952\">x</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2953\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2954\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2955\" style=\"margin-right: 0.05em;\">b</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-2956\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2957\">k</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2958\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2959\">1</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2960\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2961\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">max</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2962\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2963\">x</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2964\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2965\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2966\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2967\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2968\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2969\" style=\"vertical-align: -0.4em;\">j</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2970\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-420\">x < b_{k+1} \\leq \\max(x+1, a_j)</script>, which gives <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2971\"><span class=\"MJXp-mo\" id=\"MJXp-Span-2972\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">max</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2973\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2974\">x</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2975\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2976\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2977\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2978\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2979\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-2980\" style=\"vertical-align: -0.4em;\">j</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2981\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2982\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2983\">x</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-421\">\\max(x+1, a_j) - x</script> possible values for <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2984\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2985\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2986\" style=\"margin-right: 0.05em;\">b</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-2987\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2988\">k</span><span class=\"MJXp-mo\" id=\"MJXp-Span-2989\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-2990\">1</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-422\">b_{k+1}</script>.</p><p>Thus, the transition is as follows:</p><pre class=\"lstlisting\"><code class=\"prettyprint prettyprinted\" style=\"\"><span class=\"kwd\">for</span><span class=\"pln\"> i </span><span class=\"pun\">:=</span><span class=\"pln\"> </span><span class=\"lit\">1</span><span class=\"pln\"> to m </span><span class=\"pun\">-</span><span class=\"pln\"> </span><span class=\"lit\">1</span><span class=\"pun\">:</span><br><span class=\"pln\">    x </span><span class=\"pun\">:=</span><span class=\"pln\"> </span><span class=\"lit\">0</span><br><span class=\"pln\">    </span><span class=\"kwd\">for</span><span class=\"pln\"> j </span><span class=\"pun\">:=</span><span class=\"pln\"> i </span><span class=\"pun\">+</span><span class=\"pln\"> </span><span class=\"lit\">1</span><span class=\"pln\"> to m </span><span class=\"pun\">-</span><span class=\"pln\"> </span><span class=\"lit\">1</span><span class=\"pun\">:</span><br><span class=\"pln\">        </span><span class=\"kwd\">if</span><span class=\"pln\"> j mod </span><span class=\"lit\">2</span><span class=\"pln\"> </span><span class=\"pun\">!=</span><span class=\"pln\"> i mod </span><span class=\"lit\">2</span><span class=\"pun\">:</span><br><span class=\"pln\">            f</span><span class=\"pun\">[</span><span class=\"pln\">j</span><span class=\"pun\">]</span><span class=\"pln\"> </span><span class=\"pun\">:=</span><span class=\"pln\"> f</span><span class=\"pun\">[</span><span class=\"pln\">j</span><span class=\"pun\">]</span><span class=\"pln\"> </span><span class=\"pun\">+</span><span class=\"pln\"> f</span><span class=\"pun\">[</span><span class=\"pln\">i</span><span class=\"pun\">]</span><span class=\"pln\"> </span><span class=\"pun\">*</span><span class=\"pln\"> </span><span class=\"pun\">(</span><span class=\"pln\">max</span><span class=\"pun\">(</span><span class=\"pln\">x </span><span class=\"pun\">+</span><span class=\"pln\"> </span><span class=\"lit\">1</span><span class=\"pun\">,</span><span class=\"pln\"> a</span><span class=\"pun\">[</span><span class=\"pln\">j</span><span class=\"pun\">])</span><span class=\"pln\"> </span><span class=\"pun\">-</span><span class=\"pln\"> x</span><span class=\"pun\">)</span><br><span class=\"pln\">            x </span><span class=\"pun\">:=</span><span class=\"pln\"> max</span><span class=\"pun\">(</span><span class=\"pln\">x </span><span class=\"pun\">+</span><span class=\"pln\"> </span><span class=\"lit\">1</span><span class=\"pun\">,</span><span class=\"pln\"> a</span><span class=\"pun\">[</span><span class=\"pln\">j</span><span class=\"pun\">])</span><br></code></pre><p>The initial values are given by <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-2991\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2992\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2993\" style=\"margin-right: 0.05em;\">f</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-2994\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2995\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-2996\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2997\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-2998\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-2999\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi\" id=\"MJXp-Span-3000\">∀</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3001\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3002\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≥</span><span class=\"MJXp-mn\" id=\"MJXp-Span-3003\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3004\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">∧</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3005\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3006\" style=\"margin-left: 0.278em; margin-right: 0.278em;\">mod</span><span class=\"MJXp-mn\" id=\"MJXp-Span-3007\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3008\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-3009\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3010\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3011\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3012\" style=\"margin-right: 0.05em;\">f</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-3013\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-3014\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-3015\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-423\">f_1 = a_1, \\forall i \\geq 3 \\land i \\bmod 2 = 1, f_i = 1</script>. The final answer is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3016\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3017\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3018\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-3019\" style=\"vertical-align: -0.4em;\">m</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-3020\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⋅</span><span class=\"MJXp-munderover\" id=\"MJXp-Span-3021\"><span><span class=\"MJXp-over\"><span class=\" MJXp-script\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-3027\" style=\"margin-right: 0px; margin-left: 0px;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3028\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3029\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-3030\">1</span></span></span><span class=\"\"><span class=\"MJXp-mo\" id=\"MJXp-Span-3022\" style=\"margin-left: 0.111em; margin-right: 0.167em;\">∑</span></span></span></span><span class=\" MJXp-script\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-3023\" style=\"margin-left: 0px;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3024\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3025\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-3026\">1</span></span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-3031\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3032\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3033\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3034\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3035\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3036\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3037\" style=\"margin-left: 0.278em; margin-right: 0.278em;\">mod</span><span class=\"MJXp-mn\" id=\"MJXp-Span-3038\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3039\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-3040\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3041\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3042\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3043\" style=\"margin-right: 0.05em;\">f</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-3044\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-424\">a_m \\cdot \\sum\\limits_{i = 1}^{m - 1} [(m - i) \\bmod 2 = 1] f_i</script>.</p><p>Next, consider counting the strings whose first character is different from <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3045\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3046\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3047\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-3048\" style=\"vertical-align: -0.4em;\">1</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-425\">s_1</script>. It turns out that if the resulting string starts with a different character, then in order to delete the first contiguous segment, the second segment can be at most of length <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3049\"><span class=\"MJXp-mn\" id=\"MJXp-Span-3050\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-426\">1</script>. Therefore, after removing <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3051\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3052\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3053\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-3054\" style=\"vertical-align: -0.4em;\">1</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-427\">a_1</script> and setting <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3055\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3056\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3057\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-3058\" style=\"vertical-align: -0.4em;\">2</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-428\">a_2</script> to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3059\"><span class=\"MJXp-mn\" id=\"MJXp-Span-3060\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-429\">1</script>, we can repeat the above process.</p><p>Next, we optimize the above <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3061\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3062\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3063\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3064\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3065\" style=\"margin-right: 0.05em;\">m</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-3066\" style=\"vertical-align: 0.5em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-3067\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-430\">O(m^2)</script> DP.</p><p>Define <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3068\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3069\"><span class=\"MJXp-mtext\" id=\"MJXp-Span-3070\" style=\"margin-right: 0.05em;\">nxt</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-3071\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-431\">\\text{nxt}_i</script> as the smallest <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3072\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3073\">j</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-432\">j</script> such that <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3074\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3075\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3076\" style=\"margin-left: 0.278em; margin-right: 0.278em;\">mod</span><span class=\"MJXp-mn\" id=\"MJXp-Span-3077\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3078\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3079\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3080\" style=\"margin-left: 0.278em; margin-right: 0.278em;\">mod</span><span class=\"MJXp-mn\" id=\"MJXp-Span-3081\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3082\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">∧</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3083\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3084\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-3085\" style=\"vertical-align: -0.4em;\">j</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-3086\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mfrac\" id=\"MJXp-Span-3087\" style=\"vertical-align: 0.25em;\"><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3088\">j</span></span><span class=\"MJXp-box\" style=\"margin-top: -0.9em;\"><span class=\"MJXp-denom\"><span><span class=\"MJXp-rule\" style=\"height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;\"></span></span><span><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mn\" id=\"MJXp-Span-3089\">2</span></span></span></span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-3090\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&gt;</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3091\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3092\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-3093\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-3094\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mfrac\" id=\"MJXp-Span-3095\" style=\"vertical-align: 0.25em;\"><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3096\">i</span></span><span class=\"MJXp-box\" style=\"margin-top: -0.9em;\"><span class=\"MJXp-denom\"><span><span class=\"MJXp-rule\" style=\"height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;\"></span></span><span><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mn\" id=\"MJXp-Span-3097\">2</span></span></span></span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-433\">j \\bmod 2 = i \\bmod 2 \\land a_j - \\frac{j}{2} > a_i - \\frac{i}{2}</script>.</p><p>For a given <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3098\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3099\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-434\">i</script>, the transition works as follows:</p><ul> <li> Maintain a variable <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3100\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3101\">j</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-435\">j</script> initialized as <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3102\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3103\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3104\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3105\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3106\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-3107\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-436\">j = i + 1</script>. </li><li> Perform a special transition at <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3108\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3109\">j</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-437\">j</script>. </li><li> For <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3110\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3111\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3112\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-3113\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3114\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3115\">k</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3116\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3117\"><span class=\"MJXp-mtext\" id=\"MJXp-Span-3118\" style=\"margin-right: 0.05em;\">nxt</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-3119\" style=\"vertical-align: -0.4em;\">j</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-438\">j + 2 \\leq k < \\text{nxt}_j</script> such that <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3120\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3121\">k</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3122\" style=\"margin-left: 0.278em; margin-right: 0.278em;\">mod</span><span class=\"MJXp-mn\" id=\"MJXp-Span-3123\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3124\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3125\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3126\" style=\"margin-left: 0.278em; margin-right: 0.278em;\">mod</span><span class=\"MJXp-mn\" id=\"MJXp-Span-3127\">2</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-439\">k \\bmod 2 = j \\bmod 2</script>, update <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3128\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3129\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3130\" style=\"margin-right: 0.05em;\">f</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-3131\" style=\"vertical-align: -0.4em;\">k</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-440\">f_k</script> by adding <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3132\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3133\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3134\" style=\"margin-right: 0.05em;\">f</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-3135\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-441\">f_i</script> (which can be implemented using a difference array). </li><li> Set <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3136\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3137\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3138\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3139\"><span class=\"MJXp-mtext\" id=\"MJXp-Span-3140\" style=\"margin-right: 0.05em;\">nxt</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-3141\" style=\"vertical-align: -0.4em;\">j</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-442\">j = \\text{nxt}_j</script> and repeat the process. </li></ul><p>By directly simulating the transition process, it can be shown that the complexity is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3142\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3143\">O</span><span class=\"MJXp-mrow\" id=\"MJXp-Span-3144\"><span class=\"MJXp-mo\" id=\"MJXp-Span-3145\" style=\"margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;\"><span class=\"MJXp-right MJXp-scale7\" style=\"font-size: 1.978em; margin-left: -0.05em;\">(</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-3146\" style=\"margin-left: 0.111em; margin-right: 0.167em;\">∑</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3147\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3148\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-3149\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-3150\" style=\"margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;\"><span class=\"MJXp-right MJXp-scale7\" style=\"font-size: 1.978em; margin-left: -0.05em;\">)</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-3151\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3152\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3153\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3154\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3155\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-443\">O\\left(\\sum a_i\\right) = O(n)</script>, since each <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3156\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3157\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3158\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-3159\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-444\">a_i</script> is only jumped to at most <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3160\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3161\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3162\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-3163\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-445\">a_i</script> times.</p><p>We can further optimize the DP process to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3164\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3165\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3166\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3167\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3168\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-446\">O(m)</script>. Define <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3169\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3170\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3171\" style=\"margin-right: 0.05em;\">g</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-3172\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-447\">g_i</script> as the sum of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3173\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3174\">f</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-448\">f</script>-values of all positions that can jump to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3175\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3176\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-449\">i</script>. Then, the transition is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3177\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3178\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3179\" style=\"margin-right: 0.05em;\">g</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-3180\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3181\"><span class=\"MJXp-mtext\" id=\"MJXp-Span-3182\" style=\"margin-right: 0.05em;\">nxt</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-3183\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-3184\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">←</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3185\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3186\" style=\"margin-right: 0.05em;\">g</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-3187\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3188\"><span class=\"MJXp-mtext\" id=\"MJXp-Span-3189\" style=\"margin-right: 0.05em;\">nxt</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-3190\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-3191\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3192\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3193\" style=\"margin-right: 0.05em;\">g</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-3194\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-450\">g_{\\text{nxt}_i} \\gets g_{\\text{nxt}_i} + g_i</script>. Additionally, for <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3195\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3196\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3197\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-3198\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3199\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3200\">k</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3201\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3202\"><span class=\"MJXp-mtext\" id=\"MJXp-Span-3203\" style=\"margin-right: 0.05em;\">nxt</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-3204\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-451\">i + 2 \\leq k < \\text{nxt}_i</script> such that <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3205\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3206\">k</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3207\" style=\"margin-left: 0.278em; margin-right: 0.278em;\">mod</span><span class=\"MJXp-mn\" id=\"MJXp-Span-3208\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3209\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3210\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3211\" style=\"margin-left: 0.278em; margin-right: 0.278em;\">mod</span><span class=\"MJXp-mn\" id=\"MJXp-Span-3212\">2</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-452\">k \\bmod 2 = i \\bmod 2</script>, update <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3213\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3214\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3215\" style=\"margin-right: 0.05em;\">f</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-3216\" style=\"vertical-align: -0.4em;\">k</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-453\">f_k</script> by adding <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3217\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3218\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3219\" style=\"margin-right: 0.05em;\">g</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-3220\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-454\">g_i</script>, and then perform a special transition for <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3221\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3222\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3223\" style=\"margin-right: 0.05em;\">f</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-3224\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-3225\"><span class=\"MJXp-mtext\" id=\"MJXp-Span-3226\" style=\"margin-right: 0.05em;\">nxt</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-3227\" style=\"vertical-align: -0.4em;\">i</span></span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-455\">f_{\\text{nxt}_i}</script>.</p><p><span class=\"tex-font-style-bf\">Time complexity</span>: <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3228\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3229\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3230\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-3231\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-3232\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-456\">O(n)</script> per test case.</p></div></div></div></div>"
}