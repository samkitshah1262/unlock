<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tutorial</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
      color: #333;
      background: #fafafa;
    }
    .ttypography {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    h3 {
      color: #1a1a1a;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }
    h3 a {
      color: #0066cc;
      text-decoration: none;
    }
    h3 a:hover {
      text-decoration: underline;
    }
    .spoiler {
      margin: 15px 0;
      border: 1px solid #ddd;
      border-radius: 6px;
      overflow: hidden;
    }
    .spoiler-title {
      display: block;
      padding: 12px 15px;
      background: #f0f0f0;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
      border-bottom: 1px solid #ddd;
    }
    .spoiler-title:hover {
      background: #e8e8e8;
    }
    .spoiler-title::before {
      content: '▶ ';
      font-size: 0.8em;
      transition: transform 0.2s;
      display: inline-block;
    }
    .spoiler.open .spoiler-title::before {
      content: '▼ ';
    }
    .spoiler-content {
      padding: 15px;
      background: #fff;
      display: none;
    }
    .spoiler.open .spoiler-content {
      display: block;
    }
    pre, code {
      background: #f5f5f5;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 0.85em;
    }
    pre {
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
    code {
      padding: 2px 5px;
      border-radius: 3px;
    }
    p {
      margin: 10px 0;
    }
    .MathJax {
      font-size: 1.1em;
    }
  </style>
</head>
<body>
  <h1>Editorial</h1>
  <p><a href="https://codeforces.com/blog/entry/140505" target="_blank">View on Codeforces →</a></p>
  
  <div class="ttypography"><p>I hope everyone enjoyed the tasks, and thank you for participating.</p><p>Thank you to the coordinators and testers for suggesting solutions and modifications to the tasks, as I alone wouldn't be able to solve my own tasks or make it to how it is right now. Also thank you to them for dealing with me since July.</p><p>Please tell me in the comments if the editorial is written incorrectly or unintelligibly somewhere. I'm not the best at phrasing some things, and would appreciate amendments to the editorial.</p><p><a href="https://codeforces.com/contest/2078/problem/A" title="Codeforces Round 1008 (Div. 2)">2078A - Final Verdict</a></p> <div class="spoiler"><b class="spoiler-title">Hint</b><div class="spoiler-content" style="display: block;"><p>Something doesn't change after each operation.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>The average of the entire array doesn't change after each operation. Simply check whether the average value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">a</span></span></span><script type="math/tex" id="MathJax-Element-1">a</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">x</span></span></span><script type="math/tex" id="MathJax-Element-2">x</script> or not.</p><p>Time complexity: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mrow" id="MJXp-Span-6"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-7">O</span></span><span class="MJXp-mo" id="MJXp-Span-8" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9">n</span><span class="MJXp-mo" id="MJXp-Span-10" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-3">\mathcal{O}(n)</script> per test case.</p><p>Submission: <a href="https://codeforces.com/contest/2078/submission/310297520" title="Submission 310297520 by omsincoconut">310297520</a></p></div></div><p><a href="https://codeforces.com/contest/2078/problem/B" title="Codeforces Round 1008 (Div. 2)">2078B - Vicious Labyrinth</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Try to put as many people in cell <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-11"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">n</span></span></span><script type="math/tex" id="MathJax-Element-4">n</script> as possible.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>The minimum sum of distances will always be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-13"><span class="MJXp-mn" id="MJXp-Span-14">1</span></span></span><script type="math/tex" id="MathJax-Element-5">1</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>The following configuration gives <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-15"><span class="MJXp-mn" id="MJXp-Span-16">1</span></span></span><script type="math/tex" id="MathJax-Element-6">1</script> as the sum of distances.</p><p>For odd <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-17"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">k</span></span></span><script type="math/tex" id="MathJax-Element-7">k</script>: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-19"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">n</span><span class="MJXp-mo" id="MJXp-Span-21" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">n</span><span class="MJXp-mo" id="MJXp-Span-23" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-24" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-25" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26">n</span><span class="MJXp-mo" id="MJXp-Span-27" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28">n</span><span class="MJXp-mo" id="MJXp-Span-29" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30">n</span><span class="MJXp-mo" id="MJXp-Span-31" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-32">1</span></span></span><script type="math/tex" id="MathJax-Element-8">n, n, \ldots, n, n, n-1</script></p><p>For even <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-33"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">k</span></span></span><script type="math/tex" id="MathJax-Element-9">k</script>: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-35"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">n</span><span class="MJXp-mo" id="MJXp-Span-37" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-38">1</span><span class="MJXp-mo" id="MJXp-Span-39" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">n</span><span class="MJXp-mo" id="MJXp-Span-41" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-42">1</span><span class="MJXp-mo" id="MJXp-Span-43" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-44" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">n</span><span class="MJXp-mo" id="MJXp-Span-47" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-48">1</span><span class="MJXp-mo" id="MJXp-Span-49" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">n</span><span class="MJXp-mo" id="MJXp-Span-51" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">n</span><span class="MJXp-mo" id="MJXp-Span-53" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-54">1</span></span></span><script type="math/tex" id="MathJax-Element-10">n-1, n-1, \ldots, n-1, n, n-1</script></p><p>And the sum of distances cannot be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-55"><span class="MJXp-mn" id="MJXp-Span-56">0</span></span></span><script type="math/tex" id="MathJax-Element-11">0</script>.</p> <div class="spoiler"><b class="spoiler-title">Proof</b><div class="spoiler-content" style="display: block;"><p>Look at this as a directed (or more specifically, a functional) graph. There will be a cycle, and people in the same cycle will never be in the same cell, so not everyone can simultaneously be in cell <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-57"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">n</span></span></span><script type="math/tex" id="MathJax-Element-12">n</script>.</p></div></div><p>Time complexity: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-59"><span class="MJXp-mrow" id="MJXp-Span-60"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-61">O</span></span><span class="MJXp-mo" id="MJXp-Span-62" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63">n</span><span class="MJXp-mo" id="MJXp-Span-64" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-13">\mathcal{O}(n)</script> per test case.</p><p>Submission: <a href="https://codeforces.com/contest/2078/submission/310297574" title="Submission 310297574 by omsincoconut">310297574</a></p></div></div> <div class="spoiler"><b class="spoiler-title">Extra</b><div class="spoiler-content" style="display: block;"><p>Prove that the optimal configuration is unique.</p></div></div><p><a href="https://codeforces.com/contest/2077/problem/A" title="Codeforces Round 1008 (Div. 1)">2077A - Breach of Faith</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Rearrange the equation around.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Try to maximize the missing number.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>The equation can be rearranged to</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-65"><span class="MJXp-msubsup" id="MJXp-Span-66"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-68" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-69">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-71" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-72"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-74" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-75" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-76" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-77"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-79" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-80" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-81"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-83" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-84" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-85" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-86" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-87"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-89" style="vertical-align: -0.4em;">5</span></span><span class="MJXp-mo" id="MJXp-Span-90" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-91"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-93" style="vertical-align: -0.4em;">4</span></span><span class="MJXp-mo" id="MJXp-Span-94" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-95" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-96" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-97" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-98" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-99"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-101" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-102">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103">n</span><span class="MJXp-mo" id="MJXp-Span-104">−</span><span class="MJXp-mn" id="MJXp-Span-105">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-106" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-109" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-110">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111">n</span><span class="MJXp-mo" id="MJXp-Span-112">−</span><span class="MJXp-mn" id="MJXp-Span-113">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-114" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-115" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-116"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-118" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-119">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">n</span><span class="MJXp-mo" id="MJXp-Span-121">+</span><span class="MJXp-mn" id="MJXp-Span-122">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-14"> a_{2n} = a_1 + (a_3 - a_2) + (a_5 - a_4) + \ldots + (a_{2n-1} - a_{2n-2}) + a_{2n+1} </script></center><p>Choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-123"><span class="MJXp-msubsup" id="MJXp-Span-124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-126" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-15">a_1</script> as the largest number, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-127"><span class="MJXp-msubsup" id="MJXp-Span-128"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-130" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-131" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-132"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-134" style="vertical-align: -0.4em;">5</span></span><span class="MJXp-mo" id="MJXp-Span-135" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-136" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-137" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-138"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-140" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-141">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">n</span><span class="MJXp-mo" id="MJXp-Span-143">+</span><span class="MJXp-mn" id="MJXp-Span-144">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-16">a_3, a_5, \ldots, a_{2n+1}</script> as the next <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-145"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">n</span></span></span><script type="math/tex" id="MathJax-Element-17">n</script> largest numbers, and the rest as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-147"><span class="MJXp-msubsup" id="MJXp-Span-148"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-150" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-151" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-154" style="vertical-align: -0.4em;">4</span></span><span class="MJXp-mo" id="MJXp-Span-155" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-156" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-157" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-158"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-160" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-161">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">n</span><span class="MJXp-mo" id="MJXp-Span-163">−</span><span class="MJXp-mn" id="MJXp-Span-164">2</span></span></span></span></span><script type="math/tex" id="MathJax-Element-18">a_2, a_4, \ldots, a_{2n-2}</script>. The value of the missing number <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-165"><span class="MJXp-msubsup" id="MJXp-Span-166"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-168" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-169">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">n</span></span></span></span></span><script type="math/tex" id="MathJax-Element-19">a_{2n}</script> will be larger than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-171"><span class="MJXp-msubsup" id="MJXp-Span-172"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-174" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-20">a_1</script>, and so larger than every number in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">b</span></span></span><script type="math/tex" id="MathJax-Element-21">b</script>.</p><p>Time complexity: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-177"><span class="MJXp-mrow" id="MJXp-Span-178"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-179">O</span></span><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">n</span><span class="MJXp-mi" id="MJXp-Span-182">log</span><span class="MJXp-mo" id="MJXp-Span-183" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">n</span><span class="MJXp-mo" id="MJXp-Span-185" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-22">\mathcal{O}(n \log n)</script> per test case. Logarithmic factor is from sorting.</p><p>Submission: <a href="https://codeforces.com/contest/2077/submission/310297635" title="Submission 310297635 by omsincoconut">310297635</a></p></div></div> <div class="spoiler"><b class="spoiler-title">Note</b><div class="spoiler-content" style="display: block;"><p>There are some randomization solutions where we just shuffle <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-186"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">b</span></span></span><script type="math/tex" id="MathJax-Element-23">b</script> randomly, fill the missing number, and attempt it as a possible solution. I do not have a proof or disproof of whether this would work well enough.</p></div></div><p><a href="https://codeforces.com/contest/2078/problem/D" title="Codeforces Round 1008 (Div. 2)">2078D - Scammy Game Ad</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>It is optimal to place everyone on the same lane.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Think about the multiplier.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>It is best to think of each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-188"><span class="MJXp-mrow" id="MJXp-Span-189"><span class="MJXp-mo MJXp-mono" id="MJXp-Span-190" style="margin-left: 0.267em; margin-right: 0.267em;">+</span></span></span></span><script type="math/tex" id="MathJax-Element-24">\tt{+}</script> as "how much can we multiply this by".</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution 1</b><div class="spoiler-content" style="display: block;"><p>This is the <strong>greedy</strong> solution.</p><p>When we get more people, place all to where the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-191"><span class="MJXp-mrow" id="MJXp-Span-192"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-193">x</span></span></span></span><script type="math/tex" id="MathJax-Element-25">\tt{x}</script> will occur first. If both lanes have the next multiply at the same gate pair, then choose the one with higher multiply. If the multiply is the same, look to the next multiply.</p> <div class="spoiler"><b class="spoiler-title">Proof</b><div class="spoiler-content" style="display: block;"><p>It's easier to think of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-194"><span class="MJXp-mrow" id="MJXp-Span-195"><span class="MJXp-mo MJXp-mono" id="MJXp-Span-196" style="margin-left: 0.267em; margin-right: 0.267em;">+</span></span></span></span><script type="math/tex" id="MathJax-Element-26">\tt{+}</script> as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-197"><span class="MJXp-mrow" id="MJXp-Span-198"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-199">x</span></span><span class="MJXp-mn MJXp-mono" id="MJXp-Span-200">1</span></span></span><script type="math/tex" id="MathJax-Element-27">\tt{x} 1</script>. The idea is as follows.</p><p>Consider the range of gate pairs between two pairs with different multiply, and the pairs in the range all have the same multiply. You have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-201"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">l</span></span></span><script type="math/tex" id="MathJax-Element-28">l</script> people on the left side and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-203"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">r</span></span></span><script type="math/tex" id="MathJax-Element-29">r</script> on the right side before you enter the range. In this range, you will gain a constant number of people, say <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-205"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">x</span></span></span><script type="math/tex" id="MathJax-Element-30">x</script>, regardless of your actions here. You choose to allocate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">y</span></span></span><script type="math/tex" id="MathJax-Element-31">y</script> to the left side.</p><p>At the end of the range, there's a pair of gates <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-209"><span class="MJXp-mrow" id="MJXp-Span-210"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-211">x</span></span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-212">a</span></span></span><script type="math/tex" id="MathJax-Element-32">\tt{x} a</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-213"><span class="MJXp-mrow" id="MJXp-Span-214"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-215">x</span></span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-216">b</span></span></span><script type="math/tex" id="MathJax-Element-33">\tt{x} b</script> where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-217"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">a</span><span class="MJXp-mo" id="MJXp-Span-219" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">b</span></span></span><script type="math/tex" id="MathJax-Element-34">a > b</script> (same argument for case <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-221"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">a</span><span class="MJXp-mo" id="MJXp-Span-223" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">b</span></span></span><script type="math/tex" id="MathJax-Element-35">a < b</script>). After passing the gate, you will gain <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-225"><span class="MJXp-mo" id="MJXp-Span-226" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">a</span><span class="MJXp-mo" id="MJXp-Span-228" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-229">1</span><span class="MJXp-mo" id="MJXp-Span-230" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-231" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">l</span><span class="MJXp-mo" id="MJXp-Span-233" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">y</span><span class="MJXp-mo" id="MJXp-Span-235" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-236" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-237" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">b</span><span class="MJXp-mo" id="MJXp-Span-239" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-240">1</span><span class="MJXp-mo" id="MJXp-Span-241" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-242" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-243">r</span><span class="MJXp-mo" id="MJXp-Span-244" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">x</span><span class="MJXp-mo" id="MJXp-Span-246" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">y</span><span class="MJXp-mo" id="MJXp-Span-248" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-36">(a-1)(l+y) + (b-1)(r+x-y)</script> more people. With the current number people of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-249"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">l</span><span class="MJXp-mo" id="MJXp-Span-251" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252">y</span></span></span><script type="math/tex" id="MathJax-Element-37">l+y</script> on the left side and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-253"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254">r</span><span class="MJXp-mo" id="MJXp-Span-255" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">x</span><span class="MJXp-mo" id="MJXp-Span-257" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">y</span></span></span><script type="math/tex" id="MathJax-Element-38">r+x-y</script> on the right side, we can see that maximizing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">y</span></span></span><script type="math/tex" id="MathJax-Element-39">y</script> is the optimal choice, because there always exist an allocation such that both number of people on the left and right side will exceed those with lower selection of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-261"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">y</span></span></span><script type="math/tex" id="MathJax-Element-40">y</script>.</p></div></div><p>Time complexity: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-263"><span class="MJXp-mrow" id="MJXp-Span-264"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-265">O</span></span><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">n</span><span class="MJXp-mo" id="MJXp-Span-268" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-41">\mathcal{O}(n)</script> per test case. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-269"><span class="MJXp-mrow" id="MJXp-Span-270"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-271">O</span></span><span class="MJXp-mo" id="MJXp-Span-272" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-273"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-275" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-276" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-42">\mathcal{O}(n^2)</script> implementations are also acceptable.</p><p>Submission: <a href="https://codeforces.com/contest/2078/submission/310297718" title="Submission 310297718 by omsincoconut">310297718</a></p></div></div> <div class="spoiler"><b class="spoiler-title">Solution 2</b><div class="spoiler-content" style="display: block;"><p>This is the <strong>dynamic programming</strong> solution.</p><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-277"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">d</span><span class="MJXp-msubsup" id="MJXp-Span-279"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-281" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-282" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">i</span><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-43">dp_l[i]</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-285"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">d</span><span class="MJXp-msubsup" id="MJXp-Span-287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-289" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-290" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">i</span><span class="MJXp-mo" id="MJXp-Span-292" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-44">dp_r[i]</script> be the maximum possible multiplication possible that can be applied if a person enters the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-293"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294">i</span></span></span><script type="math/tex" id="MathJax-Element-45">i</script>-th left and right gate, respectively. Then we have the following equation (only for left is written, it's the same for the right).</p><p>If the gate is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-295"><span class="MJXp-mrow" id="MJXp-Span-296"><span class="MJXp-mo MJXp-mono" id="MJXp-Span-297" style="margin-left: 0.267em; margin-right: 0.267em;">+</span></span></span></span><script type="math/tex" id="MathJax-Element-46">\tt{+}</script></p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-298"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">d</span><span class="MJXp-msubsup" id="MJXp-Span-300"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-302" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-303" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">i</span><span class="MJXp-mo" id="MJXp-Span-305" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-306" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">d</span><span class="MJXp-msubsup" id="MJXp-Span-308"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-310" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-311" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">i</span><span class="MJXp-mo" id="MJXp-Span-313" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-314">1</span><span class="MJXp-mo" id="MJXp-Span-315" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-47">dp_l[i] = dp_l[i+1]</script></center><p>If the gate is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-316"><span class="MJXp-mrow" id="MJXp-Span-317"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-318">x</span></span></span></span><script type="math/tex" id="MathJax-Element-48">\tt{x}</script> by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-319"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320">a</span></span></span><script type="math/tex" id="MathJax-Element-49">a</script></p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-347">d</span><span class="MJXp-msubsup" id="MJXp-Span-348"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-350" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-351" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">i</span><span class="MJXp-mo" id="MJXp-Span-353" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-354" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">d</span><span class="MJXp-msubsup" id="MJXp-Span-356"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-358" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-359" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360">i</span><span class="MJXp-mo" id="MJXp-Span-361" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-362">1</span><span class="MJXp-mo" id="MJXp-Span-363" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-364" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-365" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">a</span><span class="MJXp-mo" id="MJXp-Span-367" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-368">1</span><span class="MJXp-mo" id="MJXp-Span-369" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-370" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-371" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">d</span><span class="MJXp-msubsup" id="MJXp-Span-373"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-375" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-376" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377">i</span><span class="MJXp-mo" id="MJXp-Span-378" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-379">1</span><span class="MJXp-mo" id="MJXp-Span-380" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-381" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382">d</span><span class="MJXp-msubsup" id="MJXp-Span-383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-385" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-386" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">i</span><span class="MJXp-mo" id="MJXp-Span-388" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-389">1</span><span class="MJXp-mo" id="MJXp-Span-390" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-391" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-50">dp_l[i] = dp_l[i+1] + (a-1)\max(dp_l[i+1], dp_r[i+1])</script></center><p>For each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-392"><span class="MJXp-mrow" id="MJXp-Span-393"><span class="MJXp-mo MJXp-mono" id="MJXp-Span-394" style="margin-left: 0.267em; margin-right: 0.267em;">+</span></span></span></span><script type="math/tex" id="MathJax-Element-51">\tt{+}</script>, we choose to place people at the side with more multiplication.</p><p>Time complexity: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-395"><span class="MJXp-mrow" id="MJXp-Span-396"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-397">O</span></span><span class="MJXp-mo" id="MJXp-Span-398" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399">n</span><span class="MJXp-mo" id="MJXp-Span-400" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-52">\mathcal{O}(n)</script> per test case.</p><p>Submission: <a href="https://codeforces.com/contest/2078/submission/310297763" title="Submission 310297763 by omsincoconut">310297763</a></p></div></div> <div class="spoiler"><b class="spoiler-title">Note</b><div class="spoiler-content" style="display: block;"><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">n</span><span class="MJXp-mo" id="MJXp-Span-403" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-404">30</span></span></span><script type="math/tex" id="MathJax-Element-53">n = 30</script> constraint is due to overflow. The maximum answer is the case with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-405"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">n</span><span class="MJXp-mo" id="MJXp-Span-407" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-408">30</span></span></span><script type="math/tex" id="MathJax-Element-54">n = 30</script>, the first pair of gates is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-409"><span class="MJXp-mrow" id="MJXp-Span-410"><span class="MJXp-mo MJXp-mono" id="MJXp-Span-411" style="margin-left: 0.267em; margin-right: 0.267em;">+</span></span><span class="MJXp-mn MJXp-mono" id="MJXp-Span-412">1000</span></span></span><script type="math/tex" id="MathJax-Element-55">\tt{+} 1000</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-413"><span class="MJXp-mrow" id="MJXp-Span-414"><span class="MJXp-mo MJXp-mono" id="MJXp-Span-415" style="margin-left: 0.267em; margin-right: 0.267em;">+</span></span><span class="MJXp-mn MJXp-mono" id="MJXp-Span-416">1000</span></span></span><script type="math/tex" id="MathJax-Element-56">\tt{+} 1000</script>, and the other pairs of gates are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-417"><span class="MJXp-mrow" id="MJXp-Span-418"><span class="MJXp-mo MJXp-mono" id="MJXp-Span-419" style="margin-left: 0.267em; margin-right: 0.267em;">+</span></span><span class="MJXp-mn MJXp-mono" id="MJXp-Span-420">1000</span></span></span><script type="math/tex" id="MathJax-Element-57">\tt{+} 1000</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-421"><span class="MJXp-mrow" id="MJXp-Span-422"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-423">x</span></span><span class="MJXp-mn MJXp-mono" id="MJXp-Span-424">3</span></span></span><script type="math/tex" id="MathJax-Element-58">\tt{x} 3</script>, giving the answer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-425"><span class="MJXp-mn" id="MJXp-Span-426">171644573789571884</span><span class="MJXp-mo" id="MJXp-Span-427" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-428"><span class="MJXp-mn" id="MJXp-Span-429" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-430" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-431">18</span></span></span></span></span><script type="math/tex" id="MathJax-Element-59">171644573789571884 < 10^{18}</script>.</p><p>It is possible to solve this task under modulo and force <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-432"><span class="MJXp-mrow" id="MJXp-Span-433"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-434">O</span></span><span class="MJXp-mo" id="MJXp-Span-435" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436">n</span><span class="MJXp-mo" id="MJXp-Span-437" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-60">\mathcal{O}(n)</script> solution, but it will be hard, or maybe impossible, to implement the DP solution which requires min/max operations, so I decided against it.</p></div></div><p><a href="https://codeforces.com/contest/2077/problem/B" title="Codeforces Round 1008 (Div. 1)">2077B - Finding OR Sum</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Try to get information on half of the bits.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Alternate the bits.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>The queries are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-438"><span class="MJXp-mo" id="MJXp-Span-439" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-msubsup" id="MJXp-Span-440"><span class="MJXp-mn" id="MJXp-Span-441" style="margin-right: 0.05em;">0101</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-442" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-61">\ldots 0101_2</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-443"><span class="MJXp-mo" id="MJXp-Span-444" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-msubsup" id="MJXp-Span-445"><span class="MJXp-mn" id="MJXp-Span-446" style="margin-right: 0.05em;">1010</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-447" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-62">\ldots 1010_2</script>.</p><p>It's easier to look at the case with only two binary digits first.</p><p>Let the result of query <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-448"><span class="MJXp-msubsup" id="MJXp-Span-449"><span class="MJXp-mn" id="MJXp-Span-450" style="margin-right: 0.05em;">01</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-451" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-63">01_2</script> be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-452"><span class="MJXp-msubsup" id="MJXp-Span-453"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454" style="margin-right: 0.05em;">q</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-455" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-64">q_1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-456"><span class="MJXp-msubsup" id="MJXp-Span-457"><span class="MJXp-mn" id="MJXp-Span-458" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-459" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-65">10_2</script> be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-460"><span class="MJXp-msubsup" id="MJXp-Span-461"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462" style="margin-right: 0.05em;">q</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-463" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-66">q_2</script>.</p><p>Observe that if</p> <ul>   <li><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-464"><span class="MJXp-msubsup" id="MJXp-Span-465"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466" style="margin-right: 0.05em;">q</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-467" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-468" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-469"><span class="MJXp-mn" id="MJXp-Span-470" style="margin-right: 0.05em;">100</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-471" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-67">q_2 = 100_2</script> then the first (from the right) digit of both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-472"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473">x</span></span></span><script type="math/tex" id="MathJax-Element-68">x</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-474"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">y</span></span></span><script type="math/tex" id="MathJax-Element-69">y</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-476"><span class="MJXp-mn" id="MJXp-Span-477">0</span></span></span><script type="math/tex" id="MathJax-Element-70">0</script>.</p></li>   <li><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-478"><span class="MJXp-msubsup" id="MJXp-Span-479"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480" style="margin-right: 0.05em;">q</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-481" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-482" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-483"><span class="MJXp-mn" id="MJXp-Span-484" style="margin-right: 0.05em;">101</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-485" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-71">q_2 = 101_2</script> then the first (from the right) digit of one of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-486"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">x</span></span></span><script type="math/tex" id="MathJax-Element-72">x</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-488"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">y</span></span></span><script type="math/tex" id="MathJax-Element-73">y</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-490"><span class="MJXp-mn" id="MJXp-Span-491">0</span></span></span><script type="math/tex" id="MathJax-Element-74">0</script>, and the other one is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-492"><span class="MJXp-mn" id="MJXp-Span-493">1</span></span></span><script type="math/tex" id="MathJax-Element-75">1</script>.</p></li>   <li><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-494"><span class="MJXp-msubsup" id="MJXp-Span-495"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496" style="margin-right: 0.05em;">q</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-497" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-498" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-499"><span class="MJXp-mn" id="MJXp-Span-500" style="margin-right: 0.05em;">110</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-501" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-76">q_2 = 110_2</script> then the first (from the right) digit of both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-502"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">x</span></span></span><script type="math/tex" id="MathJax-Element-77">x</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">y</span></span></span><script type="math/tex" id="MathJax-Element-78">y</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-506"><span class="MJXp-mn" id="MJXp-Span-507">1</span></span></span><script type="math/tex" id="MathJax-Element-79">1</script>.</p></li> </ul><p>Similarly, if</p> <ul>   <li><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-508"><span class="MJXp-msubsup" id="MJXp-Span-509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510" style="margin-right: 0.05em;">q</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-511" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-512" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-513"><span class="MJXp-mn" id="MJXp-Span-514" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-515" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-80">q_1 = 10_2</script> then the second (from the right) digit of both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-516"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517">x</span></span></span><script type="math/tex" id="MathJax-Element-81">x</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-518"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519">y</span></span></span><script type="math/tex" id="MathJax-Element-82">y</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-520"><span class="MJXp-mn" id="MJXp-Span-521">0</span></span></span><script type="math/tex" id="MathJax-Element-83">0</script>.</p></li>   <li><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-522"><span class="MJXp-msubsup" id="MJXp-Span-523"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-524" style="margin-right: 0.05em;">q</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-525" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-526" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-527"><span class="MJXp-mn" id="MJXp-Span-528" style="margin-right: 0.05em;">100</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-529" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-84">q_1 = 100_2</script> then the second (from the right) digit of one of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-530"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">x</span></span></span><script type="math/tex" id="MathJax-Element-85">x</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">y</span></span></span><script type="math/tex" id="MathJax-Element-86">y</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-534"><span class="MJXp-mn" id="MJXp-Span-535">0</span></span></span><script type="math/tex" id="MathJax-Element-87">0</script>, and the other one is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-536"><span class="MJXp-mn" id="MJXp-Span-537">1</span></span></span><script type="math/tex" id="MathJax-Element-88">1</script>.</p></li>   <li><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-538"><span class="MJXp-msubsup" id="MJXp-Span-539"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540" style="margin-right: 0.05em;">q</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-541" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-542" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-543"><span class="MJXp-mn" id="MJXp-Span-544" style="margin-right: 0.05em;">110</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-545" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-89">q_1 = 110_2</script> then the second (from the right) digit of both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-546"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-547">x</span></span></span><script type="math/tex" id="MathJax-Element-90">x</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-548"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-549">y</span></span></span><script type="math/tex" id="MathJax-Element-91">y</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-550"><span class="MJXp-mn" id="MJXp-Span-551">1</span></span></span><script type="math/tex" id="MathJax-Element-92">1</script>.</p></li> </ul><p>To generalize to every other digit, apply the same logic to every consecutive pair of digits in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-552"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553">x</span></span></span><script type="math/tex" id="MathJax-Element-93">x</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-554"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555">y</span></span></span><script type="math/tex" id="MathJax-Element-94">y</script>. Note that you must account for the carries from the digits before too.</p><p>After this, you will know for every digit position whether both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-556"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557">x</span></span></span><script type="math/tex" id="MathJax-Element-95">x</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-558"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">y</span></span></span><script type="math/tex" id="MathJax-Element-96">y</script> are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-560"><span class="MJXp-mn" id="MJXp-Span-561">0</span></span></span><script type="math/tex" id="MathJax-Element-97">0</script>, are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-562"><span class="MJXp-mn" id="MJXp-Span-563">1</span></span></span><script type="math/tex" id="MathJax-Element-98">1</script>, or have one <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-564"><span class="MJXp-mn" id="MJXp-Span-565">0</span></span></span><script type="math/tex" id="MathJax-Element-99">0</script> and one <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-566"><span class="MJXp-mn" id="MJXp-Span-567">1</span></span></span><script type="math/tex" id="MathJax-Element-100">1</script>. You can use this information to find <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-568"><span class="MJXp-mo" id="MJXp-Span-569" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570">m</span><span class="MJXp-mrow" id="MJXp-Span-571"><span class="MJXp-mo" id="MJXp-Span-572" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573">x</span><span class="MJXp-mo" id="MJXp-Span-574" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-575" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-576" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">m</span><span class="MJXp-mrow" id="MJXp-Span-578"><span class="MJXp-mo" id="MJXp-Span-579" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-580">y</span><span class="MJXp-mo" id="MJXp-Span-581" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-101">(m|x) + (m|y)</script> for any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-582"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583">m</span></span></span><script type="math/tex" id="MathJax-Element-102">m</script>.</p><p>Time complexity: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-584"><span class="MJXp-mrow" id="MJXp-Span-585"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-586">O</span></span><span class="MJXp-mo" id="MJXp-Span-587" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-588">log</span><span class="MJXp-mo" id="MJXp-Span-589" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-590" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-591" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592">x</span><span class="MJXp-mo" id="MJXp-Span-593" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-594" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-103">\mathcal{O}(\log \max (x))</script> per test case.</p><p>Submission: <a href="https://codeforces.com/contest/2077/submission/310297820" title="Submission 310297820 by omsincoconut">310297820</a></p></div></div><p><a href="https://codeforces.com/contest/2077/problem/C" title="Codeforces Round 1008 (Div. 1)">2077C - Binary Subsequence Value Sum</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Find a closed-form expression for the score of a binary string.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>The closed-form expression for the score of a binary string is</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-595"><span class="MJXp-mo" id="MJXp-Span-596" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-597" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-598">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599">n</span><span class="MJXp-msubsup" id="MJXp-Span-600"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-601" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-602" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-603">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-604">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605">n</span><span class="MJXp-msubsup" id="MJXp-Span-606"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-608" style="vertical-align: -0.4em;">1</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-609">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-610" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-611" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mfrac" id="MJXp-Span-612" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-614">n</span><span class="MJXp-msubsup" id="MJXp-Span-615"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-616" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-617" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-618">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-619">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620">n</span><span class="MJXp-msubsup" id="MJXp-Span-621"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-623" style="vertical-align: -0.4em;">1</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-624">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-625" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span><script type="math/tex" id="MathJax-Element-104">\lfloor \frac{cnt_0-cnt_1}{2} \rfloor \lceil \frac{cnt_0-cnt_1}{2} \rceil</script></center><p>Where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-627">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628">n</span><span class="MJXp-msubsup" id="MJXp-Span-629"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-630" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-631" style="vertical-align: -0.4em;">0</span></span></span></span><script type="math/tex" id="MathJax-Element-105">cnt_0</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-632"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-634">n</span><span class="MJXp-msubsup" id="MJXp-Span-635"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-636" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-637" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-106">cnt_1</script> are the number of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-638"><span class="MJXp-mrow" id="MJXp-Span-639"><span class="MJXp-mn MJXp-mono" id="MJXp-Span-640">0</span></span></span></span><script type="math/tex" id="MathJax-Element-107">\tt{0}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-641"><span class="MJXp-mrow" id="MJXp-Span-642"><span class="MJXp-mn MJXp-mono" id="MJXp-Span-643">1</span></span></span></span><script type="math/tex" id="MathJax-Element-108">\tt{1}</script> in the binary string, respectively.</p> <div class="spoiler"><b class="spoiler-title">A useful rearrangement</b><div class="spoiler-content" style="display: block;"><center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-644"><span class="MJXp-mo" id="MJXp-Span-645" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-646" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-647">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">n</span><span class="MJXp-msubsup" id="MJXp-Span-649"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-650" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-651" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-652">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654">n</span><span class="MJXp-msubsup" id="MJXp-Span-655"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-656" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-657" style="vertical-align: -0.4em;">1</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-658">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-659" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-660" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mfrac" id="MJXp-Span-661" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-662">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663">n</span><span class="MJXp-msubsup" id="MJXp-Span-664"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-665" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-666" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-667">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-668">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669">n</span><span class="MJXp-msubsup" id="MJXp-Span-670"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-671" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-672" style="vertical-align: -0.4em;">1</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-673">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-674" style="margin-left: 0em; margin-right: 0em;">⌉</span><span class="MJXp-mo" id="MJXp-Span-675" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-676" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mo" id="MJXp-Span-677">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-678">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-679">n</span><span class="MJXp-msubsup" id="MJXp-Span-680"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-682" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-683">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685">n</span><span class="MJXp-msubsup" id="MJXp-Span-686"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-687" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-688" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-msubsup" id="MJXp-Span-689"><span class="MJXp-mo" id="MJXp-Span-690" style="margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-691" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-692">4</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-693" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-694" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mo" id="MJXp-Span-695">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697">n</span><span class="MJXp-msubsup" id="MJXp-Span-698"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-699" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-700" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-701">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-702">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">n</span><span class="MJXp-msubsup" id="MJXp-Span-704"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-705" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-706" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-707"><span class="MJXp-mspace" id="MJXp-Span-708" style="width: 0.667em; height: 0em;"></span></span><span class="MJXp-mi" id="MJXp-Span-709">mod</span><span class="MJXp-mspace" id="MJXp-Span-710" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-711" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-712">2</span><span class="MJXp-mo" id="MJXp-Span-713">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-714">4</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-109">\lfloor \frac{cnt_0-cnt_1}{2} \rfloor \lceil \frac{cnt_0-cnt_1}{2} \rceil = \frac{(cnt_0-cnt_1)^2}{4} - \frac{(cnt_0-cnt_1 \mod 2)}{4}</script></center></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>The expression for counting subsequences might be simpler than you think.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Think of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-715"><span class="MJXp-mrow" id="MJXp-Span-716"><span class="MJXp-mn MJXp-mono" id="MJXp-Span-717">0</span></span></span></span><script type="math/tex" id="MathJax-Element-110">\tt{0}</script> as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-718"><span class="MJXp-mo" id="MJXp-Span-719" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-720">1</span></span></span><script type="math/tex" id="MathJax-Element-111">-1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-721"><span class="MJXp-mrow" id="MJXp-Span-722"><span class="MJXp-mn MJXp-mono" id="MJXp-Span-723">1</span></span></span></span><script type="math/tex" id="MathJax-Element-112">\tt{1}</script> as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-724"><span class="MJXp-mn" id="MJXp-Span-725">1</span></span></span><script type="math/tex" id="MathJax-Element-113">1</script>. Let us count the number of subsequences of a binary string which will have the sum of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-726"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727">i</span></span></span><script type="math/tex" id="MathJax-Element-114">i</script>. Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-730">n</span><span class="MJXp-msubsup" id="MJXp-Span-731"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-732" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-733" style="vertical-align: -0.4em;">0</span></span></span></span><script type="math/tex" id="MathJax-Element-115">cnt_0</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-735">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-736">n</span><span class="MJXp-msubsup" id="MJXp-Span-737"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-739" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-116">cnt_1</script> as the number of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-740"><span class="MJXp-mrow" id="MJXp-Span-741"><span class="MJXp-mn MJXp-mono" id="MJXp-Span-742">0</span></span></span></span><script type="math/tex" id="MathJax-Element-117">\tt{0}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-743"><span class="MJXp-mrow" id="MJXp-Span-744"><span class="MJXp-mn MJXp-mono" id="MJXp-Span-745">1</span></span></span></span><script type="math/tex" id="MathJax-Element-118">\tt{1}</script> in the binary string. The number of subsequences is</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-746"><span class="MJXp-mrow" id="MJXp-Span-747"><span class="MJXp-TeXmathchoice" id="MJXp-Span-748"><span class="MJXp-mstyle" id="MJXp-Span-749"><span class="MJXp-mrow" id="MJXp-Span-750"><span class="MJXp-mo" id="MJXp-Span-751" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-752"><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-753"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-754">n</span></span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-755"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">i</span><span class="MJXp-mo" id="MJXp-Span-757">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-759">n</span><span class="MJXp-msubsup" id="MJXp-Span-760"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-761" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-762" style="vertical-align: -0.4em;">0</span></span></span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-763"><span class="MJXp-mstyle" id="MJXp-Span-764"><span class="MJXp-mrow" id="MJXp-Span-765"><span class="MJXp-mo" id="MJXp-Span-766" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-119">{n} \choose {i + cnt_0}</script></center> <div class="spoiler"><b class="spoiler-title">Proof</b><div class="spoiler-content" style="display: block;"><p>We change the perspective on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-767"><span class="MJXp-mrow" id="MJXp-Span-768"><span class="MJXp-mn MJXp-mono" id="MJXp-Span-769">0</span></span></span></span><script type="math/tex" id="MathJax-Element-120">\tt{0}</script> slightly from contributing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-770"><span class="MJXp-mo" id="MJXp-Span-771" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-772">1</span></span></span><script type="math/tex" id="MathJax-Element-121">-1</script> to the sum if chosen and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-773"><span class="MJXp-mn" id="MJXp-Span-774">0</span></span></span><script type="math/tex" id="MathJax-Element-122">0</script> to the sum if not chosen, to contributing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-775"><span class="MJXp-mn" id="MJXp-Span-776">0</span></span></span><script type="math/tex" id="MathJax-Element-123">0</script> to the sum if chosen and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-777"><span class="MJXp-mn" id="MJXp-Span-778">1</span></span></span><script type="math/tex" id="MathJax-Element-124">1</script> to the sum if not chosen. This changes the problem to having <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-779"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-780">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-781">n</span><span class="MJXp-msubsup" id="MJXp-Span-782"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-784" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-785" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">n</span><span class="MJXp-msubsup" id="MJXp-Span-788"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-790" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-791" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">n</span></span></span><script type="math/tex" id="MathJax-Element-125">cnt_0 + cnt_1 = n</script> distinct objects and needing to pick <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-793"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-794">i</span><span class="MJXp-mo" id="MJXp-Span-795" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-796">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-797">n</span><span class="MJXp-msubsup" id="MJXp-Span-798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-800" style="vertical-align: -0.4em;">0</span></span></span></span><script type="math/tex" id="MathJax-Element-126">i+cnt_0</script> of them.</p></div></div><p>So the desired sum of the score over all subsequences (see expression of score of a single string in Hint 2) is</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-801"><span class="MJXp-msubsup" id="MJXp-Span-802"><span class="MJXp-mo" id="MJXp-Span-803" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-813"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814">n</span><span class="MJXp-mo" id="MJXp-Span-815">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">n</span><span class="MJXp-msubsup" id="MJXp-Span-818"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-820" style="vertical-align: -0.4em;">0</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-804"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-805">i</span><span class="MJXp-mo" id="MJXp-Span-806">=</span><span class="MJXp-mo" id="MJXp-Span-807">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-808">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809">n</span><span class="MJXp-msubsup" id="MJXp-Span-810"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-811" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-812" style="vertical-align: -0.4em;">0</span></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-821"><span class="MJXp-mrow" id="MJXp-Span-822"><span class="MJXp-TeXmathchoice" id="MJXp-Span-823"><span class="MJXp-mstyle" id="MJXp-Span-824"><span class="MJXp-mrow" id="MJXp-Span-825"><span class="MJXp-mo" id="MJXp-Span-826" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-827"><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-828"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-829">n</span></span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-830"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-831">i</span><span class="MJXp-mo" id="MJXp-Span-832">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-834">n</span><span class="MJXp-msubsup" id="MJXp-Span-835"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-837" style="vertical-align: -0.4em;">0</span></span></span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-838"><span class="MJXp-mstyle" id="MJXp-Span-839"><span class="MJXp-mrow" id="MJXp-Span-840"><span class="MJXp-mo" id="MJXp-Span-841" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-842" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-843" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-844"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-846" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-847">4</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-848" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-849" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mo" id="MJXp-Span-850">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-851">i</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-852"><span class="MJXp-mspace" id="MJXp-Span-853" style="width: 0.667em; height: 0em;"></span></span><span class="MJXp-mi" id="MJXp-Span-854">mod</span><span class="MJXp-mspace" id="MJXp-Span-855" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-856" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-857">2</span><span class="MJXp-mo" id="MJXp-Span-858">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-859">4</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-860" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-127"> \sum_{i = -cnt_0}^{n - cnt_0} {{n} \choose {i + cnt_0}} (\frac{i^2}{4} - \frac{(i \mod 2)}{4}) </script></center><p>At this point, you can throw convolution at the problem by precomputing the answer for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-861"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-862">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863">n</span><span class="MJXp-msubsup" id="MJXp-Span-864"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-865" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-866" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-867" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-868">0</span><span class="MJXp-mo" id="MJXp-Span-869" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-870">1</span><span class="MJXp-mo" id="MJXp-Span-871" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-872" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-873" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">n</span></span></span><script type="math/tex" id="MathJax-Element-128">cnt_0 = 0, 1, \ldots, n</script> and solve it in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-875"><span class="MJXp-mrow" id="MJXp-Span-876"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-877">O</span></span><span class="MJXp-mo" id="MJXp-Span-878" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-879">n</span><span class="MJXp-mi" id="MJXp-Span-880">log</span><span class="MJXp-mo" id="MJXp-Span-881" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">n</span><span class="MJXp-mo" id="MJXp-Span-883" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884">q</span><span class="MJXp-mo" id="MJXp-Span-885" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-129">\mathcal{O}(n \log n + q)</script>.</p><p>Submission: <a href="https://codeforces.com/contest/2077/submission/310298025" title="Submission 310298025 by omsincoconut">310298025</a></p><p>Alternatively, you can do more algebra to arrive at a closed-form expression.</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-886"><span class="MJXp-msubsup" id="MJXp-Span-887"><span class="MJXp-mn" id="MJXp-Span-888" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-889" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">n</span><span class="MJXp-mo" id="MJXp-Span-891">−</span><span class="MJXp-mn" id="MJXp-Span-892">4</span></span></span><span class="MJXp-mo" id="MJXp-Span-893" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">n</span><span class="MJXp-mo" id="MJXp-Span-895" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896">n</span><span class="MJXp-mo" id="MJXp-Span-897" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-898">1</span><span class="MJXp-mo" id="MJXp-Span-899" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-900" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-901">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-902">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903">n</span><span class="MJXp-msubsup" id="MJXp-Span-904"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-905" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-906" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907">n</span><span class="MJXp-mo" id="MJXp-Span-908" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-909">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911">n</span><span class="MJXp-msubsup" id="MJXp-Span-912"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-913" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-915">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-914">0</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-916" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-917">2</span><span class="MJXp-mo" id="MJXp-Span-918" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-130"> 2^{n-4}(n(n+1) - 4cnt_0n + 4cnt_0^2 - 2) </script></center> <div class="spoiler"><b class="spoiler-title">Proof</b><div class="spoiler-content" style="display: block;"><p>Consider</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-919"><span class="MJXp-msubsup" id="MJXp-Span-920"><span class="MJXp-mo" id="MJXp-Span-921" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-931"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932">n</span><span class="MJXp-mo" id="MJXp-Span-933">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-934">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-935">n</span><span class="MJXp-msubsup" id="MJXp-Span-936"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-937" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-938" style="vertical-align: -0.4em;">0</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-922"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-923">i</span><span class="MJXp-mo" id="MJXp-Span-924">=</span><span class="MJXp-mo" id="MJXp-Span-925">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-927">n</span><span class="MJXp-msubsup" id="MJXp-Span-928"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-930" style="vertical-align: -0.4em;">0</span></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-939"><span class="MJXp-mrow" id="MJXp-Span-940"><span class="MJXp-TeXmathchoice" id="MJXp-Span-941"><span class="MJXp-mstyle" id="MJXp-Span-942"><span class="MJXp-mrow" id="MJXp-Span-943"><span class="MJXp-mo" id="MJXp-Span-944" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-945"><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-946"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-947">n</span></span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-948"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-949">i</span><span class="MJXp-mo" id="MJXp-Span-950">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-951">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">n</span><span class="MJXp-msubsup" id="MJXp-Span-953"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-954" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-955" style="vertical-align: -0.4em;">0</span></span></span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-956"><span class="MJXp-mstyle" id="MJXp-Span-957"><span class="MJXp-mrow" id="MJXp-Span-958"><span class="MJXp-mo" id="MJXp-Span-959" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-960"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-962" style="vertical-align: 0.5em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-131">\sum_{i = -cnt_0}^{n - cnt_0} {{n} \choose {i + cnt_0}} i^2</script></p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-963"><span class="MJXp-mo" id="MJXp-Span-964" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-965"><span class="MJXp-mo" id="MJXp-Span-966" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-971"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-967"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">i</span><span class="MJXp-mo" id="MJXp-Span-969">=</span><span class="MJXp-mn" id="MJXp-Span-970">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-973"><span class="MJXp-mrow" id="MJXp-Span-974"><span class="MJXp-TeXmathchoice" id="MJXp-Span-975"><span class="MJXp-mstyle" id="MJXp-Span-976"><span class="MJXp-mrow" id="MJXp-Span-977"><span class="MJXp-mo" id="MJXp-Span-978" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-979"><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-980"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-981">n</span></span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-982"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983">i</span></span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-984"><span class="MJXp-mstyle" id="MJXp-Span-985"><span class="MJXp-mrow" id="MJXp-Span-986"><span class="MJXp-mo" id="MJXp-Span-987" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-988" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-989">i</span><span class="MJXp-mo" id="MJXp-Span-990" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-991">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-992">n</span><span class="MJXp-msubsup" id="MJXp-Span-993"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-995" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-msubsup" id="MJXp-Span-996"><span class="MJXp-mo" id="MJXp-Span-997" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-998" style="vertical-align: 0.5em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-132">= \sum_{i = 0}^{n} {{n} \choose {i}} (i-cnt_0)^2</script></p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-999"><span class="MJXp-mo" id="MJXp-Span-1000" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1001"><span class="MJXp-mo" id="MJXp-Span-1002" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1007"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1008">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1003"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1004">i</span><span class="MJXp-mo" id="MJXp-Span-1005">=</span><span class="MJXp-mn" id="MJXp-Span-1006">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1009"><span class="MJXp-mrow" id="MJXp-Span-1010"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1011"><span class="MJXp-mstyle" id="MJXp-Span-1012"><span class="MJXp-mrow" id="MJXp-Span-1013"><span class="MJXp-mo" id="MJXp-Span-1014" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1015"><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1016"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">n</span></span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1018"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019">i</span></span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1020"><span class="MJXp-mstyle" id="MJXp-Span-1021"><span class="MJXp-mrow" id="MJXp-Span-1022"><span class="MJXp-mo" id="MJXp-Span-1023" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1024"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1025" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1026" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1027" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1028">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">n</span><span class="MJXp-msubsup" id="MJXp-Span-1031"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1033" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-msubsup" id="MJXp-Span-1034"><span class="MJXp-mo" id="MJXp-Span-1035" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1040"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1036"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037">i</span><span class="MJXp-mo" id="MJXp-Span-1038">=</span><span class="MJXp-mn" id="MJXp-Span-1039">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1042"><span class="MJXp-mrow" id="MJXp-Span-1043"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1044"><span class="MJXp-mstyle" id="MJXp-Span-1045"><span class="MJXp-mrow" id="MJXp-Span-1046"><span class="MJXp-mo" id="MJXp-Span-1047" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1048"><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1049"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1050">n</span></span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1051"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1052">i</span></span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1053"><span class="MJXp-mstyle" id="MJXp-Span-1054"><span class="MJXp-mrow" id="MJXp-Span-1055"><span class="MJXp-mo" id="MJXp-Span-1056" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057">i</span><span class="MJXp-mo" id="MJXp-Span-1058" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1059">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1060">n</span><span class="MJXp-msubsup" id="MJXp-Span-1061"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1062" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-1064">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1063">0</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1065"><span class="MJXp-mo" id="MJXp-Span-1066" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1071"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1072">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1067"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1068">i</span><span class="MJXp-mo" id="MJXp-Span-1069">=</span><span class="MJXp-mn" id="MJXp-Span-1070">0</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1073"><span class="MJXp-mrow" id="MJXp-Span-1074"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1075"><span class="MJXp-mstyle" id="MJXp-Span-1076"><span class="MJXp-mrow" id="MJXp-Span-1077"><span class="MJXp-mo" id="MJXp-Span-1078" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1079"><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1080"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081">n</span></span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1082"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1083">i</span></span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1084"><span class="MJXp-mstyle" id="MJXp-Span-1085"><span class="MJXp-mrow" id="MJXp-Span-1086"><span class="MJXp-mo" id="MJXp-Span-1087" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span></span></span><span class="MJXp-mn" id="MJXp-Span-1088">1</span></span></span><script type="math/tex" id="MathJax-Element-133">= \sum_{i = 0}^{n} {{n} \choose {i}} i^2 - 2cnt_0 \sum_{i = 0}^{n} {{n} \choose {i}} i + cnt_0^2 \sum_{i = 0}^{n} {{n} \choose {i}} 1</script></p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1089"><span class="MJXp-mo" id="MJXp-Span-1090" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091">n</span><span class="MJXp-mo" id="MJXp-Span-1092" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1093">n</span><span class="MJXp-mo" id="MJXp-Span-1094" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1095">1</span><span class="MJXp-mo" id="MJXp-Span-1096" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1097" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1098"><span class="MJXp-mn" id="MJXp-Span-1099" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1100" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1101">n</span><span class="MJXp-mo" id="MJXp-Span-1102">−</span><span class="MJXp-mn" id="MJXp-Span-1103">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-1104" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1105">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1107">n</span><span class="MJXp-msubsup" id="MJXp-Span-1108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1109" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1110" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1111">n</span><span class="MJXp-mo" id="MJXp-Span-1112" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1113"><span class="MJXp-mn" id="MJXp-Span-1114" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1115" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1116">n</span><span class="MJXp-mo" id="MJXp-Span-1117">−</span><span class="MJXp-mn" id="MJXp-Span-1118">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1119" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121">n</span><span class="MJXp-msubsup" id="MJXp-Span-1122"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1123" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-1125">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1124">0</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1126" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1127"><span class="MJXp-mn" id="MJXp-Span-1128" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1129" style="vertical-align: 0.5em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-134">= n(n+1) \cdot 2^{n-2} - 2cnt_0 n \cdot 2^{n-1} + cnt_0^2 \cdot 2^n</script></p><p>And</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1130"><span class="MJXp-msubsup" id="MJXp-Span-1131"><span class="MJXp-mo" id="MJXp-Span-1132" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1143">n</span><span class="MJXp-mo" id="MJXp-Span-1144">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146">n</span><span class="MJXp-msubsup" id="MJXp-Span-1147"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1148" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1149" style="vertical-align: -0.4em;">0</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134">i</span><span class="MJXp-mo" id="MJXp-Span-1135">=</span><span class="MJXp-mo" id="MJXp-Span-1136">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1137">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138">n</span><span class="MJXp-msubsup" id="MJXp-Span-1139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1141" style="vertical-align: -0.4em;">0</span></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1150"><span class="MJXp-mrow" id="MJXp-Span-1151"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1152"><span class="MJXp-mstyle" id="MJXp-Span-1153"><span class="MJXp-mrow" id="MJXp-Span-1154"><span class="MJXp-mo" id="MJXp-Span-1155" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1156"><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1157"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158">n</span></span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1159"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160">i</span><span class="MJXp-mo" id="MJXp-Span-1161">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163">n</span><span class="MJXp-msubsup" id="MJXp-Span-1164"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1166" style="vertical-align: -0.4em;">0</span></span></span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1167"><span class="MJXp-mstyle" id="MJXp-Span-1168"><span class="MJXp-mrow" id="MJXp-Span-1169"><span class="MJXp-mo" id="MJXp-Span-1170" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1171" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1172">i</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1173"><span class="MJXp-mspace" id="MJXp-Span-1174" style="width: 0.667em; height: 0em;"></span></span><span class="MJXp-mi" id="MJXp-Span-1175">mod</span><span class="MJXp-mspace" id="MJXp-Span-1176" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1177" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-1178">2</span><span class="MJXp-mo" id="MJXp-Span-1179" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1180" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1181"><span class="MJXp-mn" id="MJXp-Span-1182" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1183" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184">n</span><span class="MJXp-mo" id="MJXp-Span-1185">−</span><span class="MJXp-mn" id="MJXp-Span-1186">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-135">\sum_{i = -cnt_0}^{n - cnt_0} {{n} \choose {i + cnt_0}} (i \mod 2) = 2^{n-1}</script></p><p>So</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1187"><span class="MJXp-mfrac" id="MJXp-Span-1188" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1189">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1190">4</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1191"><span class="MJXp-mo" id="MJXp-Span-1192" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.59em;"><span class="MJXp-mrow" id="MJXp-Span-1202"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203">n</span><span class="MJXp-mo" id="MJXp-Span-1204">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1205">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1206">n</span><span class="MJXp-msubsup" id="MJXp-Span-1207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1208" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1209" style="vertical-align: -0.4em;">0</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1193"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194">i</span><span class="MJXp-mo" id="MJXp-Span-1195">=</span><span class="MJXp-mo" id="MJXp-Span-1196">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1198">n</span><span class="MJXp-msubsup" id="MJXp-Span-1199"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1201" style="vertical-align: -0.4em;">0</span></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1210"><span class="MJXp-mrow" id="MJXp-Span-1211"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1212"><span class="MJXp-mstyle" id="MJXp-Span-1213"><span class="MJXp-mrow" id="MJXp-Span-1214"><span class="MJXp-mo" id="MJXp-Span-1215" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1216"><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1217"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1218">n</span></span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1220">i</span><span class="MJXp-mo" id="MJXp-Span-1221">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1222">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1223">n</span><span class="MJXp-msubsup" id="MJXp-Span-1224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1225" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1226" style="vertical-align: -0.4em;">0</span></span></span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1227"><span class="MJXp-mstyle" id="MJXp-Span-1228"><span class="MJXp-mrow" id="MJXp-Span-1229"><span class="MJXp-mo" id="MJXp-Span-1230" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1231"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1233" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1234" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1235" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236">i</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1237"><span class="MJXp-mspace" id="MJXp-Span-1238" style="width: 0.667em; height: 0em;"></span></span><span class="MJXp-mi" id="MJXp-Span-1239">mod</span><span class="MJXp-mspace" id="MJXp-Span-1240" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1241" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-1242">2</span><span class="MJXp-mo" id="MJXp-Span-1243" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-136">\frac{1}{4} \sum_{i = -cnt_0}^{n - cnt_0} {{n} \choose {i + cnt_0}} i^2 + (i \mod 2)</script></p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1244"><span class="MJXp-mo" id="MJXp-Span-1245" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1246" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1247">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1248">4</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1249" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1250">n</span><span class="MJXp-mo" id="MJXp-Span-1251" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">n</span><span class="MJXp-mo" id="MJXp-Span-1253" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1254">1</span><span class="MJXp-mo" id="MJXp-Span-1255" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1256" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1257"><span class="MJXp-mn" id="MJXp-Span-1258" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1259" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260">n</span><span class="MJXp-mo" id="MJXp-Span-1261">−</span><span class="MJXp-mn" id="MJXp-Span-1262">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-1263" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1264">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1266">n</span><span class="MJXp-msubsup" id="MJXp-Span-1267"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1268" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1269" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">n</span><span class="MJXp-mo" id="MJXp-Span-1271" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1272"><span class="MJXp-mn" id="MJXp-Span-1273" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1274" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">n</span><span class="MJXp-mo" id="MJXp-Span-1276">−</span><span class="MJXp-mn" id="MJXp-Span-1277">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1278" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1280">n</span><span class="MJXp-msubsup" id="MJXp-Span-1281"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-1284">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1283">0</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1285" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-1286"><span class="MJXp-mn" id="MJXp-Span-1287" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1288" style="vertical-align: 0.5em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1289" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1290"><span class="MJXp-mn" id="MJXp-Span-1291" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1292" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1293">n</span><span class="MJXp-mo" id="MJXp-Span-1294">−</span><span class="MJXp-mn" id="MJXp-Span-1295">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1296" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-137">= \frac{1}{4} (n(n+1) \cdot 2^{n-2} - 2cnt_0 n \cdot 2^{n-1} + cnt_0^2 \cdot 2^n - 2^{n-1})</script> </p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1297"><span class="MJXp-mo" id="MJXp-Span-1298" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1299"><span class="MJXp-mn" id="MJXp-Span-1300" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1301" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302">n</span><span class="MJXp-mo" id="MJXp-Span-1303">−</span><span class="MJXp-mn" id="MJXp-Span-1304">4</span></span></span><span class="MJXp-mo" id="MJXp-Span-1305" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1306">n</span><span class="MJXp-mo" id="MJXp-Span-1307" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1308">n</span><span class="MJXp-mo" id="MJXp-Span-1309" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1310">1</span><span class="MJXp-mo" id="MJXp-Span-1311" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1312" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1313">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1314">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1315">n</span><span class="MJXp-msubsup" id="MJXp-Span-1316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1317" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1318" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1319">n</span><span class="MJXp-mo" id="MJXp-Span-1320" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1321">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1323">n</span><span class="MJXp-msubsup" id="MJXp-Span-1324"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1325" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-1327">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1326">0</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1328" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1329">2</span><span class="MJXp-mo" id="MJXp-Span-1330" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-138">= 2^{n-4}(n(n+1) - 4cnt_0n + 4cnt_0^2 - 2)</script></p></div></div><p>Time complexity: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1331"><span class="MJXp-mrow" id="MJXp-Span-1332"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1333">O</span></span><span class="MJXp-mo" id="MJXp-Span-1334" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335">n</span><span class="MJXp-mo" id="MJXp-Span-1336" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1337">q</span><span class="MJXp-mo" id="MJXp-Span-1338" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-139">\mathcal{O}(n+q)</script> per test case.</p><p>Submission: <a href="https://codeforces.com/contest/2077/submission/310297950" title="Submission 310297950 by omsincoconut">310297950</a></p></div></div><p><a href="https://codeforces.com/contest/2077/problem/D" title="Codeforces Round 1008 (Div. 1)">2077D - Maximum Polygon</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Find a way to get the answer if you fixed the largest value or the first value of the subsequence.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Sufficiently long (which is not that long) arrays will definitely be polygon side lengths.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Suppose we consider some integer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1339"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1340">x</span></span></span><script type="math/tex" id="MathJax-Element-140">x</script>, and we try to find the lexicographically largest subsequence (say <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1341"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342">s</span></span></span><script type="math/tex" id="MathJax-Element-141">s</script>) such that the maximum element of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1344">s</span></span></span><script type="math/tex" id="MathJax-Element-142">s</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1345"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1346">x</span></span></span><script type="math/tex" id="MathJax-Element-143">x</script>.</p><p>We can do it greedily.</p><p>For the subsequence <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1347"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1348">s</span></span></span><script type="math/tex" id="MathJax-Element-144">s</script> to be valid, we need to ensure that the sum of the elements of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1349"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1350">s</span></span></span><script type="math/tex" id="MathJax-Element-145">s</script> is greater than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1351"><span class="MJXp-mn" id="MJXp-Span-1352">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353">x</span></span></span><script type="math/tex" id="MathJax-Element-146">2x</script>.</p><p>So, our greedy strategy is like we have an empty vector <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1354"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1355">s</span></span></span><script type="math/tex" id="MathJax-Element-147">s</script>, and we iterate over the array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1356"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1357">a</span></span></span><script type="math/tex" id="MathJax-Element-148">a</script> from left to right, and for each element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1358"><span class="MJXp-msubsup" id="MJXp-Span-1359"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1360" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1361" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-149">a_i</script>, we do the following:</p><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1362"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1363">s</span></span></span><script type="math/tex" id="MathJax-Element-150">s</script> is not empty and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1364"><span class="MJXp-msubsup" id="MJXp-Span-1365"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1367" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-151">a_i</script> is greater than the last element of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1368"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1369">s</span></span></span><script type="math/tex" id="MathJax-Element-152">s</script>, we will check whether we can make the total sum of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1371">s</span></span></span><script type="math/tex" id="MathJax-Element-153">s</script> greater than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1372"><span class="MJXp-mn" id="MJXp-Span-1373">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1374">x</span></span></span><script type="math/tex" id="MathJax-Element-154">2x</script>, if we remove the last element of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1375"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1376">s</span></span></span><script type="math/tex" id="MathJax-Element-155">s</script>. Now what can be the maximum possible sum of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1377"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1378">s</span></span></span><script type="math/tex" id="MathJax-Element-156">s</script>? We can just append all the elements of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1379"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380">a</span></span></span><script type="math/tex" id="MathJax-Element-157">a</script> which are less than or equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1381"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1382">x</span></span></span><script type="math/tex" id="MathJax-Element-158">x</script>, and are present to the right of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1383"><span class="MJXp-msubsup" id="MJXp-Span-1384"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1386" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-159">a_i</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1387"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1388">s</span></span></span><script type="math/tex" id="MathJax-Element-160">s</script>.</p><p>Append <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1389"><span class="MJXp-msubsup" id="MJXp-Span-1390"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1391" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1392" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-161">a_i</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1393"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1394">s</span></span></span><script type="math/tex" id="MathJax-Element-162">s</script>.</p><p>Thus, we see that the subsequence <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1395"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1396">s</span></span></span><script type="math/tex" id="MathJax-Element-163">s</script> is the lexicographically largest subsequence such that the maximum element of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1397"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398">s</span></span></span><script type="math/tex" id="MathJax-Element-164">s</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1399"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1400">x</span></span></span><script type="math/tex" id="MathJax-Element-165">x</script>.</p><p>Now, we have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1402">O</span><span class="MJXp-mo" id="MJXp-Span-1403" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404">n</span><span class="MJXp-mo" id="MJXp-Span-1405" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-166">O(n)</script> candidates for the maximum element of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407">s</span></span></span><script type="math/tex" id="MathJax-Element-167">s</script>. We cannot find the best subsequence for each candidate, as it will be too slow.</p><p>Here comes the key observation.</p><p>Now, what can be the maximum possible size of a sorted vector <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1409">v</span></span></span><script type="math/tex" id="MathJax-Element-168">v</script> such that there does not exist any subsequence of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1410"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1411">v</span></span></span><script type="math/tex" id="MathJax-Element-169">v</script> which can form the sides of a valid polygon?</p><p>We should have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1412"><span class="MJXp-msubsup" id="MJXp-Span-1413"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414" style="margin-right: 0.05em;">v</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1415" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1416" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-1417"><span class="MJXp-mo" id="MJXp-Span-1418" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1423"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1424">i</span><span class="MJXp-mo" id="MJXp-Span-1425">−</span><span class="MJXp-mn" id="MJXp-Span-1426">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1419"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1420">j</span><span class="MJXp-mo" id="MJXp-Span-1421">=</span><span class="MJXp-mn" id="MJXp-Span-1422">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1427"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1428" style="margin-right: 0.05em;">v</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1429" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-170">v_i > \sum_{j=1}^{i-1} v_j</script>.</p><p>Now, to get the maximum possible size of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1430"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431">v</span></span></span><script type="math/tex" id="MathJax-Element-171">v</script>, we should have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1432"><span class="MJXp-msubsup" id="MJXp-Span-1433"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1434" style="margin-right: 0.05em;">v</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1435" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1436" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1437">1</span></span></span><script type="math/tex" id="MathJax-Element-172">v_1 = 1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1438"><span class="MJXp-msubsup" id="MJXp-Span-1439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1440" style="margin-right: 0.05em;">v</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1441" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1442" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1443"><span class="MJXp-mn" id="MJXp-Span-1444" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1445" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1446">i</span><span class="MJXp-mo" id="MJXp-Span-1447">−</span><span class="MJXp-mn" id="MJXp-Span-1448">2</span></span></span></span></span><script type="math/tex" id="MathJax-Element-173">v_i = 2^{i - 2}</script> for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1449"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1450">i</span><span class="MJXp-mo" id="MJXp-Span-1451" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-1452">2</span></span></span><script type="math/tex" id="MathJax-Element-174">i \geq 2</script>.</p><p>Thus, the maximum possible size of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1453"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1454">v</span></span></span><script type="math/tex" id="MathJax-Element-175">v</script> can be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1455"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1456">p</span><span class="MJXp-mo" id="MJXp-Span-1457" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1458"><span class="MJXp-mi" id="MJXp-Span-1459" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1460" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1461" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1462" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1463"><span class="MJXp-mn" id="MJXp-Span-1464" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1465" style="vertical-align: 0.5em;">9</span></span><span class="MJXp-mo" id="MJXp-Span-1466" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1467" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1468">2</span></span></span><script type="math/tex" id="MathJax-Element-176">p = \log_2(10^9) + 2</script>.</p><p>Our claim is that in the lexicographically largest subsequence <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1469"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1470">s</span></span></span><script type="math/tex" id="MathJax-Element-177">s</script>, the maximum element should be one of the largest <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1471"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1472">p</span><span class="MJXp-mo" id="MJXp-Span-1473" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1474">1</span></span></span><script type="math/tex" id="MathJax-Element-178">p + 1</script> elements of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1475"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1476">a</span></span></span><script type="math/tex" id="MathJax-Element-179">a</script>.</p><p>Suppose we do not have the maximum element of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1478">s</span></span></span><script type="math/tex" id="MathJax-Element-180">s</script> in the largest <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1479"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480">p</span><span class="MJXp-mo" id="MJXp-Span-1481" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1482">1</span></span></span><script type="math/tex" id="MathJax-Element-181">p + 1</script> elements of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1483"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1484">a</span></span></span><script type="math/tex" id="MathJax-Element-182">a</script>. Let's consider the multiset of the largest <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1485"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1486">p</span><span class="MJXp-mo" id="MJXp-Span-1487" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1488">1</span></span></span><script type="math/tex" id="MathJax-Element-183">p + 1</script> elements of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1489"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490">a</span></span></span><script type="math/tex" id="MathJax-Element-184">a</script>. As we saw above, there should be a subsequence (say <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1491"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1492">t</span></span></span><script type="math/tex" id="MathJax-Element-185">t</script>) of this multiset which forms the sides of a valid polygon. Now if we insert the elements of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1493"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1494">t</span></span></span><script type="math/tex" id="MathJax-Element-186">t</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1495"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1496">s</span></span></span><script type="math/tex" id="MathJax-Element-187">s</script>, we will get a subsequence <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1497"><span class="MJXp-msup" id="MJXp-Span-1498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1499" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1500" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-188">s'</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1501"><span class="MJXp-msup" id="MJXp-Span-1502"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1503" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1504" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-189">s'</script> is valid and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1505"><span class="MJXp-msup" id="MJXp-Span-1506"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1507" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1508" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-190">s'</script> is lexicographically larger than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1510">s</span></span></span><script type="math/tex" id="MathJax-Element-191">s</script>.</p><p>Thus, we cannot have a subsequence <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1511"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1512">s</span></span></span><script type="math/tex" id="MathJax-Element-192">s</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1513"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1514">s</span></span></span><script type="math/tex" id="MathJax-Element-193">s</script> is the largest possible subsequence and the maximum element of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1515"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1516">s</span></span></span><script type="math/tex" id="MathJax-Element-194">s</script> is not in the largest <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1517"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1518">p</span><span class="MJXp-mo" id="MJXp-Span-1519" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1520">1</span></span></span><script type="math/tex" id="MathJax-Element-195">p + 1</script> elements of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1521"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1522">a</span></span></span><script type="math/tex" id="MathJax-Element-196">a</script>.</p><p>Time complexity: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1523"><span class="MJXp-mrow" id="MJXp-Span-1524"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1525">O</span></span><span class="MJXp-mo" id="MJXp-Span-1526" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1527">n</span><span class="MJXp-mi" id="MJXp-Span-1528">log</span><span class="MJXp-mo" id="MJXp-Span-1529" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1530" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1531" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1532">a</span><span class="MJXp-mo" id="MJXp-Span-1533" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1534" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-197">\mathcal{O}(n \log \max(a))</script> per test case.</p><p>Submission: <a href="https://codeforces.com/contest/2077/submission/310298095" title="Submission 310298095 by omsincoconut">310298095</a></p></div></div><p><a href="https://codeforces.com/contest/2077/problem/E" title="Codeforces Round 1008 (Div. 1)">2077E - Another Folding Strip</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Folding is basically alternating the parity of the indices.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Maximum subarray sum.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>As mentioned in Hint 1, we can see that if the darkness of the cells <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1535"><span class="MJXp-msubsup" id="MJXp-Span-1536"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1538" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1539" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1540"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1541" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1542" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1543" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1544" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1545" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1546"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1547" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1548" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-198">i_1, i_2, \ldots, i_k</script> increases in some operation, the parity of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1549"><span class="MJXp-msubsup" id="MJXp-Span-1550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1551" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1552" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-199">i_j</script> should be different from that of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1553"><span class="MJXp-msubsup" id="MJXp-Span-1554"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1555" style="margin-right: 0.05em;">i</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1556" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1557">j</span><span class="MJXp-mo" id="MJXp-Span-1558">+</span><span class="MJXp-mn" id="MJXp-Span-1559">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-200">i_{j+1}</script> for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1560"><span class="MJXp-mn" id="MJXp-Span-1561">1</span><span class="MJXp-mo" id="MJXp-Span-1562" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1563">j</span><span class="MJXp-mo" id="MJXp-Span-1564" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1565">k</span><span class="MJXp-mo" id="MJXp-Span-1566" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1567">1</span></span></span><script type="math/tex" id="MathJax-Element-201">1 \le j \le k - 1</script></p> <div class="spoiler"><b class="spoiler-title">Diagram</b><div class="spoiler-content" style="display: block;"><p><img alt=" " src="https://codeforces.com/predownloaded/66/b8/66b8149d4bf66f3d60189d84e24c5e4a5dd8a87c.jpeg" style="max-width: 100.0%;max-height: 100.0%;"></p></div></div><p>Let us try to find <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1568"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1569">f</span><span class="MJXp-mo" id="MJXp-Span-1570" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1571">a</span><span class="MJXp-mo" id="MJXp-Span-1572" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1573">1</span><span class="MJXp-mo" id="MJXp-Span-1574" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575">n</span><span class="MJXp-mo" id="MJXp-Span-1576" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1577" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-202">f(a[1, n])</script>.</p><p>Consider an array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1578"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1579">b</span></span></span><script type="math/tex" id="MathJax-Element-203">b</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1580"><span class="MJXp-msubsup" id="MJXp-Span-1581"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1582" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1583" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1584" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1585" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1586" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1587">1</span><span class="MJXp-msubsup" id="MJXp-Span-1588"><span class="MJXp-mo" id="MJXp-Span-1589" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1590" style="vertical-align: 0.5em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-1591"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1592" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1593" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-204">b_i = (-1)^i a_i</script> for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1594"><span class="MJXp-mn" id="MJXp-Span-1595">1</span><span class="MJXp-mo" id="MJXp-Span-1596" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1597">i</span><span class="MJXp-mo" id="MJXp-Span-1598" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1599">n</span></span></span><script type="math/tex" id="MathJax-Element-205">1 \le i \le n</script>.</p><p>Let us perform exactly one operation, and say our subsequence of indices is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1600"><span class="MJXp-msubsup" id="MJXp-Span-1601"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1602" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1603" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1604" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1605"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1606" style="margin-right: 0.05em;">i</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1607" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1608" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1609" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1610" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1611"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1612" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1613" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-206">i_1, i_2, \ldots, i_k</script>.</p><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1614"><span class="MJXp-msup" id="MJXp-Span-1615"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1616" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1617" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-207">a'</script> be the updated array after performing the operation, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1618"><span class="MJXp-msubsup" id="MJXp-Span-1619"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1620" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-1622">′</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1621">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1623" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1624" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1625" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1626">1</span><span class="MJXp-msubsup" id="MJXp-Span-1627"><span class="MJXp-mo" id="MJXp-Span-1628" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1629" style="vertical-align: 0.5em;"><span class="MJXp-msup" id="MJXp-Span-1630"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631" style="margin-right: 0.05em;">i</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1632" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1633"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1634" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-1636">′</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1635">i</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-208">b'_i = (-1)^{i'} a'_i</script> for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1637"><span class="MJXp-mn" id="MJXp-Span-1638">1</span><span class="MJXp-mo" id="MJXp-Span-1639" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1640">i</span><span class="MJXp-mo" id="MJXp-Span-1641" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1642">n</span></span></span><script type="math/tex" id="MathJax-Element-209">1 \le i \le n</script>.</p><p>Now we can see that</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1643"><span class="MJXp-mrow" id="MJXp-Span-1644"><span class="MJXp-mo" id="MJXp-Span-1645" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.04em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1646"><span class="MJXp-mo" id="MJXp-Span-1647" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1652"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1653">r</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1648"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1649">i</span><span class="MJXp-mo" id="MJXp-Span-1650">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1651">l</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1654"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1655" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-1657">′</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1656">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1658" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1659"><span class="MJXp-mo" id="MJXp-Span-1660" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1665"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1666">r</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1661"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1662">i</span><span class="MJXp-mo" id="MJXp-Span-1663">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1664">l</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1667"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1668" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1669" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1670" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.04em;">|</span></span></span><span class="MJXp-mo" id="MJXp-Span-1671" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-1672">1</span><span class="MJXp-mo" id="MJXp-Span-1673" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span><script type="math/tex" id="MathJax-Element-210"> \left| \sum_{i = l}^{r} b'_i - \sum_{i = l}^{r} b_i \right| \le 1, </script></center><p>for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1674"><span class="MJXp-mn" id="MJXp-Span-1675">1</span><span class="MJXp-mo" id="MJXp-Span-1676" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1677">l</span><span class="MJXp-mo" id="MJXp-Span-1678" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1679">r</span><span class="MJXp-mo" id="MJXp-Span-1680" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1681">n</span></span></span><script type="math/tex" id="MathJax-Element-211">1 \le l \le r \le n</script>.</p><p>This is so because for any subarray <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1682"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1683">b</span><span class="MJXp-mo" id="MJXp-Span-1684" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1685">l</span><span class="MJXp-mo" id="MJXp-Span-1686" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1687">r</span><span class="MJXp-mo" id="MJXp-Span-1688" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-212">b[l, r]</script>, if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1689"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1690">x</span></span></span><script type="math/tex" id="MathJax-Element-213">x</script> elements at odd indices and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1691"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1692">y</span></span></span><script type="math/tex" id="MathJax-Element-214">y</script> elements at even indices were selected, we should have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1693"><span class="MJXp-mrow" id="MJXp-Span-1694"><span class="MJXp-mo" id="MJXp-Span-1695" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696">x</span><span class="MJXp-mo" id="MJXp-Span-1697" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1698">y</span><span class="MJXp-mrow" id="MJXp-Span-1699"><span class="MJXp-mo" id="MJXp-Span-1700" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1701" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-1702">1</span></span></span><script type="math/tex" id="MathJax-Element-215">|x - y| \le 1</script>.</p><p>So, we can see that after any operation, the absolute sum of any subarray of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1703"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1704">b</span></span></span><script type="math/tex" id="MathJax-Element-216">b</script> decreases by at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1705"><span class="MJXp-mn" id="MJXp-Span-1706">1</span></span></span><script type="math/tex" id="MathJax-Element-217">1</script>.</p><p>Thus, this gives us a lower bound for the value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1707"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1708">f</span><span class="MJXp-mo" id="MJXp-Span-1709" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1710">a</span><span class="MJXp-mo" id="MJXp-Span-1711" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1712">1</span><span class="MJXp-mo" id="MJXp-Span-1713" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1714">n</span><span class="MJXp-mo" id="MJXp-Span-1715" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1716" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-218">f(a[1, n])</script>, which is</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1717"><span class="MJXp-msubsup" id="MJXp-Span-1718"><span class="MJXp-mo" id="MJXp-Span-1719" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1720" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-1721">1</span><span class="MJXp-mo" id="MJXp-Span-1722">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1723">l</span><span class="MJXp-mo" id="MJXp-Span-1724">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1725">r</span><span class="MJXp-mo" id="MJXp-Span-1726">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727">n</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1728"><span class="MJXp-mo" id="MJXp-Span-1729" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.04em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1730"><span class="MJXp-mo" id="MJXp-Span-1731" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1736"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1737">r</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1732"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1733">i</span><span class="MJXp-mo" id="MJXp-Span-1734">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1735">l</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1738"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1739" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1740" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1741" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.04em;">|</span></span></span><span class="MJXp-mo" id="MJXp-Span-1742" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><script type="math/tex" id="MathJax-Element-219"> \max_{1 \le l \le r \le n} \left| \sum_{i = l}^{r} b_i \right|. </script></center><p>Now let us consider the following greedy algorithm for selecting a subsequence <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1743"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1744">s</span></span></span><script type="math/tex" id="MathJax-Element-220">s</script> of indices:</p> <ul>   <li>Start from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1745"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1746">i</span><span class="MJXp-mo" id="MJXp-Span-1747" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1748">1</span></span></span><script type="math/tex" id="MathJax-Element-221">i = 1</script> and move to the right.</li>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1749"><span class="MJXp-msubsup" id="MJXp-Span-1750"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1751" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1752" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-222">b_i</script> is zero, we continue.</li>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1753"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1754">s</span></span></span><script type="math/tex" id="MathJax-Element-223">s</script> is empty, we append <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1755"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1756">i</span></span></span><script type="math/tex" id="MathJax-Element-224">i</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1757"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1758">s</span></span></span><script type="math/tex" id="MathJax-Element-225">s</script>, and continue.</li>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1759"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1760">i</span></span></span><script type="math/tex" id="MathJax-Element-226">i</script> does not have the same parity as the last element of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1761"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1762">s</span></span></span><script type="math/tex" id="MathJax-Element-227">s</script>, we append <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1763"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1764">i</span></span></span><script type="math/tex" id="MathJax-Element-228">i</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1765"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1766">s</span></span></span><script type="math/tex" id="MathJax-Element-229">s</script>, and continue.</li>   <li>Otherwise, we continue.</li> </ul><p>Now suppose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1767"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1768">T</span></span></span><script type="math/tex" id="MathJax-Element-230">T</script> is the set of pairs of indices <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1769"><span class="MJXp-mo" id="MJXp-Span-1770" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1771">l</span><span class="MJXp-mo" id="MJXp-Span-1772" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1773">r</span><span class="MJXp-mo" id="MJXp-Span-1774" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-231">(l, r)</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1775"><span class="MJXp-msubsup" id="MJXp-Span-1776"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1777" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1778" style="vertical-align: -0.4em;">l</span></span></span></span><script type="math/tex" id="MathJax-Element-232">b_l</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1779"><span class="MJXp-msubsup" id="MJXp-Span-1780"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1781" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1782" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-233">b_r</script> are nonzero and</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1783"><span class="MJXp-mrow" id="MJXp-Span-1784"><span class="MJXp-mo" id="MJXp-Span-1785" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.04em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1786"><span class="MJXp-mo" id="MJXp-Span-1787" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1792"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1793">r</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1788"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1789">i</span><span class="MJXp-mo" id="MJXp-Span-1790">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1791">l</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1794"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1795" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1796" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1797" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.04em;">|</span></span></span></span></span><script type="math/tex" id="MathJax-Element-234"> \left| \sum_{i = l}^{r} b_i \right| </script></center><p>is maximized.</p><p>We can prove that the absolute sum of all subarrays in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1799">T</span></span></span><script type="math/tex" id="MathJax-Element-235">T</script> would be reduced by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1800"><span class="MJXp-mn" id="MJXp-Span-1801">1</span></span></span><script type="math/tex" id="MathJax-Element-236">1</script> after performing the operation.</p><p>We can notice that if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1802"><span class="MJXp-mo" id="MJXp-Span-1803" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1804">l</span><span class="MJXp-mo" id="MJXp-Span-1805" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1806">r</span><span class="MJXp-mo" id="MJXp-Span-1807" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1808" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1809">T</span></span></span><script type="math/tex" id="MathJax-Element-237">(l, r) \in T</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1810"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1811">l</span></span></span><script type="math/tex" id="MathJax-Element-238">l</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1812"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1813">r</span></span></span><script type="math/tex" id="MathJax-Element-239">r</script> should have the same parity. Otherwise,</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1814"><span class="MJXp-mo" id="MJXp-Span-1815" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mrow" id="MJXp-Span-1816"><span class="MJXp-mo" id="MJXp-Span-1817" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1818"><span class="MJXp-mo" id="MJXp-Span-1819" style="margin-left: 0em; margin-right: 0em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1820">b</span><span class="MJXp-mo" id="MJXp-Span-1821" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1822">l</span><span class="MJXp-mo" id="MJXp-Span-1823" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1824">1</span><span class="MJXp-mo" id="MJXp-Span-1825" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1826">r</span><span class="MJXp-mo" id="MJXp-Span-1827" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1828" style="margin-left: 0em; margin-right: 0em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1829" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-1830"><span class="MJXp-mo" id="MJXp-Span-1831" style="margin-left: 0em; margin-right: 0em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1832">b</span><span class="MJXp-mo" id="MJXp-Span-1833" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1834">l</span><span class="MJXp-mo" id="MJXp-Span-1835" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1836">r</span><span class="MJXp-mo" id="MJXp-Span-1837" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1838">1</span><span class="MJXp-mo" id="MJXp-Span-1839" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1840" style="margin-left: 0em; margin-right: 0em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1841" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-1842" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mrow" id="MJXp-Span-1843"><span class="MJXp-mo" id="MJXp-Span-1844" style="margin-left: 0em; margin-right: 0em;">|</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1845">b</span><span class="MJXp-mo" id="MJXp-Span-1846" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1847">l</span><span class="MJXp-mo" id="MJXp-Span-1848" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1849">r</span><span class="MJXp-mo" id="MJXp-Span-1850" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1851" style="margin-left: 0em; margin-right: 0em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1852" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><script type="math/tex" id="MathJax-Element-240"> \max \left( \left| b[l + 1, r] \right|, \left| b[l, r - 1] \right| \right) > \left| b[l, r] \right|. </script></center><p>Next, we claim that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1853"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1854">l</span></span></span><script type="math/tex" id="MathJax-Element-241">l</script> should be in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1855"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1856">s</span></span></span><script type="math/tex" id="MathJax-Element-242">s</script>.</p><p>Suppose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1857"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1858">l</span></span></span><script type="math/tex" id="MathJax-Element-243">l</script> is not in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1859"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1860">s</span></span></span><script type="math/tex" id="MathJax-Element-244">s</script>. This means that there should be an index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1861"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1862">k</span></span></span><script type="math/tex" id="MathJax-Element-245">k</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1863"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1864">s</span></span></span><script type="math/tex" id="MathJax-Element-246">s</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1865"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1866">k</span></span></span><script type="math/tex" id="MathJax-Element-247">k</script> has the same parity as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1867"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1868">l</span></span></span><script type="math/tex" id="MathJax-Element-248">l</script> and there are no nonzero elements between <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1869"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1870">k</span></span></span><script type="math/tex" id="MathJax-Element-249">k</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1871"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1872">l</span></span></span><script type="math/tex" id="MathJax-Element-250">l</script> that have a parity different from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1873"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1874">l</span></span></span><script type="math/tex" id="MathJax-Element-251">l</script>.</p><p>Now if that is the case, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1875"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1876">b</span><span class="MJXp-mo" id="MJXp-Span-1877" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1878">k</span><span class="MJXp-mo" id="MJXp-Span-1879" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1880">r</span><span class="MJXp-mo" id="MJXp-Span-1881" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-252">b[k, r]</script> would have a greater absolute sum than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1882"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1883">b</span><span class="MJXp-mo" id="MJXp-Span-1884" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1885">l</span><span class="MJXp-mo" id="MJXp-Span-1886" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1887">r</span><span class="MJXp-mo" id="MJXp-Span-1888" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-253">b[l, r]</script>.</p><p>Thus, we conclude that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1889"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1890">l</span></span></span><script type="math/tex" id="MathJax-Element-254">l</script> will always be in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1891"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1892">s</span></span></span><script type="math/tex" id="MathJax-Element-255">s</script>.</p><p>Now let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1893"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1894">d</span></span></span><script type="math/tex" id="MathJax-Element-256">d</script> be the largest index in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1895"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1896">s</span></span></span><script type="math/tex" id="MathJax-Element-257">s</script> smaller than or equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1897"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1898">r</span></span></span><script type="math/tex" id="MathJax-Element-258">r</script>.</p><p>First of all, we should have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1899"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1900">d</span><span class="MJXp-mo" id="MJXp-Span-1901" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1902">l</span></span></span><script type="math/tex" id="MathJax-Element-259">d \ge l</script>.</p><p>Now <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1903"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1904">d</span></span></span><script type="math/tex" id="MathJax-Element-260">d</script> should have the same parity as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1905"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1906">r</span></span></span><script type="math/tex" id="MathJax-Element-261">r</script>.</p><p>This is so because if that is not the case, we should have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1907"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1908">d</span><span class="MJXp-mo" id="MJXp-Span-1909" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1910">r</span></span></span><script type="math/tex" id="MathJax-Element-262">d < r</script> and we would have selected <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1911"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1912">r</span></span></span><script type="math/tex" id="MathJax-Element-263">r</script> or any other element having the same parity as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1913"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1914">r</span></span></span><script type="math/tex" id="MathJax-Element-264">r</script> after <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1915"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1916">d</span></span></span><script type="math/tex" id="MathJax-Element-265">d</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1917"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1918">s</span></span></span><script type="math/tex" id="MathJax-Element-266">s</script>.</p><p>Thus, we can see that for all the pairs <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1919"><span class="MJXp-mo" id="MJXp-Span-1920" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1921">l</span><span class="MJXp-mo" id="MJXp-Span-1922" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1923">r</span><span class="MJXp-mo" id="MJXp-Span-1924" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1925" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1926">T</span></span></span><script type="math/tex" id="MathJax-Element-267">(l, r) \in T</script>, we should have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1928">l</span></span></span><script type="math/tex" id="MathJax-Element-268">l</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1929"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1930">s</span></span></span><script type="math/tex" id="MathJax-Element-269">s</script> and the largest element smaller than or equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1931"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1932">r</span></span></span><script type="math/tex" id="MathJax-Element-270">r</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1933"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1934">s</span></span></span><script type="math/tex" id="MathJax-Element-271">s</script> should have the same parity as that of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1935"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1936">r</span></span></span><script type="math/tex" id="MathJax-Element-272">r</script>. This implies that the absolute sum of all subarrays in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1937"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1938">T</span></span></span><script type="math/tex" id="MathJax-Element-273">T</script> would be reduced by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1939"><span class="MJXp-mn" id="MJXp-Span-1940">1</span></span></span><script type="math/tex" id="MathJax-Element-274">1</script> after performing the operation.</p><p>This is because if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1941"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1942">l</span></span></span><script type="math/tex" id="MathJax-Element-275">l</script> is odd, we would have added <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1943"><span class="MJXp-mn" id="MJXp-Span-1944">1</span><span class="MJXp-mo" id="MJXp-Span-1945" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1946" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1947">1</span><span class="MJXp-mo" id="MJXp-Span-1948" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1949">1</span><span class="MJXp-mo" id="MJXp-Span-1950" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1951" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1952">1</span><span class="MJXp-mo" id="MJXp-Span-1953" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1954" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1955" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1956">1</span></span></span><script type="math/tex" id="MathJax-Element-276">1, -1, 1, -1, \ldots, 1</script> to the subarray <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1957"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1958">b</span><span class="MJXp-mo" id="MJXp-Span-1959" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1960">l</span><span class="MJXp-mo" id="MJXp-Span-1961" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1962">r</span><span class="MJXp-mo" id="MJXp-Span-1963" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-277">b[l, r]</script>, increasing the subarray sum of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1964"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1965">b</span><span class="MJXp-mo" id="MJXp-Span-1966" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1967">l</span><span class="MJXp-mo" id="MJXp-Span-1968" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1969">r</span><span class="MJXp-mo" id="MJXp-Span-1970" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-278">b[l, r]</script> by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1971"><span class="MJXp-mn" id="MJXp-Span-1972">1</span></span></span><script type="math/tex" id="MathJax-Element-279">1</script>.</p><p>And if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1973"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1974">l</span></span></span><script type="math/tex" id="MathJax-Element-280">l</script> is even, we would have added <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1975"><span class="MJXp-mo" id="MJXp-Span-1976" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1977">1</span><span class="MJXp-mo" id="MJXp-Span-1978" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1979">1</span><span class="MJXp-mo" id="MJXp-Span-1980" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1981" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1982">1</span><span class="MJXp-mo" id="MJXp-Span-1983" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1984">1</span><span class="MJXp-mo" id="MJXp-Span-1985" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1986" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1987" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1988" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1989">1</span></span></span><script type="math/tex" id="MathJax-Element-281">-1, 1, -1, 1, \ldots, -1</script> to the subarray <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1990"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1991">b</span><span class="MJXp-mo" id="MJXp-Span-1992" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1993">l</span><span class="MJXp-mo" id="MJXp-Span-1994" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1995">r</span><span class="MJXp-mo" id="MJXp-Span-1996" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-282">b[l, r]</script>, decreasing the subarray sum of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1997"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1998">b</span><span class="MJXp-mo" id="MJXp-Span-1999" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2000">l</span><span class="MJXp-mo" id="MJXp-Span-2001" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2002">r</span><span class="MJXp-mo" id="MJXp-Span-2003" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-283">b[l, r]</script> by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2004"><span class="MJXp-mn" id="MJXp-Span-2005">1</span></span></span><script type="math/tex" id="MathJax-Element-284">1</script>.</p><p>Now we can see that the greedy algorithm would achieve the lower bound.</p><p>So, the answer for the array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2006"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2007">a</span></span></span><script type="math/tex" id="MathJax-Element-285">a</script> is the maximum absolute sum over all subarrays of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2008"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2009">b</span></span></span><script type="math/tex" id="MathJax-Element-286">b</script>.</p><p>Let us consider an array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2010"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2011">c</span></span></span><script type="math/tex" id="MathJax-Element-287">c</script> such that</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2012"><span class="MJXp-msubsup" id="MJXp-Span-2013"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2014" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2015" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2016" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2017"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2018" style="margin-right: 0.05em;">c</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2019" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2020">i</span><span class="MJXp-mo" id="MJXp-Span-2021">−</span><span class="MJXp-mn" id="MJXp-Span-2022">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2023" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2024"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2025" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2026" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2027" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-2028" style="width: 1em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-2029">with&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-2030"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2031" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2032" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-2033" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2034">0.</span></span></span><script type="math/tex" id="MathJax-Element-288"> c_i = c_{i - 1} + b_i, \quad \text{with } c_0 = 0. </script></center><p>We can further notice that the maximum absolute sum over all subarrays of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2035"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2036">b</span></span></span><script type="math/tex" id="MathJax-Element-289">b</script> is equal to</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2037"><span class="MJXp-msubsup" id="MJXp-Span-2038"><span class="MJXp-mo" id="MJXp-Span-2039" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2040" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2041">1</span><span class="MJXp-mo" id="MJXp-Span-2042">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2043">i</span><span class="MJXp-mo" id="MJXp-Span-2044">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2045">n</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2046"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2047" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2048" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2049" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2050"><span class="MJXp-mo" id="MJXp-Span-2051" style="margin-left: 0.333em; margin-right: 0.05em;">min</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2052" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2053">1</span><span class="MJXp-mo" id="MJXp-Span-2054">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2055">i</span><span class="MJXp-mo" id="MJXp-Span-2056">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2057">n</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2058"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2059" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2060" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2061" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><script type="math/tex" id="MathJax-Element-290"> \max_{1 \le i \le n} c_i - \min_{1 \le i \le n} c_i. </script></center><p>Now we can see that</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2062"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2063">f</span><span class="MJXp-mo" id="MJXp-Span-2064" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2065">a</span><span class="MJXp-mo" id="MJXp-Span-2066" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2067">l</span><span class="MJXp-mo" id="MJXp-Span-2068" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2069">r</span><span class="MJXp-mo" id="MJXp-Span-2070" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-2071" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2072" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2073"><span class="MJXp-mo" id="MJXp-Span-2074" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2075" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2076">l</span><span class="MJXp-mo" id="MJXp-Span-2077">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2078">i</span><span class="MJXp-mo" id="MJXp-Span-2079">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2080">r</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2081"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2082" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2083" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2084" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2085"><span class="MJXp-mo" id="MJXp-Span-2086" style="margin-left: 0.333em; margin-right: 0.05em;">min</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2087" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2088">l</span><span class="MJXp-mo" id="MJXp-Span-2089">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2090">i</span><span class="MJXp-mo" id="MJXp-Span-2091">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2092">r</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2093"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2094" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2095" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2096" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><script type="math/tex" id="MathJax-Element-291"> f(a[l, r]) = \max_{l \le i \le r} c_i - \min_{l \le i \le r} c_i. </script></center><p>Thus,</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2097"><span class="MJXp-msubsup" id="MJXp-Span-2098"><span class="MJXp-mo" id="MJXp-Span-2099" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2105">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2100"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2101">l</span><span class="MJXp-mo" id="MJXp-Span-2102">=</span><span class="MJXp-mn" id="MJXp-Span-2103">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2106"><span class="MJXp-mo" id="MJXp-Span-2107" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2112"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2113">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2109">r</span><span class="MJXp-mo" id="MJXp-Span-2110">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2111">l</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2114">f</span><span class="MJXp-mo" id="MJXp-Span-2115" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2116">a</span><span class="MJXp-mo" id="MJXp-Span-2117" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2118">l</span><span class="MJXp-mo" id="MJXp-Span-2119" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2120">r</span><span class="MJXp-mo" id="MJXp-Span-2121" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-2122" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2123" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2124"><span class="MJXp-mo" id="MJXp-Span-2125" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2130"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2131">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2127">l</span><span class="MJXp-mo" id="MJXp-Span-2128">=</span><span class="MJXp-mn" id="MJXp-Span-2129">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2132"><span class="MJXp-mo" id="MJXp-Span-2133" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2138"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2139">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2134"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2135">r</span><span class="MJXp-mo" id="MJXp-Span-2136">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2137">l</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2140"><span class="MJXp-mo" id="MJXp-Span-2141" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2142" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2143">l</span><span class="MJXp-mo" id="MJXp-Span-2144">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2145">i</span><span class="MJXp-mo" id="MJXp-Span-2146">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2147">r</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2148"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2149" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2150" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2151" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2152"><span class="MJXp-mo" id="MJXp-Span-2153" style="margin-left: 0.333em; margin-right: 0.05em;">min</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2154" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2155">l</span><span class="MJXp-mo" id="MJXp-Span-2156">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2157">i</span><span class="MJXp-mo" id="MJXp-Span-2158">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2159">r</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2160"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2161" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2162" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2163" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><script type="math/tex" id="MathJax-Element-292"> \sum_{l = 1}^{n} \sum_{r = l}^{n} f(a[l, r]) = \sum_{l = 1}^{n} \sum_{r = l}^{n} \max_{l \le i \le r} c_i - \min_{l \le i \le r} c_i. </script></center><p>So,</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2164"><span class="MJXp-msubsup" id="MJXp-Span-2165"><span class="MJXp-mo" id="MJXp-Span-2166" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2172">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2167"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2168">l</span><span class="MJXp-mo" id="MJXp-Span-2169">=</span><span class="MJXp-mn" id="MJXp-Span-2170">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2173"><span class="MJXp-mo" id="MJXp-Span-2174" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2179"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2180">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2176">r</span><span class="MJXp-mo" id="MJXp-Span-2177">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2178">l</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2181">f</span><span class="MJXp-mo" id="MJXp-Span-2182" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2183">a</span><span class="MJXp-mo" id="MJXp-Span-2184" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2185">l</span><span class="MJXp-mo" id="MJXp-Span-2186" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2187">r</span><span class="MJXp-mo" id="MJXp-Span-2188" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-2189" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2190" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2191"><span class="MJXp-mo" id="MJXp-Span-2192" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2197"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2198">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2193"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2194">l</span><span class="MJXp-mo" id="MJXp-Span-2195">=</span><span class="MJXp-mn" id="MJXp-Span-2196">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2199"><span class="MJXp-mo" id="MJXp-Span-2200" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2205"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2206">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2201"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2202">r</span><span class="MJXp-mo" id="MJXp-Span-2203">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2204">l</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2207"><span class="MJXp-mo" id="MJXp-Span-2208" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2209" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2210">l</span><span class="MJXp-mo" id="MJXp-Span-2211">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2212">i</span><span class="MJXp-mo" id="MJXp-Span-2213">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2214">r</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2215"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2216" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2217" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2218" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2219"><span class="MJXp-mo" id="MJXp-Span-2220" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2225"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2226">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2221"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2222">l</span><span class="MJXp-mo" id="MJXp-Span-2223">=</span><span class="MJXp-mn" id="MJXp-Span-2224">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2227"><span class="MJXp-mo" id="MJXp-Span-2228" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2233"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2234">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2230">r</span><span class="MJXp-mo" id="MJXp-Span-2231">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2232">l</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2235"><span class="MJXp-mo" id="MJXp-Span-2236" style="margin-left: 0.333em; margin-right: 0.05em;">min</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2237" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2238">l</span><span class="MJXp-mo" id="MJXp-Span-2239">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2240">i</span><span class="MJXp-mo" id="MJXp-Span-2241">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2242">r</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2243"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2244" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2245" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2246" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><script type="math/tex" id="MathJax-Element-293"> \sum_{l = 1}^{n} \sum_{r = l}^{n} f(a[l, r]) = \sum_{l = 1}^{n} \sum_{r = l}^{n} \max_{l \le i \le r} c_i - \sum_{l = 1}^{n} \sum_{r = l}^{n} \min_{l \le i \le r} c_i. </script></center><p>Finding the value of</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2247"><span class="MJXp-msubsup" id="MJXp-Span-2248"><span class="MJXp-mo" id="MJXp-Span-2249" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2254"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2255">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2250"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2251">l</span><span class="MJXp-mo" id="MJXp-Span-2252">=</span><span class="MJXp-mn" id="MJXp-Span-2253">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2256"><span class="MJXp-mo" id="MJXp-Span-2257" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2262"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2263">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2258"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2259">r</span><span class="MJXp-mo" id="MJXp-Span-2260">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2261">l</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2264"><span class="MJXp-mo" id="MJXp-Span-2265" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2266" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2267">l</span><span class="MJXp-mo" id="MJXp-Span-2268">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2269">i</span><span class="MJXp-mo" id="MJXp-Span-2270">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2271">r</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2273" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2274" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-294"> \sum_{l = 1}^{n} \sum_{r = l}^{n} \max_{l \le i \le r} c_i </script></center><p>is a fairly standard exercise, which can be done using a stack in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2275"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2276">O</span><span class="MJXp-mo" id="MJXp-Span-2277" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2278">n</span><span class="MJXp-mo" id="MJXp-Span-2279" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-295">O(n)</script> time.</p><p>Submission: <a href="https://codeforces.com/contest/2077/submission/310317161" title="Submission 310317161 by satyam343">310317161</a></p></div></div><p><a href="https://codeforces.com/contest/2077/problem/F" title="Codeforces Round 1008 (Div. 1)">2077F - AND x OR</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Characterize the property of a good pair of arrays.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Think about the last operation that turns a good pair of arrays into the same array.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2280"><span class="MJXp-mo" id="MJXp-Span-2281" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2282">a</span><span class="MJXp-mo" id="MJXp-Span-2283" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2284">b</span><span class="MJXp-mo" id="MJXp-Span-2285" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-296">(a, b)</script> is a good pair only if at least one of these two conditions hold</p> <ul>   <li><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2286"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2287">a</span><span class="MJXp-mo" id="MJXp-Span-2288" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2289">b</span></span></span><script type="math/tex" id="MathJax-Element-297">a = b</script></p></li>   <li><p>There exist two distinct indices <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2290"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2291">i</span></span></span><script type="math/tex" id="MathJax-Element-298">i</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2292"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2293">j</span></span></span><script type="math/tex" id="MathJax-Element-299">j</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2294"><span class="MJXp-msubsup" id="MJXp-Span-2295"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2296" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2297" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-300">b_i</script> is a submask of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2298"><span class="MJXp-msubsup" id="MJXp-Span-2299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2300" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2301" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-301">b_j</script>.</p></li> </ul> <div class="spoiler"><b class="spoiler-title">Proof</b><div class="spoiler-content" style="display: block;"><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2302"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2303">a</span><span class="MJXp-mo" id="MJXp-Span-2304" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2305">b</span></span></span><script type="math/tex" id="MathJax-Element-302">a \neq b</script>, then you need to do at least one operation to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2307">a</span></span></span><script type="math/tex" id="MathJax-Element-303">a</script>. In the last operation, if you choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2308"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2309">i</span></span></span><script type="math/tex" id="MathJax-Element-304">i</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2310"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2311">j</span></span></span><script type="math/tex" id="MathJax-Element-305">j</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2312"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2313">x</span></span></span><script type="math/tex" id="MathJax-Element-306">x</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2314"><span class="MJXp-msubsup" id="MJXp-Span-2315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2316" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2317" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-307">a_i</script> is a submask of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2318"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2319">x</span></span></span><script type="math/tex" id="MathJax-Element-308">x</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2320"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2321">x</span></span></span><script type="math/tex" id="MathJax-Element-309">x</script> is a submask of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2322"><span class="MJXp-msubsup" id="MJXp-Span-2323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2324" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2325" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-310">a_j</script>. So in the final array, there must be at least one pair of submask and supermask.</p><p>Next, we will show that this is sufficient. For every index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2326"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2327">k</span></span></span><script type="math/tex" id="MathJax-Element-311">k</script> other than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2328"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2329">i</span></span></span><script type="math/tex" id="MathJax-Element-312">i</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2330"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2331">j</span></span></span><script type="math/tex" id="MathJax-Element-313">j</script>, you can do this.</p> <ul>   <li><p>Perform operation with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2332"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2333">k</span></span></span><script type="math/tex" id="MathJax-Element-314">k</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2334"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2335">i</span></span></span><script type="math/tex" id="MathJax-Element-315">i</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2336"><span class="MJXp-mn" id="MJXp-Span-2337">0</span></span></span><script type="math/tex" id="MathJax-Element-316">0</script></p></li>   <li><p>Perform operation with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2338"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2339">i</span></span></span><script type="math/tex" id="MathJax-Element-317">i</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2341">k</span></span></span><script type="math/tex" id="MathJax-Element-318">k</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2342"><span class="MJXp-msubsup" id="MJXp-Span-2343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2344" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2345" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-319">b_k</script></p></li> </ul><p>Then</p> <ul>   <li><p>Perform operation with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2347">i</span></span></span><script type="math/tex" id="MathJax-Element-320">i</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2348"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2349">j</span></span></span><script type="math/tex" id="MathJax-Element-321">j</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2350"><span class="MJXp-mn" id="MJXp-Span-2351">0</span></span></span><script type="math/tex" id="MathJax-Element-322">0</script></p></li>   <li><p>Perform operation with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2352"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2353">j</span></span></span><script type="math/tex" id="MathJax-Element-323">j</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2354"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2355">i</span></span></span><script type="math/tex" id="MathJax-Element-324">i</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2356"><span class="MJXp-mn" id="MJXp-Span-2357">0</span></span></span><script type="math/tex" id="MathJax-Element-325">0</script></p></li>   <li><p>Perform operation with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2358"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2359">j</span></span></span><script type="math/tex" id="MathJax-Element-326">j</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2361">i</span></span></span><script type="math/tex" id="MathJax-Element-327">i</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2362"><span class="MJXp-msubsup" id="MJXp-Span-2363"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2364" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2365" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-328">b_i</script></p></li>   <li><p>Perform operation with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2366"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2367">i</span></span></span><script type="math/tex" id="MathJax-Element-329">i</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2368"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2369">j</span></span></span><script type="math/tex" id="MathJax-Element-330">j</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2370"><span class="MJXp-msubsup" id="MJXp-Span-2371"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2372" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2373" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-331">b_j</script></p></li> </ul></div></div><p>We need to check the two cases.</p><p>In the first case, the minimum cost will be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2374"><span class="MJXp-msubsup" id="MJXp-Span-2375"><span class="MJXp-mo" id="MJXp-Span-2376" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2381">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2377"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2378">i</span><span class="MJXp-mo" id="MJXp-Span-2379">=</span><span class="MJXp-mn" id="MJXp-Span-2380">1</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2382"><span class="MJXp-mo" id="MJXp-Span-2383" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-2384"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2385" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2386" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-2387" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2389" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2390" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mrow" id="MJXp-Span-2391"><span class="MJXp-mo" id="MJXp-Span-2392" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex" id="MathJax-Element-332">\sum_{i=1}^n |a_i - b_i|</script>.</p><p>In the second case, we want the minimum cost to create a submask-supermask pair in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2393"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2394">b</span></span></span><script type="math/tex" id="MathJax-Element-333">b</script>.</p><p><strong>Solution 1</strong></p><p>For explanation simplicity, consider the graph <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2395"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2396">G</span></span></span><script type="math/tex" id="MathJax-Element-334">G</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2397"><span class="MJXp-mn" id="MJXp-Span-2398">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2399">m</span></span></span><script type="math/tex" id="MathJax-Element-335">2m</script> vertices, representing the numbers from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2400"><span class="MJXp-mn" id="MJXp-Span-2401">1</span></span></span><script type="math/tex" id="MathJax-Element-336">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2402"><span class="MJXp-mn" id="MJXp-Span-2403">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2404">m</span></span></span><script type="math/tex" id="MathJax-Element-337">2m</script>. In this graph, there's an unweighted edge from vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2405"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2406">i</span></span></span><script type="math/tex" id="MathJax-Element-338">i</script> to vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2407"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2408">i</span><span class="MJXp-mo" id="MJXp-Span-2409" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2410">1</span></span></span><script type="math/tex" id="MathJax-Element-339">i+1</script>, and from vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2412">i</span></span></span><script type="math/tex" id="MathJax-Element-340">i</script> to all submask vertices. Color all vertices in which its value appears in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2413"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2414">b</span></span></span><script type="math/tex" id="MathJax-Element-341">b</script>. The answer is the shortest path between all pairs of distinct colored vertices.</p><p>The implementation itself (see below) uses dynamic programming consisting of three phases. The dynamic programming tracks the first and second closest vertex to each vertex, because the first closest vertex would be itself.</p> <ul>   <li><p>Propagate each colored vertices up (from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2416">i</span></span></span><script type="math/tex" id="MathJax-Element-342">i</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2417"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2418">i</span><span class="MJXp-mo" id="MJXp-Span-2419" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2420">1</span></span></span><script type="math/tex" id="MathJax-Element-343">i+1</script>).</p></li>   <li><p>Propagate to the submasks (from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2421"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2422">i</span></span></span><script type="math/tex" id="MathJax-Element-344">i</script> to its submasks).</p></li>   <li><p>Propagate down (from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2423"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2424">i</span></span></span><script type="math/tex" id="MathJax-Element-345">i</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2426">i</span><span class="MJXp-mo" id="MJXp-Span-2427" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2428">1</span></span></span><script type="math/tex" id="MathJax-Element-346">i-1</script>).</p></li> </ul><p>Time complexity: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2429"><span class="MJXp-mrow" id="MJXp-Span-2430"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2431">O</span></span><span class="MJXp-mo" id="MJXp-Span-2432" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2433">n</span><span class="MJXp-mi" id="MJXp-Span-2434">log</span><span class="MJXp-mo" id="MJXp-Span-2435" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2436">n</span><span class="MJXp-mo" id="MJXp-Span-2437" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2438">m</span><span class="MJXp-mi" id="MJXp-Span-2439">log</span><span class="MJXp-mo" id="MJXp-Span-2440" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2441">m</span><span class="MJXp-mo" id="MJXp-Span-2442" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-347">\mathcal{O}(n \log n + m \log m)</script> per test case. The <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2443"><span class="MJXp-mi" id="MJXp-Span-2444">log</span><span class="MJXp-mo" id="MJXp-Span-2445" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2446">n</span></span></span><script type="math/tex" id="MathJax-Element-348">\log n</script> factor is from the implementation which checks for duplicates in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2447"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2448">b</span></span></span><script type="math/tex" id="MathJax-Element-349">b</script> by sorting.</p><p>Submission: <a href="https://codeforces.com/contest/2077/submission/310298215" title="Submission 310298215 by omsincoconut">310298215</a></p><p><strong>Solution 2</strong></p><p>Submission: <a href="https://codeforces.com/contest/2077/submission/310317931" title="Submission 310317931 by satyam343">310317931</a></p></div></div><p><a href="https://codeforces.com/contest/2077/problem/G" title="Codeforces Round 1008 (Div. 1)">2077G - RGB Walking</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>It might help to solve this task with two colors first. As in, minimize the difference between red and blue.</p> <div class="spoiler"><b class="spoiler-title">Hint 1.1</b><div class="spoiler-content" style="display: block;"><p>Walking back and forth can do wonders.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution for this</b><div class="spoiler-content" style="display: block;"><p>Let the difference between the red edges and the blue edges passed be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2449"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2450">d</span></span></span><script type="math/tex" id="MathJax-Element-350">d</script>.</p><p>Let the edge weights of the red edges be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2451"><span class="MJXp-msubsup" id="MJXp-Span-2452"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2453" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2454" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2455" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2456"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2457" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2458" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2459" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2460" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex" id="MathJax-Element-351">r_1, r_2, \ldots</script> and the blue edges be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2461"><span class="MJXp-msubsup" id="MJXp-Span-2462"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2463" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2464" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2465" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2467" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2468" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2469" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2470" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex" id="MathJax-Element-352">b_1, b_2, \ldots</script>.</p><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2471"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2472">c</span><span class="MJXp-mo" id="MJXp-Span-2473" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2474">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2475">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2476">d</span><span class="MJXp-mo" id="MJXp-Span-2477" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2478"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2479" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2480" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2481" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2482"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2483" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2484" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2485" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2486" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2487" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2488"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2489" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2490" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2491" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2492"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2493" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2494" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2495" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2496" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2497" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-353">c = gcd(r_1, r_2, \ldots, b_1, b_2, \ldots)</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2499">C</span><span class="MJXp-mo" id="MJXp-Span-2500" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2501">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2502">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2503">m</span><span class="MJXp-mo" id="MJXp-Span-2504" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2505"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2506" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2507" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2508" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2510" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2511" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2512" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2513" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2514" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2515"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2516" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2517" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2518" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2519"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2520" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2521" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2522" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2523" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2524" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-354">C = lcm(r_1, r_2, \ldots, b_1, b_2, \ldots)</script>.</p><p>We can find a walk with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2525"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2526">d</span><span class="MJXp-mo" id="MJXp-Span-2527" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2528">0</span></span></span><script type="math/tex" id="MathJax-Element-355">d=0</script> which passes every edge and returns to vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2529"><span class="MJXp-mn" id="MJXp-Span-2530">1</span></span></span><script type="math/tex" id="MathJax-Element-356">1</script>.</p> <div class="spoiler"><b class="spoiler-title">Proof</b><div class="spoiler-content" style="display: block;"><p>For each edge, walk to one of its endpoint, walk that edge, and then walk back to vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2531"><span class="MJXp-mn" id="MJXp-Span-2532">1</span></span></span><script type="math/tex" id="MathJax-Element-357">1</script> using the same walk. This way, we passed through every edge an even number of times.</p><p>We will now walk back and forth using the edges we passed. This way, we can add to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2533"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2534">d</span></span></span><script type="math/tex" id="MathJax-Element-358">d</script> by some linear combination of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2535"><span class="MJXp-mn" id="MJXp-Span-2536">2</span><span class="MJXp-msubsup" id="MJXp-Span-2537"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2538" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2539" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2540" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2541">2</span><span class="MJXp-msubsup" id="MJXp-Span-2542"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2543" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2544" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2545" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2546" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2547" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2548">2</span><span class="MJXp-msubsup" id="MJXp-Span-2549"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2550" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2551" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2552" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2553">2</span><span class="MJXp-msubsup" id="MJXp-Span-2554"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2555" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2556" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2557" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2558" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex" id="MathJax-Element-359">2r_1, 2r_2, \ldots, 2b_1, 2b_2, \ldots</script>. Because <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2559"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2560">d</span></span></span><script type="math/tex" id="MathJax-Element-360">d</script> is divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2561"><span class="MJXp-mn" id="MJXp-Span-2562">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2563">c</span></span></span><script type="math/tex" id="MathJax-Element-361">2c</script>, we can add to it such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2564"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2565">d</span><span class="MJXp-mo" id="MJXp-Span-2566" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2567">0</span></span></span><script type="math/tex" id="MathJax-Element-362">d=0</script> by Bézout's identity.</p><p>Note: About the "can add by some linear combination", there's the slight caveat that we can only add the red and subtract the blue. We can subtract the red (or similarly, add the blue) by first subtracting from blue by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2568"><span class="MJXp-mn" id="MJXp-Span-2569">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2570">C</span></span></span><script type="math/tex" id="MathJax-Element-363">2C</script>, then add back red just so that it is deficit by the edge weight.</p></div></div><p>After passing every edge and returning to vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2571"><span class="MJXp-mn" id="MJXp-Span-2572">1</span></span></span><script type="math/tex" id="MathJax-Element-364">1</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2573"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2574">d</span><span class="MJXp-mo" id="MJXp-Span-2575" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-2576">0</span></span></span><script type="math/tex" id="MathJax-Element-365">d=0</script>, we can walk from vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2577"><span class="MJXp-mn" id="MJXp-Span-2578">1</span></span></span><script type="math/tex" id="MathJax-Element-366">1</script> to vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2579"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2580">n</span></span></span><script type="math/tex" id="MathJax-Element-367">n</script>. If the walk have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2581"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2582">d</span></span></span><script type="math/tex" id="MathJax-Element-368">d</script> divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2583"><span class="MJXp-mn" id="MJXp-Span-2584">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2585">c</span></span></span><script type="math/tex" id="MathJax-Element-369">2c</script>, then the answer is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2586"><span class="MJXp-mn" id="MJXp-Span-2587">0</span></span></span><script type="math/tex" id="MathJax-Element-370">0</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2588"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2589">c</span></span></span><script type="math/tex" id="MathJax-Element-371">c</script> otherwise. The proof of this is similar to the proof above.</p><p>To check if a walk with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2590"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2591">d</span></span></span><script type="math/tex" id="MathJax-Element-372">d</script> divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2592"><span class="MJXp-mn" id="MJXp-Span-2593">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2594">c</span></span></span><script type="math/tex" id="MathJax-Element-373">2c</script> exist or not, create a state graph where each vertex is either "reach the vertex with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2595"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2596">d</span></span></span><script type="math/tex" id="MathJax-Element-374">d</script> divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2597"><span class="MJXp-mn" id="MJXp-Span-2598">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2599">c</span></span></span><script type="math/tex" id="MathJax-Element-375">2c</script>" and "<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2600"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2601">d</span></span></span><script type="math/tex" id="MathJax-Element-376">d</script> not divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2602"><span class="MJXp-mn" id="MJXp-Span-2603">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2604">c</span></span></span><script type="math/tex" id="MathJax-Element-377">2c</script>".</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>In the two-color version (in Hint 1), we created a state graph on the parity. Can a similar idea be used?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>Think about each color separately first.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Let</p> <ul>   <li><p>the edge weights of the red edges be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2605"><span class="MJXp-msubsup" id="MJXp-Span-2606"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2607" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2608" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2609" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2610"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2611" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2612" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2613" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2614" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex" id="MathJax-Element-378">r_1, r_2, \ldots</script>, the green edges be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2615"><span class="MJXp-msubsup" id="MJXp-Span-2616"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2617" style="margin-right: 0.05em;">g</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2618" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2619" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2620"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2621" style="margin-right: 0.05em;">g</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2622" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2623" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2624" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex" id="MathJax-Element-379">g_1, g_2, \ldots</script> and the blue edges be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2625"><span class="MJXp-msubsup" id="MJXp-Span-2626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2627" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2628" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2629" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2630"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2631" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2632" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2633" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2634" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex" id="MathJax-Element-380">b_1, b_2, \ldots</script>.</p></li>   <li><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2635"><span class="MJXp-mo" id="MJXp-Span-2636" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-2637" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2638"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2639" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2640" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2641" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2642"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2643" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2644" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2645" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2646" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2647" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-381">\gcd(r_1, r_2, \ldots)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2648"><span class="MJXp-mo" id="MJXp-Span-2649" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-2650" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2651"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2652" style="margin-right: 0.05em;">g</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2653" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2654" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2655"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2656" style="margin-right: 0.05em;">g</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2657" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2658" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2659" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2660" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-382">\gcd(g_1, g_2, \ldots)</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2661"><span class="MJXp-mo" id="MJXp-Span-2662" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-2663" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2664"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2665" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2666" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2667" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2668"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2669" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2670" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2671" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2672" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-2673" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-383">\gcd(b_1, b_2, \ldots)</script> be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2674"><span class="MJXp-msubsup" id="MJXp-Span-2675"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2676" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2677" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-2678" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2679"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2680" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2681" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2682" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2683"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2684" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2685" style="vertical-align: -0.4em;">b</span></span></span></span><script type="math/tex" id="MathJax-Element-384">c_r, c_g, c_b</script>.</p></li>   <li><p>the sum of weights of red, green and blue edges traversed be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2686"><span class="MJXp-msubsup" id="MJXp-Span-2687"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2688" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2689" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-2690" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2691"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2692" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2693" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2694" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2695"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2696" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2697" style="vertical-align: -0.4em;">b</span></span></span></span><script type="math/tex" id="MathJax-Element-385">d_r, d_g, d_b</script>.</p></li> </ul><p>Define <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2698"><span class="MJXp-mo" id="MJXp-Span-2699" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-2700"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2701" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2702" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2703"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2704" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2705" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2706" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2707"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2708" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2709" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2710"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2711" style="margin-right: 0.05em;">g</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2712" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2713" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2714"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2715" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2716" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2717"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2718" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2719" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2720" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;=&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-2721"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2722" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2723" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2724"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2725" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2726" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2727" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2729" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2730" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2731"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2732" style="margin-right: 0.05em;">g</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2733" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2734" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2735"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2736" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2737" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2738"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2739" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2740" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2741" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span></span></span><script type="math/tex" id="MathJax-Element-386"><d_{r_1}, d_{g_1}, d_{b_1}> = <d_{r_2}, d_{g_2}, d_{b_2}></script> only if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2742"><span class="MJXp-msubsup" id="MJXp-Span-2743"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2744" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2745" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2746"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2747" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2748" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2749" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2750"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2751" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2752" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2753"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2754" style="margin-right: 0.05em;">g</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2755" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2756" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2757"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2758" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2759" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2760"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2761" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2762" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2763" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2764"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2765" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2766" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2767"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2768" style="margin-right: 0.05em;">g</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2769" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-387">d_{r_1}-d_{g_1} = d_{r_2}-d_{g_2}</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2770"><span class="MJXp-msubsup" id="MJXp-Span-2771"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2772" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2773" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2774"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2775" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2776" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2777" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2778"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2779" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2780" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2781"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2782" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2783" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2784" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2785"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2786" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2787" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2788"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2789" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2790" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2791" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2792"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2793" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2794" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2795"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2796" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2797" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-388">d_{r_1}-d_{b_1} = d_{r_2}-d_{b_2}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2798"><span class="MJXp-msubsup" id="MJXp-Span-2799"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2800" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2801" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2802"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2803" style="margin-right: 0.05em;">g</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2804" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2805" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2806"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2807" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2808" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2809"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2810" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2811" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2812" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2813"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2814" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2815" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2816"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2817" style="margin-right: 0.05em;">g</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2818" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2819" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-2820"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2821" style="margin-right: 0.05em;">d</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2822" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-2823"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2824" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2825" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-389">d_{g_1}-d_{b_1} = d_{g_2}-d_{b_2}</script>.</p><p>In a similar manner to hint 1, there's a walk that passes through every edge and have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2826"><span class="MJXp-mo" id="MJXp-Span-2827" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-2828"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2829" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2830" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-2831" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2832"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2833" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2834" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2835" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2836"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2837" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2838" style="vertical-align: -0.4em;">b</span></span><span class="MJXp-mo" id="MJXp-Span-2839" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;=&lt;</span><span class="MJXp-mn" id="MJXp-Span-2840">0</span><span class="MJXp-mo" id="MJXp-Span-2841" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2842">0</span><span class="MJXp-mo" id="MJXp-Span-2843" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-2844">0</span><span class="MJXp-mo" id="MJXp-Span-2845" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span></span></span><script type="math/tex" id="MathJax-Element-390"><d_r, d_g, d_b> = <0, 0, 0></script>. Furthermore, if we have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2846"><span class="MJXp-mo" id="MJXp-Span-2847" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-2848"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2849" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2850" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-2851" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2852"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2853" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2854" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2855" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2856"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2857" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2858" style="vertical-align: -0.4em;">b</span></span><span class="MJXp-mo" id="MJXp-Span-2859" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span></span></span><script type="math/tex" id="MathJax-Element-391"><d_r, d_g, d_b></script>, then we can have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2860"><span class="MJXp-mo" id="MJXp-Span-2861" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-2862"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2863" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2864" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-2865" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2866">2</span><span class="MJXp-msubsup" id="MJXp-Span-2867"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2868" style="margin-right: 0.05em;">g</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2869" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-2870" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2871"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2872" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2873" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2874" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2875"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2876" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2877" style="vertical-align: -0.4em;">b</span></span><span class="MJXp-mo" id="MJXp-Span-2878" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span></span></span><script type="math/tex" id="MathJax-Element-392"><d_r + 2g_r, d_g, d_b></script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2879"><span class="MJXp-mo" id="MJXp-Span-2880" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-2881"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2882" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2883" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-2884" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2885">2</span><span class="MJXp-msubsup" id="MJXp-Span-2886"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2887" style="margin-right: 0.05em;">g</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2888" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-2889" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2890"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2891" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2892" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2893" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2894"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2895" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2896" style="vertical-align: -0.4em;">b</span></span><span class="MJXp-mo" id="MJXp-Span-2897" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span></span></span><script type="math/tex" id="MathJax-Element-393"><d_r - 2g_r, d_g, d_b></script>. The analogous statement holds for the other two colors.</p><p>Consequently, from any reachable <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2898"><span class="MJXp-mo" id="MJXp-Span-2899" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-2900"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2901" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2902" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-2903" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2904"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2905" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2906" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2907" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2908"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2909" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2910" style="vertical-align: -0.4em;">b</span></span><span class="MJXp-mo" id="MJXp-Span-2911" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span></span></span><script type="math/tex" id="MathJax-Element-394"><d_r, d_g, d_b></script>, we can have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2912"><span class="MJXp-mo" id="MJXp-Span-2913" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-2914"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2915" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2916" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-2917" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2918"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2919" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2920" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2921" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2922"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2923" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2924" style="vertical-align: -0.4em;">b</span></span><span class="MJXp-mo" id="MJXp-Span-2925" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span></span></span><script type="math/tex" id="MathJax-Element-395"><s_r, s_g, s_b></script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2926"><span class="MJXp-msubsup" id="MJXp-Span-2927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2928" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2929" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-396">s_r</script> is either <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2930"><span class="MJXp-mn" id="MJXp-Span-2931">0</span></span></span><script type="math/tex" id="MathJax-Element-397">0</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2932"><span class="MJXp-msubsup" id="MJXp-Span-2933"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2934" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2935" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-398">c_r</script> depending on whether <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2936"><span class="MJXp-msubsup" id="MJXp-Span-2937"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2938" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2939" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-2940" style="margin-left: 0.333em; margin-right: 0.333em;">≡</span><span class="MJXp-mn" id="MJXp-Span-2941">0</span></span></span><script type="math/tex" id="MathJax-Element-399">d_r \equiv 0</script> (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2942"><span class="MJXp-TeXmathchoice" id="MJXp-Span-2943"><span class="MJXp-mspace" id="MJXp-Span-2944" style="width: 0.667em; height: 0em;"></span></span><span class="MJXp-mi" id="MJXp-Span-2945">mod</span><span class="MJXp-mspace" id="MJXp-Span-2946" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-2947" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-2948">2</span><span class="MJXp-msubsup" id="MJXp-Span-2949"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2950" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2951" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-400">\mod 2c_r</script>) or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2952"><span class="MJXp-msubsup" id="MJXp-Span-2953"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2954" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2955" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-2956" style="margin-left: 0.333em; margin-right: 0.333em;">≡</span><span class="MJXp-msubsup" id="MJXp-Span-2957"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2958" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2959" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-401">d_r \equiv c_r</script> (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2960"><span class="MJXp-TeXmathchoice" id="MJXp-Span-2961"><span class="MJXp-mspace" id="MJXp-Span-2962" style="width: 0.667em; height: 0em;"></span></span><span class="MJXp-mi" id="MJXp-Span-2963">mod</span><span class="MJXp-mspace" id="MJXp-Span-2964" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-2965" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-2966">2</span><span class="MJXp-msubsup" id="MJXp-Span-2967"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2968" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2969" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-402">\mod 2c_r</script>). The idea holds similarly for the other two colors. This invites us to look at each vertex as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2970"><span class="MJXp-mn" id="MJXp-Span-2971">8</span></span></span><script type="math/tex" id="MathJax-Element-403">8</script> possible states, corresponding to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2972"><span class="MJXp-mn" id="MJXp-Span-2973">3</span></span></span><script type="math/tex" id="MathJax-Element-404">3</script> binary options of each color.</p><p>We simply need to solve the answer for each reachable state then take the minimum. Each state corresponds to the following system of linear congruences.</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2974"><span class="MJXp-msubsup" id="MJXp-Span-2975"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2976" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2977" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-2978" style="margin-left: 0.333em; margin-right: 0.333em;">≡</span><span class="MJXp-msubsup" id="MJXp-Span-2979"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2980" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2981" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-2982" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-2983"><span class="MJXp-mspace" id="MJXp-Span-2984" style="width: 0.667em; height: 0em;"></span></span><span class="MJXp-mi" id="MJXp-Span-2985">mod</span><span class="MJXp-mspace" id="MJXp-Span-2986" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-2987" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-2988">2</span><span class="MJXp-msubsup" id="MJXp-Span-2989"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2990" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2991" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-2992" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-405"> d_r \equiv s_r (\mod 2c_r) </script></center> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2993"><span class="MJXp-msubsup" id="MJXp-Span-2994"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2995" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2996" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-2997" style="margin-left: 0.333em; margin-right: 0.333em;">≡</span><span class="MJXp-msubsup" id="MJXp-Span-2998"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2999" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3000" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-3001" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-3002"><span class="MJXp-mspace" id="MJXp-Span-3003" style="width: 0.667em; height: 0em;"></span></span><span class="MJXp-mi" id="MJXp-Span-3004">mod</span><span class="MJXp-mspace" id="MJXp-Span-3005" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-3006" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-3007">2</span><span class="MJXp-msubsup" id="MJXp-Span-3008"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3009" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3010" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-3011" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-406"> d_g \equiv s_g (\mod 2c_g) </script></center> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3012"><span class="MJXp-msubsup" id="MJXp-Span-3013"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3014" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3015" style="vertical-align: -0.4em;">b</span></span><span class="MJXp-mo" id="MJXp-Span-3016" style="margin-left: 0.333em; margin-right: 0.333em;">≡</span><span class="MJXp-msubsup" id="MJXp-Span-3017"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3018" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3019" style="vertical-align: -0.4em;">b</span></span><span class="MJXp-mo" id="MJXp-Span-3020" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-3021"><span class="MJXp-mspace" id="MJXp-Span-3022" style="width: 0.667em; height: 0em;"></span></span><span class="MJXp-mi" id="MJXp-Span-3023">mod</span><span class="MJXp-mspace" id="MJXp-Span-3024" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-3025" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-3026">2</span><span class="MJXp-msubsup" id="MJXp-Span-3027"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3028" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3029" style="vertical-align: -0.4em;">b</span></span><span class="MJXp-mo" id="MJXp-Span-3030" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-407"> d_b \equiv s_b (\mod 2c_b) </script></center><p>We aim to minimize <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3031"><span class="MJXp-mo" id="MJXp-Span-3032" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-3033" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3034"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3035" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3036" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-3037" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3038"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3039" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3040" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-3041" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3042"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3043" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3044" style="vertical-align: -0.4em;">b</span></span><span class="MJXp-mo" id="MJXp-Span-3045" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3046" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-3047" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-3048" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3049"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3050" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3051" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-3052" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3053"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3054" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3055" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-3056" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3057"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3058" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3059" style="vertical-align: -0.4em;">b</span></span><span class="MJXp-mo" id="MJXp-Span-3060" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-408">\max(d_r, d_g, d_b) - \min(d_r, d_g, d_b)</script> over all triplets which satisfy the conditions.</p><p>To do so, we will fix one of them, which we'll suppose is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3061"><span class="MJXp-msubsup" id="MJXp-Span-3062"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3063" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3064" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-409">d_r</script>, as the minimum.</p><p>Denote <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3065"><span class="MJXp-msubsup" id="MJXp-Span-3066"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3067" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3068" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-3069" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3070">p</span><span class="MJXp-mo" id="MJXp-Span-3071" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-410">f_g(p)</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3072"><span class="MJXp-msubsup" id="MJXp-Span-3073"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3074" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3075" style="vertical-align: -0.4em;">b</span></span><span class="MJXp-mo" id="MJXp-Span-3076" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3077">p</span><span class="MJXp-mo" id="MJXp-Span-3078" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-411">f_b(p)</script> as the minimum possible <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3079"><span class="MJXp-msubsup" id="MJXp-Span-3080"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3081" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3082" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-3083" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-3084" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3085"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3086" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3087" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-3088" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3089">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3090">p</span><span class="MJXp-msubsup" id="MJXp-Span-3091"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3092" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3093" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-3094" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-412">d_g - (d_r + 2pc_r)</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3095"><span class="MJXp-msubsup" id="MJXp-Span-3096"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3097" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3098" style="vertical-align: -0.4em;">b</span></span><span class="MJXp-mo" id="MJXp-Span-3099" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-3100" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3102" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3103" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-3104" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3105">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3106">p</span><span class="MJXp-msubsup" id="MJXp-Span-3107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3108" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3109" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-3110" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-413">r_b - (d_r + 2pc_r)</script> where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3111"><span class="MJXp-msubsup" id="MJXp-Span-3112"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3113" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3114" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-3115" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3116"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3117" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3118" style="vertical-align: -0.4em;">p</span></span><span class="MJXp-mo" id="MJXp-Span-3119" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-msubsup" id="MJXp-Span-3120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3121" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3122" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-3123" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-3124">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3125">p</span><span class="MJXp-msubsup" id="MJXp-Span-3126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3127" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3128" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-414">r_g, r_p \geq d_r + 2pc_r</script>.</p><p>We want to find</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3129"><span class="MJXp-msubsup" id="MJXp-Span-3130"><span class="MJXp-mo" id="MJXp-Span-3131" style="margin-left: 0.333em; margin-right: 0.05em;">min</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3132" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3133">k</span><span class="MJXp-mo" id="MJXp-Span-3134">∈</span><span class="MJXp-mrow" id="MJXp-Span-3135"><span class="MJXp-mi undefined" id="MJXp-Span-3136">Z</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3137" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-3138" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3140" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3141" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-3142" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3143">k</span><span class="MJXp-mo" id="MJXp-Span-3144" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3145" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3147" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3148" style="vertical-align: -0.4em;">b</span></span><span class="MJXp-mo" id="MJXp-Span-3149" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3150">k</span><span class="MJXp-mo" id="MJXp-Span-3151" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3152" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-415"> \min_{k \in \mathbb{Z}} \max(f_g(k), f_b(k)) </script></center><p>Observe that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3153"><span class="MJXp-msubsup" id="MJXp-Span-3154"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3155" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3156" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-3157" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3158">k</span><span class="MJXp-mo" id="MJXp-Span-3159" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-3160"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3161" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3162" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-3163" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3164" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3165"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3166" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3167" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-3168" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3169">p</span><span class="MJXp-mo" id="MJXp-Span-3170" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-416">f_g(k + c_g) = f_g(p)</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3172">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3173">b</span><span class="MJXp-mo" id="MJXp-Span-3174" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3175">k</span><span class="MJXp-mo" id="MJXp-Span-3176" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-3177"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3178" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3179" style="vertical-align: -0.4em;">b</span></span><span class="MJXp-mo" id="MJXp-Span-3180" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3181" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-3182"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3183" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3184" style="vertical-align: -0.4em;">b</span></span><span class="MJXp-mo" id="MJXp-Span-3185" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3186">p</span><span class="MJXp-mo" id="MJXp-Span-3187" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-417">fb(k + c_b) = f_b(p)</script>. By the Chinese remainder theorem, the expression above reduces to</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3188"><span class="MJXp-msubsup" id="MJXp-Span-3189"><span class="MJXp-mo" id="MJXp-Span-3190" style="margin-left: 0.333em; margin-right: 0.05em;">min</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3191" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3192">0</span><span class="MJXp-mo" id="MJXp-Span-3193">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3194">k</span><span class="MJXp-mo" id="MJXp-Span-3195">&lt;</span><span class="MJXp-mo" id="MJXp-Span-3196">gcd</span><span class="MJXp-mo" id="MJXp-Span-3197">(</span><span class="MJXp-msubsup" id="MJXp-Span-3198"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3199" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3200" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-3201">,</span><span class="MJXp-msubsup" id="MJXp-Span-3202"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3203" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3204" style="vertical-align: -0.4em;">b</span></span><span class="MJXp-mo" id="MJXp-Span-3205">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-3206" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-3207" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3208"><span class="MJXp-mo" id="MJXp-Span-3209" style="margin-left: 0.333em; margin-right: 0.05em;">min</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3210" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-3211">(</span><span class="MJXp-msubsup" id="MJXp-Span-3212"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3213" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3214" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-3215"><span class="MJXp-mspace" id="MJXp-Span-3216" style="width: 0.667em; height: 0em;"></span></span><span class="MJXp-mi" id="MJXp-Span-3217">mod</span><span class="MJXp-mspace" id="MJXp-Span-3218" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-3219" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3220">gcd</span><span class="MJXp-mo" id="MJXp-Span-3221">(</span><span class="MJXp-msubsup" id="MJXp-Span-3222"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3223" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3224" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-3225">,</span><span class="MJXp-msubsup" id="MJXp-Span-3226"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3227" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3228" style="vertical-align: -0.4em;">b</span></span><span class="MJXp-mo" id="MJXp-Span-3229">)</span><span class="MJXp-mo" id="MJXp-Span-3230">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3231">k</span><span class="MJXp-mo" id="MJXp-Span-3232">)</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3233"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3234" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3235" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-3236" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3237"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3238" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3239" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-3240" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3241" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3242"><span class="MJXp-mo" id="MJXp-Span-3243" style="margin-left: 0.333em; margin-right: 0.05em;">min</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3244" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-3245">(</span><span class="MJXp-msubsup" id="MJXp-Span-3246"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3247" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3248" style="vertical-align: -0.4em;">b</span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-3249"><span class="MJXp-mspace" id="MJXp-Span-3250" style="width: 0.667em; height: 0em;"></span></span><span class="MJXp-mi" id="MJXp-Span-3251">mod</span><span class="MJXp-mspace" id="MJXp-Span-3252" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-3253" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-3254">gcd</span><span class="MJXp-mo" id="MJXp-Span-3255">(</span><span class="MJXp-msubsup" id="MJXp-Span-3256"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3257" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3258" style="vertical-align: -0.4em;">g</span></span><span class="MJXp-mo" id="MJXp-Span-3259">,</span><span class="MJXp-msubsup" id="MJXp-Span-3260"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3261" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3262" style="vertical-align: -0.4em;">b</span></span><span class="MJXp-mo" id="MJXp-Span-3263">)</span><span class="MJXp-mo" id="MJXp-Span-3264">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3265">k</span><span class="MJXp-mo" id="MJXp-Span-3266">)</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3267"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3268" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3269" style="vertical-align: -0.4em;">b</span></span><span class="MJXp-mo" id="MJXp-Span-3270" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3271"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3272" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3273" style="vertical-align: -0.4em;">b</span></span><span class="MJXp-mo" id="MJXp-Span-3274" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3275" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-418"> \min_{0 \leq k < \gcd(c_g, c_b)} \max(\min_{(k_g \mod \gcd(c_g, c_b) = k)} f_g(k_g), \min_{(k_b \mod \gcd(c_g, c_b) = k)} f_b(k_b)) </script></center><p>Which can be evaluated in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3276"><span class="MJXp-mrow" id="MJXp-Span-3277"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3278">O</span></span><span class="MJXp-mo" id="MJXp-Span-3279" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3280">x</span><span class="MJXp-mo" id="MJXp-Span-3281" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-419">\mathcal{O}(x)</script>.</p><p>Time complexity: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3282"><span class="MJXp-mrow" id="MJXp-Span-3283"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-3284">O</span></span><span class="MJXp-mo" id="MJXp-Span-3285" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3286">n</span><span class="MJXp-mi" id="MJXp-Span-3287">log</span><span class="MJXp-mo" id="MJXp-Span-3288" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3289">x</span><span class="MJXp-mo" id="MJXp-Span-3290" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3291">x</span><span class="MJXp-mo" id="MJXp-Span-3292" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-420">\mathcal{O}(n \log x + x)</script> per test case. The logarithmic factor is from gcd computations.</p><p>Submission: <a href="https://codeforces.com/contest/2077/submission/310298269" title="Submission 310298269 by omsincoconut">310298269</a></p></div></div><p><strong>Some ending notes</strong></p> <div class="spoiler"><b class="spoiler-title">Rating predictions</b><div class="spoiler-content" style="display: block;"><p><img alt=" " src="https://codeforces.com/predownloaded/ad/e7/ade708ee8c96e124bab3a52c647a430f5cdd3a92.png" style="max-width: 100.0%;max-height: 100.0%;"></p></div></div> <div class="spoiler"><b class="spoiler-title">A small (?) story of this contest.</b><div class="spoiler-content" style="display: block;"><p>This contest was originally proposed as a Div. 2 only. It was changed to Div. 1 + Div. 2 because we found task 1G, which was originally proposed with only two colors as 2D.</p><p>The contest itself retained little of the original proposal, and most of the tasks were once proposed for a lower position.</p> <ul>   <li><p>2B was proposed as 2A.</p></li>   <li><p>1A/2C was proposed as 2A.</p></li>   <li><p>2D was proposed as 2B. The base story is credited to my friend Punpun.</p></li>   <li><p>1B/2E was proposed as 2C.</p></li>   <li><p>1C/2F was proposed as 2E with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3293"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3294">n</span><span class="MJXp-mo" id="MJXp-Span-3295" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-3296">5000</span></span></span><script type="math/tex" id="MathJax-Element-421">n \leq 5000</script>. The testers found the solutions for the current version.</p></li>   <li><p>1D was originally made for permutation arrays only. Credit to <a class="rated-user user-blue" href="https://codeforces.com/profile/satyam343" title="Expert satyam343">satyam343</a> for making the task.</p></li>   <li><p>1E/2G was proposed as 2D with binary arrays. The testers found the solutions for the current version. The idea of folding and dropping color is credited to my friend Punpun.</p></li>   <li><p>1F was proposed in a much easier form as 2B. It was buffed by <a class="rated-user user-blue" href="https://codeforces.com/profile/satyam343" title="Expert satyam343">satyam343</a>.</p></li> </ul> <div class="spoiler"><b class="spoiler-title">Original formulation</b><div class="spoiler-content" style="display: block;"><p>Given arrays <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3297"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3298">a</span></span></span><script type="math/tex" id="MathJax-Element-422">a</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3300">b</span></span></span><script type="math/tex" id="MathJax-Element-423">b</script> both of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3301"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3302">n</span></span></span><script type="math/tex" id="MathJax-Element-424">n</script>, perform the following operation no more than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3303"><span class="MJXp-mn" id="MJXp-Span-3304">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3305">n</span></span></span><script type="math/tex" id="MathJax-Element-425">2n</script> times such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3306"><span class="MJXp-msubsup" id="MJXp-Span-3307"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3308" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3309" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-3310" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-msubsup" id="MJXp-Span-3311"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3312" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3313" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-426">a_i \neq b_i</script> holds for at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3314"><span class="MJXp-mn" id="MJXp-Span-3315">2</span></span></span><script type="math/tex" id="MathJax-Element-427">2</script> values of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3317">i</span></span></span><script type="math/tex" id="MathJax-Element-428">i</script>. The operation is the same one which is used to define a good pair of arrays.</p></div></div> <ul>   <li>1G was proposed as 2D with two colors. Solving this easier version can hint the full solution.</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">About Arcaea and the soundtracks</b><div class="spoiler-content" style="display: block;"><p>Arcaea is a good rhythm game with good mechanics, music, and story. In some tasks, I put music from Arcaea in it because I want to.</p></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2077" class="notice" style="text-decoration: none;">Codeforces Round 1008 (Div. 1)</a> </span>
        </div>
        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2078" class="notice" style="text-decoration: none;">Codeforces Round 1008 (Div. 2)</a> </span>
        </div>
        
            

  <script>
    // Make all spoilers toggleable
    document.querySelectorAll('.spoiler-title').forEach(title => {
      title.addEventListener('click', function() {
        const spoiler = this.closest('.spoiler');
        spoiler.classList.toggle('open');
      });
    });
    
    // Open all spoilers by default for easier reading
    document.querySelectorAll('.spoiler').forEach(spoiler => {
      spoiler.classList.add('open');
    });
  </script>
</body>
</html>