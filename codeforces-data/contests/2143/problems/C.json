{
  "contestId": 2143,
  "index": "C",
  "title": "Max Tree",
  "timeLimit": "2 seconds",
  "memoryLimit": "256 megabytes",
  "rating": 1300,
  "tags": [
    "constructive algorithms",
    "dfs and similar",
    "graphs",
    "greedy"
  ],
  "statementHtml": "<p>  </p>\n<p>You are given a tree consisting of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2\">n</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-1\">n</script> vertices, numbered from <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3\"><span class=\"MJXp-mn\" id=\"MJXp-Span-4\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-2\">1</script> to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-5\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-6\">n</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-3\">n</script>. Each of the <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-7\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-8\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-9\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-10\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-4\">n - 1</script> edges is associated with two non-negative integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-11\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-12\">x</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-5\">x</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-13\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-14\">y</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-6\">y</script>.</p>\n<p>Consider a permutation<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-15\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-16\"><span class=\"MJXp-mi\" id=\"MJXp-Span-17\" style=\"margin-right: 0.05em;\"></span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-18\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-mtext\" id=\"MJXp-Span-19\">∗</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-7\">^{\\text{∗}}</script> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-20\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-21\">p</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-8\">p</script> of the integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-22\"><span class=\"MJXp-mn\" id=\"MJXp-Span-23\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-9\">1</script> through <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-24\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-25\">n</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-10\">n</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-26\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-27\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-28\" style=\"margin-right: 0.05em;\">p</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-29\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-11\">p_i</script> represents the value assigned to vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-30\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-31\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-12\">i</script>.</p>\n<p>For an edge <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-32\"><span class=\"MJXp-mo\" id=\"MJXp-Span-33\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-34\">u</span><span class=\"MJXp-mo\" id=\"MJXp-Span-35\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-36\">v</span><span class=\"MJXp-mo\" id=\"MJXp-Span-37\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-13\">(u, v)</script>, such that <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-38\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-39\">u</span><span class=\"MJXp-mo\" id=\"MJXp-Span-40\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-41\">v</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-14\">u < v</script> with associated values <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-42\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-43\">x</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-15\">x</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-44\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-45\">y</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-16\">y</script>, its <span class=\"tex-font-style-bf\">contribution</span> is defined as follows: <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math MJXp-display\" id=\"MJXp-Span-46\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-47\"><span class=\"MJXp-mo\" id=\"MJXp-Span-48\" style=\"margin-left: 0em; margin-right: 0em; vertical-align: -0.567em;\"><span class=\"MJXp-right MJXp-scale4\" style=\"font-size: 3.267em; margin-left: -0.278em;\">{</span></span><span class=\"MJXp-mtable\" id=\"MJXp-Span-49\"><span><span class=\"MJXp-mtr\" id=\"MJXp-Span-50\" style=\"vertical-align: baseline;\"><span class=\"MJXp-mtd\" id=\"MJXp-Span-51\" style=\"text-align: left;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-52\">x</span></span><span class=\"MJXp-mtd\" id=\"MJXp-Span-53\" style=\"padding-left: 1em; text-align: left;\"><span class=\"MJXp-mtext\" id=\"MJXp-Span-54\">if&nbsp;</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-55\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-56\" style=\"margin-right: 0.05em;\">p</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-57\" style=\"vertical-align: -0.4em;\">u</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-58\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&gt;</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-59\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-60\" style=\"margin-right: 0.05em;\">p</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-61\" style=\"vertical-align: -0.4em;\">v</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-62\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span></span></span><span class=\"MJXp-mtr\" id=\"MJXp-Span-63\" style=\"vertical-align: baseline;\"><span class=\"MJXp-mtd\" id=\"MJXp-Span-64\" style=\"padding-top: 0.2em; text-align: left;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-65\">y</span></span><span class=\"MJXp-mtd\" id=\"MJXp-Span-66\" style=\"padding-left: 1em; padding-top: 0.2em; text-align: left;\"><span class=\"MJXp-mtext\" id=\"MJXp-Span-67\">otherwise.</span></span></span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-68\" style=\"margin-left: 0em; margin-right: 0em;\"></span></span></span></span><script type=\"math/tex; mode=display\" id=\"MathJax-Element-17\"> \\begin{cases} x & \\text{if } p_u > p_v, \\\\ y & \\text{otherwise.} \\end{cases} </script></p>\n<p>The <span class=\"tex-font-style-bf\">value</span> of the permutation is the sum of the contributions from all edges.</p>\n<p>Your task is to find any permutation <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-69\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-70\">p</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-18\">p</script> that <span class=\"tex-font-style-bf\">maximizes</span> this total value.</p>\n<p><span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-71\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-72\"><span class=\"MJXp-mi\" id=\"MJXp-Span-73\" style=\"margin-right: 0.05em;\"></span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-74\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-mtext\" id=\"MJXp-Span-75\">∗</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-19\">^{\\text{∗}}</script>A permutation of length <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-76\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-77\">n</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-20\">n</script> is an array consisting of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-78\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-79\">n</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-21\">n</script> distinct integers from <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-80\"><span class=\"MJXp-mn\" id=\"MJXp-Span-81\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-22\">1</script> to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-82\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-83\">n</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-23\">n</script> in arbitrary order. For example, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-84\"><span class=\"MJXp-mo\" id=\"MJXp-Span-85\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-86\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-87\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-88\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-89\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-90\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-91\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-92\">5</span><span class=\"MJXp-mo\" id=\"MJXp-Span-93\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-94\">4</span><span class=\"MJXp-mo\" id=\"MJXp-Span-95\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-24\">[2,3,1,5,4]</script> is a permutation, but <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-96\"><span class=\"MJXp-mo\" id=\"MJXp-Span-97\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-98\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-99\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-100\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-101\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-102\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-103\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-25\">[1,2,2]</script> is not a permutation (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-104\"><span class=\"MJXp-mn\" id=\"MJXp-Span-105\">2</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-26\">2</script> appears twice in the array), and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-106\"><span class=\"MJXp-mo\" id=\"MJXp-Span-107\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-108\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-109\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-110\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-111\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-112\">4</span><span class=\"MJXp-mo\" id=\"MJXp-Span-113\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-27\">[1,3,4]</script> is also not a permutation (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-114\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-115\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-116\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-117\">3</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-28\">n=3</script> but there is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-118\"><span class=\"MJXp-mn\" id=\"MJXp-Span-119\">4</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-29\">4</script> in the array). </p>",
  "inputSpecHtml": "<p>Each test contains multiple test cases. The first line contains the number of test cases <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-120\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-121\">t</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-30\">t</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-122\"><span class=\"MJXp-mn\" id=\"MJXp-Span-123\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-124\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-125\">t</span><span class=\"MJXp-mo\" id=\"MJXp-Span-126\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-127\"><span class=\"MJXp-mn\" id=\"MJXp-Span-128\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-129\" style=\"vertical-align: 0.5em;\">4</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-31\">1 \\le t \\le 10^4</script>). The description of the test cases follows. </p><p>The first line contains a single integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-130\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-131\">n</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-32\">n</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-132\"><span class=\"MJXp-mn\" id=\"MJXp-Span-133\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-134\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-135\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-136\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mn\" id=\"MJXp-Span-137\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-138\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⋅</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-139\"><span class=\"MJXp-mn\" id=\"MJXp-Span-140\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-141\" style=\"vertical-align: 0.5em;\">5</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-33\">2 \\le n \\le 2 \\cdot 10^5</script>)&nbsp;— the number of vertices in the tree.</p><p>Each of the next <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-142\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-143\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-144\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-145\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-34\">n - 1</script> lines contains four integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-146\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-147\">u</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-35\">u</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-148\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-149\">v</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-36\">v</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-150\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-151\">x</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-37\">x</script>, and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-152\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-153\">y</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-38\">y</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-154\"><span class=\"MJXp-mn\" id=\"MJXp-Span-155\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-156\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-157\">u</span><span class=\"MJXp-mo\" id=\"MJXp-Span-158\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-159\">v</span><span class=\"MJXp-mo\" id=\"MJXp-Span-160\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-161\">n</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-39\">1 \\le u < v \\le n</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-162\"><span class=\"MJXp-mn\" id=\"MJXp-Span-163\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-164\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-165\">x</span><span class=\"MJXp-mo\" id=\"MJXp-Span-166\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-167\">y</span><span class=\"MJXp-mo\" id=\"MJXp-Span-168\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-169\"><span class=\"MJXp-mn\" id=\"MJXp-Span-170\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-171\" style=\"vertical-align: 0.5em;\">9</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-40\">1 \\le x, y \\le 10^9</script>)&nbsp;— describing an edge between vertices <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-172\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-173\">u</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-41\">u</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-174\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-175\">v</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-42\">v</script> with associated values <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-176\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-177\">x</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-43\">x</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-178\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-179\">y</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-44\">y</script>. It is guarranteed that the given edges form a tree.</p><p>It is guaranteed that the sum of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-180\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-181\">n</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-45\">n</script> over all test cases does not exceed <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-182\"><span class=\"MJXp-mn\" id=\"MJXp-Span-183\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-184\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⋅</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-185\"><span class=\"MJXp-mn\" id=\"MJXp-Span-186\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-187\" style=\"vertical-align: 0.5em;\">5</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-46\">2 \\cdot 10^5</script>. </p>",
  "outputSpecHtml": "<p>For each test case, you must output a permutation <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-188\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-189\">p</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-47\">p</script> of the integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-190\"><span class=\"MJXp-mn\" id=\"MJXp-Span-191\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-48\">1</script> through <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-192\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-193\">n</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-49\">n</script> that maximizes the total value as defined in the problem. If there are multiple answers, you can print any of them.</p>",
  "noteHtml": "<p>In the first test case:</p><p>Consider the permutation <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-194\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-195\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-196\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mo\" id=\"MJXp-Span-197\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-198\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-199\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-200\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-201\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-202\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-203\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-50\">p = [3, 2, 1]</script>. Its value is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-204\"><span class=\"MJXp-mn\" id=\"MJXp-Span-205\">5</span><span class=\"MJXp-mo\" id=\"MJXp-Span-206\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-207\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-208\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-209\">3</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-51\">5 = 2 + 3</script>. Here's why: </p><ul> <li> Since <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-210\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-211\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-212\" style=\"margin-right: 0.05em;\">p</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-213\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-214\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&gt;</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-215\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-216\" style=\"margin-right: 0.05em;\">p</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-217\" style=\"vertical-align: -0.4em;\">2</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-52\">p_1 > p_2</script>, the first edge contributes <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-218\"><span class=\"MJXp-mo\" id=\"MJXp-Span-219\" style=\"margin-left: 0em; margin-right: 0.111em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-220\">2</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-53\">+2</script>. </li><li> Since <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-221\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-222\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-223\" style=\"margin-right: 0.05em;\">p</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-224\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-225\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&gt;</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-226\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-227\" style=\"margin-right: 0.05em;\">p</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-228\" style=\"vertical-align: -0.4em;\">3</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-54\">p_2 > p_3</script>, the second edge contributes <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-229\"><span class=\"MJXp-mo\" id=\"MJXp-Span-230\" style=\"margin-left: 0em; margin-right: 0.111em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-231\">3</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-55\">+3</script>. </li></ul><p>The values of some other permutations are as follows: </p><ul> <li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-232\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-233\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-234\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mo\" id=\"MJXp-Span-235\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-236\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-237\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-238\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-239\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-240\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-241\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-56\">p = [1, 2, 3]</script> has value <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-242\"><span class=\"MJXp-mn\" id=\"MJXp-Span-243\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-244\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-245\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-246\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-247\">3</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-57\">1 + 2 = 3</script>. </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-248\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-249\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-250\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mo\" id=\"MJXp-Span-251\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-252\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-253\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-254\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-255\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-256\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-257\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-58\">p = [1, 3, 2]</script> has value <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-258\"><span class=\"MJXp-mn\" id=\"MJXp-Span-259\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-260\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-261\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-262\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-263\">4</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-59\">1 + 3 = 4</script>. </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-264\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-265\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-266\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mo\" id=\"MJXp-Span-267\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-268\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-269\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-270\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-271\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-272\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-273\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-60\">p = [3, 1, 2]</script> has value <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-274\"><span class=\"MJXp-mn\" id=\"MJXp-Span-275\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-276\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-277\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-278\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-279\">4</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-61\">2 + 2 = 4</script>. </li></ul><p>In the second test case:</p><p>The value of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-280\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-281\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-282\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mo\" id=\"MJXp-Span-283\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-284\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-285\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-286\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-287\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-288\">5</span><span class=\"MJXp-mo\" id=\"MJXp-Span-289\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-290\">4</span><span class=\"MJXp-mo\" id=\"MJXp-Span-291\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-292\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-293\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-62\">p = [2, 3, 5, 4, 1]</script> is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-294\"><span class=\"MJXp-mn\" id=\"MJXp-Span-295\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-296\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-297\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-298\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-299\">7</span><span class=\"MJXp-mo\" id=\"MJXp-Span-300\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-301\">100</span><span class=\"MJXp-mo\" id=\"MJXp-Span-302\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-303\">112</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-63\">3 + 2 + 7 + 100 = 112</script>. Another possible correct answer is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-304\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-305\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-306\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mo\" id=\"MJXp-Span-307\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-308\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-309\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-310\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-311\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-312\">4</span><span class=\"MJXp-mo\" id=\"MJXp-Span-313\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-314\">5</span><span class=\"MJXp-mo\" id=\"MJXp-Span-315\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-316\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-317\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-64\">p = [2, 3, 4, 5, 1]</script>.</p>",
  "samples": [
    {
      "input": "331 2 2 12 3 3 251 2 1 31 5 2 12 4 5 72 3 1 10052 5 5 23 5 4 64 5 1 51 5 3 5",
      "output": "3 2 1 2 3 5 4 1 1 5 2 3 4"
    }
  ],
  "images": [],
  "url": "https://codeforces.com/contest/2143/problem/C"
}