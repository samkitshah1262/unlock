{
  "contestId": 2143,
  "index": "D2",
  "title": "Inversion Graph Coloring (Hard Version)",
  "timeLimit": "3 seconds",
  "memoryLimit": "512 megabytes",
  "rating": 2200,
  "tags": [
    "binary search",
    "combinatorics",
    "data structures",
    "dp",
    "two pointers"
  ],
  "statementHtml": "<p>   </p>\n<p><span class=\"tex-font-style-bf\">This is the hard version of the problem. The difference between the versions is that in this version, <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-1-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;2000&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1\" style=\"width: 5.143em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.899em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1003.85em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2\"><span class=\"mi\" id=\"MathJax-Span-3\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-4\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mn\" id=\"MathJax-Span-5\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">2000</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi><mo>≤</mo><mn>2000</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-1\">n \\le 2000</script>. You can hack only if you solved all versions of this problem.</span> </p>\n<p>A sequence <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-2-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-6\" style=\"width: 6.929em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.252em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1005.25em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7\"><span class=\"msubsup\" id=\"MathJax-Span-8\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-9\" style=\"font-family: MathJax_Math-italic;\">b</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mn\" id=\"MathJax-Span-10\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-11\" style=\"font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-12\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-13\" style=\"font-family: MathJax_Math-italic;\">b</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mn\" id=\"MathJax-Span-14\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-15\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mo\" id=\"MathJax-Span-16\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">…</span><span class=\"mo\" id=\"MathJax-Span-17\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-18\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-19\" style=\"font-family: MathJax_Math-italic;\">b</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mi\" id=\"MathJax-Span-20\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">k</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>b</mi><mn>1</mn></msub><mo>,</mo><msub><mi>b</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>b</mi><mi>k</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-2\">b_1, b_2, \\ldots, b_k</script> is called <span class=\"tex-font-style-bf\">good</span> if there exists a coloring of each index <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-3-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-21\" style=\"width: 0.436em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-22\"><span class=\"mi\" id=\"MathJax-Span-23\" style=\"font-family: MathJax_Math-italic;\">i</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>i</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-3\">i</script> in red or blue such that for every pair of indices <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-4-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-24\" style=\"width: 2.708em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.059em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1002.06em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-25\"><span class=\"mi\" id=\"MathJax-Span-26\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-27\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-28\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">j</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>i</mi><mo>&lt;</mo><mi>j</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-4\">i < j</script> with <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-5-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-29\" style=\"width: 3.899em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.925em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1002.92em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-30\"><span class=\"msubsup\" id=\"MathJax-Span-31\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-32\" style=\"font-family: MathJax_Math-italic;\">b</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mi\" id=\"MathJax-Span-33\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-34\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">&gt;</span><span class=\"msubsup\" id=\"MathJax-Span-35\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 0.814em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-36\" style=\"font-family: MathJax_Math-italic;\">b</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mi\" id=\"MathJax-Span-37\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">j</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>b</mi><mi>i</mi></msub><mo>&gt;</mo><msub><mi>b</mi><mi>j</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-5\">b_i > b_j</script>, the colors assigned to <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-6-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-38\" style=\"width: 0.436em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-39\"><span class=\"mi\" id=\"MathJax-Span-40\" style=\"font-family: MathJax_Math-italic;\">i</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>i</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-6\">i</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-7-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-41\" style=\"width: 0.598em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.44em, 2.492em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-42\"><span class=\"mi\" id=\"MathJax-Span-43\" style=\"font-family: MathJax_Math-italic;\">j</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>j</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-7\">j</script> are different.</p>\n<p>You are given a sequence <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-8-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-44\" style=\"width: 7.47em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.63em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.572em, 1005.63em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-45\"><span class=\"msubsup\" id=\"MathJax-Span-46\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-47\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mn\" id=\"MathJax-Span-48\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-49\" style=\"font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-50\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-51\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mn\" id=\"MathJax-Span-52\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-53\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mo\" id=\"MathJax-Span-54\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">…</span><span class=\"mo\" id=\"MathJax-Span-55\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-56\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 1.031em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-57\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-58\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>a</mi><mi>n</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-8\">a_1, a_2, \\ldots, a_n</script>. Compute the number of good subsequences of the sequence, including the empty subsequence<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;&amp;#x2217;&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-59\" style=\"width: 0.598em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-60\"><span class=\"msubsup\" id=\"MathJax-Span-61\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.845em, 1000em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-62\"></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-63\"><span class=\"mrow\" id=\"MathJax-Span-64\"><span class=\"mtext\" id=\"MathJax-Span-65\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">∗</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi></mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>∗</mtext></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-9\">^{\\text{∗}}</script>. Since the answer can be very large, output it modulo <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-10-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-66\" style=\"width: 4.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.141em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1003.14em, 2.438em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-67\"><span class=\"msubsup\" id=\"MathJax-Span-68\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-69\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"mn\" id=\"MathJax-Span-70\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">9</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-71\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">+</span><span class=\"mn\" id=\"MathJax-Span-72\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">7</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.361em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mn>10</mn><mn>9</mn></msup><mo>+</mo><mn>7</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-10\">10^9 + 7</script>.</p>\n<p><span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-11-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;&amp;#x2217;&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-73\" style=\"width: 0.621em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 136%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.44em, 2.351em, -999.997em); top: -2.16em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-74\"><span class=\"msubsup\" id=\"MathJax-Span-75\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.834em, 1000em, 4.205em, -999.997em); top: -4.013em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-76\"></span><span style=\"display: inline-block; width: 0px; height: 4.019em;\"></span></span><span style=\"position: absolute; top: -4.384em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-77\"><span class=\"mrow\" id=\"MathJax-Span-78\"><span class=\"mtext\" id=\"MathJax-Span-79\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">∗</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.019em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.166em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1.097em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi></mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>∗</mtext></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-11\">^{\\text{∗}}</script>A sequence <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-12-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-80\" style=\"width: 0.621em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 136%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.44em, 2.351em, -999.997em); top: -2.16em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-81\"><span class=\"mi\" id=\"MathJax-Span-82\" style=\"font-family: MathJax_Math-italic;\">b</span></span><span style=\"display: inline-block; width: 0px; height: 2.166em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1.097em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>b</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-12\">b</script> is a subsequence of a sequence <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-83\" style=\"width: 0.806em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.559em; height: 0px; font-size: 136%;\"><span style=\"position: absolute; clip: rect(1.548em, 1000.56em, 2.351em, -999.997em); top: -2.16em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-84\"><span class=\"mi\" id=\"MathJax-Span-85\" style=\"font-family: MathJax_Math-italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.166em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 0.761em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-13\">a</script> if <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-14-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-86\" style=\"width: 0.621em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 136%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.44em, 2.351em, -999.997em); top: -2.16em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-87\"><span class=\"mi\" id=\"MathJax-Span-88\" style=\"font-family: MathJax_Math-italic;\">b</span></span><span style=\"display: inline-block; width: 0px; height: 2.166em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1.097em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>b</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-14\">b</script> can be obtained from <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-15-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-89\" style=\"width: 0.806em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.559em; height: 0px; font-size: 136%;\"><span style=\"position: absolute; clip: rect(1.548em, 1000.56em, 2.351em, -999.997em); top: -2.16em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-90\"><span class=\"mi\" id=\"MathJax-Span-91\" style=\"font-family: MathJax_Math-italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.166em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 0.761em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>a</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-15\">a</script> by the deletion of several (possibly, zero or all) element from arbitrary positions. </p>",
  "inputSpecHtml": "<p>Each test contains multiple test cases. The first line contains the number of test cases <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-92\" style=\"width: 0.544em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.381em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.33em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-93\"><span class=\"mi\" id=\"MathJax-Span-94\" style=\"font-family: MathJax_Math-italic;\">t</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-16\">t</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;100&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-95\" style=\"width: 6.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.035em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1004.98em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-96\"><span class=\"mn\" id=\"MathJax-Span-97\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-98\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-99\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">t</span><span class=\"mo\" id=\"MathJax-Span-100\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mn\" id=\"MathJax-Span-101\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">100</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><mn>100</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-17\">1 \\le t \\le 100</script>). The description of the test cases follows. </p><p>The first line contains an integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-102\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-103\"><span class=\"mi\" id=\"MathJax-Span-104\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-18\">n</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;2000&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-105\" style=\"width: 7.578em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.739em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1005.68em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-106\"><span class=\"mn\" id=\"MathJax-Span-107\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-108\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-109\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span><span class=\"mo\" id=\"MathJax-Span-110\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mn\" id=\"MathJax-Span-111\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">2000</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><mn>2000</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-19\">1 \\leq n \\leq 2000</script>)&nbsp;— the length of the sequence</p><p>The second line contains <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-112\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-113\"><span class=\"mi\" id=\"MathJax-Span-114\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-20\">n</script> integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-115\" style=\"width: 7.47em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.63em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.572em, 1005.63em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-116\"><span class=\"msubsup\" id=\"MathJax-Span-117\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-118\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mn\" id=\"MathJax-Span-119\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-120\" style=\"font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-121\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-122\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mn\" id=\"MathJax-Span-123\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-124\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mo\" id=\"MathJax-Span-125\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">…</span><span class=\"mo\" id=\"MathJax-Span-126\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-127\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 1.031em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-128\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-129\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>a</mi><mi>n</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-21\">a_1, a_2, \\ldots, a_n</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-130\" style=\"width: 6.117em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.602em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1004.6em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-131\"><span class=\"mn\" id=\"MathJax-Span-132\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-133\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-134\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-135\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-136\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-137\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-138\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn><mo>≤</mo><msub><mi>a</mi><mi>i</mi></msub><mo>≤</mo><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-22\">1 \\le a_i \\le n</script>)&nbsp;— the contents of the sequence.</p><p>It is guaranteed that the sum of <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-23-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-139\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-140\"><span class=\"mi\" id=\"MathJax-Span-141\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-23\">n</script> over all test cases does not exceed <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-24-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2000&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-142\" style=\"width: 2.654em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.005em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1001.95em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-143\"><span class=\"mn\" id=\"MathJax-Span-144\" style=\"font-family: MathJax_Main;\">2000</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>2000</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-24\">2000</script>. </p>",
  "outputSpecHtml": "<p>For each test case, output a single line containing the number of good subsequences modulo <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-25-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;9&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-145\" style=\"width: 4.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.141em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1003.14em, 2.438em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-146\"><span class=\"msubsup\" id=\"MathJax-Span-147\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-148\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"mn\" id=\"MathJax-Span-149\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">9</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-150\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">+</span><span class=\"mn\" id=\"MathJax-Span-151\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">7</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.361em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mn>10</mn><mn>9</mn></msup><mo>+</mo><mn>7</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-25\">10^9 + 7</script>.</p>",
  "noteHtml": "<p>In the first test case, the subsequences that are <span class=\"tex-font-style-bf\">not</span> good are <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-26-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-152\" style=\"width: 3.899em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.925em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1002.82em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-153\"><span class=\"mo\" id=\"MathJax-Span-154\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-155\" style=\"font-family: MathJax_Main;\">4</span><span class=\"mo\" id=\"MathJax-Span-156\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-157\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">3</span><span class=\"mo\" id=\"MathJax-Span-158\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-159\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-160\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>4</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-26\">[4, 3, 1]</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-27-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-161\" style=\"width: 3.899em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.925em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1002.82em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-162\"><span class=\"mo\" id=\"MathJax-Span-163\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-164\" style=\"font-family: MathJax_Main;\">4</span><span class=\"mo\" id=\"MathJax-Span-165\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-166\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">2</span><span class=\"mo\" id=\"MathJax-Span-167\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-168\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-169\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>4</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-27\">[4, 2, 1]</script>, and <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-170\" style=\"width: 5.143em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.899em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1003.79em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-171\"><span class=\"mo\" id=\"MathJax-Span-172\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-173\" style=\"font-family: MathJax_Main;\">4</span><span class=\"mo\" id=\"MathJax-Span-174\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-175\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">2</span><span class=\"mo\" id=\"MathJax-Span-176\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-177\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">3</span><span class=\"mo\" id=\"MathJax-Span-178\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-179\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-180\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><mn>4</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-28\">[4, 2, 3, 1]</script>. Since there are <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-29-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;16&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-181\" style=\"width: 1.301em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.92em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-182\"><span class=\"mn\" id=\"MathJax-Span-183\" style=\"font-family: MathJax_Main;\">16</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>16</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-29\">16</script> subsequences in total, this means there are <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-30-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;16&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;13&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-184\" style=\"width: 6.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.035em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1004.98em, 2.438em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-185\"><span class=\"mn\" id=\"MathJax-Span-186\" style=\"font-family: MathJax_Main;\">16</span><span class=\"mo\" id=\"MathJax-Span-187\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mn\" id=\"MathJax-Span-188\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">3</span><span class=\"mo\" id=\"MathJax-Span-189\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-190\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">13</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>16</mn><mo>−</mo><mn>3</mn><mo>=</mo><mn>13</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-30\">16 - 3 = 13</script> good subsequences.</p><p>In the third test case, every subsequence is good.</p>",
  "samples": [
    {
      "input": "444 2 3 177 6 1 2 3 3 251 1 1 1 1117 2 1 9 7 3 4 1 3 5 3",
      "output": "137332619"
    }
  ],
  "images": [],
  "url": "https://codeforces.com/contest/2143/problem/D2",
  "tutorialHtml": "<div><div class=\"ttypography\"><div class=\"problem-statement\"><div><p>Read the tutorial of the easy version first. Since this problem does not admit <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-873\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-874\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-875\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-876\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-877\" style=\"margin-right: 0.05em;\">n</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-878\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-879\">3</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-880\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-145\">O(n^{3})</script>, we should try to somehow reduce the states of the (currently) tridimensional array <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-881\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-882\">w</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-883\">a</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-884\">y</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-885\">s</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-146\">ways</script>. One important thing to notice is that the first type of transition literally copies the matrix of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-886\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-887\">w</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-888\">a</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-889\">y</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-890\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-891\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-892\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-893\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-894\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-895\">1</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-147\">ways_{i - 1}</script> to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-896\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-897\">w</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-898\">a</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-899\">y</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-900\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-901\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-902\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-903\">i</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-148\">ways_{i}</script>, and the second type of transition only changes elements on line or column <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-904\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-905\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-906\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-907\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-908\">i</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-149\">a_{i}</script>, meaning a total of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-909\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-910\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-911\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-912\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-913\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-150\">O(n)</script> elements at step <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-914\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-915\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-151\">i</script>. </p><p>An idea that comes to mind is to then completely forget about the <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-916\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-917\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-152\">i</script> state in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-918\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-919\">w</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-920\">a</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-921\">y</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-922\">s</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-153\">ways</script>, so that \"copying\" the matrix from <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-923\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-924\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-925\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-926\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-154\">i - 1</script> to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-927\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-928\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-155\">i</script> becomes automatic. We'll denote previous (for <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-929\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-930\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-931\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-932\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-156\">i-1</script>) maximum, maximum preceeded and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-933\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-934\">w</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-935\">a</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-936\">y</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-937\">s</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-157\">ways</script> as <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-938\"><span class=\"MJXp-msup\" id=\"MJXp-Span-939\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-940\" style=\"margin-right: 0.05em;\">m</span><span class=\"MJXp-mo MJXp-script\" id=\"MJXp-Span-941\" style=\"vertical-align: 0.5em;\">′</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-158\">m'</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-942\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-943\">m</span><span class=\"MJXp-msup\" id=\"MJXp-Span-944\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-945\" style=\"margin-right: 0.05em;\">p</span><span class=\"MJXp-mo MJXp-script\" id=\"MJXp-Span-946\" style=\"vertical-align: 0.5em;\">′</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-159\">mp'</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-947\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-948\">w</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-949\">a</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-950\">y</span><span class=\"MJXp-msup\" id=\"MJXp-Span-951\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-952\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mo MJXp-script\" id=\"MJXp-Span-953\" style=\"vertical-align: 0.5em;\">′</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-160\">ways'</script>. Now let's look at the transitions from the step when taking <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-954\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-955\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-956\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-957\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-958\">i</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-161\">a_{i}</script>: </p><ul> <li> if now <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-959\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-960\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-961\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-962\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-963\">i</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-964\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-965\">m</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-162\">a_{i} = m</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-966\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-967\">w</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-968\">a</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-969\">y</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-970\">s</span><span class=\"MJXp-mo\" id=\"MJXp-Span-971\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-972\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-973\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-974\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-975\">i</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-976\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-977\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-978\">m</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-979\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-980\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-163\">ways[a_{i}][mp]</script> += <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-981\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-982\"><span class=\"MJXp-mo\" id=\"MJXp-Span-983\" style=\"margin-left: 0.111em; margin-right: 0.05em;\">∑</span><span class=\"MJXp-script-box\" style=\"height: 1.86em; vertical-align: -0.64em;\"><span class=\" MJXp-script\"><span><span style=\"margin-bottom: -0.59em;\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-990\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-991\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-992\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-993\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-994\">i</span></span></span></span></span></span></span><span class=\" MJXp-script\"><span><span style=\"margin-top: -0.85em;\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-984\"><span class=\"MJXp-msup\" id=\"MJXp-Span-985\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-986\" style=\"margin-right: 0.05em;\">m</span><span class=\"MJXp-mo MJXp-script\" id=\"MJXp-Span-987\" style=\"vertical-align: 0.5em;\">′</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-988\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-989\">0</span></span></span></span></span></span></span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-995\">w</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-996\">a</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-997\">y</span><span class=\"MJXp-msup\" id=\"MJXp-Span-998\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-999\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mo MJXp-script\" id=\"MJXp-Span-1000\" style=\"vertical-align: 0.5em;\">′</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1001\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-msup\" id=\"MJXp-Span-1002\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1003\" style=\"margin-right: 0.05em;\">m</span><span class=\"MJXp-mo MJXp-script\" id=\"MJXp-Span-1004\" style=\"vertical-align: 0.5em;\">′</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1005\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1006\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1007\">m</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1008\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1009\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-164\">\\sum_{m'=0}^{a_{i}} ways'[m'][mp]</script> </li><li> if now <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1010\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1011\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1012\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1013\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1014\">i</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1015\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1016\">m</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1017\">p</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-165\">a_{i} = mp</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1018\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1019\">w</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1020\">a</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1021\">y</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1022\">s</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1023\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1024\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1025\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1026\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1027\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1028\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1029\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1030\">i</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1031\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-166\">ways[m][a_{i}]</script> += <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1032\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1033\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1034\" style=\"margin-left: 0.111em; margin-right: 0.05em;\">∑</span><span class=\"MJXp-script-box\" style=\"height: 1.86em; vertical-align: -0.64em;\"><span class=\" MJXp-script\"><span><span style=\"margin-bottom: -0.59em;\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-1042\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1043\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1044\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1045\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1046\">i</span></span></span></span></span></span></span><span class=\" MJXp-script\"><span><span style=\"margin-top: -0.85em;\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-1035\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1036\">m</span><span class=\"MJXp-msup\" id=\"MJXp-Span-1037\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1038\" style=\"margin-right: 0.05em;\">p</span><span class=\"MJXp-mo MJXp-script\" id=\"MJXp-Span-1039\" style=\"vertical-align: 0.5em;\">′</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1040\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1041\">0</span></span></span></span></span></span></span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1047\">w</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1048\">a</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1049\">y</span><span class=\"MJXp-msup\" id=\"MJXp-Span-1050\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1051\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mo MJXp-script\" id=\"MJXp-Span-1052\" style=\"vertical-align: 0.5em;\">′</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1053\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1054\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1055\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1056\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1057\">m</span><span class=\"MJXp-msup\" id=\"MJXp-Span-1058\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1059\" style=\"margin-right: 0.05em;\">p</span><span class=\"MJXp-mo MJXp-script\" id=\"MJXp-Span-1060\" style=\"vertical-align: 0.5em;\">′</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1061\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-167\">\\sum_{mp'=0}^{a_{i}} ways'[m][mp']</script> </li><li> otherwise, as also shown in the tutorial for D1, the LDS condition fails due to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1062\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1063\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1064\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1065\">m</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1066\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1067\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1068\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1069\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1070\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1071\">i</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-168\">m, mp, a_{i}</script> </li></ul><p>So now we only have <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1072\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1073\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1074\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1075\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1076\" style=\"margin-right: 0.05em;\">n</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1077\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-1078\">2</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1079\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-169\">O(n^{2})</script> \"state updates\", but each takes linear time, keeping us at <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1080\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1081\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1082\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1083\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1084\" style=\"margin-right: 0.05em;\">n</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1085\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-1086\">3</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1087\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-170\">O(n^{3})</script>. However, the transitions are now simple enough to apply a data structure on them, such as a fenwick tree. We can keep a fenwick tree on every line and every column of the matrix <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1088\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1089\">w</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1090\">a</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1091\">y</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1092\">s</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-171\">ways</script>, finding out, for each <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1093\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1094\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-172\">i</script>, at what positions should we update our matrix, and updating it at the end of iteration <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1095\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1096\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-173\">i</script> (so that we are querying the <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1097\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1098\">w</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1099\">a</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1100\">y</span><span class=\"MJXp-msup\" id=\"MJXp-Span-1101\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1102\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mo MJXp-script\" id=\"MJXp-Span-1103\" style=\"vertical-align: 0.5em;\">′</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-174\">ways'</script> version). An update on position <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1104\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1105\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1106\">l</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1107\">i</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1108\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1109\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1110\">c</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1111\">o</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1112\">l</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1113\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-175\">(lin, col)</script> with value <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1114\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1115\">v</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1116\">a</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1117\">l</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-176\">val</script> means just updating position <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1118\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1119\">c</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1120\">o</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1121\">l</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-177\">col</script> in the <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1122\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1123\">l</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1124\">i</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1125\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1126\" style=\"margin-right: 0.05em;\">n</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1127\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1128\">t</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1129\">h</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-178\">lin^{th}</script> line fenwick tree by <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1130\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1131\">v</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1132\">a</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1133\">l</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-179\">val</script> and similarly updating position <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1134\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1135\">l</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1136\">i</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1137\">n</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-180\">lin</script> in the <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1138\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1139\">c</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1140\">o</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1141\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1142\" style=\"margin-right: 0.05em;\">l</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1143\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1144\">t</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1145\">h</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-181\">col^{th}</script> column fenwick tree by <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1146\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1147\">v</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1148\">a</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1149\">l</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-182\">val</script>. </p><p>Thus, we've reduced our memory to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1150\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1151\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1152\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1153\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1154\" style=\"margin-right: 0.05em;\">n</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1155\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-1156\">2</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1157\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-183\">O(n^{2})</script> and our complexity to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1158\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1159\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1160\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1161\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1162\" style=\"margin-right: 0.05em;\">n</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-1163\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-1164\">2</span></span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1165\"><span class=\"MJXp-mi\" id=\"MJXp-Span-1166\" style=\"margin-right: 0.05em;\">log</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-1167\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1168\" style=\"margin-left: 0em; margin-right: 0em;\"></span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1169\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1170\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-184\">O(n^{2}\\log_2 n)</script>.</p></div></div></div></div>"
}