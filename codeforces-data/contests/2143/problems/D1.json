{
  "contestId": 2143,
  "index": "D1",
  "title": "Inversion Graph Coloring (Easy Version)",
  "timeLimit": "3 seconds",
  "memoryLimit": "512 megabytes",
  "rating": 1800,
  "tags": [
    "combinatorics",
    "data structures",
    "dp",
    "greedy",
    "two pointers"
  ],
  "statementHtml": "<p>   </p>\n<p><span class=\"tex-font-style-bf\">This is the easy version of the problem. The difference between the versions is that in this version, <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-1-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1\" style=\"width: 4.494em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.412em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1003.36em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2\"><span class=\"mi\" id=\"MathJax-Span-3\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-4\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mn\" id=\"MathJax-Span-5\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">300</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-1\">n \\le 300</script>. You can hack only if you solved all versions of this problem.</span> </p>\n<p>A sequence <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-2-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-6\" style=\"width: 6.929em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.252em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1005.25em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-7\"><span class=\"msubsup\" id=\"MathJax-Span-8\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-9\" style=\"font-family: MathJax_Math-italic;\">b</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mn\" id=\"MathJax-Span-10\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-11\" style=\"font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-12\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-13\" style=\"font-family: MathJax_Math-italic;\">b</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mn\" id=\"MathJax-Span-14\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-15\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mo\" id=\"MathJax-Span-16\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">…</span><span class=\"mo\" id=\"MathJax-Span-17\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-18\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-19\" style=\"font-family: MathJax_Math-italic;\">b</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mi\" id=\"MathJax-Span-20\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">k</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-2\">b_1, b_2, \\ldots, b_k</script> is called <span class=\"tex-font-style-bf\">good</span> if there exists a coloring of each index <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-3-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-21\" style=\"width: 0.436em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-22\"><span class=\"mi\" id=\"MathJax-Span-23\" style=\"font-family: MathJax_Math-italic;\">i</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-3\">i</script> in red or blue such that for every pair of indices <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-4-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-24\" style=\"width: 2.708em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.059em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1002.06em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-25\"><span class=\"mi\" id=\"MathJax-Span-26\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-27\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-28\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">j</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-4\">i < j</script> with <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-5-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-29\" style=\"width: 3.899em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.925em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1002.92em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-30\"><span class=\"msubsup\" id=\"MathJax-Span-31\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-32\" style=\"font-family: MathJax_Math-italic;\">b</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mi\" id=\"MathJax-Span-33\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-34\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">&gt;</span><span class=\"msubsup\" id=\"MathJax-Span-35\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 0.814em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-36\" style=\"font-family: MathJax_Math-italic;\">b</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mi\" id=\"MathJax-Span-37\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">j</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-5\">b_i > b_j</script>, the colors assigned to <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-6-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-38\" style=\"width: 0.436em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-39\"><span class=\"mi\" id=\"MathJax-Span-40\" style=\"font-family: MathJax_Math-italic;\">i</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-6\">i</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-7-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-41\" style=\"width: 0.598em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.44em, 2.492em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-42\"><span class=\"mi\" id=\"MathJax-Span-43\" style=\"font-family: MathJax_Math-italic;\">j</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-7\">j</script> are different.</p>\n<p>You are given a sequence <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-8-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-44\" style=\"width: 7.47em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.63em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.572em, 1005.63em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-45\"><span class=\"msubsup\" id=\"MathJax-Span-46\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-47\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mn\" id=\"MathJax-Span-48\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-49\" style=\"font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-50\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-51\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mn\" id=\"MathJax-Span-52\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-53\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mo\" id=\"MathJax-Span-54\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">…</span><span class=\"mo\" id=\"MathJax-Span-55\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-56\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 1.031em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-57\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-58\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-8\">a_1, a_2, \\ldots, a_n</script>. Compute the number of good subsequences of the sequence, including the empty subsequence<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-59\" style=\"width: 0.598em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-60\"><span class=\"msubsup\" id=\"MathJax-Span-61\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.845em, 1000em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-62\"></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-63\"><span class=\"mrow\" id=\"MathJax-Span-64\"><span class=\"mtext\" id=\"MathJax-Span-65\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">∗</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-9\">^{\\text{∗}}</script>. Since the answer can be very large, output it modulo <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-10-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-66\" style=\"width: 4.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.141em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1003.14em, 2.438em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-67\"><span class=\"msubsup\" id=\"MathJax-Span-68\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-69\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"mn\" id=\"MathJax-Span-70\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">9</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-71\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">+</span><span class=\"mn\" id=\"MathJax-Span-72\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">7</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.361em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-10\">10^9 + 7</script>.</p>\n<p><span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-11-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-73\" style=\"width: 0.621em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 136%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.44em, 2.351em, -999.997em); top: -2.16em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-74\"><span class=\"msubsup\" id=\"MathJax-Span-75\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.834em, 1000em, 4.205em, -999.997em); top: -4.013em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-76\"></span><span style=\"display: inline-block; width: 0px; height: 4.019em;\"></span></span><span style=\"position: absolute; top: -4.384em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-77\"><span class=\"mrow\" id=\"MathJax-Span-78\"><span class=\"mtext\" id=\"MathJax-Span-79\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">∗</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.019em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.166em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1.097em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-11\">^{\\text{∗}}</script>A sequence <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-12-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-80\" style=\"width: 0.621em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 136%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.44em, 2.351em, -999.997em); top: -2.16em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-81\"><span class=\"mi\" id=\"MathJax-Span-82\" style=\"font-family: MathJax_Math-italic;\">b</span></span><span style=\"display: inline-block; width: 0px; height: 2.166em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1.097em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-12\">b</script> is a subsequence of a sequence <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-83\" style=\"width: 0.806em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.559em; height: 0px; font-size: 136%;\"><span style=\"position: absolute; clip: rect(1.548em, 1000.56em, 2.351em, -999.997em); top: -2.16em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-84\"><span class=\"mi\" id=\"MathJax-Span-85\" style=\"font-family: MathJax_Math-italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.166em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 0.761em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-13\">a</script> if <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-14-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-86\" style=\"width: 0.621em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 136%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.44em, 2.351em, -999.997em); top: -2.16em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-87\"><span class=\"mi\" id=\"MathJax-Span-88\" style=\"font-family: MathJax_Math-italic;\">b</span></span><span style=\"display: inline-block; width: 0px; height: 2.166em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1.097em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-14\">b</script> can be obtained from <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-15-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-89\" style=\"width: 0.806em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.559em; height: 0px; font-size: 136%;\"><span style=\"position: absolute; clip: rect(1.548em, 1000.56em, 2.351em, -999.997em); top: -2.16em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-90\"><span class=\"mi\" id=\"MathJax-Span-91\" style=\"font-family: MathJax_Math-italic;\">a</span></span><span style=\"display: inline-block; width: 0px; height: 2.166em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 0.761em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-15\">a</script> by the deletion of several (possibly, zero or all) element from arbitrary positions. </p>",
  "inputSpecHtml": "<p>Each test contains multiple test cases. The first line contains the number of test cases <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-92\" style=\"width: 0.544em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.381em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.33em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-93\"><span class=\"mi\" id=\"MathJax-Span-94\" style=\"font-family: MathJax_Math-italic;\">t</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-16\">t</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-95\" style=\"width: 6.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.035em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1004.98em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-96\"><span class=\"mn\" id=\"MathJax-Span-97\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-98\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-99\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">t</span><span class=\"mo\" id=\"MathJax-Span-100\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mn\" id=\"MathJax-Span-101\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">100</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-17\">1 \\le t \\le 100</script>). The description of the test cases follows. </p><p>The first line contains an integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-102\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-103\"><span class=\"mi\" id=\"MathJax-Span-104\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-18\">n</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-105\" style=\"width: 6.929em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.252em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1005.2em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-106\"><span class=\"mn\" id=\"MathJax-Span-107\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-108\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-109\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span><span class=\"mo\" id=\"MathJax-Span-110\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mn\" id=\"MathJax-Span-111\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">300</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-19\">1 \\leq n \\leq 300</script>)&nbsp;— the length of the sequence</p><p>The second line contains <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-112\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-113\"><span class=\"mi\" id=\"MathJax-Span-114\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-20\">n</script> integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-115\" style=\"width: 7.47em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.63em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.572em, 1005.63em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-116\"><span class=\"msubsup\" id=\"MathJax-Span-117\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-118\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mn\" id=\"MathJax-Span-119\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-120\" style=\"font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-121\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-122\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mn\" id=\"MathJax-Span-123\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-124\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mo\" id=\"MathJax-Span-125\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">…</span><span class=\"mo\" id=\"MathJax-Span-126\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-127\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 1.031em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-128\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-129\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-21\">a_1, a_2, \\ldots, a_n</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-130\" style=\"width: 6.117em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.602em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1004.6em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-131\"><span class=\"mn\" id=\"MathJax-Span-132\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-133\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-134\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-135\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-136\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-137\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-138\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-22\">1 \\le a_i \\le n</script>)&nbsp;— the contents of the sequence.</p><p>It is guaranteed that the sum of <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-23-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-139\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-140\"><span class=\"mi\" id=\"MathJax-Span-141\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-23\">n</script> over all test cases does not exceed <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-24-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-142\" style=\"width: 2.005em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.518em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1001.46em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-143\"><span class=\"mn\" id=\"MathJax-Span-144\" style=\"font-family: MathJax_Main;\">300</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-24\">300</script>. </p>",
  "outputSpecHtml": "<p>For each test case, output a single line containing the number of good subsequences modulo <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-25-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-145\" style=\"width: 4.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.141em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1003.14em, 2.438em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-146\"><span class=\"msubsup\" id=\"MathJax-Span-147\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-148\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"mn\" id=\"MathJax-Span-149\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">9</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-150\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">+</span><span class=\"mn\" id=\"MathJax-Span-151\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">7</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.361em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-25\">10^9 + 7</script>.</p>",
  "noteHtml": "<p>In the first test case, the subsequences that are <span class=\"tex-font-style-bf\">not</span> good are <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-26-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-152\" style=\"width: 3.899em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.925em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1002.82em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-153\"><span class=\"mo\" id=\"MathJax-Span-154\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-155\" style=\"font-family: MathJax_Main;\">4</span><span class=\"mo\" id=\"MathJax-Span-156\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-157\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">3</span><span class=\"mo\" id=\"MathJax-Span-158\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-159\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-160\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-26\">[4, 3, 1]</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-27-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-161\" style=\"width: 3.899em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.925em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1002.82em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-162\"><span class=\"mo\" id=\"MathJax-Span-163\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-164\" style=\"font-family: MathJax_Main;\">4</span><span class=\"mo\" id=\"MathJax-Span-165\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-166\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">2</span><span class=\"mo\" id=\"MathJax-Span-167\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-168\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-169\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-27\">[4, 2, 1]</script>, and <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-170\" style=\"width: 5.143em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.899em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1003.79em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-171\"><span class=\"mo\" id=\"MathJax-Span-172\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-173\" style=\"font-family: MathJax_Main;\">4</span><span class=\"mo\" id=\"MathJax-Span-174\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-175\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">2</span><span class=\"mo\" id=\"MathJax-Span-176\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-177\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">3</span><span class=\"mo\" id=\"MathJax-Span-178\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-179\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-180\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-28\">[4, 2, 3, 1]</script>. Since there are <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-29-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-181\" style=\"width: 1.301em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.92em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-182\"><span class=\"mn\" id=\"MathJax-Span-183\" style=\"font-family: MathJax_Main;\">16</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-29\">16</script> subsequences in total, this means there are <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-30-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-184\" style=\"width: 6.659em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.035em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1004.98em, 2.438em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-185\"><span class=\"mn\" id=\"MathJax-Span-186\" style=\"font-family: MathJax_Main;\">16</span><span class=\"mo\" id=\"MathJax-Span-187\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mn\" id=\"MathJax-Span-188\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">3</span><span class=\"mo\" id=\"MathJax-Span-189\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-190\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">13</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-30\">16 - 3 = 13</script> good subsequences.</p><p>In the third test case, every subsequence is good.</p>",
  "samples": [
    {
      "input": "444 2 3 177 6 1 2 3 3 251 1 1 1 1117 2 1 9 7 3 4 1 3 5 3",
      "output": "137332619"
    }
  ],
  "images": [],
  "url": "https://codeforces.com/contest/2143/problem/D1",
  "tutorialHtml": "<div><div class=\"ttypography\"><div class=\"problem-statement\"><div><p>First, what does it mean for a sequence to be \"good\"? It turns out, the graph created by drawing an edge between <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-575\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-576\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-101\">i</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-577\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-578\">j</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-102\">j</script> only if <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-579\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-580\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-581\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-582\">j</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-103\">i < j</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-583\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-584\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-585\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-586\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-587\">i</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-588\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&gt;</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-589\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-590\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-591\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-592\">j</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-104\">a_{i} > a_{j}</script> is \"<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-593\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-594\">k</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-105\">k</script>-colorable\" if and only if the length of its LDS (longest decreasing subsequence) is at most <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-595\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-596\">k</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-106\">k</script>. Proving this is actually quite easy: if the length of the LDS is more than <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-597\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-598\">k</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-107\">k</script>, there exists a clique of size more than <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-599\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-600\">k</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-108\">k</script>, which is not <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-601\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-602\">k</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-109\">k</script>-colorable. If, however, the length of the LDS is at most <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-603\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-604\">k</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-110\">k</script>, we can color element <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-605\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-606\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-111\">i</script> in \"the length of the LDS starting at <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-607\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-608\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-112\">i</script>\". This way, colors will be between 1 and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-609\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-610\">k</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-113\">k</script>, and no two elements of the same color will be directly connected, since then the one with the lower index would have a bigger LDS starting from it than the other one. </p><p>Now back to our problem. We basically have to count the number of subsequences such that their LDS is at most 2. Assume we have already set a subsequence and want to verify whether its LDS is at most 2 in linear time. A possible way to do it is to try, for each prefix, to find some value <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-611\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-612\">m</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-613\">a</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-614\">x</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-615\">p</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-616\">r</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-617\">e</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-618\">c</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-619\">e</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-620\">e</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-621\">d</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-622\">e</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-623\">d</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-114\">maxpreceeded</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-624\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-625\">m</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-626\">p</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-115\">mp</script> for short), representing the biggest value that we've met on this prefix that has a bigger value to its left. If we have this for each prefix, we should just check whether <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-627\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-628\">m</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-629\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-630\" style=\"margin-right: 0.05em;\">p</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-631\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-632\">i</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-633\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;=</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-634\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-635\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-636\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-637\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-638\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-639\">1</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-116\">mp_{i} <= a_{i+1}</script> for each <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-640\"><span class=\"MJXp-mn\" id=\"MJXp-Span-641\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-642\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-643\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-644\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-645\">l</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-646\">e</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-647\">n</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-648\">g</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-649\">t</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-650\">h</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-117\">1 < i < length</script>. To calculate <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-651\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-652\">m</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-653\">p</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-118\">mp</script>, we'll probably also need to keep track of the maximum value on each prefix, call it <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-654\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-655\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-656\" style=\"margin-right: 0.05em;\">m</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-657\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-658\">i</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-119\">m_{i}</script>.</p><p>This allows us to formulate the following dp: <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-659\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-660\">w</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-661\">a</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-662\">y</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-663\">s</span><span class=\"MJXp-mo\" id=\"MJXp-Span-664\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-665\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-666\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-667\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-668\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-669\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-670\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-671\">m</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-672\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-673\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-674\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-120\">ways[i][m][mp] =</script> the number of ways to select a subsequence of the first <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-675\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-676\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-121\">i</script> elements, so that the maximum element selected is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-677\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-678\">m</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-122\">m</script>, and the maximum element preceeded by a bigger one is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-679\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-680\">m</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-681\">p</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-123\">mp</script>. We could say that a value of 0 for <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-682\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-683\">m</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-124\">m</script> or <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-684\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-685\">m</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-686\">p</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-125\">mp</script> means \"inexistence\". </p><p>What would be the transitions? </p><ul> <li> if we don't use element <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-687\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-688\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-126\">i</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-689\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-690\">w</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-691\">a</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-692\">y</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-693\">s</span><span class=\"MJXp-mo\" id=\"MJXp-Span-694\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-695\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-696\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-697\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-698\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-699\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-700\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-701\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-702\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-703\">m</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-704\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-705\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-127\">ways[i - 1][m][mp]</script> transitions to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-706\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-707\">w</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-708\">a</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-709\">y</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-710\">s</span><span class=\"MJXp-mo\" id=\"MJXp-Span-711\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-712\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-713\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-714\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-715\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-716\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-717\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-718\">m</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-719\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-720\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-128\">ways[i][m][mp]</script> for all pairs of (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-721\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-722\">m</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-129\">m</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-723\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-724\">m</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-725\">p</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-130\">mp</script>) </li><li> if we use element <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-726\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-727\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-131\">i</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-728\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-729\">w</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-730\">a</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-731\">y</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-732\">s</span><span class=\"MJXp-mo\" id=\"MJXp-Span-733\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-734\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-735\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-736\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-737\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-738\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-739\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-740\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-741\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-742\">m</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-743\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-744\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-132\">ways[i - 1][m][mp]</script> transitions to: <ul> <li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-745\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-746\">w</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-747\">a</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-748\">y</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-749\">s</span><span class=\"MJXp-mo\" id=\"MJXp-Span-750\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-751\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-752\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-753\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-754\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-755\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-756\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-757\">i</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-758\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-759\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-760\">m</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-761\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-762\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-133\">ways[i][a_{i}][mp]</script> if <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-763\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-764\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-765\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-766\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-767\">i</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-768\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≥</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-769\">m</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-134\">a_{i} \\geq m</script> </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-770\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-771\">w</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-772\">a</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-773\">y</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-774\">s</span><span class=\"MJXp-mo\" id=\"MJXp-Span-775\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-776\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-777\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-778\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-779\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-780\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-781\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-782\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-783\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-784\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-785\">i</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-786\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-135\">ways[i][m][a_{i}]</script> if <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-787\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-788\">m</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-789\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-790\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-791\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-792\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-793\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-794\">i</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-795\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-796\">m</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-136\">mp \\leq a_{i} < m</script> </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-797\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-798\">w</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-799\">a</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-800\">y</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-801\">s</span><span class=\"MJXp-mo\" id=\"MJXp-Span-802\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-803\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-804\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-805\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-806\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-807\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-808\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-809\">m</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-810\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-811\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-137\">ways[i][m][mp]</script> if <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-812\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-813\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-814\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-815\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-816\">i</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-817\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-818\">m</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-819\">p</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-138\">a_{i} < mp</script>. This transition is, however, not valid, because it breaks our LDS with <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-820\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-821\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-822\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&gt;</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-823\">m</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-824\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-825\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&gt;</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-826\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-827\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-828\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-829\">i</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-139\">m > mp > a_{i}</script> </li></ul> </li></ul><p>All the transitions are constant, and the dp has <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-830\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-831\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-832\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-833\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-834\" style=\"margin-right: 0.05em;\">n</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-835\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-836\">3</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-837\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-140\">O(n^{3})</script> states, so the complexity is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-838\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-839\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-840\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-841\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-842\" style=\"margin-right: 0.05em;\">n</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-843\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-844\">3</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-845\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-141\">O(n^{3})</script>. The answer is just the sum of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-846\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-847\">w</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-848\">a</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-849\">y</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-850\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-851\" style=\"margin-right: 0.05em;\">s</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-852\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-853\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-854\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-855\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-856\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-857\">m</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-858\">p</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-142\">ways_{n, m, mp}</script> over all <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-859\"><span class=\"MJXp-mn\" id=\"MJXp-Span-860\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-861\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-862\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-863\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-864\">m</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-865\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-866\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-867\">n</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-143\">0 \\leq m, mp \\leq n</script> (of course, all states with <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-868\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-869\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-870\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-871\">m</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-872\">p</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-144\">m \\leq mp</script> will be 0).</p></div></div></div></div>"
}