{
  "contestId": 2125,
  "index": "C",
  "title": "Count Good Numbers",
  "timeLimit": "2 seconds",
  "memoryLimit": "512 megabytes",
  "rating": 1100,
  "tags": [
    "bitmasks",
    "combinatorics",
    "math",
    "number theory"
  ],
  "statementHtml": "<p>A prime number is a positive integer that has exactly two divisors: <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-1-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2\"><span class=\"mn\" id=\"MathJax-Span-3\" style=\"font-family: MathJax_Main;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-1\">1</script> and itself. The first several prime numbers are <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-2-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4\" style=\"width: 8.444em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.388em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1006.33em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5\"><span class=\"mn\" id=\"MathJax-Span-6\" style=\"font-family: MathJax_Main;\">2</span><span class=\"mo\" id=\"MathJax-Span-7\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-8\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">3</span><span class=\"mo\" id=\"MathJax-Span-9\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-10\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">5</span><span class=\"mo\" id=\"MathJax-Span-11\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-12\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">7</span><span class=\"mo\" id=\"MathJax-Span-13\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-14\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">11</span><span class=\"mo\" id=\"MathJax-Span-15\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mo\" id=\"MathJax-Span-16\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">…</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>5</mn><mo>,</mo><mn>7</mn><mo>,</mo><mn>11</mn><mo>,</mo><mo>…</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-2\">2, 3, 5, 7, 11, \\dots</script>.</p>\n<p>Prime factorization of a positive integer is representing it as a product of prime numbers. For example:</p>\n<p>For every positive integer, its prime factorization is unique (if you don't consider the order of primes in the product).</p>\n<p>We call a positive integer <span class=\"tex-font-style-bf\">good</span> if <span class=\"tex-font-style-bf\">all</span> primes in its factorization consist of at least two digits. For example:</p>\n<p>You have to calculate the number of good integers from <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-69\" style=\"width: 0.436em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-70\"><span class=\"mi\" id=\"MathJax-Span-71\" style=\"font-family: MathJax_Math-italic;\">l</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>l</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-13\">l</script> to <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-14-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-72\" style=\"width: 0.598em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-73\"><span class=\"mi\" id=\"MathJax-Span-74\" style=\"font-family: MathJax_Math-italic;\">r</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-14\">r</script> (endpoints included).</p>",
  "inputSpecHtml": "<p>The first line contains one integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-15-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-75\" style=\"width: 0.544em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.381em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.33em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-76\"><span class=\"mi\" id=\"MathJax-Span-77\" style=\"font-family: MathJax_Math-italic;\">t</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-15\">t</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-78\" style=\"width: 6.496em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.927em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1004.93em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-79\"><span class=\"mn\" id=\"MathJax-Span-80\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-81\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-82\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">t</span><span class=\"mo\" id=\"MathJax-Span-83\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-84\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-85\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"mn\" id=\"MathJax-Span-86\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">3</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><msup><mn>10</mn><mn>3</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-16\">1 \\le t \\le 10^3</script>) — the number of test cases.</p><p>Each test case consists of one line containing two integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-87\" style=\"width: 0.436em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-88\"><span class=\"mi\" id=\"MathJax-Span-89\" style=\"font-family: MathJax_Math-italic;\">l</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>l</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-17\">l</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-90\" style=\"width: 0.598em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-91\"><span class=\"mi\" id=\"MathJax-Span-92\" style=\"font-family: MathJax_Math-italic;\">r</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-18\">r</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;18&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-93\" style=\"width: 9.256em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.983em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1006.98em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-94\"><span class=\"mn\" id=\"MathJax-Span-95\" style=\"font-family: MathJax_Main;\">2</span><span class=\"mo\" id=\"MathJax-Span-96\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-97\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">l</span><span class=\"mo\" id=\"MathJax-Span-98\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-99\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">r</span><span class=\"mo\" id=\"MathJax-Span-100\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-101\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 1.788em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-102\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"texatom\" id=\"MathJax-Span-103\"><span class=\"mrow\" id=\"MathJax-Span-104\"><span class=\"mn\" id=\"MathJax-Span-105\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">18</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>2</mn><mo>≤</mo><mi>l</mi><mo>≤</mo><mi>r</mi><mo>≤</mo><msup><mn>10</mn><mrow class=\"MJX-TeXAtom-ORD\"><mn>18</mn></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-19\">2 \\le l \\le r \\le 10^{18}</script>).</p>",
  "outputSpecHtml": "<p>For each test case, print one integer — the number of good integers from <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-106\" style=\"width: 0.436em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-107\"><span class=\"mi\" id=\"MathJax-Span-108\" style=\"font-family: MathJax_Math-italic;\">l</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>l</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-20\">l</script> to <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-109\" style=\"width: 0.598em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-110\"><span class=\"mi\" id=\"MathJax-Span-111\" style=\"font-family: MathJax_Math-italic;\">r</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-21\">r</script>.</p>",
  "noteHtml": "",
  "samples": [
    {
      "input": "42 1002 100013 372 1000000000000000000",
      "output": "21\n227\n7\n228571428571428570"
    }
  ],
  "images": [],
  "url": "https://codeforces.com/contest/2125/problem/C",
  "tutorialHtml": "<div><div class=\"ttypography\"><div class=\"problem-statement\"><div><p>To begin with, it is worth mentioning that if you need to count the number of certain integers in the interval <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-291\"><span class=\"MJXp-mo\" id=\"MJXp-Span-292\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-293\">l</span><span class=\"MJXp-mo\" id=\"MJXp-Span-294\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-295\">r</span><span class=\"MJXp-mo\" id=\"MJXp-Span-296\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-55\">[l, r]</script>, it is almost always more convenient to do it this way: count the number of such integers in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-297\"><span class=\"MJXp-mo\" id=\"MJXp-Span-298\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-299\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-300\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-301\">r</span><span class=\"MJXp-mo\" id=\"MJXp-Span-302\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-303\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-304\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-56\">[0, r+1)</script> (or in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-305\"><span class=\"MJXp-mo\" id=\"MJXp-Span-306\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-307\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-308\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-309\">r</span><span class=\"MJXp-mo\" id=\"MJXp-Span-310\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-311\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-312\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-57\">[1, r+1)</script>), and then subtract the count in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-313\"><span class=\"MJXp-mo\" id=\"MJXp-Span-314\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-315\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-316\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-317\">l</span><span class=\"MJXp-mo\" id=\"MJXp-Span-318\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-58\">[0, l)</script> (or in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-319\"><span class=\"MJXp-mo\" id=\"MJXp-Span-320\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-321\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-322\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-323\">l</span><span class=\"MJXp-mo\" id=\"MJXp-Span-324\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-59\">[1, l)</script>). Counting the number of integers on a prefix is usually significantly easier than in an interval.</p><p>Let's slightly modify the definition of a good number. If all prime factors of an integer consist of at least two digits, then it is not divisible by any of the first four prime numbers (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-325\"><span class=\"MJXp-mn\" id=\"MJXp-Span-326\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-327\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-328\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-329\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-330\">5</span><span class=\"MJXp-mo\" id=\"MJXp-Span-331\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-332\">7</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-60\">2, 3, 5, 7</script>). Similarly, if a number is not good, then it is divisible by at least one of these four numbers.</p><p>There are at least two options for solving the problem: through the periodicity of good numbers and through the inclusion-exclusion formula.</p><p>A number is good if it is not divisible by <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-333\"><span class=\"MJXp-mn\" id=\"MJXp-Span-334\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-335\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-336\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-337\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-338\">5</span><span class=\"MJXp-mo\" id=\"MJXp-Span-339\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-340\">7</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-61\">2, 3, 5, 7</script>. This means that it is sufficient to know the remainder of the number when divided by <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-341\"><span class=\"MJXp-mn\" id=\"MJXp-Span-342\">2</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-62\">2</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-343\"><span class=\"MJXp-mn\" id=\"MJXp-Span-344\">3</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-63\">3</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-345\"><span class=\"MJXp-mn\" id=\"MJXp-Span-346\">5</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-64\">5</script>, and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-347\"><span class=\"MJXp-mn\" id=\"MJXp-Span-348\">7</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-65\">7</script> to determine whether it will be good. This can be determined by the remainder when divided by <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-349\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-350\">L</span><span class=\"MJXp-mo\" id=\"MJXp-Span-351\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-352\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-353\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⋅</span><span class=\"MJXp-mn\" id=\"MJXp-Span-354\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-355\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⋅</span><span class=\"MJXp-mn\" id=\"MJXp-Span-356\">5</span><span class=\"MJXp-mo\" id=\"MJXp-Span-357\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⋅</span><span class=\"MJXp-mn\" id=\"MJXp-Span-358\">7</span><span class=\"MJXp-mo\" id=\"MJXp-Span-359\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-360\">210</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-66\">L = 2 \\cdot 3 \\cdot 5 \\cdot 7 = 210</script>: if <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-361\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-362\">x</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-67\">x</script> is good, then <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-363\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-364\">x</span><span class=\"MJXp-mo\" id=\"MJXp-Span-365\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-366\">L</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-68\">x + L</script> is also good, and vice versa.</p><p>This means that if we need to count the number of good integers from <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-367\"><span class=\"MJXp-mn\" id=\"MJXp-Span-368\">0</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-69\">0</script> to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-369\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-370\">k</span><span class=\"MJXp-mo\" id=\"MJXp-Span-371\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-372\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-70\">k-1</script>, we can calculate the number of complete segments of length <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-373\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-374\">L</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-71\">L</script> in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-375\"><span class=\"MJXp-mo\" id=\"MJXp-Span-376\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-377\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-378\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-379\">k</span><span class=\"MJXp-mo\" id=\"MJXp-Span-380\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-381\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-382\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-72\">[0, k-1]</script> (this is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-383\"><span class=\"MJXp-mo\" id=\"MJXp-Span-384\" style=\"margin-left: 0em; margin-right: 0em;\">⌊</span><span class=\"MJXp-mfrac\" id=\"MJXp-Span-385\" style=\"vertical-align: 0.25em;\"><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-386\">k</span></span><span class=\"MJXp-box\" style=\"margin-top: -0.9em;\"><span class=\"MJXp-denom\"><span><span class=\"MJXp-rule\" style=\"height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;\"></span></span><span><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-387\">L</span></span></span></span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-388\" style=\"margin-left: 0em; margin-right: 0em;\">⌋</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-73\">\\lfloor \\frac{k}{L} \\rfloor</script>), multiply this by the number of good integers in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-389\"><span class=\"MJXp-mo\" id=\"MJXp-Span-390\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-391\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-392\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-393\">L</span><span class=\"MJXp-mo\" id=\"MJXp-Span-394\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-395\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-396\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-74\">[0, L-1]</script> (this can be naively computed in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-397\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-398\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-399\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-400\">L</span><span class=\"MJXp-mo\" id=\"MJXp-Span-401\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-75\">O(L)</script>), and then handle the part of the last segment with <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-402\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-403\">k</span><span class=\"MJXp-mo\" id=\"MJXp-Span-404\" style=\"margin-left: 0.278em; margin-right: 0.278em;\">mod</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-405\">L</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-76\">k \\bmod L</script> extra integers. This way, we will get a solution in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-406\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-407\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-408\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-409\">L</span><span class=\"MJXp-mo\" id=\"MJXp-Span-410\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-77\">O(L)</script> per query.</p><p>The solution with the inclusion-exclusion formula works as follows: let's understand how to count the number of integers that are coprime to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-411\"><span class=\"MJXp-mn\" id=\"MJXp-Span-412\">210</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-78\">210</script> in the interval <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-413\"><span class=\"MJXp-mo\" id=\"MJXp-Span-414\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-415\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-416\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-417\">k</span><span class=\"MJXp-mo\" id=\"MJXp-Span-418\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-79\">[1, k]</script> (if a number is coprime to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-419\"><span class=\"MJXp-mn\" id=\"MJXp-Span-420\">210</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-80\">210</script>, then it is good, as it is not divisible by any of the primes we are interested in). We will form four sets <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-421\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-422\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-423\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-424\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-425\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-426\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-427\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-428\" style=\"vertical-align: -0.4em;\">3</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-429\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-430\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-431\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-432\" style=\"vertical-align: -0.4em;\">5</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-433\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-434\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-435\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-436\" style=\"vertical-align: -0.4em;\">7</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-81\">S_2, S_3, S_5, S_7</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-437\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-438\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-439\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-440\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-82\">S_i</script> contains all integers from <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-441\"><span class=\"MJXp-mn\" id=\"MJXp-Span-442\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-83\">1</script> to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-443\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-444\">k</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-84\">k</script> that are divisible by <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-445\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-446\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-85\">i</script>. Using the inclusion-exclusion formula, we can find the union of these four sets as follows:</p><p><span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math MJXp-display\" id=\"MJXp-Span-447\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-448\"><span class=\"MJXp-mo\" id=\"MJXp-Span-449\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-450\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-451\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-452\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mrow\" id=\"MJXp-Span-453\"><span class=\"MJXp-mo\" id=\"MJXp-Span-454\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-455\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mrow\" id=\"MJXp-Span-456\"><span class=\"MJXp-mo\" id=\"MJXp-Span-457\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-458\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-459\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-460\" style=\"vertical-align: -0.4em;\">3</span></span><span class=\"MJXp-mrow\" id=\"MJXp-Span-461\"><span class=\"MJXp-mo\" id=\"MJXp-Span-462\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-463\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mrow\" id=\"MJXp-Span-464\"><span class=\"MJXp-mo\" id=\"MJXp-Span-465\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-466\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-467\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-468\" style=\"vertical-align: -0.4em;\">5</span></span><span class=\"MJXp-mrow\" id=\"MJXp-Span-469\"><span class=\"MJXp-mo\" id=\"MJXp-Span-470\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-471\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mrow\" id=\"MJXp-Span-472\"><span class=\"MJXp-mo\" id=\"MJXp-Span-473\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-474\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-475\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-476\" style=\"vertical-align: -0.4em;\">7</span></span><span class=\"MJXp-mrow\" id=\"MJXp-Span-477\"><span class=\"MJXp-mo\" id=\"MJXp-Span-478\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-479\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mrow\" id=\"MJXp-Span-480\"><span class=\"MJXp-mo\" id=\"MJXp-Span-481\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-482\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-483\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-484\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-485\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">∩</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-486\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-487\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-488\" style=\"vertical-align: -0.4em;\">3</span></span><span class=\"MJXp-mrow\" id=\"MJXp-Span-489\"><span class=\"MJXp-mo\" id=\"MJXp-Span-490\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-491\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mrow\" id=\"MJXp-Span-492\"><span class=\"MJXp-mo\" id=\"MJXp-Span-493\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-494\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-495\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-496\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-497\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">∩</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-498\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-499\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-500\" style=\"vertical-align: -0.4em;\">5</span></span><span class=\"MJXp-mrow\" id=\"MJXp-Span-501\"><span class=\"MJXp-mo\" id=\"MJXp-Span-502\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-503\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mo\" id=\"MJXp-Span-504\" style=\"margin-left: 0em; margin-right: 0em;\">⋯</span><span class=\"MJXp-mo\" id=\"MJXp-Span-505\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mrow\" id=\"MJXp-Span-506\"><span class=\"MJXp-mo\" id=\"MJXp-Span-507\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-508\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-509\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-510\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-511\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">∩</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-512\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-513\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-514\" style=\"vertical-align: -0.4em;\">3</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-515\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">∩</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-516\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-517\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-518\" style=\"vertical-align: -0.4em;\">5</span></span><span class=\"MJXp-mrow\" id=\"MJXp-Span-519\"><span class=\"MJXp-mo\" id=\"MJXp-Span-520\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-521\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mrow\" id=\"MJXp-Span-522\"><span class=\"MJXp-mo\" id=\"MJXp-Span-523\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-524\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-525\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-526\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-527\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">∩</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-528\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-529\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-530\" style=\"vertical-align: -0.4em;\">3</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-531\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">∩</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-532\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-533\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-534\" style=\"vertical-align: -0.4em;\">7</span></span><span class=\"MJXp-mrow\" id=\"MJXp-Span-535\"><span class=\"MJXp-mo\" id=\"MJXp-Span-536\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-537\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mo\" id=\"MJXp-Span-538\" style=\"margin-left: 0em; margin-right: 0em;\">⋯</span><span class=\"MJXp-mo\" id=\"MJXp-Span-539\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mrow\" id=\"MJXp-Span-540\"><span class=\"MJXp-mo\" id=\"MJXp-Span-541\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-542\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-543\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-544\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-545\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">∩</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-546\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-547\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-548\" style=\"vertical-align: -0.4em;\">3</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-549\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">∩</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-550\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-551\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-552\" style=\"vertical-align: -0.4em;\">5</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-553\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">∩</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-554\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-555\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-556\" style=\"vertical-align: -0.4em;\">7</span></span><span class=\"MJXp-mrow\" id=\"MJXp-Span-557\"><span class=\"MJXp-mo\" id=\"MJXp-Span-558\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span></span></span><script type=\"math/tex; mode=display\" id=\"MathJax-Element-86\">|S_2| + |S_3| + |S_5| + |S_7| - |S_2 \\cap S_3| - |S_2 \\cap S_5| - \\dots + |S_2 \\cap S_3 \\cap S_5| + |S_2 \\cap S_3 \\cap S_7| + \\dots - |S_2 \\cap S_3 \\cap S_5 \\cap S_7|</script></p><p>How do we calculate <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-559\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-560\"><span class=\"MJXp-mo\" id=\"MJXp-Span-561\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-562\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-563\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-564\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mrow\" id=\"MJXp-Span-565\"><span class=\"MJXp-mo\" id=\"MJXp-Span-566\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-87\">|S_i|</script>? It is simply <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-567\"><span class=\"MJXp-mo\" id=\"MJXp-Span-568\" style=\"margin-left: 0em; margin-right: 0em;\">⌊</span><span class=\"MJXp-mfrac\" id=\"MJXp-Span-569\" style=\"vertical-align: 0.25em;\"><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-570\">k</span></span><span class=\"MJXp-box\" style=\"margin-top: -0.9em;\"><span class=\"MJXp-denom\"><span><span class=\"MJXp-rule\" style=\"height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;\"></span></span><span><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-571\">i</span></span></span></span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-572\" style=\"margin-left: 0em; margin-right: 0em;\">⌋</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-88\">\\lfloor \\frac{k}{i} \\rfloor</script>, as we need exactly the numbers <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-573\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-574\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-575\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-576\">2</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-577\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-578\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mo\" id=\"MJXp-Span-579\" style=\"margin-left: 0em; margin-right: 0em;\">…</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-89\">i, 2i, \\dots</script>. How do we calculate the size of the intersection of several sets <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-580\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-581\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-582\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-583\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-90\">S_i</script>? If a number is divisible by several primes, then it is divisible by their product, so in fact the set <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-584\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-585\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-586\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-587\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-588\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-589\" style=\"margin-right: 0.05em;\">p</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-590\" style=\"vertical-align: -0.4em;\">1</span></span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-591\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">∩</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-592\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-593\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-594\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-595\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-596\" style=\"margin-right: 0.05em;\">p</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-597\" style=\"vertical-align: -0.4em;\">2</span></span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-598\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">∩</span><span class=\"MJXp-mo\" id=\"MJXp-Span-599\" style=\"margin-left: 0em; margin-right: 0em;\">⋯</span><span class=\"MJXp-mo\" id=\"MJXp-Span-600\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">∩</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-601\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-602\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-603\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-604\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-605\" style=\"margin-right: 0.05em;\">p</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-606\" style=\"vertical-align: -0.4em;\">m</span></span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-91\">S_{p_1} \\cap S_{p_2} \\cap \\dots \\cap S_{p_m}</script> can be represented as <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-607\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-608\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-609\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-610\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mo\" id=\"MJXp-Span-611\">∏</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-612\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-613\" style=\"margin-right: 0.05em;\">p</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-614\" style=\"vertical-align: -0.4em;\">i</span></span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-92\">S_{\\prod p_i}</script>; for example, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-615\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-616\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-617\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-618\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-619\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">∩</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-620\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-621\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-622\" style=\"vertical-align: -0.4em;\">3</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-623\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">∩</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-624\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-625\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-626\" style=\"vertical-align: -0.4em;\">5</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-627\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-628\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-629\" style=\"margin-right: 0.05em;\">S</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-630\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-631\">30</span></span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-93\">S_2 \\cap S_3 \\cap S_5 = S_{30}</script>. This way, we will obtain a solution that works in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-632\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-633\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-634\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-635\"><span class=\"MJXp-mn\" id=\"MJXp-Span-636\" style=\"margin-right: 0.05em;\">2</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-637\" style=\"vertical-align: 0.5em;\">P</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-638\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-94\">O(2^P)</script> per query, where <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-639\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-640\">P</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-95\">P</script> is the number of primes we are interested in (in this case, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-641\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-642\">P</span><span class=\"MJXp-mo\" id=\"MJXp-Span-643\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-644\">4</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-96\">P = 4</script>).</p></div></div></div></div>"
}