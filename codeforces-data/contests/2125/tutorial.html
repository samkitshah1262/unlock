<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tutorial</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
      color: #333;
      background: #fafafa;
    }
    .ttypography {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    h3 {
      color: #1a1a1a;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }
    h3 a {
      color: #0066cc;
      text-decoration: none;
    }
    h3 a:hover {
      text-decoration: underline;
    }
    .spoiler {
      margin: 15px 0;
      border: 1px solid #ddd;
      border-radius: 6px;
      overflow: hidden;
    }
    .spoiler-title {
      display: block;
      padding: 12px 15px;
      background: #f0f0f0;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
      border-bottom: 1px solid #ddd;
    }
    .spoiler-title:hover {
      background: #e8e8e8;
    }
    .spoiler-title::before {
      content: '▶ ';
      font-size: 0.8em;
      transition: transform 0.2s;
      display: inline-block;
    }
    .spoiler.open .spoiler-title::before {
      content: '▼ ';
    }
    .spoiler-content {
      padding: 15px;
      background: #fff;
      display: none;
    }
    .spoiler.open .spoiler-content {
      display: block;
    }
    pre, code {
      background: #f5f5f5;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 0.85em;
    }
    pre {
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
    code {
      padding: 2px 5px;
      border-radius: 3px;
    }
    p {
      margin: 10px 0;
    }
    .MathJax {
      font-size: 1.1em;
    }
  </style>
</head>
<body>
  <h1>Editorial</h1>
  <p><a href="https://codeforces.com/blog/entry/144998" target="_blank">View on Codeforces →</a></p>
  
  <div class="ttypography"><p><a href="https://codeforces.com/contest/2125/problem/A" title="Educational Codeforces Round 181 (Rated for Div. 2)">2125A - Difficult Contest</a></p><p>Idea: <a class="rated-user user-orange" href="https://codeforces.com/profile/FelixArg" title="Master FelixArg">FelixArg</a></p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2125/problem/A" title="Educational Codeforces Round 181 (Rated for Div. 2)">2125A - Difficult Contest</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Notice that in the strings "<span class="tex-font-style-tt">FFT</span>" and "<span class="tex-font-style-tt">NTT</span>", the letter "<span class="tex-font-style-tt">T</span>" is at the end. From this, we can come up with a solution: place all the letters "<span class="tex-font-style-tt">T</span>" before all the letters "<span class="tex-font-style-tt">F</span>" and "<span class="tex-font-style-tt">N</span>".</p><p>We can do this directly in one pass through the string, or we can use a slightly more clever approach: let's sort all the letters in non-increasing order, then "<span class="tex-font-style-tt">T</span>" will come before "<span class="tex-font-style-tt">F</span>" and "<span class="tex-font-style-tt">N</span>" in the sorted string, since "<span class="tex-font-style-tt">T</span>" has a higher position in the alphabet.</p><p>Asymptotic complexity: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-140"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">O</span><span class="MJXp-mo" id="MJXp-Span-142" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">n</span><span class="MJXp-mo" id="MJXp-Span-144" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-20">O(n)</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-145"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">O</span><span class="MJXp-mo" id="MJXp-Span-147" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">n</span><span class="MJXp-mi" id="MJXp-Span-149">log</span><span class="MJXp-mo" id="MJXp-Span-150" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">n</span><span class="MJXp-mo" id="MJXp-Span-152" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-21">O(n \log n)</script></p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution (awoo)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> tc</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> tc</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tc</span><span class="pun">--){</span><span class="pln">
        </span><span class="kwd">string</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">
        sort</span><span class="pun">(</span><span class="pln">s</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> s</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">());</span><span class="pln">
        reverse</span><span class="pun">(</span><span class="pln">s</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> s</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">());</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> s </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2125/problem/B" title="Educational Codeforces Round 181 (Rated for Div. 2)">2125B - Left and Down</a></p><p>Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/BledDest" title="International Grandmaster BledDest">BledDest</a></p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2125/problem/B" title="Educational Codeforces Round 181 (Rated for Div. 2)">2125B - Left and Down</a></h3><div class="ttypography"><div class="problem-statement"><div><p>In all the examples from the problem statement, the answer is no more than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-153"><span class="MJXp-mn" id="MJXp-Span-154">2</span></span></span><script type="math/tex" id="MathJax-Element-22">2</script>, and indeed, it is always possible to reach the point <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-155"><span class="MJXp-mo" id="MJXp-Span-156" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-157">0</span><span class="MJXp-mo" id="MJXp-Span-158" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-159">0</span><span class="MJXp-mo" id="MJXp-Span-160" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-23">(0,0)</script> by using the pair <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-161"><span class="MJXp-mo" id="MJXp-Span-162" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-163">0</span><span class="MJXp-mo" id="MJXp-Span-164" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-165">1</span><span class="MJXp-mo" id="MJXp-Span-166" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-24">(0,1)</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-167"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">a</span></span></span><script type="math/tex" id="MathJax-Element-25">a</script> times and the pair <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-169"><span class="MJXp-mo" id="MJXp-Span-170" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-171">1</span><span class="MJXp-mo" id="MJXp-Span-172" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-173">0</span><span class="MJXp-mo" id="MJXp-Span-174" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-26">(1,0)</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">b</span></span></span><script type="math/tex" id="MathJax-Element-27">b</script> times, with a total cost of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-177"><span class="MJXp-mn" id="MJXp-Span-178">2</span></span></span><script type="math/tex" id="MathJax-Element-28">2</script>.</p><p>So, we need to check if it is possible to reach it at a cost of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-179"><span class="MJXp-mn" id="MJXp-Span-180">1</span></span></span><script type="math/tex" id="MathJax-Element-29">1</script>. Since the cost is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-181"><span class="MJXp-mn" id="MJXp-Span-182">1</span></span></span><script type="math/tex" id="MathJax-Element-30">1</script>, we need to find a pair <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-183"><span class="MJXp-mo" id="MJXp-Span-184" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">x</span><span class="MJXp-mo" id="MJXp-Span-187" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189">y</span><span class="MJXp-mo" id="MJXp-Span-190" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-31">(dx, dy)</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-191"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">x</span><span class="MJXp-mo" id="MJXp-Span-194" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195">k</span></span></span><script type="math/tex" id="MathJax-Element-32">dx \le k</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-196"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">y</span><span class="MJXp-mo" id="MJXp-Span-199" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">k</span></span></span><script type="math/tex" id="MathJax-Element-33">dy \le k</script>, and it is possible to reach the cell <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-201"><span class="MJXp-mo" id="MJXp-Span-202" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-203">0</span><span class="MJXp-mo" id="MJXp-Span-204" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-205">0</span><span class="MJXp-mo" id="MJXp-Span-206" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-34">(0,0)</script> by consistently applying this pair. This means there exists an integer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">t</span></span></span><script type="math/tex" id="MathJax-Element-35">t</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-209"><span class="MJXp-mo" id="MJXp-Span-210" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211">a</span><span class="MJXp-mo" id="MJXp-Span-212" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213">t</span><span class="MJXp-mo" id="MJXp-Span-214" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">x</span><span class="MJXp-mo" id="MJXp-Span-217" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">b</span><span class="MJXp-mo" id="MJXp-Span-219" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">t</span><span class="MJXp-mo" id="MJXp-Span-221" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">y</span><span class="MJXp-mo" id="MJXp-Span-224" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-36">(a = t \cdot dx, b = t \cdot dy)</script>, and accordingly, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-225"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">t</span></span></span><script type="math/tex" id="MathJax-Element-37">t</script> is a divisor of both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-227"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228">a</span></span></span><script type="math/tex" id="MathJax-Element-38">a</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">b</span></span></span><script type="math/tex" id="MathJax-Element-39">b</script>.</p><p>If there exists such <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-231"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">t</span></span></span><script type="math/tex" id="MathJax-Element-40">t</script> that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-233"><span class="MJXp-mfrac" id="MJXp-Span-234" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">a</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">t</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-237" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">k</span></span></span><script type="math/tex" id="MathJax-Element-41">\frac{a}{t} \le k</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-239"><span class="MJXp-mfrac" id="MJXp-Span-240" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">b</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">t</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-243" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">k</span></span></span><script type="math/tex" id="MathJax-Element-42">\frac{b}{t} \le k</script>, then we can use the pair <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-245"><span class="MJXp-mo" id="MJXp-Span-246" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mfrac" id="MJXp-Span-247" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248">a</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">t</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-250" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mfrac" id="MJXp-Span-251" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252">b</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">t</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-254" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-43">(\frac{a}{t}, \frac{b}{t})</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-255"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">t</span></span></span><script type="math/tex" id="MathJax-Element-44">t</script> times at a cost of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-257"><span class="MJXp-mn" id="MJXp-Span-258">1</span></span></span><script type="math/tex" id="MathJax-Element-45">1</script>. Theoretically, we could iterate through all divisors of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">a</span></span></span><script type="math/tex" id="MathJax-Element-46">a</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-261"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">b</span></span></span><script type="math/tex" id="MathJax-Element-47">b</script> and check these conditions for each. However, the limits do not allow us to do this in either <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-263"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">O</span><span class="MJXp-mo" id="MJXp-Span-265" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266">a</span><span class="MJXp-mo" id="MJXp-Span-267" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-48">O(a)</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-268"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269">O</span><span class="MJXp-mo" id="MJXp-Span-270" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msqrt" id="MJXp-Span-271"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272">a</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-273" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-49">O(\sqrt{a})</script>. Note that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-274"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">t</span></span></span><script type="math/tex" id="MathJax-Element-50">t</script> appears in the denominator of the fraction, which means we need to choose it as great as possible. Therefore, it is enough to check the only value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-276"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">t</span></span></span><script type="math/tex" id="MathJax-Element-51">t</script>—the greatest common divisor of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">a</span></span></span><script type="math/tex" id="MathJax-Element-52">a</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-280"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">b</span></span></span><script type="math/tex" id="MathJax-Element-53">b</script>. This can already be found by using the built-in function <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-282"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">d</span><span class="MJXp-mo" id="MJXp-Span-286" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">a</span><span class="MJXp-mo" id="MJXp-Span-288" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">b</span><span class="MJXp-mo" id="MJXp-Span-290" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-54">gcd(a, b)</script>.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution (ifive)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">from</span><span class="pln"> math </span><span class="kwd">import</span><span class="pln"> gcd
</span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())):</span><span class="pln">
    a</span><span class="pun">,</span><span class="pln"> b</span><span class="pun">,</span><span class="pln"> k </span><span class="pun">=</span><span class="pln"> map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">())</span><span class="pln">
    g </span><span class="pun">=</span><span class="pln"> gcd</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln"> b</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(</span><span class="lit">1</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> a </span><span class="com">// g &lt;= k and b // g &lt;= k else 2)</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2125/problem/C" title="Educational Codeforces Round 181 (Rated for Div. 2)">2125C - Count Good Numbers</a></p><p>Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/BledDest" title="International Grandmaster BledDest">BledDest</a></p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2125/problem/C" title="Educational Codeforces Round 181 (Rated for Div. 2)">2125C - Count Good Numbers</a></h3><div class="ttypography"><div class="problem-statement"><div><p>To begin with, it is worth mentioning that if you need to count the number of certain integers in the interval <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-291"><span class="MJXp-mo" id="MJXp-Span-292" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">l</span><span class="MJXp-mo" id="MJXp-Span-294" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">r</span><span class="MJXp-mo" id="MJXp-Span-296" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-55">[l, r]</script>, it is almost always more convenient to do it this way: count the number of such integers in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-297"><span class="MJXp-mo" id="MJXp-Span-298" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-299">0</span><span class="MJXp-mo" id="MJXp-Span-300" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">r</span><span class="MJXp-mo" id="MJXp-Span-302" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-303">1</span><span class="MJXp-mo" id="MJXp-Span-304" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-56">[0, r+1)</script> (or in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-305"><span class="MJXp-mo" id="MJXp-Span-306" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-307">1</span><span class="MJXp-mo" id="MJXp-Span-308" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">r</span><span class="MJXp-mo" id="MJXp-Span-310" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-311">1</span><span class="MJXp-mo" id="MJXp-Span-312" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-57">[1, r+1)</script>), and then subtract the count in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-313"><span class="MJXp-mo" id="MJXp-Span-314" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-315">0</span><span class="MJXp-mo" id="MJXp-Span-316" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">l</span><span class="MJXp-mo" id="MJXp-Span-318" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-58">[0, l)</script> (or in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-319"><span class="MJXp-mo" id="MJXp-Span-320" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-321">1</span><span class="MJXp-mo" id="MJXp-Span-322" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">l</span><span class="MJXp-mo" id="MJXp-Span-324" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-59">[1, l)</script>). Counting the number of integers on a prefix is usually significantly easier than in an interval.</p><p>Let's slightly modify the definition of a good number. If all prime factors of an integer consist of at least two digits, then it is not divisible by any of the first four prime numbers (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-325"><span class="MJXp-mn" id="MJXp-Span-326">2</span><span class="MJXp-mo" id="MJXp-Span-327" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-328">3</span><span class="MJXp-mo" id="MJXp-Span-329" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-330">5</span><span class="MJXp-mo" id="MJXp-Span-331" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-332">7</span></span></span><script type="math/tex" id="MathJax-Element-60">2, 3, 5, 7</script>). Similarly, if a number is not good, then it is divisible by at least one of these four numbers.</p><p>There are at least two options for solving the problem: through the periodicity of good numbers and through the inclusion-exclusion formula.</p><p>A number is good if it is not divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-333"><span class="MJXp-mn" id="MJXp-Span-334">2</span><span class="MJXp-mo" id="MJXp-Span-335" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-336">3</span><span class="MJXp-mo" id="MJXp-Span-337" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-338">5</span><span class="MJXp-mo" id="MJXp-Span-339" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-340">7</span></span></span><script type="math/tex" id="MathJax-Element-61">2, 3, 5, 7</script>. This means that it is sufficient to know the remainder of the number when divided by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-341"><span class="MJXp-mn" id="MJXp-Span-342">2</span></span></span><script type="math/tex" id="MathJax-Element-62">2</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-343"><span class="MJXp-mn" id="MJXp-Span-344">3</span></span></span><script type="math/tex" id="MathJax-Element-63">3</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-345"><span class="MJXp-mn" id="MJXp-Span-346">5</span></span></span><script type="math/tex" id="MathJax-Element-64">5</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-347"><span class="MJXp-mn" id="MJXp-Span-348">7</span></span></span><script type="math/tex" id="MathJax-Element-65">7</script> to determine whether it will be good. This can be determined by the remainder when divided by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-349"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">L</span><span class="MJXp-mo" id="MJXp-Span-351" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-352">2</span><span class="MJXp-mo" id="MJXp-Span-353" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mn" id="MJXp-Span-354">3</span><span class="MJXp-mo" id="MJXp-Span-355" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mn" id="MJXp-Span-356">5</span><span class="MJXp-mo" id="MJXp-Span-357" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mn" id="MJXp-Span-358">7</span><span class="MJXp-mo" id="MJXp-Span-359" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-360">210</span></span></span><script type="math/tex" id="MathJax-Element-66">L = 2 \cdot 3 \cdot 5 \cdot 7 = 210</script>: if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-361"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">x</span></span></span><script type="math/tex" id="MathJax-Element-67">x</script> is good, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-363"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364">x</span><span class="MJXp-mo" id="MJXp-Span-365" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">L</span></span></span><script type="math/tex" id="MathJax-Element-68">x + L</script> is also good, and vice versa.</p><p>This means that if we need to count the number of good integers from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-367"><span class="MJXp-mn" id="MJXp-Span-368">0</span></span></span><script type="math/tex" id="MathJax-Element-69">0</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-369"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">k</span><span class="MJXp-mo" id="MJXp-Span-371" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-372">1</span></span></span><script type="math/tex" id="MathJax-Element-70">k-1</script>, we can calculate the number of complete segments of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-373"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">L</span></span></span><script type="math/tex" id="MathJax-Element-71">L</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-375"><span class="MJXp-mo" id="MJXp-Span-376" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-377">0</span><span class="MJXp-mo" id="MJXp-Span-378" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379">k</span><span class="MJXp-mo" id="MJXp-Span-380" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-381">1</span><span class="MJXp-mo" id="MJXp-Span-382" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-72">[0, k-1]</script> (this is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-383"><span class="MJXp-mo" id="MJXp-Span-384" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-385" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386">k</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">L</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-388" style="margin-left: 0em; margin-right: 0em;">⌋</span></span></span><script type="math/tex" id="MathJax-Element-73">\lfloor \frac{k}{L} \rfloor</script>), multiply this by the number of good integers in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-389"><span class="MJXp-mo" id="MJXp-Span-390" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-391">0</span><span class="MJXp-mo" id="MJXp-Span-392" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">L</span><span class="MJXp-mo" id="MJXp-Span-394" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-395">1</span><span class="MJXp-mo" id="MJXp-Span-396" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-74">[0, L-1]</script> (this can be naively computed in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-397"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398">O</span><span class="MJXp-mo" id="MJXp-Span-399" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400">L</span><span class="MJXp-mo" id="MJXp-Span-401" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-75">O(L)</script>), and then handle the part of the last segment with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-402"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403">k</span><span class="MJXp-mo" id="MJXp-Span-404" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405">L</span></span></span><script type="math/tex" id="MathJax-Element-76">k \bmod L</script> extra integers. This way, we will get a solution in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">O</span><span class="MJXp-mo" id="MJXp-Span-408" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">L</span><span class="MJXp-mo" id="MJXp-Span-410" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-77">O(L)</script> per query.</p><p>The solution with the inclusion-exclusion formula works as follows: let's understand how to count the number of integers that are coprime to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-411"><span class="MJXp-mn" id="MJXp-Span-412">210</span></span></span><script type="math/tex" id="MathJax-Element-78">210</script> in the interval <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-413"><span class="MJXp-mo" id="MJXp-Span-414" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-415">1</span><span class="MJXp-mo" id="MJXp-Span-416" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417">k</span><span class="MJXp-mo" id="MJXp-Span-418" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-79">[1, k]</script> (if a number is coprime to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-419"><span class="MJXp-mn" id="MJXp-Span-420">210</span></span></span><script type="math/tex" id="MathJax-Element-80">210</script>, then it is good, as it is not divisible by any of the primes we are interested in). We will form four sets <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-421"><span class="MJXp-msubsup" id="MJXp-Span-422"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-424" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-425" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-426"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-428" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-429" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-430"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-432" style="vertical-align: -0.4em;">5</span></span><span class="MJXp-mo" id="MJXp-Span-433" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-436" style="vertical-align: -0.4em;">7</span></span></span></span><script type="math/tex" id="MathJax-Element-81">S_2, S_3, S_5, S_7</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-437"><span class="MJXp-msubsup" id="MJXp-Span-438"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-440" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-82">S_i</script> contains all integers from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-441"><span class="MJXp-mn" id="MJXp-Span-442">1</span></span></span><script type="math/tex" id="MathJax-Element-83">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-443"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">k</span></span></span><script type="math/tex" id="MathJax-Element-84">k</script> that are divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-445"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-446">i</span></span></span><script type="math/tex" id="MathJax-Element-85">i</script>. Using the inclusion-exclusion formula, we can find the union of these four sets as follows:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-447"><span class="MJXp-mrow" id="MJXp-Span-448"><span class="MJXp-mo" id="MJXp-Span-449" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-450"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-452" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-453"><span class="MJXp-mo" id="MJXp-Span-454" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-455" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-456"><span class="MJXp-mo" id="MJXp-Span-457" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-458"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-460" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mrow" id="MJXp-Span-461"><span class="MJXp-mo" id="MJXp-Span-462" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-463" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-464"><span class="MJXp-mo" id="MJXp-Span-465" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-468" style="vertical-align: -0.4em;">5</span></span><span class="MJXp-mrow" id="MJXp-Span-469"><span class="MJXp-mo" id="MJXp-Span-470" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-471" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-472"><span class="MJXp-mo" id="MJXp-Span-473" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-474"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-476" style="vertical-align: -0.4em;">7</span></span><span class="MJXp-mrow" id="MJXp-Span-477"><span class="MJXp-mo" id="MJXp-Span-478" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-479" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-480"><span class="MJXp-mo" id="MJXp-Span-481" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-482"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-484" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-485" style="margin-left: 0.267em; margin-right: 0.267em;">∩</span><span class="MJXp-msubsup" id="MJXp-Span-486"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-488" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mrow" id="MJXp-Span-489"><span class="MJXp-mo" id="MJXp-Span-490" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-491" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-492"><span class="MJXp-mo" id="MJXp-Span-493" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-494"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-495" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-496" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-497" style="margin-left: 0.267em; margin-right: 0.267em;">∩</span><span class="MJXp-msubsup" id="MJXp-Span-498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-500" style="vertical-align: -0.4em;">5</span></span><span class="MJXp-mrow" id="MJXp-Span-501"><span class="MJXp-mo" id="MJXp-Span-502" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-503" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-504" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-505" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-506"><span class="MJXp-mo" id="MJXp-Span-507" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-508"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-509" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-510" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-511" style="margin-left: 0.267em; margin-right: 0.267em;">∩</span><span class="MJXp-msubsup" id="MJXp-Span-512"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-514" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-515" style="margin-left: 0.267em; margin-right: 0.267em;">∩</span><span class="MJXp-msubsup" id="MJXp-Span-516"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-518" style="vertical-align: -0.4em;">5</span></span><span class="MJXp-mrow" id="MJXp-Span-519"><span class="MJXp-mo" id="MJXp-Span-520" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-521" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-522"><span class="MJXp-mo" id="MJXp-Span-523" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-524"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-525" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-526" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-527" style="margin-left: 0.267em; margin-right: 0.267em;">∩</span><span class="MJXp-msubsup" id="MJXp-Span-528"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-530" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-531" style="margin-left: 0.267em; margin-right: 0.267em;">∩</span><span class="MJXp-msubsup" id="MJXp-Span-532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-534" style="vertical-align: -0.4em;">7</span></span><span class="MJXp-mrow" id="MJXp-Span-535"><span class="MJXp-mo" id="MJXp-Span-536" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-537" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-538" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-539" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-540"><span class="MJXp-mo" id="MJXp-Span-541" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-542"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-543" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-544" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-545" style="margin-left: 0.267em; margin-right: 0.267em;">∩</span><span class="MJXp-msubsup" id="MJXp-Span-546"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-547" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-548" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-549" style="margin-left: 0.267em; margin-right: 0.267em;">∩</span><span class="MJXp-msubsup" id="MJXp-Span-550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-552" style="vertical-align: -0.4em;">5</span></span><span class="MJXp-mo" id="MJXp-Span-553" style="margin-left: 0.267em; margin-right: 0.267em;">∩</span><span class="MJXp-msubsup" id="MJXp-Span-554"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-556" style="vertical-align: -0.4em;">7</span></span><span class="MJXp-mrow" id="MJXp-Span-557"><span class="MJXp-mo" id="MJXp-Span-558" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-86">|S_2| + |S_3| + |S_5| + |S_7| - |S_2 \cap S_3| - |S_2 \cap S_5| - \dots + |S_2 \cap S_3 \cap S_5| + |S_2 \cap S_3 \cap S_7| + \dots - |S_2 \cap S_3 \cap S_5 \cap S_7|</script></p><p>How do we calculate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-559"><span class="MJXp-mrow" id="MJXp-Span-560"><span class="MJXp-mo" id="MJXp-Span-561" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-562"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-564" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mrow" id="MJXp-Span-565"><span class="MJXp-mo" id="MJXp-Span-566" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex" id="MathJax-Element-87">|S_i|</script>? It is simply <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-567"><span class="MJXp-mo" id="MJXp-Span-568" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-569" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570">k</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-571">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-572" style="margin-left: 0em; margin-right: 0em;">⌋</span></span></span><script type="math/tex" id="MathJax-Element-88">\lfloor \frac{k}{i} \rfloor</script>, as we need exactly the numbers <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-573"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574">i</span><span class="MJXp-mo" id="MJXp-Span-575" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-576">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">i</span><span class="MJXp-mo" id="MJXp-Span-578" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-579" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex" id="MathJax-Element-89">i, 2i, \dots</script>. How do we calculate the size of the intersection of several sets <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-580"><span class="MJXp-msubsup" id="MJXp-Span-581"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-582" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-583" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-90">S_i</script>? If a number is divisible by several primes, then it is divisible by their product, so in fact the set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-584"><span class="MJXp-msubsup" id="MJXp-Span-585"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-587" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-588"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-590" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-591" style="margin-left: 0.267em; margin-right: 0.267em;">∩</span><span class="MJXp-msubsup" id="MJXp-Span-592"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-594" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-595"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-596" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-597" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-598" style="margin-left: 0.267em; margin-right: 0.267em;">∩</span><span class="MJXp-mo" id="MJXp-Span-599" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-600" style="margin-left: 0.267em; margin-right: 0.267em;">∩</span><span class="MJXp-msubsup" id="MJXp-Span-601"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-603" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-606" style="vertical-align: -0.4em;">m</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-91">S_{p_1} \cap S_{p_2} \cap \dots \cap S_{p_m}</script> can be represented as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-607"><span class="MJXp-msubsup" id="MJXp-Span-608"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-610" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-611">∏</span><span class="MJXp-msubsup" id="MJXp-Span-612"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-614" style="vertical-align: -0.4em;">i</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-92">S_{\prod p_i}</script>; for example, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-615"><span class="MJXp-msubsup" id="MJXp-Span-616"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-617" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-618" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-619" style="margin-left: 0.267em; margin-right: 0.267em;">∩</span><span class="MJXp-msubsup" id="MJXp-Span-620"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-622" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-623" style="margin-left: 0.267em; margin-right: 0.267em;">∩</span><span class="MJXp-msubsup" id="MJXp-Span-624"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-626" style="vertical-align: -0.4em;">5</span></span><span class="MJXp-mo" id="MJXp-Span-627" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-628"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-629" style="margin-right: 0.05em;">S</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-630" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-631">30</span></span></span></span></span><script type="math/tex" id="MathJax-Element-93">S_2 \cap S_3 \cap S_5 = S_{30}</script>. This way, we will obtain a solution that works in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-632"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">O</span><span class="MJXp-mo" id="MJXp-Span-634" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-635"><span class="MJXp-mn" id="MJXp-Span-636" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-637" style="vertical-align: 0.5em;">P</span></span><span class="MJXp-mo" id="MJXp-Span-638" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-94">O(2^P)</script> per query, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-639"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640">P</span></span></span><script type="math/tex" id="MathJax-Element-95">P</script> is the number of primes we are interested in (in this case, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-641"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642">P</span><span class="MJXp-mo" id="MJXp-Span-643" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-644">4</span></span></span><script type="math/tex" id="MathJax-Element-96">P = 4</script>).</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution 1 (BledDest)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">def</span><span class="pln"> good</span><span class="pun">(</span><span class="pln">x</span><span class="pun">):</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> x </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> x </span><span class="pun">%</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> x </span><span class="pun">%</span><span class="pln"> </span><span class="lit">5</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> x </span><span class="pun">%</span><span class="pln"> </span><span class="lit">7</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
 
</span><span class="kwd">def</span><span class="pln"> get_naive</span><span class="pun">(</span><span class="pln">x</span><span class="pun">):</span><span class="pln">
    ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">x</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> good</span><span class="pun">(</span><span class="pln">i</span><span class="pun">):</span><span class="pln">
            ans </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> ans
 
</span><span class="kwd">def</span><span class="pln"> </span><span class="kwd">get</span><span class="pun">(</span><span class="pln">r</span><span class="pun">):</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r </span><span class="com">// 210) * get_naive(210) + get_naive(r % 210)</span><span class="pln">
 
t </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">t</span><span class="pun">):</span><span class="pln">
    l</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">=</span><span class="pln"> map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">())</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(</span><span class="kwd">get</span><span class="pun">(</span><span class="pln">r</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="kwd">get</span><span class="pun">(</span><span class="pln">l</span><span class="pun">))</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Solution 2 (awoo)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())):</span><span class="pln">
    l</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">=</span><span class="pln"> map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">())</span><span class="pln">
 
    </span><span class="kwd">def</span><span class="pln"> f</span><span class="pun">(</span><span class="pln">x</span><span class="pun">):</span><span class="pln">
        res </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
        ps </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">,</span><span class="pln"> </span><span class="lit">5</span><span class="pun">,</span><span class="pln"> </span><span class="lit">7</span><span class="pun">]</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> mask </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">16</span><span class="pun">):</span><span class="pln">
            m </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            sg </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">4</span><span class="pun">):</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">mask </span><span class="pun">&gt;&gt;</span><span class="pln"> i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">:</span><span class="pln">
                    m </span><span class="pun">*=</span><span class="pln"> ps</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln">
                    sg </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="pln">sg
            res </span><span class="pun">+=</span><span class="pln"> sg </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="com">// m)</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> res
    
    </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">f</span><span class="pun">(</span><span class="pln">r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> f</span><span class="pun">(</span><span class="pln">l </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">))</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2125/problem/D" title="Educational Codeforces Round 181 (Rated for Div. 2)">2125D - Segments Covering</a></p><p>Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/BledDest" title="International Grandmaster BledDest">BledDest</a></p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2125/problem/D" title="Educational Codeforces Round 181 (Rated for Div. 2)">2125D - Segments Covering</a></h3><div class="ttypography"><div class="problem-statement"><div><p>There are two ways to solve this problem, both based on dynamic programming.</p><p>The first approach is to calculate a dynamic programming of the form <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-645"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-646">d</span><span class="MJXp-msubsup" id="MJXp-Span-647"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-649" style="vertical-align: -0.4em;">x</span></span></span></span><script type="math/tex" id="MathJax-Element-97">dp_x</script> — the probability that all cells from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-650"><span class="MJXp-mn" id="MJXp-Span-651">1</span></span></span><script type="math/tex" id="MathJax-Element-98">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-652"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653">x</span></span></span><script type="math/tex" id="MathJax-Element-99">x</script> are covered exactly once. The base case for the dynamic programming is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-654"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655">d</span><span class="MJXp-msubsup" id="MJXp-Span-656"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-658" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-659" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-660">1</span></span></span><script type="math/tex" id="MathJax-Element-100">dp_0 = 1</script>. The transitions are as follows: to compute <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-661"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-662">d</span><span class="MJXp-msubsup" id="MJXp-Span-663"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-665" style="vertical-align: -0.4em;">x</span></span></span></span><script type="math/tex" id="MathJax-Element-101">dp_x</script>, we need to iterate over all segments <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-666"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">i</span></span></span><script type="math/tex" id="MathJax-Element-102">i</script> that end at <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-668"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669">x</span></span></span><script type="math/tex" id="MathJax-Element-103">x</script> (i.e., segments <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-670"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-671">i</span></span></span><script type="math/tex" id="MathJax-Element-104">i</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-672"><span class="MJXp-msubsup" id="MJXp-Span-673"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-674" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-675" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-676" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677">x</span></span></span><script type="math/tex" id="MathJax-Element-105">r_i = x</script>; these can be pre-stored in a cell numbered <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-678"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-679">x</span></span></span><script type="math/tex" id="MathJax-Element-106">x</script>), and for each such segment, we increase <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-680"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681">d</span><span class="MJXp-msubsup" id="MJXp-Span-682"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-684" style="vertical-align: -0.4em;">x</span></span></span></span><script type="math/tex" id="MathJax-Element-107">dp_x</script> by the probability that the following three conditions are met:</p><ul> <li> we covered everything up to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-685"><span class="MJXp-msubsup" id="MJXp-Span-686"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-687" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-688" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-689" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-690">1</span></span></span><script type="math/tex" id="MathJax-Element-108">l_i - 1</script> exactly once (this is simply <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-691"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">d</span><span class="MJXp-msubsup" id="MJXp-Span-693"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-695" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-696"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-698" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-699">−</span><span class="MJXp-mn" id="MJXp-Span-700">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-109">dp_{l_i - 1}</script>); </li><li> segment <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-701"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-702">i</span></span></span><script type="math/tex" id="MathJax-Element-110">i</script> exists (this is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-703"><span class="MJXp-mfrac" id="MJXp-Span-704" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-705"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-706" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-707" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-708"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709" style="margin-right: 0.05em;">q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-710" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-111">\frac{p_i}{q_i}</script>); </li><li> we did not cover any cells from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-711"><span class="MJXp-msubsup" id="MJXp-Span-712"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-713" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-714" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-112">l_i</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-715"><span class="MJXp-msubsup" id="MJXp-Span-716"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-718" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-113">r_i</script> with other segments. The probability of this can be calculated as follows: all segments covering cells from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-719"><span class="MJXp-msubsup" id="MJXp-Span-720"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-722" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-114">l_i</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-723"><span class="MJXp-msubsup" id="MJXp-Span-724"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-725" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-726" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-115">r_i</script> are divided into two groups: segments that start before <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-727"><span class="MJXp-msubsup" id="MJXp-Span-728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-730" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-116">l_i</script> but end in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-731"><span class="MJXp-mo" id="MJXp-Span-732" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-733"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-734" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-735" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-736" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-737">m</span><span class="MJXp-mo" id="MJXp-Span-738" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-117">[l_i, m]</script>, and segments that start in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-739"><span class="MJXp-mo" id="MJXp-Span-740" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-741"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-743" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-744" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-745"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-746" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-747" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-748" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-118">[l_i, r_i]</script>. For segments of the first group, we already know that they do not exist, since all cells up to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-749"><span class="MJXp-msubsup" id="MJXp-Span-750"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-751" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-752" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-753" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-754">1</span></span></span><script type="math/tex" id="MathJax-Element-119">l_i - 1</script> are covered exactly once (otherwise, cell <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-755"><span class="MJXp-msubsup" id="MJXp-Span-756"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-758" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-759" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-760">1</span></span></span><script type="math/tex" id="MathJax-Element-120">l_i - 1</script> would be covered by at least two segments); for segments of the second group, we do not know anything yet, so we need to take the probability that none of them exist. To quickly calculate such a probability, we can form an array where the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-761"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-762">j</span></span></span><script type="math/tex" id="MathJax-Element-121">j</script>-th cell contains the probability that no segment starting at <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-763"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764">j</span></span></span><script type="math/tex" id="MathJax-Element-122">j</script> exists (i.e., the product <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-765"><span class="MJXp-mfrac" id="MJXp-Span-766" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-767"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-768" style="margin-right: 0.05em;">q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-769" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-770">−</span><span class="MJXp-msubsup" id="MJXp-Span-771"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-772" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-773" style="vertical-align: -0.4em;">k</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-774"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-775" style="margin-right: 0.05em;">q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-776" style="vertical-align: -0.4em;">k</span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-123">\frac{q_k - p_k}{q_k}</script> for all segments where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-777"><span class="MJXp-msubsup" id="MJXp-Span-778"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-780" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-781" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782">j</span></span></span><script type="math/tex" id="MathJax-Element-124">l_k = j</script>), and take the product over that segment of the array (this can be done using prefix products, similar to how sums over segments are calculated using prefix sums). </li></ul><p>The second solution is similar to the first but is significantly simpler to implement. We will consider the dynamic programming array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-783"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-784">d</span><span class="MJXp-msubsup" id="MJXp-Span-785"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786" style="margin-right: 0.05em;">p</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-788">′</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">x</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-125">dp'_x</script> — the probability that all cells from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-789"><span class="MJXp-mn" id="MJXp-Span-790">1</span></span></span><script type="math/tex" id="MathJax-Element-126">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-791"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">x</span></span></span><script type="math/tex" id="MathJax-Element-127">x</script> are covered exactly once, <span class="tex-font-style-bf">and none of the other cells are covered</span>. The base case for this dynamic programming is: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-793"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-794">d</span><span class="MJXp-msubsup" id="MJXp-Span-795"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-796" style="margin-right: 0.05em;">p</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-798">′</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-797">0</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-128">dp'_0</script> is equal to the probability that no segment exists (i.e., the product <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-799"><span class="MJXp-mfrac" id="MJXp-Span-800" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-801"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-802" style="margin-right: 0.05em;">q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-803" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-804">−</span><span class="MJXp-msubsup" id="MJXp-Span-805"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-806" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-807" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-808"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809" style="margin-right: 0.05em;">q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-810" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-129">\frac{q_i - p_i}{q_i}</script> for all segments). The transitions are as follows: to compute <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-811"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">d</span><span class="MJXp-msubsup" id="MJXp-Span-813"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814" style="margin-right: 0.05em;">p</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-816">′</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-815">x</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-130">dp'_x</script>, we need to iterate over all segments <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-817"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-818">i</span></span></span><script type="math/tex" id="MathJax-Element-131">i</script> that end at <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-819"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-820">x</span></span></span><script type="math/tex" id="MathJax-Element-132">x</script>, and for each of them, increase <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-821"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-822">d</span><span class="MJXp-msubsup" id="MJXp-Span-823"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-824" style="margin-right: 0.05em;">p</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-826">′</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-825">x</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-133">dp'_x</script> by the probability that all cells from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-827"><span class="MJXp-mn" id="MJXp-Span-828">1</span></span></span><script type="math/tex" id="MathJax-Element-134">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-829"><span class="MJXp-msubsup" id="MJXp-Span-830"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-831" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-832" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-833" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-834">1</span></span></span><script type="math/tex" id="MathJax-Element-135">l_i - 1</script> are covered exactly once, and that segment <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-835"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836">i</span></span></span><script type="math/tex" id="MathJax-Element-136">i</script> exists. At the first glance, this is equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-837"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-838">d</span><span class="MJXp-msubsup" id="MJXp-Span-839"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840" style="margin-right: 0.05em;">p</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-847">′</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-841"><span class="MJXp-msubsup" id="MJXp-Span-842"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-843" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-844" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-845">−</span><span class="MJXp-mn" id="MJXp-Span-846">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-848" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mfrac" id="MJXp-Span-849" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-850"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-851" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-852" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-853"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854" style="margin-right: 0.05em;">q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-855" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-137">dp'_{l_i - 1} \cdot \frac{p_i}{q_i}</script>; however, this expression <span class="tex-font-style-bf">needs to be divided by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-856"><span class="MJXp-mfrac" id="MJXp-Span-857" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-858"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-859" style="margin-right: 0.05em;">q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-860" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-861">−</span><span class="MJXp-msubsup" id="MJXp-Span-862"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-864" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-865"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866" style="margin-right: 0.05em;">q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-867" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-138">\frac{q_i - p_i}{q_i}</script></span>, since in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-868"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-869">d</span><span class="MJXp-msubsup" id="MJXp-Span-870"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871" style="margin-right: 0.05em;">p</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-878">′</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-872"><span class="MJXp-msubsup" id="MJXp-Span-873"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-875" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-876">−</span><span class="MJXp-mn" id="MJXp-Span-877">1</span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-139">dp'_{l_i - 1}</script> it is assumed that this segment does not exist. This solution does not require any prefix products (unlike the first solution), so it is easier to code.</p><p>Finally, let's talk about how to work with fractions modulo <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-879"><span class="MJXp-mn" id="MJXp-Span-880">998244353</span></span></span><script type="math/tex" id="MathJax-Element-140">998244353</script> (I will refer to this number as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-881"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">M</span></span></span><script type="math/tex" id="MathJax-Element-141">M</script>). This is a prime number, so every integer from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-883"><span class="MJXp-mn" id="MJXp-Span-884">1</span></span></span><script type="math/tex" id="MathJax-Element-142">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-885"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-886">M</span><span class="MJXp-mo" id="MJXp-Span-887" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-888">1</span></span></span><script type="math/tex" id="MathJax-Element-143">M-1</script> has an inverse element modulo this number. To find it, one can either use the extended Euclidean algorithm, or raise the number to the power of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-889"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">M</span><span class="MJXp-mo" id="MJXp-Span-891" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-892">2</span></span></span><script type="math/tex" id="MathJax-Element-144">M-2</script> using binary exponentiation (for a prime <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-893"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">M</span></span></span><script type="math/tex" id="MathJax-Element-145">M</script> and each number <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-895"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896">x</span></span></span><script type="math/tex" id="MathJax-Element-146">x</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-897"><span class="MJXp-mn" id="MJXp-Span-898">1</span></span></span><script type="math/tex" id="MathJax-Element-147">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-899"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-900">M</span><span class="MJXp-mo" id="MJXp-Span-901" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-902">1</span></span></span><script type="math/tex" id="MathJax-Element-148">M-1</script>, the equality <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-903"><span class="MJXp-msubsup" id="MJXp-Span-904"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-905" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-906" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907">M</span><span class="MJXp-mo" id="MJXp-Span-908">−</span><span class="MJXp-mn" id="MJXp-Span-909">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-910" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911">M</span><span class="MJXp-mo" id="MJXp-Span-912" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-913">1</span></span></span><script type="math/tex" id="MathJax-Element-149">x^{M-1} \bmod M = 1</script> holds, so the inverse element for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-914"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">x</span></span></span><script type="math/tex" id="MathJax-Element-150">x</script> will be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-916"><span class="MJXp-msubsup" id="MJXp-Span-917"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-918" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-919" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-920">M</span><span class="MJXp-mo" id="MJXp-Span-921">−</span><span class="MJXp-mn" id="MJXp-Span-922">2</span></span></span></span></span><script type="math/tex" id="MathJax-Element-151">x^{M-2}</script>). Each fraction of the form <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-923"><span class="MJXp-mfrac" id="MJXp-Span-924" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">x</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">y</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-152">\frac{x}{y}</script> can simply be treated as the number <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">x</span><span class="MJXp-mo" id="MJXp-Span-929" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-930"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-931" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-932" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-933">−</span><span class="MJXp-mn" id="MJXp-Span-934">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-935" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-936">M</span></span></span><script type="math/tex" id="MathJax-Element-153">x \cdot y^{-1} \bmod M</script>, and when adding fractions, one can simply add the corresponding numbers without worrying about reducing fractions, finding a common denominator, and similar issues. In the first solution using prefix products, we will have to divide by some precomputed number to obtain the product over a segment — for this, it is sufficient to find its inverse element and multiply by it.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution 1 (Neon)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
 
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">using</span><span class="pln"> pt </span><span class="pun">=</span><span class="pln"> pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;;</span><span class="pln">
 
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MOD </span><span class="pun">=</span><span class="pln"> </span><span class="lit">998244353</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
   x </span><span class="pun">+=</span><span class="pln"> y</span><span class="pun">;</span><span class="pln">
   </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">&gt;=</span><span class="pln"> MOD</span><span class="pun">)</span><span class="pln"> x </span><span class="pun">-=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
   </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> x </span><span class="pun">+=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
   </span><span class="kwd">return</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> mul</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> x </span><span class="pun">*</span><span class="pln"> </span><span class="lit">1LL</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> y </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> binpow</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">int</span><span class="pln"> z </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> z </span><span class="pun">=</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">z</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">);</span><span class="pln">
    x </span><span class="pun">=</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">);</span><span class="pln">
    y </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> z</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> divide</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> binpow</span><span class="pun">(</span><span class="pln">y</span><span class="pun">,</span><span class="pln"> MOD </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">));</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln"> cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
  </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">
  cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">
  vector</span><span class="pun">&lt;</span><span class="pln">vector</span><span class="str">&lt;pt&gt;</span><span class="pun">&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">m </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> l </span><span class="pun">&gt;&gt;</span><span class="pln"> r </span><span class="pun">&gt;&gt;</span><span class="pln"> p </span><span class="pun">&gt;&gt;</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
    a</span><span class="pun">[</span><span class="pln">r</span><span class="pun">].</span><span class="pln">emplace_back</span><span class="pun">(</span><span class="pln">l </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> divide</span><span class="pun">(</span><span class="pln">p</span><span class="pun">,</span><span class="pln"> q</span><span class="pun">));</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  vector</span><span class="str">&lt;int&gt;</span><span class="pln"> pr</span><span class="pun">(</span><span class="pln">m </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
  pr</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> m</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> cur </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">_</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> cur </span><span class="pun">=</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">cur</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="pln">p</span><span class="pun">));</span><span class="pln">
    pr</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">pr</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">],</span><span class="pln"> cur</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  vector</span><span class="str">&lt;int&gt;</span><span class="pln"> dp</span><span class="pun">(</span><span class="pln">m </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
  dp</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> m</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> 
      </span><span class="kwd">int</span><span class="pln"> cur </span><span class="pun">=</span><span class="pln"> divide</span><span class="pun">(</span><span class="pln">pr</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> pr</span><span class="pun">[</span><span class="pln">l</span><span class="pun">]);</span><span class="pln">
      cur </span><span class="pun">=</span><span class="pln"> divide</span><span class="pun">(</span><span class="pln">cur</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="pln">p</span><span class="pun">));</span><span class="pln">
      cur </span><span class="pun">=</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">cur</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">);</span><span class="pln">
      dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">l</span><span class="pun">],</span><span class="pln"> cur</span><span class="pun">));</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  cout </span><span class="pun">&lt;&lt;</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">m</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">  
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Solution 2 (Neon)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
 
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">using</span><span class="pln"> pt </span><span class="pun">=</span><span class="pln"> pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;;</span><span class="pln">
 
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MOD </span><span class="pun">=</span><span class="pln"> </span><span class="lit">998244353</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
     x </span><span class="pun">+=</span><span class="pln"> y</span><span class="pun">;</span><span class="pln">
     </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">&gt;=</span><span class="pln"> MOD</span><span class="pun">)</span><span class="pln"> x </span><span class="pun">-=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
     </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> x </span><span class="pun">+=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
     </span><span class="kwd">return</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> mul</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> x </span><span class="pun">*</span><span class="pln"> </span><span class="lit">1LL</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> y </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> binpow</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> z </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">y </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> z </span><span class="pun">=</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">z</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">);</span><span class="pln">
        x </span><span class="pun">=</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">);</span><span class="pln">
        y </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> z</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> divide</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> binpow</span><span class="pun">(</span><span class="pln">y</span><span class="pun">,</span><span class="pln"> MOD </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">));</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln"> cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">
    vector</span><span class="pun">&lt;</span><span class="pln">vector</span><span class="str">&lt;pt&gt;</span><span class="pun">&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">m </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> dp</span><span class="pun">(</span><span class="pln">m </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    dp</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> l </span><span class="pun">&gt;&gt;</span><span class="pln"> r </span><span class="pun">&gt;&gt;</span><span class="pln"> p </span><span class="pun">&gt;&gt;</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> val </span><span class="pun">=</span><span class="pln"> divide</span><span class="pun">(</span><span class="pln">p</span><span class="pun">,</span><span class="pln"> q</span><span class="pun">);</span><span class="pln">
        a</span><span class="pun">[</span><span class="pln">r</span><span class="pun">].</span><span class="pln">emplace_back</span><span class="pun">(</span><span class="pln">l </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> val</span><span class="pun">);</span><span class="pln">
        dp</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="pln">val</span><span class="pun">));</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> m</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> 
            </span><span class="kwd">int</span><span class="pln"> cur </span><span class="pun">=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">l</span><span class="pun">];</span><span class="pln">
            cur </span><span class="pun">=</span><span class="pln"> divide</span><span class="pun">(</span><span class="pln">cur</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="pln">p</span><span class="pun">));</span><span class="pln">
            cur </span><span class="pun">=</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">cur</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">);</span><span class="pln">
            dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> cur</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">m</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">  
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2125/problem/E" title="Educational Codeforces Round 181 (Rated for Div. 2)">2125E - Sets of Complementary Sums</a></p><p>Idea: <a class="rated-user user-orange" href="https://codeforces.com/profile/FelixArg" title="Master FelixArg">FelixArg</a></p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2125/problem/E" title="Educational Codeforces Round 181 (Rated for Div. 2)">2125E - Sets of Complementary Sums</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Let's first understand the following: what sets <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-937"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938">Q</span></span></span><script type="math/tex" id="MathJax-Element-154">Q</script> can be obtained from some arrays <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-939"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940">a</span></span></span><script type="math/tex" id="MathJax-Element-155">a</script> using the operations described in the problem statement.</p><p>To do this, let's take an arbitrary set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-941"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942">Q</span></span></span><script type="math/tex" id="MathJax-Element-156">Q</script> and try to reconstruct any array from it. We know that the initial sum <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-943"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-944">s</span></span></span><script type="math/tex" id="MathJax-Element-157">s</script> is at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-945"><span class="MJXp-mo" id="MJXp-Span-946" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-947" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948">Q</span><span class="MJXp-mo" id="MJXp-Span-949" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-950" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-951">1</span></span></span><script type="math/tex" id="MathJax-Element-158">\max(Q) + 1</script>, because otherwise there would be a number <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-952"><span class="MJXp-mo" id="MJXp-Span-953" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-954">0</span></span></span><script type="math/tex" id="MathJax-Element-159">\le 0</script> in the array.</p><p>Let's try to reconstruct some array with a sum exactly equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-955"><span class="MJXp-mo" id="MJXp-Span-956" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-957" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-958">Q</span><span class="MJXp-mo" id="MJXp-Span-959" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-960" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-961">1</span></span></span><script type="math/tex" id="MathJax-Element-160">\max(Q) + 1</script>. We will create an empty array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-962"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-963">a</span></span></span><script type="math/tex" id="MathJax-Element-161">a</script> and then iterate through the elements of the set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-964"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965">Q</span></span></span><script type="math/tex" id="MathJax-Element-162">Q</script>, adding to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-966"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967">a</span></span></span><script type="math/tex" id="MathJax-Element-163">a</script> the numbers <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-968"><span class="MJXp-mo" id="MJXp-Span-969" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-970" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-971">Q</span><span class="MJXp-mo" id="MJXp-Span-972" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-973" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-974">1</span><span class="MJXp-mo" id="MJXp-Span-975" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-976">x</span></span></span><script type="math/tex" id="MathJax-Element-164">\max(Q) + 1 - x</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-977"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-978">x</span><span class="MJXp-mo" id="MJXp-Span-979" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">Q</span></span></span><script type="math/tex" id="MathJax-Element-165">x \in Q</script>. Okay, now let's calculate the sum of all elements in our <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-981"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982">a</span></span></span><script type="math/tex" id="MathJax-Element-166">a</script>, and there can be three scenarios:</p><ol> <li> The sum equals the initial <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-983"><span class="MJXp-mo" id="MJXp-Span-984" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-985" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986">Q</span><span class="MJXp-mo" id="MJXp-Span-987" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-988" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-989">1</span></span></span><script type="math/tex" id="MathJax-Element-167">\max(Q) + 1</script>; in this case, nothing needs to be done. </li><li> The sum is less than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-990"><span class="MJXp-mo" id="MJXp-Span-991" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-992" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-993">Q</span><span class="MJXp-mo" id="MJXp-Span-994" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-995" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-996">1</span></span></span><script type="math/tex" id="MathJax-Element-168">\max(Q) + 1</script>; in this case, we need to add several copies of some number from those currently in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-997"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998">a</span></span></span><script type="math/tex" id="MathJax-Element-169">a</script>. </li><li> The sum is greater than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-999"><span class="MJXp-mo" id="MJXp-Span-1000" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1001" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002">Q</span><span class="MJXp-mo" id="MJXp-Span-1003" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1004" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1005">1</span></span></span><script type="math/tex" id="MathJax-Element-170">\max(Q) + 1</script>; in this case, the original set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1006"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007">Q</span></span></span><script type="math/tex" id="MathJax-Element-171">Q</script> cannot be obtained using the operations described in the problem statement. </li></ol><p>For point two, it's easy: we notice that our <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1008"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">a</span></span></span><script type="math/tex" id="MathJax-Element-172">a</script> contains the number <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1010"><span class="MJXp-mn" id="MJXp-Span-1011">1</span></span></span><script type="math/tex" id="MathJax-Element-173">1</script>, so we can always make the sum of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1012"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1013">a</span></span></span><script type="math/tex" id="MathJax-Element-174">a</script> equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1014"><span class="MJXp-mo" id="MJXp-Span-1015" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1016" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">Q</span><span class="MJXp-mo" id="MJXp-Span-1018" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1019" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1020">1</span></span></span><script type="math/tex" id="MathJax-Element-175">\max(Q) + 1</script> simply by adding several ones.</p><p>Now let's consider the third point: we were unable to create the array, assuming its sum is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1021"><span class="MJXp-mo" id="MJXp-Span-1022" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1023" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024">Q</span><span class="MJXp-mo" id="MJXp-Span-1025" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1026" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1027">1</span></span></span><script type="math/tex" id="MathJax-Element-176">\max(Q) + 1</script>, but could the initial sum have been greater? Let's try to assume that the initial sum was <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1028"><span class="MJXp-mo" id="MJXp-Span-1029" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1030" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031">Q</span><span class="MJXp-mo" id="MJXp-Span-1032" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1033" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1034">2</span></span></span><script type="math/tex" id="MathJax-Element-177">\max(Q) + 2</script>; however, we will again arrive at this third point. Let's try <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1035"><span class="MJXp-mo" id="MJXp-Span-1036" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1037" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1038">Q</span><span class="MJXp-mo" id="MJXp-Span-1039" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1040" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1041">3</span></span></span><script type="math/tex" id="MathJax-Element-178">\max(Q) + 3</script>, and it won't work either, nor will any subsequent value. Why is that?</p><p>Let's express the sum of our current <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1042"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043">a</span></span></span><script type="math/tex" id="MathJax-Element-179">a</script> under the assumption that it is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1044"><span class="MJXp-mo" id="MJXp-Span-1045" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1046" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047">Q</span><span class="MJXp-mo" id="MJXp-Span-1048" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1049" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1050">1</span></span></span><script type="math/tex" id="MathJax-Element-180">\max(Q) + 1</script> in a more mathematical form:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1051"><span class="MJXp-munderover" id="MJXp-Span-1052"><span class=""><span class="MJXp-mo" id="MJXp-Span-1053" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1054" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1055">y</span><span class="MJXp-mo" id="MJXp-Span-1056">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057">Q</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1058" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1059" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1060" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061">Q</span><span class="MJXp-mo" id="MJXp-Span-1062" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1063" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1064">1</span><span class="MJXp-mo" id="MJXp-Span-1065" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1066">y</span><span class="MJXp-mo" id="MJXp-Span-1067" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1068" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1069" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1070" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1071" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1072">Q</span><span class="MJXp-mo" id="MJXp-Span-1073" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1074" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1075">1</span><span class="MJXp-mo" id="MJXp-Span-1076" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1077" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mrow" id="MJXp-Span-1078"><span class="MJXp-mo" id="MJXp-Span-1079" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1080">Q</span><span class="MJXp-mrow" id="MJXp-Span-1081"><span class="MJXp-mo" id="MJXp-Span-1082" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1083" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-munderover" id="MJXp-Span-1084"><span class=""><span class="MJXp-mo" id="MJXp-Span-1085" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1086" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1087">y</span><span class="MJXp-mo" id="MJXp-Span-1088">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1089">Q</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090">y</span></span></span><script type="math/tex; mode=display" id="MathJax-Element-181">\sum_{y \in Q} (\max(Q) + 1 - y) = (\max(Q) + 1) \cdot |Q| - \sum_{y \in Q} y</script></p><p>Now let's write the sum if the assumption was <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1091"><span class="MJXp-mo" id="MJXp-Span-1092" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1093" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094">Q</span><span class="MJXp-mo" id="MJXp-Span-1095" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1096" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1097">2</span></span></span><script type="math/tex" id="MathJax-Element-182">\max(Q) + 2</script>:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1098"><span class="MJXp-mo" id="MJXp-Span-1099" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1100" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1101" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1102">Q</span><span class="MJXp-mo" id="MJXp-Span-1103" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1104" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1105">2</span><span class="MJXp-mo" id="MJXp-Span-1106" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1107" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mrow" id="MJXp-Span-1108"><span class="MJXp-mo" id="MJXp-Span-1109" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1110">Q</span><span class="MJXp-mrow" id="MJXp-Span-1111"><span class="MJXp-mo" id="MJXp-Span-1112" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1113" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-munderover" id="MJXp-Span-1114"><span class=""><span class="MJXp-mo" id="MJXp-Span-1115" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1116" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1117">y</span><span class="MJXp-mo" id="MJXp-Span-1118">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1119">Q</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120">y</span></span></span><script type="math/tex; mode=display" id="MathJax-Element-183">(\max(Q) + 2) \cdot |Q| - \sum_{y \in Q} y</script></p><p>Subtract one from the other:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1121"><span class="MJXp-mo" id="MJXp-Span-1122" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1123" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1124" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125">Q</span><span class="MJXp-mo" id="MJXp-Span-1126" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1127" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1128">2</span><span class="MJXp-mo" id="MJXp-Span-1129" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1130" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mrow" id="MJXp-Span-1131"><span class="MJXp-mo" id="MJXp-Span-1132" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133">Q</span><span class="MJXp-mrow" id="MJXp-Span-1134"><span class="MJXp-mo" id="MJXp-Span-1135" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1136" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-munderover" id="MJXp-Span-1137"><span class=""><span class="MJXp-mo" id="MJXp-Span-1138" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1139" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140">y</span><span class="MJXp-mo" id="MJXp-Span-1141">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142">Q</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1143">y</span><span class="MJXp-mo" id="MJXp-Span-1144" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-1145" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1146" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1147" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1148" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149">Q</span><span class="MJXp-mo" id="MJXp-Span-1150" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1151" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1152">1</span><span class="MJXp-mo" id="MJXp-Span-1153" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1154" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mrow" id="MJXp-Span-1155"><span class="MJXp-mo" id="MJXp-Span-1156" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1157">Q</span><span class="MJXp-mrow" id="MJXp-Span-1158"><span class="MJXp-mo" id="MJXp-Span-1159" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1160" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-munderover" id="MJXp-Span-1161"><span class=""><span class="MJXp-mo" id="MJXp-Span-1162" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1163" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1164">y</span><span class="MJXp-mo" id="MJXp-Span-1165">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1166">Q</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167">y</span><span class="MJXp-mo" id="MJXp-Span-1168" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1169" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1170" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1171" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1172" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1173">Q</span><span class="MJXp-mo" id="MJXp-Span-1174" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1175" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1176">2</span><span class="MJXp-mo" id="MJXp-Span-1177" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1178" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mrow" id="MJXp-Span-1179"><span class="MJXp-mo" id="MJXp-Span-1180" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1181">Q</span><span class="MJXp-mrow" id="MJXp-Span-1182"><span class="MJXp-mo" id="MJXp-Span-1183" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1184" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-1185" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1186" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1187" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1188">Q</span><span class="MJXp-mo" id="MJXp-Span-1189" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1190" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1191">1</span><span class="MJXp-mo" id="MJXp-Span-1192" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1193" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mrow" id="MJXp-Span-1194"><span class="MJXp-mo" id="MJXp-Span-1195" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1196">Q</span><span class="MJXp-mrow" id="MJXp-Span-1197"><span class="MJXp-mo" id="MJXp-Span-1198" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1199" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1200"><span class="MJXp-mo" id="MJXp-Span-1201" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1202">Q</span><span class="MJXp-mrow" id="MJXp-Span-1203"><span class="MJXp-mo" id="MJXp-Span-1204" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-184">(\max(Q) + 2) \cdot |Q| - \sum_{y \in Q} y - ((\max(Q) + 1) \cdot |Q| - \sum_{y \in Q} y) = (\max(Q) + 2) \cdot |Q| - (\max(Q) + 1) \cdot |Q| = |Q|</script></p><p>It turns out that when we increased our assumption by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1205"><span class="MJXp-mn" id="MJXp-Span-1206">1</span></span></span><script type="math/tex" id="MathJax-Element-185">1</script>, the sum increased by the size of the set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1208">Q</span></span></span><script type="math/tex" id="MathJax-Element-186">Q</script>, and since the size of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1209"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1210">Q</span></span></span><script type="math/tex" id="MathJax-Element-187">Q</script> is always at least one, we will never achieve equality between our assumption and the actual sum.</p><p>From this, we can conclude that for any set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1211"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1212">Q</span></span></span><script type="math/tex" id="MathJax-Element-188">Q</script>, a necessary and sufficient condition for it to be a <span class="tex-font-style-it">set of complementary sums</span> is:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1213"><span class="MJXp-mo" id="MJXp-Span-1214" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1215" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1216" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217">Q</span><span class="MJXp-mo" id="MJXp-Span-1218" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1219" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1220">1</span><span class="MJXp-mo" id="MJXp-Span-1221" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1222" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mrow" id="MJXp-Span-1223"><span class="MJXp-mo" id="MJXp-Span-1224" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1225">Q</span><span class="MJXp-mrow" id="MJXp-Span-1226"><span class="MJXp-mo" id="MJXp-Span-1227" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1228" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-munderover" id="MJXp-Span-1229"><span class=""><span class="MJXp-mo" id="MJXp-Span-1230" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1231" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232">y</span><span class="MJXp-mo" id="MJXp-Span-1233">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1234">Q</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1235">y</span><span class="MJXp-mo" id="MJXp-Span-1236" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mo" id="MJXp-Span-1237" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1238" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1239" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1240">Q</span><span class="MJXp-mo" id="MJXp-Span-1241" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1242" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1243">1</span><span class="MJXp-mo" id="MJXp-Span-1244" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex; mode=display" id="MathJax-Element-189">(\max(Q) + 1) \cdot |Q| - \sum_{y \in Q} y \le (\max(Q) + 1)</script></p><p>or in a slightly different form:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1245"><span class="MJXp-mo" id="MJXp-Span-1246" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1247" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1248" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1249">Q</span><span class="MJXp-mo" id="MJXp-Span-1250" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1251" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1252">1</span><span class="MJXp-mo" id="MJXp-Span-1253" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1254" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-1255" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1256"><span class="MJXp-mo" id="MJXp-Span-1257" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">Q</span><span class="MJXp-mrow" id="MJXp-Span-1259"><span class="MJXp-mo" id="MJXp-Span-1260" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1261" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1262">1</span><span class="MJXp-mo" id="MJXp-Span-1263" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1264" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-munderover" id="MJXp-Span-1265"><span class=""><span class="MJXp-mo" id="MJXp-Span-1266" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1267" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1268">y</span><span class="MJXp-mo" id="MJXp-Span-1269">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">Q</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271">y</span><span class="MJXp-mo" id="MJXp-Span-1272" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-1273">0</span><span class="MJXp-mspace" id="MJXp-Span-1274" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1275" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1276" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1277" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1278" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1279" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1280" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1281" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1282" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1283" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1284" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1285" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1286" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1287" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1288" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1289" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1290" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1291" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1292" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1293" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1294" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1295" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1296" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1297" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1298" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1299" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mspace" id="MJXp-Span-1300" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1301" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1302">1</span><span class="MJXp-mo" id="MJXp-Span-1303" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex; mode=display" id="MathJax-Element-190">(\max(Q) + 1) \cdot (|Q| - 1) - \sum_{y \in Q} y \le 0\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;(1)</script></p><p>Now let's finally solve the problem itself. We would like to count such sets for which the above condition holds, and where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1304"><span class="MJXp-mrow" id="MJXp-Span-1305"><span class="MJXp-mo" id="MJXp-Span-1306" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307">Q</span><span class="MJXp-mrow" id="MJXp-Span-1308"><span class="MJXp-mo" id="MJXp-Span-1309" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1310" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1311">n</span></span></span><script type="math/tex" id="MathJax-Element-191">|Q| = n</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1312"><span class="MJXp-mo" id="MJXp-Span-1313" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1314" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1315">Q</span><span class="MJXp-mo" id="MJXp-Span-1316" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1317" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1318">x</span></span></span><script type="math/tex" id="MathJax-Element-192">\max(Q) \le x</script>.</p><p>To do this, we start with the set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1319"><span class="MJXp-mo" id="MJXp-Span-1320" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mn" id="MJXp-Span-1321">1</span><span class="MJXp-mo" id="MJXp-Span-1322" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1323">2</span><span class="MJXp-mo" id="MJXp-Span-1324" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1325" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1326" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1327" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1328" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1329">n</span><span class="MJXp-mo" id="MJXp-Span-1330" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><script type="math/tex" id="MathJax-Element-193">\{1, 2, ..., n\}</script>; from it, we can obtain other sets using one simple operation: adding <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1331"><span class="MJXp-mn" id="MJXp-Span-1332">1</span></span></span><script type="math/tex" id="MathJax-Element-194">1</script> to the suffix of the elements of the set.</p><p>For each such operation, we define <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1333"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334">f</span><span class="MJXp-mo" id="MJXp-Span-1335" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1336">i</span><span class="MJXp-mo" id="MJXp-Span-1337" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-195">f(i)</script> as the change in the sum on the left side of condition <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1338"><span class="MJXp-mo" id="MJXp-Span-1339" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1340">1</span><span class="MJXp-mo" id="MJXp-Span-1341" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-196">(1)</script> if we added <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1342"><span class="MJXp-mn" id="MJXp-Span-1343">1</span></span></span><script type="math/tex" id="MathJax-Element-197">1</script> to the suffix of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1344"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1345">i</span></span></span><script type="math/tex" id="MathJax-Element-198">i</script>. We can easily calculate all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347">f</span><span class="MJXp-mo" id="MJXp-Span-1348" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1349">i</span><span class="MJXp-mo" id="MJXp-Span-1350" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-199">f(i)</script>; they are equal to:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1351"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1352">f</span><span class="MJXp-mo" id="MJXp-Span-1353" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1354">1</span><span class="MJXp-mo" id="MJXp-Span-1355" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1356" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1357">n</span><span class="MJXp-mo" id="MJXp-Span-1358" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1359">2</span></span></span><script type="math/tex; mode=display" id="MathJax-Element-200">f(1) = n - 2</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1361">f</span><span class="MJXp-mo" id="MJXp-Span-1362" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1363">2</span><span class="MJXp-mo" id="MJXp-Span-1364" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1365" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366">n</span><span class="MJXp-mo" id="MJXp-Span-1367" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1368">3</span></span></span><script type="math/tex; mode=display" id="MathJax-Element-201">f(2) = n - 3</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1369"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1370">f</span><span class="MJXp-mo" id="MJXp-Span-1371" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1372">3</span><span class="MJXp-mo" id="MJXp-Span-1373" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1374" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1375">n</span><span class="MJXp-mo" id="MJXp-Span-1376" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1377">4</span></span></span><script type="math/tex; mode=display" id="MathJax-Element-202">f(3) = n - 4</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1378"><span class="MJXp-mo" id="MJXp-Span-1379" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex; mode=display" id="MathJax-Element-203">\dots</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1381">f</span><span class="MJXp-mo" id="MJXp-Span-1382" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383">n</span><span class="MJXp-mo" id="MJXp-Span-1384" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1385">1</span><span class="MJXp-mo" id="MJXp-Span-1386" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1387" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1388">0</span></span></span><script type="math/tex; mode=display" id="MathJax-Element-204">f(n - 1) = 0</script> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1389"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1390">f</span><span class="MJXp-mo" id="MJXp-Span-1391" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1392">n</span><span class="MJXp-mo" id="MJXp-Span-1393" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1394" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1395" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1396">1</span></span></span><script type="math/tex; mode=display" id="MathJax-Element-205">f(n) = -1</script></p><p>Notice that the only operation that decreases the left side of condition <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1397"><span class="MJXp-mo" id="MJXp-Span-1398" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1399">1</span><span class="MJXp-mo" id="MJXp-Span-1400" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-206">(1)</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1402">f</span><span class="MJXp-mo" id="MJXp-Span-1403" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404">n</span><span class="MJXp-mo" id="MJXp-Span-1405" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-207">f(n)</script>. This operation adds <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1406"><span class="MJXp-mn" id="MJXp-Span-1407">1</span></span></span><script type="math/tex" id="MathJax-Element-208">1</script> to all elements of the set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1409">Q</span></span></span><script type="math/tex" id="MathJax-Element-209">Q</script>.</p><p>So, we have the set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1410"><span class="MJXp-mo" id="MJXp-Span-1411" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mn" id="MJXp-Span-1412">1</span><span class="MJXp-mo" id="MJXp-Span-1413" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1414">2</span><span class="MJXp-mo" id="MJXp-Span-1415" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1416" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1417" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1418" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1419" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1420">n</span><span class="MJXp-mo" id="MJXp-Span-1421" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><script type="math/tex" id="MathJax-Element-210">\{1, 2, ..., n\}</script>; it may violate condition <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1422"><span class="MJXp-mo" id="MJXp-Span-1423" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1424">1</span><span class="MJXp-mo" id="MJXp-Span-1425" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-211">(1)</script>, and the only thing we can do is apply several operations of adding <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1426"><span class="MJXp-mn" id="MJXp-Span-1427">1</span></span></span><script type="math/tex" id="MathJax-Element-212">1</script> to all elements to satisfy equality in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1428"><span class="MJXp-mo" id="MJXp-Span-1429" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1430">1</span><span class="MJXp-mo" id="MJXp-Span-1431" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-213">(1)</script>. Let the number of such operations be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1432"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1434">t</span></span></span><script type="math/tex" id="MathJax-Element-214">st</script>.</p><p>Now let's perform some operations in such a way that this equality is maintained. Suppose we added <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1435"><span class="MJXp-mn" id="MJXp-Span-1436">1</span></span></span><script type="math/tex" id="MathJax-Element-215">1</script> to the suffix of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1437"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1438">j</span></span></span><script type="math/tex" id="MathJax-Element-216">j</script>; to maintain equality, we need to perform <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1440">f</span><span class="MJXp-mo" id="MJXp-Span-1441" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1442">j</span><span class="MJXp-mo" id="MJXp-Span-1443" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-217">f(j)</script> more additions of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1444"><span class="MJXp-mn" id="MJXp-Span-1445">1</span></span></span><script type="math/tex" id="MathJax-Element-218">1</script> to all of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1447">Q</span></span></span><script type="math/tex" id="MathJax-Element-219">Q</script>, while the maximum in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1449">Q</span></span></span><script type="math/tex" id="MathJax-Element-220">Q</script> increases by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1450"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451">f</span><span class="MJXp-mo" id="MJXp-Span-1452" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1453">j</span><span class="MJXp-mo" id="MJXp-Span-1454" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1455" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1456">1</span></span></span><script type="math/tex" id="MathJax-Element-221">f(j) + 1</script>.</p><p>All these considerations lead us to such an implementation: let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1457"><span class="MJXp-mtext" id="MJXp-Span-1458">dp</span><span class="MJXp-mo" id="MJXp-Span-1459" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1460">i</span><span class="MJXp-mo" id="MJXp-Span-1461" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-222">\text{dp}[i]</script> be the number of different <span class="tex-font-style-it">sets of complementary sums</span> such that the maximum in these sets equals <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1462"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1463">i</span></span></span><script type="math/tex" id="MathJax-Element-223">i</script> and equality in condition <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1464"><span class="MJXp-mo" id="MJXp-Span-1465" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1466">1</span><span class="MJXp-mo" id="MJXp-Span-1467" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-224">(1)</script> holds; the initial state is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1468"><span class="MJXp-mtext" id="MJXp-Span-1469">dp</span><span class="MJXp-mo" id="MJXp-Span-1470" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1471">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1472">t</span><span class="MJXp-mo" id="MJXp-Span-1473" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474">n</span><span class="MJXp-mo" id="MJXp-Span-1475" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1476" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1477">1</span></span></span><script type="math/tex" id="MathJax-Element-225">\text{dp}[st + n] = 1</script>.</p><p>We will recalculate this dynamic programming as in the knapsack problem. We can represent the operations of adding to the suffix of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1478"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1479">j</span></span></span><script type="math/tex" id="MathJax-Element-226">j</script> as an item with weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1480"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1481">f</span><span class="MJXp-mo" id="MJXp-Span-1482" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1483">j</span><span class="MJXp-mo" id="MJXp-Span-1484" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1485" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1486">1</span></span></span><script type="math/tex" id="MathJax-Element-227">f(j) + 1</script> that we put into the knapsack:</p><pre class="lstlisting"><code class="prettyprint prettyprinted" style=""><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><br><span class="pln">    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;</span><span class="pln"> x</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++){</span><br><span class="pln">        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> x</span><span class="pun">){</span><br><span class="pln">            dp</span><span class="pun">[</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">])</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><br><span class="pln">        </span><span class="pun">}</span><br><span class="pln">    </span><span class="pun">}</span><br><span class="pun">}</span><br></code></pre><p>Thus, we will count the <span class="tex-font-style-it">sets of complementary sums</span> for which the inequality <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1487"><span class="MJXp-mo" id="MJXp-Span-1488" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1489">1</span><span class="MJXp-mo" id="MJXp-Span-1490" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-228">(1)</script> holds; all others can be obtained from those counted by performing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1491"><span class="MJXp-mo" id="MJXp-Span-1492" style="margin-left: 0em; margin-right: 0.111em;">+</span><span class="MJXp-mn" id="MJXp-Span-1493">1</span></span></span><script type="math/tex" id="MathJax-Element-229">+1</script> operations on the entire set. Specifically, we need to make one more pass over the dynamic programming, effectively turning it into a prefix sum array:</p><pre class="lstlisting"><code class="prettyprint prettyprinted" style=""><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> x</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><br><span class="pln">    dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><br><span class="pun">}</span><br></code></pre><p>After this, the answer will simply be the sum of the entire array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1494"><span class="MJXp-mtext" id="MJXp-Span-1495">dp</span></span></span><script type="math/tex" id="MathJax-Element-230">\text{dp}</script>.</p><p>There remains one problem: the current solution works in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1496"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1497">O</span><span class="MJXp-mo" id="MJXp-Span-1498" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1499">n</span><span class="MJXp-mo" id="MJXp-Span-1500" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1501">x</span><span class="MJXp-mo" id="MJXp-Span-1502" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-231">O(n \cdot x)</script> and does not fit within the time limits.</p><p>To optimize our solution, let's take a closer look at this inequality <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1503"><span class="MJXp-mo" id="MJXp-Span-1504" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1505">1</span><span class="MJXp-mo" id="MJXp-Span-1506" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-232">(1)</script>. If the sum of all elements in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1507"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1508">Q</span></span></span><script type="math/tex" id="MathJax-Element-233">Q</script> is large, then theoretically <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1509"><span class="MJXp-mo" id="MJXp-Span-1510" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1511" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1512">Q</span><span class="MJXp-mo" id="MJXp-Span-1513" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-234">\max(Q)</script> is large and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1514"><span class="MJXp-mrow" id="MJXp-Span-1515"><span class="MJXp-mo" id="MJXp-Span-1516" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1517">Q</span><span class="MJXp-mrow" id="MJXp-Span-1518"><span class="MJXp-mo" id="MJXp-Span-1519" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex" id="MathJax-Element-235">|Q|</script> is also large. What is the maximum possible sum of the elements in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1520"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521">Q</span></span></span><script type="math/tex" id="MathJax-Element-236">Q</script>?</p><p>If we take <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1523">Q</span><span class="MJXp-mo" id="MJXp-Span-1524" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1525" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-mo" id="MJXp-Span-1526" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1527" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1528">Q</span><span class="MJXp-mo" id="MJXp-Span-1529" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1530" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1531">n</span><span class="MJXp-mo" id="MJXp-Span-1532" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1533">1</span><span class="MJXp-mo" id="MJXp-Span-1534" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1535" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1536" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537">Q</span><span class="MJXp-mo" id="MJXp-Span-1538" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1539" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1540">n</span><span class="MJXp-mo" id="MJXp-Span-1541" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1542">2</span><span class="MJXp-mo" id="MJXp-Span-1543" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1544" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1545" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1546" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1547" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548">Q</span><span class="MJXp-mo" id="MJXp-Span-1549" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1550" style="margin-left: 0em; margin-right: 0em;">}</span></span></span><script type="math/tex" id="MathJax-Element-237">Q = \{\max(Q) - n + 1, \max(Q) - n + 2, \dots, \max(Q)\}</script>, we can easily derive the formula:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1551"><span class="MJXp-mo" id="MJXp-Span-1552" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-munderover" id="MJXp-Span-1553"><span class=""><span class="MJXp-mo" id="MJXp-Span-1554" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1555" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1556">y</span><span class="MJXp-mo" id="MJXp-Span-1557">∈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1558">Q</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1559">y</span><span class="MJXp-mo" id="MJXp-Span-1560" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1561" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1562" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1563">Q</span><span class="MJXp-mo" id="MJXp-Span-1564" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1565" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mrow" id="MJXp-Span-1566"><span class="MJXp-mo" id="MJXp-Span-1567" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1568">Q</span><span class="MJXp-mrow" id="MJXp-Span-1569"><span class="MJXp-mo" id="MJXp-Span-1570" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1571" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-1572" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1573"><span class="MJXp-mo" id="MJXp-Span-1574" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575">Q</span><span class="MJXp-mrow" id="MJXp-Span-1576"><span class="MJXp-mo" id="MJXp-Span-1577" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1578" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-1579" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1580"><span class="MJXp-mo" id="MJXp-Span-1581" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1582">Q</span><span class="MJXp-mrow" id="MJXp-Span-1583"><span class="MJXp-mo" id="MJXp-Span-1584" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1585" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1586">1</span><span class="MJXp-mo" id="MJXp-Span-1587" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1588">2</span></span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-238">\max \sum_{y \in Q} y = \max(Q) \cdot |Q| - \frac{|Q| \cdot (|Q| - 1)}{2}</script></p><p>Substituting into condition <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1589"><span class="MJXp-mo" id="MJXp-Span-1590" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1591">1</span><span class="MJXp-mo" id="MJXp-Span-1592" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-239">(1)</script>:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1593"><span class="MJXp-mo" id="MJXp-Span-1594" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1595" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1596" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1597">Q</span><span class="MJXp-mo" id="MJXp-Span-1598" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1599" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1600">1</span><span class="MJXp-mo" id="MJXp-Span-1601" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1602" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-1603" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1604"><span class="MJXp-mo" id="MJXp-Span-1605" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1606">Q</span><span class="MJXp-mrow" id="MJXp-Span-1607"><span class="MJXp-mo" id="MJXp-Span-1608" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1609" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1610">1</span><span class="MJXp-mo" id="MJXp-Span-1611" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1612" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-1613" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1614" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1615">Q</span><span class="MJXp-mo" id="MJXp-Span-1616" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1617" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mrow" id="MJXp-Span-1618"><span class="MJXp-mo" id="MJXp-Span-1619" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1620">Q</span><span class="MJXp-mrow" id="MJXp-Span-1621"><span class="MJXp-mo" id="MJXp-Span-1622" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1623" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-1624" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1625"><span class="MJXp-mo" id="MJXp-Span-1626" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1627">Q</span><span class="MJXp-mrow" id="MJXp-Span-1628"><span class="MJXp-mo" id="MJXp-Span-1629" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1630" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-1631" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1632"><span class="MJXp-mo" id="MJXp-Span-1633" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1634">Q</span><span class="MJXp-mrow" id="MJXp-Span-1635"><span class="MJXp-mo" id="MJXp-Span-1636" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1637" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1638">1</span><span class="MJXp-mo" id="MJXp-Span-1639" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1640">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1641" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-1642">0</span></span></span><script type="math/tex; mode=display" id="MathJax-Element-240">(\max(Q) + 1) \cdot (|Q| - 1) - \max(Q) \cdot |Q| + \frac{|Q| \cdot (|Q| - 1)}{2} \le 0</script></p><p>From here, we can express the relationship:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1643"><span class="MJXp-mo" id="MJXp-Span-1644" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1645" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1646">Q</span><span class="MJXp-mo" id="MJXp-Span-1647" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1648" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mfrac" id="MJXp-Span-1649" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1650"><span class="MJXp-mo" id="MJXp-Span-1651" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1652">Q</span><span class="MJXp-mrow" id="MJXp-Span-1653"><span class="MJXp-mo" id="MJXp-Span-1654" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1655" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-1656" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1657"><span class="MJXp-mo" id="MJXp-Span-1658" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1659">Q</span><span class="MJXp-mrow" id="MJXp-Span-1660"><span class="MJXp-mo" id="MJXp-Span-1661" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1662" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1663">1</span><span class="MJXp-mo" id="MJXp-Span-1664" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1665">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1666" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-1667"><span class="MJXp-mo" id="MJXp-Span-1668" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1669">Q</span><span class="MJXp-mrow" id="MJXp-Span-1670"><span class="MJXp-mo" id="MJXp-Span-1671" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1672" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1673">1</span></span></span><script type="math/tex; mode=display" id="MathJax-Element-241">\max(Q) \ge \frac{|Q| \cdot (|Q| - 1)}{2} + |Q| - 1</script></p><p>From this, we see that the maximum in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1674"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1675">Q</span></span></span><script type="math/tex" id="MathJax-Element-242">Q</script> depends on the square of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1676"><span class="MJXp-mrow" id="MJXp-Span-1677"><span class="MJXp-mo" id="MJXp-Span-1678" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1679">Q</span><span class="MJXp-mrow" id="MJXp-Span-1680"><span class="MJXp-mo" id="MJXp-Span-1681" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex" id="MathJax-Element-243">|Q|</script>, which means that for large <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1682"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1683">n</span></span></span><script type="math/tex" id="MathJax-Element-244">n</script>, the answer is always <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1684"><span class="MJXp-mn" id="MJXp-Span-1685">0</span></span></span><script type="math/tex" id="MathJax-Element-245">0</script>. In other cases, we can compute our dynamic programming in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1686"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1687">O</span><span class="MJXp-mo" id="MJXp-Span-1688" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1689">x</span><span class="MJXp-mo" id="MJXp-Span-1690" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msqrt" id="MJXp-Span-1691"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1692">x</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1693" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-246">O(x \cdot \sqrt{x})</script>.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution (FelixArg)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">
 
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MOD </span><span class="pun">=</span><span class="pln"> </span><span class="lit">998</span><span class="str">'244'</span><span class="lit">353</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
    </span><span class="com">// need sum(mx + 1 - ai) &lt;= mx + 1</span><span class="pln">
    </span><span class="com">// start with 1, 2, 3, ... n</span><span class="pln">
    </span><span class="com">// min sum + 1 is n + 1</span><span class="pln">
 
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> x </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
    </span><span class="kwd">int</span><span class="pln"> s_cur </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> need </span><span class="pun">=</span><span class="pln"> s_cur </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
 
    </span><span class="com">// leads to n is O(sqrt(s))</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> need </span><span class="pun">&gt;</span><span class="pln"> x</span><span class="pun">){</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
    </span><span class="com">// so we can do dp[sum] knapsack</span><span class="pln">
 
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> dp</span><span class="pun">(</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    dp</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
 
    </span><span class="com">// for -1 and 0</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++){</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> x</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
            dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;</span><span class="pln"> x</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++){</span><span class="pln">
            </span><span class="com">// increase sum by i -&gt; mx increase by 1 + i</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> x</span><span class="pun">){</span><span class="pln">
                dp</span><span class="pun">[</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">])</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
    </span><span class="kwd">int</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> x</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> cur </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">+</span><span class="pln"> need </span><span class="pun">+</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cur </span><span class="pun">&gt;</span><span class="pln"> x</span><span class="pun">){</span><span class="pln">
            </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        ans </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ans </span><span class="pun">+</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
</span><span class="com">#ifdef</span><span class="pln"> FELIX
    </span><span class="kwd">auto</span><span class="pln"> _clock_start </span><span class="pun">=</span><span class="pln"> chrono</span><span class="pun">::</span><span class="pln">high_resolution_clock</span><span class="pun">::</span><span class="pln">now</span><span class="pun">();</span><span class="pln">
</span><span class="com">#endif</span><span class="pln">
    ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    cout</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
 
    </span><span class="kwd">int</span><span class="pln"> t </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--){</span><span class="pln">
        solve</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
</span><span class="com">#ifdef</span><span class="pln"> FELIX
    cerr </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"Executed in "</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> chrono</span><span class="pun">::</span><span class="pln">duration_cast</span><span class="pun">&lt;</span><span class="pln">chrono</span><span class="pun">::</span><span class="pln">milliseconds</span><span class="pun">&gt;(</span><span class="pln">
        chrono</span><span class="pun">::</span><span class="pln">high_resolution_clock</span><span class="pun">::</span><span class="pln">now</span><span class="pun">()</span><span class="pln">
            </span><span class="pun">-</span><span class="pln"> _clock_start</span><span class="pun">).</span><span class="pln">count</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"ms."</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
</span><span class="com">#endif</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2125/problem/F" title="Educational Codeforces Round 181 (Rated for Div. 2)">2125F - Timofey and Docker</a></p><p>Idea: <a class="rated-user user-orange" href="https://codeforces.com/profile/FelixArg" title="Master FelixArg">FelixArg</a></p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2125/problem/F" title="Educational Codeforces Round 181 (Rated for Div. 2)">2125F - Timofey and Docker</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Hint: The most challenging case is when we need to increase the number of occurrences of the word "<span class="tex-font-style-tt">docker</span>". This can be considered as a dynamic programming problem of the form <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1694"><span class="MJXp-mtext" id="MJXp-Span-1695">dp</span><span class="MJXp-mo" id="MJXp-Span-1696" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1697">i</span><span class="MJXp-mo" id="MJXp-Span-1698" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1699" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1700">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1701">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1702">t</span><span class="MJXp-mo" id="MJXp-Span-1703" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-247">\text{dp}[i][cnt]</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1704"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1705">O</span><span class="MJXp-mo" id="MJXp-Span-1706" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1707"><span class="MJXp-mo" id="MJXp-Span-1708" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1709">s</span><span class="MJXp-msubsup" id="MJXp-Span-1710"><span class="MJXp-mrow" id="MJXp-Span-1711" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1712" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1713" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1714">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-1715" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-248">O(|s|^{2})</script>. Is there a way to optimize it?</p><p>Let's calculate the maximum number of people that can be achieved, let's denote this as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1716"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1717">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1718">x</span></span></span><script type="math/tex" id="MathJax-Element-249">mx</script>. Next, we will count the number of occurrences of the string <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1719"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1720">t</span><span class="MJXp-mo" id="MJXp-Span-1721" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><script type="math/tex" id="MathJax-Element-250">t = </script>"<span class="tex-font-style-tt">docker</span>" in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1722"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1723">s</span></span></span><script type="math/tex" id="MathJax-Element-251">s</script>, let's denote this as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1724"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1725">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1726">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727">t</span></span></span><script type="math/tex" id="MathJax-Element-252">cnt</script>. Here we can notice the following: the occurrences of the string <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1729">t</span></span></span><script type="math/tex" id="MathJax-Element-253">t</script> do not overlap since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1730"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1731">t</span></span></span><script type="math/tex" id="MathJax-Element-254">t</script> consists of different letters.</p><p>Then, we will look at all the possible occurrences of the string <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1732"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1733">t</span><span class="MJXp-mo" id="MJXp-Span-1734" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><script type="math/tex" id="MathJax-Element-255">t = </script>"<span class="tex-font-style-tt">docker</span>" in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1735"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1736">s</span></span></span><script type="math/tex" id="MathJax-Element-256">s</script> that achieve <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1737"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1738">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1739">x</span></span></span><script type="math/tex" id="MathJax-Element-257">mx</script>. Formally, we can divide them into <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1740"><span class="MJXp-mn" id="MJXp-Span-1741">2</span></span></span><script type="math/tex" id="MathJax-Element-258">2</script> groups: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1742"><span class="MJXp-mo" id="MJXp-Span-1743" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1744">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1745">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1746">t</span></span></span><script type="math/tex" id="MathJax-Element-259">\le cnt</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1747"><span class="MJXp-mo" id="MJXp-Span-1748" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1749">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1750">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1751">t</span></span></span><script type="math/tex" id="MathJax-Element-260">> cnt</script>.</p><p>In the first case, we need to change some letters of the already existing occurrences, then we can update the answer as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1752"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1753">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1754">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1755">s</span><span class="MJXp-mo" id="MJXp-Span-1756" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1757" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-1758" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1759">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1760">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1761">s</span><span class="MJXp-mo" id="MJXp-Span-1762" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1763">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1764">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1765">t</span><span class="MJXp-mo" id="MJXp-Span-1766" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1767">i</span><span class="MJXp-mo" id="MJXp-Span-1768" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-261">ans = \min(ans, cnt - i)</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1769"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1770">i</span></span></span><script type="math/tex" id="MathJax-Element-262">i</script> indicates that we need exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1771"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1772">i</span></span></span><script type="math/tex" id="MathJax-Element-263">i</script> occurrences.</p><p>In the second case, we need to apply dynamic programming of the form <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1773"><span class="MJXp-mtext" id="MJXp-Span-1774">dp</span><span class="MJXp-mo" id="MJXp-Span-1775" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1776">x</span><span class="MJXp-mo" id="MJXp-Span-1777" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1778" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1779">y</span><span class="MJXp-mo" id="MJXp-Span-1780" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-264">\text{dp}[x][y]</script>—the minimum number of characters that need to be replaced in the prefix <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1781"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1782">s</span></span></span><script type="math/tex" id="MathJax-Element-265">s</script> of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1783"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1784">x</span></span></span><script type="math/tex" id="MathJax-Element-266">x</script> so that the number of occurrences is exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1785"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1786">y</span></span></span><script type="math/tex" id="MathJax-Element-267">y</script>. This dynamic programming can be computed in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1787"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1788">O</span><span class="MJXp-mo" id="MJXp-Span-1789" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-1790"><span class="MJXp-mo" id="MJXp-Span-1791" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1792">s</span><span class="MJXp-mrow" id="MJXp-Span-1793"><span class="MJXp-mo" id="MJXp-Span-1794" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1795" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1796">i</span><span class="MJXp-mo" id="MJXp-Span-1797" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-268">O(|s| \cdot i)</script>. It is sufficient to compute this dynamic programming only once for such <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1798"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1799">i</span></span></span><script type="math/tex" id="MathJax-Element-269">i</script> that achieves <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1800"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1801">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1802">x</span></span></span><script type="math/tex" id="MathJax-Element-270">mx</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1803"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1804">i</span></span></span><script type="math/tex" id="MathJax-Element-271">i</script> occurrences, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1805"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1806">i</span></span></span><script type="math/tex" id="MathJax-Element-272">i</script> is the first such that it is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1807"><span class="MJXp-mo" id="MJXp-Span-1808" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1809">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1810">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1811">t</span></span></span><script type="math/tex" id="MathJax-Element-273">\ge cnt</script>.</p><p>Now we need to optimize the dynamic programming. We can replace it with the fact that the function <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1812"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1813">g</span><span class="MJXp-mo" id="MJXp-Span-1814" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1815">x</span><span class="MJXp-mo" id="MJXp-Span-1816" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1817" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1818">dp</span><span class="MJXp-mo" id="MJXp-Span-1819" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mrow" id="MJXp-Span-1820"><span class="MJXp-mo" id="MJXp-Span-1821" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1822">s</span><span class="MJXp-mrow" id="MJXp-Span-1823"><span class="MJXp-mo" id="MJXp-Span-1824" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1825" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1826" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1827">x</span><span class="MJXp-mo" id="MJXp-Span-1828" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-274">g(x) = \text{dp}[|s|][x]</script> is non-decreasing and, in addition, convex, so we can apply the "aliens trick" to find <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1829"><span class="MJXp-mtext" id="MJXp-Span-1830">dp</span><span class="MJXp-mo" id="MJXp-Span-1831" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mrow" id="MJXp-Span-1832"><span class="MJXp-mo" id="MJXp-Span-1833" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1834">s</span><span class="MJXp-mrow" id="MJXp-Span-1835"><span class="MJXp-mo" id="MJXp-Span-1836" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1837" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1838" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1839">i</span><span class="MJXp-mo" id="MJXp-Span-1840" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-275">\text{dp}[|s|][i]</script>.</p><p>Let's recall how to determine a convex function. It is sufficient for the following condition to hold:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1841"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1842">g</span><span class="MJXp-mo" id="MJXp-Span-1843" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1844">x</span><span class="MJXp-mo" id="MJXp-Span-1845" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1846">1</span><span class="MJXp-mo" id="MJXp-Span-1847" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1848" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1849">g</span><span class="MJXp-mo" id="MJXp-Span-1850" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1851">x</span><span class="MJXp-mo" id="MJXp-Span-1852" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1853" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1854">g</span><span class="MJXp-mo" id="MJXp-Span-1855" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1856">x</span><span class="MJXp-mo" id="MJXp-Span-1857" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1858" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1859">g</span><span class="MJXp-mo" id="MJXp-Span-1860" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1861">x</span><span class="MJXp-mo" id="MJXp-Span-1862" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1863">1</span><span class="MJXp-mo" id="MJXp-Span-1864" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex; mode=display" id="MathJax-Element-276">g(x - 1) - g(x) \ge g(x) - g(x + 1)</script></p><p>For our <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1865"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1866">g</span><span class="MJXp-mo" id="MJXp-Span-1867" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1868">x</span><span class="MJXp-mo" id="MJXp-Span-1869" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-277">g(x)</script>, this condition holds, and it is quite intuitive that adding each new occurrence of the string "<span class="tex-font-style-tt">docker</span>" in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1870"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1871">s</span></span></span><script type="math/tex" id="MathJax-Element-278">s</script> becomes more expensive (i.e., it requires at least as many character replacements for each new occurrence of "<span class="tex-font-style-tt">docker</span>" in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1872"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1873">s</span></span></span><script type="math/tex" id="MathJax-Element-279">s</script>), but let's prove this.</p><p>Our quadratic dynamic programming has the form:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1874"><span class="MJXp-mtext" id="MJXp-Span-1875">dp</span><span class="MJXp-mo" id="MJXp-Span-1876" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1877">i</span><span class="MJXp-mo" id="MJXp-Span-1878" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1879" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1880">j</span><span class="MJXp-mo" id="MJXp-Span-1881" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1882" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1883"><span class=""><span class="MJXp-mo" id="MJXp-Span-1884" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1885" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1886">k</span><span class="MJXp-mo" id="MJXp-Span-1887">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1888">i</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1889">dp</span><span class="MJXp-mo" id="MJXp-Span-1890" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1891">k</span><span class="MJXp-mo" id="MJXp-Span-1892" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1893">1</span><span class="MJXp-mo" id="MJXp-Span-1894" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1895" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1896">j</span><span class="MJXp-mo" id="MJXp-Span-1897" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1898">1</span><span class="MJXp-mo" id="MJXp-Span-1899" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1900" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1901">w</span><span class="MJXp-mo" id="MJXp-Span-1902" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1903">k</span><span class="MJXp-mo" id="MJXp-Span-1904" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1905">i</span><span class="MJXp-mo" id="MJXp-Span-1906" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex; mode=display" id="MathJax-Element-280">\text{dp}[i][j] = \min_{k < i} \text{dp}[k - 1][j - 1] + w(k, i)</script></p><p>Here, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1907"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1908">w</span><span class="MJXp-mo" id="MJXp-Span-1909" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1910">k</span><span class="MJXp-mo" id="MJXp-Span-1911" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1912">i</span><span class="MJXp-mo" id="MJXp-Span-1913" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-281">w(k, i)</script> is defined as follows:</p><ul> <li> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1914"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1915">w</span><span class="MJXp-mo" id="MJXp-Span-1916" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1917">k</span><span class="MJXp-mo" id="MJXp-Span-1918" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1919">i</span><span class="MJXp-mo" id="MJXp-Span-1920" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1921" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi" id="MJXp-Span-1922">∞</span></span></span><script type="math/tex" id="MathJax-Element-282">w(k, i) = \infty</script>, if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1923"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1924">i</span><span class="MJXp-mo" id="MJXp-Span-1925" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1926">k</span><span class="MJXp-mo" id="MJXp-Span-1927" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1928">1</span><span class="MJXp-mo" id="MJXp-Span-1929" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-1930">6</span></span></span><script type="math/tex" id="MathJax-Element-283">i - k + 1 < 6</script>; </li><li> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1931"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1932">w</span><span class="MJXp-mo" id="MJXp-Span-1933" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1934">k</span><span class="MJXp-mo" id="MJXp-Span-1935" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1936">i</span><span class="MJXp-mo" id="MJXp-Span-1937" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1938" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span><script type="math/tex" id="MathJax-Element-284">w(k, i) = </script> the minimum number of character replacements in some subsegment of the segment <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1939"><span class="MJXp-mo" id="MJXp-Span-1940" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1941">k</span><span class="MJXp-mo" id="MJXp-Span-1942" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1943">i</span><span class="MJXp-mo" id="MJXp-Span-1944" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-285">(k, i)</script> to turn it into "<span class="tex-font-style-tt">docker</span>". </li></ul><p>Note that the quadrangle inequality holds:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1945"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1946">w</span><span class="MJXp-mo" id="MJXp-Span-1947" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1948">a</span><span class="MJXp-mo" id="MJXp-Span-1949" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1950">c</span><span class="MJXp-mo" id="MJXp-Span-1951" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1952" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1953">w</span><span class="MJXp-mo" id="MJXp-Span-1954" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1955">b</span><span class="MJXp-mo" id="MJXp-Span-1956" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1957">d</span><span class="MJXp-mo" id="MJXp-Span-1958" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1959" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1960">w</span><span class="MJXp-mo" id="MJXp-Span-1961" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1962">a</span><span class="MJXp-mo" id="MJXp-Span-1963" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1964">d</span><span class="MJXp-mo" id="MJXp-Span-1965" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1966" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1967">w</span><span class="MJXp-mo" id="MJXp-Span-1968" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1969">b</span><span class="MJXp-mo" id="MJXp-Span-1970" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1971">c</span><span class="MJXp-mo" id="MJXp-Span-1972" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex; mode=display" id="MathJax-Element-286">w(a, c) + w(b, d) \le w(a, d) + w(b, c)</script></p><p>for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1973"><span class="MJXp-mn" id="MJXp-Span-1974">1</span><span class="MJXp-mo" id="MJXp-Span-1975" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1976">a</span><span class="MJXp-mo" id="MJXp-Span-1977" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1978">b</span><span class="MJXp-mo" id="MJXp-Span-1979" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1980">c</span><span class="MJXp-mo" id="MJXp-Span-1981" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1982">d</span><span class="MJXp-mo" id="MJXp-Span-1983" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mrow" id="MJXp-Span-1984"><span class="MJXp-mo" id="MJXp-Span-1985" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1986">s</span><span class="MJXp-mrow" id="MJXp-Span-1987"><span class="MJXp-mo" id="MJXp-Span-1988" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex" id="MathJax-Element-287">1 \le a \le b \le c \le d \le |s|</script>.</p><p>Why does it hold? Suppose we have chosen some optimal subsegment of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1989"><span class="MJXp-mn" id="MJXp-Span-1990">6</span></span></span><script type="math/tex" id="MathJax-Element-288">6</script> for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1991"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1992">w</span><span class="MJXp-mo" id="MJXp-Span-1993" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1994">a</span><span class="MJXp-mo" id="MJXp-Span-1995" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1996">d</span><span class="MJXp-mo" id="MJXp-Span-1997" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-289">w(a, d)</script>, then this segment could have been chosen either in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1998"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1999">w</span><span class="MJXp-mo" id="MJXp-Span-2000" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2001">a</span><span class="MJXp-mo" id="MJXp-Span-2002" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2003">c</span><span class="MJXp-mo" id="MJXp-Span-2004" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-290">w(a, c)</script> or in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2005"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2006">w</span><span class="MJXp-mo" id="MJXp-Span-2007" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2008">b</span><span class="MJXp-mo" id="MJXp-Span-2009" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2010">d</span><span class="MJXp-mo" id="MJXp-Span-2011" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-291">w(b, d)</script>. At the same time, the segment for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2012"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2013">w</span><span class="MJXp-mo" id="MJXp-Span-2014" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2015">b</span><span class="MJXp-mo" id="MJXp-Span-2016" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2017">c</span><span class="MJXp-mo" id="MJXp-Span-2018" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-292">w(b, c)</script> can also be chosen in both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2019"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2020">w</span><span class="MJXp-mo" id="MJXp-Span-2021" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2022">a</span><span class="MJXp-mo" id="MJXp-Span-2023" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2024">c</span><span class="MJXp-mo" id="MJXp-Span-2025" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-293">w(a, c)</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2026"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2027">w</span><span class="MJXp-mo" id="MJXp-Span-2028" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2029">b</span><span class="MJXp-mo" id="MJXp-Span-2030" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2031">d</span><span class="MJXp-mo" id="MJXp-Span-2032" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-294">w(b, d)</script>.</p><p>The fulfillment of the quadrangle inequality is sufficient to state that the function is convex. The proof of this fact is quite extensive and will not be provided here; however, you can search for it on the internet.</p><p>Final asymptotics: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2033"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2034">O</span><span class="MJXp-mo" id="MJXp-Span-2035" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2036">n</span><span class="MJXp-mo" id="MJXp-Span-2037" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-2038"><span class="MJXp-mo" id="MJXp-Span-2039" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2040">s</span><span class="MJXp-mrow" id="MJXp-Span-2041"><span class="MJXp-mo" id="MJXp-Span-2042" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2043" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi" id="MJXp-Span-2044">log</span><span class="MJXp-mo" id="MJXp-Span-2045" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2046">C</span><span class="MJXp-mo" id="MJXp-Span-2047" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-295">O(n + |s| \cdot \log C)</script></p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution (awoo)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
 
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">forn</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> 
 
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> INF </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e8</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">string</span><span class="pln"> al </span><span class="pun">=</span><span class="pln"> </span><span class="str">"docker"</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> tc</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> tc</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tc</span><span class="pun">--){</span><span class="pln">
        </span><span class="kwd">string</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> n </span><span class="pun">=</span><span class="pln"> s</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> mx </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">/</span><span class="pln"> </span><span class="lit">6</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">
        vector</span><span class="str">&lt;int&gt;</span><span class="pln"> dx</span><span class="pun">(</span><span class="pln">mx </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">forn</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">){</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
            cin </span><span class="pun">&gt;&gt;</span><span class="pln"> l </span><span class="pun">&gt;&gt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
            r </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> mx</span><span class="pun">);</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">&gt;</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
            </span><span class="pun">++</span><span class="pln">dx</span><span class="pun">[</span><span class="pln">l</span><span class="pun">];</span><span class="pln">
            </span><span class="pun">--</span><span class="pln">dx</span><span class="pun">[</span><span class="pln">r </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">forn</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> mx </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> dx</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> dx</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
 
        </span><span class="kwd">int</span><span class="pln"> cur </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        vector</span><span class="str">&lt;int&gt;</span><span class="pln"> dif</span><span class="pun">(</span><span class="pln">max</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">5</span><span class="pun">));</span><span class="pln">
        </span><span class="kwd">forn</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">5</span><span class="pun">){</span><span class="pln">
            </span><span class="kwd">forn</span><span class="pun">(</span><span class="pln">j</span><span class="pun">,</span><span class="pln"> </span><span class="lit">6</span><span class="pun">)</span><span class="pln">
                dif</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> al</span><span class="pun">[</span><span class="pln">j</span><span class="pun">];</span><span class="pln">
            cur </span><span class="pun">+=</span><span class="pln"> dif</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
 
        </span><span class="kwd">int</span><span class="pln"> mxcnt </span><span class="pun">=</span><span class="pln"> </span><span class="pun">*</span><span class="pln">max_element</span><span class="pun">(</span><span class="pln">dx</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> dx</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">());</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> k </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> INF</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">forn</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> mx </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dx</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> mxcnt</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> cur</span><span class="pun">){</span><span class="pln">
                ans </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">,</span><span class="pln"> cur </span><span class="pun">-</span><span class="pln"> i</span><span class="pun">);</span><span class="pln">
                </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            k </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
 
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">==</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">){</span><span class="pln">
            cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
 
        </span><span class="kwd">auto</span><span class="pln"> calc </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[&amp;](</span><span class="kwd">int</span><span class="pln"> d</span><span class="pun">){</span><span class="pln">
            vector</span><span class="pun">&lt;</span><span class="pln">pair</span><span class="pun">&lt;</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;&gt;</span><span class="pln"> dp</span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{(</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">)</span><span class="lit">1e18</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">});</span><span class="pln">
            dp</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">};</span><span class="pln">
            </span><span class="kwd">forn</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">){</span><span class="pln">
                dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">],</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">6</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">)</span><span class="pln">
                    dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">6</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">6</span><span class="pun">],</span><span class="pln"> </span><span class="pun">{</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">first </span><span class="pun">+</span><span class="pln"> dif</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> d</span><span class="pun">,</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">second </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">});</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">n</span><span class="pun">];</span><span class="pln">
        </span><span class="pun">};</span><span class="pln">
 
        </span><span class="kwd">int</span><span class="pln"> l </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="pln">INF</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> sv </span><span class="pun">=</span><span class="pln"> INF</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">&lt;=</span><span class="pln"> r</span><span class="pun">){</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> m </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">[</span><span class="pln">val</span><span class="pun">,</span><span class="pln"> cnt</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> calc</span><span class="pun">(</span><span class="pln">m</span><span class="pun">);</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(-</span><span class="pln">cnt </span><span class="pun">&gt;=</span><span class="pln"> k</span><span class="pun">){</span><span class="pln">
                sv </span><span class="pun">=</span><span class="pln"> val </span><span class="pun">-</span><span class="pln"> k </span><span class="pun">*</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">
                l </span><span class="pun">=</span><span class="pln"> m </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            </span><span class="kwd">else</span><span class="pun">{</span><span class="pln">
                r </span><span class="pun">=</span><span class="pln"> m </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        ans </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">,</span><span class="pln"> sv</span><span class="pun">);</span><span class="pln">
 
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln"> 
</span><span class="pun">}</span></code></pre></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2125" class="notice" style="text-decoration: none;">Educational Codeforces Round 181 (Rated for Div. 2)</a> </span>
        </div>
        
            

  <script>
    // Make all spoilers toggleable
    document.querySelectorAll('.spoiler-title').forEach(title => {
      title.addEventListener('click', function() {
        const spoiler = this.closest('.spoiler');
        spoiler.classList.toggle('open');
      });
    });
    
    // Open all spoilers by default for easier reading
    document.querySelectorAll('.spoiler').forEach(spoiler => {
      spoiler.classList.add('open');
    });
  </script>
</body>
</html>