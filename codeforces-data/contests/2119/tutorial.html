<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tutorial</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
      color: #333;
      background: #fafafa;
    }
    .ttypography {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    h3 {
      color: #1a1a1a;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }
    h3 a {
      color: #0066cc;
      text-decoration: none;
    }
    h3 a:hover {
      text-decoration: underline;
    }
    .spoiler {
      margin: 15px 0;
      border: 1px solid #ddd;
      border-radius: 6px;
      overflow: hidden;
    }
    .spoiler-title {
      display: block;
      padding: 12px 15px;
      background: #f0f0f0;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
      border-bottom: 1px solid #ddd;
    }
    .spoiler-title:hover {
      background: #e8e8e8;
    }
    .spoiler-title::before {
      content: '▶ ';
      font-size: 0.8em;
      transition: transform 0.2s;
      display: inline-block;
    }
    .spoiler.open .spoiler-title::before {
      content: '▼ ';
    }
    .spoiler-content {
      padding: 15px;
      background: #fff;
      display: none;
    }
    .spoiler.open .spoiler-content {
      display: block;
    }
    pre, code {
      background: #f5f5f5;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 0.85em;
    }
    pre {
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
    code {
      padding: 2px 5px;
      border-radius: 3px;
    }
    p {
      margin: 10px 0;
    }
    .MathJax {
      font-size: 1.1em;
    }
  </style>
</head>
<body>
  <h1>Editorial</h1>
  <p><a href="https://codeforces.com/blog/entry/144494" target="_blank">View on Codeforces →</a></p>
  
  <div class="ttypography"><p>Sorry for misjudging the difficulty of problem D, but we still hope you enjoyed the problems!</p><p><a href="https://codeforces.com/contest/2119/problem/A" title="Codeforces Round 1035 (Div. 2)">2119A - Add or XOR</a></p><p>Author: <a class="rated-user user-red" href="https://codeforces.com/profile/YuJiahe" title="Grandmaster YuJiahe">YuJiahe</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2295;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 3.033em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.275em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1002.22em, 2.438em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-4" style="font-family: MathJax_Main; padding-left: 0.219em;">⊕</span><span class="mn" id="MathJax-Span-5" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>⊕</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-1">a \oplus 1</script> is equivalent to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6" style="width: 3.033em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.275em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1002.22em, 2.438em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-7"><span class="mi" id="MathJax-Span-8" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-9" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-10" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-2">a - 1</script> when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-11" style="width: 0.76em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-12"><span class="mi" id="MathJax-Span-13" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">a</script> is an odd number, otherwise it is equivalent to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-14" style="width: 3.033em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.275em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1002.22em, 2.438em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-15"><span class="mi" id="MathJax-Span-16" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-17" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-18" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-4">a + 1</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>If you apply <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2295;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-19" style="width: 5.739em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.332em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1004.28em, 2.438em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-20"><span class="mi" id="MathJax-Span-21" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-22" style="font-family: MathJax_Main; padding-left: 0.273em;">←</span><span class="mi" id="MathJax-Span-23" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">a</span><span class="mo" id="MathJax-Span-24" style="font-family: MathJax_Main; padding-left: 0.219em;">⊕</span><span class="mn" id="MathJax-Span-25" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo stretchy="false">←</mo><mi>a</mi><mo>⊕</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-5">a \gets a \oplus 1</script> when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-26" style="width: 0.76em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-27"><span class="mi" id="MathJax-Span-28" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">a</script> is odd, then that operation should make <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-29" style="width: 3.033em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.275em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1002.27em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-30"><span class="mi" id="MathJax-Span-31" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-32" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>=</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">a = b</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2119/problem/A" title="Codeforces Round 1035 (Div. 2)">2119A - Add or XOR</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Obviously, if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-857"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-858">b</span><span class="MJXp-mo" id="MJXp-Span-859" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-860">a</span></span></span><script type="math/tex" id="MathJax-Element-131">b < a</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-861"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-862">a</span><span class="MJXp-mo" id="MJXp-Span-863" style="margin-left: 0.267em; margin-right: 0.267em;">⊕</span><span class="MJXp-mn" id="MJXp-Span-864">1</span><span class="MJXp-mo" id="MJXp-Span-865" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866">b</span></span></span><script type="math/tex" id="MathJax-Element-132">a \oplus 1 = b</script>, the answer is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-867"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-868">y</span></span></span><script type="math/tex" id="MathJax-Element-133">y</script>. If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-869"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-870">b</span><span class="MJXp-mo" id="MJXp-Span-871" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-872">a</span></span></span><script type="math/tex" id="MathJax-Element-134">b < a</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-873"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">a</span><span class="MJXp-mo" id="MJXp-Span-875" style="margin-left: 0.267em; margin-right: 0.267em;">⊕</span><span class="MJXp-mn" id="MJXp-Span-876">1</span><span class="MJXp-mo" id="MJXp-Span-877" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-878">b</span></span></span><script type="math/tex" id="MathJax-Element-135">a \oplus 1 \ne b</script>, there is no solution.</p><p>After excluding the above, there is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-879"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880">a</span><span class="MJXp-mo" id="MJXp-Span-881" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">b</span></span></span><script type="math/tex" id="MathJax-Element-136">a \le b</script>. Then the bitwise XOR operation can only be used if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-883"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884">a</span></span></span><script type="math/tex" id="MathJax-Element-137">a</script> is even; otherwise, it will cancel out the last operation.</p><p>So if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-885"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-886">x</span><span class="MJXp-mo" id="MJXp-Span-887" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-888">y</span></span></span><script type="math/tex" id="MathJax-Element-138">x \le y</script>, then always use the add operation; otherwise, use the bitwise XOR operation if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-889"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">a</span></span></span><script type="math/tex" id="MathJax-Element-139">a</script> is even, and use the add operation if it is odd.</p><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-891"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-892">d</span><span class="MJXp-mo" id="MJXp-Span-893" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">b</span><span class="MJXp-mo" id="MJXp-Span-895" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896">a</span></span></span><script type="math/tex" id="MathJax-Element-140">d = b - a</script>. The minimal cost is:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-897"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-899">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-900">s</span><span class="MJXp-mo" id="MJXp-Span-901" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-902"><span class="MJXp-mo" id="MJXp-Span-903" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.472em;"><span class="MJXp-right MJXp-scale5" style="font-size: 2.889em; margin-left: -0.22em;">{</span></span><span class="MJXp-mtable" id="MJXp-Span-904"><span><span class="MJXp-mtr" id="MJXp-Span-905" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-906" style="text-align: left;"><span class="MJXp-mo" id="MJXp-Span-907" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-908">d</span><span class="MJXp-mrow" id="MJXp-Span-909"><span class="MJXp-mo" id="MJXp-Span-910" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-911">2</span><span class="MJXp-mo" id="MJXp-Span-912" style="margin-left: 0em; margin-right: 0em;">⌉</span><span class="MJXp-mo" id="MJXp-Span-913" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-914" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-915" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-916">x</span><span class="MJXp-mo" id="MJXp-Span-917" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-918">y</span><span class="MJXp-mo" id="MJXp-Span-919" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-920" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-921" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922">d</span><span class="MJXp-mrow" id="MJXp-Span-923"><span class="MJXp-mo" id="MJXp-Span-924" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-925">2</span><span class="MJXp-mo" id="MJXp-Span-926" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-927" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">x</span></span><span class="MJXp-mtd" id="MJXp-Span-929" style="padding-left: 1em; text-align: left;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-930">a</span><span class="MJXp-mtext" id="MJXp-Span-931">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-932">is</span><span class="MJXp-mtext" id="MJXp-Span-933">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-934">even</span></span></span><span class="MJXp-mtr" id="MJXp-Span-935" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-936" style="padding-top: 0.2em; text-align: left;"><span class="MJXp-mo" id="MJXp-Span-937" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938">d</span><span class="MJXp-mrow" id="MJXp-Span-939"><span class="MJXp-mo" id="MJXp-Span-940" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-941">2</span><span class="MJXp-mo" id="MJXp-Span-942" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-943" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-944" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-945" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946">x</span><span class="MJXp-mo" id="MJXp-Span-947" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948">y</span><span class="MJXp-mo" id="MJXp-Span-949" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-950" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-951" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">d</span><span class="MJXp-mrow" id="MJXp-Span-953"><span class="MJXp-mo" id="MJXp-Span-954" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-955">2</span><span class="MJXp-mo" id="MJXp-Span-956" style="margin-left: 0em; margin-right: 0em;">⌉</span><span class="MJXp-mo" id="MJXp-Span-957" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-958">x</span></span><span class="MJXp-mtd" id="MJXp-Span-959" style="padding-left: 1em; padding-top: 0.2em; text-align: left;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960">a</span><span class="MJXp-mtext" id="MJXp-Span-961">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-962">is</span><span class="MJXp-mtext" id="MJXp-Span-963">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-964">odd</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-965" style="margin-left: 0em; margin-right: 0em;"></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-141"> ans = \begin{cases} \lceil d/2 \rceil \cdot \min(x,y) + \lfloor d/2 \rfloor \cdot x & a \ \text{is} \ \text{even} \\ \lfloor d/2 \rfloor \cdot \min(x,y) + \lceil d/2 \rceil \cdot x & a \ \text{is} \ \text{odd} \end{cases} </script></p><p>Which is computable in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-966"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967">O</span><span class="MJXp-mo" id="MJXp-Span-968" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-969">1</span><span class="MJXp-mo" id="MJXp-Span-970" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-142">O(1)</script>. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-971"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972">O</span><span class="MJXp-mo" id="MJXp-Span-973" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">b</span><span class="MJXp-mo" id="MJXp-Span-975" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-976">a</span><span class="MJXp-mo" id="MJXp-Span-977" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-143">O(b - a)</script> solutions are also passable.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;algorithm&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstring&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstdio&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;vector&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;queue&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">,</span><span class="pln"> b</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">t</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t </span><span class="pun">--){</span><span class="pln">scanf</span><span class="pun">(</span><span class="str">"%d%d%d%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">a</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">b</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">&gt;</span><span class="pln"> b</span><span class="pun">)</span><span class="pln"> printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">^</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> b </span><span class="pun">?</span><span class="pln"> y </span><span class="pun">:</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="kwd">int</span><span class="pln"> c0 </span><span class="pun">=</span><span class="pln"> b </span><span class="pun">-</span><span class="pln"> a</span><span class="pun">,</span><span class="pln"> c1 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">b </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"%lld\n"</span><span class="pun">,</span><span class="pln"> y </span><span class="pun">&gt;</span><span class="pln"> x </span><span class="pun">?</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> c0 </span><span class="pun">*</span><span class="pln"> x </span><span class="pun">:</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">c0 </span><span class="pun">-</span><span class="pln"> c1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> x </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> c1 </span><span class="pun">*</span><span class="pln"> y</span><span class="pun">);}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2119/problem/B" title="Codeforces Round 1035 (Div. 2)">2119B - Line Segments</a></p><p>Author: <a class="rated-user user-violet" href="https://codeforces.com/profile/Lyz09" title="Candidate Master Lyz09">Lyz09</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Transform <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-34" style="width: 4.169em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.141em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1003.03em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-35"><span class="mo" id="MathJax-Span-36" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-37"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-38" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-39" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-40" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-41" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-42" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-43" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-44" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.504em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>p</mi><mi>x</mi></msub><mo>,</mo><msub><mi>p</mi><mi>y</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-8">(p_x,p_y)</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-45" style="width: 4.007em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.033em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1002.92em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-46"><span class="mo" id="MathJax-Span-47" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-48"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-49" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-50" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-51" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-52" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-53" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.436em;"><span class="mi" id="MathJax-Span-54" style="font-size: 70.7%; font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-55" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.504em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>q</mi><mi>x</mi></msub><mo>,</mo><msub><mi>q</mi><mi>y</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-9">(q_x,q_y)</script> into an operation where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-56" style="width: 1.139em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.87em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-57"><span class="msubsup" id="MathJax-Span-58"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-59" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-60" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-10">a_i</script> is the distance between the two points.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>When <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-61" style="width: 5.522em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.169em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1004.12em, 2.438em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-62"><span class="mi" id="MathJax-Span-63" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-64" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-65" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-66" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mn" id="MathJax-Span-67" style="font-family: MathJax_Main; padding-left: 0.273em;">3</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>+</mo><mn>1</mn><mo>=</mo><mn>3</mn></math></span></span><script type="math/tex" id="MathJax-Element-11">n+1=3</script>, there is a solution if and only if the largest <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-68" style="width: 1.139em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.87em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-69"><span class="msubsup" id="MathJax-Span-70"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-71" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-72" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-12">a_i</script> is less than or equal to the sum of the remaining <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-73" style="width: 1.139em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.87em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-74"><span class="msubsup" id="MathJax-Span-75"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-76" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-77" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-13">a_i</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2119/problem/B" title="Codeforces Round 1035 (Div. 2)">2119B - Line Segments</a></h3><div class="ttypography"><div class="problem-statement"><div><p>First, add an additional vector with magnitude equal to the distance <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-978"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979">d</span></span></span><script type="math/tex" id="MathJax-Element-144">d</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-980"><span class="MJXp-mo" id="MJXp-Span-981" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-982"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-984" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-985" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-986"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-988" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-989" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-145">(p_x,p_y)</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-990"><span class="MJXp-mo" id="MJXp-Span-991" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-992"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-993" style="margin-right: 0.05em;">q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-994" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-995" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-996"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-997" style="margin-right: 0.05em;">q</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-998" style="vertical-align: -0.4em;">y</span></span><span class="MJXp-mo" id="MJXp-Span-999" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-146">(q_x,q_y)</script>, directed back to the starting point. This converts the problem to checking if the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1000"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001">n</span><span class="MJXp-mo" id="MJXp-Span-1002" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1003">1</span></span></span><script type="math/tex" id="MathJax-Element-147">n+1</script> vectors can sum to zero.</p><p>Now, the problem reduces to determining whether these <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1004"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1005">n</span><span class="MJXp-mo" id="MJXp-Span-1006" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1007">1</span></span></span><script type="math/tex" id="MathJax-Element-148">n+1</script> edges can form a polygon (possibly degenerate). The necessary and sufficient condition is that no single edge exceeds the sum of the others. To see why: </p><ul> <li> Necessity: If the longest edge <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1008"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">m</span></span></span><script type="math/tex" id="MathJax-Element-149">m</script> satisfies <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1010"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">m</span><span class="MJXp-mo" id="MJXp-Span-1012" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-1013"><span class="MJXp-mo" id="MJXp-Span-1014" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1015" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1016">other edges</span></span></span></span></span><script type="math/tex" id="MathJax-Element-150">m > \sum_{\text{other edges}}</script>, it cannot connect with the remaining edges. </li><li> Sufficiency: Otherwise, we can arrange the edges: <ol> <li> Group the edges into three segments: the longest <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1017"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018">m</span></span></span><script type="math/tex" id="MathJax-Element-151">m</script> and two groups with sums <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1019"><span class="MJXp-msubsup" id="MJXp-Span-1020"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1021" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1022" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1023" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1024"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1025" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1026" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-152">s_1, s_2</script> (sums as close as possible to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1027"><span class="MJXp-mfrac" id="MJXp-Span-1028" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029">S</span><span class="MJXp-mo" id="MJXp-Span-1030">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031">m</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1032">2</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-153">\frac{S-m}{2}</script> where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1033"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034">S</span></span></span><script type="math/tex" id="MathJax-Element-154">S</script> is total length). </li><li> These three segments form a triangle because: <ul> <li> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1035"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1036">m</span><span class="MJXp-mo" id="MJXp-Span-1037" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-1038"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1039" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1040" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1041" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1042"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1044" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-155">m \leq s_1 + s_2</script> (by initial condition). </li><li> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1045"><span class="MJXp-msubsup" id="MJXp-Span-1046"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1048" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1049" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1050">m</span><span class="MJXp-mo" id="MJXp-Span-1051" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1052"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1054" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-156">s_1 \leq m + s_2</script> since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1055"><span class="MJXp-msubsup" id="MJXp-Span-1056"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1058" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1059" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mfrac" id="MJXp-Span-1060" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061">S</span><span class="MJXp-mo" id="MJXp-Span-1062">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063">m</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1064">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1065" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-1066" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mo" id="MJXp-Span-1067">max</span><span class="MJXp-mo" id="MJXp-Span-1068">(</span><span class="MJXp-msubsup" id="MJXp-Span-1069"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1070" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1071" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1072">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1073">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1074" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075">m</span><span class="MJXp-mo" id="MJXp-Span-1076" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1077"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1079" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-157">s_1 \leq \frac{S - m}{2} + \frac{\max(a_i)}{2} \leq m + s_2</script> when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1080"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081">m</span><span class="MJXp-mo" id="MJXp-Span-1082" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mo" id="MJXp-Span-1083" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1084" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1085"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1087" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1088" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-158">m \geq \max(a_i)</script>. </li><li> Similarly, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1089"><span class="MJXp-msubsup" id="MJXp-Span-1090"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1092" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1093" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094">m</span><span class="MJXp-mo" id="MJXp-Span-1095" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1096"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1098" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-159">s_2 \leq m + s_1</script>. </li></ul> </li><li> The degenerate case (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1099"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100">n</span><span class="MJXp-mo" id="MJXp-Span-1101" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1102">1</span><span class="MJXp-mo" id="MJXp-Span-1103" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1104">2</span></span></span><script type="math/tex" id="MathJax-Element-160">n+1=2</script>) is covered when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1105"><span class="MJXp-msubsup" id="MJXp-Span-1106"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1107" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1108" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1109" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1110">0</span></span></span><script type="math/tex" id="MathJax-Element-161">s_1 = 0</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1111"><span class="MJXp-msubsup" id="MJXp-Span-1112"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1114" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1115" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1116">0</span></span></span><script type="math/tex" id="MathJax-Element-162">s_2 = 0</script>. </li></ol> </li></ul><p>Therefore, we simply check if the maximum edge length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1117"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118">m</span><span class="MJXp-mo" id="MJXp-Span-1119" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1120" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1121" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1122"><span class="MJXp-mo" id="MJXp-Span-1123" style="margin-left: 0.333em; margin-right: 0.05em;">max</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1124" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-1125"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1126" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1127" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1128" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129">d</span><span class="MJXp-mo" id="MJXp-Span-1130" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-163">m = \max(\max_i a_i, d)</script> satisfies <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132">m</span><span class="MJXp-mo" id="MJXp-Span-1133" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134">S</span><span class="MJXp-mo" id="MJXp-Span-1135" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1136">m</span></span></span><script type="math/tex" id="MathJax-Element-164">m \leq S - m</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138">S</span><span class="MJXp-mo" id="MJXp-Span-1139" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140">d</span><span class="MJXp-mo" id="MJXp-Span-1141" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1142"><span class="MJXp-mo" id="MJXp-Span-1143" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1148">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145">i</span><span class="MJXp-mo" id="MJXp-Span-1146">=</span><span class="MJXp-mn" id="MJXp-Span-1147">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1149"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1150" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1151" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-165">S = d + \sum_{i=1}^n a_i</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">d</span></span></span><script type="math/tex" id="MathJax-Element-166">d</script> is the Euclidean distance between the starting point and the terminal point.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Implementation 1</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="str">&lt;iostream&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;algorithm&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;cmath&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> N </span><span class="lit">100010</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="pln">sx</span><span class="pun">,</span><span class="pln">sy</span><span class="pun">,</span><span class="pln">tx</span><span class="pun">,</span><span class="pln">ty</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">double</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	cin</span><span class="pun">&gt;&gt;</span><span class="pln">t</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		cin</span><span class="pun">&gt;&gt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
		cin</span><span class="pun">&gt;&gt;</span><span class="pln">sx</span><span class="pun">&gt;&gt;</span><span class="pln">sy</span><span class="pun">&gt;&gt;</span><span class="pln">tx</span><span class="pun">&gt;&gt;</span><span class="pln">ty</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
		 cin</span><span class="pun">&gt;&gt;</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
		a</span><span class="pun">[++</span><span class="pln">n</span><span class="pun">]=</span><span class="pln">sqrt</span><span class="pun">((</span><span class="pln">sx</span><span class="pun">-</span><span class="pln">tx</span><span class="pun">)*(</span><span class="pln">sx</span><span class="pun">-</span><span class="pln">tx</span><span class="pun">)+(</span><span class="pln">sy</span><span class="pun">-</span><span class="pln">ty</span><span class="pun">)*(</span><span class="pln">sy</span><span class="pun">-</span><span class="pln">ty</span><span class="pun">));</span><span class="pln">
		sort</span><span class="pun">(</span><span class="pln">a</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">a</span><span class="pun">+</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">double</span><span class="pln"> sum</span><span class="pun">=</span><span class="pln">a</span><span class="pun">[</span><span class="pln">n</span><span class="pun">];</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
		 sum</span><span class="pun">-=</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">sum</span><span class="pun">&lt;=</span><span class="lit">0</span><span class="pun">)</span><span class="pln">
		 puts</span><span class="pun">(</span><span class="str">"Yes"</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">else</span><span class="pln">
		 puts</span><span class="pun">(</span><span class="str">"No"</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Implementation 2</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="str">&lt;iostream&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;algorithm&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> N </span><span class="lit">100010</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="pln">sx</span><span class="pun">,</span><span class="pln">sy</span><span class="pun">,</span><span class="pln">tx</span><span class="pun">,</span><span class="pln">ty</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	cin</span><span class="pun">&gt;&gt;</span><span class="pln">t</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		cin</span><span class="pun">&gt;&gt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
		cin</span><span class="pun">&gt;&gt;</span><span class="pln">sx</span><span class="pun">&gt;&gt;</span><span class="pln">sy</span><span class="pun">&gt;&gt;</span><span class="pln">tx</span><span class="pun">&gt;&gt;</span><span class="pln">ty</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
		 cin</span><span class="pun">&gt;&gt;</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
		sort</span><span class="pun">(</span><span class="pln">a</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">a</span><span class="pun">+</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">=(</span><span class="pln">sx</span><span class="pun">-</span><span class="pln">tx</span><span class="pun">)*(</span><span class="pln">sx</span><span class="pun">-</span><span class="pln">tx</span><span class="pun">)+(</span><span class="pln">sy</span><span class="pun">-</span><span class="pln">ty</span><span class="pun">)*(</span><span class="pln">sy</span><span class="pun">-</span><span class="pln">ty</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">p</span><span class="pun">&gt;</span><span class="pln">a</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]*</span><span class="pln">a</span><span class="pun">[</span><span class="pln">n</span><span class="pun">])</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">int</span><span class="pln"> sum</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				sum</span><span class="pun">+=</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">sum</span><span class="pun">*</span><span class="pln">sum</span><span class="pun">&gt;=</span><span class="pln">p</span><span class="pun">)</span><span class="pln">
				 </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">sum</span><span class="pun">*</span><span class="pln">sum</span><span class="pun">&gt;=</span><span class="pln">p</span><span class="pun">)</span><span class="pln">
			 puts</span><span class="pun">(</span><span class="str">"Yes"</span><span class="pun">);</span><span class="pln">
			</span><span class="kwd">else</span><span class="pln">
			 puts</span><span class="pun">(</span><span class="str">"No"</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">else</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">int</span><span class="pln"> sum</span><span class="pun">=</span><span class="pln">a</span><span class="pun">[</span><span class="pln">n</span><span class="pun">];</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
			 sum</span><span class="pun">-=</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">sum</span><span class="pun">&lt;=</span><span class="lit">0</span><span class="pun">||</span><span class="pln">sum</span><span class="pun">*</span><span class="pln">sum</span><span class="pun">&lt;=</span><span class="pln">p</span><span class="pun">)</span><span class="pln">
			 puts</span><span class="pun">(</span><span class="str">"Yes"</span><span class="pun">);</span><span class="pln">
			</span><span class="kwd">else</span><span class="pln">
			 puts</span><span class="pun">(</span><span class="str">"No"</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2119/problem/C" title="Codeforces Round 1035 (Div. 2)">2119C - A Good Problem</a></p><p>Author: <a class="rated-user user-blue" href="https://codeforces.com/profile/lizhous" title="Expert lizhous">lizhous</a> Preparation: <a class="rated-user user-violet" href="https://codeforces.com/profile/Lyz09" title="Candidate Master Lyz09">Lyz09</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>For odd <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-78" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-79"><span class="mi" id="MathJax-Span-80" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">n</script>, setting <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-81" style="width: 3.304em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1002.44em, 2.492em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-82"><span class="msubsup" id="MathJax-Span-83"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-84" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-85" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-87" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">l</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">a_i = l</script> for all <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-88" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-89"><span class="mi" id="MathJax-Span-90" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">i</script> suffices.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>For even <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-91" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-92"><span class="mi" id="MathJax-Span-93" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-17">n</script>, there does not exist a valid array <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-94" style="width: 0.76em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-95"><span class="mi" id="MathJax-Span-96" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-18">a</script> that satisfies <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-97" style="width: 14.072em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.663em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1010.61em, 2.546em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-98"><span class="msubsup" id="MathJax-Span-99"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-100" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mn" id="MathJax-Span-101" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-102" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="msubsup" id="MathJax-Span-103" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-104" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mn" id="MathJax-Span-105" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-106" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mo" id="MathJax-Span-107" style="font-family: MathJax_Main; padding-left: 0.273em;">⋯</span><span class="mo" id="MathJax-Span-108" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="msubsup" id="MathJax-Span-109" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 1.951em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-110" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="texatom" id="MathJax-Span-111"><span class="mrow" id="MathJax-Span-112"><span class="mi" id="MathJax-Span-113" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-114" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-115" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-116" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-117" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">l</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>1</mn></msub><mo>=</mo><msub><mi>a</mi><mn>2</mn></msub><mo>=</mo><mo>⋯</mo><mo>=</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">a_1=a_2=\dots=a_{n-1}=l</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>For even <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-118" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-119"><span class="mi" id="MathJax-Span-120" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-20">n</script>, try to make <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-121" style="width: 14.072em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.663em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1010.61em, 2.546em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-122"><span class="msubsup" id="MathJax-Span-123"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-124" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mn" id="MathJax-Span-125" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-126" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="msubsup" id="MathJax-Span-127" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-128" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mn" id="MathJax-Span-129" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-130" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mo" id="MathJax-Span-131" style="font-family: MathJax_Main; padding-left: 0.273em;">⋯</span><span class="mo" id="MathJax-Span-132" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="msubsup" id="MathJax-Span-133" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 1.951em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-134" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="texatom" id="MathJax-Span-135"><span class="mrow" id="MathJax-Span-136"><span class="mi" id="MathJax-Span-137" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-138" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-139" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-140" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-141" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">l</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mn>1</mn></msub><mo>=</mo><msub><mi>a</mi><mn>2</mn></msub><mo>=</mo><mo>⋯</mo><mo>=</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>=</mo><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-21">a_1=a_2=\dots=a_{n-2}=l</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2119/problem/C" title="Codeforces Round 1035 (Div. 2)">2119C - A Good Problem</a></h3><div class="ttypography"><div class="problem-statement"><div><p>For odd <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1154"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155">n</span></span></span><script type="math/tex" id="MathJax-Element-167">n</script>, setting <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1156"><span class="MJXp-msubsup" id="MJXp-Span-1157"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1159" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1160" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1161">l</span></span></span><script type="math/tex" id="MathJax-Element-168">a_i = l</script> for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1162"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163">i</span></span></span><script type="math/tex" id="MathJax-Element-169">i</script> suffices. </p><p>Consider the even <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1164"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">n</span><span class="MJXp-mo" id="MJXp-Span-1166" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-1167">2</span></span></span><script type="math/tex" id="MathJax-Element-170">n > 2</script> (if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1168"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169">n</span><span class="MJXp-mo" id="MJXp-Span-1170" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1171">2</span></span></span><script type="math/tex" id="MathJax-Element-171">n=2</script> then the only legal array is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1172"><span class="MJXp-mo" id="MJXp-Span-1173" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1174">0</span><span class="MJXp-mo" id="MJXp-Span-1175" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1176">0</span><span class="MJXp-mo" id="MJXp-Span-1177" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-172">[0,0]</script>, so no solution exists because <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1178"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1179">l</span><span class="MJXp-mo" id="MJXp-Span-1180" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-1181">1</span></span></span><script type="math/tex" id="MathJax-Element-173">l\ge 1</script>).</p><p>To achieve the lexicographically smallest array, we set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1182"><span class="MJXp-msubsup" id="MJXp-Span-1183"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1185" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1186" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187">l</span></span></span><script type="math/tex" id="MathJax-Element-174">a_i = l</script> for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1188"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189">i</span><span class="MJXp-mo" id="MJXp-Span-1190" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1191">1</span></span></span><script type="math/tex" id="MathJax-Element-175">i=1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1192"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1193">n</span><span class="MJXp-mo" id="MJXp-Span-1194" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1195">1</span></span></span><script type="math/tex" id="MathJax-Element-176">n-1</script>, then try choosing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1196"><span class="MJXp-msubsup" id="MJXp-Span-1197"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1198" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1199" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1200" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-1201" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1202">l</span><span class="MJXp-mo" id="MJXp-Span-1203" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1204">r</span><span class="MJXp-mo" id="MJXp-Span-1205" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-177">a_n \in [l, r]</script>, which would require satisfying <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1206"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1207">l</span><span class="MJXp-mspace" id="MJXp-Span-1208" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-1209">&amp;</span><span class="MJXp-mspace" id="MJXp-Span-1210" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1211"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1212" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1213" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1214" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1215">l</span><span class="MJXp-mo" id="MJXp-Span-1216" style="margin-left: 0.267em; margin-right: 0.267em;">⊕</span><span class="MJXp-msubsup" id="MJXp-Span-1217"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1218" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1219" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-178">l \, \& \, a_n=l\oplus a_n</script>. Now to determine whether there is a legal <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1220"><span class="MJXp-msubsup" id="MJXp-Span-1221"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1222" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1223" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-179">a_n</script>, then consider each bit separately. Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1225">l</span><span class="MJXp-mo" id="MJXp-Span-1226" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-1227">1</span></span></span><script type="math/tex" id="MathJax-Element-180">l \ge 1</script>, there must exist a bit in the binary representation of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1228"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1229">l</span></span></span><script type="math/tex" id="MathJax-Element-181">l</script> that is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1230"><span class="MJXp-mn" id="MJXp-Span-1231">1</span></span></span><script type="math/tex" id="MathJax-Element-182">1</script>, and we observe that for any bit where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1232"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1233">l</span></span></span><script type="math/tex" id="MathJax-Element-183">l</script> has <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1234"><span class="MJXp-mn" id="MJXp-Span-1235">1</span></span></span><script type="math/tex" id="MathJax-Element-184">1</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1236"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237">l</span><span class="MJXp-mspace" id="MJXp-Span-1238" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-1239">&amp;</span><span class="MJXp-mspace" id="MJXp-Span-1240" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1241">x</span><span class="MJXp-mo" id="MJXp-Span-1242" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1243">l</span><span class="MJXp-mo" id="MJXp-Span-1244" style="margin-left: 0.267em; margin-right: 0.267em;">⊕</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245">x</span></span></span><script type="math/tex" id="MathJax-Element-185">l \, \& \, x \neq l \oplus x</script> holds for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1246"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1247">x</span><span class="MJXp-mo" id="MJXp-Span-1248" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1249">0</span></span></span><script type="math/tex" id="MathJax-Element-186">x=0</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1250"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1251">x</span><span class="MJXp-mo" id="MJXp-Span-1252" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1253">1</span></span></span><script type="math/tex" id="MathJax-Element-187">x=1</script>, so we can't just change <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1254"><span class="MJXp-msubsup" id="MJXp-Span-1255"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1256" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1257" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-188">a_n</script>.</p><p>If no valid <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1258"><span class="MJXp-msubsup" id="MJXp-Span-1259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1261" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-189">a_n</script> exists, we adjust both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1262"><span class="MJXp-msubsup" id="MJXp-Span-1263"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1264" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1265" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1266">n</span><span class="MJXp-mo" id="MJXp-Span-1267">−</span><span class="MJXp-mn" id="MJXp-Span-1268">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-190">a_{n-1}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1269"><span class="MJXp-msubsup" id="MJXp-Span-1270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1272" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-191">a_n</script>. They must satisfy <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1273"><span class="MJXp-msubsup" id="MJXp-Span-1274"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1276" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277">n</span><span class="MJXp-mo" id="MJXp-Span-1278">−</span><span class="MJXp-mn" id="MJXp-Span-1279">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1280" style="margin-left: 0.267em; margin-right: 0.267em;">⊕</span><span class="MJXp-msubsup" id="MJXp-Span-1281"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1283" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1284" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1285">l</span><span class="MJXp-mspace" id="MJXp-Span-1286" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-1287">&amp;</span><span class="MJXp-mspace" id="MJXp-Span-1288" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1289"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1290" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1291" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1292">n</span><span class="MJXp-mo" id="MJXp-Span-1293">−</span><span class="MJXp-mn" id="MJXp-Span-1294">1</span></span></span><span class="MJXp-mspace" id="MJXp-Span-1295" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-1296">&amp;</span><span class="MJXp-mspace" id="MJXp-Span-1297" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1298"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1299" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1300" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1301" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302">l</span><span class="MJXp-mo" id="MJXp-Span-1303" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-1304"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1305" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1306" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307">n</span><span class="MJXp-mo" id="MJXp-Span-1308">−</span><span class="MJXp-mn" id="MJXp-Span-1309">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1310" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1311"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1313" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1314" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1315">r</span></span></span><script type="math/tex" id="MathJax-Element-192">a_{n-1}\oplus a_n=l \, \& \, a_{n-1} \, \& \, a_n, l \le a_{n-1},a_n \le r</script>. Per-bit constraints:</p><ul> <li> If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1317">l</span></span></span><script type="math/tex" id="MathJax-Element-193">l</script>'s bit is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1318"><span class="MJXp-mn" id="MJXp-Span-1319">1</span></span></span><script type="math/tex" id="MathJax-Element-194">1</script>: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1320"><span class="MJXp-msubsup" id="MJXp-Span-1321"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1323" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324">n</span><span class="MJXp-mo" id="MJXp-Span-1325">−</span><span class="MJXp-mn" id="MJXp-Span-1326">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-195">a_{n-1}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1327"><span class="MJXp-msubsup" id="MJXp-Span-1328"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1329" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1330" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-196">a_n</script> must both be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1331"><span class="MJXp-mn" id="MJXp-Span-1332">0</span></span></span><script type="math/tex" id="MathJax-Element-197">0</script>. </li><li> If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1333"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334">l</span></span></span><script type="math/tex" id="MathJax-Element-198">l</script>'s bit is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1335"><span class="MJXp-mn" id="MJXp-Span-1336">0</span></span></span><script type="math/tex" id="MathJax-Element-199">0</script>: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1337"><span class="MJXp-msubsup" id="MJXp-Span-1338"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1339" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1340" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341">n</span><span class="MJXp-mo" id="MJXp-Span-1342">−</span><span class="MJXp-mn" id="MJXp-Span-1343">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-200">a_{n-1}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1344"><span class="MJXp-msubsup" id="MJXp-Span-1345"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1346" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1347" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-201">a_n</script> must be equal (both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1348"><span class="MJXp-mn" id="MJXp-Span-1349">0</span></span></span><script type="math/tex" id="MathJax-Element-202">0</script> or both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1350"><span class="MJXp-mn" id="MJXp-Span-1351">1</span></span></span><script type="math/tex" id="MathJax-Element-203">1</script>). </li></ul><p>From the per-bit constraints, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1352"><span class="MJXp-msubsup" id="MJXp-Span-1353"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1354" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1355" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1356">n</span><span class="MJXp-mo" id="MJXp-Span-1357">−</span><span class="MJXp-mn" id="MJXp-Span-1358">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-204">a_{n-1}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1359"><span class="MJXp-msubsup" id="MJXp-Span-1360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1361" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1362" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-205">a_n</script> must be equal at every bit, implying <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1363"><span class="MJXp-msubsup" id="MJXp-Span-1364"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1365" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1366" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1367">n</span><span class="MJXp-mo" id="MJXp-Span-1368">−</span><span class="MJXp-mn" id="MJXp-Span-1369">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1370" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1371"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1372" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1373" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-206">a_{n-1} = a_n</script>, so <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1374"><span class="MJXp-msubsup" id="MJXp-Span-1375"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1376" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1377" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1378">n</span><span class="MJXp-mo" id="MJXp-Span-1379">−</span><span class="MJXp-mn" id="MJXp-Span-1380">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1381" style="margin-left: 0.267em; margin-right: 0.267em;">⊕</span><span class="MJXp-msubsup" id="MJXp-Span-1382"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1384" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1385" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1386">0</span></span></span><script type="math/tex" id="MathJax-Element-207">a_{n-1}\oplus a_n=0</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1387"><span class="MJXp-msubsup" id="MJXp-Span-1388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1390" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1391">n</span><span class="MJXp-mo" id="MJXp-Span-1392">−</span><span class="MJXp-mn" id="MJXp-Span-1393">1</span></span></span><span class="MJXp-mspace" id="MJXp-Span-1394" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-1395">&amp;</span><span class="MJXp-mspace" id="MJXp-Span-1396" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1397"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1399" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1400" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1402" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1403" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-208">a_{n-1} \, \& \, a_n=a_n</script>. From <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1404"><span class="MJXp-msubsup" id="MJXp-Span-1405"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1406" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1407" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1408">n</span><span class="MJXp-mo" id="MJXp-Span-1409">−</span><span class="MJXp-mn" id="MJXp-Span-1410">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1411" style="margin-left: 0.267em; margin-right: 0.267em;">⊕</span><span class="MJXp-msubsup" id="MJXp-Span-1412"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1414" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1415" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1416">l</span><span class="MJXp-mspace" id="MJXp-Span-1417" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-1418">&amp;</span><span class="MJXp-mspace" id="MJXp-Span-1419" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1420"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1421" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1422" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1423">n</span><span class="MJXp-mo" id="MJXp-Span-1424">−</span><span class="MJXp-mn" id="MJXp-Span-1425">1</span></span></span><span class="MJXp-mspace" id="MJXp-Span-1426" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-1427">&amp;</span><span class="MJXp-mspace" id="MJXp-Span-1428" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1430" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1431" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-209">a_{n-1}\oplus a_n=l \, \& \, a_{n-1} \, \& \, a_n</script>, we have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1432"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433">l</span><span class="MJXp-mspace" id="MJXp-Span-1434" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-1435">&amp;</span><span class="MJXp-mspace" id="MJXp-Span-1436" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1437"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1438" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1439" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1440" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1441">0</span></span></span><script type="math/tex" id="MathJax-Element-210">l \, \& \, a_n=0</script>. Finally, we solve for the minimum <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1442"><span class="MJXp-msubsup" id="MJXp-Span-1443"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1444" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1445" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-211">a_n</script> by greedily going from high to low bit.</p><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1447">b</span></span></span><script type="math/tex" id="MathJax-Element-212">b</script> be the highest bit set in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1449">l</span></span></span><script type="math/tex" id="MathJax-Element-213">l</script>. Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1450"><span class="MJXp-msubsup" id="MJXp-Span-1451"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1452" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1453" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-214">a_n</script> must be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1454"><span class="MJXp-mo" id="MJXp-Span-1455" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1456">l</span></span></span><script type="math/tex" id="MathJax-Element-215">\ge l</script> but have bit <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1457"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1458">b</span></span></span><script type="math/tex" id="MathJax-Element-216">b</script> unset (due to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1459"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1460">l</span><span class="MJXp-mspace" id="MJXp-Span-1461" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-1462">&amp;</span><span class="MJXp-mspace" id="MJXp-Span-1463" style="width: 0.167em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1464"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1466" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1467" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1468">0</span></span></span><script type="math/tex" id="MathJax-Element-217">l \, \& \, a_n=0</script>), <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1469"><span class="MJXp-msubsup" id="MJXp-Span-1470"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1471" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1472" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-218">a_n</script> requires a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1473"><span class="MJXp-mn" id="MJXp-Span-1474">1</span></span></span><script type="math/tex" id="MathJax-Element-219">1</script> at some bit higher than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1475"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1476">b</span></span></span><script type="math/tex" id="MathJax-Element-220">b</script>. And bit <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1478">b</span></span></span><script type="math/tex" id="MathJax-Element-221">b</script> is already different, so the lower bits may be set to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1479"><span class="MJXp-mn" id="MJXp-Span-1480">0</span></span></span><script type="math/tex" id="MathJax-Element-222">0</script>, so eventually <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1481"><span class="MJXp-msubsup" id="MJXp-Span-1482"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1483" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1484" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-223">a_n</script> is the smallest power of two greater than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1485"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1486">l</span></span></span><script type="math/tex" id="MathJax-Element-224">l</script> that lies in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1487"><span class="MJXp-mo" id="MJXp-Span-1488" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1489">l</span><span class="MJXp-mo" id="MJXp-Span-1490" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1491">r</span><span class="MJXp-mo" id="MJXp-Span-1492" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-225">[l, r]</script>.</p><p>If no solution exists for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1493"><span class="MJXp-msubsup" id="MJXp-Span-1494"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1495" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1496" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1497">n</span><span class="MJXp-mo" id="MJXp-Span-1498">−</span><span class="MJXp-mn" id="MJXp-Span-1499">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1500" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1502" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1503" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-226">a_{n-1}, a_n</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1505">l</span></span></span><script type="math/tex" id="MathJax-Element-227">l</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1506"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1507">r</span></span></span><script type="math/tex" id="MathJax-Element-228">r</script> share the same highest bit <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1508"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1509">b</span></span></span><script type="math/tex" id="MathJax-Element-229">b</script>. The bitwise AND value is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1510"><span class="MJXp-mn" id="MJXp-Span-1511">1</span></span></span><script type="math/tex" id="MathJax-Element-230">1</script>, and the bitwise XOR value is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1512"><span class="MJXp-mn" id="MJXp-Span-1513">0</span></span></span><script type="math/tex" id="MathJax-Element-231">0</script> on this bit, so it is easy to see that there must be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1514"><span class="MJXp-msubsup" id="MJXp-Span-1515"><span class="MJXp-mi" id="MJXp-Span-1516" style="margin-right: 0.05em;">&amp;</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1521"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1522">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1517"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1518">i</span><span class="MJXp-mo" id="MJXp-Span-1519">=</span><span class="MJXp-mn" id="MJXp-Span-1520">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1523"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1524" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1525" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1526" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-msubsup" id="MJXp-Span-1527"><span class="MJXp-mo" id="MJXp-Span-1528" style="margin-left: 0.267em; margin-right: 0.05em;">⊕</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1533"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1534">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1529"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1530">i</span><span class="MJXp-mo" id="MJXp-Span-1531">=</span><span class="MJXp-mn" id="MJXp-Span-1532">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1535"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1536" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1537" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-232">\&_{i=1}^{n}a_i\neq\oplus_{i=1}^{n}a_i</script>.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="str">&lt;iostream&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="pln">l</span><span class="pun">,</span><span class="pln">r</span><span class="pun">,</span><span class="pln">k</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	cin</span><span class="pun">&gt;&gt;</span><span class="pln">t</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		cin</span><span class="pun">&gt;&gt;</span><span class="pln">n</span><span class="pun">&gt;&gt;</span><span class="pln">l</span><span class="pun">&gt;&gt;</span><span class="pln">r</span><span class="pun">&gt;&gt;</span><span class="pln">k</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">n</span><span class="pun">%</span><span class="lit">2</span><span class="pun">==</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			cout</span><span class="pun">&lt;&lt;</span><span class="pln">l</span><span class="pun">&lt;&lt;</span><span class="pln">endl</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">n</span><span class="pun">==</span><span class="lit">2</span><span class="pun">)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			cout</span><span class="pun">&lt;&lt;-</span><span class="lit">1</span><span class="pun">&lt;&lt;</span><span class="pln">endl</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> res</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">bool</span><span class="pln"> fl</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">res</span><span class="pun">&lt;=</span><span class="pln">r</span><span class="pun">)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">res</span><span class="pun">&gt;</span><span class="pln">l</span><span class="pun">)</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				fl</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">k</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">-</span><span class="lit">2</span><span class="pun">)</span><span class="pln">
				 cout</span><span class="pun">&lt;&lt;</span><span class="pln">l</span><span class="pun">&lt;&lt;</span><span class="pln">endl</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">else</span><span class="pln">
				 cout</span><span class="pun">&lt;&lt;</span><span class="pln">res</span><span class="pun">&lt;&lt;</span><span class="pln">endl</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			res</span><span class="pun">*=</span><span class="lit">2</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">fl</span><span class="pun">)</span><span class="pln">
		 cout</span><span class="pun">&lt;&lt;-</span><span class="lit">1</span><span class="pun">&lt;&lt;</span><span class="pln">endl</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2119/problem/D" title="Codeforces Round 1035 (Div. 2)">2119D - Token Removing</a></p><p>Author: <a class="rated-user user-red" href="https://codeforces.com/profile/YuJiahe" title="Grandmaster YuJiahe">YuJiahe</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Calculating the weight of a single valid sequence is difficult. Try another way?</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2119/problem/D" title="Codeforces Round 1035 (Div. 2)">2119D - Token Removing</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Consider determine which tokens will be removed first. Then we just need to count the number of ways that, for each position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1538"><span class="MJXp-msubsup" id="MJXp-Span-1539"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1540" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1541" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-233">p_i</script> with a token to be removed, find an closed segment <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1542"><span class="MJXp-mo" id="MJXp-Span-1543" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1544"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1545" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1546" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1547" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1548"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1549" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1550" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1551" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-234">[l_i, r_i]</script> that contains position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1552"><span class="MJXp-msubsup" id="MJXp-Span-1553"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1554" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1555" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-235">p_i</script>, and these <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1556"><span class="MJXp-msubsup" id="MJXp-Span-1557"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1558" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1559" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-236">r_i</script> are different to each other.</p><p>Assuming that the positions of the tokens are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1560"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1561">n</span><span class="MJXp-mo" id="MJXp-Span-1562" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-msubsup" id="MJXp-Span-1563"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1564" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1565" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1566" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-1567"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1568" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1569" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1570" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mo" id="MJXp-Span-1571" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-1572" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-1573"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1574" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1575" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1576">k</span><span class="MJXp-mo" id="MJXp-Span-1577">−</span><span class="MJXp-mn" id="MJXp-Span-1578">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1579" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-1580">1</span></span></span><script type="math/tex" id="MathJax-Element-237">n \ge p_0 > p_1 > \dots > p_{k - 1} \ge 1</script>, the answer to the above is obviously <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1581"><span class="MJXp-msubsup" id="MJXp-Span-1582"><span class="MJXp-mo" id="MJXp-Span-1583" style="margin-left: 0.111em; margin-right: 0.05em;">∏</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1588"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1589">k</span><span class="MJXp-mo" id="MJXp-Span-1590">−</span><span class="MJXp-mn" id="MJXp-Span-1591">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1584"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1585">i</span><span class="MJXp-mo" id="MJXp-Span-1586">=</span><span class="MJXp-mn" id="MJXp-Span-1587">0</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1592"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1593" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1594" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1595" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1596">n</span><span class="MJXp-mo" id="MJXp-Span-1597" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1598"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1599" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1600" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1601" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1602">1</span><span class="MJXp-mo" id="MJXp-Span-1603" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1604">i</span><span class="MJXp-mo" id="MJXp-Span-1605" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-238">\prod_{i = 0}^{k - 1} p_i(n - p_i + 1 - i)</script>. This inspires the following DP state: let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1606"><span class="MJXp-msubsup" id="MJXp-Span-1607"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1608" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1609" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1610">i</span><span class="MJXp-mo" id="MJXp-Span-1611">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1612">j</span></span></span></span></span><script type="math/tex" id="MathJax-Element-239">f_{i, j}</script> denote the answer for the sum of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1613"><span class="MJXp-msubsup" id="MJXp-Span-1614"><span class="MJXp-mo" id="MJXp-Span-1615" style="margin-left: 0.111em; margin-right: 0.05em;">∏</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1620"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1621">k</span><span class="MJXp-mo" id="MJXp-Span-1622">−</span><span class="MJXp-mn" id="MJXp-Span-1623">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1616"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1617">i</span><span class="MJXp-mo" id="MJXp-Span-1618">=</span><span class="MJXp-mn" id="MJXp-Span-1619">0</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1624"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1625" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1626" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1627" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1628">n</span><span class="MJXp-mo" id="MJXp-Span-1629" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1630"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1632" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1633" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1634">1</span><span class="MJXp-mo" id="MJXp-Span-1635" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1636">i</span><span class="MJXp-mo" id="MJXp-Span-1637" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-240">\prod_{i = 0}^{k - 1} p_i(n - p_i + 1 - i)</script> when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1638"><span class="MJXp-msubsup" id="MJXp-Span-1639"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1640" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1641" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1642">k</span><span class="MJXp-mo" id="MJXp-Span-1643">−</span><span class="MJXp-mn" id="MJXp-Span-1644">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1645" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1646">n</span><span class="MJXp-mo" id="MJXp-Span-1647" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1648">i</span><span class="MJXp-mo" id="MJXp-Span-1649" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1650">1</span></span></span><script type="math/tex" id="MathJax-Element-241">p_{k - 1} \ge n - i + 1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1651"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1652">k</span><span class="MJXp-mo" id="MJXp-Span-1653" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1654">i</span><span class="MJXp-mo" id="MJXp-Span-1655" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1656">j</span></span></span><script type="math/tex" id="MathJax-Element-242">k = i - j</script>. Consider whether <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1657"><span class="MJXp-msubsup" id="MJXp-Span-1658"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1659" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1660" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1661">k</span><span class="MJXp-mo" id="MJXp-Span-1662">−</span><span class="MJXp-mn" id="MJXp-Span-1663">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-243">p_{k - 1}</script> is equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1664"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1665">n</span><span class="MJXp-mo" id="MJXp-Span-1666" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1667">i</span><span class="MJXp-mo" id="MJXp-Span-1668" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1669">1</span></span></span><script type="math/tex" id="MathJax-Element-244">n - i + 1</script>, we have:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1670"><span class="MJXp-msubsup" id="MJXp-Span-1671"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1672" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1673" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1674">i</span><span class="MJXp-mo" id="MJXp-Span-1675">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1676">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1677" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1678"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1679" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1680" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1681">i</span><span class="MJXp-mo" id="MJXp-Span-1682">−</span><span class="MJXp-mn" id="MJXp-Span-1683">1</span><span class="MJXp-mo" id="MJXp-Span-1684">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1685">j</span><span class="MJXp-mo" id="MJXp-Span-1686">−</span><span class="MJXp-mn" id="MJXp-Span-1687">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1688" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1689" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1690">n</span><span class="MJXp-mo" id="MJXp-Span-1691" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1692">i</span><span class="MJXp-mo" id="MJXp-Span-1693" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1694">1</span><span class="MJXp-mo" id="MJXp-Span-1695" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1696" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1697">j</span><span class="MJXp-mo" id="MJXp-Span-1698" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1699">1</span><span class="MJXp-mo" id="MJXp-Span-1700" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1701"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1702" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1703" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1704">i</span><span class="MJXp-mo" id="MJXp-Span-1705">−</span><span class="MJXp-mn" id="MJXp-Span-1706">1</span><span class="MJXp-mo" id="MJXp-Span-1707">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1708">j</span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-245"> f_{i, j} = f_{i - 1, j - 1} + (n - i + 1)(j + 1) f_{i - 1, j} </script></p><p>The answer is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1709"><span class="MJXp-msubsup" id="MJXp-Span-1710"><span class="MJXp-mo" id="MJXp-Span-1711" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1716">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1712"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1713">j</span><span class="MJXp-mo" id="MJXp-Span-1714">=</span><span class="MJXp-mn" id="MJXp-Span-1715">0</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1717"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1718" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1719" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1720">n</span><span class="MJXp-mo" id="MJXp-Span-1721">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1722">j</span></span></span></span></span><script type="math/tex" id="MathJax-Element-246">\sum_{j = 0}^n f_{n, j}</script>. The total time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1723"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1724">O</span><span class="MJXp-mo" id="MJXp-Span-1725" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1726"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1728" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1729" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-247">O(n^2)</script>.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;algorithm&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstring&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstdio&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;vector&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;queue&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N </span><span class="pun">=</span><span class="pln"> </span><span class="lit">5005</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> mod</span><span class="pun">,</span><span class="pln"> f</span><span class="pun">[</span><span class="pln">N</span><span class="pun">][</span><span class="pln">N</span><span class="pun">],</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">&amp;</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">){</span><span class="pln">x </span><span class="pun">+=</span><span class="pln"> y</span><span class="pun">;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">&gt;=</span><span class="pln"> mod</span><span class="pun">)</span><span class="pln"> x </span><span class="pun">-=</span><span class="pln"> mod</span><span class="pun">;}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">t</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t </span><span class="pun">--){</span><span class="pln">scanf</span><span class="pun">(</span><span class="str">"%d%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">mod</span><span class="pun">),</span><span class="pln"> f</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">++)</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">j </span><span class="pun">&lt;=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">j </span><span class="pun">++)</span><span class="pln"> f</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">++)</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> now</span><span class="pun">;</span><span class="pln">j </span><span class="pun">&lt;</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">j </span><span class="pun">++)</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">now </span><span class="pun">=</span><span class="pln"> f</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">j</span><span class="pun">])</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">],</span><span class="pln"> now</span><span class="pun">),</span><span class="pln">
		f</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1ll</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> now</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">j </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">j </span><span class="pun">++)</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">,</span><span class="pln"> f</span><span class="pun">[</span><span class="pln">n</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]);</span><span class="pln">printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln"> ans</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2119/problem/E" title="Codeforces Round 1035 (Div. 2)">2119E - And Constraint</a></p><p>Author: <a class="rated-user user-blue" href="https://codeforces.com/profile/ma2021tyoi0037" title="Expert ma2021tyoi0037">ma2021tyoi0037</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>As same as the title, can you find a simple necessary constraint? </p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Consider <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-142" style="width: 3.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.708em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1002.65em, 2.492em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-143"><span class="msubsup" id="MathJax-Span-144"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-145" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-146" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mn" id="MathJax-Span-148" style="font-family: MathJax_Main; padding-left: 0.273em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-22">a_i = 0</script> first.</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2119/problem/E" title="Codeforces Round 1035 (Div. 2)">2119E - And Constraint</a></h3><div class="ttypography"><div class="problem-statement"><div><p>First, obviously <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1730"><span class="MJXp-msubsup" id="MJXp-Span-1731"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1732" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1733" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-248">b_i</script> must include <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1734"><span class="MJXp-msubsup" id="MJXp-Span-1735"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1736" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1737" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1738">i</span><span class="MJXp-mo" id="MJXp-Span-1739">−</span><span class="MJXp-mn" id="MJXp-Span-1740">1</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1741"><span class="MJXp-mo" id="MJXp-Span-1742" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1743"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1744" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1745" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1746">i</span></span></span></span></span><script type="math/tex" id="MathJax-Element-249">a_{i-1} | a_{i}</script>, which is the fundamental requirement.</p><p>Secondly, we can note that there are only <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1747"><span class="MJXp-mn" id="MJXp-Span-1748">31</span></span></span><script type="math/tex" id="MathJax-Element-250">31</script> possible effective values for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1749"><span class="MJXp-msubsup" id="MJXp-Span-1750"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1751" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1752" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-251">b_i</script>:</p><ol> <li> Considering the upper bound of the problem, it is not difficult to increase all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1753"><span class="MJXp-msubsup" id="MJXp-Span-1754"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1755" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1756" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-252">b_i</script> to above <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1757"><span class="MJXp-msubsup" id="MJXp-Span-1758"><span class="MJXp-mn" id="MJXp-Span-1759" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1760" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1761">29</span></span></span></span></span><script type="math/tex" id="MathJax-Element-253">2^{29}</script>, then change some bits to above <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1762"><span class="MJXp-msubsup" id="MJXp-Span-1763"><span class="MJXp-mn" id="MJXp-Span-1764" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1765" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1766">30</span></span></span></span></span><script type="math/tex" id="MathJax-Element-254">2^{30}</script>, and then satisfy the previous constraints. </li><li> Consider how to make the effective values so few. </li></ol><p>We might consider which <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1767"><span class="MJXp-msubsup" id="MJXp-Span-1768"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1769" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1770" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-255">b_i</script> are more likely to be the answer. Apart from the binary bit constraints that must be satisfied, we should try to avoid having 1s in each binary bit as much as possible, because this might cause our sequence not to satisfy the conditions.</p><p>Observing the process of increasing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1771"><span class="MJXp-msubsup" id="MJXp-Span-1772"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1773" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1774" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-256">b_i</script>, the useful <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1775"><span class="MJXp-msubsup" id="MJXp-Span-1776"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1777" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1778" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-257">b_i</script> exhibit a stepped pattern: the preceding bits are the same as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1779"><span class="MJXp-msubsup" id="MJXp-Span-1780"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1781" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1782" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-258">b_i</script>, the next bit is set to 1, and all subsequent bits are 0. Numbers not on this step are certainly useless.</p><p>However, we did not consider the bits that are forced to be included earlier. We can directly apply the bitwise OR with this constraint, and then we find the useful values.</p><p>With the useful values, we can directly design <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1783"><span class="MJXp-msubsup" id="MJXp-Span-1784"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1785" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1786" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1787">i</span><span class="MJXp-mo" id="MJXp-Span-1788">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1789">j</span></span></span></span></span><script type="math/tex" id="MathJax-Element-259">f_{i,j}</script> to represent the minimum number of operations when the first <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1790"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1791">i</span></span></span><script type="math/tex" id="MathJax-Element-260">i</script> numbers have been determined, and the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1792"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1793">i</span></span></span><script type="math/tex" id="MathJax-Element-261">i</script>-th number becomes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1794"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1795">j</span></span></span><script type="math/tex" id="MathJax-Element-262">j</script>.</p><p>During the transition, we can enumerate the value <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1796"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1797">k</span></span></span><script type="math/tex" id="MathJax-Element-263">k</script> for the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1798"><span class="MJXp-mo" id="MJXp-Span-1799" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1800">i</span><span class="MJXp-mo" id="MJXp-Span-1801" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1802">1</span><span class="MJXp-mo" id="MJXp-Span-1803" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-264">(i+1)</script>-th position, and if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1804"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1805">j</span><span class="MJXp-mspace" id="MJXp-Span-1806" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-1807">&amp;</span><span class="MJXp-mspace" id="MJXp-Span-1808" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1809">k</span></span></span><script type="math/tex" id="MathJax-Element-265">j \, \& \, k</script> satisfies the constraint, then we can make the transition.</p><p>The time complexity of this algorithm is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1810"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1811">O</span><span class="MJXp-mo" id="MJXp-Span-1812" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1813">n</span><span class="MJXp-msubsup" id="MJXp-Span-1814"><span class="MJXp-mi" id="MJXp-Span-1815" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1816" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1817" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1818">V</span><span class="MJXp-mo" id="MJXp-Span-1819" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-266">O(n \log^2 V)</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1820"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1821">V</span></span></span><script type="math/tex" id="MathJax-Element-267">V</script> is the maximum value among <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1822"><span class="MJXp-msubsup" id="MJXp-Span-1823"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1824" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1825" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-268">a_i</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1826"><span class="MJXp-msubsup" id="MJXp-Span-1827"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1828" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1829" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-269">b_i</script>.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">struct</span><span class="pln"> stu</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
	ll dp</span><span class="pun">;</span><span class="pln">
</span><span class="pun">};</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="lit">100007</span><span class="pun">],</span><span class="pln">b</span><span class="pun">[</span><span class="lit">100007</span><span class="pun">];</span><span class="pln">
vector</span><span class="str">&lt;stu&gt;</span><span class="pln"> f</span><span class="pun">,</span><span class="pln">g</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> ll inf</span><span class="pun">=</span><span class="lit">0x3f3f3f3f3f3f3f3f</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Subt</span><span class="pun">(){</span><span class="pln">
	cin</span><span class="pun">&gt;&gt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln"> cin</span><span class="pun">&gt;&gt;</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln"> cin</span><span class="pun">&gt;&gt;</span><span class="pln">b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
	a</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	f</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
	f</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">((</span><span class="pln">stu</span><span class="pun">){</span><span class="lit">0</span><span class="pun">,</span><span class="lit">0</span><span class="pun">});</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++){</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		g</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">30</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&gt;=-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">--){</span><span class="pln">
			</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">=</span><span class="pln">x</span><span class="pun">|</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]|</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">j</span><span class="pun">!=-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> y</span><span class="pun">|=(</span><span class="lit">1</span><span class="pun">&lt;&lt;</span><span class="pln">j</span><span class="pun">);</span><span class="pln"> 
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">y</span><span class="pun">&gt;=</span><span class="pln">b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]){</span><span class="pln">
				ll mn</span><span class="pun">=</span><span class="pln">inf</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">stu l</span><span class="pun">:</span><span class="pln">f</span><span class="pun">){</span><span class="pln">
					</span><span class="kwd">if</span><span class="pun">((</span><span class="pln">l</span><span class="pun">.</span><span class="pln">x</span><span class="pun">&amp;</span><span class="pln">y</span><span class="pun">)!=</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">])</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
					mn</span><span class="pun">=</span><span class="pln">min</span><span class="pun">(</span><span class="pln">mn</span><span class="pun">,</span><span class="pln">l</span><span class="pun">.</span><span class="pln">dp</span><span class="pun">+</span><span class="pln">y</span><span class="pun">-</span><span class="pln">b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">mn</span><span class="pun">&lt;</span><span class="pln">inf</span><span class="pun">)</span><span class="pln"> g</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">((</span><span class="pln">stu</span><span class="pun">){</span><span class="pln">y</span><span class="pun">,</span><span class="pln">mn</span><span class="pun">});</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			x</span><span class="pun">|=((</span><span class="lit">1</span><span class="pun">&lt;&lt;</span><span class="pln">j</span><span class="pun">)&amp;</span><span class="pln">b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		swap</span><span class="pun">(</span><span class="pln">f</span><span class="pun">,</span><span class="pln">g</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	ll mn</span><span class="pun">=</span><span class="pln">inf</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">stu l</span><span class="pun">:</span><span class="pln">f</span><span class="pun">)</span><span class="pln"> mn</span><span class="pun">=</span><span class="pln">min</span><span class="pun">(</span><span class="pln">mn</span><span class="pun">,</span><span class="pln">l</span><span class="pun">.</span><span class="pln">dp</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">mn</span><span class="pun">&lt;</span><span class="pln">inf</span><span class="pun">)</span><span class="pln"> cout</span><span class="pun">&lt;&lt;</span><span class="pln">mn</span><span class="pun">&lt;&lt;</span><span class="pln">endl</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">else</span><span class="pln"> cout</span><span class="pun">&lt;&lt;-</span><span class="lit">1</span><span class="pun">&lt;&lt;</span><span class="pln">endl</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
	ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="lit">0</span><span class="pun">),</span><span class="pln">cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">),</span><span class="pln">cout</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	cin</span><span class="pun">&gt;&gt;</span><span class="pln">T</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln"> </span><span class="typ">Subt</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2119/problem/F" title="Codeforces Round 1035 (Div. 2)">2119F - Volcanic Eruptions</a></p><p>Author: <a class="rated-user user-blue" href="https://codeforces.com/profile/lizhous" title="Expert lizhous">lizhous</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Try to determine the vertex where you were before the last move.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>I just need to calculate the earliest time I can reach the end vertex.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>What form of moving path from the starting vertex to the end vertex is considered optimal?</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2119/problem/F" title="Codeforces Round 1035 (Div. 2)">2119F - Volcanic Eruptions</a></h3><div class="ttypography"><div class="problem-statement"><div><p>We define a "TURN" as consecutively traversing the same edge. Define the endpoint as the vertex reached before the last move. Use <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1830"><span class="MJXp-mo" id="MJXp-Span-1831" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1832">a</span><span class="MJXp-mo" id="MJXp-Span-1833" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1834">b</span><span class="MJXp-mo" id="MJXp-Span-1835" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-270">(a,b)</script> to define an edge <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1836"><span class="MJXp-mo" id="MJXp-Span-1837" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1838">u</span><span class="MJXp-mo" id="MJXp-Span-1839" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1840">v</span><span class="MJXp-mo" id="MJXp-Span-1841" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-271">(u,v)</script> satisfied <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1842"><span class="MJXp-msubsup" id="MJXp-Span-1843"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1844" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1845" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-1846" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1847">a</span><span class="MJXp-mo" id="MJXp-Span-1848" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1849"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1850" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1851" style="vertical-align: -0.4em;">v</span></span><span class="MJXp-mo" id="MJXp-Span-1852" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1853">b</span></span></span><script type="math/tex" id="MathJax-Element-272">w_u=a,w_v=b</script>.</p><p>First, if the path does not traverse through the edge <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1854"><span class="MJXp-mo" id="MJXp-Span-1855" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1856">1</span><span class="MJXp-mo" id="MJXp-Span-1857" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1858">1</span><span class="MJXp-mo" id="MJXp-Span-1859" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-273">(1,1)</script>, the sequence of vertex weights along the path must alternate between <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1860"><span class="MJXp-mn" id="MJXp-Span-1861">1</span></span></span><script type="math/tex" id="MathJax-Element-274">1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1862"><span class="MJXp-mo" id="MJXp-Span-1863" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1864">1</span></span></span><script type="math/tex" id="MathJax-Element-275">-1</script>. The maximum moves can be computed by enumerating endpoints <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1865"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1866">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1867">d</span></span></span><script type="math/tex" id="MathJax-Element-276">ed</script> where the path from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1868"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1869">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1870">t</span></span></span><script type="math/tex" id="MathJax-Element-277">st</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1871"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1872">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1873">d</span></span></span><script type="math/tex" id="MathJax-Element-278">ed</script> satisfies this alternation. Then we can repeatedly increase the number of TURNs at any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1874"><span class="MJXp-mo" id="MJXp-Span-1875" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1876">1</span><span class="MJXp-mo" id="MJXp-Span-1877" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1878" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1879">1</span><span class="MJXp-mo" id="MJXp-Span-1880" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-279">(1,-1)</script> to ensure you always reach the endpoint just before the lava does. A simple parity check then suffices to compute the answer for this endpoint.</p><p>The remaining paths must include <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1881"><span class="MJXp-mo" id="MJXp-Span-1882" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1883">1</span><span class="MJXp-mo" id="MJXp-Span-1884" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1885">1</span><span class="MJXp-mo" id="MJXp-Span-1886" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-280">(1,1)</script>. We observe that performing TURNs on more than one distinct edge is suboptimal. This is because all TURNs can be adjusted to occur on the first traversal of the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1887"><span class="MJXp-mo" id="MJXp-Span-1888" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1889">1</span><span class="MJXp-mo" id="MJXp-Span-1890" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1891">1</span><span class="MJXp-mo" id="MJXp-Span-1892" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-281">(1,1)</script> edge. Specifically, if the current path involves <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1893"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1894">x</span></span></span><script type="math/tex" id="MathJax-Element-282">x</script> TURNs, we can modify it to perform all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1895"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1896">x</span></span></span><script type="math/tex" id="MathJax-Element-283">x</script> TURNs on the first traversal of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1897"><span class="MJXp-mo" id="MJXp-Span-1898" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1899">1</span><span class="MJXp-mo" id="MJXp-Span-1900" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1901">1</span><span class="MJXp-mo" id="MJXp-Span-1902" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-284">(1,1)</script> and then remove all remaining TURNs. This adjustment does not affect the validity of the path:</p><p>1. Path continuity: The start and end vertices of a TURN are the same, so adding or removing a TURN does not break the path's continuity.</p><p>2. Death by lava: Since your speed matches the lava's, as long as you are not in the lava at the end, you won't encounter it midway.</p><p>3. Death by low health: Before the first <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1903"><span class="MJXp-mo" id="MJXp-Span-1904" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1905">1</span><span class="MJXp-mo" id="MJXp-Span-1906" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1907">1</span><span class="MJXp-mo" id="MJXp-Span-1908" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-285">(1,1)</script>, the path must alternate between <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1909"><span class="MJXp-mn" id="MJXp-Span-1910">1</span></span></span><script type="math/tex" id="MathJax-Element-286">1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1911"><span class="MJXp-mo" id="MJXp-Span-1912" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1913">1</span></span></span><script type="math/tex" id="MathJax-Element-287">-1</script>. Removing TURNs in this segment won't cause death. Moreover, since the number of TURNs at this <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1914"><span class="MJXp-mo" id="MJXp-Span-1915" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1916">1</span><span class="MJXp-mo" id="MJXp-Span-1917" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1918">1</span><span class="MJXp-mo" id="MJXp-Span-1919" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-288">(1,1)</script> is no fewer than in the original plan, the health at the vertices after TURNs will be no lower than in the original plan, ensuring no death.</p><p>If the endpoint is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1920"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1921">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1922">d</span></span></span><script type="math/tex" id="MathJax-Element-289">ed</script>, then based on the conclusion that TURNs occur only on one edge, the optimal path must consist of a main path from the start <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1923"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1924">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1925">t</span></span></span><script type="math/tex" id="MathJax-Element-290">st</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1926"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1927">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1928">d</span></span></span><script type="math/tex" id="MathJax-Element-291">ed</script> with a TURN branch attached. This branch must satisfy:</p><p>— Its outermost edge is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1929"><span class="MJXp-mo" id="MJXp-Span-1930" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1931">1</span><span class="MJXp-mo" id="MJXp-Span-1932" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1933">1</span><span class="MJXp-mo" id="MJXp-Span-1934" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-292">(1,1)</script>.</p><p>— The path leading to this edge alternates between <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1935"><span class="MJXp-mn" id="MJXp-Span-1936">1</span></span></span><script type="math/tex" id="MathJax-Element-293">1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1937"><span class="MJXp-mo" id="MJXp-Span-1938" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1939">1</span></span></span><script type="math/tex" id="MathJax-Element-294">-1</script>.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/9c6edde1819fb24d2ece9149fdac6d6632fa6226.png" style="max-width: 100.0%;max-height: 100.0%;">   </center><p>For a given <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1940"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1941">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1942">d</span></span></span><script type="math/tex" id="MathJax-Element-295">ed</script>, to reach the endpoint earlier, we need to find the nearest <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1943"><span class="MJXp-mo" id="MJXp-Span-1944" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1945">1</span><span class="MJXp-mo" id="MJXp-Span-1946" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1947">1</span><span class="MJXp-mo" id="MJXp-Span-1948" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-296">(1,1)</script> to the main path where the segment from the start to it alternates between <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1949"><span class="MJXp-mn" id="MJXp-Span-1950">1</span></span></span><script type="math/tex" id="MathJax-Element-297">1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1951"><span class="MJXp-mo" id="MJXp-Span-1952" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1953">1</span></span></span><script type="math/tex" id="MathJax-Element-298">-1</script>. We can perform a BFS starting from each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1954"><span class="MJXp-mo" id="MJXp-Span-1955" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1956">1</span><span class="MJXp-mo" id="MJXp-Span-1957" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1958">1</span><span class="MJXp-mo" id="MJXp-Span-1959" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-299">(1,1)</script>, selecting the next vertex under the condition that its weight <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1960"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1961">w</span></span></span><script type="math/tex" id="MathJax-Element-300">w</script> differs from the current vertex's. This allows us to preprocess the nearest <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1962"><span class="MJXp-mo" id="MJXp-Span-1963" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1964">1</span><span class="MJXp-mo" id="MJXp-Span-1965" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1966">1</span><span class="MJXp-mo" id="MJXp-Span-1967" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-301">(1,1)</script> for each vertex, which can then be directly referenced when constructing the main path.</p><p>For a given <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1968"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1969">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1970">d</span></span></span><script type="math/tex" id="MathJax-Element-302">ed</script>, the vertex with the minimum health is also determined, since the TURN branch (alternating between <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1971"><span class="MJXp-mn" id="MJXp-Span-1972">1</span></span></span><script type="math/tex" id="MathJax-Element-303">1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1973"><span class="MJXp-mo" id="MJXp-Span-1974" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1975">1</span></span></span><script type="math/tex" id="MathJax-Element-304">-1</script>) does not affect the minimum health vertex. Thus, ensuring health remains above zero at all times reduces to ensuring the minimum health vertex satisfies this condition.</p><p>For a given <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1977">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1978">d</span></span></span><script type="math/tex" id="MathJax-Element-305">ed</script>, all constraints can be easily resolved to compute the earliest arrival time at the endpoint. Since your speed matches the lava's, we only need to compare your arrival time with the lava's to determine if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1979"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1980">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1981">d</span></span></span><script type="math/tex" id="MathJax-Element-306">ed</script> is a valid endpoint.</p><p>After fixing the endpoint, we can repeatedly increase the number of TURNs at <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1982"><span class="MJXp-mo" id="MJXp-Span-1983" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1984">1</span><span class="MJXp-mo" id="MJXp-Span-1985" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1986">1</span><span class="MJXp-mo" id="MJXp-Span-1987" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-307">(1,1)</script> to ensure you always reach the endpoint just before the lava does. A simple parity check then suffices to compute the answer for this endpoint.</p><p>The final answer is the maximum value obtained across all possible endpoints.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="str">&lt;iostream&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;cstdio&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;algorithm&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;cstring&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;vector&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;set&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;queue&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;unordered_map&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="str">&lt;map&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln">st</span><span class="pun">,</span><span class="pln">dist</span><span class="pun">[</span><span class="lit">1000002</span><span class="pun">],</span><span class="pln">w</span><span class="pun">[</span><span class="lit">1000001</span><span class="pun">],</span><span class="pln">tim</span><span class="pun">[</span><span class="lit">1000001</span><span class="pun">],</span><span class="pln">ans</span><span class="pun">;</span><span class="pln">
vector </span><span class="str">&lt;int&gt;</span><span class="pln"> g</span><span class="pun">[</span><span class="lit">1000001</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> f</span><span class="pun">[</span><span class="lit">1000001</span><span class="pun">];</span><span class="pln">
queue</span><span class="str">&lt;int&gt;</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> getdis</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> fa</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">:</span><span class="pln">g</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">v</span><span class="pun">==</span><span class="pln">fa</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
		dist</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]=</span><span class="pln">dist</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		getdis</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln">u</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> dfs</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> fa</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">,</span><span class="kwd">bool</span><span class="pln"> inn</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> hei</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> TIM</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> dis</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">hei</span><span class="pun">&lt;</span><span class="lit">0</span><span class="pun">)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		TIM</span><span class="pun">=</span><span class="pln">max</span><span class="pun">(</span><span class="pln">TIM</span><span class="pun">,(-</span><span class="pln">hei</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)/</span><span class="lit">2</span><span class="pun">*</span><span class="lit">2</span><span class="pun">+</span><span class="pln">k</span><span class="pun">*</span><span class="lit">2</span><span class="pun">+</span><span class="pln">dis</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">TIM</span><span class="pun">&lt;=</span><span class="pln">dist</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		ans</span><span class="pun">=</span><span class="pln">max</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">,</span><span class="pln">dist</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">else</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">:</span><span class="pln">g</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">v</span><span class="pun">==</span><span class="pln">fa</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">inn</span><span class="pun">&amp;&amp;</span><span class="pln">w</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]!=</span><span class="pln">w</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			dfs</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln">u</span><span class="pun">,</span><span class="pln">min</span><span class="pun">(</span><span class="pln">k</span><span class="pun">,</span><span class="pln">tim</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]),</span><span class="pln">inn</span><span class="pun">,</span><span class="pln">hei</span><span class="pun">+</span><span class="pln">w</span><span class="pun">[</span><span class="pln">v</span><span class="pun">],</span><span class="pln">TIM</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">dis</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">else</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			dfs</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln">u</span><span class="pun">,</span><span class="pln">k</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="pln">hei</span><span class="pun">+</span><span class="pln">w</span><span class="pun">[</span><span class="pln">v</span><span class="pun">],</span><span class="pln">TIM</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">dis</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">;</span><span class="pln"> 
</span><span class="kwd">signed</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
	cin</span><span class="pun">&gt;&gt;</span><span class="pln">T</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> cnt</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		cnt</span><span class="pun">++;</span><span class="pln">
		cin</span><span class="pun">&gt;&gt;</span><span class="pln">n</span><span class="pun">&gt;&gt;</span><span class="pln">st</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			dist</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			tim</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">1000000000</span><span class="pun">;</span><span class="pln">
			g</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
			f</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=-</span><span class="lit">10000000000000000</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		ans</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			cin</span><span class="pun">&gt;&gt;</span><span class="pln">w</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">u</span><span class="pun">,</span><span class="pln">v</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			cin</span><span class="pun">&gt;&gt;</span><span class="pln">u</span><span class="pun">&gt;&gt;</span><span class="pln">v</span><span class="pun">;</span><span class="pln">
			g</span><span class="pun">[</span><span class="pln">u</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
			g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">u</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		getdis</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">:</span><span class="pln">g</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">w</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]==</span><span class="lit">1</span><span class="pun">&amp;&amp;</span><span class="pln">w</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]==</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
				</span><span class="pun">{</span><span class="pln">
					tim</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
					q</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
					</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">while</span><span class="pun">(!</span><span class="pln">q</span><span class="pun">.</span><span class="pln">empty</span><span class="pun">())</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">=</span><span class="pln">q</span><span class="pun">.</span><span class="pln">front</span><span class="pun">();</span><span class="pln">
			q</span><span class="pun">.</span><span class="pln">pop</span><span class="pun">();</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">:</span><span class="pln">g</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">tim</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]==</span><span class="lit">1000000000</span><span class="pun">&amp;&amp;</span><span class="pln">w</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]!=</span><span class="pln">w</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln">
				</span><span class="pun">{</span><span class="pln">
					tim</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]=</span><span class="pln">tim</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
					q</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		dfs</span><span class="pun">(</span><span class="pln">st</span><span class="pun">,-</span><span class="lit">1</span><span class="pun">,</span><span class="pln">tim</span><span class="pun">[</span><span class="pln">st</span><span class="pun">],</span><span class="lit">1</span><span class="pun">,</span><span class="pln">w</span><span class="pun">[</span><span class="pln">st</span><span class="pun">],</span><span class="lit">1</span><span class="pun">,</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		cout</span><span class="pun">&lt;&lt;</span><span class="pln">ans</span><span class="pun">+(</span><span class="pln">dist</span><span class="pun">[</span><span class="pln">st</span><span class="pun">]&amp;</span><span class="lit">1</span><span class="pun">)-</span><span class="lit">1</span><span class="pun">&lt;&lt;</span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2119" class="notice" style="text-decoration: none;">Codeforces Round 1035 (Div. 2)</a> </span>
        </div>
        
            

  <script>
    // Make all spoilers toggleable
    document.querySelectorAll('.spoiler-title').forEach(title => {
      title.addEventListener('click', function() {
        const spoiler = this.closest('.spoiler');
        spoiler.classList.toggle('open');
      });
    });
    
    // Open all spoilers by default for easier reading
    document.querySelectorAll('.spoiler').forEach(spoiler => {
      spoiler.classList.add('open');
    });
  </script>
</body>
</html>