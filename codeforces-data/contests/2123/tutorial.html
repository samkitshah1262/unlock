<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tutorial</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
      color: #333;
      background: #fafafa;
    }
    .ttypography {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    h3 {
      color: #1a1a1a;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }
    h3 a {
      color: #0066cc;
      text-decoration: none;
    }
    h3 a:hover {
      text-decoration: underline;
    }
    .spoiler {
      margin: 15px 0;
      border: 1px solid #ddd;
      border-radius: 6px;
      overflow: hidden;
    }
    .spoiler-title {
      display: block;
      padding: 12px 15px;
      background: #f0f0f0;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
      border-bottom: 1px solid #ddd;
    }
    .spoiler-title:hover {
      background: #e8e8e8;
    }
    .spoiler-title::before {
      content: '▶ ';
      font-size: 0.8em;
      transition: transform 0.2s;
      display: inline-block;
    }
    .spoiler.open .spoiler-title::before {
      content: '▼ ';
    }
    .spoiler-content {
      padding: 15px;
      background: #fff;
      display: none;
    }
    .spoiler.open .spoiler-content {
      display: block;
    }
    pre, code {
      background: #f5f5f5;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 0.85em;
    }
    pre {
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
    code {
      padding: 2px 5px;
      border-radius: 3px;
    }
    p {
      margin: 10px 0;
    }
    .MathJax {
      font-size: 1.1em;
    }
  </style>
</head>
<body>
  <h1>Editorial</h1>
  <p><a href="https://codeforces.com/blog/entry/144363" target="_blank">View on Codeforces →</a></p>
  
  <div class="ttypography"><p>I hope you all enjoyed the contest!</p> <div class="spoiler"><b class="spoiler-title">Rating Predictions</b><div class="spoiler-content" style="display: block;"><table class="bordertable">   <thead>     <tr>       <th>Predictor </th>       <th>A </th>       <th>B </th>       <th>C </th>       <th>D </th>       <th>E </th>       <th>F </th>       <th>G </th>     </tr>   </thead>   <tbody>     <tr>       <td><a class="rated-user user-orange" href="https://codeforces.com/profile/AksLolCoding" title="Master AksLolCoding">AksLolCoding</a> </td>       <td>800 </td>       <td>900 </td>       <td>1000 </td>       <td>1500 </td>       <td>1500 </td>       <td>1800 </td>       <td>1700 </td>     </tr>     <tr>       <td><a class="rated-user user-orange" href="https://codeforces.com/profile/__baozii__" title="International Master __baozii__">__baozii__</a> </td>       <td>800 </td>       <td>800 </td>       <td>1200 </td>       <td>1500 </td>       <td>1500 </td>       <td>1600 </td>       <td>1900 </td>     </tr>     <tr>       <td><a class="rated-user user-blue" href="https://codeforces.com/profile/DivinePunishment" title="Expert DivinePunishment">DivinePunishment</a> </td>       <td>800 </td>       <td>900 </td>       <td>1100 </td>       <td>1400 </td>       <td>1500 </td>       <td>1600 </td>       <td>1900 </td>     </tr>     <tr>       <td><a class="rated-user user-orange" href="https://codeforces.com/profile/Edeeva" title="Master Edeeva">Edeeva</a> </td>       <td>800 </td>       <td>800 </td>       <td>1000 </td>       <td>1200 </td>       <td>1600 </td>       <td>1800 </td>       <td>2200 </td>     </tr>     <tr>       <td><a class="rated-user user-orange" href="https://codeforces.com/profile/efishel" title="Master efishel">efishel</a> </td>       <td>800 </td>       <td>800 </td>       <td>1000 </td>       <td>1200 </td>       <td>1400 </td>       <td>1500 </td>       <td>1900 </td>     </tr>     <tr>       <td><a class="rated-user user-orange" href="https://codeforces.com/profile/-firefly-" title="Master -firefly-">-firefly-</a> </td>       <td>800 </td>       <td>800 </td>       <td>900 </td>       <td>1400 </td>       <td>1500 </td>       <td>1700 </td>       <td>2000 </td>     </tr>     <tr>       <td><a class="rated-user user-blue" href="https://codeforces.com/profile/hashman" title="Expert hashman">hashman</a> </td>       <td>800 </td>       <td>900 </td>       <td>1100 </td>       <td>1600 </td>       <td>1500 </td>       <td>1800 </td>       <td>2000 </td>     </tr>     <tr>       <td><a class="rated-user user-violet" href="https://codeforces.com/profile/Hori" title="Candidate Master Hori">Hori</a> </td>       <td>800 </td>       <td>800 </td>       <td>1200 </td>       <td>1600 </td>       <td>1400 </td>       <td>1500 </td>       <td>2000 </td>     </tr>     <tr>       <td><a class="rated-user user-blue" href="https://codeforces.com/profile/kevlu8" title="Expert kevlu8">kevlu8</a> </td>       <td>800 </td>       <td>900 </td>       <td>1000 </td>       <td>1300 </td>       <td>1600 </td>       <td>1700 </td>       <td>— </td>     </tr>     <tr>       <td><a class="rated-user user-orange" href="https://codeforces.com/profile/Lilypad" title="Master Lilypad">Lilypad</a> </td>       <td>800 </td>       <td>900 </td>       <td>1100 </td>       <td>1400 </td>       <td>1400 </td>       <td>1500 </td>       <td>— </td>     </tr>     <tr>       <td><a class="rated-user user-violet" href="https://codeforces.com/profile/LMeyling" title="Candidate Master LMeyling">LMeyling</a> </td>       <td>800 </td>       <td>800 </td>       <td>1000 </td>       <td>1300 </td>       <td>1600 </td>       <td>1700 </td>       <td>2100 </td>     </tr>     <tr>       <td><a class="rated-user user-blue" href="https://codeforces.com/profile/macaquedev" title="Expert macaquedev">macaquedev</a> </td>       <td>800 </td>       <td>900 </td>       <td>800 </td>       <td>900 </td>       <td>1500 </td>       <td>1600 </td>       <td>1600 </td>     </tr>     <tr>       <td><a class="rated-user user-blue" href="https://codeforces.com/profile/Non-origination" title="Expert Non-origination">Non-origination</a> </td>       <td>800 </td>       <td>800 </td>       <td>1200 </td>       <td>1500 </td>       <td>1500 </td>       <td>1800 </td>       <td>2100 </td>     </tr>     <tr>       <td><a class="rated-user user-orange" href="https://codeforces.com/profile/Proof_by_QED" title="Master Proof_by_QED">Proof_by_QED</a> </td>       <td>800 </td>       <td>1000 </td>       <td>1100 </td>       <td>1400 </td>       <td>1600 </td>       <td>1800 </td>       <td>2100 </td>     </tr>     <tr>       <td><a class="rated-user user-violet" href="https://codeforces.com/profile/reirugan" title="Candidate Master reirugan">reirugan</a> </td>       <td>800 </td>       <td>800 </td>       <td>1100 </td>       <td>1400 </td>       <td>1600 </td>       <td>1700 </td>       <td>2000 </td>     </tr>     <tr>       <td><a class="rated-user user-blue" href="https://codeforces.com/profile/SpyrosAliv" title="Expert SpyrosAliv">SpyrosAliv</a> </td>       <td>800 </td>       <td>800 </td>       <td>1200 </td>       <td>1800 </td>       <td>1500 </td>       <td>1700 </td>       <td>— </td>     </tr>     <tr>       <td><a class="rated-user user-blue" href="https://codeforces.com/profile/yse" title="Expert yse">yse</a> </td>       <td>800 </td>       <td>900 </td>       <td>1000 </td>       <td>1200 </td>       <td>1500 </td>       <td>1700 </td>       <td>— </td>     </tr>     <tr>       <td>Average </td>       <td>800.0 </td>       <td>852.9 </td>       <td>1058.8 </td>       <td>1388.2 </td>       <td>1511.8 </td>       <td>1676.5 </td>       <td>1961.5 </td>     </tr>     <tr>       <td>Actual </td>       <td>800 </td>       <td>800 </td>       <td>1000 </td>       <td>1200 </td>       <td>1400 </td>       <td>1700 </td>       <td>2100 </td>     </tr>   </tbody> </table></div></div> <div class="spoiler"><b class="spoiler-title">Rate the contest!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>
<style data-nocturne="true" type="text/css">

</style>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10689">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="446">446</span>
            </i>
        </a>
    </span>

    <script>
        $(function() {
            const likeFormUtil = {};
            likeFormUtil.getCount = function ($count) {
                return Number($count.attr("data-value"));
            };
            likeFormUtil.setCount = function ($count, value) {
                $count.attr("data-value", value);
                $count.text(value);
            };
            likeFormUtil.like = function ($likeForm) {
                $likeForm.find(".likeState").addClass("liked");
                const $likeCount = $likeForm.find(".likeCount");
                likeFormUtil.setCount($likeCount, likeFormUtil.getCount($likeCount) + 1);
            };
            likeFormUtil.unLike = function ($likeForm) {
                if ($likeForm.find(".likeState").hasClass("liked")) {
                    $likeForm.find(".likeState").removeClass("liked");
                    const $likeCount = $likeForm.find(".likeCount");
                    likeFormUtil.setCount($likeCount, likeFormUtil.getCount($likeCount) - 1);
                }
            };
            likeFormUtil.dislike = function ($likeForm) {
                $likeForm.find(".dislikeState").addClass("disliked");
                const $dislikeCount = $likeForm.find(".dislikeCount");
                likeFormUtil.setCount($dislikeCount, likeFormUtil.getCount($dislikeCount) + 1);
            };
            likeFormUtil.unDislike = function ($likeForm) {
                if ($likeForm.find(".dislikeState").hasClass("disliked")) {
                    $likeForm.find(".dislikeState").removeClass("disliked");
                    const $dislikeCount = $likeForm.find(".dislikeCount");
                    likeFormUtil.setCount($dislikeCount, likeFormUtil.getCount($dislikeCount) - 1);
                }
            };
            likeFormUtil.disable = function ($likeForm) {
                $likeForm.find(".likeActionLink").off("click");
                $likeForm.find(".likeActionLink").on("click", function () {
                    return false;
                });
                $likeForm.find(".dislikeActionLink").off("click");
                $likeForm.find(".dislikeActionLink").on("click", function () {
                    return false;
                });
            };
            likeFormUtil.enable = function ($likeForm) {
                $likeForm.find(".likeActionLink").off("click");
                $likeForm.find(".likeActionLink").on("click", onLike);
                $likeForm.find(".dislikeActionLink").off("click");
                $likeForm.find(".dislikeActionLink").on("click", onDislike);
            };
            likeFormUtil.applyLikeableInformation = function(likeableInformation) {
                const id = likeableInformation.likeable.id;
                console.log(id);
                const $likeForm = $(".likeActionLink[data-likeableId='" + id + "']").closest(".likeForm");
                console.log($likeForm);
                likeFormUtil.setCount($likeForm.find(".likeCount"), likeableInformation.likeCount);
                likeFormUtil.setCount($likeForm.find(".dislikeCount"), likeableInformation.dislikeCount);
                if (likeableInformation.liked) {
                    $likeForm.find(".likeState").addClass("liked");
                } else {
                    $likeForm.find(".likeState").removeClass("liked");
                }
                if (likeableInformation.disliked) {
                    $likeForm.find(".likeState").addClass("disliked");
                } else {
                    $likeForm.find(".likeState").removeClass("disliked");
                }
            }
            likeFormUtil.applyLikeableInformations = function(likeableInformations) {
                likeableInformations.forEach((applyLikeableInformation) => {
                    likeFormUtil.applyLikeableInformation(applyLikeableInformation);
                });
            }

            function onLike() {
                const $likeActionLink = $(this);
                const likeableId = $likeActionLink.attr("data-likeableId");
                const $likeForm = $likeActionLink.parent();

                likeFormUtil.disable($likeForm);
                $.post("/data/like", {
                    action: "like",
                    likeableId: likeableId
                }, function (data) {
                    if (data["success"] === true) {
                        if (data["liked"]) {
                            Codeforces.showMessage('Added to liked');
                        } else {
                            Codeforces.showMessage('Removed from liked');
                        }
                        likeFormUtil.applyLikeableInformations(data["likeableInformations"]);
                    } else {
                        Codeforces.showMessage(data["message"] || "Error");
                    }
                    likeFormUtil.enable($likeForm);
                }, "json");
                return false;
            }

            function onDislike() {
                const $dislikeActionLink = $(this);
                const likeableId = $dislikeActionLink.attr("data-likeableId");
                const $likeForm = $dislikeActionLink.parent();

                likeFormUtil.disable($likeForm);
                $.post("/data/like", {
                    action: "dislike",
                    likeableId: likeableId
                }, function (data) {
                    if (data["success"] === true) {
                        if (data["disliked"]) {
                            Codeforces.showMessage('Added to disliked');
                        } else {
                            Codeforces.showMessage('Removed from disliked');
                        }
                        likeFormUtil.applyLikeableInformations(data["likeableInformations"]);
                    } else {
                        Codeforces.showMessage(data["message"] || "Error");
                    }
                    likeFormUtil.enable($likeForm);
                }, "json");
                return false;
            }

            $(".likeActionLink").click(onLike);
            $(".dislikeActionLink").click(onDislike);

            $(".likeCount").add(".dislikeCount").each(function () {
                const $count = $(this);
                likeFormUtil.setCount($count, likeFormUtil.getCount($count));
            });
        });
    </script>

<script data-nocturne="true"> $(function () {
}); </script>

 Excellent contest</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10690">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="219">219</span>
            </i>
        </a>
    </span>


 Good contest</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10691">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="38">38</span>
            </i>
        </a>
    </span>


 Average contest</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10692">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="11">11</span>
            </i>
        </a>
    </span>


 Bad contest</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10693">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="10">10</span>
            </i>
        </a>
    </span>


 Horrible contest</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10694">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="24">24</span>
            </i>
        </a>
    </span>


 Trivial contest</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10695">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="93">93</span>
            </i>
        </a>
    </span>


 Easy contest</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10696">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="496">496</span>
            </i>
        </a>
    </span>


 Average contest</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10697">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="66">66</span>
            </i>
        </a>
    </span>


 Hard contest</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10698">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="2">2</span>
            </i>
        </a>
    </span>


 Impossible contest</li> </ul></div></div></div></div><h4><a href="https://codeforces.com/contest/2123/problem/A">A — Blackboard Game</a></h4> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>Alice can't lose unless there are no numbers remaining on her turn (in particular, this can only occur if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">n</span></span></span><script type="math/tex" id="MathJax-Element-1">n</script> is even). So Bob's job is to pair all numbers into disjoint pairs <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mo" id="MJXp-Span-4" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5">a</span><span class="MJXp-mo" id="MJXp-Span-6" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7">b</span><span class="MJXp-mo" id="MJXp-Span-8" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-2">(a, b)</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">a</span><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">b</span><span class="MJXp-mo" id="MJXp-Span-13" style="margin-left: 0.333em; margin-right: 0.333em;">≡</span><span class="MJXp-mn" id="MJXp-Span-14">3</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-15"><span class="MJXp-mspace" id="MJXp-Span-16" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-18">mod</span><span class="MJXp-mspace" id="MJXp-Span-19" style="width: 0.333em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-20">4</span><span class="MJXp-mo" id="MJXp-Span-21" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-3">a+b\equiv 3\pmod 4</script>. If he can do so, he wins by choosing the paired number to each of Alice's choices. Otherwise, Alice wins.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>It doesn't really matter if Bob chooses, say, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-22"><span class="MJXp-mn" id="MJXp-Span-23">0</span></span></span><script type="math/tex" id="MathJax-Element-4">0</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-24"><span class="MJXp-mn" id="MJXp-Span-25">4</span></span></span><script type="math/tex" id="MathJax-Element-5">4</script>, because it won't affect the value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-26"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27">a</span><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29">b</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-30"><span class="MJXp-mspace" id="MJXp-Span-31" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-32" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-33">mod</span><span class="MJXp-mspace" id="MJXp-Span-34" style="width: 0.333em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-35">4</span><span class="MJXp-mo" id="MJXp-Span-36" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-6">a+b\pmod 4</script>. That is, two values are essentially identical in this game if they are equivalent <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-39"><span class="MJXp-mo" id="MJXp-Span-40" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mn" id="MJXp-Span-41">4</span></span></span><script type="math/tex" id="MathJax-Element-7">\bmod 4</script>. So now, the numbers on the blackboard are essentially <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-42"><span class="MJXp-mn" id="MJXp-Span-43">0</span><span class="MJXp-mo" id="MJXp-Span-44" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-45">1</span><span class="MJXp-mo" id="MJXp-Span-46" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-47">2</span><span class="MJXp-mo" id="MJXp-Span-48" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-49">3</span><span class="MJXp-mo" id="MJXp-Span-50" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-51">0</span><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-53">1</span><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-55">2</span><span class="MJXp-mo" id="MJXp-Span-56" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-57">3</span><span class="MJXp-mo" id="MJXp-Span-58" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-59" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-60" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">n</span><span class="MJXp-mo" id="MJXp-Span-62" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-63">1</span><span class="MJXp-mo" id="MJXp-Span-64" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-65"><span class="MJXp-mspace" id="MJXp-Span-66" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-67" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-68">mod</span><span class="MJXp-mspace" id="MJXp-Span-69" style="width: 0.333em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-70">4</span><span class="MJXp-mo" id="MJXp-Span-71" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-8">0, 1, 2, 3, 0, 1, 2, 3, \dots (n-1)\pmod 4</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 3</b><div class="spoiler-content" style="display: block;"><p>Now, all of the numbers on the blackboard are either <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-72"><span class="MJXp-mn" id="MJXp-Span-73">0</span></span></span><script type="math/tex" id="MathJax-Element-9">0</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-74"><span class="MJXp-mn" id="MJXp-Span-75">1</span></span></span><script type="math/tex" id="MathJax-Element-10">1</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-76"><span class="MJXp-mn" id="MJXp-Span-77">2</span></span></span><script type="math/tex" id="MathJax-Element-11">2</script>, or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-78"><span class="MJXp-mn" id="MJXp-Span-79">3</span></span></span><script type="math/tex" id="MathJax-Element-12">3</script>. It is clear that Bob must pair <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-80"><span class="MJXp-mn" id="MJXp-Span-81">0</span></span></span><script type="math/tex" id="MathJax-Element-13">0</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-82"><span class="MJXp-mn" id="MJXp-Span-83">3</span></span></span><script type="math/tex" id="MathJax-Element-14">3</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-84"><span class="MJXp-mn" id="MJXp-Span-85">1</span></span></span><script type="math/tex" id="MathJax-Element-15">1</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-86"><span class="MJXp-mn" id="MJXp-Span-87">2</span></span></span><script type="math/tex" id="MathJax-Element-16">2</script>. So Bob wins if the number of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-88"><span class="MJXp-mn" id="MJXp-Span-89">0</span></span></span><script type="math/tex" id="MathJax-Element-17">0</script>'s is the same as the number of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-90"><span class="MJXp-mn" id="MJXp-Span-91">3</span></span></span><script type="math/tex" id="MathJax-Element-18">3</script>'s, and the number of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-92"><span class="MJXp-mn" id="MJXp-Span-93">1</span></span></span><script type="math/tex" id="MathJax-Element-19">1</script>'s is the same as the number of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-94"><span class="MJXp-mn" id="MJXp-Span-95">2</span></span></span><script type="math/tex" id="MathJax-Element-20">2</script>'s.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> cnt</span><span class="pun">(</span><span class="lit">4</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        cnt</span><span class="pun">[</span><span class="pln">i </span><span class="pun">%</span><span class="pln"> </span><span class="lit">4</span><span class="pun">]++;</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cnt</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> cnt</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> cnt</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> cnt</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> </span><span class="str">"Bob"</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">"Alice"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Step 4 (optional)</b><div class="spoiler-content" style="display: block;"><p>For an <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-96"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">O</span><span class="MJXp-mo" id="MJXp-Span-98" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-99">1</span><span class="MJXp-mo" id="MJXp-Span-100" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-21">O(1)</script> solution, observe that as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">n</span></span></span><script type="math/tex" id="MathJax-Element-22">n</script> increases, a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-103"><span class="MJXp-mn" id="MJXp-Span-104">0</span></span></span><script type="math/tex" id="MathJax-Element-23">0</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-105"><span class="MJXp-mn" id="MJXp-Span-106">1</span></span></span><script type="math/tex" id="MathJax-Element-24">1</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-107"><span class="MJXp-mn" id="MJXp-Span-108">2</span></span></span><script type="math/tex" id="MathJax-Element-25">2</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-109"><span class="MJXp-mn" id="MJXp-Span-110">3</span></span></span><script type="math/tex" id="MathJax-Element-26">3</script> are introduced, in that order. So the number of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-111"><span class="MJXp-mn" id="MJXp-Span-112">0</span></span></span><script type="math/tex" id="MathJax-Element-27">0</script>'s can only match the number of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-113"><span class="MJXp-mn" id="MJXp-Span-114">3</span></span></span><script type="math/tex" id="MathJax-Element-28">3</script>'s, and the number of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-115"><span class="MJXp-mn" id="MJXp-Span-116">1</span></span></span><script type="math/tex" id="MathJax-Element-29">1</script>'s can only match the number of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-117"><span class="MJXp-mn" id="MJXp-Span-118">2</span></span></span><script type="math/tex" id="MathJax-Element-30">2</script>'s, if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-119"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">n</span></span></span><script type="math/tex" id="MathJax-Element-31">n</script> is a multiple of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-121"><span class="MJXp-mn" id="MJXp-Span-122">4</span></span></span><script type="math/tex" id="MathJax-Element-32">4</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">%</span><span class="pln"> </span><span class="lit">4</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> </span><span class="str">"Alice"</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">"Bob"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10699">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="213">213</span>
            </i>
        </a>
    </span>


 Excellent problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10700">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="86">86</span>
            </i>
        </a>
    </span>


 Good problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10701">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="88">88</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10702">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="17">17</span>
            </i>
        </a>
    </span>


 Bad problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10703">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="18">18</span>
            </i>
        </a>
    </span>


 Horrible problem</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10704">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="251">251</span>
            </i>
        </a>
    </span>


 Trivial problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10705">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="66">66</span>
            </i>
        </a>
    </span>


 Easy problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10706">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="98">98</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10707">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="31">31</span>
            </i>
        </a>
    </span>


 Hard problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10708">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="12">12</span>
            </i>
        </a>
    </span>


 Impossible problem</li> </ul></div></div></div></div><h4><a href="https://codeforces.com/contest/2123/problem/B">B — Tournament</a></h4> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">k</span><span class="MJXp-mo" id="MJXp-Span-125" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-126">1</span></span></span><script type="math/tex" id="MathJax-Element-33">k > 1</script>, then the answer is always <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-127"><span class="MJXp-mrow" id="MJXp-Span-128"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-129">YES</span></span></span></span><script type="math/tex" id="MathJax-Element-34">\texttt{YES}</script>. This is because player <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-130"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">j</span></span></span><script type="math/tex" id="MathJax-Element-35">j</script> might never get picked.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-132"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">k</span><span class="MJXp-mo" id="MJXp-Span-134" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-135">1</span></span></span><script type="math/tex" id="MathJax-Element-36">k=1</script>, then we claim that the answer is only <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-136"><span class="MJXp-mrow" id="MJXp-Span-137"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-138">YES</span></span></span></span><script type="math/tex" id="MathJax-Element-37">\texttt{YES}</script> if player <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">j</span></span></span><script type="math/tex" id="MathJax-Element-38">j</script> has the maximum strength across all players. Indeed, consider the set of players with maximum strength. It is impossible for all of them to get eliminated, because the last one of them can't possibly lose a match. So at least one of these players will be remaining at the end of the game. If player <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-141"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">j</span></span></span><script type="math/tex" id="MathJax-Element-39">j</script> is not one of these players, they cannot be the last player remaining.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> j</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">,</span><span class="pln"> mx </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> j </span><span class="pun">&gt;&gt;</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
        mx </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">mx</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> mx </span><span class="pun">?</span><span class="pln"> </span><span class="str">"YES"</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">"NO"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10709">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="62">62</span>
            </i>
        </a>
    </span>


 Excellent problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10710">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="187">187</span>
            </i>
        </a>
    </span>


 Good problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10711">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="69">69</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10712">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="10">10</span>
            </i>
        </a>
    </span>


 Bad problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10713">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="7">7</span>
            </i>
        </a>
    </span>


 Horrible problem</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10714">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="82">82</span>
            </i>
        </a>
    </span>


 Trivial problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10715">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="179">179</span>
            </i>
        </a>
    </span>


 Easy problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10716">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="77">77</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10717">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="15">15</span>
            </i>
        </a>
    </span>


 Hard problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10718">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="6">6</span>
            </i>
        </a>
    </span>


 Impossible problem</li> </ul></div></div></div></div><h4><a href="https://codeforces.com/contest/2123/problem/C">C — Prefix Min and Suffix Max</a></h4> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-143"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">a</span></span></span><script type="math/tex" id="MathJax-Element-40">a</script> has size <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-145"><span class="MJXp-mn" id="MJXp-Span-146">2</span></span></span><script type="math/tex" id="MathJax-Element-41">2</script>, we can make either of its elements the last one. We can transform <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-147"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">a</span></span></span><script type="math/tex" id="MathJax-Element-42">a</script> into <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-149"><span class="MJXp-mo" id="MJXp-Span-150" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-151" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-154" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-155" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-156"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-158" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-159" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-43">\min(a_1, a_2)</script> by choosing the prefix of size <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-160"><span class="MJXp-mn" id="MJXp-Span-161">2</span></span></span><script type="math/tex" id="MathJax-Element-44">2</script>, and we can transform <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-162"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">a</span></span></span><script type="math/tex" id="MathJax-Element-45">a</script> into <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-164"><span class="MJXp-mo" id="MJXp-Span-165" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-166" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-167"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-169" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-170" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-173" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-174" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-46">\max(a_1, a_2)</script> by choosing the suffix of size <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-175"><span class="MJXp-mn" id="MJXp-Span-176">2</span></span></span><script type="math/tex" id="MathJax-Element-47">2</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-177"><span class="MJXp-msubsup" id="MJXp-Span-178"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-180" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-48">a_i</script> is a prefix min, now we can transform <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-181"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182">a</span></span></span><script type="math/tex" id="MathJax-Element-49">a</script> into <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-183"><span class="MJXp-mo" id="MJXp-Span-184" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-185"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-187" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-50">[a_i]</script>. We do so by first choosing the prefix of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-189"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190">i</span></span></span><script type="math/tex" id="MathJax-Element-51">i</script>. Now, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-191"><span class="MJXp-msubsup" id="MJXp-Span-192"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-194" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-52">a_i</script> is the first element of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-195"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196">a</span></span></span><script type="math/tex" id="MathJax-Element-53">a</script>. If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-197"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">a</span></span></span><script type="math/tex" id="MathJax-Element-54">a</script> is of size <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-199"><span class="MJXp-mn" id="MJXp-Span-200">1</span></span></span><script type="math/tex" id="MathJax-Element-55">1</script>, we are done. Otherwise, we can choose the suffix consisting of all of the elements after it. Now, our array is of size <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-201"><span class="MJXp-mn" id="MJXp-Span-202">2</span></span></span><script type="math/tex" id="MathJax-Element-56">2</script>, so we can transform <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-203"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">a</span></span></span><script type="math/tex" id="MathJax-Element-57">a</script> into <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-205"><span class="MJXp-mo" id="MJXp-Span-206" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-209" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-210" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-58">[a_i]</script> as desired. By identical reasoning, if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-211"><span class="MJXp-msubsup" id="MJXp-Span-212"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-214" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-59">a_i</script> is a suffix max, we can transform <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-215"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">a</span></span></span><script type="math/tex" id="MathJax-Element-60">a</script> into <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-217"><span class="MJXp-mo" id="MJXp-Span-218" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-221" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-222" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-61">[a_i]</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 3</b><div class="spoiler-content" style="display: block;"><p>Now, suppose that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-223"><span class="MJXp-msubsup" id="MJXp-Span-224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-226" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-62">a_i</script> is not a prefix min or a suffix max. Then let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-227"><span class="MJXp-msubsup" id="MJXp-Span-228"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-230" style="vertical-align: -0.4em;">p</span></span></span></span><script type="math/tex" id="MathJax-Element-63">a_p</script> be the min of the prefix <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-231"><span class="MJXp-mo" id="MJXp-Span-232" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-233"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-235" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-236" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-237" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-238" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-239"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-241" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-242" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-64">[a_1, \dots, a_i]</script>, and let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-243"><span class="MJXp-msubsup" id="MJXp-Span-244"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-246" style="vertical-align: -0.4em;">s</span></span></span></span><script type="math/tex" id="MathJax-Element-65">a_s</script> be the max of the suffix <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-247"><span class="MJXp-mo" id="MJXp-Span-248" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-249"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-251" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-252" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-253" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-254" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-255"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-257" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-258" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-66">[a_i, \dots, a_n]</script>. Note that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">p</span><span class="MJXp-mo" id="MJXp-Span-261" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">i</span><span class="MJXp-mo" id="MJXp-Span-263" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">s</span></span></span><script type="math/tex" id="MathJax-Element-67">p < i < s</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-265"><span class="MJXp-msubsup" id="MJXp-Span-266"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-268" style="vertical-align: -0.4em;">p</span></span><span class="MJXp-mo" id="MJXp-Span-269" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-272" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-273" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-274"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-276" style="vertical-align: -0.4em;">s</span></span></span></span><script type="math/tex" id="MathJax-Element-68">a_p < a_i < a_s</script>. </p><p>We claim that it is impossible to remove <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-277"><span class="MJXp-msubsup" id="MJXp-Span-278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-280" style="vertical-align: -0.4em;">p</span></span></span></span><script type="math/tex" id="MathJax-Element-69">a_p</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-281"><span class="MJXp-msubsup" id="MJXp-Span-282"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-284" style="vertical-align: -0.4em;">s</span></span></span></span><script type="math/tex" id="MathJax-Element-70">a_s</script> without removing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-285"><span class="MJXp-msubsup" id="MJXp-Span-286"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-288" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-71">a_i</script>. Consider the first operation which removes (at least) one of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-289"><span class="MJXp-msubsup" id="MJXp-Span-290"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-292" style="vertical-align: -0.4em;">p</span></span></span></span><script type="math/tex" id="MathJax-Element-72">a_p</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-293"><span class="MJXp-msubsup" id="MJXp-Span-294"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-296" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-73">a_i</script>, or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-297"><span class="MJXp-msubsup" id="MJXp-Span-298"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-300" style="vertical-align: -0.4em;">s</span></span></span></span><script type="math/tex" id="MathJax-Element-74">a_s</script>.</p> <ul>   <li>Suppose you remove <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-301"><span class="MJXp-msubsup" id="MJXp-Span-302"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-304" style="vertical-align: -0.4em;">p</span></span></span></span><script type="math/tex" id="MathJax-Element-75">a_p</script> by choosing a prefix which includes an element smaller than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-305"><span class="MJXp-msubsup" id="MJXp-Span-306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-308" style="vertical-align: -0.4em;">p</span></span></span></span><script type="math/tex" id="MathJax-Element-76">a_p</script>. Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-309"><span class="MJXp-msubsup" id="MJXp-Span-310"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-312" style="vertical-align: -0.4em;">p</span></span></span></span><script type="math/tex" id="MathJax-Element-77">a_p</script> is the smallest element in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-313"><span class="MJXp-mo" id="MJXp-Span-314" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-317" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-318" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-319" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-320" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-321"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-323" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-324" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-78">[a_1, \dots, a_i]</script>, this means that you must have chosen at least one element after <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-325"><span class="MJXp-msubsup" id="MJXp-Span-326"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-328" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-79">a_i</script>. But then this prefix also includes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-329"><span class="MJXp-msubsup" id="MJXp-Span-330"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-332" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-80">a_i</script>. Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-333"><span class="MJXp-msubsup" id="MJXp-Span-334"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-336" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-81">a_i</script> is not the min of this prefix, it will also be removed. By identical reasoning, if you remove <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-337"><span class="MJXp-msubsup" id="MJXp-Span-338"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-340" style="vertical-align: -0.4em;">s</span></span></span></span><script type="math/tex" id="MathJax-Element-82">a_s</script> by choosing a suffix which includes an element larger than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-341"><span class="MJXp-msubsup" id="MJXp-Span-342"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-344" style="vertical-align: -0.4em;">s</span></span></span></span><script type="math/tex" id="MathJax-Element-83">a_s</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-345"><span class="MJXp-msubsup" id="MJXp-Span-346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-347" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-348" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-84">a_i</script> will also be removed.</li>   <li>Conversely, suppose you remove <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-349"><span class="MJXp-msubsup" id="MJXp-Span-350"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-352" style="vertical-align: -0.4em;">p</span></span></span></span><script type="math/tex" id="MathJax-Element-85">a_p</script> by choosing a suffix which includes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-353"><span class="MJXp-msubsup" id="MJXp-Span-354"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-356" style="vertical-align: -0.4em;">p</span></span></span></span><script type="math/tex" id="MathJax-Element-86">a_p</script>. But then this suffix will include <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-357"><span class="MJXp-msubsup" id="MJXp-Span-358"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-360" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-87">a_i</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-361"><span class="MJXp-msubsup" id="MJXp-Span-362"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-364" style="vertical-align: -0.4em;">s</span></span></span></span><script type="math/tex" id="MathJax-Element-88">a_s</script>. Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-365"><span class="MJXp-msubsup" id="MJXp-Span-366"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-368" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-89">a_i</script> is not the max of this suffix, it will also be removed. By identical reasoning, if you remove <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-369"><span class="MJXp-msubsup" id="MJXp-Span-370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-372" style="vertical-align: -0.4em;">s</span></span></span></span><script type="math/tex" id="MathJax-Element-90">a_s</script> by choosing a prefix which includes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-373"><span class="MJXp-msubsup" id="MJXp-Span-374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-376" style="vertical-align: -0.4em;">s</span></span></span></span><script type="math/tex" id="MathJax-Element-91">a_s</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-377"><span class="MJXp-msubsup" id="MJXp-Span-378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-380" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-92">a_i</script> will also be removed.</li> </ul><p>So the first operation that removes one of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-381"><span class="MJXp-msubsup" id="MJXp-Span-382"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-384" style="vertical-align: -0.4em;">p</span></span></span></span><script type="math/tex" id="MathJax-Element-93">a_p</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-385"><span class="MJXp-msubsup" id="MJXp-Span-386"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-388" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-94">a_i</script>, or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-389"><span class="MJXp-msubsup" id="MJXp-Span-390"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-391" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-392" style="vertical-align: -0.4em;">s</span></span></span></span><script type="math/tex" id="MathJax-Element-95">a_s</script> will necessarily remove <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-393"><span class="MJXp-msubsup" id="MJXp-Span-394"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-396" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-96">a_i</script>, so it is impossible to transform <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-397"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398">a</span></span></span><script type="math/tex" id="MathJax-Element-97">a</script> into <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-399"><span class="MJXp-mo" id="MJXp-Span-400" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-403" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-404" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-98">[a_i]</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">),</span><span class="pln"> pre</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> INT_MAX</span><span class="pun">),</span><span class="pln"> suf</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">2</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
        pre</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">pre</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&gt;=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">--)</span><span class="pln">
        suf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">suf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> pre</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> suf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10719">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="103">103</span>
            </i>
        </a>
    </span>


 Excellent problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10720">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="240">240</span>
            </i>
        </a>
    </span>


 Good problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10721">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="38">38</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10722">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="9">9</span>
            </i>
        </a>
    </span>


 Bad problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10723">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="10">10</span>
            </i>
        </a>
    </span>


 Horrible problem</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10724">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="29">29</span>
            </i>
        </a>
    </span>


 Trivial problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10725">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="116">116</span>
            </i>
        </a>
    </span>


 Easy problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10726">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="229">229</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10727">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="42">42</span>
            </i>
        </a>
    </span>


 Hard problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10728">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="5">5</span>
            </i>
        </a>
    </span>


 Impossible problem</li> </ul></div></div></div></div><h4><a href="https://codeforces.com/contest/2123/problem/D">D — Binary String Battle</a></h4> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-405"><span class="MJXp-mrow" id="MJXp-Span-406"><span class="MJXp-mi" id="MJXp-Span-407">c</span><span class="MJXp-mi" id="MJXp-Span-408">n</span><span class="MJXp-mi" id="MJXp-Span-409">t</span></span></span></span><script type="math/tex" id="MathJax-Element-99">\mathrm{cnt}</script> be the number of ones in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-410"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411">s</span></span></span><script type="math/tex" id="MathJax-Element-100">s</script>. Then clearly if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-412"><span class="MJXp-mrow" id="MJXp-Span-413"><span class="MJXp-mi" id="MJXp-Span-414">c</span><span class="MJXp-mi" id="MJXp-Span-415">n</span><span class="MJXp-mi" id="MJXp-Span-416">t</span></span><span class="MJXp-mo" id="MJXp-Span-417" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">k</span></span></span><script type="math/tex" id="MathJax-Element-101">\mathrm{cnt} \leq k</script>, Alice can win immediately.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>Now, let's reframe Bob's win condition. Bob can win if and only if he can ensure that, before each of Alice's turns, there are at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-419"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420">k</span><span class="MJXp-mo" id="MJXp-Span-421" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-422">1</span></span></span><script type="math/tex" id="MathJax-Element-102">k+1</script> ones in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-423"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">s</span></span></span><script type="math/tex" id="MathJax-Element-103">s</script>. In other words, he has to ensure that after each of his turns, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-425"><span class="MJXp-mrow" id="MJXp-Span-426"><span class="MJXp-mi" id="MJXp-Span-427">c</span><span class="MJXp-mi" id="MJXp-Span-428">n</span><span class="MJXp-mi" id="MJXp-Span-429">t</span></span><span class="MJXp-mo" id="MJXp-Span-430" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431">k</span></span></span><script type="math/tex" id="MathJax-Element-104">\mathrm{cnt} > k</script>. Clearly, after each of Bob's turns, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-432"><span class="MJXp-mrow" id="MJXp-Span-433"><span class="MJXp-mi" id="MJXp-Span-434">c</span><span class="MJXp-mi" id="MJXp-Span-435">n</span><span class="MJXp-mi" id="MJXp-Span-436">t</span></span><span class="MJXp-mo" id="MJXp-Span-437" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438">k</span></span></span><script type="math/tex" id="MathJax-Element-105">\mathrm{cnt} \geq k</script>, since the entire substring he chose is all ones. So he only has to ensure that there is at least one other extra one in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440">s</span></span></span><script type="math/tex" id="MathJax-Element-106">s</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 3</b><div class="spoiler-content" style="display: block;"><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-441"><span class="MJXp-mrow" id="MJXp-Span-442"><span class="MJXp-mi" id="MJXp-Span-443">c</span><span class="MJXp-mi" id="MJXp-Span-444">n</span><span class="MJXp-mi" id="MJXp-Span-445">t</span></span><span class="MJXp-mo" id="MJXp-Span-446" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447">k</span></span></span><script type="math/tex" id="MathJax-Element-107">\mathrm{cnt} > k</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449">n</span><span class="MJXp-mo" id="MJXp-Span-450" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-451">2</span><span class="MJXp-mo" id="MJXp-Span-452" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453">k</span></span></span><script type="math/tex" id="MathJax-Element-108">n\geq 2\cdot k</script>, then Bob can always win. Indeed, on each of Bob's turns, he can pick any existing one in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-454"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455">s</span></span></span><script type="math/tex" id="MathJax-Element-109">s</script> to be the extra one. Now, he simply has to choose a substring which doesn't contain this extra one. Then there will be at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-456"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457">k</span><span class="MJXp-mo" id="MJXp-Span-458" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-459">1</span></span></span><script type="math/tex" id="MathJax-Element-110">k+1</script> ones; the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-460"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461">k</span></span></span><script type="math/tex" id="MathJax-Element-111">k</script> from the substring he chose, and the extra one. If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-462"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463">n</span><span class="MJXp-mo" id="MJXp-Span-464" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mn" id="MJXp-Span-465">2</span><span class="MJXp-mo" id="MJXp-Span-466" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">k</span></span></span><script type="math/tex" id="MathJax-Element-112">n\geq 2\cdot k</script>, then there must be at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-468"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-469">k</span></span></span><script type="math/tex" id="MathJax-Element-113">k</script> elements to either the left or the right of this one, so Bob can choose such a substring.</p><p>For example, consider <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-470"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-471">n</span><span class="MJXp-mo" id="MJXp-Span-472" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-473">8</span></span></span><script type="math/tex" id="MathJax-Element-114">n=8</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-474"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">k</span><span class="MJXp-mo" id="MJXp-Span-476" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-477">4</span></span></span><script type="math/tex" id="MathJax-Element-115">k=4</script>. Suppose, before Bob's turn, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-478"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-479">s</span><span class="MJXp-mo" id="MJXp-Span-480" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-481">00100010</span></span></span><script type="math/tex" id="MathJax-Element-116">s=00100010</script>. Then Bob chooses any arbitrary existing one in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-482"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483">s</span></span></span><script type="math/tex" id="MathJax-Element-117">s</script>, say, the one in the third position. Now, he would like to choose a substring of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-484"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485">k</span></span></span><script type="math/tex" id="MathJax-Element-118">k</script> which does not include the third position. In this case, he can choose the substring <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-486"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">s</span><span class="MJXp-mo" id="MJXp-Span-488" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-489">5</span><span class="MJXp-mo" id="MJXp-Span-490" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-491">8</span><span class="MJXp-mo" id="MJXp-Span-492" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-119">s[5, 8]</script>. Now, after his turn, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-493"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">s</span><span class="MJXp-mo" id="MJXp-Span-495" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-496">00101111</span></span></span><script type="math/tex" id="MathJax-Element-120">s=00101111</script>. As desired, there are at least five ones, in particular, the four in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-497"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498">s</span><span class="MJXp-mo" id="MJXp-Span-499" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-500">5</span><span class="MJXp-mo" id="MJXp-Span-501" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-502">8</span><span class="MJXp-mo" id="MJXp-Span-503" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-121">s[5, 8]</script> and the extra one in the third position.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 4</b><div class="spoiler-content" style="display: block;"><p>This motivates Alice's strategy as well. Suppose that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">n</span><span class="MJXp-mo" id="MJXp-Span-506" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-507">2</span><span class="MJXp-mo" id="MJXp-Span-508" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-509">k</span></span></span><script type="math/tex" id="MathJax-Element-122">n<2\cdot k</script>. Alice would like to make sure that Bob is losing value from his moves. Notice that every substring of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-510"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511">k</span></span></span><script type="math/tex" id="MathJax-Element-123">k</script> includes the element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-512"><span class="MJXp-msubsup" id="MJXp-Span-513"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-515" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-124">s_k</script>. So, after Bob's first turn, we have that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-516"><span class="MJXp-msubsup" id="MJXp-Span-517"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-519" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-520" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-521">1</span></span></span><script type="math/tex" id="MathJax-Element-125">s_k=1</script>. Now, a winning strategy for Alice is to leave <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-522"><span class="MJXp-msubsup" id="MJXp-Span-523"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-524" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-525" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-526" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-527">1</span></span></span><script type="math/tex" id="MathJax-Element-126">s_k=1</script> until her last turn, and otherwise choose any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-528"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">k</span></span></span><script type="math/tex" id="MathJax-Element-127">k</script> arbitrary ones to flip. This guarantees that after every round, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-530"><span class="MJXp-mrow" id="MJXp-Span-531"><span class="MJXp-mi" id="MJXp-Span-532">c</span><span class="MJXp-mi" id="MJXp-Span-533">n</span><span class="MJXp-mi" id="MJXp-Span-534">t</span></span></span></span><script type="math/tex" id="MathJax-Element-128">\mathrm{cnt}</script> decreases, because Alice flips <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-535"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536">k</span></span></span><script type="math/tex" id="MathJax-Element-129">k</script> ones, whereas Bob flips at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-537"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">k</span><span class="MJXp-mo" id="MJXp-Span-539" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-540">1</span></span></span><script type="math/tex" id="MathJax-Element-130">k-1</script> zeros, since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-541"><span class="MJXp-msubsup" id="MJXp-Span-542"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-543" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-544" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-131">a_k</script> is already one. Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-545"><span class="MJXp-mrow" id="MJXp-Span-546"><span class="MJXp-mi" id="MJXp-Span-547">c</span><span class="MJXp-mi" id="MJXp-Span-548">n</span><span class="MJXp-mi" id="MJXp-Span-549">t</span></span></span></span><script type="math/tex" id="MathJax-Element-132">\mathrm{cnt}</script> is nonnegative, finite, and decreasing, it must eventually reach zero.</p><p>For example, consider <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551">n</span><span class="MJXp-mo" id="MJXp-Span-552" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-553">8</span></span></span><script type="math/tex" id="MathJax-Element-133">n=8</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-554"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555">k</span><span class="MJXp-mo" id="MJXp-Span-556" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-557">5</span></span></span><script type="math/tex" id="MathJax-Element-134">k=5</script>. Suppose that before Alice's turn, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-558"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">s</span><span class="MJXp-mo" id="MJXp-Span-560" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-561">01111101</span></span></span><script type="math/tex" id="MathJax-Element-135">s=01111101</script>. Then we have that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-562"><span class="MJXp-mrow" id="MJXp-Span-563"><span class="MJXp-mi" id="MJXp-Span-564">c</span><span class="MJXp-mi" id="MJXp-Span-565">n</span><span class="MJXp-mi" id="MJXp-Span-566">t</span></span><span class="MJXp-mo" id="MJXp-Span-567" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-568">6</span></span></span><script type="math/tex" id="MathJax-Element-136">\mathrm{cnt}=6</script>. Alice wants to choose any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-569"><span class="MJXp-mn" id="MJXp-Span-570">5</span></span></span><script type="math/tex" id="MathJax-Element-137">5</script> ones to flip, except for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-571"><span class="MJXp-msubsup" id="MJXp-Span-572"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-574" style="vertical-align: -0.4em;">5</span></span></span></span><script type="math/tex" id="MathJax-Element-138">s_5</script>. So she chooses to flip <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-575"><span class="MJXp-msubsup" id="MJXp-Span-576"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-578" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-139">s_2</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-579"><span class="MJXp-msubsup" id="MJXp-Span-580"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-582" style="vertical-align: -0.4em;">3</span></span></span></span><script type="math/tex" id="MathJax-Element-140">s_3</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-583"><span class="MJXp-msubsup" id="MJXp-Span-584"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-585" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-586" style="vertical-align: -0.4em;">4</span></span></span></span><script type="math/tex" id="MathJax-Element-141">s_4</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-587"><span class="MJXp-msubsup" id="MJXp-Span-588"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-590" style="vertical-align: -0.4em;">6</span></span></span></span><script type="math/tex" id="MathJax-Element-142">s_6</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-591"><span class="MJXp-msubsup" id="MJXp-Span-592"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-594" style="vertical-align: -0.4em;">8</span></span></span></span><script type="math/tex" id="MathJax-Element-143">s_8</script>. Now, before Bob's turn, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-595"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-596">s</span><span class="MJXp-mo" id="MJXp-Span-597" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-598">00001000</span></span></span><script type="math/tex" id="MathJax-Element-144">s=00001000</script>. But any substring of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-599"><span class="MJXp-mn" id="MJXp-Span-600">5</span></span></span><script type="math/tex" id="MathJax-Element-145">5</script> includes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-601"><span class="MJXp-msubsup" id="MJXp-Span-602"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-603" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-604" style="vertical-align: -0.4em;">5</span></span></span></span><script type="math/tex" id="MathJax-Element-146">s_5</script>, so Bob can only flip at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-605"><span class="MJXp-mn" id="MJXp-Span-606">4</span></span></span><script type="math/tex" id="MathJax-Element-147">4</script> zeros. Suppose he chooses <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-607"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-608">s</span><span class="MJXp-mo" id="MJXp-Span-609" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-610">2</span><span class="MJXp-mo" id="MJXp-Span-611" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-612">6</span><span class="MJXp-mo" id="MJXp-Span-613" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-148">s[2, 6]</script>. Then after his turn, we have that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-614"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-615">s</span><span class="MJXp-mo" id="MJXp-Span-616" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-617">01111100</span></span></span><script type="math/tex" id="MathJax-Element-149">s=01111100</script>. During this round, the value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-618"><span class="MJXp-mrow" id="MJXp-Span-619"><span class="MJXp-mi" id="MJXp-Span-620">c</span><span class="MJXp-mi" id="MJXp-Span-621">n</span><span class="MJXp-mi" id="MJXp-Span-622">t</span></span></span></span><script type="math/tex" id="MathJax-Element-150">\mathrm{cnt}</script> decreased from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-623"><span class="MJXp-mn" id="MJXp-Span-624">6</span></span></span><script type="math/tex" id="MathJax-Element-151">6</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-625"><span class="MJXp-mn" id="MJXp-Span-626">5</span></span></span><script type="math/tex" id="MathJax-Element-152">5</script>, as desired.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">,</span><span class="pln"> cnt </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">string</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> k </span><span class="pun">&gt;&gt;</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">char</span><span class="pln"> c </span><span class="pun">:</span><span class="pln"> s</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">c </span><span class="pun">==</span><span class="pln"> </span><span class="str">'1'</span><span class="pun">)</span><span class="pln">
            cnt</span><span class="pun">++;</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cnt </span><span class="pun">&lt;=</span><span class="pln"> k </span><span class="pun">||</span><span class="pln"> n </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">2</span><span class="pun">*</span><span class="pln">k </span><span class="pun">?</span><span class="pln"> </span><span class="str">"Alice"</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">"Bob"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="pln">NULL</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10729">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="368">368</span>
            </i>
        </a>
    </span>


 Excellent problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10730">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="156">156</span>
            </i>
        </a>
    </span>


 Good problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10731">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="17">17</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10732">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="27">27</span>
            </i>
        </a>
    </span>


 Bad problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10733">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="140">140</span>
            </i>
        </a>
    </span>


 Horrible problem</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10734">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="17">17</span>
            </i>
        </a>
    </span>


 Trivial problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10735">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="37">37</span>
            </i>
        </a>
    </span>


 Easy problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10736">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="132">132</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10737">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="505">505</span>
            </i>
        </a>
    </span>


 Hard problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10738">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="25">25</span>
            </i>
        </a>
    </span>


 Impossible problem</li> </ul></div></div></div></div><h4><a href="https://codeforces.com/contest/2123/problem/E">E — MEX Count</a></h4> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-627"><span class="MJXp-mrow" id="MJXp-Span-628"><span class="MJXp-mi" id="MJXp-Span-629">m</span><span class="MJXp-mi" id="MJXp-Span-630">e</span><span class="MJXp-mi" id="MJXp-Span-631">x</span></span></span></span><script type="math/tex" id="MathJax-Element-153">\mathrm{mex}</script> be the original <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-632"><span class="MJXp-mrow" id="MJXp-Span-633"><span class="MJXp-mi" id="MJXp-Span-634">M</span><span class="MJXp-mi" id="MJXp-Span-635">E</span><span class="MJXp-mi" id="MJXp-Span-636">X</span></span></span></span><script type="math/tex" id="MathJax-Element-154">\mathrm{MEX}</script> of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-637"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-638">a</span></span></span><script type="math/tex" id="MathJax-Element-155">a</script>. Clearly we cannot increase <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-639"><span class="MJXp-mrow" id="MJXp-Span-640"><span class="MJXp-mi" id="MJXp-Span-641">M</span><span class="MJXp-mi" id="MJXp-Span-642">E</span><span class="MJXp-mi" id="MJXp-Span-643">X</span></span><span class="MJXp-mo" id="MJXp-Span-644" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-645">a</span><span class="MJXp-mo" id="MJXp-Span-646" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-156">\mathrm{MEX}(a)</script> by removing elements. So, for every <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-647"><span class="MJXp-mn" id="MJXp-Span-648">0</span><span class="MJXp-mo" id="MJXp-Span-649" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-650">i</span><span class="MJXp-mo" id="MJXp-Span-651" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mrow" id="MJXp-Span-652"><span class="MJXp-mi" id="MJXp-Span-653">m</span><span class="MJXp-mi" id="MJXp-Span-654">e</span><span class="MJXp-mi" id="MJXp-Span-655">x</span></span></span></span><script type="math/tex" id="MathJax-Element-157">0\leq i\leq \mathrm{mex}</script>, let's try to determine, for which <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-656"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657">k</span></span></span><script type="math/tex" id="MathJax-Element-158">k</script> can we make <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-658"><span class="MJXp-mrow" id="MJXp-Span-659"><span class="MJXp-mi" id="MJXp-Span-660">M</span><span class="MJXp-mi" id="MJXp-Span-661">E</span><span class="MJXp-mi" id="MJXp-Span-662">X</span></span><span class="MJXp-mo" id="MJXp-Span-663" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664">a</span><span class="MJXp-mo" id="MJXp-Span-665" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-666" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">i</span></span></span><script type="math/tex" id="MathJax-Element-159">\mathrm{MEX}(a) = i</script>?</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>We must have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-668"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669">i</span><span class="MJXp-mo" id="MJXp-Span-670" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-671">n</span><span class="MJXp-mo" id="MJXp-Span-672" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-673">k</span></span></span><script type="math/tex" id="MathJax-Element-160">i\leq n-k</script>, since the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-674"><span class="MJXp-mrow" id="MJXp-Span-675"><span class="MJXp-mi" id="MJXp-Span-676">M</span><span class="MJXp-mi" id="MJXp-Span-677">E</span><span class="MJXp-mi" id="MJXp-Span-678">X</span></span></span></span><script type="math/tex" id="MathJax-Element-161">\mathrm{MEX}</script> of an array cannot be greater than its size. Furthermore, we must have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-679"><span class="MJXp-mrow" id="MJXp-Span-680"><span class="MJXp-mi" id="MJXp-Span-681">f</span><span class="MJXp-mi" id="MJXp-Span-682">r</span><span class="MJXp-mi" id="MJXp-Span-683">e</span><span class="MJXp-mi" id="MJXp-Span-684">q</span></span><span class="MJXp-mo" id="MJXp-Span-685" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686">i</span><span class="MJXp-mo" id="MJXp-Span-687" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-688" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-689">k</span></span></span><script type="math/tex" id="MathJax-Element-162">\mathrm{freq}(i) \leq k</script>, since we have to remove all instances of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-690"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691">i</span></span></span><script type="math/tex" id="MathJax-Element-163">i</script> in order to make it the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-692"><span class="MJXp-mrow" id="MJXp-Span-693"><span class="MJXp-mi" id="MJXp-Span-694">M</span><span class="MJXp-mi" id="MJXp-Span-695">E</span><span class="MJXp-mi" id="MJXp-Span-696">X</span></span></span></span><script type="math/tex" id="MathJax-Element-164">\mathrm{MEX}</script> of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-697"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698">a</span></span></span><script type="math/tex" id="MathJax-Element-165">a</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 3</b><div class="spoiler-content" style="display: block;"><p>Now, we claim that these are the only constraints. Indeed, suppose that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-699"><span class="MJXp-mn" id="MJXp-Span-700">0</span><span class="MJXp-mo" id="MJXp-Span-701" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-702">i</span><span class="MJXp-mo" id="MJXp-Span-703" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mrow" id="MJXp-Span-704"><span class="MJXp-mi" id="MJXp-Span-705">m</span><span class="MJXp-mi" id="MJXp-Span-706">e</span><span class="MJXp-mi" id="MJXp-Span-707">x</span></span></span></span><script type="math/tex" id="MathJax-Element-166">0\leq i\leq \mathrm{mex}</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-708"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709">i</span><span class="MJXp-mo" id="MJXp-Span-710" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711">n</span><span class="MJXp-mo" id="MJXp-Span-712" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-713">k</span></span></span><script type="math/tex" id="MathJax-Element-167">i\leq n-k</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-714"><span class="MJXp-mrow" id="MJXp-Span-715"><span class="MJXp-mi" id="MJXp-Span-716">f</span><span class="MJXp-mi" id="MJXp-Span-717">r</span><span class="MJXp-mi" id="MJXp-Span-718">e</span><span class="MJXp-mi" id="MJXp-Span-719">q</span></span><span class="MJXp-mo" id="MJXp-Span-720" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721">i</span><span class="MJXp-mo" id="MJXp-Span-722" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-723" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724">k</span></span></span><script type="math/tex" id="MathJax-Element-168">\mathrm{freq}(i) \leq k</script>. We want to choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-725"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-726">n</span><span class="MJXp-mo" id="MJXp-Span-727" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-728">k</span></span></span><script type="math/tex" id="MathJax-Element-169">n-k</script> elements to keep. Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-729"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-730">i</span><span class="MJXp-mo" id="MJXp-Span-731" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mrow" id="MJXp-Span-732"><span class="MJXp-mi" id="MJXp-Span-733">m</span><span class="MJXp-mi" id="MJXp-Span-734">e</span><span class="MJXp-mi" id="MJXp-Span-735">x</span></span></span></span><script type="math/tex" id="MathJax-Element-170">i\leq \mathrm{mex}</script>, every element smaller than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-736"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-737">i</span></span></span><script type="math/tex" id="MathJax-Element-171">i</script> is in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-738"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-739">a</span></span></span><script type="math/tex" id="MathJax-Element-172">a</script>, and since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-740"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-741">i</span><span class="MJXp-mo" id="MJXp-Span-742" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743">n</span><span class="MJXp-mo" id="MJXp-Span-744" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-745">k</span></span></span><script type="math/tex" id="MathJax-Element-173">i\leq n-k</script>, we can first choose one instance of every element less than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-746"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747">i</span></span></span><script type="math/tex" id="MathJax-Element-174">i</script>. Now, the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-748"><span class="MJXp-mrow" id="MJXp-Span-749"><span class="MJXp-mi" id="MJXp-Span-750">M</span><span class="MJXp-mi" id="MJXp-Span-751">E</span><span class="MJXp-mi" id="MJXp-Span-752">X</span></span></span></span><script type="math/tex" id="MathJax-Element-175">\mathrm{MEX}</script> of our chosen elements is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-753"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-754">i</span></span></span><script type="math/tex" id="MathJax-Element-176">i</script>, so we just need to choose the rest of the elements without affecting the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-755"><span class="MJXp-mrow" id="MJXp-Span-756"><span class="MJXp-mi" id="MJXp-Span-757">M</span><span class="MJXp-mi" id="MJXp-Span-758">E</span><span class="MJXp-mi" id="MJXp-Span-759">X</span></span></span></span><script type="math/tex" id="MathJax-Element-177">\mathrm{MEX}</script>. We can just choose elements arbitrarily, as long as we don't choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-760"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-761">i</span></span></span><script type="math/tex" id="MathJax-Element-178">i</script>. Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-762"><span class="MJXp-mrow" id="MJXp-Span-763"><span class="MJXp-mi" id="MJXp-Span-764">f</span><span class="MJXp-mi" id="MJXp-Span-765">r</span><span class="MJXp-mi" id="MJXp-Span-766">e</span><span class="MJXp-mi" id="MJXp-Span-767">q</span></span><span class="MJXp-mo" id="MJXp-Span-768" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-769">i</span><span class="MJXp-mo" id="MJXp-Span-770" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-771" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-772">k</span></span></span><script type="math/tex" id="MathJax-Element-179">\mathrm{freq}(i) \leq k</script>, we have enough spare elements to reach our <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-773"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-774">n</span><span class="MJXp-mo" id="MJXp-Span-775" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-776">k</span></span></span><script type="math/tex" id="MathJax-Element-180">n-k</script> quota without needing to choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-777"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-778">i</span></span></span><script type="math/tex" id="MathJax-Element-181">i</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 4</b><div class="spoiler-content" style="display: block;"><p>Let's maintain a set of elements which can be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-779"><span class="MJXp-mrow" id="MJXp-Span-780"><span class="MJXp-mi" id="MJXp-Span-781">M</span><span class="MJXp-mi" id="MJXp-Span-782">E</span><span class="MJXp-mi" id="MJXp-Span-783">X</span></span><span class="MJXp-mo" id="MJXp-Span-784" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-785">a</span><span class="MJXp-mo" id="MJXp-Span-786" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-182">\mathrm{MEX}(a)</script> after removing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-787"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-788">k</span></span></span><script type="math/tex" id="MathJax-Element-183">k</script> elements. As <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-789"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-790">k</span></span></span><script type="math/tex" id="MathJax-Element-184">k</script> increases, how does this set change? If we compare the set from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-791"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">k</span><span class="MJXp-mo" id="MJXp-Span-793" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-794">1</span></span></span><script type="math/tex" id="MathJax-Element-185">k-1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-795"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-796">k</span></span></span><script type="math/tex" id="MathJax-Element-186">k</script>, we now have that the value <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-797"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-798">n</span><span class="MJXp-mo" id="MJXp-Span-799" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-800" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801">k</span><span class="MJXp-mo" id="MJXp-Span-802" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-803">1</span><span class="MJXp-mo" id="MJXp-Span-804" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-187">n-(k-1)</script> is no longer legal, since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-805"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-806">n</span><span class="MJXp-mo" id="MJXp-Span-807" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-808" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809">k</span><span class="MJXp-mo" id="MJXp-Span-810" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-811">1</span><span class="MJXp-mo" id="MJXp-Span-812" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-813" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814">n</span><span class="MJXp-mo" id="MJXp-Span-815" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816">k</span></span></span><script type="math/tex" id="MathJax-Element-188">n-(k-1) > n-k</script>, so let's erase this element from our set. Furthermore, any elements with frequency <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-817"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-818">k</span></span></span><script type="math/tex" id="MathJax-Element-189">k</script> might now be legal, so let's add them to our set as long as they are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-819"><span class="MJXp-mo" id="MJXp-Span-820" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mo" id="MJXp-Span-821" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-822" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-823"><span class="MJXp-mi" id="MJXp-Span-824">m</span><span class="MJXp-mi" id="MJXp-Span-825">e</span><span class="MJXp-mi" id="MJXp-Span-826">x</span></span><span class="MJXp-mo" id="MJXp-Span-827" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-828">n</span><span class="MJXp-mo" id="MJXp-Span-829" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-830">k</span><span class="MJXp-mo" id="MJXp-Span-831" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-190">\leq \min(\mathrm{mex}, n-k)</script>. Then we output the size of our set.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    map</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> freq</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">set</span><span class="str">&lt;int&gt;</span><span class="pln"> excl</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        excl</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
        freq</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]++;</span><span class="pln">
        excl</span><span class="pun">.</span><span class="pln">erase</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    map</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> vector</span><span class="str">&lt;int&gt;</span><span class="pun">&gt;</span><span class="pln"> invfreq</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> p </span><span class="pun">:</span><span class="pln"> freq</span><span class="pun">)</span><span class="pln">
        invfreq</span><span class="pun">[</span><span class="pln">p</span><span class="pun">.</span><span class="pln">second</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">p</span><span class="pun">.</span><span class="pln">first</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> mex </span><span class="pun">=</span><span class="pln"> </span><span class="pun">*</span><span class="pln">excl</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">set</span><span class="str">&lt;int&gt;</span><span class="pln"> vals</span><span class="pun">;</span><span class="pln">
    vals</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">(</span><span class="pln">mex</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> k</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> k</span><span class="pun">++){</span><span class="pln">
        vals</span><span class="pun">.</span><span class="pln">erase</span><span class="pun">(</span><span class="pln">n</span><span class="pun">-</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">:</span><span class="pln"> invfreq</span><span class="pun">[</span><span class="pln">k</span><span class="pun">])</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">mex</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">-</span><span class="pln">k</span><span class="pun">))</span><span class="pln">
                vals</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> vals</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">!=</span><span class="pln"> n </span><span class="pun">?</span><span class="pln"> </span><span class="str">' '</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Step 4 (alternative)</b><div class="spoiler-content" style="display: block;"><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-832"><span class="MJXp-msubsup" id="MJXp-Span-833"><span class="MJXp-mrow" id="MJXp-Span-834" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-835">a</span><span class="MJXp-mi" id="MJXp-Span-836">n</span><span class="MJXp-mi" id="MJXp-Span-837">s</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-838" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-191">\mathrm{ans}_k</script> be the number of possible values of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-839"><span class="MJXp-mrow" id="MJXp-Span-840"><span class="MJXp-mi" id="MJXp-Span-841">M</span><span class="MJXp-mi" id="MJXp-Span-842">E</span><span class="MJXp-mi" id="MJXp-Span-843">X</span></span><span class="MJXp-mo" id="MJXp-Span-844" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845">a</span><span class="MJXp-mo" id="MJXp-Span-846" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-192">\mathrm{MEX}(a)</script> after removing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-847"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-848">k</span></span></span><script type="math/tex" id="MathJax-Element-193">k</script> elements from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-849"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-850">a</span></span></span><script type="math/tex" id="MathJax-Element-194">a</script>. Now, let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-851"><span class="MJXp-mrow" id="MJXp-Span-852"><span class="MJXp-mi" id="MJXp-Span-853">d</span><span class="MJXp-mi" id="MJXp-Span-854">i</span><span class="MJXp-mi" id="MJXp-Span-855">f</span><span class="MJXp-mi" id="MJXp-Span-856">f</span></span></span></span><script type="math/tex" id="MathJax-Element-195">\mathrm{diff}</script> be the difference array of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-857"><span class="MJXp-mrow" id="MJXp-Span-858"><span class="MJXp-mi" id="MJXp-Span-859">a</span><span class="MJXp-mi" id="MJXp-Span-860">n</span><span class="MJXp-mi" id="MJXp-Span-861">s</span></span></span></span><script type="math/tex" id="MathJax-Element-196">\mathrm{ans}</script>; that is, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-862"><span class="MJXp-msubsup" id="MJXp-Span-863"><span class="MJXp-mrow" id="MJXp-Span-864" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-865">d</span><span class="MJXp-mi" id="MJXp-Span-866">i</span><span class="MJXp-mi" id="MJXp-Span-867">f</span><span class="MJXp-mi" id="MJXp-Span-868">f</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-869" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-870" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-871"><span class="MJXp-mrow" id="MJXp-Span-872" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-873">a</span><span class="MJXp-mi" id="MJXp-Span-874">n</span><span class="MJXp-mi" id="MJXp-Span-875">s</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-876" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-877" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-878"><span class="MJXp-mrow" id="MJXp-Span-879" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-880">a</span><span class="MJXp-mi" id="MJXp-Span-881">n</span><span class="MJXp-mi" id="MJXp-Span-882">s</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-883" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884">k</span><span class="MJXp-mo" id="MJXp-Span-885">−</span><span class="MJXp-mn" id="MJXp-Span-886">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-197">\mathrm{diff}_k = \mathrm{ans}_k - \mathrm{ans}_{k-1}</script>. Then for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-887"><span class="MJXp-mn" id="MJXp-Span-888">0</span><span class="MJXp-mo" id="MJXp-Span-889" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">i</span><span class="MJXp-mo" id="MJXp-Span-891" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mrow" id="MJXp-Span-892"><span class="MJXp-mi" id="MJXp-Span-893">m</span><span class="MJXp-mi" id="MJXp-Span-894">e</span><span class="MJXp-mi" id="MJXp-Span-895">x</span></span></span></span><script type="math/tex" id="MathJax-Element-198">0\leq i\leq \mathrm{mex}</script>, we have that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-896"><span class="MJXp-mrow" id="MJXp-Span-897"><span class="MJXp-mi" id="MJXp-Span-898">M</span><span class="MJXp-mi" id="MJXp-Span-899">E</span><span class="MJXp-mi" id="MJXp-Span-900">X</span></span><span class="MJXp-mo" id="MJXp-Span-901" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-902">a</span><span class="MJXp-mo" id="MJXp-Span-903" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-199">\mathrm{MEX}(a)</script> can be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-904"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-905">i</span></span></span><script type="math/tex" id="MathJax-Element-200">i</script> if and only if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-906"><span class="MJXp-mrow" id="MJXp-Span-907"><span class="MJXp-mi" id="MJXp-Span-908">f</span><span class="MJXp-mi" id="MJXp-Span-909">r</span><span class="MJXp-mi" id="MJXp-Span-910">e</span><span class="MJXp-mi" id="MJXp-Span-911">q</span></span><span class="MJXp-mo" id="MJXp-Span-912" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-913">i</span><span class="MJXp-mo" id="MJXp-Span-914" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-915" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-916">k</span><span class="MJXp-mo" id="MJXp-Span-917" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-918">n</span><span class="MJXp-mo" id="MJXp-Span-919" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-920">i</span></span></span><script type="math/tex" id="MathJax-Element-201">\mathrm{freq}(i) \leq k \leq n-i</script>. So we increment <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-921"><span class="MJXp-msubsup" id="MJXp-Span-922"><span class="MJXp-mrow" id="MJXp-Span-923" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-924">d</span><span class="MJXp-mi" id="MJXp-Span-925">i</span><span class="MJXp-mi" id="MJXp-Span-926">f</span><span class="MJXp-mi" id="MJXp-Span-927">f</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-928" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-929"><span class="MJXp-mi" id="MJXp-Span-930">f</span><span class="MJXp-mi" id="MJXp-Span-931">r</span><span class="MJXp-mi" id="MJXp-Span-932">e</span><span class="MJXp-mi" id="MJXp-Span-933">q</span></span><span class="MJXp-mo" id="MJXp-Span-934">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-935">i</span><span class="MJXp-mo" id="MJXp-Span-936">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-202">\mathrm{diff}_{\mathrm{freq}(i)}</script> and decrement <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-937"><span class="MJXp-msubsup" id="MJXp-Span-938"><span class="MJXp-mrow" id="MJXp-Span-939" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-940">d</span><span class="MJXp-mi" id="MJXp-Span-941">i</span><span class="MJXp-mi" id="MJXp-Span-942">f</span><span class="MJXp-mi" id="MJXp-Span-943">f</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-944" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-945">n</span><span class="MJXp-mo" id="MJXp-Span-946">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-947">i</span><span class="MJXp-mo" id="MJXp-Span-948">+</span><span class="MJXp-mn" id="MJXp-Span-949">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-203">\mathrm{diff}_{n-i+1}</script>. Finally, we can reconstruct <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-950"><span class="MJXp-mrow" id="MJXp-Span-951"><span class="MJXp-mi" id="MJXp-Span-952">a</span><span class="MJXp-mi" id="MJXp-Span-953">n</span><span class="MJXp-mi" id="MJXp-Span-954">s</span></span></span></span><script type="math/tex" id="MathJax-Element-204">\mathrm{ans}</script> by taking the prefix sums of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-955"><span class="MJXp-mrow" id="MJXp-Span-956"><span class="MJXp-mi" id="MJXp-Span-957">d</span><span class="MJXp-mi" id="MJXp-Span-958">i</span><span class="MJXp-mi" id="MJXp-Span-959">f</span><span class="MJXp-mi" id="MJXp-Span-960">f</span></span></span></span><script type="math/tex" id="MathJax-Element-205">\mathrm{diff}</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">),</span><span class="pln"> ans</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">),</span><span class="pln"> diff</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">2</span><span class="pun">);</span><span class="pln">
    map</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> freq</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
        freq</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]++;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln">
        diff</span><span class="pun">[</span><span class="pln">freq</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]++;</span><span class="pln">
        diff</span><span class="pun">[</span><span class="pln">n</span><span class="pun">-</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]--;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">freq</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">
            </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> k</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> k</span><span class="pun">++){</span><span class="pln">
        ans</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">?</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">k</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> diff</span><span class="pun">[</span><span class="pln">k</span><span class="pun">];</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">!=</span><span class="pln"> n </span><span class="pun">?</span><span class="pln"> </span><span class="str">' '</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="pln">NULL</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10739">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="387">387</span>
            </i>
        </a>
    </span>


 Excellent problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10740">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="100">100</span>
            </i>
        </a>
    </span>


 Good problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10741">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="13">13</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10742">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="14">14</span>
            </i>
        </a>
    </span>


 Bad problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10743">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="11">11</span>
            </i>
        </a>
    </span>


 Horrible problem</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10744">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="7">7</span>
            </i>
        </a>
    </span>


 Trivial problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10745">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="22">22</span>
            </i>
        </a>
    </span>


 Easy problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10746">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="151">151</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10747">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="375">375</span>
            </i>
        </a>
    </span>


 Hard problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10748">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="7">7</span>
            </i>
        </a>
    </span>


 Impossible problem</li> </ul></div></div></div></div><h4><a href="https://codeforces.com/contest/2123/problem/F">F — Minimize Fixed Points</a></h4> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>Let's first find out which values must be fixed points. Clearly if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-961"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962">i</span></span></span><script type="math/tex" id="MathJax-Element-206">i</script> is relatively prime to every <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-963"><span class="MJXp-mn" id="MJXp-Span-964">1</span><span class="MJXp-mo" id="MJXp-Span-965" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-966">j</span><span class="MJXp-mo" id="MJXp-Span-967" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">n</span></span></span><script type="math/tex" id="MathJax-Element-207">1\leq j\leq n</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-969"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">j</span><span class="MJXp-mo" id="MJXp-Span-971" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972">i</span></span></span><script type="math/tex" id="MathJax-Element-208">j\neq i</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-973"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">i</span></span></span><script type="math/tex" id="MathJax-Element-209">i</script> must be a fixed point. This occurs when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-975"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-976">i</span><span class="MJXp-mo" id="MJXp-Span-977" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-978">1</span></span></span><script type="math/tex" id="MathJax-Element-210">i=1</script>, or when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-979"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">i</span></span></span><script type="math/tex" id="MathJax-Element-211">i</script> is prime and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-981"><span class="MJXp-mn" id="MJXp-Span-982">2</span><span class="MJXp-mo" id="MJXp-Span-983" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984">i</span><span class="MJXp-mo" id="MJXp-Span-985" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986">n</span></span></span><script type="math/tex" id="MathJax-Element-212">2\cdot i > n</script>, because the smallest number that is not relatively prime to prime <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-987"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-988">i</span></span></span><script type="math/tex" id="MathJax-Element-213">i</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-989"><span class="MJXp-mn" id="MJXp-Span-990">2</span><span class="MJXp-mo" id="MJXp-Span-991" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-992">i</span></span></span><script type="math/tex" id="MathJax-Element-214">2\cdot i</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>Now, let's try to construct <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-993"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994">p</span></span></span><script type="math/tex" id="MathJax-Element-215">p</script> such that these are the only fixed points. Consider the cycle decomposition of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-995"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-996">p</span></span></span><script type="math/tex" id="MathJax-Element-216">p</script>. If we can ensure that all elements in a cycle, excluding the cycle <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-997"><span class="MJXp-mo" id="MJXp-Span-998" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-999">1</span><span class="MJXp-mo" id="MJXp-Span-1000" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-217">(1)</script>, share a common divisor greater than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1001"><span class="MJXp-mn" id="MJXp-Span-1002">1</span></span></span><script type="math/tex" id="MathJax-Element-218">1</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1003"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1004">p</span></span></span><script type="math/tex" id="MathJax-Element-219">p</script> is good.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 3</b><div class="spoiler-content" style="display: block;"><p>Notice that a fixed point corresponds to a cycle of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1005"><span class="MJXp-mn" id="MJXp-Span-1006">1</span></span></span><script type="math/tex" id="MathJax-Element-220">1</script>. So we want as few cycles of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1007"><span class="MJXp-mn" id="MJXp-Span-1008">1</span></span></span><script type="math/tex" id="MathJax-Element-221">1</script> as possible. The prime <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1009"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1010">i</span></span></span><script type="math/tex" id="MathJax-Element-222">i</script> are the most restrictive. Let's pair all prime <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1011"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1012">i</span></span></span><script type="math/tex" id="MathJax-Element-223">i</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1013"><span class="MJXp-mn" id="MJXp-Span-1014">2</span><span class="MJXp-mo" id="MJXp-Span-1015" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">i</span></span></span><script type="math/tex" id="MathJax-Element-224">2\cdot i</script>, if possible. Now, none of the primes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1017"><span class="MJXp-mo" id="MJXp-Span-1018" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mfrac" id="MJXp-Span-1019" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1021">2</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-225">\leq \frac{n}{2}</script> are fixed points. For the remaining composites, we have a lot more freedom. We can insert them into the cycle with any one of their prime factors; now, the composites are also not fixed points. Then all cycles share a common divisor, namely, the prime in that cycle, so <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1022"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">p</span></span></span><script type="math/tex" id="MathJax-Element-226">p</script> is good.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 4</b><div class="spoiler-content" style="display: block;"><p>One systematic way to do this is to partition the elements from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1024"><span class="MJXp-mn" id="MJXp-Span-1025">1</span></span></span><script type="math/tex" id="MathJax-Element-227">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1026"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1027">n</span></span></span><script type="math/tex" id="MathJax-Element-228">n</script> based on their largest prime divisor. Then, indeed, all of the elements in the cycle containing prime <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1028"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029">i</span></span></span><script type="math/tex" id="MathJax-Element-229">i</script> are divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1030"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031">i</span></span></span><script type="math/tex" id="MathJax-Element-230">i</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1032"><span class="MJXp-mn" id="MJXp-Span-1033">2</span><span class="MJXp-mo" id="MJXp-Span-1034" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1035">i</span></span></span><script type="math/tex" id="MathJax-Element-231">2\cdot i</script> has largest prime factor <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1036"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037">i</span></span></span><script type="math/tex" id="MathJax-Element-232">i</script>, so if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1038"><span class="MJXp-mn" id="MJXp-Span-1039">2</span><span class="MJXp-mo" id="MJXp-Span-1040" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041">i</span><span class="MJXp-mo" id="MJXp-Span-1042" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043">n</span></span></span><script type="math/tex" id="MathJax-Element-233">2\cdot i \leq n</script>, it will be in the cycle containing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1044"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045">i</span></span></span><script type="math/tex" id="MathJax-Element-234">i</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
vector</span><span class="str">&lt;bool&gt;</span><span class="pln"> comp</span><span class="pun">(</span><span class="lit">1e5</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
vector</span><span class="str">&lt;int&gt;</span><span class="pln"> primes</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> sieve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">2</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">*</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="lit">1e5</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">comp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="pln">i</span><span class="pun">*</span><span class="pln">i</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">&lt;=</span><span class="lit">1e5</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">+=</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
                comp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">2</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;=</span><span class="lit">1e5</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">comp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">
            primes</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> p</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> it </span><span class="pun">=</span><span class="pln"> primes</span><span class="pun">.</span><span class="pln">rbegin</span><span class="pun">();</span><span class="pln"> it </span><span class="pun">!=</span><span class="pln"> primes</span><span class="pun">.</span><span class="pln">rend</span><span class="pun">();</span><span class="pln"> </span><span class="pun">++</span><span class="pln">it</span><span class="pun">){</span><span class="pln">
        vector</span><span class="str">&lt;int&gt;</span><span class="pln"> cycle</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=*</span><span class="pln">it</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">+=*</span><span class="pln">it</span><span class="pun">)</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">
                cycle</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;</span><span class="pln">cycle</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
            p</span><span class="pun">[</span><span class="pln">cycle</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> cycle</span><span class="pun">[(</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> cycle</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">
            p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">!=</span><span class="pln"> n </span><span class="pun">?</span><span class="pln"> </span><span class="str">' '</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    sieve</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10749">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="250">250</span>
            </i>
        </a>
    </span>


 Excellent problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10750">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="63">63</span>
            </i>
        </a>
    </span>


 Good problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10751">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="16">16</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10752">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="6">6</span>
            </i>
        </a>
    </span>


 Bad problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10753">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="11">11</span>
            </i>
        </a>
    </span>


 Horrible problem</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10754">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="8">8</span>
            </i>
        </a>
    </span>


 Trivial problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10755">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="59">59</span>
            </i>
        </a>
    </span>


 Easy problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10756">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="179">179</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10757">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="82">82</span>
            </i>
        </a>
    </span>


 Hard problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10758">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="10">10</span>
            </i>
        </a>
    </span>


 Impossible problem</li> </ul></div></div></div></div><h4><a href="https://codeforces.com/contest/2123/problem/G">G — Modular Sorting</a></h4> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>Let's first try to answer a query of type 2 in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1046"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047">O</span><span class="MJXp-mo" id="MJXp-Span-1048" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049">n</span><span class="MJXp-mo" id="MJXp-Span-1050" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-235">O(n)</script>. We want to set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1051"><span class="MJXp-msubsup" id="MJXp-Span-1052"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1054" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-236">a_1</script> as small as possible. Then we want to set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1055"><span class="MJXp-msubsup" id="MJXp-Span-1056"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1058" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-237">a_2</script> to the smallest value which is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1059"><span class="MJXp-mo" id="MJXp-Span-1060" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-msubsup" id="MJXp-Span-1061"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1062" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1063" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-238">\geq a_1</script>. We continue to choose elements greedily, selecting the smallest legal value <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1064"><span class="MJXp-msubsup" id="MJXp-Span-1065"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1066" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1067" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-239">a_i</script> which is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1068"><span class="MJXp-mo" id="MJXp-Span-1069" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-msubsup" id="MJXp-Span-1070"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1072" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1073">i</span><span class="MJXp-mo" id="MJXp-Span-1074">−</span><span class="MJXp-mn" id="MJXp-Span-1075">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-240">\geq a_{i-1}</script>. If at any point there are no legal values, the answer is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1076"><span class="MJXp-mrow" id="MJXp-Span-1077"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1078">NO</span></span></span></span><script type="math/tex" id="MathJax-Element-241">\texttt{NO}</script>. Otherwise, the answer is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1079"><span class="MJXp-mrow" id="MJXp-Span-1080"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-1081">YES</span></span></span></span><script type="math/tex" id="MathJax-Element-242">\texttt{YES}</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>Now, let's try to characterize what values we can change <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1082"><span class="MJXp-msubsup" id="MJXp-Span-1083"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1085" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-243">a_i</script> into. Clearly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1086"><span class="MJXp-msubsup" id="MJXp-Span-1087"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1089" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1090"><span class="MJXp-mspace" id="MJXp-Span-1091" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-1092" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-1093">mod</span><span class="MJXp-mspace" id="MJXp-Span-1094" style="width: 0.333em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1095" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-1096" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097">k</span><span class="MJXp-mo" id="MJXp-Span-1098" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099">m</span><span class="MJXp-mo" id="MJXp-Span-1100" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1101" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-244">a_i\pmod{\gcd(k, m)}</script> is invariant across operations.</p><p>Next, we claim that all values less than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1102"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1103">m</span></span></span><script type="math/tex" id="MathJax-Element-245">m</script> which are congruent to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1104"><span class="MJXp-msubsup" id="MJXp-Span-1105"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1107" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1108"><span class="MJXp-mspace" id="MJXp-Span-1109" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-1110" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-1111">mod</span><span class="MJXp-mspace" id="MJXp-Span-1112" style="width: 0.333em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1113" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-1114" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">k</span><span class="MJXp-mo" id="MJXp-Span-1116" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1117">m</span><span class="MJXp-mo" id="MJXp-Span-1118" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1119" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-246">a_i\pmod{\gcd(k, m)}</script> are reachable.</p><p>First, let's consider the case where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1120"><span class="MJXp-mo" id="MJXp-Span-1121" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-1122" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1123">k</span><span class="MJXp-mo" id="MJXp-Span-1124" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125">m</span><span class="MJXp-mo" id="MJXp-Span-1126" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1127" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1128">1</span></span></span><script type="math/tex" id="MathJax-Element-247">\gcd(k, m) = 1</script>. Then we can set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1129"><span class="MJXp-msubsup" id="MJXp-Span-1130"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1131" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1132" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1133" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-msubsup" id="MJXp-Span-1134"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1135" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1136" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1137" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1138">1</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1139"><span class="MJXp-mspace" id="MJXp-Span-1140" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-1141" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-1142">mod</span><span class="MJXp-mspace" id="MJXp-Span-1143" style="width: 0.333em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">m</span><span class="MJXp-mo" id="MJXp-Span-1145" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-248">a_i := a_i + 1\pmod m</script> by applying the operation onto <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1146"><span class="MJXp-msubsup" id="MJXp-Span-1147"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1148" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1149" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-249">a_i</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1150"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151">x</span></span></span><script type="math/tex" id="MathJax-Element-250">x</script> times, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">x</span></span></span><script type="math/tex" id="MathJax-Element-251">x</script> is the <a href="https://en.wikipedia.org/wiki/Modular_multiplicative_inverse">modular multiplicative inverse</a> of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1154"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155">k</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1156"><span class="MJXp-mspace" id="MJXp-Span-1157" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-1158" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-1159">mod</span><span class="MJXp-mspace" id="MJXp-Span-1160" style="width: 0.333em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1161">m</span><span class="MJXp-mo" id="MJXp-Span-1162" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-252">k\pmod m</script>. By repeatedly adding <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1163"><span class="MJXp-mn" id="MJXp-Span-1164">1</span></span></span><script type="math/tex" id="MathJax-Element-253">1</script>, we can set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1165"><span class="MJXp-msubsup" id="MJXp-Span-1166"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1168" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-254">a_i</script> to any value.</p><p>Next, let's consider the case where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1169"><span class="MJXp-mo" id="MJXp-Span-1170" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-1171" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1172">k</span><span class="MJXp-mo" id="MJXp-Span-1173" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1174">m</span><span class="MJXp-mo" id="MJXp-Span-1175" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1176" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-1177">1</span></span></span><script type="math/tex" id="MathJax-Element-255">\gcd(k, m) > 1</script>. Then, if we imagine dividing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1178"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1179">k</span></span></span><script type="math/tex" id="MathJax-Element-256">k</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1180"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1181">m</span></span></span><script type="math/tex" id="MathJax-Element-257">m</script> by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1182"><span class="MJXp-mo" id="MJXp-Span-1183" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-1184" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1185">k</span><span class="MJXp-mo" id="MJXp-Span-1186" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187">m</span><span class="MJXp-mo" id="MJXp-Span-1188" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-258">\gcd(k, m)</script>, we fall into the previous case; that is, we can set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1189"><span class="MJXp-msubsup" id="MJXp-Span-1190"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1191" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1192" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1193" style="margin-left: 0.111em; margin-right: 0.167em;">:=</span><span class="MJXp-msubsup" id="MJXp-Span-1194"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1195" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1196" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1197" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1198" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-1199" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">k</span><span class="MJXp-mo" id="MJXp-Span-1201" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1202">m</span><span class="MJXp-mo" id="MJXp-Span-1203" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1204"><span class="MJXp-mspace" id="MJXp-Span-1205" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-1206" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-1207">mod</span><span class="MJXp-mspace" id="MJXp-Span-1208" style="width: 0.333em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209">m</span><span class="MJXp-mo" id="MJXp-Span-1210" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-259">a_i := a_i + \gcd(k, m)\pmod m</script> by applying the operation onto <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1211"><span class="MJXp-msubsup" id="MJXp-Span-1212"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1214" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-260">a_i</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1215"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1216">x</span></span></span><script type="math/tex" id="MathJax-Element-261">x</script> times, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1217"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1218">x</span></span></span><script type="math/tex" id="MathJax-Element-262">x</script> is the modular multiplicative inverse of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1219"><span class="MJXp-mfrac" id="MJXp-Span-1220" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1221">k</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mo" id="MJXp-Span-1222">gcd</span><span class="MJXp-mo" id="MJXp-Span-1223">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1224">k</span><span class="MJXp-mo" id="MJXp-Span-1225">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1226">m</span><span class="MJXp-mo" id="MJXp-Span-1227">)</span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1228"><span class="MJXp-mspace" id="MJXp-Span-1229" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-1230" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-1231">mod</span><span class="MJXp-mspace" id="MJXp-Span-1232" style="width: 0.333em; height: 0em;"></span><span class="MJXp-mfrac" id="MJXp-Span-1233" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1234">m</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mo" id="MJXp-Span-1235">gcd</span><span class="MJXp-mo" id="MJXp-Span-1236">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237">k</span><span class="MJXp-mo" id="MJXp-Span-1238">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1239">m</span><span class="MJXp-mo" id="MJXp-Span-1240">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1241" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-263">\frac{k}{\gcd(k, m)}\pmod{\frac{m}{\gcd(k, m)}}</script>. By repeatedly adding <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1242"><span class="MJXp-mo" id="MJXp-Span-1243" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-1244" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245">k</span><span class="MJXp-mo" id="MJXp-Span-1246" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1247">m</span><span class="MJXp-mo" id="MJXp-Span-1248" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-264">\gcd(k, m)</script>, we can set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1249"><span class="MJXp-msubsup" id="MJXp-Span-1250"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1251" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1252" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-265">a_i</script> to any value which falls into the same congruence class <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1253"><span class="MJXp-mo" id="MJXp-Span-1254" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mrow" id="MJXp-Span-1255"><span class="MJXp-mo" id="MJXp-Span-1256" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-1257" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">k</span><span class="MJXp-mo" id="MJXp-Span-1259" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260">m</span><span class="MJXp-mo" id="MJXp-Span-1261" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><script type="math/tex" id="MathJax-Element-266">\bmod{\gcd(k, m)}</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 3</b><div class="spoiler-content" style="display: block;"><p>Let's try simulating the greedy process, where we repeatedly choose the smallest value which lies in the same congruence class <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1262"><span class="MJXp-mo" id="MJXp-Span-1263" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mo" id="MJXp-Span-1264" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-1265" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1266">k</span><span class="MJXp-mo" id="MJXp-Span-1267" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1268">m</span><span class="MJXp-mo" id="MJXp-Span-1269" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-267">\bmod \gcd(k, m)</script>. Then if we have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1270"><span class="MJXp-msubsup" id="MJXp-Span-1271"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1272" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1273" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1274" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">m</span></span></span><script type="math/tex" id="MathJax-Element-268">a_n < m</script>, we can sort the array.</p><p>However, we want to represent the array in a way such that we can update <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1276"><span class="MJXp-msubsup" id="MJXp-Span-1277"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1278" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1279" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-269">a_i</script> quickly, and check the end-result of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1280"><span class="MJXp-msubsup" id="MJXp-Span-1281"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1283" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-270">a_n</script> after our greedy process quickly. Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1284"><span class="MJXp-mrow" id="MJXp-Span-1285"><span class="MJXp-mi" id="MJXp-Span-1286">d</span><span class="MJXp-mi" id="MJXp-Span-1287">i</span><span class="MJXp-mi" id="MJXp-Span-1288">f</span><span class="MJXp-mi" id="MJXp-Span-1289">f</span></span></span></span><script type="math/tex" id="MathJax-Element-271">\mathrm{diff}</script> be the difference array of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1290"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291">a</span></span></span><script type="math/tex" id="MathJax-Element-272">a</script>; that is, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1292"><span class="MJXp-msubsup" id="MJXp-Span-1293"><span class="MJXp-mrow" id="MJXp-Span-1294" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-1295">d</span><span class="MJXp-mi" id="MJXp-Span-1296">i</span><span class="MJXp-mi" id="MJXp-Span-1297">f</span><span class="MJXp-mi" id="MJXp-Span-1298">f</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1299" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1300" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1301"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1303" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1304" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1305"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1306" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1307" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1308">i</span><span class="MJXp-mo" id="MJXp-Span-1309">−</span><span class="MJXp-mn" id="MJXp-Span-1310">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-273">\mathrm{diff}_i = a_i - a_{i-1}</script> (for convenience, we will define <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1311"><span class="MJXp-msubsup" id="MJXp-Span-1312"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1313" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1314" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1315" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1316">0</span></span></span><script type="math/tex" id="MathJax-Element-274">a_0 = 0</script>). Then, by telescoping sum, we have that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1317"><span class="MJXp-msubsup" id="MJXp-Span-1318"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1319" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1320" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-275">a_n</script> is the sum of the elements of the difference array; that is, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1321"><span class="MJXp-msubsup" id="MJXp-Span-1322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1323" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1324" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1325" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1326" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1327"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1328" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1329" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1330" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1331"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1333" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334">n</span><span class="MJXp-mo" id="MJXp-Span-1335">−</span><span class="MJXp-mn" id="MJXp-Span-1336">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1337" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1338" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1339" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1342" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1343">n</span><span class="MJXp-mo" id="MJXp-Span-1344">−</span><span class="MJXp-mn" id="MJXp-Span-1345">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1346" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1347"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1348" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1349" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1350">n</span><span class="MJXp-mo" id="MJXp-Span-1351">−</span><span class="MJXp-mn" id="MJXp-Span-1352">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-1353" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1354" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1355" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-1356" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1357" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1358"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1360" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1361" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1362"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1363" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1364" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1365" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1366" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1367" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1368"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1369" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1370" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1371" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1372"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1373" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1374" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1375" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-276">a_n = (a_n - a_{n-1}) + (a_{n-1} - a_{n-2}) + \dots + (a_2 - a_1) + (a_1 - a_0)</script>.</p><p>Now, notice that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1376"><span class="MJXp-msubsup" id="MJXp-Span-1377"><span class="MJXp-mrow" id="MJXp-Span-1378" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-1379">d</span><span class="MJXp-mi" id="MJXp-Span-1380">i</span><span class="MJXp-mi" id="MJXp-Span-1381">f</span><span class="MJXp-mi" id="MJXp-Span-1382">f</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1383" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-277">\mathrm{diff}_i</script> is invariant <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1384"><span class="MJXp-mo" id="MJXp-Span-1385" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mrow" id="MJXp-Span-1386"><span class="MJXp-mo" id="MJXp-Span-1387" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-1388" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389">k</span><span class="MJXp-mo" id="MJXp-Span-1390" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1391">m</span><span class="MJXp-mo" id="MJXp-Span-1392" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><script type="math/tex" id="MathJax-Element-278">\bmod{\gcd(k, m)}</script>, and we also must have that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1393"><span class="MJXp-msubsup" id="MJXp-Span-1394"><span class="MJXp-mrow" id="MJXp-Span-1395" style="margin-right: 0.05em;"><span class="MJXp-mi" id="MJXp-Span-1396">d</span><span class="MJXp-mi" id="MJXp-Span-1397">i</span><span class="MJXp-mi" id="MJXp-Span-1398">f</span><span class="MJXp-mi" id="MJXp-Span-1399">f</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1400" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-279">\mathrm{diff}_i</script> is nonnegative for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1402">a</span></span></span><script type="math/tex" id="MathJax-Element-280">a</script> to be nondecreasing. So let's maintain the sum of the elements of the difference array, where each element is taken <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1403"><span class="MJXp-mo" id="MJXp-Span-1404" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mrow" id="MJXp-Span-1405"><span class="MJXp-mo" id="MJXp-Span-1406" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-1407" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1408">k</span><span class="MJXp-mo" id="MJXp-Span-1409" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1410">m</span><span class="MJXp-mo" id="MJXp-Span-1411" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><script type="math/tex" id="MathJax-Element-281">\bmod{\gcd(k, m)}</script>, for each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1412"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">k</span></span></span><script type="math/tex" id="MathJax-Element-282">k</script>. Then this is the final value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1414"><span class="MJXp-msubsup" id="MJXp-Span-1415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1416" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1417" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-283">a_n</script> after simulating the greedy process. This is quick to update, since only two elements of the difference array are changed with each update.</p><p>Finally, we observe that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1418"><span class="MJXp-mo" id="MJXp-Span-1419" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-1420" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1421">k</span><span class="MJXp-mo" id="MJXp-Span-1422" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1423">m</span><span class="MJXp-mo" id="MJXp-Span-1424" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-284">\gcd(k, m)</script> is always a divisor of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1426">m</span></span></span><script type="math/tex" id="MathJax-Element-285">m</script>, so we only have to maintain and update <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1427"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1428">d</span><span class="MJXp-mo" id="MJXp-Span-1429" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1430">m</span><span class="MJXp-mo" id="MJXp-Span-1431" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-286">d(m)</script> different values. This allows us to answer queries in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1432"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433">O</span><span class="MJXp-mo" id="MJXp-Span-1434" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1435">d</span><span class="MJXp-mo" id="MJXp-Span-1436" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1437">m</span><span class="MJXp-mo" id="MJXp-Span-1438" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1439" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-287">O(d(m))</script> time.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> mod</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> m</span><span class="pun">){</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">%</span><span class="pln"> m </span><span class="pun">+</span><span class="pln"> m</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">,</span><span class="pln"> q</span><span class="pun">,</span><span class="pln"> op</span><span class="pun">,</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> m </span><span class="pun">&gt;&gt;</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    map</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">&gt;</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">*</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">m</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(!(</span><span class="pln">m </span><span class="pun">%</span><span class="pln"> i</span><span class="pun">)){</span><span class="pln">
            ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
            ans</span><span class="pun">[</span><span class="pln">m</span><span class="pun">/</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> p </span><span class="pun">:</span><span class="pln"> ans</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
            ans</span><span class="pun">[</span><span class="pln">p</span><span class="pun">.</span><span class="pln">first</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> mod</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">first</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">q</span><span class="pun">--){</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> op</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">op </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
            cin </span><span class="pun">&gt;&gt;</span><span class="pln"> i </span><span class="pun">&gt;&gt;</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> p </span><span class="pun">:</span><span class="pln"> ans</span><span class="pun">){</span><span class="pln">
                ans</span><span class="pun">[</span><span class="pln">p</span><span class="pun">.</span><span class="pln">first</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> mod</span><span class="pun">(</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">first</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> mod</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">first</span><span class="pun">);</span><span class="pln">
                </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">i </span><span class="pun">!=</span><span class="pln"> n</span><span class="pun">)</span><span class="pln">
                    ans</span><span class="pun">[</span><span class="pln">p</span><span class="pun">.</span><span class="pln">first</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> mod</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">first</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> mod</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">first</span><span class="pun">);</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">else</span><span class="pun">{</span><span class="pln">
            cin </span><span class="pun">&gt;&gt;</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
            cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">__gcd</span><span class="pun">(</span><span class="pln">k</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">)]</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> m </span><span class="pun">?</span><span class="pln"> </span><span class="str">"YES"</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">"NO"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="pln">NULL</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Step 3 (alternative)</b><div class="spoiler-content" style="display: block;"><p>Imagine putting all of the numbers from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1440"><span class="MJXp-mn" id="MJXp-Span-1441">0</span></span></span><script type="math/tex" id="MathJax-Element-288">0</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1442"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1443">m</span><span class="MJXp-mo" id="MJXp-Span-1444" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1445">1</span></span></span><script type="math/tex" id="MathJax-Element-289">m-1</script> in a grid, where each row is of size <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1446"><span class="MJXp-mo" id="MJXp-Span-1447" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-1448" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1449">k</span><span class="MJXp-mo" id="MJXp-Span-1450" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451">m</span><span class="MJXp-mo" id="MJXp-Span-1452" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-290">\gcd(k, m)</script>. For example, if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1453"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1454">k</span><span class="MJXp-mo" id="MJXp-Span-1455" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1456">8</span></span></span><script type="math/tex" id="MathJax-Element-291">k=8</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1457"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1458">m</span><span class="MJXp-mo" id="MJXp-Span-1459" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1460">12</span></span></span><script type="math/tex" id="MathJax-Element-292">m=12</script>, our grid would look as follows:</p> <table class="bordertable">   <tbody>     <tr>       <td>8 </td>       <td>9 </td>       <td>10 </td>       <td>11 </td>     </tr>     <tr>       <td>4 </td>       <td>5 </td>       <td>6 </td>       <td>7 </td>     </tr>     <tr>       <td>0 </td>       <td>1 </td>       <td>2 </td>       <td>3 </td>     </tr>   </tbody> </table><p>Then observe that by applying operations, we can reach any element in the same column. Consider simulating the greedy process. Then we want to choose the lowest row possible; that is, we want to move up in the grid as infrequently as possible.</p><p>Notice that we only have to move up in the grid if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1461"><span class="MJXp-msubsup" id="MJXp-Span-1462"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1463" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1464" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1465"><span class="MJXp-mspace" id="MJXp-Span-1466" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-1467" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-1468">mod</span><span class="MJXp-mspace" id="MJXp-Span-1469" style="width: 0.333em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1470" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-1471" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1472">k</span><span class="MJXp-mo" id="MJXp-Span-1473" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474">m</span><span class="MJXp-mo" id="MJXp-Span-1475" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1476" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1477" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-1478"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1479" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1480" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1481">i</span><span class="MJXp-mo" id="MJXp-Span-1482">−</span><span class="MJXp-mn" id="MJXp-Span-1483">1</span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1484"><span class="MJXp-mspace" id="MJXp-Span-1485" style="width: 0.444em; height: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-1486" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-1487">mod</span><span class="MJXp-mspace" id="MJXp-Span-1488" style="width: 0.333em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1489" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-1490" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1491">k</span><span class="MJXp-mo" id="MJXp-Span-1492" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1493">m</span><span class="MJXp-mo" id="MJXp-Span-1494" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1495" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-293">a_i \pmod{\gcd(k, m)} < a_{i-1} \pmod{\gcd(k, m)}</script>, because then we cannot stay in the same row. We want to move up in the grid <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1496"><span class="MJXp-mo" id="MJXp-Span-1497" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mfrac" id="MJXp-Span-1498" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1499">m</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mo" id="MJXp-Span-1500">gcd</span><span class="MJXp-mo" id="MJXp-Span-1501">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1502">k</span><span class="MJXp-mo" id="MJXp-Span-1503">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1504">m</span><span class="MJXp-mo" id="MJXp-Span-1505">)</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-294">< \frac{m}{\gcd(k, m)}</script> times. So let's maintain the number of times we are forced to move up in the grid, for each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1506"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1507">k</span></span></span><script type="math/tex" id="MathJax-Element-295">k</script>. This is quick to update, since when we update <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1508"><span class="MJXp-msubsup" id="MJXp-Span-1509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1510" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1511" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-296">a_i</script>, we only have to compare it to the two adjacent values.</p><p>Finally, we observe that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1512"><span class="MJXp-mo" id="MJXp-Span-1513" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-1514" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1515">k</span><span class="MJXp-mo" id="MJXp-Span-1516" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1517">m</span><span class="MJXp-mo" id="MJXp-Span-1518" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-297">\gcd(k, m)</script> is always a divisor of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1519"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1520">m</span></span></span><script type="math/tex" id="MathJax-Element-298">m</script>, so we only have to maintain and update <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1521"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1522">d</span><span class="MJXp-mo" id="MJXp-Span-1523" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1524">m</span><span class="MJXp-mo" id="MJXp-Span-1525" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-299">d(m)</script> different values. This allows us to answer queries in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1526"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1527">O</span><span class="MJXp-mo" id="MJXp-Span-1528" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1529">d</span><span class="MJXp-mo" id="MJXp-Span-1530" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1531">m</span><span class="MJXp-mo" id="MJXp-Span-1532" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1533" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-300">O(d(m))</script> time.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">,</span><span class="pln"> q</span><span class="pun">,</span><span class="pln"> op</span><span class="pun">,</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> m </span><span class="pun">&gt;&gt;</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    map</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">*</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">m</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(!(</span><span class="pln">m </span><span class="pun">%</span><span class="pln"> i</span><span class="pun">)){</span><span class="pln">
            ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
            ans</span><span class="pun">[</span><span class="pln">m</span><span class="pun">/</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> p </span><span class="pun">:</span><span class="pln"> ans</span><span class="pun">)</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
            ans</span><span class="pun">[</span><span class="pln">p</span><span class="pun">.</span><span class="pln">first</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">first </span><span class="pun">&lt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">first</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">q</span><span class="pun">--){</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> op</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">op </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
            cin </span><span class="pun">&gt;&gt;</span><span class="pln"> i </span><span class="pun">&gt;&gt;</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> p </span><span class="pun">:</span><span class="pln"> ans</span><span class="pun">){</span><span class="pln">
                ans</span><span class="pun">[</span><span class="pln">p</span><span class="pun">.</span><span class="pln">first</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">%</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">first </span><span class="pun">&lt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">first</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">first </span><span class="pun">&lt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">first</span><span class="pun">);</span><span class="pln">
                </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">i </span><span class="pun">!=</span><span class="pln"> n</span><span class="pun">)</span><span class="pln">
                    ans</span><span class="pun">[</span><span class="pln">p</span><span class="pun">.</span><span class="pln">first</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">first </span><span class="pun">&lt;</span><span class="pln"> x </span><span class="pun">%</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">first</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">first </span><span class="pun">&lt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">first</span><span class="pun">);</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
            a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">else</span><span class="pun">{</span><span class="pln">
            cin </span><span class="pun">&gt;&gt;</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
            cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ans</span><span class="pun">[</span><span class="pln">__gcd</span><span class="pun">(</span><span class="pln">k</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">)]</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> m </span><span class="pun">/</span><span class="pln"> __gcd</span><span class="pun">(</span><span class="pln">k</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">)</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> </span><span class="str">"YES"</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">"NO"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="pln">NULL</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10759">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="181">181</span>
            </i>
        </a>
    </span>


 Excellent problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10760">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="25">25</span>
            </i>
        </a>
    </span>


 Good problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10761">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="7">7</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10762">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="1">1</span>
            </i>
        </a>
    </span>


 Bad problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10763">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="8">8</span>
            </i>
        </a>
    </span>


 Horrible problem</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10764">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="8">8</span>
            </i>
        </a>
    </span>


 Trivial problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10765">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="16">16</span>
            </i>
        </a>
    </span>


 Easy problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10766">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="39">39</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10767">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="144">144</span>
            </i>
        </a>
    </span>


 Hard problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="10768">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="29">29</span>
            </i>
        </a>
    </span>


 Impossible problem</li> </ul></div></div></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2123" class="notice" style="text-decoration: none;">Codeforces Round 1034 (Div. 3)</a> </span>
        </div>
        
            

  <script>
    // Make all spoilers toggleable
    document.querySelectorAll('.spoiler-title').forEach(title => {
      title.addEventListener('click', function() {
        const spoiler = this.closest('.spoiler');
        spoiler.classList.toggle('open');
      });
    });
    
    // Open all spoilers by default for easier reading
    document.querySelectorAll('.spoiler').forEach(spoiler => {
      spoiler.classList.add('open');
    });
  </script>
</body>
</html>