<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tutorial</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
      color: #333;
      background: #fafafa;
    }
    .ttypography {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    h3 {
      color: #1a1a1a;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }
    h3 a {
      color: #0066cc;
      text-decoration: none;
    }
    h3 a:hover {
      text-decoration: underline;
    }
    .spoiler {
      margin: 15px 0;
      border: 1px solid #ddd;
      border-radius: 6px;
      overflow: hidden;
    }
    .spoiler-title {
      display: block;
      padding: 12px 15px;
      background: #f0f0f0;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
      border-bottom: 1px solid #ddd;
    }
    .spoiler-title:hover {
      background: #e8e8e8;
    }
    .spoiler-title::before {
      content: '▶ ';
      font-size: 0.8em;
      transition: transform 0.2s;
      display: inline-block;
    }
    .spoiler.open .spoiler-title::before {
      content: '▼ ';
    }
    .spoiler-content {
      padding: 15px;
      background: #fff;
      display: none;
    }
    .spoiler.open .spoiler-content {
      display: block;
    }
    pre, code {
      background: #f5f5f5;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 0.85em;
    }
    pre {
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
    code {
      padding: 2px 5px;
      border-radius: 3px;
    }
    p {
      margin: 10px 0;
    }
    .MathJax {
      font-size: 1.1em;
    }
  </style>
</head>
<body>
  <h1>Editorial</h1>
  <p><a href="https://codeforces.com/blog/entry/149154" target="_blank">View on Codeforces →</a></p>
  
  <div class="ttypography"><p>Thank you all for participation! We hope, you enjoyed the problems.</p><h3><a href="https://codeforces.com/contest/2176/problem/A" title="Codeforces Round 1070 (Div. 2)">2176A - Operations with Inversions</a></h3> <div class="spoiler"><b class="spoiler-title">Hints</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Which element of the array cannot be removed using the described operations?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Under what condition the element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-msubsup" id="MJXp-Span-2"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-4" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-1">a_j</script> <strong>cannot</strong> be removed?</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Note that the element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-msubsup" id="MJXp-Span-6"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-8" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-2">a_1</script> cannot be removed using the described operations.</p><p>In general, the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">j</span></span></span><script type="math/tex" id="MathJax-Element-3">j</script>-th element <strong>cannot</strong> be removed if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-11"><span class="MJXp-msubsup" id="MJXp-Span-12"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-14" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-4">a_j</script> is not less than all elements <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-15"><span class="MJXp-msubsup" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-18" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-19" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-msubsup" id="MJXp-Span-20"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-22" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">j</span><span class="MJXp-mo" id="MJXp-Span-24">−</span><span class="MJXp-mn" id="MJXp-Span-25">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-5">a_1 \ldots a_{j - 1}</script>.</p><p>Otherwise, among the elements <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-26"><span class="MJXp-msubsup" id="MJXp-Span-27"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-29" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-30" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-msubsup" id="MJXp-Span-31"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-33" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">j</span><span class="MJXp-mo" id="MJXp-Span-35">−</span><span class="MJXp-mn" id="MJXp-Span-36">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-6">a_1 \ldots a_{j - 1}</script>, there will always be an element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-37"><span class="MJXp-msubsup" id="MJXp-Span-38"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-40" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-41" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-42"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-44" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-7">a_i > a_j</script>, which means that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-45"><span class="MJXp-msubsup" id="MJXp-Span-46"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-48" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-8">a_j</script> can be removed.</p><p>The constraints are small enough, so for each element, this statement can be checked in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-49"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">O</span><span class="MJXp-mo" id="MJXp-Span-51" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">n</span><span class="MJXp-mo" id="MJXp-Span-53" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-9">O(n)</script> for one check — resulting in a total of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-54"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">O</span><span class="MJXp-mo" id="MJXp-Span-56" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-57"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-59" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-60" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-10">O(n^2)</script> for the test.</p><p>The idea for solving it in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-61"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">O</span><span class="MJXp-mo" id="MJXp-Span-63" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">n</span><span class="MJXp-mo" id="MJXp-Span-65" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-11">O(n)</script> is as follows:</p> <ul>   <li>We will process the elements starting from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-66"><span class="MJXp-msubsup" id="MJXp-Span-67"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-69" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-12">a_2</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-70"><span class="MJXp-msubsup" id="MJXp-Span-71"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-73" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-13">a_n</script>.</li>   <li>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-74"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">M</span></span></span><script type="math/tex" id="MathJax-Element-14">M</script> denote the largest among the already processed elements, initially <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-76"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77">M</span><span class="MJXp-mo" id="MJXp-Span-78" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-79"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-81" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-15">M = a_1</script>.</li>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-82"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">M</span><span class="MJXp-mo" id="MJXp-Span-84" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-85"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-87" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-16">M > a_j</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-88"><span class="MJXp-msubsup" id="MJXp-Span-89"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-91" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-17">a_j</script> is removed; otherwise, we set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-92"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">M</span></span></span><script type="math/tex" id="MathJax-Element-18">M</script> equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-94"><span class="MJXp-msubsup" id="MJXp-Span-95"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-97" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-19">a_j</script>.</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;iostream&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;vector&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;algorithm&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;map&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;ctime&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;queue&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;iomanip&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">"assert.h"</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;math.h&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;set&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;deque&gt;</span><span class="pln">
 
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
 
</span><span class="com">#define</span><span class="pln"> vi vector</span><span class="str">&lt;int&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> vii vector</span><span class="pun">&lt;</span><span class="pln">pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> pii pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> ll </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> pll pair</span><span class="pun">&lt;</span><span class="pln">ll</span><span class="pun">,</span><span class="pln"> ll</span><span class="pun">&gt;</span><span class="pln">
 
</span><span class="kwd">const</span><span class="pln"> ll INF </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2e18</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    vi a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
 
    </span><span class="kwd">int</span><span class="pln"> cmx </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
 
    </span><span class="kwd">int</span><span class="pln"> mx </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
 
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        mx </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">mx</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> mx</span><span class="pun">)</span><span class="pln"> cmx</span><span class="pun">++;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
    </span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> cmx</span><span class="pun">;</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> res </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    srand</span><span class="pun">(</span><span class="pln">time</span><span class="pun">(</span><span class="lit">0</span><span class="pun">));</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    cout</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">),</span><span class="pln"> cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> T </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        solve</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span></code></pre></div></div><h3><a href="https://codeforces.com/contest/2176/problem/B" title="Codeforces Round 1070 (Div. 2)">2176B - Optimal Shifts</a></h3> <div class="spoiler"><b class="spoiler-title">Hints</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>What is the answer for the strings "101", "1010", "10101", "101010", and so on?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Is the optimal set of operations different for the strings "100", "010", and "001"?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>What is the answer for the strings "100", "0100", "00100", "001000", and so on?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 4</b><div class="spoiler-content" style="display: block;"><p>Is the answer different for the strings "0100100", "100011", "001110110"?</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Consider all groups of consecutive zeros in the cyclic string <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-98"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99">S</span></span></span><script type="math/tex" id="MathJax-Element-20">S</script>.</p><p>Let the number of zeros in these groups be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-100"><span class="MJXp-msubsup" id="MJXp-Span-101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-103" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-104" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-105"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-107" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-108" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-109" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-110" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-113" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-21">z_1, z_2, \ldots, z_k</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-114"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115">k</span></span></span><script type="math/tex" id="MathJax-Element-22">k</script> is the number of groups.</p><p>In this case, the answer is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-121"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">Z</span><span class="MJXp-mo" id="MJXp-Span-124" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-125" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-126" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-127"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-129" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-130" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-23">MZ = \max(z_j)</script>.</p><p>We will show that the answer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">Z</span></span></span><script type="math/tex" id="MathJax-Element-24">MZ</script> is always achievable as a result:</p> <ul>   <li>We can perform the operation with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-134"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">d</span><span class="MJXp-mo" id="MJXp-Span-136" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-137">1</span></span></span><script type="math/tex" id="MathJax-Element-25">d = 1</script> exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-138"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">Z</span></span></span><script type="math/tex" id="MathJax-Element-26">MZ</script> times.</li>   <li>After each operation, all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-141"><span class="MJXp-msubsup" id="MJXp-Span-142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-144" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-145" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-146">0</span></span></span><script type="math/tex" id="MathJax-Element-27">z_j > 0</script> will decrease by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-147"><span class="MJXp-mn" id="MJXp-Span-148">1</span></span></span><script type="math/tex" id="MathJax-Element-28">1</script>, as the leftmost zero <strong>in each block</strong> will turn into a one.</li>   <li>Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-149"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">Z</span><span class="MJXp-mo" id="MJXp-Span-152" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-153" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-154" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-155"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-157" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-158" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-29">MZ = \max(z_j)</script>, after <strong>exactly</strong> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-159"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">Z</span></span></span><script type="math/tex" id="MathJax-Element-30">MZ</script> operations, all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-162"><span class="MJXp-msubsup" id="MJXp-Span-163"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-165" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-31">z_j</script> will be equal to zero.</li> </ul><p>We will show that it is impossible to obtain an answer better than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-166"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">Z</span></span></span><script type="math/tex" id="MathJax-Element-32">MZ</script>:</p> <ul>   <li>Suppose there exists an answer with the sum of cyclic shifts <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-169"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">S</span><span class="MJXp-mo" id="MJXp-Span-171" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-172"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173" style="margin-right: 0.05em;">d</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-174" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-175" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-176"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177" style="margin-right: 0.05em;">d</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-178" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-179" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-181" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-182"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-184" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-33">S = d_1 + d_2 + \dots + d_m</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-185"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">S</span><span class="MJXp-mo" id="MJXp-Span-187" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189">Z</span></span></span><script type="math/tex" id="MathJax-Element-34">S < MZ</script>.</li>   <li>Consider the largest block of zeros (its size is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-190"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">Z</span></span></span><script type="math/tex" id="MathJax-Element-35">MZ</script>) and the one to the left of this block.</li>   <li>When applying the first operation with shift <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-193"><span class="MJXp-msubsup" id="MJXp-Span-194"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195" style="margin-right: 0.05em;">d</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-196" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-36">d_1</script>, we could not have created ones in positions to the right of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-197"><span class="MJXp-msubsup" id="MJXp-Span-198"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199" style="margin-right: 0.05em;">d</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-200" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-37">d_1</script> in this block.</li>   <li>When applying the subsequent cyclic shifts, this one can also only move to the right by the value of the shifts.</li>   <li>In total, this one can only move <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-201"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">S</span></span></span><script type="math/tex" id="MathJax-Element-38">S</script> positions to the right from its original position, which is strictly less than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-203"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">Z</span></span></span><script type="math/tex" id="MathJax-Element-39">MZ</script> — thus the last zero of the block will remain a zero, contradicting the initial assumption.</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;iostream&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;vector&gt;</span><span class="pln">
 
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="com">#define</span><span class="pln"> vi vector</span><span class="str">&lt;int&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> ll </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">string</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">
	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">
	s </span><span class="pun">+=</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">
	n </span><span class="pun">*=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> cur </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
 
	</span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
 
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">'1'</span><span class="pun">)</span><span class="pln"> cur </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">else</span><span class="pln"> cur</span><span class="pun">++;</span><span class="pln">
		res </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">res</span><span class="pun">,</span><span class="pln"> cur</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	cout </span><span class="pun">&lt;&lt;</span><span class="pln"> res </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		solve</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
 
</span><span class="pun">}</span><span class="pln">
</span></code></pre></div></div><h3><a href="https://codeforces.com/contest/2176/problem/C" title="Codeforces Round 1070 (Div. 2)">2176C - Odd Process</a></h3> <div class="spoiler"><b class="spoiler-title">Hints</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>You have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-206"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">n</span></span></span><script type="math/tex" id="MathJax-Element-40">n</script> coins, and all of them are even. What will the answers be for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-208"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">k</span></span></span><script type="math/tex" id="MathJax-Element-41">k</script>?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>You have two coins: one even and one odd. What will the answers be for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-210"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211">k</span><span class="MJXp-mo" id="MJXp-Span-212" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-213">1</span></span></span><script type="math/tex" id="MathJax-Element-42">k = 1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-214"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">k</span><span class="MJXp-mo" id="MJXp-Span-216" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-217">2</span></span></span><script type="math/tex" id="MathJax-Element-43">k = 2</script>?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>You have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-218"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">n</span></span></span><script type="math/tex" id="MathJax-Element-44">n</script> coins, and exactly one of them is odd. What will the answers be for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-220"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">k</span></span></span><script type="math/tex" id="MathJax-Element-45">k</script>?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 4</b><div class="spoiler-content" style="display: block;"><p>You have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-222"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">n</span></span></span><script type="math/tex" id="MathJax-Element-46">n</script> coins, and all of them are odd. What will the answers be for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">k</span></span></span><script type="math/tex" id="MathJax-Element-47">k</script>?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 5</b><div class="spoiler-content" style="display: block;"><p>You have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-226"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">n</span></span></span><script type="math/tex" id="MathJax-Element-48">n</script> coins, and exactly three of them are odd. What will the answers be for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-228"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">k</span><span class="MJXp-mo" id="MJXp-Span-230" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-231" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">n</span><span class="MJXp-mo" id="MJXp-Span-233" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-234">2</span><span class="MJXp-mo" id="MJXp-Span-235" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-49">k = (n - 2)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-236"><span class="MJXp-mo" id="MJXp-Span-237" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">n</span><span class="MJXp-mo" id="MJXp-Span-239" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-240">1</span><span class="MJXp-mo" id="MJXp-Span-241" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-50">(n - 1)</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-242"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-243">n</span></span></span><script type="math/tex" id="MathJax-Element-51">n</script>, respectively?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 6</b><div class="spoiler-content" style="display: block;"><p>You have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-244"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">n</span></span></span><script type="math/tex" id="MathJax-Element-52">n</script> coins, and exactly four of them are odd. What will the answers be for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-246"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">k</span></span></span><script type="math/tex" id="MathJax-Element-53">k</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-248"><span class="MJXp-mo" id="MJXp-Span-249" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">n</span><span class="MJXp-mo" id="MJXp-Span-251" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-252">3</span><span class="MJXp-mo" id="MJXp-Span-253" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-54">(n - 3)</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-254"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">n</span></span></span><script type="math/tex" id="MathJax-Element-55">n</script>?</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>If all the coins you have are even, then regardless of your actions, the bag will be empty every time.</p><p>Let's say we have one odd coin <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-256"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">c</span></span></span><script type="math/tex" id="MathJax-Element-56">oc</script> and several even coins <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">e</span><span class="MJXp-msubsup" id="MJXp-Span-261"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-263" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-264" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">e</span><span class="MJXp-msubsup" id="MJXp-Span-266"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-268" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-269" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-270" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-271" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272">e</span><span class="MJXp-msubsup" id="MJXp-Span-273"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-275" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-57">ec_1, ec_2, \dots, ec_m</script>. </p><p>We will sort the even coins in descending order: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-276"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">e</span><span class="MJXp-msubsup" id="MJXp-Span-278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-280" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-281" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282">e</span><span class="MJXp-msubsup" id="MJXp-Span-283"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-285" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-286" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mo" id="MJXp-Span-287" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">e</span><span class="MJXp-msubsup" id="MJXp-Span-289"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-291" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-58">ec_1 \ge ec_2 \ge \dots ec_m</script>.</p><p>In this case, for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-292"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">k</span><span class="MJXp-mo" id="MJXp-Span-294" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-295">1</span><span class="MJXp-mo" id="MJXp-Span-296" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-297" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">m</span><span class="MJXp-mo" id="MJXp-Span-299" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-300">1</span><span class="MJXp-mo" id="MJXp-Span-301" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-59">k = 1 \dots (m + 1)</script>, we can construct the following answers:</p> <ul>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-302"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">c</span></span></span><script type="math/tex" id="MathJax-Element-60">oc</script></li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-305"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">c</span><span class="MJXp-mo" id="MJXp-Span-308" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">e</span><span class="MJXp-msubsup" id="MJXp-Span-310"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-312" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-61">oc + ec_1</script></li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-313"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315">c</span><span class="MJXp-mo" id="MJXp-Span-316" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">e</span><span class="MJXp-msubsup" id="MJXp-Span-318"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-320" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-321" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">e</span><span class="MJXp-msubsup" id="MJXp-Span-323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-325" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-62">oc + ec_1 + ec_2</script></li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-326"><span class="MJXp-mo" id="MJXp-Span-327" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex" id="MathJax-Element-63">\dots</script></li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-328"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330">c</span><span class="MJXp-mo" id="MJXp-Span-331" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332">e</span><span class="MJXp-msubsup" id="MJXp-Span-333"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-335" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-336" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337">e</span><span class="MJXp-msubsup" id="MJXp-Span-338"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-340" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-341" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-342" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-343" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344">e</span><span class="MJXp-msubsup" id="MJXp-Span-345"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-347" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-64">oc + ec_1 + ec_2 + \dots + ec_m</script>.</li> </ul><p>But what to do if there are several odd coins?</p><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-348"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">c</span></span></span><script type="math/tex" id="MathJax-Element-65">oc</script> be the largest of the odd coins.</p><p>We will perform the above actions for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-351"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">k</span></span></span><script type="math/tex" id="MathJax-Element-66">k</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-353"><span class="MJXp-mn" id="MJXp-Span-354">1</span></span></span><script type="math/tex" id="MathJax-Element-67">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-355"><span class="MJXp-mo" id="MJXp-Span-356" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357">m</span><span class="MJXp-mo" id="MJXp-Span-358" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-359">1</span><span class="MJXp-mo" id="MJXp-Span-360" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-68">(m + 1)</script>.</p><p>For <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-361"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">k</span><span class="MJXp-mo" id="MJXp-Span-363" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-364" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">m</span><span class="MJXp-mo" id="MJXp-Span-366" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-367">2</span><span class="MJXp-mo" id="MJXp-Span-368" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-69">k = (m + 2)</script>, we will use the following construction:</p> <ul>   <li>First, we will put any two odd coins that are not the coin <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-369"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371">c</span></span></span><script type="math/tex" id="MathJax-Element-70">oc</script> into the bag.</li>   <li>Next, we will put the coin <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-372"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">c</span></span></span><script type="math/tex" id="MathJax-Element-71">oc</script> and all even coins except the smallest one <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-375"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">e</span><span class="MJXp-msubsup" id="MJXp-Span-377"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-379" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-72">ec_m</script>.</li> </ul><p>For <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">k</span><span class="MJXp-mo" id="MJXp-Span-382" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-383" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">m</span><span class="MJXp-mo" id="MJXp-Span-385" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-386">3</span><span class="MJXp-mo" id="MJXp-Span-387" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-73">k = (m + 3)</script>, we will add the smallest even coin <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389">e</span><span class="MJXp-msubsup" id="MJXp-Span-390"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-391" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-392" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-74">ec_m</script> to the already constructed answer.</p><p>For <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-393"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">k</span><span class="MJXp-mo" id="MJXp-Span-395" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-396" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">m</span><span class="MJXp-mo" id="MJXp-Span-398" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-399">4</span><span class="MJXp-mo" id="MJXp-Span-400" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-75">k = (m + 4)</script>, we will add two more "unnecessary" odd coins at the beginning and again remove <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">e</span><span class="MJXp-msubsup" id="MJXp-Span-403"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-405" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-76">ec_m</script>.</p><p>For <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">k</span><span class="MJXp-mo" id="MJXp-Span-408" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-409" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410">m</span><span class="MJXp-mo" id="MJXp-Span-411" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-412">5</span><span class="MJXp-mo" id="MJXp-Span-413" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-77">k = (m + 5)</script>, we will add <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-414"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415">e</span><span class="MJXp-msubsup" id="MJXp-Span-416"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-418" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-78">ec_m</script> again, and so on.</p><p>Note for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-419"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420">k</span><span class="MJXp-mo" id="MJXp-Span-421" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422">n</span></span></span><script type="math/tex" id="MathJax-Element-79">k = n</script>: if you have an even number of odd coins in total, then regardless of the order of addition, the bag will be emptied in the end.</p></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;iostream&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;vector&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;algorithm&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;map&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;ctime&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;queue&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;iomanip&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">"assert.h"</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;math.h&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;set&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;deque&gt;</span><span class="pln">
 
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
 
</span><span class="com">#define</span><span class="pln"> vi vector</span><span class="str">&lt;int&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> vii vector</span><span class="pun">&lt;</span><span class="pln">pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> pii pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> ll </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> pll pair</span><span class="pun">&lt;</span><span class="pln">ll</span><span class="pun">,</span><span class="pln"> ll</span><span class="pun">&gt;</span><span class="pln">
 
</span><span class="kwd">const</span><span class="pln"> ll INF </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2e18</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    vi a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
 
 
    vi odd</span><span class="pun">,</span><span class="pln"> even</span><span class="pun">;</span><span class="pln">
 
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> odd</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> even</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
    sort</span><span class="pun">(</span><span class="pln">odd</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> odd</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">());</span><span class="pln">
    sort</span><span class="pun">(</span><span class="pln">even</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> even</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">());</span><span class="pln">
    reverse</span><span class="pun">(</span><span class="pln">even</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> even</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">());</span><span class="pln">
 
    vector</span><span class="str">&lt;ll&gt;</span><span class="pln"> prefeven</span><span class="pun">((</span><span class="kwd">int</span><span class="pun">)</span><span class="pln">even</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
 
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">even</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        prefeven</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> even</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> prefeven</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> prefeven</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> even</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
    ll ans </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="pln">INF</span><span class="pun">;</span><span class="pln">
 
    </span><span class="kwd">int</span><span class="pln"> cntodd </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pun">)</span><span class="pln">odd</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> cnteven </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> cnteven</span><span class="pun">++;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
    </span><span class="kwd">int</span><span class="pln"> odd1 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> even1 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
 
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">odd</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> odd1 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> even1 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
 
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> k </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> k</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">even1 </span><span class="pun">&lt;</span><span class="pln"> even</span><span class="pun">.</span><span class="pln">size</span><span class="pun">())</span><span class="pln"> even1</span><span class="pun">++;</span><span class="pln">
            </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">odd1 </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> odd</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> even1 </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                    odd1 </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
                    even1</span><span class="pun">--;</span><span class="pln">
                </span><span class="pun">}</span><span class="pln">
                </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                    odd1</span><span class="pun">++;</span><span class="pln">
                </span><span class="pun">}</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">odd1 </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            cout </span><span class="pun">&lt;&lt;</span><span class="pln"> odd</span><span class="pun">.</span><span class="pln">back</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> prefeven</span><span class="pun">[</span><span class="pln">even1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">" "</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">" "</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    srand</span><span class="pun">(</span><span class="pln">time</span><span class="pun">(</span><span class="lit">0</span><span class="pun">));</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    cout</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">),</span><span class="pln"> cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> T </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        solve</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><h3><a href="https://codeforces.com/contest/2176/problem/D" title="Codeforces Round 1070 (Div. 2)">2176D - Fibonacci Paths</a></h3><p>In this Editorial, we will refer to simple paths in the graph, where the sequence of numbers forms a generalized Fibonacci sequence, as Fibonacci paths.</p> <div class="spoiler"><b class="spoiler-title">Hints</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Think about what the simplest Fibonacci paths look like.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>The simplest Fibonacci paths are paths of two vertices (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-423"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">u</span><span class="MJXp-mo" id="MJXp-Span-425" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426">v</span></span></span><script type="math/tex" id="MathJax-Element-80">u,v</script>) connected by an edge. Moreover, any edge in the graph is a Fibonacci path, as the corresponding sequence of numbers (the ends of the edge) consists of only two numbers.</p><p>Now think about what longer Fibonacci paths look like.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>Longer Fibonacci paths consist of a sequence of edges such that the numbers at the ends of the first edge are arbitrary. But the number at the end of any other edge is the sum of the numbers at the ends of the previous edge and the beginning of the current edge. </p><p><img src="https://codeforces.com/predownloaded/24/fe/24fe9dc94b3e8d227694a584f1140e2d54555947.png" style="margin: 0 5.0% 5.0%;max-width: 100.0%;max-height: 100.0%;"></p><p>Think about dynamic programming on edges.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Let's count <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-427"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-428">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429">p</span><span class="MJXp-mo" id="MJXp-Span-430" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432">v</span><span class="MJXp-mo" id="MJXp-Span-433" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-81">dp[uv]</script> — the number of Fibonacci paths that start with the edge (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435">u</span><span class="MJXp-mo" id="MJXp-Span-436" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437">v</span></span></span><script type="math/tex" id="MathJax-Element-82">u,v</script>). The transitions in such dynamics will look like <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-438"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440">p</span><span class="MJXp-mo" id="MJXp-Span-441" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443">v</span><span class="MJXp-mo" id="MJXp-Span-444" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-445" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-446" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448">p</span><span class="MJXp-mo" id="MJXp-Span-449" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">w</span><span class="MJXp-mo" id="MJXp-Span-452" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-83">dp[uv]=\sum dp[vw]</script>, for such edges (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-453"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">v</span><span class="MJXp-mo" id="MJXp-Span-455" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-456">w</span></span></span><script type="math/tex" id="MathJax-Element-84">v,w</script>) for which <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-457"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461">t</span><span class="MJXp-mo" id="MJXp-Span-462" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463">w</span><span class="MJXp-mo" id="MJXp-Span-464" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-465" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-469">t</span><span class="MJXp-mo" id="MJXp-Span-470" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-471">u</span><span class="MJXp-mo" id="MJXp-Span-472" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-473" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477">t</span><span class="MJXp-mo" id="MJXp-Span-478" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-479">v</span><span class="MJXp-mo" id="MJXp-Span-480" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-85">cost[w]=cost[u]+cost[v]</script>.</p><p>How to compute such dynamics if it depends on the order of processing edges? We could introduce a parameter <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-481"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482">k</span></span></span><script type="math/tex" id="MathJax-Element-86">k</script> — fix the length of the Fibonacci path, and then the dynamics would look like <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-483"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485">p</span><span class="MJXp-mo" id="MJXp-Span-486" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488">v</span><span class="MJXp-mo" id="MJXp-Span-489" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-490" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">k</span><span class="MJXp-mo" id="MJXp-Span-492" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-493" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-494" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-495">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496">p</span><span class="MJXp-mo" id="MJXp-Span-497" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499">w</span><span class="MJXp-mo" id="MJXp-Span-500" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-501" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">k</span><span class="MJXp-mo" id="MJXp-Span-503" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-504">1</span><span class="MJXp-mo" id="MJXp-Span-505" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-87">dp[uv][k]=\sum dp[vw][k-1]</script>. But there is a simpler way.</p><p>Notice that in a Fibonacci path, for each subsequent edge, the sum of the numbers at its ends is strictly greater than the sum of the numbers at the ends of the previous edge. This means that edges with a greater sum of numbers should be processed strictly before edges with a smaller sum of numbers, and the order of processing edges with the same sum can be arbitrary, as they cannot be part of the same Fibonacci path.</p><p>Then we will sort the edges, and it will remain only to quickly recalculate the sum <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-506"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-507">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-508">p</span><span class="MJXp-mo" id="MJXp-Span-509" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511">v</span><span class="MJXp-mo" id="MJXp-Span-512" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-513" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-514" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">p</span><span class="MJXp-mo" id="MJXp-Span-517" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519">w</span><span class="MJXp-mo" id="MJXp-Span-520" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-88">dp[uv]=\sum dp[vw]</script> from the dynamics. Naively searching for edges (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-521"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-522">v</span><span class="MJXp-mo" id="MJXp-Span-523" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-524">w</span></span></span><script type="math/tex" id="MathJax-Element-89">v, w</script>) where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-525"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-526">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-528">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">t</span><span class="MJXp-mo" id="MJXp-Span-530" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">w</span><span class="MJXp-mo" id="MJXp-Span-532" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-533" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537">t</span><span class="MJXp-mo" id="MJXp-Span-538" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539">u</span><span class="MJXp-mo" id="MJXp-Span-540" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-541" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-542">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-543">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">t</span><span class="MJXp-mo" id="MJXp-Span-546" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-547">v</span><span class="MJXp-mo" id="MJXp-Span-548" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-90">cost[w]=cost[u]+cost[v]</script> will not work, as the asymptotic complexity of such a solution will easily be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-549"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-550">O</span><span class="MJXp-mo" id="MJXp-Span-551" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-552"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553" style="margin-right: 0.05em;">E</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-554" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-555" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-91">O(E^2)</script> or worse.</p><p>Therefore, we will compress edges with the same value at the end and coming from the same vertex together. For each vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-556"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557">u</span></span></span><script type="math/tex" id="MathJax-Element-92">u</script>, we will maintain a dictionary <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-558"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560">p</span><span class="MJXp-mo" id="MJXp-Span-561" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-562">u</span><span class="MJXp-mo" id="MJXp-Span-563" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-564" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-568">t</span><span class="MJXp-mo" id="MJXp-Span-569" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-93">dp[u][cost]</script> — the number of Fibonacci paths from vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-570"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-571">u</span></span></span><script type="math/tex" id="MathJax-Element-94">u</script> that go to some vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-572"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573">v</span></span></span><script type="math/tex" id="MathJax-Element-95">v</script> with value <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-574"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-576">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578">t</span></span></span><script type="math/tex" id="MathJax-Element-96">cost</script>.</p><p>The recalculation of this dynamics is such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-579"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-580">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581">p</span><span class="MJXp-mo" id="MJXp-Span-582" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583">u</span><span class="MJXp-mo" id="MJXp-Span-584" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-585" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-588">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589">t</span><span class="MJXp-mo" id="MJXp-Span-590" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-591">v</span><span class="MJXp-mo" id="MJXp-Span-592" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-593" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-594" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-596">p</span><span class="MJXp-mo" id="MJXp-Span-597" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-598">u</span><span class="MJXp-mo" id="MJXp-Span-599" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-600" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-601">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-603">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-604">t</span><span class="MJXp-mo" id="MJXp-Span-605" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606">v</span><span class="MJXp-mo" id="MJXp-Span-607" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-608" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-609" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-610" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-611">1</span><span class="MJXp-mo" id="MJXp-Span-612" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-614">p</span><span class="MJXp-mo" id="MJXp-Span-615" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-616">v</span><span class="MJXp-mo" id="MJXp-Span-617" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-618" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-619">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">t</span><span class="MJXp-mo" id="MJXp-Span-623" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624">u</span><span class="MJXp-mo" id="MJXp-Span-625" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-626" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-627">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-629">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-630">t</span><span class="MJXp-mo" id="MJXp-Span-631" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632">v</span><span class="MJXp-mo" id="MJXp-Span-633" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-634" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-635" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-97">dp[u][cost[v]] = dp[u][cost[v]] + (1 + dp[v][cost[u] + cost[v]])</script> — the value of the dynamics <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-636"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-638">p</span><span class="MJXp-mo" id="MJXp-Span-639" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640">u</span><span class="MJXp-mo" id="MJXp-Span-641" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-642" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-645">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-646">t</span><span class="MJXp-mo" id="MJXp-Span-647" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">v</span><span class="MJXp-mo" id="MJXp-Span-649" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-650" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-98">dp[u][cost[v]]</script> is incremented by the number of paths from vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-651"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652">v</span></span></span><script type="math/tex" id="MathJax-Element-99">v</script> with cost <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-653"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-656">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657">t</span><span class="MJXp-mo" id="MJXp-Span-658" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-659">u</span><span class="MJXp-mo" id="MJXp-Span-660" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-661" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-662">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-665">t</span><span class="MJXp-mo" id="MJXp-Span-666" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">v</span><span class="MJXp-mo" id="MJXp-Span-668" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-100">cost[u]+cost[v]</script>, plus one for the path from a single edge (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-669"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670">u</span><span class="MJXp-mo" id="MJXp-Span-671" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">v</span></span></span><script type="math/tex" id="MathJax-Element-101">u,v</script>).</p><p>The asymptotic complexity of the solution is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-673"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-674">O</span><span class="MJXp-mo" id="MJXp-Span-675" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-676">E</span><span class="MJXp-mo" id="MJXp-Span-677" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi" id="MJXp-Span-678">log</span><span class="MJXp-mo" id="MJXp-Span-679" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-680" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681">E</span><span class="MJXp-mo" id="MJXp-Span-682" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-683" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-102">O(E\cdot\operatorname{log}(E))</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
 
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="com">#define</span><span class="pln"> vi vector</span><span class="str">&lt;int&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> vii vector</span><span class="pun">&lt;</span><span class="pln">pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> pii pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> ll </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> pll pair</span><span class="pun">&lt;</span><span class="pln">ll</span><span class="pun">,</span><span class="pln"> ll</span><span class="pun">&gt;</span><span class="pln">
 
</span><span class="kwd">const</span><span class="pln"> ll INF </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2e18</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MOD </span><span class="pun">=</span><span class="pln"> </span><span class="lit">998244353</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">struct</span><span class="pln"> </span><span class="typ">Edge</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">;</span><span class="pln">
    ll s</span><span class="pun">;</span><span class="pln">
    </span><span class="typ">Edge</span><span class="pun">(){}</span><span class="pln">
    </span><span class="typ">Edge</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> ll s</span><span class="pun">)</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> u</span><span class="pun">(</span><span class="pln">u</span><span class="pun">),</span><span class="pln"> v</span><span class="pun">(</span><span class="pln">v</span><span class="pun">),</span><span class="pln"> s</span><span class="pun">(</span><span class="pln">s</span><span class="pun">){}</span><span class="pln">
    </span><span class="kwd">bool</span><span class="pln"> </span><span class="kwd">operator</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> </span><span class="typ">Edge</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">other</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> s </span><span class="pun">&lt;</span><span class="pln"> other</span><span class="pun">.</span><span class="pln">s</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">};</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">a</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> b</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    a </span><span class="pun">+=</span><span class="pln"> b</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">&gt;=</span><span class="pln"> MOD</span><span class="pun">)</span><span class="pln"> a </span><span class="pun">-=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">
    vector </span><span class="str">&lt;ll&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    vector </span><span class="str">&lt;vi&gt;</span><span class="pln"> g</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    vector </span><span class="pun">&lt;</span><span class="typ">Edge</span><span class="pun">&gt;</span><span class="pln"> edges</span><span class="pun">;</span><span class="pln">
 
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> m</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">;</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> u </span><span class="pun">&gt;&gt;</span><span class="pln"> v</span><span class="pun">;</span><span class="pln">
        u</span><span class="pun">--;</span><span class="pln">
        v</span><span class="pun">--;</span><span class="pln">
        g</span><span class="pun">[</span><span class="pln">u</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
        edges</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="typ">Edge</span><span class="pun">(</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]));</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
    sort</span><span class="pun">(</span><span class="pln">edges</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> edges</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">());</span><span class="pln">
    reverse</span><span class="pun">(</span><span class="pln">edges</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> edges</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">());</span><span class="pln">
 
    vector</span><span class="pun">&lt;</span><span class="pln">map </span><span class="pun">&lt;</span><span class="pln">ll</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;&gt;</span><span class="pln"> sumdp</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
 
    </span><span class="kwd">int</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
 
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> e </span><span class="pun">:</span><span class="pln"> edges</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> u </span><span class="pun">=</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">u</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> v </span><span class="pun">=</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">v</span><span class="pun">;</span><span class="pln">
        ll s </span><span class="pun">=</span><span class="pln"> e</span><span class="pun">.</span><span class="pln">s</span><span class="pun">;</span><span class="pln">
        </span><span class="com">//cout &lt;&lt; u &lt;&lt; " " &lt;&lt; v &lt;&lt; " " &lt;&lt; s &lt;&lt; endl;</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> curdp </span><span class="pun">=</span><span class="pln"> sumdp</span><span class="pun">[</span><span class="pln">v</span><span class="pun">][</span><span class="pln">s</span><span class="pun">];</span><span class="pln">
        </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">curdp</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">sumdp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">a</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]],</span><span class="pln"> curdp</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">,</span><span class="pln"> curdp</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    srand</span><span class="pun">(</span><span class="pln">time</span><span class="pun">(</span><span class="lit">0</span><span class="pun">));</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    cout</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">),</span><span class="pln"> cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> T </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        solve</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span></code></pre></div></div><h3><a href="https://codeforces.com/contest/2176/problem/E" title="Codeforces Round 1070 (Div. 2)">2176E - Remove at the lowest cost</a></h3> <div class="spoiler"><b class="spoiler-title">Hints</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Come up with a solution to the problem without queries.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Let's look at the maximum elements. What can you say about the segments between them?</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution without queries</b><div class="spoiler-content" style="display: block;"><p>Let's first provide a theoretical estimate for the answer, followed by an algorithm that achieves this estimate.</p><p>Let's introduce <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-684"><span class="MJXp-mi" id="MJXp-Span-685">f</span><span class="MJXp-mo" id="MJXp-Span-686" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-687" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688">l</span><span class="MJXp-mo" id="MJXp-Span-689" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-690">r</span><span class="MJXp-mo" id="MJXp-Span-691" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">x</span><span class="MJXp-mo" id="MJXp-Span-693" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-103">\operatorname{f}(l, r, x)</script>, which means the following: suppose we only consider the elements <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-694"><span class="MJXp-msubsup" id="MJXp-Span-695"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-697" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-698" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-699"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-700" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-701" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-702">l</span><span class="MJXp-mo" id="MJXp-Span-703">+</span><span class="MJXp-mn" id="MJXp-Span-704">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-705" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-706" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-707" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-708"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-710" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711">r</span><span class="MJXp-mo" id="MJXp-Span-712">−</span><span class="MJXp-mn" id="MJXp-Span-713">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-104">a_l, a_{l + 1}, \ldots, a_{r - 1}</script>, and we can eliminate each of them using an element with a removal cost of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-714"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">x</span></span></span><script type="math/tex" id="MathJax-Element-105">x</script>. What is the minimum removal cost for the entire range? Let's assume that we pass the best possible value to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-716"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717">x</span></span></span><script type="math/tex" id="MathJax-Element-106">x</script>.</p><p>Then let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-718"><span class="MJXp-msubsup" id="MJXp-Span-719"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-720" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-721" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-722" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-723"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-725" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-726" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-727" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-728" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-729"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-730" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-731" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-107">p_1, p_2, \ldots, p_m</script> be the positions of all the maxima on the interval. Note the following facts:</p> <ul>   <li><p>For any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-732"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733">i</span><span class="MJXp-mo" id="MJXp-Span-734" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-735">j</span></span></span><script type="math/tex" id="MathJax-Element-108">i, j</script> for which there exists <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-736"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-737">k</span></span></span><script type="math/tex" id="MathJax-Element-109">k</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-738"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-739">l</span><span class="MJXp-mo" id="MJXp-Span-740" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-741">i</span><span class="MJXp-mo" id="MJXp-Span-742" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-743"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-745" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-746" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747">j</span><span class="MJXp-mo" id="MJXp-Span-748" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-749">r</span></span></span><script type="math/tex" id="MathJax-Element-110">l \leq i < p_k < j < r</script>, there is no sequence of operations in which one of these elements removes the other</p></li>   <li><p>At least one of the elements <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-750"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-751">p</span></span></span><script type="math/tex" id="MathJax-Element-111">p</script> must be removed by an element outside this interval</p></li>   <li><p>The elements <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-752"><span class="MJXp-msubsup" id="MJXp-Span-753"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-754" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-755" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-756" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-757"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-759" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-760" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-761" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-762" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-763"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-765" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-112">p_1, p_2, \ldots, p_m</script> can be removed either for the cost of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-766"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-767">x</span></span></span><script type="math/tex" id="MathJax-Element-113">x</script> or for the cost of another maximum element</p></li> </ul><p>Define <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-768"><span class="MJXp-msup" id="MJXp-Span-769"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-771" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-772" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-774">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-775">n</span><span class="MJXp-mo" id="MJXp-Span-776" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-777">x</span><span class="MJXp-mo" id="MJXp-Span-778" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-779"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-780" style="margin-right: 0.05em;">c</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-781" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-782"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-784" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-785" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-786"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787" style="margin-right: 0.05em;">c</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-788" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-789"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-790" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-791" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-792" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-793" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-794" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-795"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-796" style="margin-right: 0.05em;">c</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-797" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-798"><span class="MJXp-mi" id="MJXp-Span-799" style="margin-right: 0.05em;"></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-800" style="vertical-align: -0.4em;">m</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-801" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-114">x' = min(x, c_{p_1}, c_{p_2}, \ldots, c_{_m})</script>. Then from these three remarks, we can conclude that, with the optimal choice of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-802"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803">x</span></span></span><script type="math/tex" id="MathJax-Element-115">x</script> earlier, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-804"><span class="MJXp-mi" id="MJXp-Span-805">f</span><span class="MJXp-mo" id="MJXp-Span-806" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-807" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-808">l</span><span class="MJXp-mo" id="MJXp-Span-809" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-810">r</span><span class="MJXp-mo" id="MJXp-Span-811" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">x</span><span class="MJXp-mo" id="MJXp-Span-813" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-814" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msup" id="MJXp-Span-815"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-817" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-818" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819">m</span><span class="MJXp-mo" id="MJXp-Span-820" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi" id="MJXp-Span-821">f</span><span class="MJXp-mo" id="MJXp-Span-822" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-823" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-824">l</span><span class="MJXp-mo" id="MJXp-Span-825" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-826"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-827" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-828" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-829" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msup" id="MJXp-Span-830"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-831" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-832" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-833" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-834" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi" id="MJXp-Span-835">f</span><span class="MJXp-mo" id="MJXp-Span-836" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-837" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-838"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-840" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-841" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-842">1</span><span class="MJXp-mo" id="MJXp-Span-843" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-844"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845" style="margin-right: 0.05em;">p</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-846" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-847" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msup" id="MJXp-Span-848"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-849" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-850" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-851" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-852" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-853" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-854" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi" id="MJXp-Span-855">f</span><span class="MJXp-mo" id="MJXp-Span-856" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-857" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-858"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-859" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-860" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-861" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-862">1</span><span class="MJXp-mo" id="MJXp-Span-863" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-864">r</span><span class="MJXp-mo" id="MJXp-Span-865" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msup" id="MJXp-Span-866"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-868" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-869" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-116">\operatorname{f}(l, r, x) = x' \cdot m + \operatorname{f}(l, p_1, x') + \operatorname{f}(p_1 + 1, p_2, x') + \ldots + \operatorname{f}(p_m + 1, r, x')</script>.</p><p>This is true because, according to point 2, there must be at least one element that is removed by an element outside the interval. According to point 3, we can remove the remaining <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-870"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">m</span><span class="MJXp-mo" id="MJXp-Span-872" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-873">1</span></span></span><script type="math/tex" id="MathJax-Element-117">m - 1</script> maxima only using <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-874"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875">x</span></span></span><script type="math/tex" id="MathJax-Element-118">x</script> and other elements <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-876"><span class="MJXp-msubsup" id="MJXp-Span-877"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-878" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-879" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-119">p_i</script>, and the remaining maximum is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-880"><span class="MJXp-msup" id="MJXp-Span-881"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-883" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-120">x'</script>(according to the condition). And according to point 1, all the segments are independent of each other, if we do not consider the maxima.</p><p>In this case, the answer to the problem is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-884"><span class="MJXp-mi" id="MJXp-Span-885">f</span><span class="MJXp-mo" id="MJXp-Span-886" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-887" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-888">0</span><span class="MJXp-mo" id="MJXp-Span-889" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">n</span><span class="MJXp-mo" id="MJXp-Span-891" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-892">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-893">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">f</span><span class="MJXp-mo" id="MJXp-Span-895" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-896" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-899">f</span></span></span><script type="math/tex" id="MathJax-Element-121">\operatorname{f}(0, n, inf) - inf</script>.</p><p>Now, we will show that this sequence of deletions is valid.</p><p>We will also recursively remove segments, but with the condition that this minimum element outside the segment will lie strictly to the left or to the right of the segment <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-900"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-901">l</span><span class="MJXp-mo" id="MJXp-Span-902" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903">r</span></span></span><script type="math/tex" id="MathJax-Element-122">l, r</script>. Then, when we have selected <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-904"><span class="MJXp-msup" id="MJXp-Span-905"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-906" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-907" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-123">x'</script>, we can perform the following process: </p><p>We have a set of segments <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-908"><span class="MJXp-mo" id="MJXp-Span-909" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-910"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911" style="margin-right: 0.05em;">l</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-912" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-913" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-914"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-916" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-917" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-918" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-919" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-920" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-921" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-922"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-923" style="margin-right: 0.05em;">l</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-924" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">m</span><span class="MJXp-mo" id="MJXp-Span-926">+</span><span class="MJXp-mn" id="MJXp-Span-927">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-928" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-929"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-930" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-931" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932">m</span><span class="MJXp-mo" id="MJXp-Span-933">+</span><span class="MJXp-mn" id="MJXp-Span-934">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-935" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-124">(l_1, r_1), \ldots, (l_{m + 1}, r_{m + 1})</script>. We will find a segment that is a neighbor of the element <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-936"><span class="MJXp-msup" id="MJXp-Span-937"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-939" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-125">x'</script>, and we will recursively remove it. After that, this optimal neighbor will have one of the maximum elements as a neighbor (or we will have removed the entire segment). We remove it for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-940"><span class="MJXp-msup" id="MJXp-Span-941"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-943" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-126">x'</script>.</p><p>This process will end when there is exactly one element that can be removed for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-944"><span class="MJXp-msup" id="MJXp-Span-945"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946" style="margin-right: 0.05em;">x</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-947" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-127">x'</script>. It is easy to see that we have reached our estimate, which means that the recursive algorithm above actually returns the answer to the problem.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>What is the structure of the recursive calls to the function <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-948"><span class="MJXp-mi" id="MJXp-Span-949">f</span></span></span><script type="math/tex" id="MathJax-Element-128">\operatorname{f}</script>? Can we remember it and then use it to efficiently process requests? For which elements will the cost of deleting them change when we set it to zero?</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution with queries</b><div class="spoiler-content" style="display: block;"><p>Note that the structure of the function calls <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-950"><span class="MJXp-mi" id="MJXp-Span-951">f</span></span></span><script type="math/tex" id="MathJax-Element-129">\operatorname{f}</script> is a tree. Let's save it and remember the price we paid for removing each element, let's call it <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-952"><span class="MJXp-msubsup" id="MJXp-Span-953"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-954" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-955" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-130">r_i</script>.</p><p>Then, when the request to zero <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-956"><span class="MJXp-msubsup" id="MJXp-Span-957"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-958" style="margin-right: 0.05em;">c</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-959" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-960"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-962" style="vertical-align: -0.4em;">i</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-131">c_{p_i}</script> comes, we take the node for which <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-963"><span class="MJXp-msubsup" id="MJXp-Span-964"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-966" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-132">p_i</script> is one of the maximums and perform a depth-first search on the subtree of this node, avoiding the nodes that have already been zeroed. Thus, we change the corresponding values of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-967"><span class="MJXp-msubsup" id="MJXp-Span-968"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-970" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-133">r_i</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-971"><span class="MJXp-mn" id="MJXp-Span-972">0</span></span></span><script type="math/tex" id="MathJax-Element-134">0</script> and recalculate the global answer.</p><p>The complexity of the solution is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-973"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">O</span><span class="MJXp-mo" id="MJXp-Span-975" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-976">n</span><span class="MJXp-mi" id="MJXp-Span-977">log</span><span class="MJXp-mo" id="MJXp-Span-978" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-979"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">n</span></span><span class="MJXp-mo" id="MJXp-Span-981" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-135">O(n \log{n})</script>, as we need to calculate the maximum on a segment to implement the function <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-982"><span class="MJXp-mi" id="MJXp-Span-983">f</span></span></span><script type="math/tex" id="MathJax-Element-136">\operatorname{f}</script>, which may require a segment tree or a sparse table.</p><p>There may be other approaches to the problem.</p></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;iostream&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;vector&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;set&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;map&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;algorithm&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;deque&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;queue&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;iomanip&gt;</span><span class="pln">
 
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="com">#define</span><span class="pln"> ll </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> vi vector</span><span class="str">&lt;int&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> pii pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> vii vector</span><span class="str">&lt;pii&gt;</span><span class="pln">
 
 
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N </span><span class="pun">=</span><span class="pln"> </span><span class="lit">505010</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MOD </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e9</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">7</span><span class="pun">;</span><span class="pln">
 
vi g</span><span class="pun">[</span><span class="lit">3</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> N</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> cost1</span><span class="pun">[</span><span class="lit">3</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> N</span><span class="pun">],</span><span class="pln"> cost2</span><span class="pun">[</span><span class="lit">3</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> N</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> tree</span><span class="pun">[</span><span class="lit">4</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> N</span><span class="pun">],</span><span class="pln"> pos</span><span class="pun">[</span><span class="lit">4</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> N</span><span class="pun">],</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln"> c</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> nxtL</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln"> nxtR</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> num</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> build</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> tl</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> tr</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tl </span><span class="pun">==</span><span class="pln"> tr</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        tree</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">tl</span><span class="pun">];</span><span class="pln">
        pos</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tl</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> tm </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tl </span><span class="pun">+</span><span class="pln"> tr</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
    build</span><span class="pun">(</span><span class="pln">v </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln"> tl</span><span class="pun">,</span><span class="pln"> tm</span><span class="pun">);</span><span class="pln">
    build</span><span class="pun">(</span><span class="pln">v </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> tm </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> tr</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tree</span><span class="pun">[</span><span class="pln">v </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> tree</span><span class="pun">[</span><span class="pln">v </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        tree</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tree</span><span class="pun">[</span><span class="pln">v </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pun">];</span><span class="pln">
        pos</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">v </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        tree</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tree</span><span class="pun">[</span><span class="pln">v </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">
        pos</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">v </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
pii getmax</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> tl</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> tr</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">&gt;</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pln"> </span><span class="pun">};</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">==</span><span class="pln"> tl </span><span class="pun">&amp;&amp;</span><span class="pln"> r </span><span class="pun">==</span><span class="pln"> tr</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> tree</span><span class="pun">[</span><span class="pln">v</span><span class="pun">],</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">};</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> tm </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tl </span><span class="pun">+</span><span class="pln"> tr</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> 
    pii tmp </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">getmax</span><span class="pun">(</span><span class="pln">v </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pun">,</span><span class="pln"> tl</span><span class="pun">,</span><span class="pln"> tm</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> tm</span><span class="pun">)),</span><span class="pln"> getmax</span><span class="pun">(</span><span class="pln">v </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> tm </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> tr</span><span class="pun">,</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> tm </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"> r</span><span class="pun">));</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> tmp</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
 
</span><span class="kwd">int</span><span class="pln"> state </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
ll ans</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> addEdge</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v </span><span class="pun">==</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> u </span><span class="pun">==</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
    g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">u</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> it </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> precalc</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> minc</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> xx </span><span class="pun">=</span><span class="pln"> minc</span><span class="pun">;</span><span class="pln">
    state</span><span class="pun">++;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> vres </span><span class="pun">=</span><span class="pln"> state</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">&gt;</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> vres</span><span class="pun">;</span><span class="pln">
    pii p </span><span class="pun">=</span><span class="pln"> getmax</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">);</span><span class="pln">

    vi t</span><span class="pun">;</span><span class="pln">
 
    </span><span class="kwd">int</span><span class="pln"> pos </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">second</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pos </span><span class="pun">&gt;=</span><span class="pln"> l</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        t</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">pos</span><span class="pun">);</span><span class="pln">
        pos </span><span class="pun">=</span><span class="pln"> nxtL</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
    reverse</span><span class="pun">(</span><span class="pln">t</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> t</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">());</span><span class="pln">
 
    pos </span><span class="pun">=</span><span class="pln"> nxtR</span><span class="pun">[</span><span class="pln">p</span><span class="pun">.</span><span class="pln">second</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pos </span><span class="pun">&lt;=</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        t</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">pos</span><span class="pun">);</span><span class="pln">
        pos </span><span class="pun">=</span><span class="pln"> nxtR</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x </span><span class="pun">:</span><span class="pln"> t</span><span class="pun">)</span><span class="pln"> minc </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">minc</span><span class="pun">,</span><span class="pln"> c</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x </span><span class="pun">:</span><span class="pln"> t</span><span class="pun">)</span><span class="pln"> num</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> vres</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">xx </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pun">)</span><span class="lit">1e9</span><span class="pun">)</span><span class="pln"> ans </span><span class="pun">+=</span><span class="pln"> minc</span><span class="pun">;</span><span class="pln">
 
    cost1</span><span class="pun">[</span><span class="pln">vres</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> minc</span><span class="pun">;</span><span class="pln">
 
    ans </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> minc </span><span class="pun">*</span><span class="pln"> </span><span class="pun">((</span><span class="kwd">int</span><span class="pun">)</span><span class="pln">t</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    addEdge</span><span class="pun">(</span><span class="pln">vres</span><span class="pun">,</span><span class="pln"> precalc</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> minc</span><span class="pun">));</span><span class="pln">
 
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> t</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        addEdge</span><span class="pun">(</span><span class="pln">vres</span><span class="pun">,</span><span class="pln"> precalc</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> minc</span><span class="pun">));</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
    addEdge</span><span class="pun">(</span><span class="pln">vres</span><span class="pun">,</span><span class="pln"> precalc</span><span class="pun">(</span><span class="pln">t</span><span class="pun">.</span><span class="pln">back</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> minc</span><span class="pun">));</span><span class="pln">
 
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v </span><span class="pun">:</span><span class="pln"> t</span><span class="pun">)</span><span class="pln"> num</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> vres</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> vres</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> go</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">cost1</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln"> </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">].</span><span class="pln">size</span><span class="pun">())</span><span class="pln"> </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> ans </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">((</span><span class="kwd">int</span><span class="pun">)</span><span class="pln">g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> cost1</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">else</span><span class="pln"> ans </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">((</span><span class="kwd">int</span><span class="pun">)</span><span class="pln">g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> cost1</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln">
    cost1</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        go</span><span class="pun">(</span><span class="pln">u</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
 
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    vi p</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]--;</span><span class="pln">
    map </span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> lst</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">lst</span><span class="pun">.</span><span class="pln">find</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> lst</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">())</span><span class="pln"> nxtL</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> nxtL</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> lst</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]];</span><span class="pln">
        lst</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    lst</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">lst</span><span class="pun">.</span><span class="pln">find</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> lst</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">())</span><span class="pln"> nxtR</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln"> nxtR</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> lst</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]];</span><span class="pln">
        lst</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
    build</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
    ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    state </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> root </span><span class="pun">=</span><span class="pln"> precalc</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pun">)</span><span class="lit">1e9</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">" "</span><span class="pun">;</span><span class="pln">
 
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> num</span><span class="pun">[</span><span class="pln">p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]];</span><span class="pln">
        go</span><span class="pun">(</span><span class="pln">j</span><span class="pun">);</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">" "</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> T </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        solve</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span></code></pre></div></div><h3><a href="https://codeforces.com/contest/2176/problem/F" title="Codeforces Round 1070 (Div. 2)">2176F - Omega Numbers</a></h3> <div class="spoiler"><b class="spoiler-title">Hints</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Try to express <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-984"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-985">ω</span><span class="MJXp-mo" id="MJXp-Span-986" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987">x</span><span class="MJXp-mo" id="MJXp-Span-988" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-989">y</span><span class="MJXp-mo" id="MJXp-Span-990" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-137">\omega(x \cdot y)</script> in terms of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-991"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-992">ω</span><span class="MJXp-mo" id="MJXp-Span-993" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994">x</span><span class="MJXp-mo" id="MJXp-Span-995" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-138">\omega(x)</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-996"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-997">ω</span><span class="MJXp-mo" id="MJXp-Span-998" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999">y</span><span class="MJXp-mo" id="MJXp-Span-1000" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-139">\omega(y)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1001"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002">ω</span><span class="MJXp-mo" id="MJXp-Span-1003" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1004">x</span><span class="MJXp-mo" id="MJXp-Span-1005" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006">y</span><span class="MJXp-mo" id="MJXp-Span-1007" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1008" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">ω</span><span class="MJXp-mo" id="MJXp-Span-1010" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">x</span><span class="MJXp-mo" id="MJXp-Span-1012" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1013" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014">ω</span><span class="MJXp-mo" id="MJXp-Span-1015" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">y</span><span class="MJXp-mo" id="MJXp-Span-1017" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1018" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019">ω</span><span class="MJXp-mo" id="MJXp-Span-1020" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-1021">gcd</span><span class="MJXp-mo" id="MJXp-Span-1022" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1023" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024">x</span><span class="MJXp-mo" id="MJXp-Span-1025" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026">y</span><span class="MJXp-mo" id="MJXp-Span-1027" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1028" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-140">\omega(x \cdot y) = \omega(x) + \omega(y) - \omega(\operatorname{gcd}(x,y))</script>. How large can <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1029"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">ω</span><span class="MJXp-mo" id="MJXp-Span-1031" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">x</span><span class="MJXp-mo" id="MJXp-Span-1033" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-141">\omega(x)</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1034"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1035">ω</span><span class="MJXp-mo" id="MJXp-Span-1036" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037">x</span><span class="MJXp-mo" id="MJXp-Span-1038" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1039">y</span><span class="MJXp-mo" id="MJXp-Span-1040" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-142">\omega(x \cdot y)</script> be?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1041"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1042">ω</span><span class="MJXp-mo" id="MJXp-Span-1043" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044">x</span><span class="MJXp-mo" id="MJXp-Span-1045" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1046" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-1047">6</span></span></span><script type="math/tex" id="MathJax-Element-143">\omega(x) \leq 6</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1048"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049">ω</span><span class="MJXp-mo" id="MJXp-Span-1050" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051">x</span><span class="MJXp-mo" id="MJXp-Span-1052" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053">y</span><span class="MJXp-mo" id="MJXp-Span-1054" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1055" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-1056">12</span></span></span><script type="math/tex" id="MathJax-Element-144">\omega(x \cdot y) \leq 12</script>. How can we count the number of pairs (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1057"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058">x</span><span class="MJXp-mo" id="MJXp-Span-1059" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1060">y</span></span></span><script type="math/tex" id="MathJax-Element-145">x,y</script>) with a fixed sum <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1061"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1062">ω</span><span class="MJXp-mo" id="MJXp-Span-1063" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">x</span><span class="MJXp-mo" id="MJXp-Span-1065" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1066" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067">ω</span><span class="MJXp-mo" id="MJXp-Span-1068" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1069">y</span><span class="MJXp-mo" id="MJXp-Span-1070" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1071" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1072">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1073">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1076">t</span></span></span><script type="math/tex" id="MathJax-Element-146">\omega(x)+\omega(y)=const</script> and a fixed <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1077"><span class="MJXp-mi" id="MJXp-Span-1078">gcd</span><span class="MJXp-mo" id="MJXp-Span-1079" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1080" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081">x</span><span class="MJXp-mo" id="MJXp-Span-1082" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1083">y</span><span class="MJXp-mo" id="MJXp-Span-1084" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1085" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1087">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1089">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090">t</span></span></span><script type="math/tex" id="MathJax-Element-147">\operatorname{gcd}(x,y)=const</script>?</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1091"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092">K</span></span></span><script type="math/tex" id="MathJax-Element-148">K</script> denote the maximum number of unique primes in the factorization of any number under the given constraints. In this problem, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1093"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094">K</span><span class="MJXp-mo" id="MJXp-Span-1095" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-1096">6</span></span></span><script type="math/tex" id="MathJax-Element-149">K \leq 6</script>, and asymptotically <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1097"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098">K</span><span class="MJXp-mo" id="MJXp-Span-1099" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100">O</span><span class="MJXp-mo" id="MJXp-Span-1101" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-1102">log</span><span class="MJXp-mo" id="MJXp-Span-1103" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1104" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1105">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1107">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1108">A</span><span class="MJXp-mo" id="MJXp-Span-1109" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1110" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-150">K=O(\operatorname{log}(maxA))</script>.</p><p>Let's try to compute <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1112">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">p</span><span class="MJXp-mo" id="MJXp-Span-1114" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">g</span><span class="MJXp-mo" id="MJXp-Span-1116" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1117" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1119">u</span><span class="MJXp-msubsup" id="MJXp-Span-1120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1122" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1123">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1124">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1126" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-151">dp[g][sum_{len}]</script> — the number of ordered pairs (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1127"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128">i</span><span class="MJXp-mo" id="MJXp-Span-1129" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130">j</span></span></span><script type="math/tex" id="MathJax-Element-152">i,j</script>) such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1131"><span class="MJXp-mi" id="MJXp-Span-1132">gcd</span><span class="MJXp-mo" id="MJXp-Span-1133" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1134" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1136" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1137" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1138" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1141" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1142" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1143" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">g</span></span></span><script type="math/tex" id="MathJax-Element-153">\operatorname{gcd}(a_i,a_j)=g</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1145"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146">ω</span><span class="MJXp-mo" id="MJXp-Span-1147" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1148"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1150" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1151" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1152" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">ω</span><span class="MJXp-mo" id="MJXp-Span-1154" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1155"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1156" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1157" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1158" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1159" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1161">u</span><span class="MJXp-msubsup" id="MJXp-Span-1162"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1164" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1166">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167">n</span></span></span></span></span><script type="math/tex" id="MathJax-Element-154">\omega(a_i)+\omega(a_j)=sum_{len}</script>. If we can compute this dynamic programming, then the answer to the problem is: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1168"><span class="MJXp-msubsup" id="MJXp-Span-1169"><span class="MJXp-mo" id="MJXp-Span-1170" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1176">g</span><span class="MJXp-mo" id="MJXp-Span-1177">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1172">g</span><span class="MJXp-mo" id="MJXp-Span-1173">=</span><span class="MJXp-mn" id="MJXp-Span-1174">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1179"><span class="MJXp-mo" id="MJXp-Span-1180" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1187"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1188">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190">n</span><span class="MJXp-mo" id="MJXp-Span-1191">=</span><span class="MJXp-mn" id="MJXp-Span-1192">2</span><span class="MJXp-mo" id="MJXp-Span-1193">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194">K</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1181"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1183">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184">n</span><span class="MJXp-mo" id="MJXp-Span-1185">=</span><span class="MJXp-mn" id="MJXp-Span-1186">1</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1195">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1196">p</span><span class="MJXp-mo" id="MJXp-Span-1197" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1198">g</span><span class="MJXp-mo" id="MJXp-Span-1199" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1200" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1201">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1202">u</span><span class="MJXp-msubsup" id="MJXp-Span-1203"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1204" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1205" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1206">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1207">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1208">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1209" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1210" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-1211" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1212">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213">u</span><span class="MJXp-msubsup" id="MJXp-Span-1214"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1215" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1216" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1218">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1219">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1220" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1221">ω</span><span class="MJXp-mo" id="MJXp-Span-1222" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1223">g</span><span class="MJXp-mo" id="MJXp-Span-1224" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1225"><span class="MJXp-mo" id="MJXp-Span-1226" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1227" style="vertical-align: 0.5em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-155">\sum_{g=1}^{g=n}\sum_{len=1}^{len=2 \cdot K}dp[g][sum_{len}] \cdot (sum_{len}-\omega(g))^k</script>.</p><p>A well-known method can be used to count the number of pairs of numbers in the array (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1228"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1229">i</span><span class="MJXp-mo" id="MJXp-Span-1230" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1231">j</span></span></span><script type="math/tex" id="MathJax-Element-156">i,j</script>) for which <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1232"><span class="MJXp-mi" id="MJXp-Span-1233">gcd</span><span class="MJXp-mo" id="MJXp-Span-1234" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1235" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1236"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1238" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1239" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1240"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1241" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1242" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1243" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1244" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245">g</span></span></span><script type="math/tex" id="MathJax-Element-157">\operatorname{gcd}(a_i,a_j)=g</script> for any number <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1246"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1247">g</span></span></span><script type="math/tex" id="MathJax-Element-158">g</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1248"><span class="MJXp-mn" id="MJXp-Span-1249">1</span></span></span><script type="math/tex" id="MathJax-Element-159">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1250"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1251">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1253">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254">A</span></span></span><script type="math/tex" id="MathJax-Element-160">maxA</script>. Let's modify this method for our problem.</p><p>Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1255"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1256">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1257">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">t</span><span class="MJXp-mo" id="MJXp-Span-1259" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260">x</span><span class="MJXp-mo" id="MJXp-Span-1261" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1262" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1264">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">n</span><span class="MJXp-mo" id="MJXp-Span-1266" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-161">cnt[x][len]</script> be the number of numbers in the original array that are divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1267"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1268">x</span></span></span><script type="math/tex" id="MathJax-Element-162">x</script>, and for which <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">ω</span><span class="MJXp-mo" id="MJXp-Span-1271" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1272">x</span><span class="MJXp-mo" id="MJXp-Span-1273" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-163">\omega(x)</script> equals <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1274"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1276">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277">n</span></span></span><script type="math/tex" id="MathJax-Element-164">len</script>.</p><p>To compute this auxiliary dynamic programming, we can iterate over each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279">x</span></span></span><script type="math/tex" id="MathJax-Element-165">x</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1280"><span class="MJXp-mn" id="MJXp-Span-1281">1</span></span></span><script type="math/tex" id="MathJax-Element-166">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1282"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1284">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1285">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1286">A</span></span></span><script type="math/tex" id="MathJax-Element-167">maxA</script>, and for each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288">x</span></span></span><script type="math/tex" id="MathJax-Element-168">x</script>, iterate over its multiples and add to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1289"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1290">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1292">t</span><span class="MJXp-mo" id="MJXp-Span-1293" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1294">x</span><span class="MJXp-mo" id="MJXp-Span-1295" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1296" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297">ω</span><span class="MJXp-mo" id="MJXp-Span-1298" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1299">i</span><span class="MJXp-mo" id="MJXp-Span-1300" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1301">x</span><span class="MJXp-mo" id="MJXp-Span-1302" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1303" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-169">cnt[x][\omega(i \cdot x)]</script> the count of multiples <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1304"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1305">i</span><span class="MJXp-mo" id="MJXp-Span-1306" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307">x</span></span></span><script type="math/tex" id="MathJax-Element-170">i \cdot x</script> from the array. The asymptotic complexity of this counting is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1308"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1309">O</span><span class="MJXp-mo" id="MJXp-Span-1310" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1311">n</span><span class="MJXp-mo" id="MJXp-Span-1312" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi" id="MJXp-Span-1313">log</span><span class="MJXp-mo" id="MJXp-Span-1314" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1315" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316">n</span><span class="MJXp-mo" id="MJXp-Span-1317" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1318" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-171">O(n \cdot \operatorname{log}(n))</script> (partial sums of the harmonic series).</p><p>Now we are ready to compute the dynamic programming <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1319"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1320">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1321">p</span><span class="MJXp-mo" id="MJXp-Span-1322" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1323">g</span><span class="MJXp-mo" id="MJXp-Span-1324" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1325" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1326">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1327">u</span><span class="MJXp-msubsup" id="MJXp-Span-1328"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1329" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1330" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1331">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1333">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1334" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-172">dp[g][sum_{len}]</script>. Let's iterate over the greatest common divisor <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1336">g</span></span></span><script type="math/tex" id="MathJax-Element-173">g</script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1339">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1340">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341">A</span></span></span><script type="math/tex" id="MathJax-Element-174">maxA</script> down to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1342"><span class="MJXp-mn" id="MJXp-Span-1343">1</span></span></span><script type="math/tex" id="MathJax-Element-175">1</script>. If we simply wanted to count the number of pairs with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1344"><span class="MJXp-mi" id="MJXp-Span-1345">gcd</span><span class="MJXp-mo" id="MJXp-Span-1346" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347">g</span></span></span><script type="math/tex" id="MathJax-Element-176">\operatorname{gcd}=g</script>, we would subtract the already counted pairs with larger multiples of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1348"><span class="MJXp-mi" id="MJXp-Span-1349">gcd</span></span></span><script type="math/tex" id="MathJax-Element-177">\operatorname{gcd}</script>.</p><p>But now we also have a fixed total length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1350"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1351">ω</span><span class="MJXp-mo" id="MJXp-Span-1352" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353">x</span><span class="MJXp-mo" id="MJXp-Span-1354" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-178">\omega(x)</script> of both numbers in the pair. Therefore, for a fixed <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1355"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1356">g</span></span></span><script type="math/tex" id="MathJax-Element-179">g</script>, we will also iterate over 2 parameters — <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1357"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1358">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359">e</span><span class="MJXp-msubsup" id="MJXp-Span-1360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1361" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1362" style="vertical-align: -0.4em;">a</span></span></span></span><script type="math/tex" id="MathJax-Element-180">len_a</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1363"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1364">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1365">e</span><span class="MJXp-msubsup" id="MJXp-Span-1366"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1367" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1368" style="vertical-align: -0.4em;">b</span></span></span></span><script type="math/tex" id="MathJax-Element-181">len_b</script>, that is, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1369"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1370">ω</span><span class="MJXp-mo" id="MJXp-Span-1371" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1372">a</span><span class="MJXp-mo" id="MJXp-Span-1373" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-182">\omega(a)</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1375">ω</span><span class="MJXp-mo" id="MJXp-Span-1376" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1377">b</span><span class="MJXp-mo" id="MJXp-Span-1378" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-183">\omega(b)</script> for both numbers.</p><p>Then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1379"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1381">p</span><span class="MJXp-mo" id="MJXp-Span-1382" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383">g</span><span class="MJXp-mo" id="MJXp-Span-1384" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1385" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1386">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1387">u</span><span class="MJXp-msubsup" id="MJXp-Span-1388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1390" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1391">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1392">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1393">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1394" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1395" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1396">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1397">p</span><span class="MJXp-mo" id="MJXp-Span-1398" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1399">g</span><span class="MJXp-mo" id="MJXp-Span-1400" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1401" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1402">ω</span><span class="MJXp-mo" id="MJXp-Span-1403" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404">a</span><span class="MJXp-mo" id="MJXp-Span-1405" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1406" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407">ω</span><span class="MJXp-mo" id="MJXp-Span-1408" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1409">b</span><span class="MJXp-mo" id="MJXp-Span-1410" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1411" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1412" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414">p</span><span class="MJXp-mo" id="MJXp-Span-1415" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1416">g</span><span class="MJXp-mo" id="MJXp-Span-1417" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1418" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1419">i</span><span class="MJXp-mo" id="MJXp-Span-1420" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1421">j</span><span class="MJXp-mo" id="MJXp-Span-1422" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1423" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1424">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1425">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1426">t</span><span class="MJXp-mo" id="MJXp-Span-1427" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1428">g</span><span class="MJXp-mo" id="MJXp-Span-1429" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1430" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431">i</span><span class="MJXp-mo" id="MJXp-Span-1432" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1433" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1434">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1435">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1436">t</span><span class="MJXp-mo" id="MJXp-Span-1437" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1438">g</span><span class="MJXp-mo" id="MJXp-Span-1439" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1440" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1441">j</span><span class="MJXp-mo" id="MJXp-Span-1442" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-184">dp[g][sum_{len}]=dp[g][\omega(a) + \omega(b)]=dp[g][i+j]=cnt[g][i] \cdot cnt[g][j]</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1443"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1444">i</span><span class="MJXp-mo" id="MJXp-Span-1445" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1446">j</span></span></span><script type="math/tex" id="MathJax-Element-185">i,j</script> are iterated from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1447"><span class="MJXp-mn" id="MJXp-Span-1448">1</span></span></span><script type="math/tex" id="MathJax-Element-186">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1449"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1450">K</span></span></span><script type="math/tex" id="MathJax-Element-187">K</script>. Here we also need to be careful and account for the case when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1451"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1452">i</span><span class="MJXp-mo" id="MJXp-Span-1453" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1454">j</span></span></span><script type="math/tex" id="MathJax-Element-188">i=j</script>, in which case we add <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1455"><span class="MJXp-mfrac" id="MJXp-Span-1456" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1457">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1458">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1459">t</span><span class="MJXp-mo" id="MJXp-Span-1460">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1461">g</span><span class="MJXp-mo" id="MJXp-Span-1462">]</span><span class="MJXp-mo" id="MJXp-Span-1463">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464">i</span><span class="MJXp-mo" id="MJXp-Span-1465">]</span><span class="MJXp-mo" id="MJXp-Span-1466">⋅</span><span class="MJXp-mo" id="MJXp-Span-1467">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1468">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1469">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1470">t</span><span class="MJXp-mo" id="MJXp-Span-1471">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1472">g</span><span class="MJXp-mo" id="MJXp-Span-1473">]</span><span class="MJXp-mo" id="MJXp-Span-1474">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1475">i</span><span class="MJXp-mo" id="MJXp-Span-1476">]</span><span class="MJXp-mo" id="MJXp-Span-1477">−</span><span class="MJXp-mn" id="MJXp-Span-1478">1</span><span class="MJXp-mo" id="MJXp-Span-1479">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1480">2</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-189">\frac{cnt[g][i] \cdot (cnt[g][i] - 1)}{2}</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1481"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1483">p</span><span class="MJXp-mo" id="MJXp-Span-1484" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1485">g</span><span class="MJXp-mo" id="MJXp-Span-1486" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1487" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1488">i</span><span class="MJXp-mo" id="MJXp-Span-1489" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490">j</span><span class="MJXp-mo" id="MJXp-Span-1491" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-190">dp[g][i+j]</script>.</p><p>Next, we simply iterate over the multiples of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1492"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1493">g</span></span></span><script type="math/tex" id="MathJax-Element-191">g</script>: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1494"><span class="MJXp-mn" id="MJXp-Span-1495">2</span><span class="MJXp-mo" id="MJXp-Span-1496" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1497">g</span><span class="MJXp-mo" id="MJXp-Span-1498" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1499">3</span><span class="MJXp-mo" id="MJXp-Span-1500" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1501">g</span><span class="MJXp-mo" id="MJXp-Span-1502" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1503" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex" id="MathJax-Element-192">2 \cdot g, 3 \cdot g, \ldots</script>, to subtract the intersections <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1505">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1506">p</span><span class="MJXp-mo" id="MJXp-Span-1507" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1508">g</span><span class="MJXp-mo" id="MJXp-Span-1509" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1510" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1511">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1512">u</span><span class="MJXp-msubsup" id="MJXp-Span-1513"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1514" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1515" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1516">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1517">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1518">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1519" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1520" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1522">p</span><span class="MJXp-mo" id="MJXp-Span-1523" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1524">g</span><span class="MJXp-mo" id="MJXp-Span-1525" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1526" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1527">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1528">u</span><span class="MJXp-msubsup" id="MJXp-Span-1529"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1530" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1531" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1532">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1533">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1534">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1535" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1536" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1538">p</span><span class="MJXp-mo" id="MJXp-Span-1539" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1540">i</span><span class="MJXp-mo" id="MJXp-Span-1541" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1542">g</span><span class="MJXp-mo" id="MJXp-Span-1543" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1544" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1545">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1546">u</span><span class="MJXp-msubsup" id="MJXp-Span-1547"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1549" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1550">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1551">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1552">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1553" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-193">dp[g][sum_{len}] = dp[g][sum_{len}] - dp[i \cdot g][sum_{len}]</script>.</p><p>The asymptotic complexity of the solution is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1554"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1555">O</span><span class="MJXp-mo" id="MJXp-Span-1556" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1557">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1558">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1559">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1560">A</span><span class="MJXp-mo" id="MJXp-Span-1561" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-1562" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1563"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1564" style="margin-right: 0.05em;">K</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1565" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1566" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1567">K</span><span class="MJXp-mo" id="MJXp-Span-1568" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi" id="MJXp-Span-1569">log</span><span class="MJXp-mo" id="MJXp-Span-1570" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1571" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1572">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1573">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1574">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575">A</span><span class="MJXp-mo" id="MJXp-Span-1576" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1577" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1578" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-194">O(maxA \cdot (K^2 + K \cdot \operatorname{log}(maxA)))</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Implementation</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
 
</span><span class="kwd">using</span><span class="pln"> std</span><span class="pun">::</span><span class="pln">cin</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> std</span><span class="pun">::</span><span class="pln">cout</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> vi </span><span class="pun">=</span><span class="pln"> std</span><span class="pun">::</span><span class="pln">vector</span><span class="str">&lt;int&gt;</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> vvi </span><span class="pun">=</span><span class="pln"> std</span><span class="pun">::</span><span class="pln">vector</span><span class="str">&lt;vi&gt;</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> ll </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">auto</span><span class="pln"> ready </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]()</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
        std</span><span class="pun">::</span><span class="pln">ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}();</span><span class="pln">
 
ll binpow</span><span class="pun">(</span><span class="pln">ll a</span><span class="pun">,</span><span class="pln"> ll p</span><span class="pun">,</span><span class="pln"> ll mod</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    ll res </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    ll mult </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> res </span><span class="pun">*</span><span class="pln"> mult </span><span class="pun">%</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
        mult </span><span class="pun">=</span><span class="pln"> mult </span><span class="pun">*</span><span class="pln"> mult </span><span class="pun">%</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
        p </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">const</span><span class="pln"> ll mod </span><span class="pun">=</span><span class="pln"> </span><span class="lit">998244353</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> max_a </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2e5</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">10</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> max_len </span><span class="pun">=</span><span class="pln"> </span><span class="lit">6</span><span class="pun">;</span><span class="pln">
vi fi_div</span><span class="pun">(</span><span class="pln">max_a</span><span class="pun">);</span><span class="pln">
vi num_len</span><span class="pun">(</span><span class="pln">max_a</span><span class="pun">);</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> precalc</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="com">// Here we precompute the number of unique primes in each number, i.e. w(n)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> max_a</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">fi_div</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;</span><span class="pln"> max_a</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">+=</span><span class="pln"> i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">fi_div</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> fi_div</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
 
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> max_a</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> len </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="pun">++</span><span class="pln">len</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> tmp </span><span class="pun">=</span><span class="pln"> fi_div</span><span class="pun">[</span><span class="pln">x</span><span class="pun">];</span><span class="pln">
            </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">fi_div</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> tmp</span><span class="pun">)</span><span class="pln"> x </span><span class="pun">/=</span><span class="pln"> tmp</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        num_len</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
 
    vi vec</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> vec</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
 
    vvi cnt</span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> vi</span><span class="pun">(</span><span class="pln">max_len </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">));</span><span class="pln">
 
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> vec</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
        cnt</span><span class="pun">[</span><span class="pln">vec</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]][</span><span class="pln">num_len</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    
    </span><span class="com">// Here we calcualte auxilary dp - cnt[x][len] - how many numbers with w(n) = len are divisible by x</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        vi dp</span><span class="pun">(</span><span class="pln">max_len </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
 
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;</span><span class="pln"> n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">+=</span><span class="pln"> i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> s </span><span class="pun">=</span><span class="lit">0</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> s </span><span class="pun">&lt;</span><span class="pln"> max_len </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">s</span><span class="pun">)</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">s</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="pln">s</span><span class="pun">];</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        cnt</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> dp</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    
    vvi dp</span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> vi</span><span class="pun">(</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> max_len </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">));</span><span class="pln">
    ll ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0LL</span><span class="pun">;</span><span class="pln">
    
    </span><span class="com">// Here we calcualte dp[g][len]</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> g </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> g </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> </span><span class="pun">--</span><span class="pln">g</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="com">// Account for cases len_a != len_b</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> len1 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> len1 </span><span class="pun">&lt;=</span><span class="pln"> max_len</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">len1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> len2 </span><span class="pun">=</span><span class="pln"> len1 </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> len2 </span><span class="pun">&lt;=</span><span class="pln"> max_len</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">len2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                dp</span><span class="pun">[</span><span class="pln">g</span><span class="pun">][</span><span class="pln">len1 </span><span class="pun">+</span><span class="pln"> len2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1LL</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">g</span><span class="pun">][</span><span class="pln">len1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">g</span><span class="pun">][</span><span class="pln">len2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
                dp</span><span class="pun">[</span><span class="pln">g</span><span class="pun">][</span><span class="pln">len1 </span><span class="pun">+</span><span class="pln"> len2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="com">// Account for cases len_a = len_b</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> len </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> len </span><span class="pun">&lt;=</span><span class="pln"> max_len</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">len</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            dp</span><span class="pun">[</span><span class="pln">g</span><span class="pun">][</span><span class="pln">len </span><span class="pun">+</span><span class="pln"> len</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1LL</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">g</span><span class="pun">][</span><span class="pln">len</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">g</span><span class="pun">][</span><span class="pln">len</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
            dp</span><span class="pun">[</span><span class="pln">g</span><span class="pun">][</span><span class="pln">len </span><span class="pun">+</span><span class="pln"> len</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        
        </span><span class="com">// Subtruct states with where gcd is multiple of current g</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> g</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;</span><span class="pln"> n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">+=</span><span class="pln"> g</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> s </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> s </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> max_len </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">s</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                dp</span><span class="pun">[</span><span class="pln">g</span><span class="pun">][</span><span class="pln">s</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="pln">s</span><span class="pun">];</span><span class="pln">
                dp</span><span class="pun">[</span><span class="pln">g</span><span class="pun">][</span><span class="pln">s</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> s </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> s </span><span class="pun">&lt;</span><span class="pln">  </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> max_len </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">s</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            dp</span><span class="pun">[</span><span class="pln">g</span><span class="pun">][</span><span class="pln">s</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
            dp</span><span class="pun">[</span><span class="pln">g</span><span class="pun">][</span><span class="pln">s</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
            dp</span><span class="pun">[</span><span class="pln">g</span><span class="pun">][</span><span class="pln">s</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    
        </span><span class="com">// Add k-th powers to the answer</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> gcd_len </span><span class="pun">=</span><span class="pln"> num_len</span><span class="pun">[</span><span class="pln">g</span><span class="pun">];</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> len </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> len </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> max_len </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">len</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> rad </span><span class="pun">=</span><span class="pln"> len </span><span class="pun">-</span><span class="pln"> gcd_len</span><span class="pun">;</span><span class="pln">
            ans </span><span class="pun">+=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">g</span><span class="pun">][</span><span class="pln">len</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> mod </span><span class="pun">*</span><span class="pln"> binpow</span><span class="pun">(</span><span class="pln">rad</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">,</span><span class="pln"> mod</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
            ans </span><span class="pun">%=</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
 
    </span><span class="pun">}</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"\n"</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    precalc</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span></code></pre></div></div><p>Tutorial of <a href="https://codeforces.com/contest/2176">Codeforces Round 1070 (Div. 2) </a></p></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2176" class="notice" style="text-decoration: none;">Codeforces Round 1070 (Div. 2)</a> </span>
        </div>
        
            

  <script>
    // Make all spoilers toggleable
    document.querySelectorAll('.spoiler-title').forEach(title => {
      title.addEventListener('click', function() {
        const spoiler = this.closest('.spoiler');
        spoiler.classList.toggle('open');
      });
    });
    
    // Open all spoilers by default for easier reading
    document.querySelectorAll('.spoiler').forEach(spoiler => {
      spoiler.classList.add('open');
    });
  </script>
</body>
</html>