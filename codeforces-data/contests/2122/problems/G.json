{
  "contestId": 2122,
  "index": "G",
  "title": "Tree Parking",
  "timeLimit": "2 seconds",
  "memoryLimit": "256 megabytes",
  "rating": 3300,
  "tags": [
    "combinatorics",
    "fft",
    "math",
    "trees"
  ],
  "statementHtml": "<p> </p>\n<p>Consider the following problem statement:</p>\n<p>You are given a tree with <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-1-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2\"><span class=\"mi\" id=\"MathJax-Span-3\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-1\">n</script> vertices rooted at <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-2-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5\"><span class=\"mn\" id=\"MathJax-Span-6\" style=\"font-family: MathJax_Main;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-2\">1</script>. For each <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-3-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7\" style=\"width: 5.468em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.115em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1004.12em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-8\"><span class=\"mn\" id=\"MathJax-Span-9\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-10\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-11\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">i</span><span class=\"mo\" id=\"MathJax-Span-12\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-13\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-3\">1 \\leq i \\leq n</script>, a car will enter the root at time <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-4-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-14\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.6em, 2.438em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-15\"><span class=\"msubsup\" id=\"MathJax-Span-16\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-17\" style=\"font-family: MathJax_Math-italic;\">l</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.327em;\"><span class=\"mi\" id=\"MathJax-Span-18\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>l</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-4\">l_i</script>. It will then instantaneously travel from the root to vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-5-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-19\" style=\"width: 0.436em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-20\"><span class=\"mi\" id=\"MathJax-Span-21\" style=\"font-family: MathJax_Math-italic;\">i</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>i</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-5\">i</script> through the unique simple path and park there. It will leave through the same path in the other direction at time <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-6-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-22\" style=\"width: 1.031em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.76em, 2.438em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-23\"><span class=\"msubsup\" id=\"MathJax-Span-24\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-25\" style=\"font-family: MathJax_Math-italic;\">r</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mi\" id=\"MathJax-Span-26\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>r</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-6\">r_i</script>.</p>\n<p>During the time when a car is parked in a vertex, it blocks other cars from traveling through that vertex. The tree is called <span class=\"tex-font-style-it\">valid</span> if and only if all cars are able to enter and leave the tree at their desired times.</p>\n<p>Count the number of pairs of sequences <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-7-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-27\" style=\"width: 0.436em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-28\"><span class=\"mi\" id=\"MathJax-Span-29\" style=\"font-family: MathJax_Math-italic;\">l</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>l</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-7\">l</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-8-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-30\" style=\"width: 0.598em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-31\"><span class=\"mi\" id=\"MathJax-Span-32\" style=\"font-family: MathJax_Math-italic;\">r</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>r</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-8\">r</script> such that <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-33\" style=\"width: 3.574em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.708em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1002.71em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-34\"><span class=\"msubsup\" id=\"MathJax-Span-35\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-36\" style=\"font-family: MathJax_Math-italic;\">l</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.327em;\"><span class=\"mi\" id=\"MathJax-Span-37\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-38\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">&lt;</span><span class=\"msubsup\" id=\"MathJax-Span-39\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-40\" style=\"font-family: MathJax_Math-italic;\">r</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mi\" id=\"MathJax-Span-41\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>l</mi><mi>i</mi></msub><mo>&lt;</mo><msub><mi>r</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-9\">l_i < r_i</script>, their concatenation is a permutation of <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-10-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-42\" style=\"width: 4.115em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.087em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1003.09em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-43\"><span class=\"mn\" id=\"MathJax-Span-44\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-45\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">…</span><span class=\"mn\" id=\"MathJax-Span-46\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">2</span><span class=\"mi\" id=\"MathJax-Span-47\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn><mo>…</mo><mn>2</mn><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-10\">1 \\ldots 2n</script>, and the tree is valid. </p>\n<p>Calculate the sum of the answers to the problem over all labeled trees<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-11-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;&amp;#x2217;&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-48\" style=\"width: 0.598em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-49\"><span class=\"msubsup\" id=\"MathJax-Span-50\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.845em, 1000em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-51\"></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-52\"><span class=\"mrow\" id=\"MathJax-Span-53\"><span class=\"mtext\" id=\"MathJax-Span-54\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">∗</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi></mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>∗</mtext></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-11\">^{\\text{∗}}</script> with <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-12-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-55\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-56\"><span class=\"mi\" id=\"MathJax-Span-57\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-12\">n</script> vertices and <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-58\" style=\"width: 0.76em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-59\"><span class=\"mi\" id=\"MathJax-Span-60\" style=\"font-family: MathJax_Math-italic;\">k</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>k</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-13\">k</script> leaves. The root is not considered a leaf. Since the answer may be large, calculate it modulo <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-14-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;998&lt;/mn&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mn&gt;244&lt;/mn&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mn&gt;353&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-61\" style=\"width: 6.388em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.819em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1004.76em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-62\"><span class=\"mn\" id=\"MathJax-Span-63\" style=\"font-family: MathJax_Main;\">998</span><span class=\"mspace\" id=\"MathJax-Span-64\" style=\"height: 0em; vertical-align: 0em; width: 0.165em; display: inline-block; overflow: hidden;\"></span><span class=\"mn\" id=\"MathJax-Span-65\" style=\"font-family: MathJax_Main;\">244</span><span class=\"mspace\" id=\"MathJax-Span-66\" style=\"height: 0em; vertical-align: 0em; width: 0.165em; display: inline-block; overflow: hidden;\"></span><span class=\"mn\" id=\"MathJax-Span-67\" style=\"font-family: MathJax_Main;\">353</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>998</mn><mspace width=\"thinmathspace\"></mspace><mn>244</mn><mspace width=\"thinmathspace\"></mspace><mn>353</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-14\">998\\,244\\,353</script>.</p>\n<p><span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-15-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;&amp;#x2217;&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-68\" style=\"width: 0.621em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 136%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.44em, 2.351em, -999.997em); top: -2.16em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-69\"><span class=\"msubsup\" id=\"MathJax-Span-70\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.834em, 1000em, 4.205em, -999.997em); top: -4.013em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-71\"></span><span style=\"display: inline-block; width: 0px; height: 4.019em;\"></span></span><span style=\"position: absolute; top: -4.384em; left: 0em;\"><span class=\"texatom\" id=\"MathJax-Span-72\"><span class=\"mrow\" id=\"MathJax-Span-73\"><span class=\"mtext\" id=\"MathJax-Span-74\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">∗</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.019em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.166em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.08em; border-left: 0px solid; width: 0px; height: 1.097em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mi></mi><mrow class=\"MJX-TeXAtom-ORD\"><mtext>∗</mtext></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-15\">^{\\text{∗}}</script>Two labeled trees are considered different if and only if their edge sets are different.</p>",
  "inputSpecHtml": "<p>Each test contains multiple test cases. The first line contains the number of test cases <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-75\" style=\"width: 0.544em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.381em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.33em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-76\"><span class=\"mi\" id=\"MathJax-Span-77\" style=\"font-family: MathJax_Math-italic;\">t</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>t</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-16\">t</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-78\" style=\"width: 6.496em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.927em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1004.93em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-79\"><span class=\"mn\" id=\"MathJax-Span-80\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-81\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-82\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">t</span><span class=\"mo\" id=\"MathJax-Span-83\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-84\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-85\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"mn\" id=\"MathJax-Span-86\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">4</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn><mo>≤</mo><mi>t</mi><mo>≤</mo><msup><mn>10</mn><mn>4</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-17\">1 \\le t \\le 10^4</script>). The description of the test cases follows. </p><p>The only line of each test case contains two integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-87\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-88\"><span class=\"mi\" id=\"MathJax-Span-89\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-18\">n</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-90\" style=\"width: 0.76em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-91\"><span class=\"mi\" id=\"MathJax-Span-92\" style=\"font-family: MathJax_Math-italic;\">k</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>k</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-19\">k</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-93\" style=\"width: 10.879em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 8.228em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1008.23em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-94\"><span class=\"mn\" id=\"MathJax-Span-95\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-96\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-97\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">k</span><span class=\"mo\" id=\"MathJax-Span-98\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-99\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span><span class=\"mo\" id=\"MathJax-Span-100\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mn\" id=\"MathJax-Span-101\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">2</span><span class=\"mo\" id=\"MathJax-Span-102\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">⋅</span><span class=\"msubsup\" id=\"MathJax-Span-103\" style=\"padding-left: 0.219em;\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-104\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"mn\" id=\"MathJax-Span-105\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">5</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn><mo>≤</mo><mi>k</mi><mo>&lt;</mo><mi>n</mi><mo>≤</mo><mn>2</mn><mo>⋅</mo><msup><mn>10</mn><mn>5</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-20\">1 \\leq k < n \\leq 2 \\cdot 10^5</script>)&nbsp;— the number of vertices and leaves of the tree, respectively.</p><p>It is guaranteed that the sum of <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-106\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-107\"><span class=\"mi\" id=\"MathJax-Span-108\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-21\">n</script> over all test cases does not exceed <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-109\" style=\"width: 3.52em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.654em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1002.65em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-110\"><span class=\"mn\" id=\"MathJax-Span-111\" style=\"font-family: MathJax_Main;\">2</span><span class=\"mo\" id=\"MathJax-Span-112\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">⋅</span><span class=\"msubsup\" id=\"MathJax-Span-113\" style=\"padding-left: 0.219em;\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-114\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"mn\" id=\"MathJax-Span-115\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">5</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>2</mn><mo>⋅</mo><msup><mn>10</mn><mn>5</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-22\">2 \\cdot 10^5</script>. </p>",
  "outputSpecHtml": "<p>For each test case, output one integer&nbsp;— the answer modulo <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-23-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;998&lt;/mn&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mn&gt;244&lt;/mn&gt;&lt;mspace width=&quot;thinmathspace&quot; /&gt;&lt;mn&gt;353&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-116\" style=\"width: 6.388em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.819em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1004.76em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-117\"><span class=\"mn\" id=\"MathJax-Span-118\" style=\"font-family: MathJax_Main;\">998</span><span class=\"mspace\" id=\"MathJax-Span-119\" style=\"height: 0em; vertical-align: 0em; width: 0.165em; display: inline-block; overflow: hidden;\"></span><span class=\"mn\" id=\"MathJax-Span-120\" style=\"font-family: MathJax_Main;\">244</span><span class=\"mspace\" id=\"MathJax-Span-121\" style=\"height: 0em; vertical-align: 0em; width: 0.165em; display: inline-block; overflow: hidden;\"></span><span class=\"mn\" id=\"MathJax-Span-122\" style=\"font-family: MathJax_Main;\">353</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>998</mn><mspace width=\"thinmathspace\"></mspace><mn>244</mn><mspace width=\"thinmathspace\"></mspace><mn>353</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-23\">998\\,244\\,353</script>.</p>",
  "noteHtml": "<p>In the first case, there is only one tree that satisfies the constraints. The correct pairs of sequences are: <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-24-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle scriptlevel=&quot;0&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mstyle scriptlevel=&quot;0&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mspace width=&quot;mediummathspace&quot; /&gt;&lt;mstyle scriptlevel=&quot;0&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mstyle scriptlevel=&quot;0&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mspace width=&quot;mediummathspace&quot; /&gt;&lt;mstyle scriptlevel=&quot;0&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-OPEN&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;(&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;mstyle scriptlevel=&quot;0&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-CLOSE&quot;&gt;&lt;mo maxsize=&quot;1.2em&quot; minsize=&quot;1.2em&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mstyle&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-123\" style=\"width: 27.708em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 20.998em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.193em, 1020.94em, 2.708em, -999.997em); top: -2.216em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-124\"><span class=\"mo\" id=\"MathJax-Span-125\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-126\" style=\"font-family: MathJax_Math-italic;\">l</span><span class=\"mo\" id=\"MathJax-Span-127\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-128\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">r</span><span class=\"mo\" id=\"MathJax-Span-129\" style=\"font-family: MathJax_Main;\">)</span><span class=\"mo\" id=\"MathJax-Span-130\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mstyle\" id=\"MathJax-Span-131\" style=\"padding-left: 0.273em;\"><span class=\"mrow\" id=\"MathJax-Span-132\"><span class=\"texatom\" id=\"MathJax-Span-133\"><span class=\"mrow\" id=\"MathJax-Span-134\"><span class=\"mo\" id=\"MathJax-Span-135\" style=\"vertical-align: 0em;\"><span style=\"font-family: MathJax_Size1;\">(</span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-136\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-137\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-138\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-139\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">3</span><span class=\"mo\" id=\"MathJax-Span-140\" style=\"font-family: MathJax_Main;\">]</span><span class=\"mo\" id=\"MathJax-Span-141\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mo\" id=\"MathJax-Span-142\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">[</span><span class=\"mn\" id=\"MathJax-Span-143\" style=\"font-family: MathJax_Main;\">2</span><span class=\"mo\" id=\"MathJax-Span-144\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-145\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">4</span><span class=\"mo\" id=\"MathJax-Span-146\" style=\"font-family: MathJax_Main;\">]</span><span class=\"mstyle\" id=\"MathJax-Span-147\"><span class=\"mrow\" id=\"MathJax-Span-148\"><span class=\"texatom\" id=\"MathJax-Span-149\"><span class=\"mrow\" id=\"MathJax-Span-150\"><span class=\"mo\" id=\"MathJax-Span-151\" style=\"vertical-align: 0em;\"><span style=\"font-family: MathJax_Size1;\">)</span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-152\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mspace\" id=\"MathJax-Span-153\" style=\"height: 0em; vertical-align: 0em; width: 0.219em; display: inline-block; overflow: hidden;\"></span><span class=\"mstyle\" id=\"MathJax-Span-154\" style=\"padding-left: 0.165em;\"><span class=\"mrow\" id=\"MathJax-Span-155\"><span class=\"texatom\" id=\"MathJax-Span-156\"><span class=\"mrow\" id=\"MathJax-Span-157\"><span class=\"mo\" id=\"MathJax-Span-158\" style=\"vertical-align: 0em;\"><span style=\"font-family: MathJax_Size1;\">(</span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-159\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-160\" style=\"font-family: MathJax_Main;\">3</span><span class=\"mo\" id=\"MathJax-Span-161\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-162\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-163\" style=\"font-family: MathJax_Main;\">]</span><span class=\"mo\" id=\"MathJax-Span-164\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mo\" id=\"MathJax-Span-165\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">[</span><span class=\"mn\" id=\"MathJax-Span-166\" style=\"font-family: MathJax_Main;\">4</span><span class=\"mo\" id=\"MathJax-Span-167\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-168\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">2</span><span class=\"mo\" id=\"MathJax-Span-169\" style=\"font-family: MathJax_Main;\">]</span><span class=\"mstyle\" id=\"MathJax-Span-170\"><span class=\"mrow\" id=\"MathJax-Span-171\"><span class=\"texatom\" id=\"MathJax-Span-172\"><span class=\"mrow\" id=\"MathJax-Span-173\"><span class=\"mo\" id=\"MathJax-Span-174\" style=\"vertical-align: 0em;\"><span style=\"font-family: MathJax_Size1;\">)</span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-175\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mspace\" id=\"MathJax-Span-176\" style=\"height: 0em; vertical-align: 0em; width: 0.219em; display: inline-block; overflow: hidden;\"></span><span class=\"mstyle\" id=\"MathJax-Span-177\" style=\"padding-left: 0.165em;\"><span class=\"mrow\" id=\"MathJax-Span-178\"><span class=\"texatom\" id=\"MathJax-Span-179\"><span class=\"mrow\" id=\"MathJax-Span-180\"><span class=\"mo\" id=\"MathJax-Span-181\" style=\"vertical-align: 0em;\"><span style=\"font-family: MathJax_Size1;\">(</span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-182\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-183\" style=\"font-family: MathJax_Main;\">2</span><span class=\"mo\" id=\"MathJax-Span-184\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-185\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-186\" style=\"font-family: MathJax_Main;\">]</span><span class=\"mo\" id=\"MathJax-Span-187\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mo\" id=\"MathJax-Span-188\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">[</span><span class=\"mn\" id=\"MathJax-Span-189\" style=\"font-family: MathJax_Main;\">3</span><span class=\"mo\" id=\"MathJax-Span-190\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-191\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">4</span><span class=\"mo\" id=\"MathJax-Span-192\" style=\"font-family: MathJax_Main;\">]</span><span class=\"mstyle\" id=\"MathJax-Span-193\"><span class=\"mrow\" id=\"MathJax-Span-194\"><span class=\"texatom\" id=\"MathJax-Span-195\"><span class=\"mrow\" id=\"MathJax-Span-196\"><span class=\"mo\" id=\"MathJax-Span-197\" style=\"vertical-align: 0em;\"><span style=\"font-family: MathJax_Size1;\">)</span></span></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-198\" style=\"font-family: MathJax_Main;\">.</span></span><span style=\"display: inline-block; width: 0px; height: 2.221em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.496em; border-left: 0px solid; width: 0px; height: 1.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mo stretchy=\"false\">(</mo><mi>l</mi><mo>,</mo><mi>r</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mstyle scriptlevel=\"0\"><mrow class=\"MJX-TeXAtom-OPEN\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo></mrow></mstyle><mo stretchy=\"false\">[</mo><mn>1</mn><mo>,</mo><mn>3</mn><mo stretchy=\"false\">]</mo><mo>,</mo><mo stretchy=\"false\">[</mo><mn>2</mn><mo>,</mo><mn>4</mn><mo stretchy=\"false\">]</mo><mstyle scriptlevel=\"0\"><mrow class=\"MJX-TeXAtom-CLOSE\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo></mrow></mstyle><mo>,</mo><mspace width=\"mediummathspace\"></mspace><mstyle scriptlevel=\"0\"><mrow class=\"MJX-TeXAtom-OPEN\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo></mrow></mstyle><mo stretchy=\"false\">[</mo><mn>3</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo>,</mo><mo stretchy=\"false\">[</mo><mn>4</mn><mo>,</mo><mn>2</mn><mo stretchy=\"false\">]</mo><mstyle scriptlevel=\"0\"><mrow class=\"MJX-TeXAtom-CLOSE\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo></mrow></mstyle><mo>,</mo><mspace width=\"mediummathspace\"></mspace><mstyle scriptlevel=\"0\"><mrow class=\"MJX-TeXAtom-OPEN\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo></mrow></mstyle><mo stretchy=\"false\">[</mo><mn>2</mn><mo>,</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo>,</mo><mo stretchy=\"false\">[</mo><mn>3</mn><mo>,</mo><mn>4</mn><mo stretchy=\"false\">]</mo><mstyle scriptlevel=\"0\"><mrow class=\"MJX-TeXAtom-CLOSE\"><mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo></mrow></mstyle><mo>.</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-24\"> (l, r) = \\bigl([1, 3], [2, 4]\\bigr),\\:\\bigl([3, 1], [4, 2]\\bigr),\\:\\bigl([2, 1], [3, 4]\\bigr). </script></p>",
  "samples": [
    {
      "input": "32 18 365 43",
      "output": "3\n899171636\n38330886"
    }
  ],
  "images": [],
  "url": "https://codeforces.com/contest/2122/problem/G",
  "tutorialHtml": "<div><div class=\"ttypography\"><div class=\"problem-statement\"><div><p>Let's solve the problem for a single tree.</p><p>A tree is valid if and only if no interval contains any endpoint from its subtree. This condition allows us to approach the problem using dynamic programming. After simplification, the answer for a single tree becomes <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span></p><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-245-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mfrac><mrow><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo><mo>!</mo></mrow><mrow><msup><mn>2</mn><mi>n</mi></msup><msub><mi>s</mi><mn>1</mn></msub><msub><mi>s</mi><mn>2</mn></msub><mo>&amp;#x22EF;</mo><msub><mi>s</mi><mi>n</mi></msub></mrow></mfrac><mo>,</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2948\" style=\"width: 7.795em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.901em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(0.544em, 1005.85em, 3.195em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2949\"><span class=\"mfrac\" id=\"MathJax-Span-2950\"><span style=\"display: inline-block; position: relative; width: 5.414em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;\"><span style=\"position: absolute; clip: rect(3.087em, 1002.06em, 4.44em, -999.997em); top: -4.705em; left: 50%; margin-left: -1.08em;\"><span class=\"mrow\" id=\"MathJax-Span-2951\"><span class=\"mo\" id=\"MathJax-Span-2952\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mn\" id=\"MathJax-Span-2953\" style=\"font-family: MathJax_Main;\">2</span><span class=\"mi\" id=\"MathJax-Span-2954\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-2955\" style=\"font-family: MathJax_Main;\">)</span><span class=\"mo\" id=\"MathJax-Span-2956\" style=\"font-family: MathJax_Main;\">!</span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; clip: rect(3.141em, 1005.25em, 4.332em, -999.997em); top: -3.298em; left: 50%; margin-left: -2.649em;\"><span class=\"mrow\" id=\"MathJax-Span-2957\"><span class=\"msubsup\" id=\"MathJax-Span-2958\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-2959\" style=\"font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.49em;\"><span class=\"mi\" id=\"MathJax-Span-2960\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2961\"><span style=\"display: inline-block; position: relative; width: 0.923em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2962\" style=\"font-family: MathJax_Math-italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.49em;\"><span class=\"mn\" id=\"MathJax-Span-2963\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2964\"><span style=\"display: inline-block; position: relative; width: 0.923em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2965\" style=\"font-family: MathJax_Math-italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.49em;\"><span class=\"mn\" id=\"MathJax-Span-2966\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2967\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">⋯</span><span class=\"msubsup\" id=\"MathJax-Span-2968\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2969\" style=\"font-family: MathJax_Math-italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.49em;\"><span class=\"mi\" id=\"MathJax-Span-2970\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; clip: rect(0.869em, 1005.41em, 1.247em, -999.997em); top: -1.296em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.414em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.085em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2971\" style=\"font-family: MathJax_Main;\">,</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -1.211em; border-left: 0px solid; width: 0px; height: 3.218em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mfrac><mrow><mo stretchy=\"false\">(</mo><mn>2</mn><mi>n</mi><mo stretchy=\"false\">)</mo><mo>!</mo></mrow><mrow><msup><mn>2</mn><mi>n</mi></msup><msub><mi>s</mi><mn>1</mn></msub><msub><mi>s</mi><mn>2</mn></msub><mo>⋯</mo><msub><mi>s</mi><mi>n</mi></msub></mrow></mfrac><mo>,</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-245\"> \\frac{(2n)!}{2^n s_1 s_2 \\cdots s_n}, </script> where <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-246-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>s</mi><mi>i</mi></msub></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2972\" style=\"width: 1.085em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.814em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.81em, 2.438em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2973\"><span class=\"msubsup\" id=\"MathJax-Span-2974\"><span style=\"display: inline-block; position: relative; width: 0.814em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2975\" style=\"font-family: MathJax_Math-italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.49em;\"><span class=\"mi\" id=\"MathJax-Span-2976\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>s</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-246\">s_i</script> is the size of the subtree rooted at vertex <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-247-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2977\" style=\"width: 0.436em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2978\"><span class=\"mi\" id=\"MathJax-Span-2979\" style=\"font-family: MathJax_Math-italic;\">i</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>i</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-247\">i</script>. Therefore, calculating the sum of the answers reduces to computing the sum of <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-248-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;><mfrac><mn>1</mn><mrow><msub><mi>s</mi><mn>1</mn></msub><msub><mi>s</mi><mn>2</mn></msub><mo>&amp;#x22EF;</mo><msub><mi>s</mi><mi>n</mi></msub></mrow></mfrac></mstyle></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2980\" style=\"width: 4.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.141em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.085em, 1003.14em, 2.708em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2981\"><span class=\"mstyle\" id=\"MathJax-Span-2982\"><span class=\"mrow\" id=\"MathJax-Span-2983\"><span class=\"mfrac\" id=\"MathJax-Span-2984\"><span style=\"display: inline-block; position: relative; width: 2.925em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;\"><span style=\"position: absolute; clip: rect(3.358em, 1000.33em, 4.169em, -999.997em); top: -4.435em; left: 50%; margin-left: -0.16em;\"><span class=\"mn\" id=\"MathJax-Span-2985\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; clip: rect(3.52em, 1002.76em, 4.278em, -999.997em); top: -3.677em; left: 50%; margin-left: -1.404em;\"><span class=\"mrow\" id=\"MathJax-Span-2986\"><span class=\"msubsup\" id=\"MathJax-Span-2987\"><span style=\"display: inline-block; position: relative; width: 0.652em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.52em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2988\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.893em; left: 0.327em;\"><span class=\"mn\" id=\"MathJax-Span-2989\" style=\"font-size: 50%; font-family: MathJax_Main;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-2990\"><span style=\"display: inline-block; position: relative; width: 0.652em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.52em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2991\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.893em; left: 0.327em;\"><span class=\"mn\" id=\"MathJax-Span-2992\" style=\"font-size: 50%; font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-2993\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">⋯</span><span class=\"msubsup\" id=\"MathJax-Span-2994\"><span style=\"display: inline-block; position: relative; width: 0.706em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.52em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-2995\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.893em; left: 0.327em;\"><span class=\"mi\" id=\"MathJax-Span-2996\" style=\"font-size: 50%; font-family: MathJax_Math-italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; clip: rect(0.869em, 1002.92em, 1.247em, -999.997em); top: -1.296em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.925em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.085em;\"></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 1.932em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mstyle displaystyle=\"false\" scriptlevel=\"0\"><mfrac><mn>1</mn><mrow><msub><mi>s</mi><mn>1</mn></msub><msub><mi>s</mi><mn>2</mn></msub><mo>⋯</mo><msub><mi>s</mi><mi>n</mi></msub></mrow></mfrac></mstyle></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-248\">\\tfrac{1}{s_1 s_2 \\cdots s_n}</script> across all labeled trees with <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-249-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-2997\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2998\"><span class=\"mi\" id=\"MathJax-Span-2999\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-249\">n</script> vertices and <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-250-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3000\" style=\"width: 0.76em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3001\"><span class=\"mi\" id=\"MathJax-Span-3002\" style=\"font-family: MathJax_Math-italic;\">k</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>k</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-250\">k</script> leaves.<p></p><p>It is a well-known result that the number of topological sorts of a tree is <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-251-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;false&quot; scriptlevel=&quot;0&quot;><mfrac><mrow><mi>n</mi><mo>!</mo></mrow><mrow><msub><mi>s</mi><mn>1</mn></msub><msub><mi>s</mi><mn>2</mn></msub><mo>&amp;#x22EF;</mo><msub><mi>s</mi><mi>n</mi></msub></mrow></mfrac></mstyle></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3003\" style=\"width: 4.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.141em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.031em, 1003.14em, 2.708em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3004\"><span class=\"mstyle\" id=\"MathJax-Span-3005\"><span class=\"mrow\" id=\"MathJax-Span-3006\"><span class=\"mfrac\" id=\"MathJax-Span-3007\"><span style=\"display: inline-block; position: relative; width: 2.925em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;\"><span style=\"position: absolute; clip: rect(3.358em, 1000.54em, 4.169em, -999.997em); top: -4.435em; left: 50%; margin-left: -0.322em;\"><span class=\"mrow\" id=\"MathJax-Span-3008\"><span class=\"mi\" id=\"MathJax-Span-3009\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-3010\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">!</span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; clip: rect(3.52em, 1002.76em, 4.278em, -999.997em); top: -3.677em; left: 50%; margin-left: -1.404em;\"><span class=\"mrow\" id=\"MathJax-Span-3011\"><span class=\"msubsup\" id=\"MathJax-Span-3012\"><span style=\"display: inline-block; position: relative; width: 0.652em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.52em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3013\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.893em; left: 0.327em;\"><span class=\"mn\" id=\"MathJax-Span-3014\" style=\"font-size: 50%; font-family: MathJax_Main;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"msubsup\" id=\"MathJax-Span-3015\"><span style=\"display: inline-block; position: relative; width: 0.652em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.52em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3016\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.893em; left: 0.327em;\"><span class=\"mn\" id=\"MathJax-Span-3017\" style=\"font-size: 50%; font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3018\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">⋯</span><span class=\"msubsup\" id=\"MathJax-Span-3019\"><span style=\"display: inline-block; position: relative; width: 0.706em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.52em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3020\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.893em; left: 0.327em;\"><span class=\"mi\" id=\"MathJax-Span-3021\" style=\"font-size: 50%; font-family: MathJax_Math-italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; clip: rect(0.869em, 1002.92em, 1.247em, -999.997em); top: -1.296em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.925em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.085em;\"></span></span></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.639em; border-left: 0px solid; width: 0px; height: 2.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mstyle displaystyle=\"false\" scriptlevel=\"0\"><mfrac><mrow><mi>n</mi><mo>!</mo></mrow><mrow><msub><mi>s</mi><mn>1</mn></msub><msub><mi>s</mi><mn>2</mn></msub><mo>⋯</mo><msub><mi>s</mi><mi>n</mi></msub></mrow></mfrac></mstyle></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-251\">\\tfrac{n!}{s_1 s_2 \\cdots s_n}</script>. This means we only need to compute the total number of topological sorts of all trees with <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-252-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3022\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3023\"><span class=\"mi\" id=\"MathJax-Span-3024\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-252\">n</script> vertices and <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-253-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3025\" style=\"width: 0.76em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3026\"><span class=\"mi\" id=\"MathJax-Span-3027\" style=\"font-family: MathJax_Math-italic;\">k</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>k</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-253\">k</script> leaves, and then divide the result by <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-254-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi><mo>!</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3028\" style=\"width: 1.139em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.81em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3029\"><span class=\"mi\" id=\"MathJax-Span-3030\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-3031\" style=\"font-family: MathJax_Main;\">!</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi><mo>!</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-254\">n!</script> to obtain the desired sum.</p><p>Let us now fix a topological sort and count the number of trees consistent with it. This is equivalent to counting the number of trees where each parent <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-255-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>p</mi><mi>i</mi></msub><mo>&amp;lt;</mo><mi>i</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3032\" style=\"width: 3.304em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.492em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1002.44em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3033\"><span class=\"msubsup\" id=\"MathJax-Span-3034\"><span style=\"display: inline-block; position: relative; width: 0.814em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-3035\" style=\"font-family: MathJax_Math-italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.49em;\"><span class=\"mi\" id=\"MathJax-Span-3036\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3037\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">&lt;</span><span class=\"mi\" id=\"MathJax-Span-3038\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">i</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>p</mi><mi>i</mi></msub><mo>&lt;</mo><mi>i</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-255\">p_i < i</script>, and the tree has exactly <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-256-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3039\" style=\"width: 0.76em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3040\"><span class=\"mi\" id=\"MathJax-Span-3041\" style=\"font-family: MathJax_Math-italic;\">k</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>k</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-256\">k</script> leaves. This leads to the recurrence:</p><p><span class=\"MathJax_Preview\" style=\"color: inherit;\"></span></p><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-257-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo>,</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x22C5;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo>&amp;#x2212;</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x22C5;</mo><mi>k</mi><mo>.</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3042\" style=\"width: 28.682em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 21.702em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1021.65em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3043\"><span class=\"mi\" id=\"MathJax-Span-3044\" style=\"font-family: MathJax_Math-italic;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3045\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-3046\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-3047\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-3048\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">k</span><span class=\"mo\" id=\"MathJax-Span-3049\" style=\"font-family: MathJax_Main;\">)</span><span class=\"mo\" id=\"MathJax-Span-3050\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mi\" id=\"MathJax-Span-3051\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3052\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-3053\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-3054\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mn\" id=\"MathJax-Span-3055\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span><span class=\"mo\" id=\"MathJax-Span-3056\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-3057\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">k</span><span class=\"mo\" id=\"MathJax-Span-3058\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mn\" id=\"MathJax-Span-3059\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span><span class=\"mo\" id=\"MathJax-Span-3060\" style=\"font-family: MathJax_Main;\">)</span><span class=\"mo\" id=\"MathJax-Span-3061\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">⋅</span><span class=\"mo\" id=\"MathJax-Span-3062\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">(</span><span class=\"mi\" id=\"MathJax-Span-3063\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-3064\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mi\" id=\"MathJax-Span-3065\" style=\"font-family: MathJax_Math-italic; padding-left: 0.219em;\">k</span><span class=\"mo\" id=\"MathJax-Span-3066\" style=\"font-family: MathJax_Main;\">)</span><span class=\"mo\" id=\"MathJax-Span-3067\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">+</span><span class=\"mi\" id=\"MathJax-Span-3068\" style=\"font-family: MathJax_Math-italic; padding-left: 0.219em;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3069\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-3070\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-3071\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mn\" id=\"MathJax-Span-3072\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span><span class=\"mo\" id=\"MathJax-Span-3073\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-3074\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">k</span><span class=\"mo\" id=\"MathJax-Span-3075\" style=\"font-family: MathJax_Main;\">)</span><span class=\"mo\" id=\"MathJax-Span-3076\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">⋅</span><span class=\"mi\" id=\"MathJax-Span-3077\" style=\"font-family: MathJax_Math-italic; padding-left: 0.219em;\">k</span><span class=\"mo\" id=\"MathJax-Span-3078\" style=\"font-family: MathJax_Main;\">.</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mi>f</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo>,</mo><mi>k</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>⋅</mo><mo stretchy=\"false\">(</mo><mi>n</mi><mo>−</mo><mi>k</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>k</mi><mo stretchy=\"false\">)</mo><mo>⋅</mo><mi>k</mi><mo>.</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-257\"> f(n, k) = f(n - 1, k - 1) \\cdot (n - k) + f(n - 1, k) \\cdot k. </script><p></p><p>It turns out (as can be verified via OEIS or other sources) that <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-258-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo>,</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>A</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3079\" style=\"width: 14.18em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.717em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1010.61em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3080\"><span class=\"mi\" id=\"MathJax-Span-3081\" style=\"font-family: MathJax_Math-italic;\">f<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-3082\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-3083\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-3084\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-3085\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">k</span><span class=\"mo\" id=\"MathJax-Span-3086\" style=\"font-family: MathJax_Main;\">)</span><span class=\"mo\" id=\"MathJax-Span-3087\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mi\" id=\"MathJax-Span-3088\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">A</span><span class=\"mo\" id=\"MathJax-Span-3089\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-3090\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-3091\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mn\" id=\"MathJax-Span-3092\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span><span class=\"mo\" id=\"MathJax-Span-3093\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-3094\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">k</span><span class=\"mo\" id=\"MathJax-Span-3095\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mn\" id=\"MathJax-Span-3096\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span><span class=\"mo\" id=\"MathJax-Span-3097\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>f</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo>,</mo><mi>k</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>A</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-258\">f(n, k) = A(n - 1, k - 1)</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-259-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo>,</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3098\" style=\"width: 4.115em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.087em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1002.98em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3099\"><span class=\"mi\" id=\"MathJax-Span-3100\" style=\"font-family: MathJax_Math-italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-3101\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-3102\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-3103\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-3104\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">k</span><span class=\"mo\" id=\"MathJax-Span-3105\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>A</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo>,</mo><mi>k</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-259\">A(n, k)</script> is the Eulerian number counting permutations of length <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-260-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3106\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3107\"><span class=\"mi\" id=\"MathJax-Span-3108\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-260\">n</script> with exactly <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-261-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3109\" style=\"width: 0.76em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3110\"><span class=\"mi\" id=\"MathJax-Span-3111\" style=\"font-family: MathJax_Math-italic;\">k</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>k</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-261\">k</script> descents. Eulerian numbers can be computed efficiently <a href=\"https://en.wikipedia.org/wiki/Eulerian_number#Definition\">using inclusion-exclusion</a> in <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-262-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;>O</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>k</mi><mi>log</mi><mo>&amp;#x2061;</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo></math>\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3112\" style=\"width: 5.739em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.332em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1004.22em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3113\"><span class=\"texatom\" id=\"MathJax-Span-3114\"><span class=\"mrow\" id=\"MathJax-Span-3115\"><span class=\"mi\" id=\"MathJax-Span-3116\" style=\"font-family: MathJax_Caligraphic;\">O</span></span></span><span class=\"mo\" id=\"MathJax-Span-3117\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-3118\" style=\"font-family: MathJax_Math-italic;\">k</span><span class=\"mi\" id=\"MathJax-Span-3119\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">log</span><span class=\"mo\" id=\"MathJax-Span-3120\"></span><span class=\"mi\" id=\"MathJax-Span-3121\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">n</span><span class=\"mo\" id=\"MathJax-Span-3122\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">O</mi></mrow><mo stretchy=\"false\">(</mo><mi>k</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy=\"false\">)</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-262\">\\mathcal{O}(k \\log n)</script> time.</p><p>Taking everything into account, the final answer is <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span></p><div class=\"MathJax_Display\" style=\"text-align: center;\"><span class=\"MathJax\" id=\"MathJax-Element-263-Frame\" tabindex=\"0\" data-mathml=\"<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mfrac><mrow><mi>A</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x22C5;</mo><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo><mo>!</mo></mrow><mrow><mi>n</mi><mo>&amp;#x22C5;</mo><msup><mn>2</mn><mi>n</mi></msup></mrow></mfrac><mo>.</mo></math>\" role=\"presentation\" style=\"text-align: center; position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-3123\" style=\"width: 13.26em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.014em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(0.544em, 1009.96em, 3.033em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-3124\"><span class=\"mfrac\" id=\"MathJax-Span-3125\"><span style=\"display: inline-block; position: relative; width: 9.527em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;\"><span style=\"position: absolute; clip: rect(3.087em, 1009.31em, 4.44em, -999.997em); top: -4.705em; left: 50%; margin-left: -4.705em;\"><span class=\"mrow\" id=\"MathJax-Span-3126\"><span class=\"mi\" id=\"MathJax-Span-3127\" style=\"font-family: MathJax_Math-italic;\">A</span><span class=\"mo\" id=\"MathJax-Span-3128\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-3129\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-3130\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mn\" id=\"MathJax-Span-3131\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span><span class=\"mo\" id=\"MathJax-Span-3132\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-3133\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">k</span><span class=\"mo\" id=\"MathJax-Span-3134\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mn\" id=\"MathJax-Span-3135\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span><span class=\"mo\" id=\"MathJax-Span-3136\" style=\"font-family: MathJax_Main;\">)</span><span class=\"mo\" id=\"MathJax-Span-3137\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">⋅</span><span class=\"mo\" id=\"MathJax-Span-3138\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">(</span><span class=\"mn\" id=\"MathJax-Span-3139\" style=\"font-family: MathJax_Main;\">2</span><span class=\"mi\" id=\"MathJax-Span-3140\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-3141\" style=\"font-family: MathJax_Main;\">)</span><span class=\"mo\" id=\"MathJax-Span-3142\" style=\"font-family: MathJax_Main;\">!</span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; clip: rect(3.141em, 1002.33em, 4.169em, -999.997em); top: -3.298em; left: 50%; margin-left: -1.134em;\"><span class=\"mrow\" id=\"MathJax-Span-3143\"><span class=\"mi\" id=\"MathJax-Span-3144\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-3145\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">⋅</span><span class=\"msubsup\" id=\"MathJax-Span-3146\" style=\"padding-left: 0.219em;\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-3147\" style=\"font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.49em;\"><span class=\"mi\" id=\"MathJax-Span-3148\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; clip: rect(0.869em, 1009.53em, 1.247em, -999.997em); top: -1.296em; left: 0em;\"><span style=\"display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 9.527em; height: 0px;\"></span><span style=\"display: inline-block; width: 0px; height: 1.085em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-3149\" style=\"font-family: MathJax_Main;\">.</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.996em; border-left: 0px solid; width: 0px; height: 3.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mfrac><mrow><mi>A</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo>,</mo><mi>k</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>⋅</mo><mo stretchy=\"false\">(</mo><mn>2</mn><mi>n</mi><mo stretchy=\"false\">)</mo><mo>!</mo></mrow><mrow><mi>n</mi><mo>⋅</mo><msup><mn>2</mn><mi>n</mi></msup></mrow></mfrac><mo>.</mo></math></span></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-263\"> \\frac{A(n - 1, k - 1) \\cdot (2n)!}{n \\cdot 2^n}. </script><p></p></div></div></div></div>"
}