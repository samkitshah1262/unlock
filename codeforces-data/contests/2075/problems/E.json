{
  "contestId": 2075,
  "index": "E",
  "title": "XOR Matrix",
  "timeLimit": "2 seconds",
  "memoryLimit": "512 megabytes",
  "rating": 2500,
  "tags": [
    "bitmasks",
    "combinatorics",
    "dp",
    "implementation",
    "math"
  ],
  "statementHtml": "<p>For two arrays <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-1-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1\" style=\"width: 10.663em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 8.065em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1007.96em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2\"><span class=\"mi\" id=\"MathJax-Span-3\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-4\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mo\" id=\"MathJax-Span-5\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-6\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mn\" id=\"MathJax-Span-8\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-9\" style=\"font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-10\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-11\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mn\" id=\"MathJax-Span-12\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-13\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mo\" id=\"MathJax-Span-14\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">…</span><span class=\"mo\" id=\"MathJax-Span-15\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-16\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 1.031em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-17\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-18\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-19\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-1\">a = [a_1, a_2, \\dots, a_n]</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-2-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-20\" style=\"width: 10.392em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.849em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1007.74em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-21\"><span class=\"mi\" id=\"MathJax-Span-22\" style=\"font-family: MathJax_Math-italic;\">b</span><span class=\"mo\" id=\"MathJax-Span-23\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mo\" id=\"MathJax-Span-24\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">[</span><span class=\"msubsup\" id=\"MathJax-Span-25\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-26\" style=\"font-family: MathJax_Math-italic;\">b</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mn\" id=\"MathJax-Span-27\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-28\" style=\"font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-29\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-30\" style=\"font-family: MathJax_Math-italic;\">b</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mn\" id=\"MathJax-Span-31\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-32\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mo\" id=\"MathJax-Span-33\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">…</span><span class=\"mo\" id=\"MathJax-Span-34\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-35\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 1.139em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-36\" style=\"font-family: MathJax_Math-italic;\">b</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mi\" id=\"MathJax-Span-37\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">m</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-38\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-2\">b = [b_1, b_2, \\dots, b_m]</script>, we define the XOR matrix <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-3-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-39\" style=\"width: 1.085em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.814em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.81em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-40\"><span class=\"mi\" id=\"MathJax-Span-41\" style=\"font-family: MathJax_Math-italic;\">X<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-3\">X</script> of size <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-4-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-42\" style=\"width: 3.574em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.708em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1002.71em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-43\"><span class=\"mi\" id=\"MathJax-Span-44\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-45\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">×</span><span class=\"mi\" id=\"MathJax-Span-46\" style=\"font-family: MathJax_Math-italic; padding-left: 0.219em;\">m</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.789em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-4\">n \\times m</script>, where for each pair <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-5-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-47\" style=\"width: 2.654em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.005em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1001.9em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-48\"><span class=\"mo\" id=\"MathJax-Span-49\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-50\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-51\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-52\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">j</span><span class=\"mo\" id=\"MathJax-Span-53\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-5\">(i,j)</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-6-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-54\" style=\"width: 5.468em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.115em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1004.12em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-55\"><span class=\"mn\" id=\"MathJax-Span-56\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-57\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-58\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">i</span><span class=\"mo\" id=\"MathJax-Span-59\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-60\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-6\">1 \\le i \\le n</script>; <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-7-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-61\" style=\"width: 5.901em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.44em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1004.44em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-62\"><span class=\"mn\" id=\"MathJax-Span-63\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-64\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-65\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">j</span><span class=\"mo\" id=\"MathJax-Span-66\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-67\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">m</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-7\">1 \\le j \\le m</script>) it holds that <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-8-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-68\" style=\"width: 7.741em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.847em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1005.85em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-69\"><span class=\"msubsup\" id=\"MathJax-Span-70\"><span style=\"display: inline-block; position: relative; width: 1.626em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.87em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-71\" style=\"font-family: MathJax_Math-italic;\">X<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.814em;\"><span class=\"texatom\" id=\"MathJax-Span-72\"><span class=\"mrow\" id=\"MathJax-Span-73\"><span class=\"mi\" id=\"MathJax-Span-74\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-75\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-76\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">j</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-77\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"msubsup\" id=\"MathJax-Span-78\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-79\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-80\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-81\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">⊕</span><span class=\"msubsup\" id=\"MathJax-Span-82\" style=\"padding-left: 0.219em;\"><span style=\"display: inline-block; position: relative; width: 0.814em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-83\" style=\"font-family: MathJax_Math-italic;\">b</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mi\" id=\"MathJax-Span-84\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">j</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-8\">X_{i,j} = a_i \\oplus b_j</script>. The symbol <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-85\" style=\"width: 1.031em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.41em, 1000.71em, 2.438em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-86\"><span class=\"mo\" id=\"MathJax-Span-87\" style=\"font-family: MathJax_Main;\">⊕</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-9\">\\oplus</script> denotes the bitwise XOR operation.</p>\n<p>You are given four integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-10-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-88\" style=\"width: 5.739em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.332em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1004.33em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-89\"><span class=\"mi\" id=\"MathJax-Span-90\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-91\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-92\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">m</span><span class=\"mo\" id=\"MathJax-Span-93\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-94\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">A</span><span class=\"mo\" id=\"MathJax-Span-95\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-96\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">B</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-10\">n, m, A, B</script>. Count the number of such pairs of arrays <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-11-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-97\" style=\"width: 2.871em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.167em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1002.06em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-98\"><span class=\"mo\" id=\"MathJax-Span-99\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-100\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-101\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-102\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">b</span><span class=\"mo\" id=\"MathJax-Span-103\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-11\">(a, b)</script> such that:</p>",
  "inputSpecHtml": "<p>The first line contains one integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-128\" style=\"width: 0.544em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.381em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.33em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-129\"><span class=\"mi\" id=\"MathJax-Span-130\" style=\"font-family: MathJax_Math-italic;\">t</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-20\">t</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-131\" style=\"width: 6.496em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.927em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1004.93em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-132\"><span class=\"mn\" id=\"MathJax-Span-133\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-134\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-135\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">t</span><span class=\"mo\" id=\"MathJax-Span-136\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-137\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-138\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"mn\" id=\"MathJax-Span-139\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">4</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-21\">1 \\le t \\le 10^4</script>) — the number of test cases.</p><p>Each test case consists of one line containing four integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-140\" style=\"width: 5.739em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.332em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1004.33em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-141\"><span class=\"mi\" id=\"MathJax-Span-142\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-143\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-144\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">m</span><span class=\"mo\" id=\"MathJax-Span-145\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-146\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">A</span><span class=\"mo\" id=\"MathJax-Span-147\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-148\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">B</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-22\">n, m, A, B</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-23-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-149\" style=\"width: 13.856em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 10.501em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1010.45em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-150\"><span class=\"mn\" id=\"MathJax-Span-151\" style=\"font-family: MathJax_Main;\">2</span><span class=\"mo\" id=\"MathJax-Span-152\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-153\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span><span class=\"mo\" id=\"MathJax-Span-154\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-155\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">m</span><span class=\"mo\" id=\"MathJax-Span-156\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-157\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">A</span><span class=\"mo\" id=\"MathJax-Span-158\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-159\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">B</span><span class=\"mo\" id=\"MathJax-Span-160\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-161\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 1.301em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-162\" style=\"font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.49em;\"><span class=\"texatom\" id=\"MathJax-Span-163\"><span class=\"mrow\" id=\"MathJax-Span-164\"><span class=\"mn\" id=\"MathJax-Span-165\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">29</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-166\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mn\" id=\"MathJax-Span-167\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.575em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-23\">2 \\le n, m, A, B \\le 2^{29} - 1</script>).</p>",
  "outputSpecHtml": "<p>For each test case, output one integer — the number of pairs of arrays <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-24-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-168\" style=\"width: 2.871em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.167em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1002.06em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-169\"><span class=\"mo\" id=\"MathJax-Span-170\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-171\" style=\"font-family: MathJax_Math-italic;\">a</span><span class=\"mo\" id=\"MathJax-Span-172\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-173\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">b</span><span class=\"mo\" id=\"MathJax-Span-174\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-24\">(a, b)</script> that satisfy all three conditions. Since this number can be very large, output it modulo <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-25-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-175\" style=\"width: 5.955em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.494em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1004.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-176\"><span class=\"mn\" id=\"MathJax-Span-177\" style=\"font-family: MathJax_Main;\">998244353</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-25\">998244353</script>.</p>",
  "noteHtml": "",
  "samples": [
    {
      "input": "62 2 2 22 3 4 55 7 4 31337 42 1337 424 2 13 37536870902 536370902 536390912 466128231",
      "output": "57\n864\n50360\n439988899\n112000\n732195491"
    }
  ],
  "images": [],
  "url": "https://codeforces.com/contest/2075/problem/E",
  "tutorialHtml": "<div><div class=\"ttypography\"><div class=\"problem-statement\"><div><p>If there are at least three pairwise distinct elements in one of the two arrays ($$$a$$$ and $$$b$$$), then there will also be at least three distinct elements in the matrix. Therefore, we can assume that the number of distinct elements in each of the arrays does not exceed $$$2$$$.</p><p>This allows us to construct the answer from the following parts:</p><ol> <li> the number of pairs of arrays where all elements in $$$a$$$ are the same and all elements in $$$b$$$ are the same; </li><li> the number of pairs of arrays where all elements in $$$a$$$ are the same, and the number of distinct elements in $$$b$$$ is $$$2$$$; </li><li> the number of pairs of arrays where the number of distinct elements in $$$a$$$ is $$$2$$$, and all elements in $$$b$$$ are the same; </li><li> the number of pairs of arrays where both $$$a$$$ and $$$b$$$ have two distinct elements each. </li></ol><p>The first part of the answer is simply $$$(A+1) \\cdot (B+1)$$$, as we can choose which number all elements in $$$A$$$ will equal, and which number all elements in $$$B$$$ will equal.</p><p>The second and third parts are very similar to each other. Therefore, we will explain how the second part is calculated, and the third can be computed similarly. We can choose which number will be in $$$a$$$, and the number of ways to do this is $$$(A+1)$$$. We can also choose which two numbers will be in $$$b$$$, which can be done in $$$\\frac{B(B+1)}{2}$$$ ways. Additionally, we need to choose the positions in $$$b$$$ where the first number will be; the number of ways to do this is $$$2^m - 2$$$ (not $$$2^m$$$, since we need to exclude the cases where the same number appears in all positions). Therefore, the second part of the answer is $$$(A+1) \\cdot \\frac{B(B+1)}{2} \\cdot (2^m-2)$$$.</p><p>The fourth part is the most complex. The main problem is that it is important which specific values we choose for the arrays $$$a$$$ and $$$b$$$. Let all elements of $$$a$$$ be either $$$a_1$$$ or $$$a_2$$$ ($$$a_1 &gt; a_2$$$), and all elements of $$$b$$$ be either $$$b_1$$$ or $$$b_2$$$ ($$$b_1 &gt; b_2$$$). Then for this quadruple $$$(a_1, a_2, b_1, b_2)$$$, there are $$$(2^n-2) \\cdot (2^m-2)$$$ ways to choose which positions in which arrays correspond to which numbers. This must be multiplied by the number of suitable quadruples, so let's learn how to count them.</p><p>We are interested in quadruples of numbers $$$(a_1, a_2, b_1, b_2)$$$ that satisfy the conditions:</p><ul> <li> $$$0 \\le a_2 &lt; a_1 \\le A$$$; </li><li> $$$0 \\le b_2 &lt; b_1 \\le B$$$; </li><li> $$$a_1 \\oplus b_2 = a_2 \\oplus b_1$$$ (otherwise, we will have more than two distinct values in the matrix, since $$$a_1 \\oplus b_1 \\ne a_1 \\oplus b_2$$$). This condition is also equivalent to $$$a_1 \\oplus b_1 = a_2 \\oplus b_2$$$, so if it holds, there are exactly two distinct values in the matrix. </li></ul><p>The third condition can be rewritten as $$$a_1 \\oplus a_2 = b_1 \\oplus b_2$$$. Let's then count not the quadruples $$$(a_1, a_2, b_1, b_2)$$$, but the triples $$$(a_1, b_1, x)$$$ such that $$$0 \\le a_1 \\oplus x &lt; a_1 \\le A$$$ and $$$0 \\le b_1 \\oplus x &lt; b_1 \\le B$$$.</p><p>This can be done using digit dynamic programming on the bits of these three numbers from the most significant to the least significant. Let $$$dp[i][f_a][f_b][f_x]$$$ be the number of ways to set the $$$i$$$ most significant bits in these three numbers such that:</p><ul> <li> $$$f_a = 0$$$, if the number $$$a_1$$$ is still equal to the upper limit $$$A$$$, or $$$f_a = 1$$$, if it is definitely less; </li><li> $$$f_b = 0$$$, if the number $$$b_1$$$ is still equal to the upper limit $$$B$$$, or $$$f_b = 1$$$, if it is definitely less; </li><li> $$$f_x = 0$$$, if the number $$$x$$$ is still equal to $$$0$$$, or $$$f_x = 1$$$, if it is definitely not $$$0$$$. </li></ul><p>Transitions in this dynamic programming are done as follows: we iterate over which values will be in the next bit of these three numbers, check that this does not violate any conditions, and observe how the values of $$$f_a, f_b, f_x$$$ change.</p><p>What conditions do we need to check?</p><ul> <li> We need to ensure that $$$a_1 \\le A$$$, so if $$$f_a$$$ is $$$0$$$ and the next bit in $$$A$$$ is $$$0$$$, we cannot set $$$1$$$ in the next bit of $$$a_1$$$; </li><li> We need to ensure that $$$b_1 \\le B$$$ (similarly); </li><li> We need to ensure that $$$a_1 \\oplus x &lt; a_1$$$, so if $$$f_x$$$ is $$$0$$$ and we set the next bit in $$$a_1$$$ to $$$0$$$, this bit must also be $$$0$$$ in the number $$$x$$$; </li><li> We need to ensure that $$$b_1 \\oplus x &lt; b_1$$$ (similarly). </li></ul><p>The flags $$$f_a, f_b, f_x$$$ are recalculated quite trivially, and we will not discuss this in detail in the explanation.</p><p>The answer should be collected from all states of the form $$$dp[K][f_a][f_b][1]$$$, where $$$K$$$ is the number of bits in the numbers. This way, we will obtain the number of pairs $$$(a_1, a_2, b_1, b_2)$$$ that can be used.</p><p>This dynamic programming is the most computationally intensive part of the solution, so the entire solution works in $$$O(\\log \\max(A,B))$$$, but with a very large constant in the asymptotic notation.</p></div></div></div></div>"
}