<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tutorial</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
      color: #333;
      background: #fafafa;
    }
    .ttypography {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    h3 {
      color: #1a1a1a;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }
    h3 a {
      color: #0066cc;
      text-decoration: none;
    }
    h3 a:hover {
      text-decoration: underline;
    }
    .spoiler {
      margin: 15px 0;
      border: 1px solid #ddd;
      border-radius: 6px;
      overflow: hidden;
    }
    .spoiler-title {
      display: block;
      padding: 12px 15px;
      background: #f0f0f0;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
      border-bottom: 1px solid #ddd;
    }
    .spoiler-title:hover {
      background: #e8e8e8;
    }
    .spoiler-title::before {
      content: '▶ ';
      font-size: 0.8em;
      transition: transform 0.2s;
      display: inline-block;
    }
    .spoiler.open .spoiler-title::before {
      content: '▼ ';
    }
    .spoiler-content {
      padding: 15px;
      background: #fff;
      display: none;
    }
    .spoiler.open .spoiler-content {
      display: block;
    }
    pre, code {
      background: #f5f5f5;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 0.85em;
    }
    pre {
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
    code {
      padding: 2px 5px;
      border-radius: 3px;
    }
    p {
      margin: 10px 0;
    }
    .MathJax {
      font-size: 1.1em;
    }
  </style>
</head>
<body>
  <h1>Editorial</h1>
  <p><a href="https://codeforces.com/blog/entry/141053" target="_blank">View on Codeforces →</a></p>
  
  <div class="ttypography"><p>We apologize for the late editorial. </p><p><a href="https://codeforces.com/contest/2090/problem/A" title="Codeforces Round 1012 (Div. 2)">2090A - Treasure Hunt</a> <br> Idea: <a class="rated-user user-orange" href="https://codeforces.com/profile/_Lucien" title="Master _Lucien">_Lucien</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Let's calculate how many operations we need. The number of pairs of operations is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mrow" id="MJXp-Span-2"><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌊</span></span><span class="MJXp-mfrac" id="MJXp-Span-4" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5">a</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">x</span><span class="MJXp-mo" id="MJXp-Span-7">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌋</span></span></span></span></span><script type="math/tex" id="MathJax-Element-1">\left\lfloor\frac{a}{x + y}\right\rfloor</script>. Additionally, we add <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-10"><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0em; margin-right: 0.111em;">+</span><span class="MJXp-mn" id="MJXp-Span-12">1</span></span></span><script type="math/tex" id="MathJax-Element-2">+1</script> if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-13"><span class="MJXp-mo" id="MJXp-Span-14" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15">a</span><span class="MJXp-mo" id="MJXp-Span-16" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">x</span><span class="MJXp-mo" id="MJXp-Span-19" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">y</span><span class="MJXp-mo" id="MJXp-Span-21" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-22" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-23" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">x</span></span></span><script type="math/tex" id="MathJax-Element-3">(a \bmod (x + y)) \ge x</script>, because in this case, the first player will be able to make one more move. Note that the first part is always even, which means the answer depends only on whether <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-25"><span class="MJXp-mo" id="MJXp-Span-26" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27">a</span><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mo" id="MJXp-Span-29" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30">x</span><span class="MJXp-mo" id="MJXp-Span-31" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32">y</span><span class="MJXp-mo" id="MJXp-Span-33" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-34" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-35" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">x</span></span></span><script type="math/tex" id="MathJax-Element-4">(a \bmod (x + y)) \ge x</script>, and in this case, the answer is YES.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">

</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> x </span><span class="pun">&gt;&gt;</span><span class="pln"> y </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"NO\n"</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"YES\n"</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">

    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln">
        solve</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2090/problem/B" title="Codeforces Round 1012 (Div. 2)">2090B - Pushing Balls</a> <br> Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/Ecrade_" title="Grandmaster Ecrade_">Ecrade_</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>We can transform the problem into: select a row / column and replace the leftmost / topmost <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-37"><span class="MJXp-mn" id="MJXp-Span-38">0</span></span></span><script type="math/tex" id="MathJax-Element-5">0</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-39"><span class="MJXp-mn" id="MJXp-Span-40">1</span></span></span><script type="math/tex" id="MathJax-Element-6">1</script>. Then the solution is clear: if, for each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-41"><span class="MJXp-mn" id="MJXp-Span-42">1</span></span></span><script type="math/tex" id="MathJax-Element-7">1</script> in the grid, there does not exist any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-43"><span class="MJXp-mn" id="MJXp-Span-44">0</span></span></span><script type="math/tex" id="MathJax-Element-8">0</script> on its top, or does not exist any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-45"><span class="MJXp-mn" id="MJXp-Span-46">0</span></span></span><script type="math/tex" id="MathJax-Element-9">0</script> on its left, then the answer is YES; otherwise NO.</p><p>But how to prove that if the condition is satisfied, we can always construct a valid series of ball-pushing operations? We can consider the problem in reverse order: given the final state, if, for an <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-47"><span class="MJXp-mn" id="MJXp-Span-48">1</span></span></span><script type="math/tex" id="MathJax-Element-10">1</script> in the grid, there does not exist any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-49"><span class="MJXp-mn" id="MJXp-Span-50">0</span></span></span><script type="math/tex" id="MathJax-Element-11">0</script> on its top, or does not exist any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-51"><span class="MJXp-mn" id="MJXp-Span-52">0</span></span></span><script type="math/tex" id="MathJax-Element-12">0</script> on its left, then we can turn it into <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-53"><span class="MJXp-mn" id="MJXp-Span-54">0</span></span></span><script type="math/tex" id="MathJax-Element-13">0</script>, and our goal is to turn all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-55"><span class="MJXp-mn" id="MJXp-Span-56">1</span></span></span><script type="math/tex" id="MathJax-Element-14">1</script> s into <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-57"><span class="MJXp-mn" id="MJXp-Span-58">0</span></span></span><script type="math/tex" id="MathJax-Element-15">0</script> s. We can always reach the goal if we choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-59"><span class="MJXp-mn" id="MJXp-Span-60">1</span></span></span><script type="math/tex" id="MathJax-Element-16">1</script> s in descending order of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-61"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">i</span><span class="MJXp-mo" id="MJXp-Span-63" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">j</span></span></span><script type="math/tex" id="MathJax-Element-17">i+j</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-65"><span class="MJXp-mo" id="MJXp-Span-66" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67">i</span><span class="MJXp-mo" id="MJXp-Span-68" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69">j</span><span class="MJXp-mo" id="MJXp-Span-70" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-18">(i,j)</script> is their coordinates in the grid.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
ll t</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="pln">m</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="lit">59</span><span class="pun">][</span><span class="lit">59</span><span class="pun">],</span><span class="pln">vis</span><span class="pun">[</span><span class="lit">59</span><span class="pun">][</span><span class="lit">59</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">char</span><span class="pln"> s</span><span class="pun">[</span><span class="lit">59</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> ll read</span><span class="pun">(){</span><span class="pln">
	ll s </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">w </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">char</span><span class="pln"> ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">&gt;</span><span class="pln"> </span><span class="str">'9'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> ch </span><span class="pun">&lt;</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">){</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">==</span><span class="pln"> </span><span class="str">'-'</span><span class="pun">)</span><span class="pln"> w </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();}</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="str">'9'</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> ch </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">)</span><span class="pln"> s </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">3</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">^</span><span class="pln"> </span><span class="lit">48</span><span class="pun">),</span><span class="pln">ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> s </span><span class="pun">*</span><span class="pln"> w</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
	t </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t </span><span class="pun">--){</span><span class="pln">
		n </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">(),</span><span class="pln">m </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
			scanf</span><span class="pun">(</span><span class="str">"%s"</span><span class="pun">,</span><span class="pln">s </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">j </span><span class="pun">&lt;=</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">j </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
				a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">;</span><span class="pln">
				vis</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">j </span><span class="pun">&lt;=</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">j </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">])</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
				vis</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">j </span><span class="pun">&lt;=</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">j </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">])</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
				vis</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">bool</span><span class="pln"> fl </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n </span><span class="pun">&amp;&amp;</span><span class="pln"> fl</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">j </span><span class="pun">&lt;=</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">j </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> </span><span class="pun">!</span><span class="pln">vis</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]){</span><span class="pln">
					fl </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
					</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		puts</span><span class="pun">(</span><span class="pln">fl </span><span class="pun">?</span><span class="pln"> </span><span class="str">"YES"</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">"NO"</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2090/problem/C" title="Codeforces Round 1012 (Div. 2)">2090C - Dining Hall</a> <br> Idea: <a class="rated-user user-orange" href="https://codeforces.com/profile/myee" title="International Master myee">myee</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><blockquote><p>Original idea from <a class="rated-user user-orange" href="https://codeforces.com/profile/myee" title="International Master myee">myee</a> has <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-71"><span class="MJXp-mn" id="MJXp-Span-72">4</span></span></span><script type="math/tex" id="MathJax-Element-19">4</script> cases, which is a medium difficulty problem using deletable heap. You may find the original statement in zh-cn on GitHub later.</p><p>The Codeforces version by <a class="rated-user user-red" href="https://codeforces.com/profile/FairyWinx" title="Grandmaster FairyWinx">FairyWinx</a> has only <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-73"><span class="MJXp-mn" id="MJXp-Span-74">2</span></span></span><script type="math/tex" id="MathJax-Element-20">2</script> cases, in order to meet the difficulty as Div2C.</p><p>The En/Ru statement changes for times after checking. Sorry for the inconvenience.</p> </blockquote><p>Firstly we can get the distance of each cell by BFS or Math Way: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-75"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76">d</span><span class="MJXp-mo" id="MJXp-Span-77" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78">x</span><span class="MJXp-mo" id="MJXp-Span-79" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80">y</span><span class="MJXp-mo" id="MJXp-Span-81" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-82" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">x</span><span class="MJXp-mo" id="MJXp-Span-84" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">y</span><span class="MJXp-mo" id="MJXp-Span-86" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-87">2</span><span class="MJXp-mo" id="MJXp-Span-88" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89">x</span><span class="MJXp-mo" id="MJXp-Span-90" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mn" id="MJXp-Span-91">3</span><span class="MJXp-mo" id="MJXp-Span-92" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">y</span><span class="MJXp-mo" id="MJXp-Span-94" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mn" id="MJXp-Span-95">3</span><span class="MJXp-mo" id="MJXp-Span-96" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-97">2</span><span class="MJXp-mo" id="MJXp-Span-98" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-21">d(x,y)=x+y+2[x\bmod3=y\bmod3=2]</script>.</p><p><img alt=" " src="https://espresso.codeforces.com/db9590b32cd739d8aff4b52b22fba9065f198177.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p>The proof is trivial.</p><p>Then we can sort out the first <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-99"><span class="MJXp-mn" id="MJXp-Span-100">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101">n</span></span></span><script type="math/tex" id="MathJax-Element-22">4n</script> table cell with the lowest distance in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-102"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103">O</span><span class="MJXp-mo" id="MJXp-Span-104" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105">n</span><span class="MJXp-mo" id="MJXp-Span-106" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-23">O(n)</script> time: by BFS or enumerating possible <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">d</span><span class="MJXp-mo" id="MJXp-Span-109" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">x</span><span class="MJXp-mo" id="MJXp-Span-111" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">y</span><span class="MJXp-mo" id="MJXp-Span-113" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-114" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115">k</span></span></span><script type="math/tex" id="MathJax-Element-24">d(x,y)=k</script>.</p><p>Suppose we record whether a table cell is occupied or not by a bool array. Then we can check whether a cell can be allowed to go by someone <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-116"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">o</span><span class="MJXp-mo" id="MJXp-Span-118" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-119">0</span><span class="MJXp-mrow" id="MJXp-Span-120"><span class="MJXp-mo" id="MJXp-Span-121" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-122">1</span></span></span><script type="math/tex" id="MathJax-Element-25">o=0/1</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">O</span><span class="MJXp-mo" id="MJXp-Span-125" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-126">1</span><span class="MJXp-mo" id="MJXp-Span-127" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-26">O(1)</script> time.</p><p>Suppose the shortest table cell we can choose is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-128"><span class="MJXp-msubsup" id="MJXp-Span-129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-131" style="vertical-align: -0.4em;">0</span></span></span></span><script type="math/tex" id="MathJax-Element-27">x_0</script> -th and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-132"><span class="MJXp-msubsup" id="MJXp-Span-133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-135" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-28">x_1</script> -th ones, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-136"><span class="MJXp-msubsup" id="MJXp-Span-137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-139" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-140" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-141"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-143" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-144" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-145">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">n</span></span></span><script type="math/tex" id="MathJax-Element-29">x_1\le x_0\le4n</script>. We can keep trying the smallest <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-147"><span class="MJXp-msubsup" id="MJXp-Span-148"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-150" style="vertical-align: -0.4em;">o</span></span></span></span><script type="math/tex" id="MathJax-Element-30">x_o</script> until it's okay.</p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-151"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">O</span><span class="MJXp-mo" id="MJXp-Span-153" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">n</span><span class="MJXp-mo" id="MJXp-Span-155" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-31">O(n)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">

</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">uint</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> bol </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">bool</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pln"> T</span><span class="pun">=</span><span class="lit">2000</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">uint</span><span class="pln"> R</span><span class="pun">=</span><span class="lit">200000</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">uint</span><span class="pln"> </span><span class="typ">Ord</span><span class="pun">[</span><span class="pln">R</span><span class="pun">+</span><span class="lit">5</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">uint</span><span class="pln"> </span><span class="typ">Nxt</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> p</span><span class="pun">,</span><span class="kwd">uint</span><span class="pln"> o</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">uint</span><span class="pln"> x</span><span class="pun">=</span><span class="pln">p</span><span class="pun">/</span><span class="pln">T</span><span class="pun">,</span><span class="pln">y</span><span class="pun">=</span><span class="pln">p</span><span class="pun">%</span><span class="pln">T</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">o</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln">y</span><span class="pun">=</span><span class="pln">y</span><span class="pun">/</span><span class="lit">3</span><span class="pun">*</span><span class="lit">3</span><span class="pun">+</span><span class="lit">3</span><span class="pun">-</span><span class="pln">y</span><span class="pun">%</span><span class="lit">3</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">o</span><span class="pun">&amp;</span><span class="lit">2</span><span class="pun">)</span><span class="pln">x</span><span class="pun">=</span><span class="pln">x</span><span class="pun">/</span><span class="lit">3</span><span class="pun">*</span><span class="lit">3</span><span class="pun">+</span><span class="lit">3</span><span class="pun">-</span><span class="pln">x</span><span class="pun">%</span><span class="lit">3</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> x</span><span class="pun">*</span><span class="pln">T</span><span class="pun">+</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

bol G</span><span class="pun">[</span><span class="lit">2</span><span class="pun">][</span><span class="pln">T</span><span class="pun">*</span><span class="pln">T</span><span class="pun">];</span><span class="kwd">uint</span><span class="pln"> </span><span class="typ">Ans</span><span class="pun">[</span><span class="lit">2</span><span class="pun">];</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
</span><span class="com">#ifdef</span><span class="pln"> MYEE
    freopen</span><span class="pun">(</span><span class="str">"QAQ.in"</span><span class="pun">,</span><span class="str">"r"</span><span class="pun">,</span><span class="pln">stdin</span><span class="pun">);</span><span class="pln">
    freopen</span><span class="pun">(</span><span class="str">"QAQ.out"</span><span class="pun">,</span><span class="str">"w"</span><span class="pun">,</span><span class="pln">stdout</span><span class="pun">);</span><span class="pln">
</span><span class="com">#endif</span><span class="pln">
    </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">2</span><span class="pun">,</span><span class="pln">tp</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&amp;&amp;</span><span class="pln">tp</span><span class="pun">&lt;</span><span class="pln">R</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">i</span><span class="pun">%</span><span class="lit">3</span><span class="pun">==</span><span class="lit">2</span><span class="pun">)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> x</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">x</span><span class="pun">&lt;</span><span class="pln">i</span><span class="pun">&amp;&amp;</span><span class="pln">tp</span><span class="pun">&lt;</span><span class="pln">R</span><span class="pun">;</span><span class="pln">x</span><span class="pun">+=</span><span class="lit">3</span><span class="pun">)</span><span class="typ">Ord</span><span class="pun">[</span><span class="pln">tp</span><span class="pun">++]=</span><span class="pln">x</span><span class="pun">*</span><span class="pln">T</span><span class="pun">+</span><span class="pln">i</span><span class="pun">-</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(!(</span><span class="pln">i</span><span class="pun">%</span><span class="lit">3</span><span class="pun">))</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> x</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">x</span><span class="pun">&lt;=</span><span class="pln">i</span><span class="pun">-</span><span class="lit">2</span><span class="pun">&amp;&amp;</span><span class="pln">tp</span><span class="pun">&lt;</span><span class="pln">R</span><span class="pun">;</span><span class="pln">x</span><span class="pun">++)</span><span class="pln">
            </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">x</span><span class="pun">%</span><span class="lit">3</span><span class="pun">==</span><span class="lit">1</span><span class="pun">)</span><span class="typ">Ord</span><span class="pun">[</span><span class="pln">tp</span><span class="pun">++]=</span><span class="pln">x</span><span class="pun">*</span><span class="pln">T</span><span class="pun">+</span><span class="pln">i</span><span class="pun">-</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">x</span><span class="pun">%</span><span class="lit">3</span><span class="pun">==</span><span class="lit">2</span><span class="pun">)</span><span class="typ">Ord</span><span class="pun">[</span><span class="pln">tp</span><span class="pun">++]=</span><span class="pln">x</span><span class="pun">*</span><span class="pln">T</span><span class="pun">+</span><span class="pln">i</span><span class="pun">-</span><span class="pln">x</span><span class="pun">-</span><span class="lit">2</span><span class="pun">,</span><span class="typ">Ord</span><span class="pun">[</span><span class="pln">tp</span><span class="pun">++]=</span><span class="pln">x</span><span class="pun">*</span><span class="pln">T</span><span class="pun">+</span><span class="pln">i</span><span class="pun">-</span><span class="pln">x</span><span class="pun">;</span><span class="pln">
        </span><span class="typ">Ord</span><span class="pun">[</span><span class="pln">tp</span><span class="pun">++]=(</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">)*</span><span class="pln">T</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">uint</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">scanf</span><span class="pun">(</span><span class="str">"%u"</span><span class="pun">,&amp;</span><span class="pln">t</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln">
    </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">uint</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">scanf</span><span class="pun">(</span><span class="str">"%u"</span><span class="pun">,&amp;</span><span class="pln">q</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">q</span><span class="pun">*</span><span class="lit">4</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">G</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="typ">Ord</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]=</span><span class="pln">G</span><span class="pun">[</span><span class="lit">1</span><span class="pun">][</span><span class="typ">Ord</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="typ">Ans</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]=</span><span class="typ">Ans</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">q</span><span class="pun">--)</span><span class="pln">
        </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">uint</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">scanf</span><span class="pun">(</span><span class="str">"%u"</span><span class="pun">,&amp;</span><span class="pln">t</span><span class="pun">);</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">G</span><span class="pun">[</span><span class="pln">t</span><span class="pun">][</span><span class="typ">Ord</span><span class="pun">[</span><span class="typ">Ans</span><span class="pun">[</span><span class="pln">t</span><span class="pun">]]])</span><span class="typ">Ans</span><span class="pun">[</span><span class="pln">t</span><span class="pun">]++;</span><span class="pln">
            t</span><span class="pun">=</span><span class="typ">Ord</span><span class="pun">[</span><span class="typ">Ans</span><span class="pun">[</span><span class="pln">t</span><span class="pun">]];</span><span class="pln">printf</span><span class="pun">(</span><span class="str">"%u %u\n"</span><span class="pun">,</span><span class="pln">t</span><span class="pun">/</span><span class="pln">T</span><span class="pun">,</span><span class="pln">t</span><span class="pun">%</span><span class="pln">T</span><span class="pun">);</span><span class="pln">
            G</span><span class="pun">[</span><span class="lit">1</span><span class="pun">][</span><span class="pln">t</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> o</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">o</span><span class="pun">&lt;</span><span class="lit">4</span><span class="pun">;</span><span class="pln">o</span><span class="pun">++)</span><span class="pln">G</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="typ">Nxt</span><span class="pun">(</span><span class="pln">t</span><span class="pun">,</span><span class="pln">o</span><span class="pun">)]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2089/problem/A" title="Codeforces Round 1012 (Div. 1)">2089A - Simple Permutation</a> <br> Idea: <a class="rated-user user-legendary" href="https://codeforces.com/profile/QuietBeautifulThoughts" title="Legendary Grandmaster QuietBeautifulThoughts"><span class="legendary-user-first-letter">Q</span>uietBeautifulThoughts</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p><strong>Lemma (Bertrand's postulate):</strong> For each positive integer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-156"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">x</span></span></span><script type="math/tex" id="MathJax-Element-32">x</script>, there is a prime <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-158"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">p</span></span></span><script type="math/tex" id="MathJax-Element-33">p</script> inside the interval <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-160"><span class="MJXp-mo" id="MJXp-Span-161" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">x</span><span class="MJXp-mo" id="MJXp-Span-163" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-164">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">x</span><span class="MJXp-mo" id="MJXp-Span-166" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-34">[x,2x]</script>. </p><p>Find a prime number <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-167"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">p</span></span></span><script type="math/tex" id="MathJax-Element-35">p</script> between <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-169"><span class="MJXp-mo" id="MJXp-Span-170" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-171" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-173">3</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-174" style="margin-left: 0em; margin-right: 0em;">⌋</span></span></span><script type="math/tex" id="MathJax-Element-36">\lfloor \frac{n}{3} \rfloor</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-175"><span class="MJXp-mo" id="MJXp-Span-176" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mfrac" id="MJXp-Span-177" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-178">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-180">3</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-181" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span><script type="math/tex" id="MathJax-Element-37">\lceil \frac{2n}{3} \rceil</script>, and construct the permutation in an alternating way: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-182"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">p</span><span class="MJXp-mo" id="MJXp-Span-184" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">p</span><span class="MJXp-mo" id="MJXp-Span-186" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-187">1</span><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189">p</span><span class="MJXp-mo" id="MJXp-Span-190" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-191">1</span><span class="MJXp-mo" id="MJXp-Span-192" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">p</span><span class="MJXp-mo" id="MJXp-Span-194" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-195">2</span><span class="MJXp-mo" id="MJXp-Span-196" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">p</span><span class="MJXp-mo" id="MJXp-Span-198" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-199">2</span><span class="MJXp-mo" id="MJXp-Span-200" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-201" style="margin-left: 0em; margin-right: 0em;">…</span></span></span><script type="math/tex" id="MathJax-Element-38">p, p-1, p+1, p-2, p+2, \dots</script>. Place the remaining numbers arbitrarily.</p><p>In this construction, we have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-202"><span class="MJXp-msubsup" id="MJXp-Span-203"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-205" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-206" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-209" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-210" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-211"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212" style="margin-right: 0.05em;">c</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-213" style="vertical-align: -0.4em;">5</span></span><span class="MJXp-mo" id="MJXp-Span-214" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-215" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-216" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-217"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218" style="margin-right: 0.05em;">c</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-219" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-220">2</span><span class="MJXp-mo" id="MJXp-Span-221">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-222" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-224">3</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-225">⌋</span><span class="MJXp-mo" id="MJXp-Span-226">−</span><span class="MJXp-mn" id="MJXp-Span-227">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-228" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">p</span></span></span><script type="math/tex" id="MathJax-Element-39">c_1 = c_3 = c_5 = \dots = c_{2 \lfloor \frac{n}{3} \rfloor - 1} = p</script>, which meets the requirement with at least <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-230"><span class="MJXp-mo" id="MJXp-Span-231" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-232" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-234">3</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-235" style="margin-left: 0em; margin-right: 0em;">⌋</span></span></span><script type="math/tex" id="MathJax-Element-40">\lfloor \frac{n}{3} \rfloor</script> numbers being prime.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">bool</span><span class="pln"> isPrime</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">x </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> i </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> x </span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">x </span><span class="pun">%</span><span class="pln"> i </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
			</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

vector</span><span class="str">&lt;int&gt;</span><span class="pln"> generateSol</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">){</span><span class="pln">
	vector</span><span class="str">&lt;int&gt;</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
	ans</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">p</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n </span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">p </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
			ans</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">p </span><span class="pun">-</span><span class="pln"> i</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">p </span><span class="pun">+</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">)</span><span class="pln">
			ans</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">p </span><span class="pun">+</span><span class="pln"> i</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> t </span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
		cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
		vector </span><span class="pun">&lt;</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">x</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">isPrime</span><span class="pun">(</span><span class="pln">n </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> x</span><span class="pun">)){</span><span class="pln">
				ans </span><span class="pun">=</span><span class="pln"> generateSol</span><span class="pun">(</span><span class="pln">n </span><span class="pun">,</span><span class="pln"> n </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> x</span><span class="pun">);</span><span class="pln">
				</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">isPrime</span><span class="pun">(</span><span class="pln">n </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> x</span><span class="pun">)){</span><span class="pln">
				ans </span><span class="pun">=</span><span class="pln"> generateSol</span><span class="pun">(</span><span class="pln">n </span><span class="pun">,</span><span class="pln"> n </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> x</span><span class="pun">);</span><span class="pln">
				</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n </span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
			cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">" \n"</span><span class="pun">[</span><span class="pln">i </span><span class="pun">==</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2089/problem/B1" title="Codeforces Round 1012 (Div. 1)">2089B1 - Canteen (Easy Version)</a> <br> Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/Ecrade_" title="Grandmaster Ecrade_">Ecrade_</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>For each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-236"><span class="MJXp-msubsup" id="MJXp-Span-237"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-239" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-41"> a_i </script>, calculate the minimum number of cyclic right shifts required to reduce it to zero, denoted as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-240"><span class="MJXp-msubsup" id="MJXp-Span-241"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-243" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-42"> d_i </script>. The answer is the maximum <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-244"><span class="MJXp-msubsup" id="MJXp-Span-245"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-247" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-43"> d_i </script> across all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-248"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">i</span></span></span><script type="math/tex" id="MathJax-Element-44"> i </script>. </p><p>For cyclic problems, we can consider breaking the cycle into a chain (i.e., let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-250"><span class="MJXp-msubsup" id="MJXp-Span-251"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-253" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254">i</span><span class="MJXp-mo" id="MJXp-Span-255">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-257" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-258"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-260" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-45"> a_{i+n} = a_i </script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-261"><span class="MJXp-msubsup" id="MJXp-Span-262"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-264" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">i</span><span class="MJXp-mo" id="MJXp-Span-266">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-268" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-271" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-46"> b_{i+n} = b_i </script>). </p><p>Consider constructing a parenthesis sequence <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">s</span></span></span><script type="math/tex" id="MathJax-Element-47"> s </script> by concatenating <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-274"><span class="MJXp-msubsup" id="MJXp-Span-275"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-277" style="vertical-align: -0.4em;">0</span></span></span></span><script type="math/tex" id="MathJax-Element-48"> a_0 </script> left parentheses, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-278"><span class="MJXp-msubsup" id="MJXp-Span-279"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-281" style="vertical-align: -0.4em;">0</span></span></span></span><script type="math/tex" id="MathJax-Element-49"> b_0 </script> right parentheses, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-282"><span class="MJXp-msubsup" id="MJXp-Span-283"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-285" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-50"> a_1 </script> left parentheses, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-286"><span class="MJXp-msubsup" id="MJXp-Span-287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-289" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-51"> b_1 </script> right parentheses, ... ,<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-290"><span class="MJXp-msubsup" id="MJXp-Span-291"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-293" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-294">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">n</span><span class="MJXp-mo" id="MJXp-Span-296">−</span><span class="MJXp-mn" id="MJXp-Span-297">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-52"> a_{2n-1} </script> left parentheses and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-298"><span class="MJXp-msubsup" id="MJXp-Span-299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-301" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-302">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">n</span><span class="MJXp-mo" id="MJXp-Span-304">−</span><span class="MJXp-mn" id="MJXp-Span-305">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-53"> b_{2n-1} </script> right parentheses. The operation in the original problem corresponds to the process of matching parentheses in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">s</span></span></span><script type="math/tex" id="MathJax-Element-54"> s </script>:</p> <ul>   <li>"Set the smaller of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-308"><span class="MJXp-mo" id="MJXp-Span-309" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-310"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-312" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-313" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-314"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-316" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-317" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-55">(a_i, b_i)</script> to zero and the larger to their difference" <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-318"><span class="MJXp-mo" id="MJXp-Span-319" style="margin-left: 0.333em; margin-right: 0.333em;">⇒</span></span></span><script type="math/tex" id="MathJax-Element-56">\Rightarrow</script> "Match the parentheses corresponding to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-320"><span class="MJXp-mo" id="MJXp-Span-321" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-324" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-325" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-326"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-328" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-329" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-57">(a_i, b_i)</script>".</li>   <li>"Cyclically right-shift <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-330"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">a</span></span></span><script type="math/tex" id="MathJax-Element-58"> a </script>" <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-332"><span class="MJXp-mo" id="MJXp-Span-333" style="margin-left: 0.333em; margin-right: 0.333em;">⇒</span></span></span><script type="math/tex" id="MathJax-Element-59">\Rightarrow</script> "Unmatched left parentheses continue to find matching right parentheses".</li> </ul><p>The first time <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-334"><span class="MJXp-msubsup" id="MJXp-Span-335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-337" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-60"> a_i </script> is reduced to zero depends on which <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-338"><span class="MJXp-msubsup" id="MJXp-Span-339"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-341" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-61"> b_j </script> ’s right parenthesis matches the leftmost parenthesis corresponding to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-342"><span class="MJXp-msubsup" id="MJXp-Span-343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-345" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-62"> a_i </script>. </p><p>We can use prefix sums to find matchings of the parenthesis: Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-346"><span class="MJXp-msubsup" id="MJXp-Span-347"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-349" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-350" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-351"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357" style="margin-right: 0px; margin-left: 0px;">i</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-352" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-353" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354">j</span><span class="MJXp-mo" id="MJXp-Span-355">=</span><span class="MJXp-mn" id="MJXp-Span-356">0</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-358" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-359"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-361" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-362" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-363"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-365" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-366" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-63"> c_i = \sum\limits_{j=0}^i (a_j - b_j) </script>. Define <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-367"><span class="MJXp-msubsup" id="MJXp-Span-368"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-370" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-64"> p_i </script> as the smallest index satisfying <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-371"><span class="MJXp-msubsup" id="MJXp-Span-372"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-374" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-375" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">i</span></span></span><script type="math/tex" id="MathJax-Element-65"> p_i > i </script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-377"><span class="MJXp-msubsup" id="MJXp-Span-378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379" style="margin-right: 0.05em;">c</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-380" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-381"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-383" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-384" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-385"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-387" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-66"> c_{p_i} \leq c_i </script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-388"><span class="MJXp-msubsup" id="MJXp-Span-389"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-391" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-392" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-393"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-395" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-396" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">i</span></span></span><script type="math/tex" id="MathJax-Element-67"> d_i = p_i - i </script>. We can compute all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-398"><span class="MJXp-msubsup" id="MJXp-Span-399"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-401" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-68"> p_i </script> with a monotonic stack.</p><p>It should be pointed out that matching parentheses is just an intuitive way of understanding the solution. You can, of course, also draw the above conclusion by direct observation.</p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-402"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403">O</span><span class="MJXp-mo" id="MJXp-Span-404" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-405" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">n</span><span class="MJXp-mo" id="MJXp-Span-407" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-69"> O(\sum n) </script>. </p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
ll t</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="pln">k</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="lit">400009</span><span class="pun">],</span><span class="pln">stk</span><span class="pun">[</span><span class="lit">400009</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> ll read</span><span class="pun">(){</span><span class="pln">
	ll s </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">w </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">char</span><span class="pln"> ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">&gt;</span><span class="pln"> </span><span class="str">'9'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> ch </span><span class="pun">&lt;</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">){</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">==</span><span class="pln"> </span><span class="str">'-'</span><span class="pun">)</span><span class="pln"> w </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();}</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="str">'9'</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> ch </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">)</span><span class="pln"> s </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">3</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">^</span><span class="pln"> </span><span class="lit">48</span><span class="pun">),</span><span class="pln">ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> s </span><span class="pun">*</span><span class="pln"> w</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
	t </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t </span><span class="pun">--){</span><span class="pln">
		n </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">(),</span><span class="pln">k </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">
		ll tp </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tp </span><span class="pun">&amp;&amp;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">stk</span><span class="pun">[</span><span class="pln">tp</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> tp </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">,</span><span class="pln">stk</span><span class="pun">[</span><span class="pln">tp</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> i</span><span class="pun">);</span><span class="pln">
			stk</span><span class="pun">[++</span><span class="pln"> tp</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"%lld\n"</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2089/problem/B2" title="Codeforces Round 1012 (Div. 1)">2089B2 - Canteen (Hard Version)</a> <br> Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/Ecrade_" title="Grandmaster Ecrade_">Ecrade_</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>We can use binary search on the answer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">x</span></span></span><script type="math/tex" id="MathJax-Element-70"> x </script>, and calculate the minimum number of changes needed to make <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-410"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411">a</span></span></span><script type="math/tex" id="MathJax-Element-71">a</script> zero within <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-412"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413">x</span></span></span><script type="math/tex" id="MathJax-Element-72"> x </script> rounds.</p><p>However, direct computation on the cyclic chain of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-414"><span class="MJXp-mn" id="MJXp-Span-415">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416">n</span></span></span><script type="math/tex" id="MathJax-Element-73"> 2n </script> elements is troublesome (due to overlapping contributions). Instead, we can cyclically shift <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-417"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">a</span></span></span><script type="math/tex" id="MathJax-Element-74"> a </script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-419"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420">b</span></span></span><script type="math/tex" id="MathJax-Element-75"> b </script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-421"><span class="MJXp-msubsup" id="MJXp-Span-422"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423" style="margin-right: 0.05em;">c</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-424" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">n</span><span class="MJXp-mo" id="MJXp-Span-426">−</span><span class="MJXp-mn" id="MJXp-Span-427">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-428" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-429"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-435" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436">n</span><span class="MJXp-mo" id="MJXp-Span-437">−</span><span class="MJXp-mn" id="MJXp-Span-438">1</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-430" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-431" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432">i</span><span class="MJXp-mo" id="MJXp-Span-433">=</span><span class="MJXp-mn" id="MJXp-Span-434">0</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-441" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-76"> c_{n-1} = \min\limits_{i=0}^{n-1} c_i</script>, which ensures that no <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-442"><span class="MJXp-msubsup" id="MJXp-Span-443"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-445" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-446">n</span><span class="MJXp-mo" id="MJXp-Span-447">−</span><span class="MJXp-mn" id="MJXp-Span-448">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-449" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-450">0</span></span></span><script type="math/tex" id="MathJax-Element-77"> a_{n-1}>0 </script> will be cyclically shifted to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-451"><span class="MJXp-msubsup" id="MJXp-Span-452"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-454" style="vertical-align: -0.4em;">0</span></span></span></span><script type="math/tex" id="MathJax-Element-78">a_0</script>, enabling us to only consider the first <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-455"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-456">n</span></span></span><script type="math/tex" id="MathJax-Element-79">n</script> elements of the chain.</p><p>For the adjusted <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-457"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">a</span></span></span><script type="math/tex" id="MathJax-Element-80"> a </script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-459"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">b</span></span></span><script type="math/tex" id="MathJax-Element-81"> b </script>, we can greedily process <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-461"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462">i</span></span></span><script type="math/tex" id="MathJax-Element-82"> i </script> from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-463"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464">n</span><span class="MJXp-mo" id="MJXp-Span-465" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">x</span><span class="MJXp-mo" id="MJXp-Span-467" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-468">1</span></span></span><script type="math/tex" id="MathJax-Element-83"> n - x - 1 </script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-469"><span class="MJXp-mo" id="MJXp-Span-470" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-471">1</span></span></span><script type="math/tex" id="MathJax-Element-84"> -1 </script>: If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-472"><span class="MJXp-munderover" id="MJXp-Span-473"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-481" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482">i</span><span class="MJXp-mo" id="MJXp-Span-483">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">x</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-474" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-475" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">j</span><span class="MJXp-mo" id="MJXp-Span-477">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-478">i</span><span class="MJXp-mo" id="MJXp-Span-479">+</span><span class="MJXp-mn" id="MJXp-Span-480">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-485"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-486" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-487" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-488" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-489"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-491" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-85"> \min\limits_{j=i+1}^{i+x}c_j > c_i </script>, then we should apply <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-492"><span class="MJXp-munderover" id="MJXp-Span-493"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-501" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">i</span><span class="MJXp-mo" id="MJXp-Span-503">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">x</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-494" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-495" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496">j</span><span class="MJXp-mo" id="MJXp-Span-497">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498">i</span><span class="MJXp-mo" id="MJXp-Span-499">+</span><span class="MJXp-mn" id="MJXp-Span-500">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-505"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-507" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-508" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510" style="margin-right: 0.05em;">c</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-511" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-86"> \min\limits_{j=i+1}^{i+x}c_j - c_i </script> changes to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-512"><span class="MJXp-msubsup" id="MJXp-Span-513"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-515" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">i</span><span class="MJXp-mo" id="MJXp-Span-517">+</span><span class="MJXp-mn" id="MJXp-Span-518">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-87"> a_{i+1} </script> (assume that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-519"><span class="MJXp-msubsup" id="MJXp-Span-520"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521" style="margin-right: 0.05em;">c</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-522" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-523">−</span><span class="MJXp-mn" id="MJXp-Span-524">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-525" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-526">0</span></span></span><script type="math/tex" id="MathJax-Element-88">c_{-1}=0</script>). We can also use a monotonic stack to maintain the whole process. </p><p>Note that if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-527"><span class="MJXp-munderover" id="MJXp-Span-528"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-534" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">n</span><span class="MJXp-mo" id="MJXp-Span-536">−</span><span class="MJXp-mn" id="MJXp-Span-537">1</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-529" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-530" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">i</span><span class="MJXp-mo" id="MJXp-Span-532">=</span><span class="MJXp-mn" id="MJXp-Span-533">0</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-538"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-540" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-541" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-542">k</span></span></span><script type="math/tex" id="MathJax-Element-89">\sum\limits_{i=0}^{n-1} a_i=k</script>, we should output <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-543"><span class="MJXp-mn" id="MJXp-Span-544">0</span></span></span><script type="math/tex" id="MathJax-Element-90">0</script>.</p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546">O</span><span class="MJXp-mo" id="MJXp-Span-547" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-548" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-549">n</span><span class="MJXp-mi" id="MJXp-Span-550">log</span><span class="MJXp-mo" id="MJXp-Span-551" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">k</span><span class="MJXp-mo" id="MJXp-Span-553" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-91"> O(\sum n\log k) </script>.</p><p><strong>Bonus:</strong> Find an <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-554"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555">O</span><span class="MJXp-mo" id="MJXp-Span-556" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-557" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558">n</span><span class="MJXp-mo" id="MJXp-Span-559" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-92">O(\sum n)</script> solution. </p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
ll t</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="pln">k</span><span class="pun">,</span><span class="pln">pos</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="lit">400009</span><span class="pun">],</span><span class="pln">stk</span><span class="pun">[</span><span class="lit">400009</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> ll read</span><span class="pun">(){</span><span class="pln">
	ll s </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">w </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">char</span><span class="pln"> ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">&gt;</span><span class="pln"> </span><span class="str">'9'</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> ch </span><span class="pun">&lt;</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">){</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">==</span><span class="pln"> </span><span class="str">'-'</span><span class="pun">)</span><span class="pln"> w </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();}</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="str">'9'</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> ch </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="str">'0'</span><span class="pun">)</span><span class="pln"> s </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">3</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ch </span><span class="pun">^</span><span class="pln"> </span><span class="lit">48</span><span class="pun">),</span><span class="pln">ch </span><span class="pun">=</span><span class="pln"> getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> s </span><span class="pun">*</span><span class="pln"> w</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">bool</span><span class="pln"> judge</span><span class="pun">(</span><span class="pln">ll x</span><span class="pun">){</span><span class="pln">
	ll l </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">r </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">res </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> pos</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&gt;=</span><span class="pln"> pos </span><span class="pun">-</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">&lt;=</span><span class="pln"> r </span><span class="pun">&amp;&amp;</span><span class="pln"> stk</span><span class="pun">[</span><span class="pln">l</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">&gt;</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> l </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pos </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">&gt;=</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">+=</span><span class="pln"> max</span><span class="pun">(</span><span class="lit">0ll</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="pln">stk</span><span class="pun">[</span><span class="pln">l</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">res </span><span class="pun">&gt;</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">&lt;=</span><span class="pln"> r </span><span class="pun">&amp;&amp;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">stk</span><span class="pun">[</span><span class="pln">r</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> r </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		stk</span><span class="pun">[++</span><span class="pln"> r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
	t </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t </span><span class="pun">--){</span><span class="pln">
		n </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">(),</span><span class="pln">k </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">();</span><span class="pln">
		ll suma </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> read</span><span class="pun">(),</span><span class="pln">suma </span><span class="pun">+=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-=</span><span class="pln"> read</span><span class="pun">(),</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">suma </span><span class="pun">==</span><span class="pln"> k</span><span class="pun">){</span><span class="pln">puts</span><span class="pun">(</span><span class="str">"0"</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">
		pos </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll i </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">])</span><span class="pln"> pos </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
		ll l </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln">r </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">,</span><span class="pln">ans </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">&lt;=</span><span class="pln"> r</span><span class="pun">){</span><span class="pln">
			ll mid </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">+</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">judge</span><span class="pun">(</span><span class="pln">mid</span><span class="pun">))</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> mid</span><span class="pun">,</span><span class="pln">r </span><span class="pun">=</span><span class="pln"> mid </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">else</span><span class="pln"> l </span><span class="pun">=</span><span class="pln"> mid </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"%lld\n"</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2089/problem/C2" title="Codeforces Round 1012 (Div. 1)">2089C2 - Key of Like (Hard Version)</a> <br> Idea: <a class="rated-user user-violet" href="https://codeforces.com/profile/SpiritualKhorosho" title="Candidate Master SpiritualKhorosho">SpiritualKhorosho</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><h3>Background</h3><p>This problem is inspired by a minigame from a recently released party video game, but the story was modified to comply with <em>the title</em>. We tried to isolate the artistic part and the theoretical part, and I apologize if you still feel like working on reading comprehension exercises.</p><h3>Solution</h3><p>Noticing that each member's strategy is not maximizing the total outcome (which is the expected number of successful matches between keys and locks), but only maximizing the outcome in her current turn, and equally likely to adopt each of optimal (pure) strategies, it will be ideal if there is some simple form of the strategy that only depends on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-560"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-561">L</span></span></span><script type="math/tex" id="MathJax-Element-93">L</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-562"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563">K</span></span></span><script type="math/tex" id="MathJax-Element-94">K</script>.</p><h4>Analyzing the Strategy</h4><p>At the very beginning, when there is no information about the relationship between keys and locks, the first member in her first turn must randomly choose a key and a lock.</p><p>What about the second member, if the first one is not lucky enough? Since she will not choose the same pair of keys and locks, there are three different types of (pure) strategies:</p> <ul>   <li><p>Choose a different key to open the same lock;</p></li>   <li><p>Choose the same key to open a different lock;</p></li>   <li><p>Choose a different key and a different lock.</p></li> </ul><p>For the first type of strategy, since there are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-564"><span class="MJXp-mo" id="MJXp-Span-565" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">L</span><span class="MJXp-mo" id="MJXp-Span-567" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-568">K</span><span class="MJXp-mo" id="MJXp-Span-569" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-570">1</span><span class="MJXp-mo" id="MJXp-Span-571" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-95">(L+K-1)</script> keys remaining (after the very first attempt), and among them is only one correct key, the probability of opening the same lock is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-572"><span class="MJXp-mn" id="MJXp-Span-573">1</span><span class="MJXp-mrow" id="MJXp-Span-574"><span class="MJXp-mo" id="MJXp-Span-575" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-576" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">L</span><span class="MJXp-mo" id="MJXp-Span-578" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-579">K</span><span class="MJXp-mo" id="MJXp-Span-580" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-581">1</span><span class="MJXp-mo" id="MJXp-Span-582" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-96">1/(L+K-1)</script>.</p><p>For the second type, it can be proven that the probability is also <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-583"><span class="MJXp-mn" id="MJXp-Span-584">1</span><span class="MJXp-mrow" id="MJXp-Span-585"><span class="MJXp-mo" id="MJXp-Span-586" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-587" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-588">L</span><span class="MJXp-mo" id="MJXp-Span-589" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-590">K</span><span class="MJXp-mo" id="MJXp-Span-591" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-592">1</span><span class="MJXp-mo" id="MJXp-Span-593" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-97">1/(L+K-1)</script>. Another way to think of this is, add <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595">K</span></span></span><script type="math/tex" id="MathJax-Element-98">K</script> imaginary locks and match each of them with a counterfeit key. Then, it is apparent that a new lock matches the selected key with the given probability.</p> <div class="spoiler"><b class="spoiler-title">The Straightforward Computation of the Probability</b><div class="spoiler-content" style="display: block;"><p>The key selected by the first member can either be a real key or a counterfeit one. Denote the event of the key being authentic as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-596"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597">A</span></span></span><script type="math/tex" id="MathJax-Element-99">A</script>, and that of it failing to open the lock at the first turn as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-598"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599">B</span></span></span><script type="math/tex" id="MathJax-Element-100">B</script>. Then, according to the Bayes' theorem along with the law of total probability,</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-600"><span class="MJXp-mtable" id="MJXp-Span-601"><span><span class="MJXp-mtr" id="MJXp-Span-602" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-603" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-604">P</span><span class="MJXp-mo" id="MJXp-Span-605" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606">A</span><span class="MJXp-mrow" id="MJXp-Span-607"><span class="MJXp-mo" id="MJXp-Span-608" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609">B</span><span class="MJXp-mo" id="MJXp-Span-610" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-611" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-612"></span><span class="MJXp-mo" id="MJXp-Span-613" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-614" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-615">P</span><span class="MJXp-mo" id="MJXp-Span-616" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-617">B</span><span class="MJXp-mrow" id="MJXp-Span-618"><span class="MJXp-mo" id="MJXp-Span-619" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620">A</span><span class="MJXp-mo" id="MJXp-Span-621" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">P</span><span class="MJXp-mo" id="MJXp-Span-623" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624">A</span><span class="MJXp-mo" id="MJXp-Span-625" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626">P</span><span class="MJXp-mo" id="MJXp-Span-627" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628">B</span><span class="MJXp-mo" id="MJXp-Span-629" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-630" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-631" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632">P</span><span class="MJXp-mo" id="MJXp-Span-633" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-634">B</span><span class="MJXp-mrow" id="MJXp-Span-635"><span class="MJXp-mo" id="MJXp-Span-636" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637">A</span><span class="MJXp-mo" id="MJXp-Span-638" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-639">P</span><span class="MJXp-mo" id="MJXp-Span-640" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">A</span><span class="MJXp-mo" id="MJXp-Span-642" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643">P</span><span class="MJXp-mo" id="MJXp-Span-644" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-645">B</span><span class="MJXp-mrow" id="MJXp-Span-646"><span class="MJXp-mo" id="MJXp-Span-647" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">A</span><span class="MJXp-mo" id="MJXp-Span-649" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-650">P</span><span class="MJXp-mo" id="MJXp-Span-651" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652">A</span><span class="MJXp-mo" id="MJXp-Span-653" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-654" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655">P</span><span class="MJXp-mrow" id="MJXp-Span-656"><span class="MJXp-mo" id="MJXp-Span-657" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.05em;">(</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658">B</span><span class="MJXp-mrow" id="MJXp-Span-659"><span class="MJXp-mo" id="MJXp-Span-660" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.013em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-661"><span class="MJXp-munderover" id="MJXp-Span-662"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-664" style="margin-left: 0px; margin-right: 0px;">ˉ</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663">A</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-665" style="margin-left: 0em; margin-right: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-666" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.05em;">)</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">P</span><span class="MJXp-mrow" id="MJXp-Span-668"><span class="MJXp-mo" id="MJXp-Span-669" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.05em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-670"><span class="MJXp-munderover" id="MJXp-Span-671"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-673" style="margin-left: 0px; margin-right: 0px;">ˉ</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">A</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-674" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.05em;">)</span></span></span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-675" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-676" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-677" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-678"></span><span class="MJXp-mo" id="MJXp-Span-679" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-680" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mo" id="MJXp-Span-681" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-682" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683">L</span><span class="MJXp-mo" id="MJXp-Span-684" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-685">1</span><span class="MJXp-mo" id="MJXp-Span-686" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-687"><span class="MJXp-mo" id="MJXp-Span-688" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-689">L</span><span class="MJXp-mo" id="MJXp-Span-690" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-691" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-692" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-693">L</span><span class="MJXp-mrow" id="MJXp-Span-694"><span class="MJXp-mo" id="MJXp-Span-695" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-696" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697">L</span><span class="MJXp-mo" id="MJXp-Span-698" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-699">K</span><span class="MJXp-mo" id="MJXp-Span-700" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-701" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mo" id="MJXp-Span-702" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-703" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-704">L</span><span class="MJXp-mo" id="MJXp-Span-705" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-706">1</span><span class="MJXp-mo" id="MJXp-Span-707" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-708"><span class="MJXp-mo" id="MJXp-Span-709" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-710">L</span><span class="MJXp-mo" id="MJXp-Span-711" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-712" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-713" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-714">L</span><span class="MJXp-mrow" id="MJXp-Span-715"><span class="MJXp-mo" id="MJXp-Span-716" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-717" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-718">L</span><span class="MJXp-mo" id="MJXp-Span-719" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-720">K</span><span class="MJXp-mo" id="MJXp-Span-721" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-722" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-723" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-724">1</span><span class="MJXp-mo" id="MJXp-Span-725" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-726" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727">K</span><span class="MJXp-mrow" id="MJXp-Span-728"><span class="MJXp-mo" id="MJXp-Span-729" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-730" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731">L</span><span class="MJXp-mo" id="MJXp-Span-732" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733">K</span><span class="MJXp-mo" id="MJXp-Span-734" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-735" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-736" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-737" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-738" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-739"></span><span class="MJXp-mo" id="MJXp-Span-740" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-741" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742">L</span><span class="MJXp-mo" id="MJXp-Span-743" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-744">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-745">L</span><span class="MJXp-mo" id="MJXp-Span-746" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747">K</span><span class="MJXp-mo" id="MJXp-Span-748" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-749">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-750" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span><span class="MJXp-mtr" id="MJXp-Span-751" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-752" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-753">P</span><span class="MJXp-mrow" id="MJXp-Span-754"><span class="MJXp-mo" id="MJXp-Span-755" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.05em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-756"><span class="MJXp-mo" id="MJXp-Span-757" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-758"><span class="MJXp-munderover" id="MJXp-Span-759"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-761" style="margin-left: 0px; margin-right: 0px;">ˉ</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">A</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-762" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.013em;">|</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-763">B</span><span class="MJXp-mo" id="MJXp-Span-764" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.05em;">)</span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-765" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-766"></span><span class="MJXp-mo" id="MJXp-Span-767" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-768">1</span><span class="MJXp-mo" id="MJXp-Span-769" style="margin-left: 0em; margin-right: 0.222em;">—</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770">P</span><span class="MJXp-mo" id="MJXp-Span-771" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-772">A</span><span class="MJXp-mrow" id="MJXp-Span-773"><span class="MJXp-mo" id="MJXp-Span-774" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-775">B</span><span class="MJXp-mo" id="MJXp-Span-776" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-777" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-778" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">K</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-780">L</span><span class="MJXp-mo" id="MJXp-Span-781" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782">K</span><span class="MJXp-mo" id="MJXp-Span-783" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-784">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-785" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-101">\begin{equation} \begin{split} P(A|B) &= \frac{P(B|A)P(A)}{P(B)} = \frac{P(B|A)P(A)}{P(B|A)P(A) + P\left(B\left|\bar{A}\right.\right)P\left(\bar{A}\right)} \\ &= \frac{((L-1)/L)\cdot (L/(L+K))}{((L-1)/L)\cdot (L/(L+K)) + 1\cdot(K/(L+K))}\\ &= \frac{L-1}{L+K-1},\\ P\left(\left.\bar{A}\right|B\right) &= 1 — P(A|B) = \frac{K}{L+K-1}. \end{split} \end{equation}</script></p><p>Thus, the probability that the same key selected by the first member can open another lock randomly chosen by the second member (denoted as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-786"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">C</span></span></span><script type="math/tex" id="MathJax-Element-102">C</script>) is</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-788"><span class="MJXp-mtable" id="MJXp-Span-789"><span><span class="MJXp-mtr" id="MJXp-Span-790" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-791" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">P</span><span class="MJXp-mo" id="MJXp-Span-793" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-794">C</span><span class="MJXp-mrow" id="MJXp-Span-795"><span class="MJXp-mo" id="MJXp-Span-796" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-797">B</span><span class="MJXp-mo" id="MJXp-Span-798" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-799" style="padding-left: 0em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-800"></span><span class="MJXp-mo" id="MJXp-Span-801" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-802">P</span><span class="MJXp-mo" id="MJXp-Span-803" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-804">A</span><span class="MJXp-mrow" id="MJXp-Span-805"><span class="MJXp-mo" id="MJXp-Span-806" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807">B</span><span class="MJXp-mo" id="MJXp-Span-808" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-809" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-810">P</span><span class="MJXp-mo" id="MJXp-Span-811" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">C</span><span class="MJXp-mrow" id="MJXp-Span-813"><span class="MJXp-mo" id="MJXp-Span-814" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-815">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816">B</span><span class="MJXp-mo" id="MJXp-Span-817" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-818" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819">P</span><span class="MJXp-mrow" id="MJXp-Span-820"><span class="MJXp-mo" id="MJXp-Span-821" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.05em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-822"><span class="MJXp-mo" id="MJXp-Span-823" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-824"><span class="MJXp-munderover" id="MJXp-Span-825"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-827" style="margin-left: 0px; margin-right: 0px;">ˉ</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-826">A</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-828" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.013em;">|</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-829">B</span><span class="MJXp-mo" id="MJXp-Span-830" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.05em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-831" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-832">P</span><span class="MJXp-mrow" id="MJXp-Span-833"><span class="MJXp-mo" id="MJXp-Span-834" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.05em;">(</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-835">C</span><span class="MJXp-mrow" id="MJXp-Span-836"><span class="MJXp-mo" id="MJXp-Span-837" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.013em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-838"><span class="MJXp-munderover" id="MJXp-Span-839"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-841" style="margin-left: 0px; margin-right: 0px;">ˉ</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840">A</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842">B</span><span class="MJXp-mo" id="MJXp-Span-843" style="margin-left: 0em; margin-right: 0em;"></span></span><span class="MJXp-mo" id="MJXp-Span-844" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.236em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.942em; margin-left: -0.05em;">)</span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-845" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-846" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-847" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-848"></span><span class="MJXp-mo" id="MJXp-Span-849" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-850" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-851">L</span><span class="MJXp-mo" id="MJXp-Span-852" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-853">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854">L</span><span class="MJXp-mo" id="MJXp-Span-855" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-856">K</span><span class="MJXp-mo" id="MJXp-Span-857" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-858">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-859" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mfrac" id="MJXp-Span-860" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-861">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-862">L</span><span class="MJXp-mo" id="MJXp-Span-863" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-864">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-865" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-866" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867">K</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-868">L</span><span class="MJXp-mo" id="MJXp-Span-869" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-870">K</span><span class="MJXp-mo" id="MJXp-Span-871" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-872">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-873" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mn" id="MJXp-Span-874">0</span></span></span><span class="MJXp-mtr" id="MJXp-Span-875" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-876" style="padding-top: 0.3em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-877" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mi" id="MJXp-Span-878"></span><span class="MJXp-mo" id="MJXp-Span-879" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-880" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-881">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">L</span><span class="MJXp-mo" id="MJXp-Span-883" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884">K</span><span class="MJXp-mo" id="MJXp-Span-885" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-886">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-887" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span></span></span><script type="math/tex; mode=display" id="MathJax-Element-103">\begin{equation} \begin{split} P(C|B) &= P(A|B)\cdot P(C|AB) + P\left(\left.\bar{A}\right|B\right)\cdot P\left(C\left|\bar{A}B\right.\right)\\ &=\frac{L-1}{L+K-1}\cdot\frac{1}{L-1} + \frac{K}{L+K-1}\cdot 0\\ &= \frac{1}{L+K-1}. \end{split} \end{equation}</script></p></div></div><p>For the third type of strategy, its probability can be computed from either the first type or the second type, as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-888"><span class="MJXp-mo" id="MJXp-Span-889" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">L</span><span class="MJXp-mo" id="MJXp-Span-891" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-892">K</span><span class="MJXp-mo" id="MJXp-Span-893" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-894">1</span><span class="MJXp-mo" id="MJXp-Span-895" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-104">(L+K-1)</script> different outcomes are equally likely to happen:</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-896"><span class="MJXp-mfrac" id="MJXp-Span-897" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-898">1</span><span class="MJXp-mo" id="MJXp-Span-899" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-900">1</span><span class="MJXp-mrow" id="MJXp-Span-901"><span class="MJXp-mo" id="MJXp-Span-902" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-903" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-904">L</span><span class="MJXp-mo" id="MJXp-Span-905" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-906">K</span><span class="MJXp-mo" id="MJXp-Span-907" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-908">1</span><span class="MJXp-mo" id="MJXp-Span-909" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910">L</span><span class="MJXp-mo" id="MJXp-Span-911" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-912">K</span><span class="MJXp-mo" id="MJXp-Span-913" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-914">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-915" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-916" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">L</span><span class="MJXp-mo" id="MJXp-Span-918" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-919">K</span><span class="MJXp-mo" id="MJXp-Span-920" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-921">2</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mo" id="MJXp-Span-922" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-923">L</span><span class="MJXp-mo" id="MJXp-Span-924" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">K</span><span class="MJXp-mo" id="MJXp-Span-926" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-927">1</span><span class="MJXp-msubsup" id="MJXp-Span-928"><span class="MJXp-mo" id="MJXp-Span-929" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-930" style="vertical-align: 0.5em;">2</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-931" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mfrac" id="MJXp-Span-932" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-933">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-934">L</span><span class="MJXp-mo" id="MJXp-Span-935" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-936">K</span><span class="MJXp-mo" id="MJXp-Span-937" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-938">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-939" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><script type="math/tex; mode=display" id="MathJax-Element-105">\begin{equation} \frac{1-1/(L+K-1)}{L+K-1}=\frac{L+K-2}{(L+K-1)^2}<\frac{1}{L+K-1}. \end{equation}</script></p><p>In conclusion, the second member will either choose the same key or the same lock. Because there are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-940"><span class="MJXp-mo" id="MJXp-Span-941" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942">L</span><span class="MJXp-mo" id="MJXp-Span-943" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-944">1</span><span class="MJXp-mo" id="MJXp-Span-945" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-106">(L - 1)</script> pairs of the same key and other locks, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-946"><span class="MJXp-mo" id="MJXp-Span-947" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948">L</span><span class="MJXp-mo" id="MJXp-Span-949" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-950">K</span><span class="MJXp-mo" id="MJXp-Span-951" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-952">1</span><span class="MJXp-mo" id="MJXp-Span-953" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-107">(L + K - 1)</script> pairs of other keys and the same lock, the second member will use the same key with probability <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-954"><span class="MJXp-mo" id="MJXp-Span-955" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-956">L</span><span class="MJXp-mo" id="MJXp-Span-957" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-958">1</span><span class="MJXp-mo" id="MJXp-Span-959" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-960"><span class="MJXp-mo" id="MJXp-Span-961" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-962" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-963">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-964">L</span><span class="MJXp-mo" id="MJXp-Span-965" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-966">K</span><span class="MJXp-mo" id="MJXp-Span-967" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-968">2</span><span class="MJXp-mo" id="MJXp-Span-969" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-108">(L - 1)/(2L + K - 2)</script>, or check the same lock with probability <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-970"><span class="MJXp-mo" id="MJXp-Span-971" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972">L</span><span class="MJXp-mo" id="MJXp-Span-973" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">K</span><span class="MJXp-mo" id="MJXp-Span-975" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-976">1</span><span class="MJXp-mo" id="MJXp-Span-977" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-978"><span class="MJXp-mo" id="MJXp-Span-979" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-980" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-981">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982">L</span><span class="MJXp-mo" id="MJXp-Span-983" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984">K</span><span class="MJXp-mo" id="MJXp-Span-985" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-986">2</span><span class="MJXp-mo" id="MJXp-Span-987" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-109">(L + K - 1)/(2L + K - 2)</script>.</p><p>As for all the following attempts, a similar <em>Proof</em> shows that, everyone will imitate the strategy adopted by the second member. That is to say, if the second member decides to continue with the same key, everyone will keep using this same key, until a lock is opened or all the locks are checked; if the second member picks a different key for the same lock, everyone will challenge this same lock, until it is eventually settled (and obviously it will). </p><p>Furthermore, whenever a key is identified as counterfeit, or a lock is opened, the information 'collapses', which turns the original problem into a subproblem with either one less counterfeit key (corresponding to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-988"><span class="MJXp-msup" id="MJXp-Span-989"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990" style="margin-right: 0.05em;">K</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-991" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-992" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-993">K</span><span class="MJXp-mo" id="MJXp-Span-994" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-995">1</span></span></span><script type="math/tex" id="MathJax-Element-110">K' = K - 1</script>), or both one less valid key and one less lock (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-996"><span class="MJXp-msup" id="MJXp-Span-997"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998" style="margin-right: 0.05em;">L</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-999" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1000" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001">L</span><span class="MJXp-mo" id="MJXp-Span-1002" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1003">1</span></span></span><script type="math/tex" id="MathJax-Element-111">L' = L - 1</script>), respectively.</p><p>To sum up, the process of the game is:</p> <ul>   <li>Whenever a lock is opened, the original problem is reduced to a subproblem with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1004"><span class="MJXp-msup" id="MJXp-Span-1005"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006" style="margin-right: 0.05em;">L</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1007" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1008" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">L</span><span class="MJXp-mo" id="MJXp-Span-1010" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1011">1</span></span></span><script type="math/tex" id="MathJax-Element-112">L' = L - 1</script>;</li>   <li>Whenever a key is proven counterfeit, the original problem is reduced to a subproblem where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1012"><span class="MJXp-msup" id="MJXp-Span-1013"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014" style="margin-right: 0.05em;">K</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1015" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1016" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">K</span><span class="MJXp-mo" id="MJXp-Span-1018" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1019">1</span></span></span><script type="math/tex" id="MathJax-Element-113">K' = K - 1</script>; -The first member randomly chooses a key and a lock to check if they match;</li>   <li>If the first member fails, the second member adopts the same key with probability <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1020"><span class="MJXp-mo" id="MJXp-Span-1021" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022">L</span><span class="MJXp-mo" id="MJXp-Span-1023" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1024">1</span><span class="MJXp-mo" id="MJXp-Span-1025" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1026"><span class="MJXp-mo" id="MJXp-Span-1027" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-1028" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1029">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">L</span><span class="MJXp-mo" id="MJXp-Span-1031" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">K</span><span class="MJXp-mo" id="MJXp-Span-1033" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1034">2</span><span class="MJXp-mo" id="MJXp-Span-1035" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-114">(L - 1)/(2L + K - 2)</script>, or investigates the same lock with probability <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1036"><span class="MJXp-mo" id="MJXp-Span-1037" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1038">L</span><span class="MJXp-mo" id="MJXp-Span-1039" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1040">K</span><span class="MJXp-mo" id="MJXp-Span-1041" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1042">1</span><span class="MJXp-mo" id="MJXp-Span-1043" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1044"><span class="MJXp-mo" id="MJXp-Span-1045" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-1046" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1047">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1048">L</span><span class="MJXp-mo" id="MJXp-Span-1049" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1050">K</span><span class="MJXp-mo" id="MJXp-Span-1051" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1052">2</span><span class="MJXp-mo" id="MJXp-Span-1053" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-115">(L + K - 1)/(2L + K - 2)</script>;</li>   <li>If the second member fails as well, all the following attempts will replicate the choice of whether to employ the same key or the same lock.</li> </ul><h4>Design the Algorithm with Strategies Solved</h4><p>Knowing the concrete strategies, the task now becomes how to compute the expected values efficiently. As you might have imagined, it can be achieved using dynamic programming due to the existence of overlapping subproblems. But let's examine another approach which might be easier to understand: compute <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1054"><span class="MJXp-msubsup" id="MJXp-Span-1055"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1056" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1057" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1058" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1059">l</span><span class="MJXp-mo" id="MJXp-Span-1060" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061">k</span><span class="MJXp-mo" id="MJXp-Span-1062" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-116">p_i (l, k)</script>, the total probability that the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1063"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">i</span></span></span><script type="math/tex" id="MathJax-Element-117">i</script>-th member begins a subproblem with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1065"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1066">l</span></span></span><script type="math/tex" id="MathJax-Element-118">l</script> locks and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1067"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1068">k</span></span></span><script type="math/tex" id="MathJax-Element-119">k</script> counterfeit keys, and accumulate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1069"><span class="MJXp-msubsup" id="MJXp-Span-1070"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071" style="margin-right: 0.05em;">e</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1072" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-120">e_i</script>'s during the computation.</p><p>Transitions for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1073"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074">p</span></span></span><script type="math/tex" id="MathJax-Element-121">p</script> itself include (and those from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1075"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1076">p</span></span></span><script type="math/tex" id="MathJax-Element-122">p</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1077"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078">e</span></span></span><script type="math/tex" id="MathJax-Element-123">e</script> will be similar to):</p> <ol>   <li>The first member manages to open the lock without any prior information;</li>   <li>The second member makes a successful guess;</li>   <li>Any of the succeeding attempts succeeds;</li>   <li>Everyone uses the same key but it fails on all the locks.</li> </ol><p>For each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1079"><span class="MJXp-msubsup" id="MJXp-Span-1080"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1082" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1083" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084">l</span><span class="MJXp-mo" id="MJXp-Span-1085" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086">k</span><span class="MJXp-mo" id="MJXp-Span-1087" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-124">p_i(l, k)</script>, all the transition can be easily processed in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1088"><span class="MJXp-mi" id="MJXp-Span-1089">Θ</span><span class="MJXp-mo" id="MJXp-Span-1090" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1091">1</span><span class="MJXp-mo" id="MJXp-Span-1092" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-125">\Theta(1)</script> time, except the third one. A verbatim implementation requires <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1093"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094">O</span><span class="MJXp-mo" id="MJXp-Span-1095" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1096">L</span><span class="MJXp-mo" id="MJXp-Span-1097" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098">K</span><span class="MJXp-mo" id="MJXp-Span-1099" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-126">O(L + K)</script> time per state, which is apparently not efficient enough. Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1100"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1101">N</span><span class="MJXp-mo" id="MJXp-Span-1102" style="margin-left: 0.333em; margin-right: 0.333em;">≪</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1103">L</span></span></span><script type="math/tex" id="MathJax-Element-127">N \ll L</script>, a possible work-around is to compute the transition coefficient for each member, instead of each attempt. Intuitively, all attempts should share the same probability of success, regardless of the order. A simplified model is to draw all balls sequentially without replacement from a box of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1104"><span class="MJXp-mn" id="MJXp-Span-1105">1</span></span></span><script type="math/tex" id="MathJax-Element-128">1</script> red ball and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1106"><span class="MJXp-mo" id="MJXp-Span-1107" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1108">x</span><span class="MJXp-mo" id="MJXp-Span-1109" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1110">1</span><span class="MJXp-mo" id="MJXp-Span-1111" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-129">(x-1)</script> white balls, in which the red ball appears at the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1112"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">i</span></span></span><script type="math/tex" id="MathJax-Element-130">i</script>-th attempt with an equal probability of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1114"><span class="MJXp-mn" id="MJXp-Span-1115">1</span><span class="MJXp-mrow" id="MJXp-Span-1116"><span class="MJXp-mo" id="MJXp-Span-1117" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118">x</span></span></span><script type="math/tex" id="MathJax-Element-131">1/x</script>. Of course, the observation for our problem can also be proven mathematically, but let's omit it for simplicity.</p><p>This important observation reduces the time complexity of the third type of transition to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1119"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120">O</span><span class="MJXp-mo" id="MJXp-Span-1121" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1122">N</span><span class="MJXp-mo" id="MJXp-Span-1123" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-132">O(N)</script>, as we can first compute the maximum number of attempts for each member, and then multiply it with the common probability of a single attempt. However, this is still not enough for passing the problem (and we adjusted the constraints to prevent so).</p><p>The final trick to pass all testcases requires revisiting the transition coefficients we just computed. Notice that, if all the members have <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125">a</span></span></span><script type="math/tex" id="MathJax-Element-133">a</script> attempts in total (but for the third type of transition only, which excludes the first two), then:</p> <ul>   <li><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1127">a</span></span></span><script type="math/tex" id="MathJax-Element-134">a</script> is a multiple of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1128"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129">N</span></span></span><script type="math/tex" id="MathJax-Element-135">N</script>, then every member can have at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1130"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1131">a</span><span class="MJXp-mrow" id="MJXp-Span-1132"><span class="MJXp-mo" id="MJXp-Span-1133" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134">N</span></span></span><script type="math/tex" id="MathJax-Element-136">a/N</script> attempts;</p></li>   <li><p>Otherwise, the first <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1136">a</span><span class="MJXp-mo" id="MJXp-Span-1137" style="margin-left: 0.278em; margin-right: 0.278em;">mod</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138">N</span></span></span><script type="math/tex" id="MathJax-Element-137">a \bmod N</script> members (right after the second member, who decides to advance with the same key or the same lock) can have at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1139"><span class="MJXp-mo" id="MJXp-Span-1140" style="margin-left: 0em; margin-right: 0em;">⌈</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1141">a</span><span class="MJXp-mrow" id="MJXp-Span-1142"><span class="MJXp-mo" id="MJXp-Span-1143" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">N</span><span class="MJXp-mo" id="MJXp-Span-1145" style="margin-left: 0em; margin-right: 0em;">⌉</span></span></span><script type="math/tex" id="MathJax-Element-138">\lceil a/N\rceil</script> attempts, while all the others can have at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1146"><span class="MJXp-mo" id="MJXp-Span-1147" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1148">a</span><span class="MJXp-mrow" id="MJXp-Span-1149"><span class="MJXp-mo" id="MJXp-Span-1150" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151">N</span><span class="MJXp-mo" id="MJXp-Span-1152" style="margin-left: 0em; margin-right: 0em;">⌋</span></span></span><script type="math/tex" id="MathJax-Element-139">\lfloor a/N\rfloor</script> attempts.</p></li> </ul><p>This implies that the transition coefficients consists of at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1153"><span class="MJXp-mn" id="MJXp-Span-1154">3</span></span></span><script type="math/tex" id="MathJax-Element-140">3</script> maximal contiguous subsequences of the same coefficients (in fact, if the coefficients are treated as a circular sequence, then there will be exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1155"><span class="MJXp-mn" id="MJXp-Span-1156">1</span></span></span><script type="math/tex" id="MathJax-Element-141">1</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1157"><span class="MJXp-mn" id="MJXp-Span-1158">2</span></span></span><script type="math/tex" id="MathJax-Element-142">2</script> for the two cases respectively). Using techniques such as prefix sums helps further decrease the complexity of the computation to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1159"><span class="MJXp-mi" id="MJXp-Span-1160">Θ</span><span class="MJXp-mo" id="MJXp-Span-1161" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1162">1</span><span class="MJXp-mo" id="MJXp-Span-1163" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-143">\Theta(1)</script> per state.</p><p>The total time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1164"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">O</span><span class="MJXp-mo" id="MJXp-Span-1166" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1168">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169">K</span><span class="MJXp-mo" id="MJXp-Span-1170" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-144">O(NLK)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstdio&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstring&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> MOD </span><span class="lit">1000000007</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> MAXN </span><span class="lit">108</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> MAXL </span><span class="lit">5004</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> MAXK </span><span class="lit">27</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> e</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">],</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">][</span><span class="pln">MAXK</span><span class="pun">][</span><span class="pln">MAXN</span><span class="pun">],</span><span class="pln"> inv</span><span class="pun">[</span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> MAXL </span><span class="pun">+</span><span class="pln"> MAXK</span><span class="pun">];</span><span class="pln">  
</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> _update</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> a</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> lbd</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> rbd</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">base</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> diff</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="kwd">base</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">lbd</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> diff</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">rbd</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> MOD </span><span class="pun">-</span><span class="pln"> diff</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="typ">Hill</span><span class="pun">(</span><span class="pln">_a</span><span class="pun">,</span><span class="pln"> _lbd</span><span class="pun">,</span><span class="pln"> _rbd</span><span class="pun">,</span><span class="pln"> _base</span><span class="pun">,</span><span class="pln"> _diff</span><span class="pun">)</span><span class="pln"> _update</span><span class="pun">(</span><span class="pln">_a</span><span class="pun">,</span><span class="pln"> _lbd</span><span class="pun">,</span><span class="pln"> _rbd</span><span class="pun">,</span><span class="pln"> _base</span><span class="pun">,</span><span class="pln"> _diff</span><span class="pun">)</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="typ">Valley</span><span class="pun">(</span><span class="pln">_a</span><span class="pun">,</span><span class="pln"> _lbd</span><span class="pun">,</span><span class="pln"> _rbd</span><span class="pun">,</span><span class="pln"> _base</span><span class="pun">,</span><span class="pln"> _diff</span><span class="pun">)</span><span class="pln"> _update</span><span class="pun">(</span><span class="pln">_a</span><span class="pun">,</span><span class="pln"> _rbd</span><span class="pun">,</span><span class="pln"> _lbd</span><span class="pun">,</span><span class="pln"> </span><span class="pun">((</span><span class="pln">_base</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">_diff</span><span class="pun">))</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">,</span><span class="pln"> MOD </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">_diff</span><span class="pun">))</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> </span><span class="typ">Update</span><span class="pun">(</span><span class="pln">_a</span><span class="pun">,</span><span class="pln"> _lbd</span><span class="pun">,</span><span class="pln"> _rbd</span><span class="pun">,</span><span class="pln"> _base</span><span class="pun">,</span><span class="pln"> _diff</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">_lbd </span><span class="pun">&lt;</span><span class="pln"> _rbd</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Hill</span><span class="pun">(</span><span class="pln">_a</span><span class="pun">,</span><span class="pln"> _lbd</span><span class="pun">,</span><span class="pln"> _rbd</span><span class="pun">,</span><span class="pln"> _base</span><span class="pun">,</span><span class="pln"> _diff</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="typ">Valley</span><span class="pun">(</span><span class="pln">_a</span><span class="pun">,</span><span class="pln"> _lbd</span><span class="pun">,</span><span class="pln"> _rbd</span><span class="pun">,</span><span class="pln"> _base</span><span class="pun">,</span><span class="pln"> _diff</span><span class="pun">);</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> like</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">,</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> j</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">,</span><span class="pln"> b</span><span class="pun">,</span><span class="pln"> dh</span><span class="pun">,</span><span class="pln"> now</span><span class="pun">,</span><span class="pln"> nxt</span><span class="pun">,</span><span class="pln"> totk</span><span class="pun">,</span><span class="pln"> ntry</span><span class="pun">,</span><span class="pln"> prob</span><span class="pun">,</span><span class="pln"> pd</span><span class="pun">,</span><span class="pln"> pb</span><span class="pun">,</span><span class="pln"> lbd</span><span class="pun">,</span><span class="pln"> rbd</span><span class="pun">;</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d %d %d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">k</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	inv</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> l </span><span class="pun">+</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> j</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> inv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">MOD </span><span class="pun">-</span><span class="pln"> MOD </span><span class="pun">/</span><span class="pln"> i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> inv</span><span class="pun">[</span><span class="pln">MOD </span><span class="pun">%</span><span class="pln"> i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
	
	memset</span><span class="pun">(</span><span class="pln">p</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">p</span><span class="pun">));</span><span class="pln">
	memset</span><span class="pun">(</span><span class="pln">e</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">e</span><span class="pun">));</span><span class="pln">
	p</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	p</span><span class="pun">[</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	now </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> nxt </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> l</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;=</span><span class="pln"> k</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">j</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			totk </span><span class="pun">=</span><span class="pln"> l </span><span class="pun">+</span><span class="pln"> k </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">-</span><span class="pln"> j</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> a </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">a</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">now</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">a</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">now</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">a </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">])</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> a </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">a</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
				</span><span class="com">// Match at the first try</span><span class="pln">
				prob </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">now</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">a</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> inv</span><span class="pun">[</span><span class="pln">totk</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">(</span><span class="pln">e</span><span class="pun">[</span><span class="pln">a</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> prob</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">!=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">[</span><span class="pln">a </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> MOD </span><span class="pun">-</span><span class="pln"> prob</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">nxt</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][(</span><span class="pln">a </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> prob</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">!=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">nxt</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][(</span><span class="pln">a </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> MOD </span><span class="pun">-</span><span class="pln"> prob</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">

				prob </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> prob </span><span class="pun">*</span><span class="pln"> inv</span><span class="pun">[</span><span class="pln">totk </span><span class="pun">+</span><span class="pln"> l </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
				</span><span class="com">// Same lock</span><span class="pln">
				pd </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> prob </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ntry </span><span class="pun">=</span><span class="pln"> totk </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
				pb </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ntry </span><span class="pun">/</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> pd </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dh </span><span class="pun">=</span><span class="pln"> ntry </span><span class="pun">%</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
					lbd </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
					rbd </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">+</span><span class="pln"> dh</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> 
					</span><span class="typ">Update</span><span class="pun">(</span><span class="pln">e</span><span class="pun">,</span><span class="pln"> lbd</span><span class="pun">,</span><span class="pln"> rbd</span><span class="pun">,</span><span class="pln"> pb</span><span class="pun">,</span><span class="pln"> pd</span><span class="pun">);</span><span class="pln">
					</span><span class="pun">(++</span><span class="pln">lbd</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
					</span><span class="pun">++(</span><span class="pln">rbd  </span><span class="pun">%=</span><span class="pln"> n</span><span class="pun">);</span><span class="pln"> 
					</span><span class="typ">Update</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">nxt</span><span class="pun">][</span><span class="pln">j</span><span class="pun">],</span><span class="pln"> lbd</span><span class="pun">,</span><span class="pln"> rbd</span><span class="pun">,</span><span class="pln"> pb</span><span class="pun">,</span><span class="pln"> pd</span><span class="pun">);</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
					</span><span class="pun">(</span><span class="pln">e</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> pb</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
					</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">nxt</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> pb</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">

				</span><span class="com">// Same key</span><span class="pln">
				pd </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> prob </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ntry </span><span class="pun">=</span><span class="pln"> l </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">&lt;</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
					pb </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> pd </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">-</span><span class="pln"> j</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln"> 
					b </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">+</span><span class="pln"> l </span><span class="pun">-</span><span class="pln"> i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
					</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">now</span><span class="pun">][</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">b</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> pb</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
					</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">b </span><span class="pun">!=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">now</span><span class="pun">][</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">b </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> MOD </span><span class="pun">-</span><span class="pln"> pb</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				pb </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ntry </span><span class="pun">/</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> pd </span><span class="pun">%</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dh </span><span class="pun">=</span><span class="pln"> ntry </span><span class="pun">%</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
					lbd </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
					rbd </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">+</span><span class="pln"> dh</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> 
					</span><span class="typ">Update</span><span class="pun">(</span><span class="pln">e</span><span class="pun">,</span><span class="pln"> lbd</span><span class="pun">,</span><span class="pln"> rbd</span><span class="pun">,</span><span class="pln"> pb</span><span class="pun">,</span><span class="pln"> pd</span><span class="pun">);</span><span class="pln">
					</span><span class="pun">(++</span><span class="pln">lbd</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
					</span><span class="pun">++(</span><span class="pln">rbd  </span><span class="pun">%=</span><span class="pln"> n</span><span class="pun">);</span><span class="pln"> 
					</span><span class="typ">Update</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">nxt</span><span class="pun">][</span><span class="pln">j</span><span class="pun">],</span><span class="pln"> lbd</span><span class="pun">,</span><span class="pln"> rbd</span><span class="pun">,</span><span class="pln"> pb</span><span class="pun">,</span><span class="pln"> pd</span><span class="pun">);</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
					</span><span class="pun">(</span><span class="pln">e</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> pb</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
					</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">nxt</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> pb</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">

		now </span><span class="pun">^=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		nxt </span><span class="pun">^=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		memset</span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">nxt</span><span class="pun">],</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">sizeof</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> MAXK </span><span class="pun">*</span><span class="pln"> MAXN</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> e</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">])</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> MOD</span><span class="pun">;</span><span class="pln">

	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> printf</span><span class="pun">(</span><span class="str">"%d%c"</span><span class="pun">,</span><span class="pln"> e</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> </span><span class="str">" \n"</span><span class="pun">[</span><span class="pln">i </span><span class="pun">==</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">t</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		like</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2089/problem/D" title="Codeforces Round 1012 (Div. 1)">2089D - Conditional Operators</a> <br> Idea: <a class="rated-user user-orange" href="https://codeforces.com/profile/E.Space" title="International Master E.Space">E.Space</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Each operation transform three adjacent characters into one. If the string starts with <code class="tt">11</code>, the answer should be yes since we can first transform the remaining part into a single <code class="tt">0</code> or <code class="tt">1</code> and then the value of <code class="tt">11?</code> is always <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1171"><span class="MJXp-mn" id="MJXp-Span-1172">1</span></span></span><script type="math/tex" id="MathJax-Element-145">1</script>.</p><p>If the string ends with <code class="tt">1</code>, only <code class="tt">101</code> has no solution, otherwise it starts with <code class="tt">11</code> or <code class="tt">0</code>, or we can transform <code class="tt">10?</code> in the front of the string into a 0. Then transform the rest part of the string into a single character to make the last operation <code class="tt">0?(anything):1</code> makes 1.</p><p>If an operation transformed a string ending with <code class="tt">0</code> into one ending with <code class="tt">1</code>, it must be <code class="tt">1?1:0</code> makes 1.</p><p>Consider the case where the strings contains <code class="tt">11</code> as a substring. After transforming the remaining part, <code class="tt">?11??</code> or <code class="tt">??11?</code> will be derived. The cases are <code class="tt">01100</code>, <code class="tt">00110</code>, <code class="tt">01110</code>, <code class="tt">10110</code>. All other cases start with <code class="tt">11</code> or end with <code class="tt">1</code>.</p><p>All cases of <code class="tt">??11?</code> have a solution:</p><p><code class="tt">(0?0:1)?1:0</code> makes 1.</p><p><code class="tt">(0?1:1)?1:0</code> makes 1.</p><p><code class="tt">1?(0?1:1):0</code> makes 1.</p><p>However, <code class="tt">01100</code> has no solution.</p><p>Since <code class="tt">0?0:1</code> equals 1, before the last <code class="tt">1</code>, any two adjacent 0's with no <code class="tt">1</code> in between can be eliminated. Thus, if there are two 1's with an even number of 0's in between, and there are an even number of characters in front the former <code class="tt">1</code>, i.e., <code class="tt">(..)*1(00)*1(..)*0</code> in regular expression, the answer should be yes, since after eliminating the 0's in between, the 1's become adjacent. The parity of the characters before the former <code class="tt">1</code> guarantees that it will not become <code class="tt">01100</code>.</p><p>Another case is that the string ends with <code class="tt">0</code> and every pair of adjacent 1's has an odd number of 0's in between. Since <code class="tt">0(1?0:1)0</code> makes <code class="tt">000</code>, <code class="tt">1(0?1:0)1</code> makes <code class="tt">101</code>, <code class="tt">10(1?0:0)01</code> makes <code class="tt">10001</code>, there is no way to change the parity of the consecutive 0's to make <code class="tt">11</code> to change the ending <code class="tt">0</code> into <code class="tt">1</code>.</p><p>In the remaining case, there are even 0's between some pair of adjacent 1's, but the number of characters before the first 1 is odd, there must be only one pair. Suppose the string is 1-indexed. It is because the indices of such pair of 1's must be [odd, even]; while the indices in the previous case must be [even, odd]. Thus, if there are two such pairs of this case [odd, even], in the parity sequence [odd, even, ..., odd, even] there must be an [even, odd] as a substring.</p><p>Therefore, any other pair of adjacent 1's must have odd 0's in between, i.e., <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1173"><span class="MJXp-mn" id="MJXp-Span-1174">0</span><span class="MJXp-mo" id="MJXp-Span-1175" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1176">00</span><span class="MJXp-msubsup" id="MJXp-Span-1177"><span class="MJXp-mo" id="MJXp-Span-1178" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1179" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mstyle" id="MJXp-Span-1180" style="color: blue;"><span class="MJXp-mo" id="MJXp-Span-1181" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1182">10</span><span class="MJXp-mo" id="MJXp-Span-1183" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1184">00</span><span class="MJXp-msubsup" id="MJXp-Span-1185"><span class="MJXp-mo" id="MJXp-Span-1186" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1187" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-msubsup" id="MJXp-Span-1188"><span class="MJXp-mo" id="MJXp-Span-1189" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1190" style="vertical-align: 0.5em;">∗</span></span></span><span class="MJXp-mstyle" id="MJXp-Span-1191" style="color: red;"><span class="MJXp-mn" id="MJXp-Span-1192">1</span></span><span class="MJXp-mstyle" id="MJXp-Span-1193" style="color: black;"><span class="MJXp-mo" id="MJXp-Span-1194" style="margin-left: 0em; margin-right: 0em;">(</span></span><span class="MJXp-mn" id="MJXp-Span-1195">00</span><span class="MJXp-msubsup" id="MJXp-Span-1196"><span class="MJXp-mo" id="MJXp-Span-1197" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1198" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mstyle" id="MJXp-Span-1199" style="color: red;"><span class="MJXp-mn" id="MJXp-Span-1200">1</span></span><span class="MJXp-mstyle" id="MJXp-Span-1201" style="color: blue;"><span class="MJXp-mo" id="MJXp-Span-1202" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1203" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1204">00</span><span class="MJXp-msubsup" id="MJXp-Span-1205"><span class="MJXp-mo" id="MJXp-Span-1206" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1207" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mn" id="MJXp-Span-1208">01</span><span class="MJXp-msubsup" id="MJXp-Span-1209"><span class="MJXp-mo" id="MJXp-Span-1210" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1211" style="vertical-align: 0.5em;">∗</span></span></span><span class="MJXp-mstyle" id="MJXp-Span-1212" style="color: black;"><span class="MJXp-mo" id="MJXp-Span-1213" style="margin-left: 0em; margin-right: 0em;">(</span></span><span class="MJXp-mn" id="MJXp-Span-1214">00</span><span class="MJXp-msubsup" id="MJXp-Span-1215"><span class="MJXp-mo" id="MJXp-Span-1216" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1217" style="vertical-align: 0.5em;">+</span></span></span></span><script type="math/tex" id="MathJax-Element-146">0(00)^*\color{blue}{(10(00)^*)^*}\color{red}1\color{black}(00)^*\color{red}1\color{blue}{((00)^*01)^*}\color{black}(00)^+</script> in regular expression. Any operation remains the string in this case, except that the string is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1218"><span class="MJXp-mn" id="MJXp-Span-1219">0</span><span class="MJXp-mo" id="MJXp-Span-1220" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1221">00</span><span class="MJXp-msubsup" id="MJXp-Span-1222"><span class="MJXp-mo" id="MJXp-Span-1223" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1224" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mstyle" id="MJXp-Span-1225" style="color: blue;"><span class="MJXp-mo" id="MJXp-Span-1226" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1227">10</span><span class="MJXp-mo" id="MJXp-Span-1228" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1229">00</span><span class="MJXp-msubsup" id="MJXp-Span-1230"><span class="MJXp-mo" id="MJXp-Span-1231" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1232" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-msubsup" id="MJXp-Span-1233"><span class="MJXp-mo" id="MJXp-Span-1234" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1235" style="vertical-align: 0.5em;">∗</span></span></span><span class="MJXp-mstyle" id="MJXp-Span-1236" style="color: red;"><span class="MJXp-mn" id="MJXp-Span-1237">1</span></span><span class="MJXp-mstyle" id="MJXp-Span-1238" style="color: red;"><span class="MJXp-mn" id="MJXp-Span-1239">1</span></span><span class="MJXp-mstyle" id="MJXp-Span-1240" style="color: black;"><span class="MJXp-mo" id="MJXp-Span-1241" style="margin-left: 0em; margin-right: 0em;">(</span></span><span class="MJXp-mn" id="MJXp-Span-1242">00</span><span class="MJXp-msubsup" id="MJXp-Span-1243"><span class="MJXp-mo" id="MJXp-Span-1244" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1245" style="vertical-align: 0.5em;">+</span></span></span></span><script type="math/tex" id="MathJax-Element-147">0(00)^*\color{blue}{(10(00)^*)^*}\color{red}1\color{red}1\color{black}(00)^+</script> and the operation is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1246"><span class="MJXp-mstyle" id="MJXp-Span-1247" style="color: red;"><span class="MJXp-mn" id="MJXp-Span-1248">1</span></span><span class="MJXp-mstyle" id="MJXp-Span-1249" style="color: black;"><span class="MJXp-mo" id="MJXp-Span-1250" style="margin-left: 0.111em; margin-right: 0.111em;">?</span></span><span class="MJXp-mstyle" id="MJXp-Span-1251" style="color: red;"><span class="MJXp-mn" id="MJXp-Span-1252">1</span></span><span class="MJXp-mstyle" id="MJXp-Span-1253" style="color: black;"><span class="MJXp-mo" id="MJXp-Span-1254" style="margin-left: 0.111em; margin-right: 0.167em;">:</span></span><span class="MJXp-mn" id="MJXp-Span-1255">0</span></span></span><script type="math/tex" id="MathJax-Element-148">\color{red}1\color{black}?\color{red}1\color{black}:0</script> makes 1. Since it must ends with <code class="tt">00</code>, it becomes a string ending with <code class="tt">0</code> and every pair of adjacent 1's has odd 0's in between, which is a case mentioned before that has no solution.</p><p>In conclusion, it has a solution if and only of at least one of the two following conditions is met:</p> <ul>   <li>It ends with <code class="tt">1</code> but it is not <code class="tt">101</code>.</li>   <li>It has two adjacent 1's such that there are even 0's in between and the number of characters before the former <code class="tt">1</code> is even.</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">char</span><span class="pln"> s</span><span class="pun">[</span><span class="lit">333333</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">char</span><span class="pln"> val</span><span class="pun">(</span><span class="kwd">char</span><span class="pln"> x</span><span class="pun">,</span><span class="kwd">char</span><span class="pln"> y</span><span class="pun">,</span><span class="kwd">char</span><span class="pln"> z</span><span class="pun">){</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> x</span><span class="pun">==</span><span class="str">'1'</span><span class="pun">?</span><span class="pln">y</span><span class="pun">:</span><span class="pln">z</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
std</span><span class="pun">::</span><span class="pln">pair</span><span class="pun">&lt;</span><span class="pln">std</span><span class="pun">::</span><span class="kwd">string</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">&gt;</span><span class="pln"> fold</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">){</span><span class="pln">
	std</span><span class="pun">::</span><span class="kwd">string</span><span class="pln"> str</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">char</span><span class="pln"> v</span><span class="pun">=</span><span class="pln">s</span><span class="pun">[</span><span class="pln">r</span><span class="pun">];</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">l</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">r</span><span class="pun">;</span><span class="pln">i</span><span class="pun">+=</span><span class="lit">2</span><span class="pun">){</span><span class="pln">
		str</span><span class="pun">+=</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
		str</span><span class="pun">+=</span><span class="str">'?'</span><span class="pun">;</span><span class="pln">
		str</span><span class="pun">+=</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
		str</span><span class="pun">+=</span><span class="str">':'</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	str</span><span class="pun">+=</span><span class="pln">s</span><span class="pun">[</span><span class="pln">r</span><span class="pun">];</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">r</span><span class="pun">-</span><span class="lit">2</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&gt;=</span><span class="pln">l</span><span class="pun">;</span><span class="pln">i</span><span class="pun">-=</span><span class="lit">2</span><span class="pun">){</span><span class="pln">
		v</span><span class="pun">=</span><span class="pln">val</span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">],</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> std</span><span class="pun">::</span><span class="pln">make_pair</span><span class="pun">(</span><span class="pln">str</span><span class="pun">,</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">(){</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,&amp;</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
	n</span><span class="pun">=</span><span class="lit">2</span><span class="pun">*</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%s"</span><span class="pun">,</span><span class="pln">s</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">last</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">){</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]==</span><span class="str">'1'</span><span class="pun">&amp;&amp;</span><span class="kwd">last</span><span class="pun">&gt;</span><span class="lit">0</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">i</span><span class="pun">%</span><span class="lit">2</span><span class="pun">==</span><span class="lit">0</span><span class="pun">&amp;&amp;</span><span class="kwd">last</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">){</span><span class="pln">
				puts</span><span class="pun">(</span><span class="str">"Yes"</span><span class="pun">);</span><span class="pln">
				std</span><span class="pun">::</span><span class="kwd">string</span><span class="pln"> s4</span><span class="pun">=</span><span class="pln">fold</span><span class="pun">(</span><span class="kwd">last</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">i</span><span class="pun">).</span><span class="pln">first</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">auto</span><span class="pln"> tmp</span><span class="pun">=</span><span class="pln">fold</span><span class="pun">(</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
				std</span><span class="pun">::</span><span class="kwd">string</span><span class="pln"> s5</span><span class="pun">=</span><span class="pln">tmp</span><span class="pun">.</span><span class="pln">first</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">char</span><span class="pln"> v5</span><span class="pun">=</span><span class="pln">tmp</span><span class="pun">.</span><span class="pln">second</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">last</span><span class="pun">==</span><span class="lit">1</span><span class="pun">){</span><span class="pln">
					printf</span><span class="pun">(</span><span class="str">"1?(%s):(%s)\n"</span><span class="pun">,</span><span class="pln">s4</span><span class="pun">.</span><span class="pln">c_str</span><span class="pun">(),</span><span class="pln">s5</span><span class="pun">.</span><span class="pln">c_str</span><span class="pun">());</span><span class="pln">
					</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				tmp</span><span class="pun">=</span><span class="pln">fold</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="kwd">last</span><span class="pun">-</span><span class="lit">2</span><span class="pun">);</span><span class="pln">
				std</span><span class="pun">::</span><span class="kwd">string</span><span class="pln"> s1</span><span class="pun">=</span><span class="pln">tmp</span><span class="pun">.</span><span class="pln">first</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">char</span><span class="pln"> v1</span><span class="pun">=</span><span class="pln">tmp</span><span class="pun">.</span><span class="pln">second</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">v1</span><span class="pun">==</span><span class="str">'1'</span><span class="pun">){</span><span class="pln">
					printf</span><span class="pun">(</span><span class="str">"(%s)?(%c?1:(%s)):(%s)\n"</span><span class="pun">,</span><span class="pln">s1</span><span class="pun">.</span><span class="pln">c_str</span><span class="pun">(),</span><span class="pln">s</span><span class="pun">[</span><span class="kwd">last</span><span class="pun">-</span><span class="lit">1</span><span class="pun">],</span><span class="pln">s4</span><span class="pun">.</span><span class="pln">c_str</span><span class="pun">(),</span><span class="pln">s5</span><span class="pun">.</span><span class="pln">c_str</span><span class="pun">());</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">else</span><span class="pun">{</span><span class="pln">
					printf</span><span class="pun">(</span><span class="str">"((%s)?%c:1)?(%s):(%s)\n"</span><span class="pun">,</span><span class="pln">s1</span><span class="pun">.</span><span class="pln">c_str</span><span class="pun">(),</span><span class="pln">s</span><span class="pun">[</span><span class="kwd">last</span><span class="pun">-</span><span class="lit">1</span><span class="pun">],</span><span class="pln">s4</span><span class="pun">.</span><span class="pln">c_str</span><span class="pun">(),</span><span class="pln">s5</span><span class="pun">.</span><span class="pln">c_str</span><span class="pun">());</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]==</span><span class="str">'1'</span><span class="pun">){</span><span class="pln">
			</span><span class="kwd">last</span><span class="pun">=</span><span class="pln">i</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]==</span><span class="str">'1'</span><span class="pun">&amp;&amp;</span><span class="pln">std</span><span class="pun">::</span><span class="kwd">string</span><span class="pun">(</span><span class="pln">s</span><span class="pun">+</span><span class="lit">1</span><span class="pun">)!=</span><span class="str">"101"</span><span class="pun">){</span><span class="pln">
		puts</span><span class="pun">(</span><span class="str">"Yes"</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">auto</span><span class="pln"> left</span><span class="pun">=</span><span class="pln">s</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]==</span><span class="str">'0'</span><span class="pun">?</span><span class="pln">fold</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="lit">1</span><span class="pun">):</span><span class="pln">fold</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="lit">3</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">auto</span><span class="pln"> mid</span><span class="pun">=</span><span class="pln">s</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]==</span><span class="str">'0'</span><span class="pun">?</span><span class="pln">fold</span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">):</span><span class="pln">fold</span><span class="pun">(</span><span class="lit">4</span><span class="pun">,</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"(%s)?(%s):1\n"</span><span class="pun">,</span><span class="pln">left</span><span class="pun">.</span><span class="pln">first</span><span class="pun">.</span><span class="pln">c_str</span><span class="pun">(),</span><span class="pln">mid</span><span class="pun">.</span><span class="pln">first</span><span class="pun">.</span><span class="pln">c_str</span><span class="pun">());</span><span class="pln">
		</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	puts</span><span class="pun">(</span><span class="str">"No"</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(){</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,&amp;</span><span class="pln">T</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">T</span><span class="pun">--){</span><span class="pln">
		solve</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2089/problem/E" title="Codeforces Round 1012 (Div. 1)">2089E - Black Cat Collapse</a> <br> Idea: <a class="rated-user user-orange" href="https://codeforces.com/profile/abruce" title="International Master abruce">abruce</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Firstly, consider a classical dp to calculate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1256"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1257">d</span><span class="MJXp-msubsup" id="MJXp-Span-1258"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1259" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1260" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1261">u</span><span class="MJXp-mo" id="MJXp-Span-1262">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263">k</span></span></span></span></span><script type="math/tex" id="MathJax-Element-149">dp_{u,k}</script> as the number of delete <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1264"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">k</span></span></span><script type="math/tex" id="MathJax-Element-150">k</script> vertices in subtree <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1266"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1267">u</span></span></span><script type="math/tex" id="MathJax-Element-151">u</script> without considering deleting vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1268"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269">n</span><span class="MJXp-mo" id="MJXp-Span-1270" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271">i</span><span class="MJXp-mo" id="MJXp-Span-1272" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1273">1</span></span></span><script type="math/tex" id="MathJax-Element-152">n-i+1</script> everyday. This is trivial.</p><p>Then, due to the existence of an “automatic deletion” process, we cannot view the selected points within the subtree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1274"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">u</span></span></span><script type="math/tex" id="MathJax-Element-153">u</script> as operations with only relative order, because they may be illegal. However, we consider the final operation sequence, putting the vertex chosen on the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1276"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277">i</span></span></span><script type="math/tex" id="MathJax-Element-154">i</script> th day in the position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279">n</span><span class="MJXp-mo" id="MJXp-Span-1280" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1281">i</span><span class="MJXp-mo" id="MJXp-Span-1282" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1283">1</span></span></span><script type="math/tex" id="MathJax-Element-155">n-i+1</script>. That is, if we firstly choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1284"><span class="MJXp-mn" id="MJXp-Span-1285">4</span></span></span><script type="math/tex" id="MathJax-Element-156">4</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1286"><span class="MJXp-mn" id="MJXp-Span-1287">3</span></span></span><script type="math/tex" id="MathJax-Element-157">3</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1288"><span class="MJXp-mn" id="MJXp-Span-1289">1</span></span></span><script type="math/tex" id="MathJax-Element-158">1</script>, it will be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1290"><span class="MJXp-mn" id="MJXp-Span-1291">0431</span></span></span><script type="math/tex" id="MathJax-Element-159">0431</script>. Then, one vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1292"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1293">u</span></span></span><script type="math/tex" id="MathJax-Element-160">u</script> must be put in position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1294"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1295">u</span></span></span><script type="math/tex" id="MathJax-Element-161">u</script> or later.</p><p>Then, we find that for the subtree of vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1296"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297">u</span></span></span><script type="math/tex" id="MathJax-Element-162">u</script> with DFS order interval <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1298"><span class="MJXp-mo" id="MJXp-Span-1299" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">l</span><span class="MJXp-mo" id="MJXp-Span-1301" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302">r</span><span class="MJXp-mo" id="MJXp-Span-1303" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-163">[l,r]</script>, all vertices can't be put in position before <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1304"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1305">l</span></span></span><script type="math/tex" id="MathJax-Element-164">l</script>, and it is always legal to put in position after <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307">r</span></span></span><script type="math/tex" id="MathJax-Element-165">r</script> if parent-child relations are satisfied.</p><p>So we consider a dp <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1308"><span class="MJXp-msubsup" id="MJXp-Span-1309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1310" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1311" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312">u</span><span class="MJXp-mo" id="MJXp-Span-1313">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1314">i</span><span class="MJXp-mo" id="MJXp-Span-1315">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316">j</span><span class="MJXp-mo" id="MJXp-Span-1317">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1318">k</span></span></span></span></span><script type="math/tex" id="MathJax-Element-166">f_{u,i,j,k}</script> which represents that the subtree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1319"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1320">u</span></span></span><script type="math/tex" id="MathJax-Element-167">u</script> leaves position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1321"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322">i</span></span></span><script type="math/tex" id="MathJax-Element-168">i</script> for ancestors (which means nothing can be placed at position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324">i</span></span></span><script type="math/tex" id="MathJax-Element-169">i</script> or before, and if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1325"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1326">i</span><span class="MJXp-mo" id="MJXp-Span-1327" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1328">0</span></span></span><script type="math/tex" id="MathJax-Element-170">i=0</script>, then nothing is left for ancestors), there are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330">j</span></span></span><script type="math/tex" id="MathJax-Element-171">j</script> empty spaces (not including the one left for ancestors), and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1331"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332">k</span></span></span><script type="math/tex" id="MathJax-Element-172">k</script> vertices need to be put into positions after the subtree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1333"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334">u</span></span></span><script type="math/tex" id="MathJax-Element-173">u</script>. In the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1336">i</span><span class="MJXp-mo" id="MJXp-Span-1337" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1338">0</span></span></span><script type="math/tex" id="MathJax-Element-174">i=0</script> case, we merge subtrees, and the subtree with smaller DFS order can put some backward operations into the space of the subtree with bigger DFS order.</p><p>Specifically, consider the sons of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1339"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1340">u</span></span></span><script type="math/tex" id="MathJax-Element-175">u</script> enumerated in reverse order of DFS, and the son is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1341"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342">v</span></span></span><script type="math/tex" id="MathJax-Element-176">v</script>. Then enumerate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1344">w</span></span></span><script type="math/tex" id="MathJax-Element-177">w</script> as how many backward operations of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1345"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1346">v</span></span></span><script type="math/tex" id="MathJax-Element-178">v</script> will fill in space of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1347"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1348">u</span></span></span><script type="math/tex" id="MathJax-Element-179">u</script>. The transition is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1349"><span class="MJXp-msubsup" id="MJXp-Span-1350"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1351" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1352" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353">u</span><span class="MJXp-mo" id="MJXp-Span-1354">,</span><span class="MJXp-mn" id="MJXp-Span-1355">0</span><span class="MJXp-mo" id="MJXp-Span-1356">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1357">j</span><span class="MJXp-mo" id="MJXp-Span-1358">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359">j</span><span class="MJXp-mn" id="MJXp-Span-1360">1</span><span class="MJXp-mo" id="MJXp-Span-1361">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1362">w</span><span class="MJXp-mo" id="MJXp-Span-1363">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1364">k</span><span class="MJXp-mo" id="MJXp-Span-1365">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366">k</span><span class="MJXp-mn" id="MJXp-Span-1367">1</span><span class="MJXp-mo" id="MJXp-Span-1368">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1369">w</span></span></span><span class="MJXp-mo" id="MJXp-Span-1370" style="margin-left: 0.333em; margin-right: 0.333em;">←</span><span class="MJXp-msubsup" id="MJXp-Span-1371"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1372" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1373" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1374">u</span><span class="MJXp-mo" id="MJXp-Span-1375">,</span><span class="MJXp-mn" id="MJXp-Span-1376">0</span><span class="MJXp-mo" id="MJXp-Span-1377">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1378">j</span><span class="MJXp-mo" id="MJXp-Span-1379">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380">j</span><span class="MJXp-mn" id="MJXp-Span-1381">1</span><span class="MJXp-mo" id="MJXp-Span-1382">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383">w</span><span class="MJXp-mo" id="MJXp-Span-1384">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385">k</span><span class="MJXp-mo" id="MJXp-Span-1386">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1387">k</span><span class="MJXp-mn" id="MJXp-Span-1388">1</span><span class="MJXp-mo" id="MJXp-Span-1389">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1390">w</span></span></span><span class="MJXp-mo" id="MJXp-Span-1391" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1392"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1393" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1394" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1395">u</span><span class="MJXp-mo" id="MJXp-Span-1396">,</span><span class="MJXp-mn" id="MJXp-Span-1397">0</span><span class="MJXp-mo" id="MJXp-Span-1398">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1399">j</span><span class="MJXp-mo" id="MJXp-Span-1400">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1401">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1402" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-msubsup" id="MJXp-Span-1403"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1405" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1406">v</span><span class="MJXp-mo" id="MJXp-Span-1407">,</span><span class="MJXp-mn" id="MJXp-Span-1408">0</span><span class="MJXp-mo" id="MJXp-Span-1409">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1410">j</span><span class="MJXp-mn" id="MJXp-Span-1411">1</span><span class="MJXp-mo" id="MJXp-Span-1412">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">k</span><span class="MJXp-mn" id="MJXp-Span-1414">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1415" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mrow" id="MJXp-Span-1416"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1417"><span class="MJXp-mstyle" id="MJXp-Span-1418"><span class="MJXp-mrow" id="MJXp-Span-1419"><span class="MJXp-mo" id="MJXp-Span-1420" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1421"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1422">j</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1423">w</span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1424"><span class="MJXp-mstyle" id="MJXp-Span-1425"><span class="MJXp-mrow" id="MJXp-Span-1426"><span class="MJXp-mo" id="MJXp-Span-1427" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1428" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mrow" id="MJXp-Span-1429"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1430"><span class="MJXp-mstyle" id="MJXp-Span-1431"><span class="MJXp-mrow" id="MJXp-Span-1432"><span class="MJXp-mo" id="MJXp-Span-1433" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1434"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1435">k</span><span class="MJXp-mo" id="MJXp-Span-1436">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1437">k</span><span class="MJXp-mn" id="MJXp-Span-1438">1</span><span class="MJXp-mo" id="MJXp-Span-1439">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1440">w</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1441">k</span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1442"><span class="MJXp-mstyle" id="MJXp-Span-1443"><span class="MJXp-mrow" id="MJXp-Span-1444"><span class="MJXp-mo" id="MJXp-Span-1445" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-180">f_{u,0,j+j1-w,k+k1-w}\leftarrow f_{u,0,j+j1-w,k+k1-w}+f_{u,0,j,k}\times f_{v,0,j1,k1}\times \binom{j}{w}\times\binom{k+k1-w}{k}</script>. That is, after putting <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1447">w</span></span></span><script type="math/tex" id="MathJax-Element-181">w</script> operations from backward operations of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1449">v</span></span></span><script type="math/tex" id="MathJax-Element-182">v</script> into spaces of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1450"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451">u</span></span></span><script type="math/tex" id="MathJax-Element-183">u</script>, we merge the spaces of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1452"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1453">u</span></span></span><script type="math/tex" id="MathJax-Element-184">u</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1454"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1455">v</span></span></span><script type="math/tex" id="MathJax-Element-185">v</script>, then the backward operations of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1456"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1457">u</span></span></span><script type="math/tex" id="MathJax-Element-186">u</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1458"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1459">v</span></span></span><script type="math/tex" id="MathJax-Element-187">v</script>.</p><p>For <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1460"><span class="MJXp-msubsup" id="MJXp-Span-1461"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1462" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1463" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464">v</span><span class="MJXp-mo" id="MJXp-Span-1465">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1466">i</span><span class="MJXp-mo" id="MJXp-Span-1467">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1468">j</span><span class="MJXp-mo" id="MJXp-Span-1469">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1470">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1471" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1472">i</span><span class="MJXp-mo" id="MJXp-Span-1473" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mn" id="MJXp-Span-1474">0</span><span class="MJXp-mo" id="MJXp-Span-1475" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-188">f_{v,i,j,k}(i\neq 0)</script>, it won't interfere with the transition with its following siblings. And for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1476"><span class="MJXp-msubsup" id="MJXp-Span-1477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1478" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1479" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480">u</span><span class="MJXp-mo" id="MJXp-Span-1481">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482">i</span><span class="MJXp-mo" id="MJXp-Span-1483">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1484">j</span><span class="MJXp-mo" id="MJXp-Span-1485">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1486">k</span></span></span></span></span><script type="math/tex" id="MathJax-Element-189">f_{u,i,j,k}</script>,any operations from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1487"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1488">v</span></span></span><script type="math/tex" id="MathJax-Element-190">v</script> can't put into the subtree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1489"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490">u</span></span></span><script type="math/tex" id="MathJax-Element-191">u</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1491"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1492">v</span></span></span><script type="math/tex" id="MathJax-Element-192">v</script>, so we only need to merge backward operations of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1493"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1494">u</span></span></span><script type="math/tex" id="MathJax-Element-193">u</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1495"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1496">v</span></span></span><script type="math/tex" id="MathJax-Element-194">v</script>.</p><p>After finishing the transition of subtrees, we consider where to put <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1497"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1498">u</span></span></span><script type="math/tex" id="MathJax-Element-195">u</script>.</p> <ul>   <li>If we don't put <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1499"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500">u</span></span></span><script type="math/tex" id="MathJax-Element-196">u</script>, there will be one more space, and we can consider whether to leave it for ancestors if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1502">i</span><span class="MJXp-mo" id="MJXp-Span-1503" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1504">0</span></span></span><script type="math/tex" id="MathJax-Element-197">i=0</script>.That is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1505"><span class="MJXp-msubsup" id="MJXp-Span-1506"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1507" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1508" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1509">u</span><span class="MJXp-mo" id="MJXp-Span-1510">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1511">i</span><span class="MJXp-mo" id="MJXp-Span-1512">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1513">j</span><span class="MJXp-mo" id="MJXp-Span-1514">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1515">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1516" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-msubsup" id="MJXp-Span-1517"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1518" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1519" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1520">u</span><span class="MJXp-mo" id="MJXp-Span-1521">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1522">i</span><span class="MJXp-mo" id="MJXp-Span-1523">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1524">j</span><span class="MJXp-mo" id="MJXp-Span-1525">+</span><span class="MJXp-mn" id="MJXp-Span-1526">1</span><span class="MJXp-mo" id="MJXp-Span-1527">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1528">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1529" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1530"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1531" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1532" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1533">u</span><span class="MJXp-mo" id="MJXp-Span-1534">,</span><span class="MJXp-mn" id="MJXp-Span-1535">0</span><span class="MJXp-mo" id="MJXp-Span-1536">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537">j</span><span class="MJXp-mo" id="MJXp-Span-1538">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1539">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1540" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-msubsup" id="MJXp-Span-1541"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1542" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1543" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1544">u</span><span class="MJXp-mo" id="MJXp-Span-1545">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1546">u</span><span class="MJXp-mo" id="MJXp-Span-1547">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548">j</span><span class="MJXp-mo" id="MJXp-Span-1549">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1550">k</span></span></span></span></span><script type="math/tex" id="MathJax-Element-198">f_{u,i,j,k}\rightarrow f_{u,i,j+1,k},f_{u,0,j,k}\rightarrow f_{u,u,j,k}</script>.</li>   <li>We put <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1551"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1552">u</span></span></span><script type="math/tex" id="MathJax-Element-199">u</script> into the position left for ancestors, that is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1553"><span class="MJXp-msubsup" id="MJXp-Span-1554"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1555" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1556" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1557">u</span><span class="MJXp-mo" id="MJXp-Span-1558">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1559">i</span><span class="MJXp-mo" id="MJXp-Span-1560">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1561">j</span><span class="MJXp-mo" id="MJXp-Span-1562">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1563">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1564" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-msubsup" id="MJXp-Span-1565"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1566" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1567" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1568">u</span><span class="MJXp-mo" id="MJXp-Span-1569">,</span><span class="MJXp-mn" id="MJXp-Span-1570">0</span><span class="MJXp-mo" id="MJXp-Span-1571">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1572">j</span><span class="MJXp-mo" id="MJXp-Span-1573">+</span><span class="MJXp-mn" id="MJXp-Span-1574">1</span><span class="MJXp-mo" id="MJXp-Span-1575">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1576">k</span></span></span></span></span><script type="math/tex" id="MathJax-Element-200">f_{u,i,j,k}\rightarrow f_{u,0,j+1,k}</script>. And we can leave another position for ancestors of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1577"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1578">u</span></span></span><script type="math/tex" id="MathJax-Element-201">u</script>, that is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1579"><span class="MJXp-msubsup" id="MJXp-Span-1580"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1581" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1582" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1583">u</span><span class="MJXp-mo" id="MJXp-Span-1584">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1585">i</span><span class="MJXp-mo" id="MJXp-Span-1586">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1587">j</span><span class="MJXp-mo" id="MJXp-Span-1588">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1589">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1590" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-msubsup" id="MJXp-Span-1591"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1592" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1593" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1594">u</span><span class="MJXp-mo" id="MJXp-Span-1595">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1596">i</span><span class="MJXp-mn" id="MJXp-Span-1597">1</span><span class="MJXp-mo" id="MJXp-Span-1598">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1599">j</span><span class="MJXp-mo" id="MJXp-Span-1600">+</span><span class="MJXp-mn" id="MJXp-Span-1601">1</span><span class="MJXp-mo" id="MJXp-Span-1602">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1603">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1604" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1605">i</span><span class="MJXp-mn" id="MJXp-Span-1606">1</span><span class="MJXp-mo" id="MJXp-Span-1607" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1608">i</span><span class="MJXp-mo" id="MJXp-Span-1609" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-202">f_{u,i,j,k}\rightarrow f_{u,i1,j+1,k}(i1<i)</script>.</li>   <li>We put <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1610"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1611">u</span></span></span><script type="math/tex" id="MathJax-Element-203">u</script> into position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1612"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1613">u</span></span></span><script type="math/tex" id="MathJax-Element-204">u</script>, in that case, we can't leave position for ancestors of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1614"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1615">u</span></span></span><script type="math/tex" id="MathJax-Element-205">u</script>, that is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1616"><span class="MJXp-msubsup" id="MJXp-Span-1617"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1618" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1619" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1620">u</span><span class="MJXp-mo" id="MJXp-Span-1621">,</span><span class="MJXp-mn" id="MJXp-Span-1622">0</span><span class="MJXp-mo" id="MJXp-Span-1623">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1624">j</span><span class="MJXp-mo" id="MJXp-Span-1625">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1626">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1627" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-msubsup" id="MJXp-Span-1628"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1629" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1630" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631">u</span><span class="MJXp-mo" id="MJXp-Span-1632">,</span><span class="MJXp-mn" id="MJXp-Span-1633">0</span><span class="MJXp-mo" id="MJXp-Span-1634">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1635">j</span><span class="MJXp-mo" id="MJXp-Span-1636">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1637">k</span></span></span></span></span><script type="math/tex" id="MathJax-Element-206">f_{u,0,j,k}\rightarrow f_{u,0,j,k}</script>.</li>   <li>We put <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1638"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1639">u</span></span></span><script type="math/tex" id="MathJax-Element-207">u</script> backward, then we can't put anything in the subtree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1640"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1641">u</span></span></span><script type="math/tex" id="MathJax-Element-208">u</script>, but we can leave position for ancestors of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1642"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1643">u</span></span></span><script type="math/tex" id="MathJax-Element-209">u</script>, that is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1644"><span class="MJXp-msubsup" id="MJXp-Span-1645"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1646" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1647" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1648">u</span><span class="MJXp-mo" id="MJXp-Span-1649">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1650">i</span><span class="MJXp-mo" id="MJXp-Span-1651">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1652">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1653">i</span><span class="MJXp-msubsup" id="MJXp-Span-1654"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1655" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1656" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-1657">−</span><span class="MJXp-mn" id="MJXp-Span-1658">2</span><span class="MJXp-mo" id="MJXp-Span-1659">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1660">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1661" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-msubsup" id="MJXp-Span-1662"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1663" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1664" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1665">u</span><span class="MJXp-mo" id="MJXp-Span-1666">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1667">i</span><span class="MJXp-mo" id="MJXp-Span-1668">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1669">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1670">i</span><span class="MJXp-msubsup" id="MJXp-Span-1671"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1672" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1673" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-1674">−</span><span class="MJXp-mn" id="MJXp-Span-1675">1</span><span class="MJXp-mo" id="MJXp-Span-1676">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1677">k</span><span class="MJXp-mo" id="MJXp-Span-1678">+</span><span class="MJXp-mn" id="MJXp-Span-1679">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1680" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1681"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1682" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1683" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1684">u</span><span class="MJXp-mo" id="MJXp-Span-1685">,</span><span class="MJXp-mn" id="MJXp-Span-1686">0</span><span class="MJXp-mo" id="MJXp-Span-1687">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1688">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1689">i</span><span class="MJXp-msubsup" id="MJXp-Span-1690"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1691" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1692" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-1693">−</span><span class="MJXp-mn" id="MJXp-Span-1694">1</span><span class="MJXp-mo" id="MJXp-Span-1695">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-1697" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-msubsup" id="MJXp-Span-1698"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1699" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1700" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1701">u</span><span class="MJXp-mo" id="MJXp-Span-1702">,</span><span class="MJXp-mn" id="MJXp-Span-1703">0</span><span class="MJXp-mo" id="MJXp-Span-1704">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1705">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1706">i</span><span class="MJXp-msubsup" id="MJXp-Span-1707"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1708" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1709" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-1710">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1711">k</span><span class="MJXp-mo" id="MJXp-Span-1712">+</span><span class="MJXp-mn" id="MJXp-Span-1713">1</span></span></span></span></span><script type="math/tex" id="MathJax-Element-210">f_{u,i,siz_u-2,k}\rightarrow f_{u,i,siz_u-1,k+1},f_{u,0,siz_u-1,k}\rightarrow f_{u,0,siz_u,k+1}</script>.</li> </ul><p>The answer for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1714"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1715">i</span></span></span><script type="math/tex" id="MathJax-Element-211">i</script> operations is just we leave position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1716"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1717">n</span><span class="MJXp-mo" id="MJXp-Span-1718" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1719">i</span><span class="MJXp-mo" id="MJXp-Span-1720" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1721">1</span></span></span><script type="math/tex" id="MathJax-Element-212">n-i+1</script> for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1722"><span class="MJXp-mn" id="MJXp-Span-1723">1</span></span></span><script type="math/tex" id="MathJax-Element-213">1</script>, and there are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1724"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1725">n</span><span class="MJXp-mo" id="MJXp-Span-1726" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727">i</span></span></span><script type="math/tex" id="MathJax-Element-214">n-i</script> spaces (therefore the spaces are before <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1729">n</span><span class="MJXp-mo" id="MJXp-Span-1730" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1731">i</span><span class="MJXp-mo" id="MJXp-Span-1732" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1733">1</span></span></span><script type="math/tex" id="MathJax-Element-215">n-i+1</script>) and no backward operations.</p><p>The time complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1735">O</span><span class="MJXp-mo" id="MJXp-Span-1736" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-1737" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-msubsup" id="MJXp-Span-1738"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1739" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1740" style="vertical-align: 0.5em;">5</span></span><span class="MJXp-mo" id="MJXp-Span-1741" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-216">O(\sum n^5)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> read</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">=</span><span class="lit">0</span><span class="pun">,</span><span class="pln">f</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">char</span><span class="pln"> c</span><span class="pun">=</span><span class="pln">getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">c</span><span class="pun">&lt;</span><span class="str">'0'</span><span class="pun">||</span><span class="pln">c</span><span class="pun">&gt;</span><span class="str">'9'</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">c</span><span class="pun">==</span><span class="str">'-'</span><span class="pun">)</span><span class="pln">f</span><span class="pun">=-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		c</span><span class="pun">=</span><span class="pln">getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">c</span><span class="pun">&gt;=</span><span class="str">'0'</span><span class="pun">&amp;&amp;</span><span class="pln">c</span><span class="pun">&lt;=</span><span class="str">'9'</span><span class="pun">)</span><span class="pln">x</span><span class="pun">=</span><span class="pln">x</span><span class="pun">*</span><span class="lit">10</span><span class="pun">+</span><span class="pln">c</span><span class="pun">-</span><span class="str">'0'</span><span class="pun">,</span><span class="pln">c</span><span class="pun">=</span><span class="pln">getchar</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> x</span><span class="pun">*</span><span class="pln">f</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">namespace</span><span class="pln"> tokido_saya </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> maxn</span><span class="pun">=</span><span class="lit">81</span><span class="pun">,</span><span class="pln">mod</span><span class="pun">=</span><span class="lit">998244353</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">typedef</span><span class="pln"> vector</span><span class="str">&lt;int&gt;</span><span class="pun">::</span><span class="pln">iterator iter</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln">lp</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">],</span><span class="pln">rp</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">],</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">],</span><span class="pln">t</span><span class="pun">;</span><span class="pln">
	vector</span><span class="str">&lt;int&gt;</span><span class="pln"> v</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">];</span><span class="pln">
	ll f</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">][</span><span class="pln">maxn</span><span class="pun">][</span><span class="pln">maxn</span><span class="pun">][</span><span class="pln">maxn</span><span class="pun">],</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">][</span><span class="pln">maxn</span><span class="pun">],</span><span class="pln">fac</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">],</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">];</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> zc</span><span class="pun">[</span><span class="pln">maxn</span><span class="pun">][</span><span class="pln">maxn</span><span class="pun">][</span><span class="pln">maxn</span><span class="pun">][</span><span class="pln">maxn</span><span class="pun">];</span><span class="pln">
	ll qpow</span><span class="pun">(</span><span class="pln">ll x</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		ll w</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">y</span><span class="pun">)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">y</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln">w</span><span class="pun">=</span><span class="pln">w</span><span class="pun">*</span><span class="pln">x</span><span class="pun">%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
			x</span><span class="pun">=</span><span class="pln">x</span><span class="pun">*</span><span class="pln">x</span><span class="pun">%</span><span class="pln">mod</span><span class="pun">,</span><span class="pln">y</span><span class="pun">&gt;&gt;=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> w</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	ll C</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">y</span><span class="pun">&lt;</span><span class="lit">0</span><span class="pun">||</span><span class="pln">y</span><span class="pun">&gt;</span><span class="pln">x</span><span class="pun">)</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> fac</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]*</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">x</span><span class="pun">-</span><span class="pln">y</span><span class="pun">]%</span><span class="pln">mod</span><span class="pun">*</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">y</span><span class="pun">]%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">void</span><span class="pln"> dfs1</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		lp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]=</span><span class="pln">rp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]=</span><span class="pln">u</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">iter it</span><span class="pun">=</span><span class="pln">v</span><span class="pun">[</span><span class="pln">u</span><span class="pun">].</span><span class="kwd">begin</span><span class="pun">();</span><span class="pln">it</span><span class="pun">!=</span><span class="pln">v</span><span class="pun">[</span><span class="pln">u</span><span class="pun">].</span><span class="kwd">end</span><span class="pun">();</span><span class="pln">it</span><span class="pun">++)</span><span class="pln">dfs1</span><span class="pun">(*</span><span class="pln">it</span><span class="pun">),</span><span class="pln">rp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]=</span><span class="pln">max</span><span class="pun">(</span><span class="pln">rp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">],</span><span class="pln">rp</span><span class="pun">[*</span><span class="pln">it</span><span class="pun">]);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">void</span><span class="pln"> dfs2</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">,</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">iter it</span><span class="pun">=</span><span class="pln">v</span><span class="pun">[</span><span class="pln">u</span><span class="pun">].</span><span class="kwd">begin</span><span class="pun">();</span><span class="pln">it</span><span class="pun">!=</span><span class="pln">v</span><span class="pun">[</span><span class="pln">u</span><span class="pun">].</span><span class="kwd">end</span><span class="pun">();</span><span class="pln">it</span><span class="pun">++)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">int</span><span class="pln"> v</span><span class="pun">=*</span><span class="pln">it</span><span class="pun">;</span><span class="pln">
			dfs2</span><span class="pun">(</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln">i</span><span class="pun">&gt;=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">--)</span><span class="pln">
				</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln">j</span><span class="pun">;</span><span class="pln">j</span><span class="pun">--)</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">+</span><span class="pln">j</span><span class="pun">]=(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">+</span><span class="pln">j</span><span class="pun">]+</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]*</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">v</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]%</span><span class="pln">mod</span><span class="pun">*</span><span class="pln">C</span><span class="pun">(</span><span class="pln">i</span><span class="pun">+</span><span class="pln">j</span><span class="pun">,</span><span class="pln">j</span><span class="pun">))%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j1</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j1</span><span class="pun">&lt;=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln">j1</span><span class="pun">++)</span><span class="pln">
				</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k1</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">k1</span><span class="pun">&lt;=</span><span class="pln">min</span><span class="pun">(</span><span class="pln">j1</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]);</span><span class="pln">k1</span><span class="pun">++)</span><span class="pln">
				</span><span class="pun">{</span><span class="pln">
					memset</span><span class="pun">(</span><span class="pln">zc</span><span class="pun">[</span><span class="pln">j1</span><span class="pun">][</span><span class="pln">k1</span><span class="pun">],</span><span class="lit">0</span><span class="pun">,</span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">zc</span><span class="pun">[</span><span class="pln">j1</span><span class="pun">][</span><span class="pln">k1</span><span class="pun">]));</span><span class="pln">
					</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
						</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">k</span><span class="pun">&lt;=</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">k</span><span class="pun">++)</span><span class="pln">
							</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> w</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">w</span><span class="pun">&lt;=</span><span class="pln">min</span><span class="pun">(</span><span class="pln">k1</span><span class="pun">,</span><span class="pln">j</span><span class="pun">);</span><span class="pln">w</span><span class="pun">++)</span><span class="pln">zc</span><span class="pun">[</span><span class="pln">j1</span><span class="pun">][</span><span class="pln">k1</span><span class="pun">][</span><span class="pln">j</span><span class="pun">+</span><span class="pln">j1</span><span class="pun">-</span><span class="pln">w</span><span class="pun">][</span><span class="pln">k</span><span class="pun">+</span><span class="pln">k1</span><span class="pun">-</span><span class="pln">w</span><span class="pun">]=(</span><span class="pln">zc</span><span class="pun">[</span><span class="pln">j1</span><span class="pun">][</span><span class="pln">k1</span><span class="pun">][</span><span class="pln">j</span><span class="pun">+</span><span class="pln">j1</span><span class="pun">-</span><span class="pln">w</span><span class="pun">][</span><span class="pln">k</span><span class="pun">+</span><span class="pln">k1</span><span class="pun">-</span><span class="pln">w</span><span class="pun">]+</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">]*</span><span class="pln">C</span><span class="pun">(</span><span class="pln">j</span><span class="pun">,</span><span class="pln">w</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">*</span><span class="pln">C</span><span class="pun">(</span><span class="pln">k</span><span class="pun">+</span><span class="pln">k1</span><span class="pun">-</span><span class="pln">w</span><span class="pun">,</span><span class="pln">k</span><span class="pun">))%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">	
			memset</span><span class="pun">(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">],</span><span class="lit">0</span><span class="pun">,</span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]));</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln">j</span><span class="pun">++)</span><span class="pln">
				</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">k</span><span class="pun">&lt;=</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">k</span><span class="pun">++)</span><span class="pln">
					</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j1</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j1</span><span class="pun">&lt;=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]+</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln">j1</span><span class="pun">++)</span><span class="pln">
						</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k1</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">k1</span><span class="pun">&lt;=</span><span class="pln">min</span><span class="pun">(</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]+</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">],</span><span class="pln">j1</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">k1</span><span class="pun">++)</span><span class="pln">
							</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">zc</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">][</span><span class="pln">j1</span><span class="pun">][</span><span class="pln">k1</span><span class="pun">])</span><span class="pln">
							</span><span class="pun">{</span><span class="pln">
								</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> w</span><span class="pun">=</span><span class="pln">zc</span><span class="pun">[</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">][</span><span class="pln">j1</span><span class="pun">][</span><span class="pln">k1</span><span class="pun">];</span><span class="pln">
								f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="pln">j1</span><span class="pun">][</span><span class="pln">k1</span><span class="pun">]=(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="pln">j1</span><span class="pun">][</span><span class="pln">k1</span><span class="pun">]+</span><span class="pln">f</span><span class="pun">[</span><span class="pln">v</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">]*</span><span class="pln">w</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
								</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">lp</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">rp</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j1</span><span class="pun">][</span><span class="pln">k1</span><span class="pun">]=(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j1</span><span class="pun">][</span><span class="pln">k1</span><span class="pun">]+</span><span class="pln">f</span><span class="pun">[</span><span class="pln">v</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">]*</span><span class="pln">w</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
							</span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">rp</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">rp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
				</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&gt;=</span><span class="pln">i</span><span class="pun">-</span><span class="pln">rp</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">--)</span><span class="pln">
					</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">=</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">k</span><span class="pun">&gt;=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">k</span><span class="pun">--)</span><span class="pln">
					</span><span class="pun">{</span><span class="pln">
						</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> val</span><span class="pun">=</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">];</span><span class="pln">
						f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
						</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">p</span><span class="pun">&lt;=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln">p</span><span class="pun">++)</span><span class="pln">
							</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> w</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">w</span><span class="pun">&lt;=</span><span class="pln">min</span><span class="pun">(</span><span class="pln">p</span><span class="pun">,</span><span class="pln">j</span><span class="pun">-(</span><span class="pln">i</span><span class="pun">-</span><span class="pln">rp</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]-</span><span class="lit">1</span><span class="pun">));</span><span class="pln">w</span><span class="pun">++)</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">+</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]-</span><span class="pln">w</span><span class="pun">][</span><span class="pln">k</span><span class="pun">+</span><span class="pln">p</span><span class="pun">-</span><span class="pln">w</span><span class="pun">]=(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">+</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]-</span><span class="pln">w</span><span class="pun">][</span><span class="pln">k</span><span class="pun">+</span><span class="pln">p</span><span class="pun">-</span><span class="pln">w</span><span class="pun">]+</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">v</span><span class="pun">][</span><span class="pln">p</span><span class="pun">]*</span><span class="pln">val</span><span class="pun">%</span><span class="pln">mod</span><span class="pun">*</span><span class="pln">C</span><span class="pun">(</span><span class="pln">j</span><span class="pun">-(</span><span class="pln">i</span><span class="pun">-</span><span class="pln">rp</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]-</span><span class="lit">1</span><span class="pun">),</span><span class="pln">w</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">*</span><span class="pln">C</span><span class="pun">(</span><span class="pln">k</span><span class="pun">+</span><span class="pln">p</span><span class="pun">-</span><span class="pln">w</span><span class="pun">,</span><span class="pln">k</span><span class="pun">))%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
					</span><span class="pun">}</span><span class="pln">
			siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]+=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">v</span><span class="pun">];</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln">i</span><span class="pun">&gt;=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">--)</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]=(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]+</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">])%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">u</span><span class="pun">!=</span><span class="lit">1</span><span class="pun">)</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln">j</span><span class="pun">&gt;=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j</span><span class="pun">--)</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">=</span><span class="pln">min</span><span class="pun">(</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]);</span><span class="pln">k</span><span class="pun">&gt;=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">k</span><span class="pun">--)</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				ll sum</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">rp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln">i</span><span class="pun">&gt;=</span><span class="pln">lp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln">i</span><span class="pun">--)</span><span class="pln">
				</span><span class="pun">{</span><span class="pln">
					</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> w</span><span class="pun">=</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">];</span><span class="pln">
					f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">][</span><span class="pln">k</span><span class="pun">]=(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">][</span><span class="pln">k</span><span class="pun">]+</span><span class="pln">w</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
					</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">j</span><span class="pun">==</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">][</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]=(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">][</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]+</span><span class="pln">w</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
					f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">]=</span><span class="pln">sum</span><span class="pun">,</span><span class="pln">sum</span><span class="pun">=(</span><span class="pln">sum</span><span class="pun">+</span><span class="pln">w</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> w</span><span class="pun">=</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">];</span><span class="pln">
				f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">lp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">]=(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">lp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">]+</span><span class="pln">w</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">,</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">][</span><span class="pln">k</span><span class="pun">]=(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">][</span><span class="pln">k</span><span class="pun">]+</span><span class="pln">w</span><span class="pun">+</span><span class="pln">sum</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">j</span><span class="pun">==</span><span class="pln">siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">][</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]=(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="lit">0</span><span class="pun">][</span><span class="pln">j</span><span class="pun">+</span><span class="lit">1</span><span class="pun">][</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]+</span><span class="pln">w</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">,</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">lp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]=(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">u</span><span class="pun">][</span><span class="pln">lp</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]][</span><span class="pln">j</span><span class="pun">][</span><span class="pln">k</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]+</span><span class="pln">w</span><span class="pun">)%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		siz</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]++;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln">y</span><span class="pun">;</span><span class="pln">
		t</span><span class="pun">=</span><span class="pln">read</span><span class="pun">(),</span><span class="pln">fac</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="lit">80</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">fac</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">fac</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]*</span><span class="pln">i</span><span class="pun">%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
		inv</span><span class="pun">[</span><span class="lit">80</span><span class="pun">]=</span><span class="pln">qpow</span><span class="pun">(</span><span class="pln">fac</span><span class="pun">[</span><span class="lit">80</span><span class="pun">],</span><span class="pln">mod</span><span class="pun">-</span><span class="lit">2</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">80</span><span class="pun">;</span><span class="pln">i</span><span class="pun">;</span><span class="pln">i</span><span class="pun">--)</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]=</span><span class="pln">inv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]*</span><span class="pln">i</span><span class="pun">%</span><span class="pln">mod</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			n</span><span class="pun">=</span><span class="pln">read</span><span class="pun">(),</span><span class="pln">memset</span><span class="pun">(</span><span class="pln">f</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">f</span><span class="pun">)),</span><span class="pln">memset</span><span class="pun">(</span><span class="pln">dp</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">dp</span><span class="pun">)),</span><span class="pln">memset</span><span class="pun">(</span><span class="pln">siz</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">siz</span><span class="pun">));</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">v</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				x</span><span class="pun">=</span><span class="pln">read</span><span class="pun">(),</span><span class="pln">y</span><span class="pun">=</span><span class="pln">read</span><span class="pun">();</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">x</span><span class="pun">&gt;</span><span class="pln">y</span><span class="pun">)</span><span class="pln">swap</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
				v</span><span class="pun">[</span><span class="pln">x</span><span class="pun">].</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">y</span><span class="pun">);</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln">sort</span><span class="pun">(</span><span class="pln">v</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln">v</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="kwd">end</span><span class="pun">()),</span><span class="pln">reverse</span><span class="pun">(</span><span class="pln">v</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln">v</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="kwd">end</span><span class="pun">());</span><span class="pln">
			dfs1</span><span class="pun">(</span><span class="lit">1</span><span class="pun">),</span><span class="pln">dfs2</span><span class="pun">(</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&gt;</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">--)</span><span class="pln">printf</span><span class="pun">(</span><span class="str">"%lld "</span><span class="pun">,</span><span class="pln">f</span><span class="pun">[</span><span class="lit">1</span><span class="pun">][</span><span class="pln">i</span><span class="pun">][</span><span class="pln">i</span><span class="pun">-</span><span class="lit">2</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]);</span><span class="pln">
			puts</span><span class="pun">(</span><span class="str">"1"</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> tokido_saya</span><span class="pun">::</span><span class="pln">main</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2089" class="notice" style="text-decoration: none;">Codeforces Round 1012 (Div. 1)</a> </span>
        </div>
        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2090" class="notice" style="text-decoration: none;">Codeforces Round 1012 (Div. 2)</a> </span>
        </div>
        
            

  <script>
    // Make all spoilers toggleable
    document.querySelectorAll('.spoiler-title').forEach(title => {
      title.addEventListener('click', function() {
        const spoiler = this.closest('.spoiler');
        spoiler.classList.toggle('open');
      });
    });
    
    // Open all spoilers by default for easier reading
    document.querySelectorAll('.spoiler').forEach(spoiler => {
      spoiler.classList.add('open');
    });
  </script>
</body>
</html>