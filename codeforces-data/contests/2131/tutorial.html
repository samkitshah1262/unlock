<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tutorial</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
      color: #333;
      background: #fafafa;
    }
    .ttypography {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    h3 {
      color: #1a1a1a;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }
    h3 a {
      color: #0066cc;
      text-decoration: none;
    }
    h3 a:hover {
      text-decoration: underline;
    }
    .spoiler {
      margin: 15px 0;
      border: 1px solid #ddd;
      border-radius: 6px;
      overflow: hidden;
    }
    .spoiler-title {
      display: block;
      padding: 12px 15px;
      background: #f0f0f0;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
      border-bottom: 1px solid #ddd;
    }
    .spoiler-title:hover {
      background: #e8e8e8;
    }
    .spoiler-title::before {
      content: '▶ ';
      font-size: 0.8em;
      transition: transform 0.2s;
      display: inline-block;
    }
    .spoiler.open .spoiler-title::before {
      content: '▼ ';
    }
    .spoiler-content {
      padding: 15px;
      background: #fff;
      display: none;
    }
    .spoiler.open .spoiler-content {
      display: block;
    }
    pre, code {
      background: #f5f5f5;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 0.85em;
    }
    pre {
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
    code {
      padding: 2px 5px;
      border-radius: 3px;
    }
    p {
      margin: 10px 0;
    }
    .MathJax {
      font-size: 1.1em;
    }
  </style>
</head>
<body>
  <h1>Editorial</h1>
  <p><a href="https://codeforces.com/blog/entry/145439" target="_blank">View on Codeforces →</a></p>
  
  <div class="ttypography"><p>I hope you all enjoyed the contest!</p> <div class="spoiler"><b class="spoiler-title">Rating Predictions</b><div class="spoiler-content" style="display: block;"><table class="bordertable">   <thead>     <tr>       <th>Predictor </th>       <th>A </th>       <th>B </th>       <th>C </th>       <th>D </th>       <th>E </th>       <th>F </th>       <th>G </th>       <th>H </th>     </tr>   </thead>   <tbody>     <tr>       <td><a class="rated-user user-orange" href="https://codeforces.com/profile/AksLolCoding" title="Master AksLolCoding">AksLolCoding</a> </td>       <td>800 </td>       <td>900 </td>       <td>1000 </td>       <td>1400 </td>       <td>1500 </td>       <td>1800 </td>       <td>1800 </td>       <td>— </td>     </tr>     <tr>       <td><a class="rated-user user-cyan" href="https://codeforces.com/profile/ALnQ417" title="Specialist ALnQ417">ALnQ417</a> </td>       <td>800 </td>       <td>900 </td>       <td>1100 </td>       <td>1300 </td>       <td>1500 </td>       <td>1600 </td>       <td>— </td>       <td>— </td>     </tr>     <tr>       <td><a class="rated-user user-orange" href="https://codeforces.com/profile/bookcat" title="International Master bookcat">bookcat</a> </td>       <td>800 </td>       <td>1200 </td>       <td>1200 </td>       <td>1500 </td>       <td>1600 </td>       <td>1600 </td>       <td>1600 </td>       <td>2000 </td>     </tr>     <tr>       <td><a class="rated-user user-blue" href="https://codeforces.com/profile/chromate00" title="Expert chromate00">chromate00</a> </td>       <td>800 </td>       <td>800 </td>       <td>1000 </td>       <td>1400 </td>       <td>1400 </td>       <td>1800 </td>       <td>1800 </td>       <td>2200 </td>     </tr>     <tr>       <td><a class="rated-user user-orange" href="https://codeforces.com/profile/cry" title="International Master cry">cry</a> </td>       <td>800 </td>       <td>1000 </td>       <td>1200 </td>       <td>1600 </td>       <td>1700 </td>       <td>2100 </td>       <td>2100 </td>       <td>2400 </td>     </tr>     <tr>       <td><a class="rated-user user-violet" href="https://codeforces.com/profile/Edeeva" title="Candidate Master Edeeva">Edeeva</a> </td>       <td>800 </td>       <td>800 </td>       <td>1000 </td>       <td>1300 </td>       <td>1400 </td>       <td>1600 </td>       <td>1900 </td>       <td>— </td>     </tr>     <tr>       <td><a class="rated-user user-orange" href="https://codeforces.com/profile/efishel" title="Master efishel">efishel</a> </td>       <td>800 </td>       <td>1000 </td>       <td>1000 </td>       <td>1500 </td>       <td>1500 </td>       <td>1800 </td>       <td>1900 </td>       <td>2200 </td>     </tr>     <tr>       <td><a class="rated-user user-blue" href="https://codeforces.com/profile/_Equinox" title="Expert _Equinox">_Equinox</a> </td>       <td>800 </td>       <td>800 </td>       <td>800 </td>       <td>1200 </td>       <td>1500 </td>       <td>1600 </td>       <td>1800 </td>       <td>— </td>     </tr>     <tr>       <td><a class="rated-user user-violet" href="https://codeforces.com/profile/fatalerror" title="Candidate Master fatalerror">fatalerror</a> </td>       <td>800 </td>       <td>1400 </td>       <td>1200 </td>       <td>1600 </td>       <td>1700 </td>       <td>1900 </td>       <td>2000 </td>       <td>2100 </td>     </tr>     <tr>       <td><a class="rated-user user-orange" href="https://codeforces.com/profile/-firefly-" title="Master -firefly-">-firefly-</a> </td>       <td>800 </td>       <td>800 </td>       <td>900 </td>       <td>1400 </td>       <td>1400 </td>       <td>1600 </td>       <td>1800 </td>       <td>2500 </td>     </tr>     <tr>       <td><a class="rated-user user-red" href="https://codeforces.com/profile/nifeshe" title="Grandmaster nifeshe">nifeshe</a> </td>       <td>800 </td>       <td>800 </td>       <td>1000 </td>       <td>1500 </td>       <td>1600 </td>       <td>1800 </td>       <td>1900 </td>       <td>2400 </td>     </tr>     <tr>       <td><a class="rated-user user-blue" href="https://codeforces.com/profile/Non-origination" title="Expert Non-origination">Non-origination</a> </td>       <td>800 </td>       <td>800 </td>       <td>1000 </td>       <td>1600 </td>       <td>1300 </td>       <td>1600 </td>       <td>1800 </td>       <td>— </td>     </tr>     <tr>       <td><a class="rated-user user-violet" href="https://codeforces.com/profile/reirugan" title="Candidate Master reirugan">reirugan</a> </td>       <td>800 </td>       <td>900 </td>       <td>1200 </td>       <td>1500 </td>       <td>1500 </td>       <td>1800 </td>       <td>1800 </td>       <td>— </td>     </tr>     <tr>       <td><a class="rated-user user-orange" href="https://codeforces.com/profile/temporary1" title="International Master temporary1">temporary1</a> </td>       <td>800 </td>       <td>800 </td>       <td>900 </td>       <td>1400 </td>       <td>1300 </td>       <td>1800 </td>       <td>1900 </td>       <td>2200 </td>     </tr>     <tr>       <td><a class="rated-user user-cyan" href="https://codeforces.com/profile/white_two" title="Specialist white_two">white_two</a> </td>       <td>800 </td>       <td>800 </td>       <td>1200 </td>       <td>1400 </td>       <td>1400 </td>       <td>1900 </td>       <td>— </td>       <td>— </td>     </tr>   </tbody> </table></div></div> <div class="spoiler"><b class="spoiler-title">Rate the contest!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>
<style data-nocturne="true" type="text/css">

</style>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11348">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="246">246</span>
            </i>
        </a>
    </span>

    <script>
        $(function() {
            const likeFormUtil = {};
            likeFormUtil.getCount = function ($count) {
                return Number($count.attr("data-value"));
            };
            likeFormUtil.setCount = function ($count, value) {
                $count.attr("data-value", value);
                $count.text(value);
            };
            likeFormUtil.like = function ($likeForm) {
                $likeForm.find(".likeState").addClass("liked");
                const $likeCount = $likeForm.find(".likeCount");
                likeFormUtil.setCount($likeCount, likeFormUtil.getCount($likeCount) + 1);
            };
            likeFormUtil.unLike = function ($likeForm) {
                if ($likeForm.find(".likeState").hasClass("liked")) {
                    $likeForm.find(".likeState").removeClass("liked");
                    const $likeCount = $likeForm.find(".likeCount");
                    likeFormUtil.setCount($likeCount, likeFormUtil.getCount($likeCount) - 1);
                }
            };
            likeFormUtil.dislike = function ($likeForm) {
                $likeForm.find(".dislikeState").addClass("disliked");
                const $dislikeCount = $likeForm.find(".dislikeCount");
                likeFormUtil.setCount($dislikeCount, likeFormUtil.getCount($dislikeCount) + 1);
            };
            likeFormUtil.unDislike = function ($likeForm) {
                if ($likeForm.find(".dislikeState").hasClass("disliked")) {
                    $likeForm.find(".dislikeState").removeClass("disliked");
                    const $dislikeCount = $likeForm.find(".dislikeCount");
                    likeFormUtil.setCount($dislikeCount, likeFormUtil.getCount($dislikeCount) - 1);
                }
            };
            likeFormUtil.disable = function ($likeForm) {
                $likeForm.find(".likeActionLink").off("click");
                $likeForm.find(".likeActionLink").on("click", function () {
                    return false;
                });
                $likeForm.find(".dislikeActionLink").off("click");
                $likeForm.find(".dislikeActionLink").on("click", function () {
                    return false;
                });
            };
            likeFormUtil.enable = function ($likeForm) {
                $likeForm.find(".likeActionLink").off("click");
                $likeForm.find(".likeActionLink").on("click", onLike);
                $likeForm.find(".dislikeActionLink").off("click");
                $likeForm.find(".dislikeActionLink").on("click", onDislike);
            };
            likeFormUtil.applyLikeableInformation = function(likeableInformation) {
                const id = likeableInformation.likeable.id;
                console.log(id);
                const $likeForm = $(".likeActionLink[data-likeableId='" + id + "']").closest(".likeForm");
                console.log($likeForm);
                likeFormUtil.setCount($likeForm.find(".likeCount"), likeableInformation.likeCount);
                likeFormUtil.setCount($likeForm.find(".dislikeCount"), likeableInformation.dislikeCount);
                if (likeableInformation.liked) {
                    $likeForm.find(".likeState").addClass("liked");
                } else {
                    $likeForm.find(".likeState").removeClass("liked");
                }
                if (likeableInformation.disliked) {
                    $likeForm.find(".likeState").addClass("disliked");
                } else {
                    $likeForm.find(".likeState").removeClass("disliked");
                }
            }
            likeFormUtil.applyLikeableInformations = function(likeableInformations) {
                likeableInformations.forEach((applyLikeableInformation) => {
                    likeFormUtil.applyLikeableInformation(applyLikeableInformation);
                });
            }

            function onLike() {
                const $likeActionLink = $(this);
                const likeableId = $likeActionLink.attr("data-likeableId");
                const $likeForm = $likeActionLink.parent();

                likeFormUtil.disable($likeForm);
                $.post("/data/like", {
                    action: "like",
                    likeableId: likeableId
                }, function (data) {
                    if (data["success"] === true) {
                        if (data["liked"]) {
                            Codeforces.showMessage('Added to liked');
                        } else {
                            Codeforces.showMessage('Removed from liked');
                        }
                        likeFormUtil.applyLikeableInformations(data["likeableInformations"]);
                    } else {
                        Codeforces.showMessage(data["message"] || "Error");
                    }
                    likeFormUtil.enable($likeForm);
                }, "json");
                return false;
            }

            function onDislike() {
                const $dislikeActionLink = $(this);
                const likeableId = $dislikeActionLink.attr("data-likeableId");
                const $likeForm = $dislikeActionLink.parent();

                likeFormUtil.disable($likeForm);
                $.post("/data/like", {
                    action: "dislike",
                    likeableId: likeableId
                }, function (data) {
                    if (data["success"] === true) {
                        if (data["disliked"]) {
                            Codeforces.showMessage('Added to disliked');
                        } else {
                            Codeforces.showMessage('Removed from disliked');
                        }
                        likeFormUtil.applyLikeableInformations(data["likeableInformations"]);
                    } else {
                        Codeforces.showMessage(data["message"] || "Error");
                    }
                    likeFormUtil.enable($likeForm);
                }, "json");
                return false;
            }

            $(".likeActionLink").click(onLike);
            $(".dislikeActionLink").click(onDislike);

            $(".likeCount").add(".dislikeCount").each(function () {
                const $count = $(this);
                likeFormUtil.setCount($count, likeFormUtil.getCount($count));
            });
        });
    </script>

<script data-nocturne="true"> $(function () {
}); </script>

 Excellent contest</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11349">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="295">295</span>
            </i>
        </a>
    </span>


 Good contest</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11350">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="32">32</span>
            </i>
        </a>
    </span>


 Average contest</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11351">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="10">10</span>
            </i>
        </a>
    </span>


 Bad contest</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11352">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="8">8</span>
            </i>
        </a>
    </span>


 Horrible contest</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11353">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="8">8</span>
            </i>
        </a>
    </span>


 Trivial contest</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11354">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="32">32</span>
            </i>
        </a>
    </span>


 Easy contest</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11355">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="359">359</span>
            </i>
        </a>
    </span>


 Average contest</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11356">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="164">164</span>
            </i>
        </a>
    </span>


 Hard contest</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11357">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="8">8</span>
            </i>
        </a>
    </span>


 Impossible contest</li> </ul></div></div></div></div><p><a href="https://codeforces.com/contest/2131/problem/A" title="Codeforces Round 1042 (Div. 3)">2131A - Lever</a></p><p>Idea: <a class="rated-user user-orange" href="https://codeforces.com/profile/-firefly-" title="Master -firefly-">-firefly-</a> <br> Preparation: <a class="rated-user user-orange" href="https://codeforces.com/profile/-firefly-" title="Master -firefly-">-firefly-</a> <br> Analysis: <a class="rated-user user-orange" href="https://codeforces.com/profile/temporary1" title="International Master temporary1">temporary1</a></p> <div class="spoiler"><b class="spoiler-title">Hint</b><div class="spoiler-content" style="display: block;"><p>The step <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mn" id="MJXp-Span-2">2</span></span></span><script type="math/tex" id="MathJax-Element-1">2</script> doesn't affect step <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mn" id="MJXp-Span-4">1</span></span></span><script type="math/tex" id="MathJax-Element-2">1</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2131/problem/A" title="Codeforces Round 1042 (Div. 3)">2131A - Lever</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Notice that the iteration will only end if step $$$1$$$ is ignored, so we only need to consider step $$$1$$$.</p><p>Notice that if for some $$$i$$$ such that $$$a_i &gt; b_i$$$, it will only be affected by step $$$1$$$. Additionally, it will be affected $$$a_i-b_i$$$ times. Thus, in total, step $$$1$$$ will run for sum of $$$\max(a_i-b_i,0)$$$ times, and thus the iteration will end on this number plus $$$1$$$.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Code (Python)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">import</span><span class="pln"> sys
input </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> sys</span><span class="pun">.</span><span class="pln">stdin</span><span class="pun">.</span><span class="pln">readline</span><span class="pun">().</span><span class="pln">rstrip</span><span class="pun">()</span><span class="pln">
ii </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
mii </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">())</span><span class="pln">
lii </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> list</span><span class="pun">(</span><span class="pln">mii</span><span class="pun">())</span><span class="pln">

</span><span class="kwd">def</span><span class="pln"> solve</span><span class="pun">():</span><span class="pln">
    n </span><span class="pun">=</span><span class="pln"> ii</span><span class="pun">()</span><span class="pln">
    A </span><span class="pun">=</span><span class="pln"> lii</span><span class="pun">()</span><span class="pln">
    B </span><span class="pun">=</span><span class="pln"> lii</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> sum</span><span class="pun">(</span><span class="pln">a </span><span class="pun">-</span><span class="pln"> b </span><span class="kwd">for</span><span class="pln"> a</span><span class="pun">,</span><span class="pln"> b </span><span class="kwd">in</span><span class="pln"> zip</span><span class="pun">(</span><span class="pln">A</span><span class="pun">,</span><span class="pln"> B</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> a </span><span class="pun">&gt;</span><span class="pln"> b</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">

</span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">ii</span><span class="pun">()):</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">solve</span><span class="pun">())</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11358">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="185">185</span>
            </i>
        </a>
    </span>


 Excellent problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11359">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="63">63</span>
            </i>
        </a>
    </span>


 Good problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11360">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="47">47</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11361">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="25">25</span>
            </i>
        </a>
    </span>


 Bad problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11362">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="26">26</span>
            </i>
        </a>
    </span>


 Horrible problem</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11363">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="111">111</span>
            </i>
        </a>
    </span>


 Trivial problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11364">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="134">134</span>
            </i>
        </a>
    </span>


 Easy problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11365">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="64">64</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11366">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="35">35</span>
            </i>
        </a>
    </span>


 Hard problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11367">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="24">24</span>
            </i>
        </a>
    </span>


 Impossible problem</li> </ul></div></div></div></div><p><a href="https://codeforces.com/contest/2131/problem/B" title="Codeforces Round 1042 (Div. 3)">2131B - Alternating Series</a></p><p>Idea: <a class="rated-user user-orange" href="https://codeforces.com/profile/-firefly-" title="Master -firefly-">-firefly-</a> <br> Preparation: <a class="rated-user user-orange" href="https://codeforces.com/profile/-firefly-" title="Master -firefly-">-firefly-</a> <br> Analysis: <a class="rated-user user-violet" href="https://codeforces.com/profile/reirugan" title="Candidate Master reirugan">reirugan</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>There are no much difference between the series when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">n</span><span class="MJXp-mo" id="MJXp-Span-7" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">k</span></span></span><script type="math/tex" id="MathJax-Element-3">n=k</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">n</span><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">k</span><span class="MJXp-mo" id="MJXp-Span-13" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-14">1</span></span></span><script type="math/tex" id="MathJax-Element-4">n=k+1</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Construct the series from the left to the right greedily.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2131/problem/B" title="Codeforces Round 1042 (Div. 3)">2131B - Alternating Series</a></h3><div class="ttypography"><div class="problem-statement"><div><p>We see that the first condition is equivalent to the elements of $$$a$$$ being alternating in sign. Note that this implies all of the elements are nonzero. Now, we consider the second condition.</p><p>First, we claim that any positive element $$$a_i$$$ must satisfy $$$a_i\geq 2$$$. Furthermore, if $$$2\leq i \leq n-1$$$, then we must have $$$a_i\geq 3$$$.</p><p>Suppose that $$$2\leq i\leq n-1$$$. Then consider the subarray $$$a[i-1, i+1]$$$. We must have that $$$a_{i-1}$$$ and $$$a_{i+1}$$$ are negative, so $$$a_{i-1} + a_i + a_{i+1} \leq (-1) + a_i + (-1) = a_i - 2$$$. But we need that $$$a_{i-1} + a_i + a_{i+1} \geq 1$$$, so we need that $$$a_i - 2 \leq 1$$$, so $$$a_i \geq 3$$$. Identical reasoning holds if $$$i=1$$$ or $$$i=n$$$ with the single adjacent element, yielding $$$a_i\geq 2$$$.</p><p>Now, let us try constructing greedily from left to right, where we pick the number with the smallest possible absolute value. We choose $$$a_1 = -1$$$, because we cannot pick $$$a_1 = 1$$$ by the previous condition. Now, for all even indices, we will pick $$$3$$$ if $$$2\leq i\leq n-1$$$, or $$$2$$$ if $$$i=n$$$. For all odd indices, we will pick $$$-1$$$. For example, for $$$n=6$$$, this yields the array $$$a = [-1, 3, -1, 3, -1, 2]$$$.</p><p>Let's verify that this is a good array. Since the signs are alternating, it satisfies the first condition. Now, consider a subarray of length $$$k\geq 2$$$. If the subarray has length $$$2$$$, then it consists of one positive value $$$\geq 2$$$ and one negative value $$$-1$$$, so its sum is positive. If the subarray has length $$$3$$$, then it either has two positive values $$$\geq 2$$$ and one negative value $$$-1$$$, or is $$$[-1, 3, -1]$$$; both cases yield a positive sum. Finally, if the subarray has length $$$\geq 4$$$, then we have at least $$$\lfloor \frac{k}{2}\rfloor$$$ positive values, and at most $$$\lceil \frac{k}{2}\rceil$$$ negative values, so the sum is at least $$$(2)\frac{k-1}{2} + (-1)\frac{k+1}{2} = \frac12k - \frac32 \geq \frac12$$$, so the sum is positive.</p><p>Since $$$a$$$ is good and was constructed greedily, $$$a$$$ is better than any other good array.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Code (Python)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">import</span><span class="pln"> sys
input </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> sys</span><span class="pun">.</span><span class="pln">stdin</span><span class="pun">.</span><span class="pln">readline</span><span class="pun">().</span><span class="pln">rstrip</span><span class="pun">()</span><span class="pln">
ii </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
mii </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">())</span><span class="pln">
lii </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> list</span><span class="pun">(</span><span class="pln">mii</span><span class="pun">())</span><span class="pln">

</span><span class="kwd">def</span><span class="pln"> solve</span><span class="pun">():</span><span class="pln">
    n </span><span class="pun">=</span><span class="pln"> ii</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> n </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln">
    ans </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="com">// 2)</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> n </span><span class="pun">%</span><span class="pln"> </span><span class="lit">2</span><span class="pun">:</span><span class="pln">
        ans</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        ans</span><span class="pun">[-</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> ans

</span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">ii</span><span class="pun">()):</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(*</span><span class="pln">solve</span><span class="pun">())</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11368">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="52">52</span>
            </i>
        </a>
    </span>


 Excellent problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11369">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="130">130</span>
            </i>
        </a>
    </span>


 Good problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11370">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="62">62</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11371">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="5">5</span>
            </i>
        </a>
    </span>


 Bad problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11372">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="14">14</span>
            </i>
        </a>
    </span>


 Horrible problem</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11373">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="27">27</span>
            </i>
        </a>
    </span>


 Trivial problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11374">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="109">109</span>
            </i>
        </a>
    </span>


 Easy problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11375">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="111">111</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11376">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="18">18</span>
            </i>
        </a>
    </span>


 Hard problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11377">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="9">9</span>
            </i>
        </a>
    </span>


 Impossible problem</li> </ul></div></div></div></div><p><a href="https://codeforces.com/contest/2131/problem/C" title="Codeforces Round 1042 (Div. 3)">2131C - Make it Equal</a></p><p>Idea: <a class="rated-user user-orange" href="https://codeforces.com/profile/Tobo" title="International Master Tobo">Tobo</a> <br> Preparation: <a class="rated-user user-orange" href="https://codeforces.com/profile/Tobo" title="International Master Tobo">Tobo</a>, <a class="rated-user user-orange" href="https://codeforces.com/profile/-firefly-" title="Master -firefly-">-firefly-</a>, <a class="rated-user user-orange" href="https://codeforces.com/profile/LMeyling" title="Master LMeyling">LMeyling</a> <br> Analysis: <a class="rated-user user-orange" href="https://codeforces.com/profile/Tobo" title="International Master Tobo">Tobo</a></p> <div class="spoiler"><b class="spoiler-title">Hint</b><div class="spoiler-content" style="display: block;"><p>Consider the operations modulo <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-15"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16">k</span></span></span><script type="math/tex" id="MathJax-Element-5">k</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2131/problem/C" title="Codeforces Round 1042 (Div. 3)">2131C - Make it Equal</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Key observation: </p><p>We can only change an element $$$x$$$ to $$$y$$$ if and only if $$$x\equiv y \pmod k$$$ or $$$x + y\equiv 0 \pmod k$$$.</p><p>Proof: </p><p>Step 1: If $$$x\equiv y \pmod k$$$, assume that $$$x &lt; y$$$, we can do the following operations: add $$$x$$$ to $$$k$$$ for $$$\frac{y-x}{k}$$$ times. Vice versa.</p><p>Step 2: If $$$x + y\equiv 0 \pmod k$$$, we can make $$$x$$$ become $$$x\bmod k$$$ with some operations, then make $$$x\bmod k$$$ become $$$z=(k-x) \% k$$$, and now we can see $$$z\equiv y \pmod k$$$, repeat the operations in step 1 to make $$$z$$$ to $$$y$$$.</p><p>So, for every element $$$x$$$ in multiset $$$S$$$ and $$$T$$$, we make it become as small as possible, which is equal to $$$min(x\% k, (k - x \% k) \% k)$$$. Then check $$$S$$$ and $$$T$$$ if they are equal.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Code (Python)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">import</span><span class="pln"> sys
input </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> sys</span><span class="pun">.</span><span class="pln">stdin</span><span class="pun">.</span><span class="pln">readline</span><span class="pun">().</span><span class="pln">rstrip</span><span class="pun">()</span><span class="pln">
ii </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
mii </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">())</span><span class="pln">
lii </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> list</span><span class="pun">(</span><span class="pln">mii</span><span class="pun">())</span><span class="pln">

</span><span class="kwd">from</span><span class="pln"> collections </span><span class="kwd">import</span><span class="pln"> defaultdict
</span><span class="kwd">from</span><span class="pln"> random </span><span class="kwd">import</span><span class="pln"> getrandbits
RD </span><span class="pun">=</span><span class="pln"> getrandbits</span><span class="pun">(</span><span class="lit">31</span><span class="pun">)</span><span class="pln">

</span><span class="kwd">def</span><span class="pln"> solve</span><span class="pun">():</span><span class="pln">
    n</span><span class="pun">,</span><span class="pln"> k </span><span class="pun">=</span><span class="pln"> mii</span><span class="pun">()</span><span class="pln">
    A </span><span class="pun">=</span><span class="pln"> lii</span><span class="pun">()</span><span class="pln">
    B </span><span class="pun">=</span><span class="pln"> lii</span><span class="pun">()</span><span class="pln">
    cnt </span><span class="pun">=</span><span class="pln"> defaultdict</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> x </span><span class="kwd">in</span><span class="pln"> A</span><span class="pun">:</span><span class="pln">
        r </span><span class="pun">=</span><span class="pln"> x </span><span class="pun">%</span><span class="pln"> k
        cnt</span><span class="pun">[</span><span class="pln">min</span><span class="pun">(</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">-</span><span class="pln">r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">^</span><span class="pln"> RD</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> x </span><span class="kwd">in</span><span class="pln"> B</span><span class="pun">:</span><span class="pln">
        r </span><span class="pun">=</span><span class="pln"> x </span><span class="pun">%</span><span class="pln"> k
        cnt</span><span class="pun">[</span><span class="pln">min</span><span class="pun">(</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">-</span><span class="pln">r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">^</span><span class="pln"> RD</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> all</span><span class="pun">(</span><span class="pln">v </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> v </span><span class="kwd">in</span><span class="pln"> cnt</span><span class="pun">.</span><span class="pln">values</span><span class="pun">())</span><span class="pln">

</span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">ii</span><span class="pun">()):</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(</span><span class="str">'YES'</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="str">'NO'</span><span class="pun">)</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11378">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="146">146</span>
            </i>
        </a>
    </span>


 Excellent problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11379">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="242">242</span>
            </i>
        </a>
    </span>


 Good problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11380">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="31">31</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11381">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="43">43</span>
            </i>
        </a>
    </span>


 Bad problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11382">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="22">22</span>
            </i>
        </a>
    </span>


 Horrible problem</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11383">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="8">8</span>
            </i>
        </a>
    </span>


 Trivial problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11384">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="55">55</span>
            </i>
        </a>
    </span>


 Easy problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11385">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="243">243</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11386">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="198">198</span>
            </i>
        </a>
    </span>


 Hard problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11387">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="16">16</span>
            </i>
        </a>
    </span>


 Impossible problem</li> </ul></div></div></div></div><p><a href="https://codeforces.com/contest/2131/problem/D" title="Codeforces Round 1042 (Div. 3)">2131D - Arboris Contractio</a></p><p>Idea: <a class="rated-user user-orange" href="https://codeforces.com/profile/-firefly-" title="Master -firefly-">-firefly-</a> <br> Preparation: <a class="rated-user user-orange" href="https://codeforces.com/profile/-firefly-" title="Master -firefly-">-firefly-</a> <br> Analysis: <a class="rated-user user-red" href="https://codeforces.com/profile/__baozii__" title="Grandmaster __baozii__">__baozii__</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>What is the minimum diameter achievable?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>How are leaves significant?</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2131/problem/D" title="Codeforces Round 1042 (Div. 3)">2131D - Arboris Contractio</a></h3><div class="ttypography"><div class="problem-statement"><div><p>We first handle the case where $$$n=2$$$. The diameter is $$$1$$$, and we do not need to perform any operations.</p><p>For $$$n&gt;2$$$, it can be proven that the minimum diameter achievable is $$$2$$$. You can choose any vertex as the root, and repeatedly perform the operations to make every other vertex a child of it. </p><p>Let's fix the final root of the tree as $$$r$$$. Denote $$$p_u$$$ as the parent of $$$u$$$, and $$$d_u$$$ as the depth of $$$u$$$. We define $$$d_u$$$ as such:</p><ul> <li> $$$d_r=0$$$; </li><li> $$$d_u=d_{p_u}+1$$$. </li></ul><p>For vertices with depth no larger than $$$1$$$, we do not need to perform any operations on them as they are already in their desired positions. For vertices with depth larger than $$$1$$$, notice that in every operation, only one of the vertices on the path selected can be a leaf. This means that we can only "get rid" of one leaf in one operation. Also, you can always choose the path where one end is $$$r$$$ and the other end is a leaf with depth larger than $$$1$$$. Doing so for all leaves with depth larger than $$$1$$$ guarantees all vertices to be a child of $$$r$$$. Hence, the minimum number of operations for fixed root $$$r$$$ is the number of leaves with depth larger than $$$1$$$. The final answer would be the minimum over all choices of roots. </p><p>With careful implementation, the final complexity should be $$$O(n)$$$ per test case.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Code (Python)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">import</span><span class="pln"> sys
input </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> sys</span><span class="pun">.</span><span class="pln">stdin</span><span class="pun">.</span><span class="pln">readline</span><span class="pun">().</span><span class="pln">rstrip</span><span class="pun">()</span><span class="pln">
ii </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
mii </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">())</span><span class="pln">
lii </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> list</span><span class="pun">(</span><span class="pln">mii</span><span class="pun">())</span><span class="pln">

</span><span class="kwd">def</span><span class="pln"> solve</span><span class="pun">():</span><span class="pln">
    n </span><span class="pun">=</span><span class="pln"> ii</span><span class="pun">()</span><span class="pln">
    g </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[[]</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)]</span><span class="pln">
    deg </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n
    </span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">-</span><span class="lit">1</span><span class="pun">):</span><span class="pln">
        u</span><span class="pun">,</span><span class="pln"> v </span><span class="pun">=</span><span class="pln"> mii</span><span class="pun">()</span><span class="pln">
        u </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> v </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        g</span><span class="pun">[</span><span class="pln">u</span><span class="pun">].</span><span class="pln">append</span><span class="pun">(</span><span class="pln">v</span><span class="pun">)</span><span class="pln">
        g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">].</span><span class="pln">append</span><span class="pun">(</span><span class="pln">u</span><span class="pun">)</span><span class="pln">
        deg</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
        deg</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> n </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">3</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pln">

    c1 </span><span class="pun">=</span><span class="pln"> sum</span><span class="pun">(</span><span class="pln">deg</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> u </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">))</span><span class="pln">
    mx </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">sum</span><span class="pun">(</span><span class="pln">deg</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> v </span><span class="kwd">in</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln"> </span><span class="kwd">for</span><span class="pln"> u </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">))</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> c1 </span><span class="pun">-</span><span class="pln"> mx

</span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">ii</span><span class="pun">()):</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">solve</span><span class="pun">())</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11388">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="360">360</span>
            </i>
        </a>
    </span>


 Excellent problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11389">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="54">54</span>
            </i>
        </a>
    </span>


 Good problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11390">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="9">9</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11391">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="2">2</span>
            </i>
        </a>
    </span>


 Bad problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11392">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="25">25</span>
            </i>
        </a>
    </span>


 Horrible problem</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11393">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="13">13</span>
            </i>
        </a>
    </span>


 Trivial problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11394">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="31">31</span>
            </i>
        </a>
    </span>


 Easy problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11395">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="125">125</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11396">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="310">310</span>
            </i>
        </a>
    </span>


 Hard problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11397">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="10">10</span>
            </i>
        </a>
    </span>


 Impossible problem</li> </ul></div></div></div></div><p><a href="https://codeforces.com/contest/2131/problem/E" title="Codeforces Round 1042 (Div. 3)">2131E - Adjacent XOR</a></p><p>Idea: <a class="rated-user user-orange" href="https://codeforces.com/profile/-firefly-" title="Master -firefly-">-firefly-</a> <br> Preparation: <a class="rated-user user-orange" href="https://codeforces.com/profile/-firefly-" title="Master -firefly-">-firefly-</a> <br> Analysis: <a class="rated-user user-red" href="https://codeforces.com/profile/__baozii__" title="Grandmaster __baozii__">__baozii__</a></p> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2131/problem/E" title="Codeforces Round 1042 (Div. 3)">2131E - Adjacent XOR</a></h3><div class="ttypography"><div class="problem-statement"><div><p>The key observation to this problem is that throughout the whole process of performing operations, the value of $$$a_i$$$ for each index $$$i$$$ changes at most once, since we are only allowed to perform the operation on each index once. This means that throughout the process, $$$a_i$$$ either equals the original $$$a_i$$$ or equals $$$b_i$$$. </p><p>Consider two adjacent indices $$$i$$$ and $$$i+1$$$. How do we determine which index to operate on first? There are a few cases:</p><ul> <li> $$$a_i=b_i$$$: we do not need to perform any operation on $$$i$$$;</li><li> $$$a_i \oplus a_{i+1}=b_i$$$: we should operate on $$$i$$$ first, as operating on $$$i+1$$$ first will make $$$a_{i+1}$$$ become $$$b_{i+1}$$$. $$$a_i$$$ would thus never have a chance to become $$$b_i$$$.</li><li> $$$a_i \oplus b_{i+1}=b_i$$$: we should operate on $$$i+1$$$ first, as operating on $$$i$$$ first will make $$$a_i \ne b_i$$$. </li><li> Since the value of $$$a_{i+1}$$$ either equals the original $$$a_{i+1}$$$ or $$$b_{i+1}$$$, if none of the above equalities hold, it is impossible to transform $$$a$$$ to $$$b$$$. </li></ul><p>These requirements form a directed graph, where there is an edge from $$$i$$$ to $$$j$$$ if and only if you need to operate on $$$i$$$ before operating on $$$j$$$. Since all edges are between adjacent indices, it can be easily shown that the graph is acyclic. This means that there is guaranteed to exist a sequence of operations fulfilling all the requirements. As such, we have proven the necessity and sufficiency of the three equalities.</p><p>In conclusion, if and only if for every index $$$1 \le i \le n$$$ one of these three equalities holds:</p><ul> <li> $$$a_i=b_i$$$;</li><li> $$$a_i \oplus a_{i+1}=b_i$$$ if $$$i &lt; n$$$;</li><li> $$$a_i \oplus b_{i+1}=b_i$$$ if $$$i &lt; n$$$; </li></ul><p>then it is possible to transform $$$a$$$ to $$$b$$$. The final complexity is $$$O(n)$$$ per test case.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Code (Python)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">import</span><span class="pln"> sys
input </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> sys</span><span class="pun">.</span><span class="pln">stdin</span><span class="pun">.</span><span class="pln">readline</span><span class="pun">().</span><span class="pln">rstrip</span><span class="pun">()</span><span class="pln">
ii </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
mii </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">())</span><span class="pln">
lii </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> list</span><span class="pun">(</span><span class="pln">mii</span><span class="pun">())</span><span class="pln">

</span><span class="kwd">def</span><span class="pln"> solve</span><span class="pun">():</span><span class="pln">
    n </span><span class="pun">=</span><span class="pln"> ii</span><span class="pun">()</span><span class="pln">
    A </span><span class="pun">=</span><span class="pln"> lii</span><span class="pun">()</span><span class="pln">
    B </span><span class="pun">=</span><span class="pln"> lii</span><span class="pun">()</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> A</span><span class="pun">[-</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> B</span><span class="pun">[-</span><span class="lit">1</span><span class="pun">]:</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">-</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> A</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> B</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> A</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">^</span><span class="pln"> A</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> B</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> A</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">^</span><span class="pln"> B</span><span class="pun">[</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> B</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]:</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">False</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">True</span><span class="pln">

</span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">ii</span><span class="pun">()):</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(</span><span class="str">'YES'</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="str">'NO'</span><span class="pun">)</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11398">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="177">177</span>
            </i>
        </a>
    </span>


 Excellent problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11399">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="107">107</span>
            </i>
        </a>
    </span>


 Good problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11400">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="82">82</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11401">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="14">14</span>
            </i>
        </a>
    </span>


 Bad problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11402">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="18">18</span>
            </i>
        </a>
    </span>


 Horrible problem</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11403">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="19">19</span>
            </i>
        </a>
    </span>


 Trivial problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11404">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="259">259</span>
            </i>
        </a>
    </span>


 Easy problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11405">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="111">111</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11406">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="38">38</span>
            </i>
        </a>
    </span>


 Hard problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11407">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="4">4</span>
            </i>
        </a>
    </span>


 Impossible problem</li> </ul></div></div></div></div><p><a href="https://codeforces.com/contest/2131/problem/F" title="Codeforces Round 1042 (Div. 3)">2131F - Unjust Binary Life</a></p><p>Idea: <a class="rated-user user-orange" href="https://codeforces.com/profile/efishel" title="Master efishel">efishel</a>, <a class="rated-user user-red" href="https://codeforces.com/profile/__baozii__" title="Grandmaster __baozii__">__baozii__</a> <br> Preparation: <a class="rated-user user-orange" href="https://codeforces.com/profile/-firefly-" title="Master -firefly-">-firefly-</a> <br> Analysis: <a class="rated-user user-orange" href="https://codeforces.com/profile/temporary1" title="International Master temporary1">temporary1</a>, <a class="rated-user user-violet" href="https://codeforces.com/profile/reirugan" title="Candidate Master reirugan">reirugan</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>The grid possesses a significant property. Try to generate some grids with random <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-17"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">a</span></span></span><script type="math/tex" id="MathJax-Element-6">a</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-19"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">b</span></span></span><script type="math/tex" id="MathJax-Element-7">b</script>, and understand the distribution of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-21"><span class="MJXp-mn" id="MJXp-Span-22">0</span></span></span><script type="math/tex" id="MathJax-Element-8">0</script>'s and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-23"><span class="MJXp-mn" id="MJXp-Span-24">1</span></span></span><script type="math/tex" id="MathJax-Element-9">1</script>'s.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>For each point <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-25"><span class="MJXp-mo" id="MJXp-Span-26" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27">x</span><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29">y</span><span class="MJXp-mo" id="MJXp-Span-30" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-10">(x, y)</script>, you can derive the answer formula like <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-33"><span class="MJXp-mo" id="MJXp-Span-34" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-35" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">f</span><span class="MJXp-mo" id="MJXp-Span-37" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">x</span><span class="MJXp-mo" id="MJXp-Span-39" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">y</span><span class="MJXp-mo" id="MJXp-Span-41" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-42" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43">g</span><span class="MJXp-mo" id="MJXp-Span-44" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45">x</span><span class="MJXp-mo" id="MJXp-Span-46" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47">y</span><span class="MJXp-mo" id="MJXp-Span-48" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-49" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-11">\min(f(x,y), g(x,y))</script>. Note that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-50"><span class="MJXp-mstyle" id="MJXp-Span-51"><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-53" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">f</span><span class="MJXp-mo" id="MJXp-Span-55" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56">g</span><span class="MJXp-mo" id="MJXp-Span-57" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-58" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-59" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">f</span><span class="MJXp-mo" id="MJXp-Span-61" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">g</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-63">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-64" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mfrac" id="MJXp-Span-65" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-66"><span class="MJXp-mo" id="MJXp-Span-67" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68">f</span><span class="MJXp-mo" id="MJXp-Span-69" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70">g</span><span class="MJXp-mrow" id="MJXp-Span-71"><span class="MJXp-mo" id="MJXp-Span-72" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-73">2</span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-12">\displaystyle\min(f,g)=\frac{f+g}{2}-\frac{|f-g|}{2}</script></p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2131/problem/F" title="Codeforces Round 1042 (Div. 3)">2131F - Unjust Binary Life</a></h3><div class="ttypography"><div class="problem-statement"><div><p>We first determine how to compute $$$f(x,y)$$$ for a specific pair $$$(x,y)$$$. Suppose you are currently on cell $$$(i,j)$$$, then we have that $$$a_i \oplus b_j = 0$$$. Then we can move to cell $$$(i+1, j)$$$ if and only if $$$$$$ \begin{align*} a_{i+1} \oplus b_j &amp;= 0\\ \Updownarrow\\ (a_i \oplus b_j) \oplus (a_{i+1} \oplus b_j) &amp;= 0\oplus0\\ \Updownarrow\\ a_i \oplus a_{i+1} &amp;= 0\\ \Updownarrow\\ a_i &amp;= a_{i+1} \end{align*} $$$$$$ Thus, our condition is equivalent to $$$a_i = a_{i+1}$$$. Similarly, we can move to cell $$$(i, j+1)$$$ if and only if $$$b_j = b_{j+1}$$$. This implies that we must have $$$a_1 = ... = a_x = b_1 = ... = b_y$$$. Let us define $$$\mathrm{cnt}_0(x, y)$$$ to be the number of zeros in $$$a[1, x]$$$ plus the number of zeros in $$$b[1, y]$$$, and similarly define $$$\mathrm{cnt}_1(x, y)$$$. Then we have that $$$$$$f(x,y) = \min(\mathrm{cnt}_0(x, y), \mathrm{cnt}_1(x, y))$$$$$$</p><p>But notice that the minimum of two values is equal to their average minus half their difference. So we have that $$$$$$ \begin{align*} f(x,y) &amp;= \frac{\mathrm{cnt}_0(x, y) + \mathrm{cnt}_1(x, y)}{2} - \frac{|\mathrm{cnt}_0(x, y) - \mathrm{cnt}_1(x, y)|}{2}\\ &amp;= \frac{x+y}{2} - \frac{|\mathrm{cnt}_0(x, y) - \mathrm{cnt}_1(x, y)|}{2} \end{align*} $$$$$$ By summing, we get $$$$$$ \begin{align*} \sum f(x,y) &amp;= \sum \frac{x+y}{2} - \sum \frac{|\mathrm{cnt}_0(x, y) - \mathrm{cnt}_1(x, y)|}{2}\\ &amp;= \frac{n^2(n+1)}{2} - \sum \frac{|\mathrm{cnt}_0(x, y) - \mathrm{cnt}_1(x, y)|}{2} \end{align*} $$$$$$ Now, we only have to compute $$$\sum |\mathrm{cnt}_0(x, y) - \mathrm{cnt}_1(x, y)|$$$. But observe that $$$$$$ \begin{align*} |\mathrm{cnt}_0(x, y) - \mathrm{cnt}_1(x, y)| &amp;= |\mathrm{cnt}_0(x, 0) + \mathrm{cnt}_0(0, y) - \mathrm{cnt}_1(x, 0) - \mathrm{cnt}_1(0, y)|\\ &amp;= |(\mathrm{cnt}_0(x, 0) - \mathrm{cnt}_1(x, 0)) - (\mathrm{cnt}_1(0, y) - \mathrm{cnt}_0(0, y))| \end{align*} $$$$$$ We now define $$$$$$ \begin{align*} \mathrm{prea}(x) &amp;= \mathrm{cnt}_0(x, 0) - \mathrm{cnt}_1(x, 0)\\ \mathrm{preb}(y) &amp;= \mathrm{cnt}_1(0, y) - \mathrm{cnt}_0(0, y) \end{align*} $$$$$$ That is, $$$\mathrm{prea}(x)$$$ is the number of zeros minus the number of ones in $$$a[1, x]$$$, and $$$\mathrm{preb}(y)$$$ is the number of ones minus the number of zeros in $$$b[1, y]$$$. Note that these are computable in $$$O(n)$$$ with prefix sums.</p><p>Then we have that $$$$$$\sum |\mathrm{cnt}_0(x, y) - \mathrm{cnt}_1(x, y)| = \sum |\mathrm{prea}(x) - \mathrm{preb}(y)|$$$$$$</p><p>Now, for a fixed $$$x$$$, we would like to add $$$\mathrm{prea}(x)$$$ for every smaller $$$\mathrm{preb}(y)$$$ value, and subtract $$$\mathrm{prea}(x)$$$ for every greater or equal $$$\mathrm{preb}(y)$$$ value. Similarly, for a fixed $$$y$$$, we would like to add $$$\mathrm{preb}(y)$$$ for every smaller or equal $$$\mathrm{prea}(x)$$$ value, and subtract $$$\mathrm{preb}(y)$$$ for every greater $$$\mathrm{prea}(x)$$$ value. This can be done by sorting $$$\mathrm{prea}$$$ and $$$\mathrm{preb}$$$, and traversing them simultaneously by two-pointers.</p><p>This allows us to compute the final answer.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="com">#define</span><span class="pln"> f first
</span><span class="com">#define</span><span class="pln"> s second
</span><span class="com">#define</span><span class="pln"> ll </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> pii pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> pli pair</span><span class="pun">&lt;</span><span class="pln">ll</span><span class="pun">,</span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> pll pair</span><span class="pun">&lt;</span><span class="pln">ll</span><span class="pun">,</span><span class="pln">ll</span><span class="pun">&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> tiii tuple</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="kwd">int</span><span class="pun">,</span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> tiiii tuple</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="kwd">int</span><span class="pun">,</span><span class="kwd">int</span><span class="pun">,</span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> pb push_back
</span><span class="com">#define</span><span class="pln"> eb emplace_back
</span><span class="com">#define</span><span class="pln"> emp emplace
</span><span class="com">#define</span><span class="pln"> mkp make_pair
</span><span class="com">#define</span><span class="pln"> mkt make_tuple
</span><span class="com">#define</span><span class="pln"> vctr vector
</span><span class="com">#define</span><span class="pln"> arr array
</span><span class="com">#define</span><span class="pln"> all</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> x</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> x</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">()</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> amin</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln">b</span><span class="pun">)</span><span class="pln"> a </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln">b</span><span class="pun">)</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> amax</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln">b</span><span class="pun">)</span><span class="pln"> a </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln">b</span><span class="pun">)</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> brick</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="com">#x &lt;&lt; " = " &lt;&lt; (x) &lt;&lt; " | "</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> dbg</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="com">#x &lt;&lt; " = " &lt;&lt; (x) &lt;&lt; '\n'</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> vdbg</span><span class="pun">(</span><span class="pln">a</span><span class="pun">)</span><span class="pln"> cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="com">#a &lt;&lt; " = "; for(auto _x : a)cout &lt;&lt; _x &lt;&lt; ' '; cout &lt;&lt; '\n'</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> adbg</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="com">#a &lt;&lt; " = "; for(int _i = 1; _i &lt;= n; ++_i)cout &lt;&lt; a[_i] &lt;&lt; ' '; cout &lt;&lt; '\n'</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> adbg0</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="com">#a &lt;&lt; " = "; for(int _i = 0; _i &lt; n; ++_i)cout &lt;&lt; a[_i] &lt;&lt; ' '; cout &lt;&lt; '\n'</span><span class="pln">
mt19937 rng</span><span class="pun">(</span><span class="kwd">static_cast</span><span class="str">&lt;uint32_t&gt;</span><span class="pun">(</span><span class="pln">chrono</span><span class="pun">::</span><span class="pln">steady_clock</span><span class="pun">::</span><span class="pln">now</span><span class="pun">().</span><span class="pln">time_since_epoch</span><span class="pun">().</span><span class="pln">count</span><span class="pun">()));</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> uid</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> b</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> uniform_int_distribution</span><span class="str">&lt;int&gt;</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln">b</span><span class="pun">)(</span><span class="pln">rng</span><span class="pun">);</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
ll uld</span><span class="pun">(</span><span class="pln">ll a</span><span class="pun">,</span><span class="pln"> ll b</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> uniform_int_distribution</span><span class="str">&lt;ll&gt;</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln">b</span><span class="pun">)(</span><span class="pln">rng</span><span class="pun">);</span><span class="pln"> </span><span class="pun">}</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MOD </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e9</span><span class="pun">+</span><span class="lit">7</span><span class="pun">;</span><span class="pln"> </span><span class="com">// 998244353;</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">200005</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> b</span><span class="pun">[</span><span class="lit">200005</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> c</span><span class="pun">[</span><span class="lit">200005</span><span class="pun">][</span><span class="lit">2</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> d</span><span class="pun">[</span><span class="lit">200005</span><span class="pun">][</span><span class="lit">2</span><span class="pun">];</span><span class="pln">
ll pf</span><span class="pun">[</span><span class="lit">400005</span><span class="pun">][</span><span class="lit">2</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> cnt</span><span class="pun">[</span><span class="lit">400005</span><span class="pun">];</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	ios_base</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
	cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="pln">NULL</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> tt</span><span class="pun">;</span><span class="pln">
	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> tt</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tt</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
		cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">string</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
		cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">'1'</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">'1'</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> o </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">*</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			pf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			pf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			cnt</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]+(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
			c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]+(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
			pf</span><span class="pun">[</span><span class="pln">o</span><span class="pun">+</span><span class="pln">c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]-</span><span class="pln">c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
			pf</span><span class="pun">[</span><span class="pln">o</span><span class="pun">+</span><span class="pln">c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]-</span><span class="pln">c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
			cnt</span><span class="pun">[</span><span class="pln">o</span><span class="pun">+</span><span class="pln">c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]-</span><span class="pln">c</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">*</span><span class="pln">n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			pf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> pf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
			pf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> pf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
			cnt</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]+(</span><span class="pln">b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
			d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]+(</span><span class="pln">b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		ll ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">int</span><span class="pln"> z </span><span class="pun">=</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]-</span><span class="pln">d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
			</span><span class="com">// 0 worth it when delta &lt;= z</span><span class="pln">
			ans </span><span class="pun">+=</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]*(</span><span class="pln">ll</span><span class="pun">)</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">o</span><span class="pun">+</span><span class="pln">z</span><span class="pun">]+</span><span class="pln">pf</span><span class="pun">[</span><span class="pln">o</span><span class="pun">+</span><span class="pln">z</span><span class="pun">][</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
			ans </span><span class="pun">+=</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]*(</span><span class="pln">ll</span><span class="pun">)(</span><span class="pln">n</span><span class="pun">-</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">o</span><span class="pun">+</span><span class="pln">z</span><span class="pun">])+</span><span class="pln">pf</span><span class="pun">[</span><span class="lit">2</span><span class="pun">*</span><span class="pln">n</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]-</span><span class="pln">pf</span><span class="pun">[</span><span class="pln">o</span><span class="pun">+</span><span class="pln">z</span><span class="pun">][</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11408">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="225">225</span>
            </i>
        </a>
    </span>


 Excellent problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11409">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="83">83</span>
            </i>
        </a>
    </span>


 Good problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11410">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="5">5</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11411">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="16">16</span>
            </i>
        </a>
    </span>


 Bad problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11412">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="9">9</span>
            </i>
        </a>
    </span>


 Horrible problem</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11413">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="3">3</span>
            </i>
        </a>
    </span>


 Trivial problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11414">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="9">9</span>
            </i>
        </a>
    </span>


 Easy problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11415">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="18">18</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11416">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="357">357</span>
            </i>
        </a>
    </span>


 Hard problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11417">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="19">19</span>
            </i>
        </a>
    </span>


 Impossible problem</li> </ul></div></div></div></div><p><a href="https://codeforces.com/contest/2131/problem/G" title="Codeforces Round 1042 (Div. 3)">2131G - Wafu!</a></p><p>Idea: <a class="rated-user user-orange" href="https://codeforces.com/profile/-firefly-" title="Master -firefly-">-firefly-</a> <br> Preparation: <a class="rated-user user-orange" href="https://codeforces.com/profile/-firefly-" title="Master -firefly-">-firefly-</a> <br> Analysis: <a class="rated-user user-red" href="https://codeforces.com/profile/__baozii__" title="Grandmaster __baozii__">__baozii__</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>For a set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-74"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">S</span></span></span><script type="math/tex" id="MathJax-Element-13">S</script>, how many operations are required to transform <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-76"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77">S</span></span></span><script type="math/tex" id="MathJax-Element-14">S</script> into <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-78"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79">S</span><span class="MJXp-mo" id="MJXp-Span-80" style="margin-left: 0.267em; margin-right: 0.267em;">∖</span><span class="MJXp-mrow" id="MJXp-Span-81"><span class="MJXp-mo" id="MJXp-Span-82" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-83" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">S</span><span class="MJXp-mo" id="MJXp-Span-85" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><script type="math/tex" id="MathJax-Element-15">S \setminus {\min(S)}</script>?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-86"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">S</span></span></span><script type="math/tex" id="MathJax-Element-16">S</script> can be represented as a binary number (though very large).</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>How to calculate the answer when elements in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-88"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89">S</span></span></span><script type="math/tex" id="MathJax-Element-17">S</script> are very large?</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><div><h3><a href="https://codeforces.com/contest/2131/problem/G" title="Codeforces Round 1042 (Div. 3)">2131G - Wafu!</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Read the hints.</p><p>For simplicity, we will decrease all integers in $$$S$$$ by $$$1$$$.</p><p>For a set $$$S$$$, consider a binary number $$$f(S)=\sum_{v \in S}2^v$$$. The given operation is equivalent to:</p><ul> <li> Find the lowest set bit of $$$f(S)$$$, let it be $$$b$$$;</li><li> Flip all bits that are no larger than $$$b$$$. </li></ul> <p>Notice that this is exactly the same as decreasing $$$f(S)$$$ by $$$1$$$. In other words, if we denote $$$S^\prime$$$ as the set obtained by operating on $$$S$$$ once, then $$$f(S^\prime)=f(S)-1$$$. Hence, the number of operations required to transform $$$S$$$ into $$$S \setminus \{\min(S)\}$$$ is $$$2^{\min(S)}$$$. </p><p>With the above information, we can solve the problem by simulating the operations efficiently. </p><p>Firstly, consider when $$$v=\min(S)$$$, we need $$$2^v$$$ operations to completely remove $$$v$$$ from $$$S$$$. Let $$$F(v)$$$ be the product of all score multipliers contributed by these operations. We can calculate $$$F(v)$$$ efficiently using dynamic programming:</p><ul> <li> $$$F(0)=1$$$;</li><li> $$$F(i)=(i+1)\cdot\prod_{j&lt;i}F(j)$$$.</li></ul><p>This is because when we perform the operation once, $$$v$$$ is removed and $$$0,1,\ldots,v-1$$$ are inserted into $$$S$$$.</p><p>We will now simulate all $$$k$$$ operations by considering blocks of $$$2^v$$$. Iterate the elements in $$$S$$$ from small to large. Let the current element be $$$v$$$. There are two cases:</p><ul> <li> $$$k\ge2^v$$$: we perform $$$2^v$$$ operations on $$$S$$$ to remove $$$v$$$. $$$k$$$ becomes $$$k-2^v$$$ and the final score is multiplied by $$$F(v)$$$.</li><li> $$$k&lt;2^v$$$: this case is more complicated. Consider dynamic programming: let $$$P(i,j)$$$ be the product of all score multipliers when $$$\min(S)=i$$$ and there are $$$j$$$ operations left. Here, we guarantee that $$$j&lt;2^i$$$. The base cases and transitions of $$$P(i,j)$$$ are as follows:<ul> <li> $$$P(i,0)=1$$$, since there are no more operations left;</li><li> Otherwise, since $$$j$$$ is positive, we first operate once, with score $$$(i+1)$$$. $$$S$$$ now contains all integers less than $$$i$$$. Iterate these newly inserted elements from small to large. Let the current element be $$$w$$$. There are again two cases:<ul> <li> $$$j \ge 2^w$$$: we perform $$$2^w$$$ operations on $$$S$$$ to remove $$$w$$$. $$$j$$$ becomes $$$j-2^w$$$ and the score is multiplied by $$$F(w)$$$.</li><li> $$$j &lt; 2^w$$$: score is multiplied by $$$P(w,j)$$$, and the iteration is terminated. </li></ul><p>Note that since $$$2^{30} &gt; 10^9$$$, the iteration will definitely terminate when $$$w\ge30$$$. </p></li></ul><p>Then the iteration is terminated. This is because $$$k$$$ operations is not enough to completely remove $$$v$$$ from $$$S$$$. Thus, all elements greater than $$$v$$$ will never be affected. </p></li></ul><p>The final complexity is $$$O(n\log n + \log^2 k)$$$ per test case.</p></div></div></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Code (Python)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="pln">MOD </span><span class="pun">=</span><span class="pln"> </span><span class="lit">10</span><span class="pln"> </span><span class="pun">**</span><span class="pln"> </span><span class="lit">9</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">7</span><span class="pln">

dp </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">31</span><span class="pln">
dp</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">31</span><span class="pun">):</span><span class="pln">
    dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> j </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">i</span><span class="pun">):</span><span class="pln">
        dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD

</span><span class="kwd">def</span><span class="pln"> dfs</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">):</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> k </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    ans </span><span class="pun">=</span><span class="pln"> v </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    v </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">v </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">30</span><span class="pun">)</span><span class="pln">
    k </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> j </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">v </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> k </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> j</span><span class="pun">:</span><span class="pln">
            ans </span><span class="pun">=</span><span class="pln"> ans </span><span class="pun">*</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD
            k </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> j
        </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
            ans </span><span class="pun">=</span><span class="pln"> ans </span><span class="pun">*</span><span class="pln"> dfs</span><span class="pun">(</span><span class="pln">j</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD
            </span><span class="kwd">break</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> ans

</span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())):</span><span class="pln">
    n</span><span class="pun">,</span><span class="pln"> k </span><span class="pun">=</span><span class="pln"> map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">())</span><span class="pln">
    s </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">(</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">()))</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
        s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    s</span><span class="pun">.</span><span class="pln">sort</span><span class="pun">()</span><span class="pln">
    ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> v </span><span class="kwd">in</span><span class="pln"> s</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> v </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">30</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> k </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> v</span><span class="pun">:</span><span class="pln">
            k </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> v
            ans </span><span class="pun">=</span><span class="pln"> ans </span><span class="pun">*</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD
        </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
            ans </span><span class="pun">=</span><span class="pln"> ans </span><span class="pun">*</span><span class="pln"> dfs</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> MOD
            </span><span class="kwd">break</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">)</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11418">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="138">138</span>
            </i>
        </a>
    </span>


 Excellent problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11419">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="41">41</span>
            </i>
        </a>
    </span>


 Good problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11420">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="11">11</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11421">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="8">8</span>
            </i>
        </a>
    </span>


 Bad problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11422">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="2">2</span>
            </i>
        </a>
    </span>


 Horrible problem</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11423">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="6">6</span>
            </i>
        </a>
    </span>


 Trivial problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11424">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="33">33</span>
            </i>
        </a>
    </span>


 Easy problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11425">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="103">103</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11426">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="50">50</span>
            </i>
        </a>
    </span>


 Hard problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11427">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="4">4</span>
            </i>
        </a>
    </span>


 Impossible problem</li> </ul></div></div></div></div><p><a href="https://codeforces.com/contest/2131/problem/H" title="Codeforces Round 1042 (Div. 3)">2131H - Sea, You &amp; copriMe</a></p><p>Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/__baozii__" title="Grandmaster __baozii__">__baozii__</a>, <a class="rated-user user-orange" href="https://codeforces.com/profile/-firefly-" title="Master -firefly-">-firefly-</a> <br> Preparation: <a class="rated-user user-orange" href="https://codeforces.com/profile/-firefly-" title="Master -firefly-">-firefly-</a> <br> Analysis: <a class="rated-user user-orange" href="https://codeforces.com/profile/-firefly-" title="Master -firefly-">-firefly-</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Let's consider an easier problem: how do we find one coprime pair from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-90"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">a</span></span></span><script type="math/tex" id="MathJax-Element-18">a</script>?</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 1</b><div class="spoiler-content" style="display: block;"><p>If there exists one coprime pair, it means there exists an <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-92"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">i</span></span></span><script type="math/tex" id="MathJax-Element-19">i</script> such that</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-94"><span class="MJXp-mstyle" id="MJXp-Span-95"><span class="MJXp-munderover" id="MJXp-Span-96"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-102" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103">n</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-97" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-98" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99">j</span><span class="MJXp-mo" id="MJXp-Span-100">=</span><span class="MJXp-mn" id="MJXp-Span-101">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-104" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mo" id="MJXp-Span-105" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-106" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-109" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-110" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-113" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-114" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-115" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-116">1</span><span class="MJXp-mo" id="MJXp-Span-117" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-118" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-119" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-122" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-124">1</span><span class="MJXp-mo" id="MJXp-Span-125" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-126" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-127">0</span></span></span></span><script type="math/tex" id="MathJax-Element-20">\displaystyle\sum_{j=1}^{n}[\gcd(a_i, a_j)=1] - [a_i = 1] > 0</script></center><p>In other words, there are at least one other indices <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-128"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">j</span></span></span><script type="math/tex" id="MathJax-Element-21">j</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-130"><span class="MJXp-mo" id="MJXp-Span-131" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-132" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-135" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-136" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-139" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-140" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-141" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-142">1</span></span></span><script type="math/tex" id="MathJax-Element-22">\gcd(a_i, a_j)=1</script>.</p><p>Therefore, we strengthen the problem that we need to find <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-143"><span class="MJXp-mstyle" id="MJXp-Span-144"><span class="MJXp-munderover" id="MJXp-Span-145"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-151" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">n</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-146" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-147" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">j</span><span class="MJXp-mo" id="MJXp-Span-149">=</span><span class="MJXp-mn" id="MJXp-Span-150">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-153" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mo" id="MJXp-Span-154" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-155" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-156"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-158" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-159" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-160"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-162" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-163" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-164" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-165">1</span><span class="MJXp-mo" id="MJXp-Span-166" style="margin-left: 0em; margin-right: 0em;">]</span></span></span></span><script type="math/tex" id="MathJax-Element-23">\displaystyle\sum_{j=1}^{n}[\gcd(a_i, a_j)=1]</script> for each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-167"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">i</span></span></span><script type="math/tex" id="MathJax-Element-24">i</script>. Here, we introduce two ways to solve the formula.</p><p>In the following discussion, we denote <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-169"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">f</span><span class="MJXp-mo" id="MJXp-Span-171" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">d</span><span class="MJXp-mo" id="MJXp-Span-173" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-25">f(d)</script> to be the count of elements in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-174"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">a</span></span></span><script type="math/tex" id="MathJax-Element-26">a</script> divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-176"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">d</span></span></span><script type="math/tex" id="MathJax-Element-27">d</script>. We can precompute <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-178"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">f</span><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-181">1</span><span class="MJXp-mo" id="MJXp-Span-182" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-183" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">f</span><span class="MJXp-mo" id="MJXp-Span-185" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-186">2</span><span class="MJXp-mo" id="MJXp-Span-187" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-189" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-190" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">f</span><span class="MJXp-mo" id="MJXp-Span-192" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">m</span><span class="MJXp-mo" id="MJXp-Span-194" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-28">f(1), f(2), \dots, f(m)</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-195"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196">O</span><span class="MJXp-mo" id="MJXp-Span-197" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">m</span><span class="MJXp-mi" id="MJXp-Span-199">log</span><span class="MJXp-mo" id="MJXp-Span-200" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">m</span><span class="MJXp-mo" id="MJXp-Span-202" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-29">O(m\log m)</script> time using harmonic trick.</p> <div class="spoiler"><b class="spoiler-title">Principle of Inclusion-Exclusion (PIE)</b><div class="spoiler-content" style="display: block;"><p>For each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-203"><span class="MJXp-msubsup" id="MJXp-Span-204"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-206" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-30">a_i</script>, find the set of distinct prime factors of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-207"><span class="MJXp-msubsup" id="MJXp-Span-208"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-210" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-31">a_i</script>. Let's call this set <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-211"><span class="MJXp-msubsup" id="MJXp-Span-212"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213" style="margin-right: 0.05em;">P</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-214" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-32">P_i</script>. For each prime factor <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-215"><span class="MJXp-msubsup" id="MJXp-Span-216"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-218" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-219" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-msubsup" id="MJXp-Span-220"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221" style="margin-right: 0.05em;">P</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-222" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-33">p_k \in P_i</script>, let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-223"><span class="MJXp-msubsup" id="MJXp-Span-224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-226" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-34">S_k</script> be the set of elements in the array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-227"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228">a</span></span></span><script type="math/tex" id="MathJax-Element-35">a</script> that are divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-229"><span class="MJXp-msubsup" id="MJXp-Span-230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-232" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-36">p_k</script>.</p><p>Any number that is NOT coprime to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-233"><span class="MJXp-msubsup" id="MJXp-Span-234"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-236" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-37">a_i</script> must share at least one prime factor with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-237"><span class="MJXp-msubsup" id="MJXp-Span-238"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-240" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-38">a_i</script>, so it must belongs to the set union <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-241"><span class="MJXp-msubsup" id="MJXp-Span-242"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-243" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-244" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-245" style="margin-left: 0.267em; margin-right: 0.267em;">∪</span><span class="MJXp-msubsup" id="MJXp-Span-246"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-248" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-249" style="margin-left: 0.267em; margin-right: 0.267em;">∪</span><span class="MJXp-mo" id="MJXp-Span-250" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-251" style="margin-left: 0.267em; margin-right: 0.267em;">∪</span><span class="MJXp-msubsup" id="MJXp-Span-252"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-254" style="vertical-align: -0.4em;">k</span></span></span></span><script type="math/tex" id="MathJax-Element-39">S_1 \cup S_2 \cup \dots \cup S_k</script>. By PIE we can calculate the size of the union:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-255"><span class="MJXp-mstyle" id="MJXp-Span-256"><span class="MJXp-mrow" id="MJXp-Span-257"><span class="MJXp-mo" id="MJXp-Span-258" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-261" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-262" style="margin-left: 0.267em; margin-right: 0.267em;">∪</span><span class="MJXp-msubsup" id="MJXp-Span-263"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-265" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0.267em; margin-right: 0.267em;">∪</span><span class="MJXp-mo" id="MJXp-Span-267" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-268" style="margin-left: 0.267em; margin-right: 0.267em;">∪</span><span class="MJXp-msubsup" id="MJXp-Span-269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-271" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mrow" id="MJXp-Span-272"><span class="MJXp-mo" id="MJXp-Span-273" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-275"><span class=""><span class="MJXp-mo" id="MJXp-Span-276" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-277" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">r</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-279"><span class="MJXp-mo" id="MJXp-Span-280" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-281"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-283" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mrow" id="MJXp-Span-284"><span class="MJXp-mo" id="MJXp-Span-285" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-286" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-munderover" id="MJXp-Span-287"><span class=""><span class="MJXp-mo" id="MJXp-Span-288" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-289" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">r</span><span class="MJXp-mo" id="MJXp-Span-291">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">s</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-293"><span class="MJXp-mo" id="MJXp-Span-294" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-295"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-297" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-298" style="margin-left: 0.267em; margin-right: 0.267em;">∩</span><span class="MJXp-msubsup" id="MJXp-Span-299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-301" style="vertical-align: -0.4em;">s</span></span><span class="MJXp-mrow" id="MJXp-Span-302"><span class="MJXp-mo" id="MJXp-Span-303" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-304" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-munderover" id="MJXp-Span-305"><span class=""><span class="MJXp-mo" id="MJXp-Span-306" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-307" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">r</span><span class="MJXp-mo" id="MJXp-Span-309">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">s</span><span class="MJXp-mo" id="MJXp-Span-311">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">t</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-313"><span class="MJXp-mo" id="MJXp-Span-314" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-317" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-318" style="margin-left: 0.267em; margin-right: 0.267em;">∩</span><span class="MJXp-msubsup" id="MJXp-Span-319"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-321" style="vertical-align: -0.4em;">s</span></span><span class="MJXp-mo" id="MJXp-Span-322" style="margin-left: 0.267em; margin-right: 0.267em;">∩</span><span class="MJXp-msubsup" id="MJXp-Span-323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-325" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-326"><span class="MJXp-mo" id="MJXp-Span-327" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-328" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-329" style="margin-left: 0em; margin-right: 0em;">⋯</span></span></span></span><script type="math/tex" id="MathJax-Element-40">\displaystyle|S_1 \cup S_2 \cup \dots \cup S_k| = \sum_{r} |S_r| - \sum_{r<s} |S_r \cap S_s| + \sum_{r<s<t} |S_r \cap S_s \cap S_t| - \cdots</script></center><p>Here:</p> <ul>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-330"><span class="MJXp-mrow" id="MJXp-Span-331"><span class="MJXp-mo" id="MJXp-Span-332" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-333"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-335" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mrow" id="MJXp-Span-336"><span class="MJXp-mo" id="MJXp-Span-337" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex" id="MathJax-Element-41">|S_r|</script> is the count of elements in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-338"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339">a</span></span></span><script type="math/tex" id="MathJax-Element-42">a</script> divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-340"><span class="MJXp-msubsup" id="MJXp-Span-341"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-343" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-43">p_r</script>, which is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-344"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345">f</span><span class="MJXp-mo" id="MJXp-Span-346" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-347"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-349" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-350" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-44">f(p_r)</script>.</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-351"><span class="MJXp-mrow" id="MJXp-Span-352"><span class="MJXp-mo" id="MJXp-Span-353" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-354"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-356" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-357" style="margin-left: 0.267em; margin-right: 0.267em;">∩</span><span class="MJXp-msubsup" id="MJXp-Span-358"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-360" style="vertical-align: -0.4em;">s</span></span><span class="MJXp-mrow" id="MJXp-Span-361"><span class="MJXp-mo" id="MJXp-Span-362" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex" id="MathJax-Element-45">|S_r \cap S_s|</script> is the count of elements in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-363"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364">a</span></span></span><script type="math/tex" id="MathJax-Element-46">a</script> divisible by both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-365"><span class="MJXp-msubsup" id="MJXp-Span-366"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-368" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-47">p_r</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-369"><span class="MJXp-msubsup" id="MJXp-Span-370"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-372" style="vertical-align: -0.4em;">s</span></span></span></span><script type="math/tex" id="MathJax-Element-48">p_s</script>, that is, divisible by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-373"><span class="MJXp-msubsup" id="MJXp-Span-374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-376" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-msubsup" id="MJXp-Span-377"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-379" style="vertical-align: -0.4em;">s</span></span></span></span><script type="math/tex" id="MathJax-Element-49">p_rp_s</script>, which is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">f</span><span class="MJXp-mo" id="MJXp-Span-382" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-385" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-msubsup" id="MJXp-Span-386"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-388" style="vertical-align: -0.4em;">s</span></span><span class="MJXp-mo" id="MJXp-Span-389" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-50">f(p_rp_s)</script>.</li>   <li>Similarly, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-390"><span class="MJXp-mrow" id="MJXp-Span-391"><span class="MJXp-mo" id="MJXp-Span-392" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-393"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-395" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-396" style="margin-left: 0.267em; margin-right: 0.267em;">∩</span><span class="MJXp-msubsup" id="MJXp-Span-397"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-399" style="vertical-align: -0.4em;">s</span></span><span class="MJXp-mo" id="MJXp-Span-400" style="margin-left: 0.267em; margin-right: 0.267em;">∩</span><span class="MJXp-msubsup" id="MJXp-Span-401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-403" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-404"><span class="MJXp-mo" id="MJXp-Span-405" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex" id="MathJax-Element-51">|S_r \cap S_s \cap S_t|</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">f</span><span class="MJXp-mo" id="MJXp-Span-408" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-409"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-411" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-msubsup" id="MJXp-Span-412"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-414" style="vertical-align: -0.4em;">s</span></span><span class="MJXp-msubsup" id="MJXp-Span-415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-417" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-418" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-52">f(p_rp_sp_t)</script>.</li> </ul><p>Since <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-419"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420">f</span><span class="MJXp-mo" id="MJXp-Span-421" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422">d</span><span class="MJXp-mo" id="MJXp-Span-423" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-53">f(d)</script> has been precomputed, we can compute <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-424"><span class="MJXp-mrow" id="MJXp-Span-425"><span class="MJXp-mo" id="MJXp-Span-426" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-427"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-428" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-429" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-430" style="margin-left: 0.267em; margin-right: 0.267em;">∪</span><span class="MJXp-msubsup" id="MJXp-Span-431"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-433" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-434" style="margin-left: 0.267em; margin-right: 0.267em;">∪</span><span class="MJXp-mo" id="MJXp-Span-435" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-436" style="margin-left: 0.267em; margin-right: 0.267em;">∪</span><span class="MJXp-msubsup" id="MJXp-Span-437"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-439" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mrow" id="MJXp-Span-440"><span class="MJXp-mo" id="MJXp-Span-441" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><script type="math/tex" id="MathJax-Element-54">|S_1 \cup S_2 \cup \dots \cup S_k|</script> for each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-442"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443">i</span></span></span><script type="math/tex" id="MathJax-Element-55">i</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-444"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-445">O</span><span class="MJXp-mo" id="MJXp-Span-446" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-447"><span class="MJXp-mn" id="MJXp-Span-448" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-449" style="vertical-align: 0.5em;"><span class="MJXp-mrow" id="MJXp-Span-450"><span class="MJXp-mo" id="MJXp-Span-451">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-452"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453" style="margin-right: 0.05em;">P</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-454" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mrow" id="MJXp-Span-455"><span class="MJXp-mo" id="MJXp-Span-456">|</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-457" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-56">O(2^{|P_i|})</script> time. Because <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-458"><span class="MJXp-mn" id="MJXp-Span-459">2</span><span class="MJXp-mo" id="MJXp-Span-460" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mn" id="MJXp-Span-461">3</span><span class="MJXp-mo" id="MJXp-Span-462" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mn" id="MJXp-Span-463">5</span><span class="MJXp-mo" id="MJXp-Span-464" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mn" id="MJXp-Span-465">7</span><span class="MJXp-mo" id="MJXp-Span-466" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mn" id="MJXp-Span-467">11</span><span class="MJXp-mo" id="MJXp-Span-468" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mn" id="MJXp-Span-469">13</span><span class="MJXp-mo" id="MJXp-Span-470" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mn" id="MJXp-Span-471">17</span><span class="MJXp-mo" id="MJXp-Span-472" style="margin-left: 0.267em; margin-right: 0.267em;">×</span><span class="MJXp-mn" id="MJXp-Span-473">19</span><span class="MJXp-mo" id="MJXp-Span-474" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-475">9699690</span><span class="MJXp-mo" id="MJXp-Span-476" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-msubsup" id="MJXp-Span-477"><span class="MJXp-mn" id="MJXp-Span-478" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-479" style="vertical-align: 0.5em;">6</span></span></span></span><script type="math/tex" id="MathJax-Element-57">2 \times 3 \times 5 \times 7 \times 11 \times 13 \times 17 \times 19 = 9699690 > 10^6</script>, the size of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-480"><span class="MJXp-msubsup" id="MJXp-Span-481"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482" style="margin-right: 0.05em;">P</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-483" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-58">P_i</script> won't exceed <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-484"><span class="MJXp-mn" id="MJXp-Span-485">7</span></span></span><script type="math/tex" id="MathJax-Element-59">7</script>. Therefore, the operation number is roughly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-486"><span class="MJXp-msubsup" id="MJXp-Span-487"><span class="MJXp-mn" id="MJXp-Span-488" style="margin-right: 0.05em;">2</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-489" style="vertical-align: 0.5em;">7</span></span><span class="MJXp-mo" id="MJXp-Span-490" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">n</span><span class="MJXp-mo" id="MJXp-Span-492" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-493">3</span><span class="MJXp-mo" id="MJXp-Span-494" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-495"><span class="MJXp-mn" id="MJXp-Span-496" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-497" style="vertical-align: 0.5em;">7</span></span></span></span><script type="math/tex" id="MathJax-Element-60">2^7 \cdot n \le 3 \cdot 10^7</script>, which is acceptable.</p><p>After finding the count of elements that is NOT coprime to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-498"><span class="MJXp-msubsup" id="MJXp-Span-499"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-500" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-501" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-61">a_i</script>, we can then easily obtain <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-502"><span class="MJXp-mstyle" id="MJXp-Span-503"><span class="MJXp-munderover" id="MJXp-Span-504"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-510" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511">n</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-505" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-506" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-507">j</span><span class="MJXp-mo" id="MJXp-Span-508">=</span><span class="MJXp-mn" id="MJXp-Span-509">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-512" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mo" id="MJXp-Span-513" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-514" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-515"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-517" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-518" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-519"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-520" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-521" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-522" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-523" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-524">1</span><span class="MJXp-mo" id="MJXp-Span-525" style="margin-left: 0em; margin-right: 0em;">]</span></span></span></span><script type="math/tex" id="MathJax-Element-62">\displaystyle\sum_{j=1}^{n}[\gcd(a_i, a_j)=1]</script> by subtraction.</p></div></div> <div class="spoiler"><b class="spoiler-title">Mobius Inversion</b><div class="spoiler-content" style="display: block;"><p>Another advanced approach to find the result is Mobius inversion. We will assume that you know the definition and property of mobius function <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-526"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527">μ</span><span class="MJXp-mo" id="MJXp-Span-528" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">n</span><span class="MJXp-mo" id="MJXp-Span-530" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-63">\mu(n)</script> in the following discussion.</p><p>Since we know that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-531"><span class="MJXp-mstyle" id="MJXp-Span-532"><span class="MJXp-mo" id="MJXp-Span-533" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mo" id="MJXp-Span-534" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-535" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536">x</span><span class="MJXp-mo" id="MJXp-Span-537" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">y</span><span class="MJXp-mo" id="MJXp-Span-539" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-540" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-541">1</span><span class="MJXp-mo" id="MJXp-Span-542" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-543" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-544"><span class=""><span class="MJXp-mo" id="MJXp-Span-545" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-546" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-547">d</span><span class="MJXp-mrow" id="MJXp-Span-548"><span class="MJXp-mo" id="MJXp-Span-549">|</span></span><span class="MJXp-mo" id="MJXp-Span-550">gcd</span><span class="MJXp-mo" id="MJXp-Span-551">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">x</span><span class="MJXp-mo" id="MJXp-Span-553">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">y</span><span class="MJXp-mo" id="MJXp-Span-555">)</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-556">μ</span><span class="MJXp-mo" id="MJXp-Span-557" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558">d</span><span class="MJXp-mo" id="MJXp-Span-559" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><script type="math/tex" id="MathJax-Element-64">\displaystyle[\gcd(x, y) = 1] = \sum_{d|\gcd(x, y)}\mu(d)</script>, we can expand the orginal formula as:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-560"><span class="MJXp-mstyle" id="MJXp-Span-561"><span class="MJXp-munderover" id="MJXp-Span-562"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-568" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569">n</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-563" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-564" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565">j</span><span class="MJXp-mo" id="MJXp-Span-566">=</span><span class="MJXp-mn" id="MJXp-Span-567">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-570" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mo" id="MJXp-Span-571" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-572" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-573"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-575" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-576" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-577"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-579" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-580" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-581" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-582">1</span><span class="MJXp-mo" id="MJXp-Span-583" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-584" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-585"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-591" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592">n</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-586" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-587" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-588">j</span><span class="MJXp-mo" id="MJXp-Span-589">=</span><span class="MJXp-mn" id="MJXp-Span-590">1</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-593"><span class=""><span class="MJXp-mo" id="MJXp-Span-594" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-595" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-596">d</span><span class="MJXp-mrow" id="MJXp-Span-597"><span class="MJXp-mo" id="MJXp-Span-598">|</span></span><span class="MJXp-mo" id="MJXp-Span-599">gcd</span><span class="MJXp-mo" id="MJXp-Span-600">(</span><span class="MJXp-msubsup" id="MJXp-Span-601"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-603" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-604">,</span><span class="MJXp-msubsup" id="MJXp-Span-605"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-607" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-608">)</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609">μ</span><span class="MJXp-mo" id="MJXp-Span-610" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-611">d</span><span class="MJXp-mo" id="MJXp-Span-612" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><script type="math/tex" id="MathJax-Element-65">\displaystyle\sum_{j=1}^{n}[\gcd(a_i, a_j)=1] = \sum_{j=1}^{n}\sum_{d|\gcd(a_i, a_j)}\mu(d)</script></center><p>Let's swap the order of summation and get</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-613"><span class="MJXp-mstyle" id="MJXp-Span-614"><span class="MJXp-munderover" id="MJXp-Span-615"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-621" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">m</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-616" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-617" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618">d</span><span class="MJXp-mo" id="MJXp-Span-619">=</span><span class="MJXp-mn" id="MJXp-Span-620">1</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623">μ</span><span class="MJXp-mo" id="MJXp-Span-624" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625">d</span><span class="MJXp-mo" id="MJXp-Span-626" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-627"><span class="MJXp-mo" id="MJXp-Span-628" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.744em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.978em; margin-left: -0.17em;">(</span></span><span class="MJXp-munderover" id="MJXp-Span-629"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-635" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-636">n</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-630" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-631" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632">j</span><span class="MJXp-mo" id="MJXp-Span-633">=</span><span class="MJXp-mn" id="MJXp-Span-634">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-637" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-638">d</span><span class="MJXp-mrow" id="MJXp-Span-639"><span class="MJXp-mo" id="MJXp-Span-640" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-641" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-642" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-643"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-645" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-646" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-647"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-649" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-650" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-651" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-652" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.744em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.978em; margin-left: -0.17em;">)</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-66">\displaystyle\sum_{d=1}^{m}\mu(d)\left(\sum_{j=1}^{n}[d|\gcd(a_i,a_j)]\right)</script></center><p>Because <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-653"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654">d</span><span class="MJXp-mrow" id="MJXp-Span-655"><span class="MJXp-mo" id="MJXp-Span-656" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-657" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-658" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-659"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-661" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-662" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-663"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-665" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-666" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-67">d | \gcd(a_i, a_j)</script> is equivalent to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-667"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-668">d</span><span class="MJXp-mrow" id="MJXp-Span-669"><span class="MJXp-mo" id="MJXp-Span-670" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-671"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-673" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-68">d|a_i</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-674"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">d</span><span class="MJXp-mrow" id="MJXp-Span-676"><span class="MJXp-mo" id="MJXp-Span-677" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-678"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-679" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-680" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-69">d|a_j</script>, we can simplify the formula to</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-681"><span class="MJXp-mstyle" id="MJXp-Span-682"><span class="MJXp-munderover" id="MJXp-Span-683"><span class=""><span class="MJXp-mo" id="MJXp-Span-684" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-685" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686">d</span><span class="MJXp-mrow" id="MJXp-Span-687"><span class="MJXp-mo" id="MJXp-Span-688">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-689"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-690" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-691" style="vertical-align: -0.4em;">i</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">μ</span><span class="MJXp-mo" id="MJXp-Span-693" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694">d</span><span class="MJXp-mo" id="MJXp-Span-695" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-696"><span class="MJXp-mo" id="MJXp-Span-697" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.744em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.978em; margin-left: -0.17em;">(</span></span><span class="MJXp-munderover" id="MJXp-Span-698"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-704" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-705">n</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-699" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-700" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-701">j</span><span class="MJXp-mo" id="MJXp-Span-702">=</span><span class="MJXp-mn" id="MJXp-Span-703">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-706" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-707">d</span><span class="MJXp-mrow" id="MJXp-Span-708"><span class="MJXp-mo" id="MJXp-Span-709" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-710"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-712" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-713" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-714" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.744em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.978em; margin-left: -0.17em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-715" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-716"><span class=""><span class="MJXp-mo" id="MJXp-Span-717" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-718" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-719">d</span><span class="MJXp-mrow" id="MJXp-Span-720"><span class="MJXp-mo" id="MJXp-Span-721">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-722"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-723" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-724" style="vertical-align: -0.4em;">i</span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-725">μ</span><span class="MJXp-mo" id="MJXp-Span-726" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727">d</span><span class="MJXp-mo" id="MJXp-Span-728" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">f</span><span class="MJXp-mo" id="MJXp-Span-730" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731">d</span><span class="MJXp-mo" id="MJXp-Span-732" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><script type="math/tex" id="MathJax-Element-70">\displaystyle\sum_{d|a_i}\mu(d)\left(\sum_{j=1}^{n}[d|a_j]\right) = \sum_{d|a_i}\mu(d)f(d)</script></center><p>Thus, we can enumerate the divisors of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-733"><span class="MJXp-msubsup" id="MJXp-Span-734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-735" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-736" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-71">a_i</script> for each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-737"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">i</span></span></span><script type="math/tex" id="MathJax-Element-72">i</script> and compute the summation above by brute force, which yields a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-739"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-740">O</span><span class="MJXp-mo" id="MJXp-Span-741" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742">n</span><span class="MJXp-msqrt" id="MJXp-Span-743"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744">m</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-745" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-73">O(n\sqrt{m})</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-746"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747">O</span><span class="MJXp-mo" id="MJXp-Span-748" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-749">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750">d</span><span class="MJXp-mo" id="MJXp-Span-751" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752">n</span><span class="MJXp-mo" id="MJXp-Span-753" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-754" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-74">O(nd(n))</script> time.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Let's build a graph <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-755"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">G</span></span></span><script type="math/tex" id="MathJax-Element-75">G</script> where vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-757"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758">i</span></span></span><script type="math/tex" id="MathJax-Element-76">i</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-759"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">j</span></span></span><script type="math/tex" id="MathJax-Element-77">j</script> has an undirected edge if and only if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-761"><span class="MJXp-mo" id="MJXp-Span-762" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-763" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-764"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-765" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-766" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-767" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-768"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-769" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-770" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-771" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-772" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-773">1</span></span></span><script type="math/tex" id="MathJax-Element-78">\gcd(a_i, a_j) = 1</script>. The problem becomes finding a match of size <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-774"><span class="MJXp-mn" id="MJXp-Span-775">2</span></span></span><script type="math/tex" id="MathJax-Element-79">2</script> in the graph. However, we only has each vertex's degrees based on the discussion above. How do we find the match only based on degrees?</p></div></div> <div class="spoiler"><b class="spoiler-title">Step 2</b><div class="spoiler-content" style="display: block;"><p>We use a greedy approach to obtain the match of size <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-776"><span class="MJXp-mn" id="MJXp-Span-777">2</span></span></span><script type="math/tex" id="MathJax-Element-80">2</script>. Let's say <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-778"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">G</span></span></span><script type="math/tex" id="MathJax-Element-81">G</script> has at least one edge.</p> <ol>   <li>Choose a vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-780"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-781">u</span></span></span><script type="math/tex" id="MathJax-Element-82">u</script> with the maximum degree.</li>   <li>From all vertices that is connected to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-782"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783">u</span></span></span><script type="math/tex" id="MathJax-Element-83">u</script>, pick a vertex <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-784"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-785">v</span></span></span><script type="math/tex" id="MathJax-Element-84">v</script> with the minimum degree.</li>   <li>Remove vertices <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-786"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">u</span></span></span><script type="math/tex" id="MathJax-Element-85">u</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-788"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789">v</span></span></span><script type="math/tex" id="MathJax-Element-86">v</script> and their associated edges from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-790"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-791">G</span></span></span><script type="math/tex" id="MathJax-Element-87">G</script> to get a new graph <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-792"><span class="MJXp-msubsup" id="MJXp-Span-793"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-794" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-795" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-88">G^\prime</script>.</li>   <li>If there are at least one remaining edge in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-796"><span class="MJXp-msubsup" id="MJXp-Span-797"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-798" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-799" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-89">G^\prime</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-800"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801">G</span></span></span><script type="math/tex" id="MathJax-Element-90">G</script> has a match of size <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-802"><span class="MJXp-mn" id="MJXp-Span-803">2</span></span></span><script type="math/tex" id="MathJax-Element-91">2</script> that contains <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-804"><span class="MJXp-mo" id="MJXp-Span-805" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-806">u</span><span class="MJXp-mo" id="MJXp-Span-807" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-808">v</span><span class="MJXp-mo" id="MJXp-Span-809" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-92">(u, v)</script> and the remaining edge. Otherwise, it doesn't have a match of size <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-810"><span class="MJXp-mn" id="MJXp-Span-811">2</span></span></span><script type="math/tex" id="MathJax-Element-93">2</script>.</li> </ol> <div class="spoiler"><b class="spoiler-title">Proof of correctness</b><div class="spoiler-content" style="display: block;"><p>We will prove that if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-812"><span class="MJXp-msubsup" id="MJXp-Span-813"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-815" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-94">G^\prime</script> contains no edges, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-816"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">G</span></span></span><script type="math/tex" id="MathJax-Element-95">G</script> doesn't have a match of size <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-818"><span class="MJXp-mn" id="MJXp-Span-819">2</span></span></span><script type="math/tex" id="MathJax-Element-96">2</script>.</p><p>Because <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-820"><span class="MJXp-msubsup" id="MJXp-Span-821"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-822" style="margin-right: 0.05em;">G</span><span class="MJXp-mi MJXp-script" id="MJXp-Span-823" style="vertical-align: 0.5em;">′</span></span></span></span><script type="math/tex" id="MathJax-Element-97">G^\prime</script> has no edge, all of the vertices that is not isolated in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-824"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-825">G</span></span></span><script type="math/tex" id="MathJax-Element-98">G</script> connect to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-826"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-827">u</span></span></span><script type="math/tex" id="MathJax-Element-99">u</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-828"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-829">v</span></span></span><script type="math/tex" id="MathJax-Element-100">v</script> or both. It means <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-830"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-831">G</span></span></span><script type="math/tex" id="MathJax-Element-101">G</script> has only one connected component that contains more than two vertices. To make disucssion easier, we will use <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-832"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833">G</span></span></span><script type="math/tex" id="MathJax-Element-102">G</script> to refer to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-834"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-835">G</span></span></span><script type="math/tex" id="MathJax-Element-103">G</script>'s major connect component. That means all of the vertices other than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-836"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837">u</span></span></span><script type="math/tex" id="MathJax-Element-104">u</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-838"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839">v</span></span></span><script type="math/tex" id="MathJax-Element-105">v</script> have a degree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-840"><span class="MJXp-mn" id="MJXp-Span-841">1</span></span></span><script type="math/tex" id="MathJax-Element-106">1</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-842"><span class="MJXp-mn" id="MJXp-Span-843">2</span></span></span><script type="math/tex" id="MathJax-Element-107">2</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-844"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845">G</span></span></span><script type="math/tex" id="MathJax-Element-108">G</script>.</p> <ol>   <li>If all vertices other than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-846"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-847">u</span></span></span><script type="math/tex" id="MathJax-Element-109">u</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-848"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-849">v</span></span></span><script type="math/tex" id="MathJax-Element-110">v</script> have a degree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-850"><span class="MJXp-mn" id="MJXp-Span-851">1</span></span></span><script type="math/tex" id="MathJax-Element-111">1</script>. If at least one vertex is connected to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-852"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-853">u</span></span></span><script type="math/tex" id="MathJax-Element-112">u</script>, the minimum degree that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-854"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-855">u</span></span></span><script type="math/tex" id="MathJax-Element-113">u</script>'s connected vertices becomes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-856"><span class="MJXp-mn" id="MJXp-Span-857">1</span></span></span><script type="math/tex" id="MathJax-Element-114">1</script>. Since the algorithm choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-858"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-859">v</span></span></span><script type="math/tex" id="MathJax-Element-115">v</script> with the minimum degree, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-860"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861">v</span></span></span><script type="math/tex" id="MathJax-Element-116">v</script> also has a degree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-862"><span class="MJXp-mn" id="MJXp-Span-863">1</span></span></span><script type="math/tex" id="MathJax-Element-117">1</script>, so all vertices are connected to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-864"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-865">u</span></span></span><script type="math/tex" id="MathJax-Element-118">u</script>. In this case, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-866"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867">G</span></span></span><script type="math/tex" id="MathJax-Element-119">G</script> is a star-shaped tree, which doesn't have a match of size <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-868"><span class="MJXp-mn" id="MJXp-Span-869">2</span></span></span><script type="math/tex" id="MathJax-Element-120">2</script> for obvious reason. On the other hand, if all vertices are connected to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-870"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">v</span></span></span><script type="math/tex" id="MathJax-Element-121">v</script>, the degree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-872"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-873">v</span></span></span><script type="math/tex" id="MathJax-Element-122">v</script> is greater than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-874"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875">u</span></span></span><script type="math/tex" id="MathJax-Element-123">u</script>, which is impossible become the degree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-876"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877">u</span></span></span><script type="math/tex" id="MathJax-Element-124">u</script> is maximum.</li>   <li>If exactly one vertex other than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-878"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-879">u</span></span></span><script type="math/tex" id="MathJax-Element-125">u</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-880"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-881">v</span></span></span><script type="math/tex" id="MathJax-Element-126">v</script> has a degree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-882"><span class="MJXp-mn" id="MJXp-Span-883">2</span></span></span><script type="math/tex" id="MathJax-Element-127">2</script>, it must connect to both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-884"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885">u</span></span></span><script type="math/tex" id="MathJax-Element-128">u</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-886"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-887">v</span></span></span><script type="math/tex" id="MathJax-Element-129">v</script>. Similar to the discussion above, we can prove that no other vertex can be connected to either <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-888"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-889">u</span></span></span><script type="math/tex" id="MathJax-Element-130">u</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-890"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-891">v</span></span></span><script type="math/tex" id="MathJax-Element-131">v</script>. In this case, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-892"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-893">G</span></span></span><script type="math/tex" id="MathJax-Element-132">G</script> is a three-vertex loop, or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-894"><span class="MJXp-msubsup" id="MJXp-Span-895"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896" style="margin-right: 0.05em;">K</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-897" style="vertical-align: -0.4em;">3</span></span></span></span><script type="math/tex" id="MathJax-Element-133">K_3</script>, which doesn't have a match of size <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-898"><span class="MJXp-mn" id="MJXp-Span-899">2</span></span></span><script type="math/tex" id="MathJax-Element-134">2</script>.</li>   <li>If more than two vertices other than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-900"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-901">u</span></span></span><script type="math/tex" id="MathJax-Element-135">u</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-902"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903">v</span></span></span><script type="math/tex" id="MathJax-Element-136">v</script> have a degree of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-904"><span class="MJXp-mn" id="MJXp-Span-905">2</span></span></span><script type="math/tex" id="MathJax-Element-137">2</script>, it means <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-906"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907">v</span></span></span><script type="math/tex" id="MathJax-Element-138">v</script> has a degree of more than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-908"><span class="MJXp-mn" id="MJXp-Span-909">3</span></span></span><script type="math/tex" id="MathJax-Element-139">3</script>. Let's denote a vertex that connects to both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-910"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911">u</span></span></span><script type="math/tex" id="MathJax-Element-140">u</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-912"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-913">v</span></span></span><script type="math/tex" id="MathJax-Element-141">v</script> as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-914"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">w</span></span></span><script type="math/tex" id="MathJax-Element-142">w</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-916"><span class="MJXp-mrow" id="MJXp-Span-917"><span class="MJXp-mi" id="MJXp-Span-918">d</span><span class="MJXp-mi" id="MJXp-Span-919">e</span><span class="MJXp-mi" id="MJXp-Span-920">g</span></span><span class="MJXp-mo" id="MJXp-Span-921" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922">w</span><span class="MJXp-mo" id="MJXp-Span-923" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-924" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-925">2</span><span class="MJXp-mo" id="MJXp-Span-926" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-927">3</span><span class="MJXp-mo" id="MJXp-Span-928" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mrow" id="MJXp-Span-929"><span class="MJXp-mi" id="MJXp-Span-930">d</span><span class="MJXp-mi" id="MJXp-Span-931">e</span><span class="MJXp-mi" id="MJXp-Span-932">g</span></span><span class="MJXp-mo" id="MJXp-Span-933" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-934">v</span><span class="MJXp-mo" id="MJXp-Span-935" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-143">\mathrm{deg}(w) = 2 < 3 \le \mathrm{deg}(v)</script>. Because <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-936"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-937">w</span></span></span><script type="math/tex" id="MathJax-Element-144">w</script> is also connected to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-938"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939">u</span></span></span><script type="math/tex" id="MathJax-Element-145">u</script>, it contradicts to the step <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-940"><span class="MJXp-mn" id="MJXp-Span-941">2</span></span></span><script type="math/tex" id="MathJax-Element-146">2</script> of the algorithm.</li> </ol></div></div><p>For our problem, for each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-942"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-943">i</span></span></span><script type="math/tex" id="MathJax-Element-147">i</script>, the degree is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-944"><span class="MJXp-mstyle" id="MJXp-Span-945"><span class="MJXp-munderover" id="MJXp-Span-946"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-952" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953">n</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-947" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-948" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-949">j</span><span class="MJXp-mo" id="MJXp-Span-950">=</span><span class="MJXp-mn" id="MJXp-Span-951">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-954" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mo" id="MJXp-Span-955" style="margin-left: 0.333em; margin-right: 0.333em;">gcd</span><span class="MJXp-mo" id="MJXp-Span-956" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-957"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-958" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-959" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-960" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-961"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-963" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-964" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-965" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-966">1</span><span class="MJXp-mo" id="MJXp-Span-967" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-968" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-969" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-970"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-971" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-972" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-973" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-974">1</span><span class="MJXp-mo" id="MJXp-Span-975" style="margin-left: 0em; margin-right: 0em;">]</span></span></span></span><script type="math/tex" id="MathJax-Element-148">\displaystyle\sum_{j=1}^{n}[\gcd(a_i, a_j)=1] - [a_i = 1]</script>. We can then brute force to find the first edge, remove it, and then try to find the second edge.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> i64 </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">constexpr</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> V </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e6</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">10</span><span class="pun">;</span><span class="pln">

std</span><span class="pun">::</span><span class="pln">array</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> V</span><span class="pun">&gt;</span><span class="pln"> mu</span><span class="pun">,</span><span class="pln"> comp</span><span class="pun">;</span><span class="pln">
std</span><span class="pun">::</span><span class="pln">vector</span><span class="str">&lt;int&gt;</span><span class="pln"> primes</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> m </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    std</span><span class="pun">::</span><span class="pln">cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    std</span><span class="pun">::</span><span class="pln">vector</span><span class="str">&lt;int&gt;</span><span class="pln"> a</span><span class="pun">(</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        std</span><span class="pun">::</span><span class="pln">cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
        m </span><span class="pun">=</span><span class="pln"> std</span><span class="pun">::</span><span class="pln">max</span><span class="pun">(</span><span class="pln">m</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    std</span><span class="pun">::</span><span class="pln">vector</span><span class="str">&lt;int&gt;</span><span class="pln"> mul</span><span class="pun">(</span><span class="pln">m</span><span class="pun">+</span><span class="lit">1</span><span class="pun">),</span><span class="pln"> deg</span><span class="pun">(</span><span class="pln">n</span><span class="pun">),</span><span class="pln"> mp</span><span class="pun">(</span><span class="pln">m</span><span class="pun">+</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        mp</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]++;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;=</span><span class="pln"> m</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">j</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> j</span><span class="pun">;</span><span class="pln"> x </span><span class="pun">&lt;=</span><span class="pln"> m</span><span class="pun">;</span><span class="pln"> x </span><span class="pun">+=</span><span class="pln"> j</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            mul</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> mp</span><span class="pun">[</span><span class="pln">x</span><span class="pun">];</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">*</span><span class="pln"> j </span><span class="pun">&lt;=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln"> </span><span class="pun">++</span><span class="pln">j</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> j </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                deg</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> mu</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> mul</span><span class="pun">[</span><span class="pln">j</span><span class="pun">];</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">*</span><span class="pln"> j </span><span class="pun">&lt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                    deg</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> mu</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> mul</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> j</span><span class="pun">];</span><span class="pln">
                </span><span class="pun">}</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">--</span><span class="pln">deg</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    std</span><span class="pun">::</span><span class="pln">array</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4</span><span class="pun">&gt;</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> u </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> v </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> mind </span><span class="pun">=</span><span class="pln"> INT32_MAX</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">deg</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> deg</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            u </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">deg</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        std</span><span class="pun">::</span><span class="pln">cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"0\n"</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    deg</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">==</span><span class="pln"> u</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">std</span><span class="pun">::</span><span class="pln">gcd</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="pun">--</span><span class="pln">deg</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">mind </span><span class="pun">&gt;</span><span class="pln"> deg</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                mind </span><span class="pun">=</span><span class="pln"> deg</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
                v </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    ans</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> u</span><span class="pun">;</span><span class="pln">
    ans</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> v</span><span class="pun">;</span><span class="pln">
    deg</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">==</span><span class="pln"> u </span><span class="pun">||</span><span class="pln"> i </span><span class="pun">==</span><span class="pln"> v</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">std</span><span class="pun">::</span><span class="pln">gcd</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="pun">--</span><span class="pln">deg</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    u </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">deg</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> deg</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            u </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">deg</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        std</span><span class="pun">::</span><span class="pln">cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"0\n"</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    v </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">==</span><span class="pln"> u </span><span class="pun">||</span><span class="pln"> </span><span class="pun">!</span><span class="pln">deg</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">std</span><span class="pun">::</span><span class="pln">gcd</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            v </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">assert</span><span class="pun">(</span><span class="pln">v </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    ans</span><span class="pun">[</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> u</span><span class="pun">;</span><span class="pln"> ans</span><span class="pun">[</span><span class="lit">3</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> v</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">4</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        std</span><span class="pun">::</span><span class="pln">cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">" \n"</span><span class="pun">[</span><span class="pln">i </span><span class="pun">==</span><span class="pln"> </span><span class="lit">3</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    std</span><span class="pun">::</span><span class="pln">cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="kwd">nullptr</span><span class="pun">)-&gt;</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> T </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    std</span><span class="pun">::</span><span class="pln">cin </span><span class="pun">&gt;&gt;</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
    mu</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> V</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">comp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            primes</span><span class="pun">.</span><span class="pln">emplace_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
            mu</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> p</span><span class="pun">:</span><span class="pln"> primes</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> q </span><span class="pun">=</span><span class="pln"> i </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">q </span><span class="pun">&gt;=</span><span class="pln"> V</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
            comp</span><span class="pun">[</span><span class="pln">q</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">%</span><span class="pln"> p </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                mu</span><span class="pun">[</span><span class="pln">q</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
                </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
            </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                mu</span><span class="pun">[</span><span class="pln">q</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="pln">mu</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate the problem!</b><div class="spoiler-content" style="display: block;"><div class="spoiler"><b class="spoiler-title">Quality</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11428">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="138">138</span>
            </i>
        </a>
    </span>


 Excellent problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11429">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="2">2</span>
            </i>
        </a>
    </span>


 Good problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11430">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="5">5</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11431">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="1">1</span>
            </i>
        </a>
    </span>


 Bad problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11432">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="11">11</span>
            </i>
        </a>
    </span>


 Horrible problem</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Difficulty</b><div class="spoiler-content" style="display: block;"><ul>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11433">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="11">11</span>
            </i>
        </a>
    </span>


 Trivial problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11434">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="2">2</span>
            </i>
        </a>
    </span>


 Easy problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11435">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="14">14</span>
            </i>
        </a>
    </span>


 Average problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11436">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="108">108</span>
            </i>
        </a>
    </span>


 Hard problem</li>   <li>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11437">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="38">38</span>
            </i>
        </a>
    </span>


 Impossible problem</li> </ul></div></div></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2131" class="notice" style="text-decoration: none;">Codeforces Round 1042 (Div. 3)</a> </span>
        </div>
        
            

  <script>
    // Make all spoilers toggleable
    document.querySelectorAll('.spoiler-title').forEach(title => {
      title.addEventListener('click', function() {
        const spoiler = this.closest('.spoiler');
        spoiler.classList.toggle('open');
      });
    });
    
    // Open all spoilers by default for easier reading
    document.querySelectorAll('.spoiler').forEach(spoiler => {
      spoiler.classList.add('open');
    });
  </script>
</body>
</html>