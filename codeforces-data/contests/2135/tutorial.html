<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tutorial</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
      color: #333;
      background: #fafafa;
    }
    .ttypography {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    h3 {
      color: #1a1a1a;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }
    h3 a {
      color: #0066cc;
      text-decoration: none;
    }
    h3 a:hover {
      text-decoration: underline;
    }
    .spoiler {
      margin: 15px 0;
      border: 1px solid #ddd;
      border-radius: 6px;
      overflow: hidden;
    }
    .spoiler-title {
      display: block;
      padding: 12px 15px;
      background: #f0f0f0;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
      border-bottom: 1px solid #ddd;
    }
    .spoiler-title:hover {
      background: #e8e8e8;
    }
    .spoiler-title::before {
      content: '▶ ';
      font-size: 0.8em;
      transition: transform 0.2s;
      display: inline-block;
    }
    .spoiler.open .spoiler-title::before {
      content: '▼ ';
    }
    .spoiler-content {
      padding: 15px;
      background: #fff;
      display: none;
    }
    .spoiler.open .spoiler-content {
      display: block;
    }
    pre, code {
      background: #f5f5f5;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 0.85em;
    }
    pre {
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
    code {
      padding: 2px 5px;
      border-radius: 3px;
    }
    p {
      margin: 10px 0;
    }
    .MathJax {
      font-size: 1.1em;
    }
  </style>
</head>
<body>
  <h1>Editorial</h1>
  <p><a href="https://codeforces.com/blog/entry/145796" target="_blank">View on Codeforces →</a></p>
  
  <div class="ttypography"><div class="spoiler"><b class="spoiler-title">Rate the Contest!</b><div class="spoiler-content" style="display: block;"><ul>   <li>Amazing round: 
<style data-nocturne="true" type="text/css">

</style>

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11686">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="256">256</span>
            </i>
        </a>
    </span>

    <script>
        $(function() {
            const likeFormUtil = {};
            likeFormUtil.getCount = function ($count) {
                return Number($count.attr("data-value"));
            };
            likeFormUtil.setCount = function ($count, value) {
                $count.attr("data-value", value);
                $count.text(value);
            };
            likeFormUtil.like = function ($likeForm) {
                $likeForm.find(".likeState").addClass("liked");
                const $likeCount = $likeForm.find(".likeCount");
                likeFormUtil.setCount($likeCount, likeFormUtil.getCount($likeCount) + 1);
            };
            likeFormUtil.unLike = function ($likeForm) {
                if ($likeForm.find(".likeState").hasClass("liked")) {
                    $likeForm.find(".likeState").removeClass("liked");
                    const $likeCount = $likeForm.find(".likeCount");
                    likeFormUtil.setCount($likeCount, likeFormUtil.getCount($likeCount) - 1);
                }
            };
            likeFormUtil.dislike = function ($likeForm) {
                $likeForm.find(".dislikeState").addClass("disliked");
                const $dislikeCount = $likeForm.find(".dislikeCount");
                likeFormUtil.setCount($dislikeCount, likeFormUtil.getCount($dislikeCount) + 1);
            };
            likeFormUtil.unDislike = function ($likeForm) {
                if ($likeForm.find(".dislikeState").hasClass("disliked")) {
                    $likeForm.find(".dislikeState").removeClass("disliked");
                    const $dislikeCount = $likeForm.find(".dislikeCount");
                    likeFormUtil.setCount($dislikeCount, likeFormUtil.getCount($dislikeCount) - 1);
                }
            };
            likeFormUtil.disable = function ($likeForm) {
                $likeForm.find(".likeActionLink").off("click");
                $likeForm.find(".likeActionLink").on("click", function () {
                    return false;
                });
                $likeForm.find(".dislikeActionLink").off("click");
                $likeForm.find(".dislikeActionLink").on("click", function () {
                    return false;
                });
            };
            likeFormUtil.enable = function ($likeForm) {
                $likeForm.find(".likeActionLink").off("click");
                $likeForm.find(".likeActionLink").on("click", onLike);
                $likeForm.find(".dislikeActionLink").off("click");
                $likeForm.find(".dislikeActionLink").on("click", onDislike);
            };
            likeFormUtil.applyLikeableInformation = function(likeableInformation) {
                const id = likeableInformation.likeable.id;
                console.log(id);
                const $likeForm = $(".likeActionLink[data-likeableId='" + id + "']").closest(".likeForm");
                console.log($likeForm);
                likeFormUtil.setCount($likeForm.find(".likeCount"), likeableInformation.likeCount);
                likeFormUtil.setCount($likeForm.find(".dislikeCount"), likeableInformation.dislikeCount);
                if (likeableInformation.liked) {
                    $likeForm.find(".likeState").addClass("liked");
                } else {
                    $likeForm.find(".likeState").removeClass("liked");
                }
                if (likeableInformation.disliked) {
                    $likeForm.find(".likeState").addClass("disliked");
                } else {
                    $likeForm.find(".likeState").removeClass("disliked");
                }
            }
            likeFormUtil.applyLikeableInformations = function(likeableInformations) {
                likeableInformations.forEach((applyLikeableInformation) => {
                    likeFormUtil.applyLikeableInformation(applyLikeableInformation);
                });
            }

            function onLike() {
                const $likeActionLink = $(this);
                const likeableId = $likeActionLink.attr("data-likeableId");
                const $likeForm = $likeActionLink.parent();

                likeFormUtil.disable($likeForm);
                $.post("/data/like", {
                    action: "like",
                    likeableId: likeableId
                }, function (data) {
                    if (data["success"] === true) {
                        if (data["liked"]) {
                            Codeforces.showMessage('Added to liked');
                        } else {
                            Codeforces.showMessage('Removed from liked');
                        }
                        likeFormUtil.applyLikeableInformations(data["likeableInformations"]);
                    } else {
                        Codeforces.showMessage(data["message"] || "Error");
                    }
                    likeFormUtil.enable($likeForm);
                }, "json");
                return false;
            }

            function onDislike() {
                const $dislikeActionLink = $(this);
                const likeableId = $dislikeActionLink.attr("data-likeableId");
                const $likeForm = $dislikeActionLink.parent();

                likeFormUtil.disable($likeForm);
                $.post("/data/like", {
                    action: "dislike",
                    likeableId: likeableId
                }, function (data) {
                    if (data["success"] === true) {
                        if (data["disliked"]) {
                            Codeforces.showMessage('Added to disliked');
                        } else {
                            Codeforces.showMessage('Removed from disliked');
                        }
                        likeFormUtil.applyLikeableInformations(data["likeableInformations"]);
                    } else {
                        Codeforces.showMessage(data["message"] || "Error");
                    }
                    likeFormUtil.enable($likeForm);
                }, "json");
                return false;
            }

            $(".likeActionLink").click(onLike);
            $(".dislikeActionLink").click(onDislike);

            $(".likeCount").add(".dislikeCount").each(function () {
                const $count = $(this);
                likeFormUtil.setCount($count, likeFormUtil.getCount($count));
            });
        });
    </script>

<script data-nocturne="true"> $(function () {
}); </script>

</li>   <li>Good round: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11687">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="142">142</span>
            </i>
        </a>
    </span>


</li>   <li>Average round: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11688">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="35">35</span>
            </i>
        </a>
    </span>


</li>   <li>Bad round: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11689">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="15">15</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible round: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11690">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="25">25</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2136/problem/A" title="Codeforces Round 1046 (Div. 2)">2136A - In the Dream</a></p><p>Idea: <a class="rated-user user-violet" href="https://codeforces.com/profile/Alan_dong" title="Candidate Master Alan_dong">Alan_dong</a><br>Preparation: <a class="rated-user user-orange" href="https://codeforces.com/profile/Register" title="Master Register">Register</a></p> <div class="spoiler"><b class="spoiler-title">Hint</b><div class="spoiler-content" style="display: block;"><p>If one team got a score of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">x</span></span></span><script type="math/tex" id="MathJax-Element-1">x</script> in the first half, what is the maximum score the other team could get?</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>We can consider the first half and the second half separately. The dream might come true if and only if the scores in both halves are possible. In the second half, the RiOI team scored <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mo" id="MJXp-Span-4" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5">c</span><span class="MJXp-mo" id="MJXp-Span-6" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7">a</span><span class="MJXp-mo" id="MJXp-Span-8" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-2">(c - a)</script> goals, while the KDOI team scored <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-mo" id="MJXp-Span-10" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11">d</span><span class="MJXp-mo" id="MJXp-Span-12" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13">b</span><span class="MJXp-mo" id="MJXp-Span-14" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-3">(d - b)</script> goals.</p><p>Suppose the RiOI team scored <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-15"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16">x</span></span></span><script type="math/tex" id="MathJax-Element-4">x</script> goals in some half. Denoting the score of the KDOI team as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-17"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">y</span></span></span><script type="math/tex" id="MathJax-Element-5">y</script>, one can see that the maximal value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-19"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">y</span></span></span><script type="math/tex" id="MathJax-Element-6">y</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-21"><span class="MJXp-mn" id="MJXp-Span-22">2</span><span class="MJXp-mo" id="MJXp-Span-23" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">x</span><span class="MJXp-mo" id="MJXp-Span-25" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-26">2</span></span></span><script type="math/tex" id="MathJax-Element-7">2\cdot x + 2</script>, under the goal order <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-27"><span class="MJXp-mrow" id="MJXp-Span-28"><span class="MJXp-mstyle" id="MJXp-Span-29" style="color: red;"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-30">K</span></span><span class="MJXp-mstyle" id="MJXp-Span-31" style="color: red;"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-32">K</span></span><span class="MJXp-mstyle" id="MJXp-Span-33" style="color: black;"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-34">R</span></span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-35">K</span><span class="MJXp-mstyle" id="MJXp-Span-36" style="color: red;"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-37">K</span></span><span class="MJXp-mstyle" id="MJXp-Span-38" style="color: black;"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-39">R</span></span><span class="MJXp-mo MJXp-mono" id="MJXp-Span-40" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo MJXp-mono" id="MJXp-Span-41" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo MJXp-mono" id="MJXp-Span-42" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-43">R</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-44">K</span><span class="MJXp-mstyle" id="MJXp-Span-45" style="color: red;"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-46">K</span></span><span class="MJXp-mstyle" id="MJXp-Span-47" style="color: black;"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-48">R</span></span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-49">K</span><span class="MJXp-mstyle" id="MJXp-Span-50" style="color: red;"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-51">K</span></span></span></span></span><script type="math/tex" id="MathJax-Element-8">\tt{\color{red}K\color{red}K\color{black}RK\color{red}K\color{black}R...RK\color{red}K\color{black}RK\color{red}K}</script>. When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-52"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">y</span><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">x</span></span></span><script type="math/tex" id="MathJax-Element-9">y \geq x</script>, all scores in the range <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-56"><span class="MJXp-mo" id="MJXp-Span-57" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">x</span><span class="MJXp-mo" id="MJXp-Span-59" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-60">2</span><span class="MJXp-mo" id="MJXp-Span-61" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">x</span><span class="MJXp-mo" id="MJXp-Span-63" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-64">2</span><span class="MJXp-mo" id="MJXp-Span-65" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-10">[x, 2\cdot x+2]</script> can be achieved by deleting several <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-66"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-67">K</span></span></span><script type="math/tex" id="MathJax-Element-11">\tt K</script>-s colored red.</p><p>Therefore, the scores <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-68"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69">x</span><span class="MJXp-mo" id="MJXp-Span-70" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71">y</span></span></span><script type="math/tex" id="MathJax-Element-12">x: y</script> in a single half are possible, if and only if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-74"><span class="MJXp-mo" id="MJXp-Span-75" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-76" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77">x</span><span class="MJXp-mo" id="MJXp-Span-78" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79">y</span><span class="MJXp-mo" id="MJXp-Span-80" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-81" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-82">2</span><span class="MJXp-mo" id="MJXp-Span-83" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-84" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-mo" id="MJXp-Span-85" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">x</span><span class="MJXp-mo" id="MJXp-Span-87" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">y</span><span class="MJXp-mo" id="MJXp-Span-89" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-90" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-91">2</span></span></span><script type="math/tex" id="MathJax-Element-13">\max(x, y) \leq 2\cdot \min(x, y) + 2</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">

</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">,</span><span class="pln"> b</span><span class="pun">,</span><span class="pln"> c</span><span class="pun">,</span><span class="pln"> d</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">T</span><span class="pun">);</span><span class="pln"> T</span><span class="pun">--;</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%d%d%d%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">a</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">b</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">c</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">d</span><span class="pun">),</span><span class="pln"> c </span><span class="pun">-=</span><span class="pln"> a</span><span class="pun">,</span><span class="pln"> d </span><span class="pun">-=</span><span class="pln"> b</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">&gt;</span><span class="pln"> b</span><span class="pun">)</span><span class="pln"> swap</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln"> b</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">c </span><span class="pun">&gt;</span><span class="pln"> d</span><span class="pun">)</span><span class="pln"> swap</span><span class="pun">(</span><span class="pln">c</span><span class="pun">,</span><span class="pln"> d</span><span class="pun">);</span><span class="pln">
		puts</span><span class="pun">((</span><span class="pln">a </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> b </span><span class="pun">&amp;&amp;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">c </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> d </span><span class="pun">?</span><span class="pln"> </span><span class="str">"YES"</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">"NO"</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Code (Python)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">import</span><span class="pln"> sys
input</span><span class="pun">=</span><span class="pln">sys</span><span class="pun">.</span><span class="pln">stdin</span><span class="pun">.</span><span class="pln">readline
 
t</span><span class="pun">=</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">t</span><span class="pun">):</span><span class="pln">
    a</span><span class="pun">,</span><span class="pln">b</span><span class="pun">,</span><span class="pln">c</span><span class="pun">,</span><span class="pln">d</span><span class="pun">=</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln">input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">())</span><span class="pln">
    </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">max</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln">b</span><span class="pun">)&gt;</span><span class="lit">2</span><span class="pun">*</span><span class="pln">min</span><span class="pun">(</span><span class="pln">a</span><span class="pun">,</span><span class="pln">b</span><span class="pun">)+</span><span class="lit">2</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"NO"</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">elif</span><span class="pun">(</span><span class="pln">max</span><span class="pun">(</span><span class="pln">c</span><span class="pun">-</span><span class="pln">a</span><span class="pun">,</span><span class="pln">d</span><span class="pun">-</span><span class="pln">b</span><span class="pun">)&gt;</span><span class="lit">2</span><span class="pun">*</span><span class="pln">min</span><span class="pun">(</span><span class="pln">c</span><span class="pun">-</span><span class="pln">a</span><span class="pun">,</span><span class="pln">d</span><span class="pun">-</span><span class="pln">b</span><span class="pun">)+</span><span class="lit">2</span><span class="pun">):</span><span class="pln">
        </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"NO"</span><span class="pun">)</span><span class="pln">
    </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
        </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"YES"</span><span class="pun">)</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate the Problem!</b><div class="spoiler-content" style="display: block;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11636">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="43">43</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11637">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="153">153</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11638">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="53">53</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11639">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="12">12</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11640">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="45">45</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2136/problem/B" title="Codeforces Round 1046 (Div. 2)">2136B - Like the Bitset</a></p><p>Idea &amp; Preparation: <a class="rated-user user-red" href="https://codeforces.com/profile/_istil" title="International Grandmaster _istil">_istil</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>When shall we output <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-92"><span class="MJXp-mrow" id="MJXp-Span-93"><span class="MJXp-mi MJXp-mono" id="MJXp-Span-94">N</span><span class="MJXp-mi MJXp-mono" id="MJXp-Span-95">O</span></span></span></span><script type="math/tex" id="MathJax-Element-14">\tt{NO}</script>?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>We can put larger numbers on indices with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-96"><span class="MJXp-msubsup" id="MJXp-Span-97"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-99" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-100" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-101"><span class="MJXp-mn MJXp-mono" id="MJXp-Span-102">0</span></span></span></span><script type="math/tex" id="MathJax-Element-15">s_i = \tt{0}</script>, and smaller numbers on indices with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-103"><span class="MJXp-msubsup" id="MJXp-Span-104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-106" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-107" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-108"><span class="MJXp-mn MJXp-mono" id="MJXp-Span-109">1</span></span></span></span><script type="math/tex" id="MathJax-Element-16">s_i = \tt{1}</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Note that if there is an interval <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-110"><span class="MJXp-msubsup" id="MJXp-Span-111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-113" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-114" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-115" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-116" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-117"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-119" style="vertical-align: -0.4em;">r</span></span></span></span><script type="math/tex" id="MathJax-Element-17">p_l, \ldots, p_r</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121">r</span><span class="MJXp-mo" id="MJXp-Span-122" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">l</span><span class="MJXp-mo" id="MJXp-Span-124" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-125">1</span><span class="MJXp-mo" id="MJXp-Span-126" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">k</span></span></span><script type="math/tex" id="MathJax-Element-18">r - l + 1 \geq k</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-128"><span class="MJXp-msubsup" id="MJXp-Span-129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-131" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-132" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-135" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">l</span><span class="MJXp-mo" id="MJXp-Span-137">+</span><span class="MJXp-mn" id="MJXp-Span-138">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-139" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-140" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-141" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-144" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-145" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-146"><span class="MJXp-mn MJXp-mono" id="MJXp-Span-147">1</span></span></span></span><script type="math/tex" id="MathJax-Element-19">s_l = s_{l+1} = \ldots = s_r = \tt{1}</script>, then it's impossible to satisfy all the requirements, since by iterating <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-148"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">i</span></span></span><script type="math/tex" id="MathJax-Element-20">i</script> over <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-150"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">l</span></span></span><script type="math/tex" id="MathJax-Element-21">l</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">r</span></span></span><script type="math/tex" id="MathJax-Element-22">r</script>, there must be some <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-154"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">i</span></span></span><script type="math/tex" id="MathJax-Element-23">i</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-156"><span class="MJXp-msubsup" id="MJXp-Span-157"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-159" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-160" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-161" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-162" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-163"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-165" style="vertical-align: -0.4em;">l</span></span><span class="MJXp-mo" id="MJXp-Span-166" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-167" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-168" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-169"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-171" style="vertical-align: -0.4em;">r</span></span><span class="MJXp-mo" id="MJXp-Span-172" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-24">p_i = \max(p_l, \ldots, p_r)</script>.</p><p>Otherwise, denote <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-173"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174">c</span></span></span><script type="math/tex" id="MathJax-Element-25">c</script> as the number of occurrences of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-175"><span class="MJXp-mrow" id="MJXp-Span-176"><span class="MJXp-mn MJXp-mono" id="MJXp-Span-177">1</span></span></span></span><script type="math/tex" id="MathJax-Element-26">\tt{1}</script> in the string <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-178"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">s</span></span></span><script type="math/tex" id="MathJax-Element-27">s</script>. We can always construct the permutation by filling the indices <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-180"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">i</span></span></span><script type="math/tex" id="MathJax-Element-28">i</script> of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-182"><span class="MJXp-msubsup" id="MJXp-Span-183"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-185" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-186" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-187"><span class="MJXp-mn MJXp-mono" id="MJXp-Span-188">1</span></span></span></span><script type="math/tex" id="MathJax-Element-29">s_i = \tt{1}</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-189"><span class="MJXp-mn" id="MJXp-Span-190">1</span></span></span><script type="math/tex" id="MathJax-Element-30">1</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-191"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">c</span></span></span><script type="math/tex" id="MathJax-Element-31">c</script> respectively, and indices of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-193"><span class="MJXp-msubsup" id="MJXp-Span-194"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-196" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-197" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-198"><span class="MJXp-mn MJXp-mono" id="MJXp-Span-199">0</span></span></span></span><script type="math/tex" id="MathJax-Element-32">s_i = \tt{0}</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-200"><span class="MJXp-mo" id="MJXp-Span-201" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">c</span><span class="MJXp-mo" id="MJXp-Span-203" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-204">1</span><span class="MJXp-mo" id="MJXp-Span-205" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-33">(c + 1)</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-206"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">n</span></span></span><script type="math/tex" id="MathJax-Element-34">n</script> respectively. It works because for every interval <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-208"><span class="MJXp-mo" id="MJXp-Span-209" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">l</span><span class="MJXp-mo" id="MJXp-Span-211" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">r</span><span class="MJXp-mo" id="MJXp-Span-213" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-35">[l, r]</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-214"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">r</span><span class="MJXp-mo" id="MJXp-Span-216" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">l</span><span class="MJXp-mo" id="MJXp-Span-218" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-219">1</span><span class="MJXp-mo" id="MJXp-Span-220" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">k</span></span></span><script type="math/tex" id="MathJax-Element-36">r - l + 1 \geq k</script>, there is at least one index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-222"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">l</span><span class="MJXp-mo" id="MJXp-Span-224" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">i</span><span class="MJXp-mo" id="MJXp-Span-226" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">r</span></span></span><script type="math/tex" id="MathJax-Element-37">l \leq i \leq r</script> such that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-228"><span class="MJXp-msubsup" id="MJXp-Span-229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-231" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-232" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-233"><span class="MJXp-mn MJXp-mono" id="MJXp-Span-234">0</span></span></span></span><script type="math/tex" id="MathJax-Element-38">s_i = \tt{0}</script>, and it will be greater than all the indices of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-235"><span class="MJXp-msubsup" id="MJXp-Span-236"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-238" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-239" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-240"><span class="MJXp-mn MJXp-mono" id="MJXp-Span-241">1</span></span></span></span><script type="math/tex" id="MathJax-Element-39">s_i = \tt{1}</script>.</p><p>Time complexity: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-242"><span class="MJXp-mrow" id="MJXp-Span-243"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-244">O</span></span><span class="MJXp-mo" id="MJXp-Span-245" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">n</span><span class="MJXp-mo" id="MJXp-Span-247" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-40">\mathcal O(n)</script> per test case.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">;</span><span class="pln"> std</span><span class="pun">::</span><span class="pln">cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n </span><span class="pun">&gt;&gt;</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
	std</span><span class="pun">::</span><span class="kwd">string</span><span class="pln"> s</span><span class="pun">;</span><span class="pln"> std</span><span class="pun">::</span><span class="pln">cin </span><span class="pun">&gt;&gt;</span><span class="pln"> s</span><span class="pun">,</span><span class="pln"> s </span><span class="pun">=</span><span class="pln"> </span><span class="str">" "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="pun">++</span><span class="pln">j</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">'1'</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">&lt;</span><span class="pln"> n </span><span class="pun">&amp;&amp;</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">'1'</span><span class="pun">)</span><span class="pln"> j</span><span class="pun">++;</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">void</span><span class="pun">)</span><span class="pln">puts</span><span class="pun">(</span><span class="str">"NO"</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	puts</span><span class="pun">(</span><span class="str">"YES"</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> c1 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> c2 </span><span class="pun">=</span><span class="pln"> std</span><span class="pun">::</span><span class="pln">count_if</span><span class="pun">(</span><span class="pln">s</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> s</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">(),</span><span class="pln"> </span><span class="pun">[&amp;](</span><span class="kwd">char</span><span class="pln"> ch</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-&gt;</span><span class="pln"> </span><span class="kwd">bool</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> ch </span><span class="pun">==</span><span class="pln"> </span><span class="str">'1'</span><span class="pun">;</span><span class="pln"> </span><span class="pun">});</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> 
		std</span><span class="pun">::</span><span class="pln">cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">'1'</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> </span><span class="pun">++</span><span class="pln">c1 </span><span class="pun">:</span><span class="pln"> </span><span class="pun">++</span><span class="pln">c2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">" \n"</span><span class="pun">[</span><span class="pln">i </span><span class="pun">==</span><span class="pln"> n</span><span class="pun">];</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln"> std</span><span class="pun">::</span><span class="pln">cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Code (Python)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="kwd">import</span><span class="pln"> sys
input</span><span class="pun">=</span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln">sys</span><span class="pun">.</span><span class="pln">stdin</span><span class="pun">.</span><span class="pln">readline</span><span class="pun">().</span><span class="pln">rstrip</span><span class="pun">()</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())):</span><span class="pln">
  n</span><span class="pun">,</span><span class="pln">k</span><span class="pun">=</span><span class="pln">map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln">input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">())</span><span class="pln">
  s</span><span class="pun">=</span><span class="pln">input</span><span class="pun">()</span><span class="pln">
  </span><span class="kwd">if</span><span class="pln"> </span><span class="str">"1"</span><span class="pun">*</span><span class="pln">k </span><span class="kwd">in</span><span class="pln"> s</span><span class="pun">:</span><span class="pln"> </span><span class="com"># YES YOU WILL NOT BELIEVE THAT THIS IS O(N)</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"No"</span><span class="pun">)</span><span class="pln">
  </span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(</span><span class="str">"Yes"</span><span class="pun">)</span><span class="pln">
    a</span><span class="pun">=</span><span class="pln">sorted</span><span class="pun">(</span><span class="pln">range</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln">n</span><span class="pun">),</span><span class="pln">key</span><span class="pun">=</span><span class="kwd">lambda</span><span class="pln"> i</span><span class="pun">:</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln">reverse</span><span class="pun">=</span><span class="kwd">True</span><span class="pun">)</span><span class="pln">
    ans</span><span class="pun">=[</span><span class="lit">0</span><span class="pun">]*</span><span class="pln">n
    </span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">n</span><span class="pun">):</span><span class="pln">
      ans</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]=</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pln">
    </span><span class="kwd">print</span><span class="pun">(*</span><span class="pln">ans</span><span class="pun">)</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate the Problem!</b><div class="spoiler-content" style="display: block;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11641">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="81">81</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11642">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="129">129</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11643">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="55">55</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11644">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="7">7</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11645">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="21">21</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2135/problem/A" title="Codeforces Round 1046 (Div. 1)">2135A - Against the Difference</a></p><p>Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/Error_Yuan" title="Grandmaster Error_Yuan">Error_Yuan</a><br>Preparation: <a class="rated-user user-red" href="https://codeforces.com/profile/__baozii__" title="Grandmaster __baozii__">__baozii__</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>DP is needed for this problem.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>If you force some index to be in the subsequence, there is only one optimal transition.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Let's go for DP. Denote <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-248"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">p</span><span class="MJXp-mo" id="MJXp-Span-251" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252">i</span><span class="MJXp-mo" id="MJXp-Span-253" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-41">dp(i)</script> as the length of the longest <em>neat</em> subsequence of prefix <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-254"><span class="MJXp-mo" id="MJXp-Span-255" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-256"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-258" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-259" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-260"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-262" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-263" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-264" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-265" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-266"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-268" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-269" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-42">[a_1, a_2, \ldots, a_i]</script>. It's obvious that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272">p</span><span class="MJXp-mo" id="MJXp-Span-273" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-274">0</span><span class="MJXp-mo" id="MJXp-Span-275" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-276" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">p</span><span class="MJXp-mo" id="MJXp-Span-279" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-280">1</span><span class="MJXp-mo" id="MJXp-Span-281" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-282" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mo" id="MJXp-Span-283" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">p</span><span class="MJXp-mo" id="MJXp-Span-287" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">n</span><span class="MJXp-mo" id="MJXp-Span-289" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-43">dp(0) \leq dp(1) \leq \ldots \leq dp(n)</script>.</p><p>Suppose we have calculated <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-290"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">p</span><span class="MJXp-mo" id="MJXp-Span-293" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-294">0</span><span class="MJXp-mo" id="MJXp-Span-295" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-296" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-297" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-298" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">p</span><span class="MJXp-mo" id="MJXp-Span-301" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">i</span><span class="MJXp-mo" id="MJXp-Span-303" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-304">1</span><span class="MJXp-mo" id="MJXp-Span-305" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-44">dp(0), \ldots, dp(i-1)</script>. Let's try to calculate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">p</span><span class="MJXp-mo" id="MJXp-Span-309" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">i</span><span class="MJXp-mo" id="MJXp-Span-311" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-45">dp(i)</script>:</p> <ol>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-312"><span class="MJXp-msubsup" id="MJXp-Span-313"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-315" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-46">a_i</script> is not selected in the <em>neat</em> subsequence, we simply use <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318">p</span><span class="MJXp-mo" id="MJXp-Span-319" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320">i</span><span class="MJXp-mo" id="MJXp-Span-321" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-322">1</span><span class="MJXp-mo" id="MJXp-Span-323" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-47">dp(i-1)</script> to update <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-324"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">p</span><span class="MJXp-mo" id="MJXp-Span-327" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">i</span><span class="MJXp-mo" id="MJXp-Span-329" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-48">dp(i)</script>;</li>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-330"><span class="MJXp-msubsup" id="MJXp-Span-331"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-333" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-49">a_i</script> is selected in the <em>neat</em> subsequence, the subsequence must end with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-334"><span class="MJXp-msubsup" id="MJXp-Span-335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-337" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-50">a_i</script> elements equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-338"><span class="MJXp-msubsup" id="MJXp-Span-339"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-341" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-51">a_i</script>. Since the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-342"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344">p</span></span></span><script type="math/tex" id="MathJax-Element-52">dp</script> array is monotone, we should greedily find the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-345"><span class="MJXp-msubsup" id="MJXp-Span-346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-347" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-348" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-53">a_i</script>-th largest index <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-349"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">x</span></span></span><script type="math/tex" id="MathJax-Element-54">x</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-351"><span class="MJXp-mo" id="MJXp-Span-352" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-353"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-355" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-356" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-357" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-358" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-359"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-361" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-362" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-55">[a_1, \ldots, a_i]</script> where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-363"><span class="MJXp-msubsup" id="MJXp-Span-364"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-366" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-367" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-368"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-370" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-56">a_x = a_i</script>, and use <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-371"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373">p</span><span class="MJXp-mo" id="MJXp-Span-374" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375">x</span><span class="MJXp-mo" id="MJXp-Span-376" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-377">1</span><span class="MJXp-mo" id="MJXp-Span-378" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-379" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-382" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-57">dp(x-1) + a_i</script> to update <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385">p</span><span class="MJXp-mo" id="MJXp-Span-386" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">i</span><span class="MJXp-mo" id="MJXp-Span-388" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-58">dp(i)</script>.</li> </ol><p>The resulting <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-389"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-391">p</span><span class="MJXp-mo" id="MJXp-Span-392" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">i</span><span class="MJXp-mo" id="MJXp-Span-394" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-59">dp(i)</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-395"><span class="MJXp-mo" id="MJXp-Span-396" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-397" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399">p</span><span class="MJXp-mo" id="MJXp-Span-400" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">i</span><span class="MJXp-mo" id="MJXp-Span-402" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-403">1</span><span class="MJXp-mo" id="MJXp-Span-404" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-405" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">p</span><span class="MJXp-mo" id="MJXp-Span-408" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">x</span><span class="MJXp-mo" id="MJXp-Span-410" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-411">1</span><span class="MJXp-mo" id="MJXp-Span-412" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-413" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-414"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-416" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-417" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-60">\max(dp(i-1), dp(x-1) + a_i)</script>. Finding <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-418"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419">x</span></span></span><script type="math/tex" id="MathJax-Element-61">x</script> can be done efficiently by storing the occurrences of each different value.</p><p>Time complexity: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-420"><span class="MJXp-mrow" id="MJXp-Span-421"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-422">O</span></span><span class="MJXp-mo" id="MJXp-Span-423" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">n</span><span class="MJXp-mo" id="MJXp-Span-425" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-62">\mathcal O(n)</script> per test case.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">

</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MAXN </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2e5</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">10</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">],</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">];</span><span class="pln"> deque</span><span class="str">&lt;int&gt;</span><span class="pln"> q</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">];</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">T</span><span class="pun">);</span><span class="pln"> T</span><span class="pun">--;</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> q</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">],</span><span class="pln"> q</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]].</span><span class="pln">emplace_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">q</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> q</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]].</span><span class="pln">pop_front</span><span class="pun">();</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">q</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">q</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]].</span><span class="pln">front</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate the Problem!</b><div class="spoiler-content" style="display: block;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11646">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="230">230</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11647">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="324">324</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11648">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="57">57</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11649">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="9">9</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11650">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="38">38</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2135/problem/B" title="Codeforces Round 1046 (Div. 1)">2135B - For the Champion</a></p><p>Idea &amp; Preparation: <a class="rated-user user-red" href="https://codeforces.com/profile/Error_Yuan" title="Grandmaster Error_Yuan">Error_Yuan</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>You may not know the given Manhattan distance is between you and which anchor point. Can you make some moves so that you can determine it?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>The absolute value in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-426"><span class="MJXp-mo" id="MJXp-Span-427" style="margin-left: 0em; margin-right: 0em;">|</span><span class="MJXp-msubsup" id="MJXp-Span-428"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-430" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-431" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432">c</span><span class="MJXp-mo" id="MJXp-Span-433" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mo" id="MJXp-Span-434" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-435" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-msubsup" id="MJXp-Span-436"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-438" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-439" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440">d</span><span class="MJXp-mo" id="MJXp-Span-441" style="margin-left: 0em; margin-right: 0em;">|</span></span></span><script type="math/tex" id="MathJax-Element-63">\lvert x_i-c \rvert + \lvert y_i-d \rvert</script> is somehow annoying, because you don't know whether it's <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-442"><span class="MJXp-mo" id="MJXp-Span-443" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-444"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-445" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-446" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-447" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448">c</span><span class="MJXp-mo" id="MJXp-Span-449" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-64">(x_i - c)</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-450"><span class="MJXp-mo" id="MJXp-Span-451" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">c</span><span class="MJXp-mo" id="MJXp-Span-453" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-454"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-456" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-457" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-65">(c - x_i)</script>. Find a way to fix the sign of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-458"><span class="MJXp-mo" id="MJXp-Span-459" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-460"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-462" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-463" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464">c</span><span class="MJXp-mo" id="MJXp-Span-465" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-66">(x_i - c)</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-466"><span class="MJXp-mo" id="MJXp-Span-467" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-468"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-469" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-470" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-471" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-472">d</span><span class="MJXp-mo" id="MJXp-Span-473" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-67">(y_i - d)</script>.</p> <div class="spoiler"><b class="spoiler-title">Extra Hint</b><div class="spoiler-content" style="display: block;"><p>Try to move the robot to the top-left corner.</p></div></div></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Read the hints.</p><p>Denote <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-474"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">V</span></span></span><script type="math/tex" id="MathJax-Element-68">V</script> as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-476"><span class="MJXp-msubsup" id="MJXp-Span-477"><span class="MJXp-mn" id="MJXp-Span-478" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-479" style="vertical-align: 0.5em;">9</span></span></span></span><script type="math/tex" id="MathJax-Element-69">10^9</script>. Let's first use four operations <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-480"><span class="MJXp-mo" id="MJXp-Span-481" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-482"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-483">L</span></span><span class="MJXp-mo" id="MJXp-Span-484" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485">V</span><span class="MJXp-mo" id="MJXp-Span-486" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-70">(\texttt{L}, V)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-487"><span class="MJXp-mo" id="MJXp-Span-488" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-489"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-490">L</span></span><span class="MJXp-mo" id="MJXp-Span-491" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492">V</span><span class="MJXp-mo" id="MJXp-Span-493" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-71">(\texttt{L}, V)</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-494"><span class="MJXp-mo" id="MJXp-Span-495" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-496"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-497">U</span></span><span class="MJXp-mo" id="MJXp-Span-498" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499">V</span><span class="MJXp-mo" id="MJXp-Span-500" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-72">(\texttt{U}, V)</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-501"><span class="MJXp-mo" id="MJXp-Span-502" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-503"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-504">U</span></span><span class="MJXp-mo" id="MJXp-Span-505" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506">V</span><span class="MJXp-mo" id="MJXp-Span-507" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-73">(\texttt{U}, V)</script>. Since initially <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-508"><span class="MJXp-mo" id="MJXp-Span-509" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510">V</span><span class="MJXp-mo" id="MJXp-Span-511" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-512">X</span><span class="MJXp-mo" id="MJXp-Span-513" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">Y</span><span class="MJXp-mo" id="MJXp-Span-515" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">V</span></span></span><script type="math/tex" id="MathJax-Element-74">-V \leq X, Y \leq V</script>, after the four operations, it's guaranteed that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-517"><span class="MJXp-msup" id="MJXp-Span-518"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519" style="margin-right: 0.05em;">X</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-520" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-521" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msup" id="MJXp-Span-522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-523" style="margin-right: 0.05em;">Y</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-524" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-525" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mo" id="MJXp-Span-526" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527">V</span></span></span><script type="math/tex" id="MathJax-Element-75">X', Y' \leq -V</script>.</p><p>Thus, one can note that the current value received from the jury is exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-528"><span class="MJXp-munderover" id="MJXp-Span-529"><span class=""><span class="MJXp-mo" id="MJXp-Span-530" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-531" style="margin-left: 0px;"><span class="MJXp-mn" id="MJXp-Span-532">1</span><span class="MJXp-mo" id="MJXp-Span-533">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534">i</span><span class="MJXp-mo" id="MJXp-Span-535">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-537" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-538" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-msubsup" id="MJXp-Span-539"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-541" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-542" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msup" id="MJXp-Span-543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544" style="margin-right: 0.05em;">X</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-545" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-546" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mo" id="MJXp-Span-547" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-548" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-msubsup" id="MJXp-Span-549"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-550" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-551" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-552" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msup" id="MJXp-Span-553"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554" style="margin-right: 0.05em;">Y</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-555" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-556" style="margin-left: 0.167em; margin-right: 0.167em;">|</span><span class="MJXp-mo" id="MJXp-Span-557" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-558" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-559"><span class=""><span class="MJXp-mo" id="MJXp-Span-560" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-561" style="margin-left: 0px;"><span class="MJXp-mn" id="MJXp-Span-562">1</span><span class="MJXp-mo" id="MJXp-Span-563">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564">i</span><span class="MJXp-mo" id="MJXp-Span-565">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-567" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msup" id="MJXp-Span-568"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569" style="margin-right: 0.05em;">X</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-570" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-571" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-572"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-574" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-575" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-576"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-578" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-579" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msup" id="MJXp-Span-580"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581" style="margin-right: 0.05em;">Y</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-582" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-583" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-76">\min\limits_{1 \leq i \leq n}(\lvert x_i - X'\rvert + \lvert y_i - Y'\rvert) = \min\limits_{1 \leq i \leq n}(X' - x_i + y_i - Y')</script>, which equals <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-584"><span class="MJXp-munderover" id="MJXp-Span-585"><span class=""><span class="MJXp-mo" id="MJXp-Span-586" style="margin-left: 0.333em; margin-right: 0.333em;">min</span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-587" style="margin-left: 0px;"><span class="MJXp-mn" id="MJXp-Span-588">1</span><span class="MJXp-mo" id="MJXp-Span-589">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-590">i</span><span class="MJXp-mo" id="MJXp-Span-591">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592">n</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-593" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-594"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-596" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-597" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-598"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-600" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-601" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-602" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-603">X</span><span class="MJXp-mo" id="MJXp-Span-604" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605">Y</span><span class="MJXp-mo" id="MJXp-Span-606" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-607">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-608">V</span></span></span><script type="math/tex" id="MathJax-Element-77">\min\limits_{1 \leq i \leq n}(x_i - y_i) - X + Y + 4V</script>. This gives us the value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-609"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-610">X</span><span class="MJXp-mo" id="MJXp-Span-611" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-612">Y</span></span></span><script type="math/tex" id="MathJax-Element-78">X + Y</script>.</p><p>Similarly, if we move to the top-right corner (or the bottom-left one), we can know the value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-613"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-614">X</span><span class="MJXp-mo" id="MJXp-Span-615" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-616">Y</span></span></span><script type="math/tex" id="MathJax-Element-79">X - Y</script>. It would take <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-617"><span class="MJXp-mn" id="MJXp-Span-618">4</span></span></span><script type="math/tex" id="MathJax-Element-80">4</script> extra steps of moving down or moving right (instead of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-619"><span class="MJXp-mn" id="MJXp-Span-620">4</span><span class="MJXp-mo" id="MJXp-Span-621" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-622">4</span></span></span><script type="math/tex" id="MathJax-Element-81">4 + 4</script>). By knowing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-623"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624">X</span><span class="MJXp-mo" id="MJXp-Span-625" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626">Y</span></span></span><script type="math/tex" id="MathJax-Element-82">X + Y</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-627"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628">X</span><span class="MJXp-mo" id="MJXp-Span-629" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-630">Y</span></span></span><script type="math/tex" id="MathJax-Element-83">X - Y</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-631"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632">X</span></span></span><script type="math/tex" id="MathJax-Element-84">X</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-633"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-634">Y</span></span></span><script type="math/tex" id="MathJax-Element-85">Y</script> can be solved out.</p><p>Hence, we use only <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-635"><span class="MJXp-mn" id="MJXp-Span-636">8</span></span></span><script type="math/tex" id="MathJax-Element-86">8</script> operations for each test case, which is sufficient to pass.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> all</span><span class="pun">(</span><span class="pln">s</span><span class="pun">)</span><span class="pln"> s</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> s</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">()</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> ll </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> ull </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> _N </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e5</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">5</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
    ll mn1 </span><span class="pun">=</span><span class="pln"> LLONG_MAX</span><span class="pun">,</span><span class="pln"> mx2 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="pln">LLONG_MAX</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        ll x</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">;</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> x </span><span class="pun">&gt;&gt;</span><span class="pln"> y</span><span class="pun">;</span><span class="pln">
        mn1 </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">mn1</span><span class="pun">,</span><span class="pln"> y </span><span class="pun">-</span><span class="pln"> x</span><span class="pun">);</span><span class="pln">
        mx2 </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">mx2</span><span class="pun">,</span><span class="pln"> x </span><span class="pun">+</span><span class="pln"> y</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    ll res</span><span class="pun">;</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"? R 1000000000"</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"? R 1000000000"</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"? D 1000000000"</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"? D 1000000000"</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
    ll res1 </span><span class="pun">=</span><span class="pln"> mn1 </span><span class="pun">-</span><span class="pln"> res </span><span class="pun">+</span><span class="pln"> </span><span class="lit">4000000000ll</span><span class="pun">;</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"? U 1000000000"</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"? U 1000000000"</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"? U 1000000000"</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"? U 1000000000"</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
    ll res2 </span><span class="pun">=</span><span class="pln"> mx2 </span><span class="pun">+</span><span class="pln"> res </span><span class="pun">-</span><span class="pln"> </span><span class="lit">4000000000ll</span><span class="pun">;</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"! "</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">res2 </span><span class="pun">-</span><span class="pln"> res1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">res2 </span><span class="pun">+</span><span class="pln"> res1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">),</span><span class="pln"> cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">),</span><span class="pln"> cout</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		solve</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate the Problem!</b><div class="spoiler-content" style="display: block;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11651">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="429">429</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11652">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="48">48</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11653">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="23">23</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11654">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="19">19</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11655">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="80">80</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2135/problem/C" title="Codeforces Round 1046 (Div. 1)">2135C - By the Assignment</a></p><p>Idea &amp; Preparation: <a class="rated-user user-orange" href="https://codeforces.com/profile/Register" title="Master Register">Register</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Consider the value of nodes on a cycle.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Consider the parity of the cycle's length.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>The following are equivalent statements:</p> <ul>   <li>"There is a cycle containing nodes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-637"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-638">u</span><span class="MJXp-mo" id="MJXp-Span-639" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640">v</span></span></span><script type="math/tex" id="MathJax-Element-87">u, v</script>";</li>   <li>"Nodes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-641"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642">u</span><span class="MJXp-mo" id="MJXp-Span-643" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644">v</span></span></span><script type="math/tex" id="MathJax-Element-88">u, v</script> are in the same two-edge-connected component".</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Hint 4</b><div class="spoiler-content" style="display: block;"><p>Two two-edge-connected components don't affect each other.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Read the hints.</p><p>First, focus on a simple cycle only. Denote its length as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-645"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-646">l</span></span></span><script type="math/tex" id="MathJax-Element-89">l</script>. We can choose two arbitrary nodes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-647"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">u</span></span></span><script type="math/tex" id="MathJax-Element-90">u</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-649"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-650">v</span></span></span><script type="math/tex" id="MathJax-Element-91">v</script> on the cycle, obtaining two different simple paths. The two paths have equal values for all pairs of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-651"><span class="MJXp-mo" id="MJXp-Span-652" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653">u</span><span class="MJXp-mo" id="MJXp-Span-654" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655">v</span><span class="MJXp-mo" id="MJXp-Span-656" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-92">(u, v)</script>. This implies that, for each set of size <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-657"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658">l</span><span class="MJXp-mo" id="MJXp-Span-659" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-660">2</span></span></span><script type="math/tex" id="MathJax-Element-93">l-2</script> containing only nodes on the cycle, the bitwise XOR of the weight of the nodes in the set should equal <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-661"><span class="MJXp-mn" id="MJXp-Span-662">0</span></span></span><script type="math/tex" id="MathJax-Element-94">0</script>.</p><p>Thus, all nodes on the cycle have equal weight, since when sets <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-663"><span class="MJXp-msubsup" id="MJXp-Span-664"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-665" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-666" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-667" style="margin-left: 0.267em; margin-right: 0.267em;">∪</span><span class="MJXp-mrow" id="MJXp-Span-668"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669">v</span></span></span></span><script type="math/tex" id="MathJax-Element-95">S_0 \cup {v}</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-670"><span class="MJXp-msubsup" id="MJXp-Span-671"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-673" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-674" style="margin-left: 0.267em; margin-right: 0.267em;">∪</span><span class="MJXp-mrow" id="MJXp-Span-675"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-676">u</span></span></span></span><script type="math/tex" id="MathJax-Element-96">S_0 \cup {u}</script> have equal bitwise XOR of node weights, this leads to nodes <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-677"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-678">u</span></span></span><script type="math/tex" id="MathJax-Element-97">u</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-679"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-680">v</span></span></span><script type="math/tex" id="MathJax-Element-98">v</script> having equal weights. Additionally, if <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-681"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-682">l</span></span></span><script type="math/tex" id="MathJax-Element-99">l</script> is odd, one can verify that the weight of nodes on the cycle must be equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-683"><span class="MJXp-mn" id="MJXp-Span-684">0</span></span></span><script type="math/tex" id="MathJax-Element-100">0</script> (otherwise, it can be an arbitrary integer in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-685"><span class="MJXp-mo" id="MJXp-Span-686" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-687">0</span><span class="MJXp-mo" id="MJXp-Span-688" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-689">V</span><span class="MJXp-mo" id="MJXp-Span-690" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-101">[0, V)</script>).</p><p>By decomposing the graph into two-edge-connected components, one can easily determine whether two nodes share a cycle —— by checking whether they belong to the same component. The answer is independent in each component, so we can simply multiply them together.</p><p>How to calculate the answer for a two-edge-connected component? First of all, the weight of all nodes must be equal. Then, if there exists an odd cycle (which can be detected with 2-coloring), it should equal <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-691"><span class="MJXp-mn" id="MJXp-Span-692">0</span></span></span><script type="math/tex" id="MathJax-Element-102">0</script>. There are only three different possible answers: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-693"><span class="MJXp-mn" id="MJXp-Span-694">0</span></span></span><script type="math/tex" id="MathJax-Element-103">0</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-695"><span class="MJXp-mn" id="MJXp-Span-696">1</span></span></span><script type="math/tex" id="MathJax-Element-104">1</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-697"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698">V</span></span></span><script type="math/tex" id="MathJax-Element-105">V</script>.</p><p>Thus, one can calculate the answer to the original problem efficiently.</p><p>Time Complexity: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-699"><span class="MJXp-mrow" id="MJXp-Span-700"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-701">O</span></span><span class="MJXp-mo" id="MJXp-Span-702" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">n</span><span class="MJXp-mo" id="MJXp-Span-704" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-705">m</span><span class="MJXp-mo" id="MJXp-Span-706" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-106">\mathcal O(n + m)</script> per test case.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">

</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MAXN </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2e5</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">10</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> mod </span><span class="pun">=</span><span class="pln"> </span><span class="lit">998244353</span><span class="pun">;</span><span class="pln">

vector</span><span class="str">&lt;int&gt;</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">],</span><span class="pln"> dcc</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">];</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> dfn</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">],</span><span class="pln"> low</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">],</span><span class="pln"> id</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">],</span><span class="pln"> tp</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">],</span><span class="pln"> cnt</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> tarjan</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> f </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	dfn</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> low</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">++</span><span class="pln">id</span><span class="pun">,</span><span class="pln"> s</span><span class="pun">[++</span><span class="pln">tp</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> u</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">dfn</span><span class="pun">[</span><span class="pln">v</span><span class="pun">])</span><span class="pln"> tarjan</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln"> u</span><span class="pun">),</span><span class="pln"> low</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">low</span><span class="pun">[</span><span class="pln">u</span><span class="pun">],</span><span class="pln"> low</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]);</span><span class="pln">
		</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v </span><span class="pun">!=</span><span class="pln"> f</span><span class="pun">)</span><span class="pln"> low</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">low</span><span class="pun">[</span><span class="pln">u</span><span class="pun">],</span><span class="pln"> dfn</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dfn</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> low</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		cnt</span><span class="pun">++;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> x </span><span class="pun">!=</span><span class="pln"> u</span><span class="pun">;</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			x </span><span class="pun">=</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">tp</span><span class="pun">--],</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> cnt</span><span class="pun">;</span><span class="pln">
			dcc</span><span class="pun">[</span><span class="pln">cnt</span><span class="pun">].</span><span class="pln">emplace_back</span><span class="pun">(</span><span class="pln">x</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">];</span><span class="pln">

</span><span class="kwd">bool</span><span class="pln"> check</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> f </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(~</span><span class="pln">col</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> f</span><span class="pun">;</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> f</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> v </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">v</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> </span><span class="pun">!</span><span class="pln">check</span><span class="pun">(</span><span class="pln">v</span><span class="pun">,</span><span class="pln"> f </span><span class="pun">^</span><span class="pln"> </span><span class="lit">1</span><span class="pun">))</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">,</span><span class="pln"> V</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">],</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">T</span><span class="pun">);</span><span class="pln"> T</span><span class="pun">--;</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%d%d%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">m</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">V</span><span class="pun">),</span><span class="pln"> id </span><span class="pun">=</span><span class="pln"> cnt </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> dfn</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> low</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> col</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">(),</span><span class="pln"> dcc</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> m</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			scanf</span><span class="pun">(</span><span class="str">"%d%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
			g</span><span class="pun">[</span><span class="pln">u</span><span class="pun">].</span><span class="pln">emplace_back</span><span class="pun">(</span><span class="pln">v</span><span class="pun">),</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">v</span><span class="pun">].</span><span class="pln">emplace_back</span><span class="pun">(</span><span class="pln">u</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">dfn</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> tarjan</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> cnt</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">int</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> u </span><span class="pun">:</span><span class="pln"> dcc</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">u</span><span class="pun">];</span><span class="pln">
				</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">!=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">u</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">ans</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">bool</span><span class="pln"> f </span><span class="pun">=</span><span class="pln"> check</span><span class="pun">(</span><span class="pln">dcc</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="lit">0</span><span class="pun">]);</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">f</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll</span><span class="pun">)</span><span class="pln">ans </span><span class="pun">*</span><span class="pln"> V </span><span class="pun">%</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">ans</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln"> ans</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate the Problem!</b><div class="spoiler-content" style="display: block;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11656">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="230">230</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11657">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="24">24</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11658">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="28">28</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11659">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="17">17</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11660">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="41">41</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2135/problem/D1" title="Codeforces Round 1046 (Div. 1)">2135D1 - From the Unknown (Easy Version)</a></p><p><a href="https://codeforces.com/contest/2135/problem/D2" title="Codeforces Round 1046 (Div. 1)">2135D2 - From the Unknown (Hard Version)</a></p><p>Idea &amp; Preparation: <a class="rated-user user-red" href="https://codeforces.com/profile/Error_Yuan" title="Grandmaster Error_Yuan">Error_Yuan</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Try to input <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-707"><span class="MJXp-msubsup" id="MJXp-Span-708"><span class="MJXp-mn" id="MJXp-Span-709" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-710" style="vertical-align: 0.5em;">5</span></span></span></span><script type="math/tex" id="MathJax-Element-107">10^5</script> copies of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-711"><span class="MJXp-mn" id="MJXp-Span-712">1</span></span></span><script type="math/tex" id="MathJax-Element-108">1</script> in the first query. What can you get then?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>After the first query, you can get <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-713"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-714">W</span><span class="MJXp-mo" id="MJXp-Span-715" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-716" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717">L</span><span class="MJXp-mo" id="MJXp-Span-718" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-719">R</span><span class="MJXp-mo" id="MJXp-Span-720" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-109">W\in [L, R]</script>. And <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-721"><span class="MJXp-mn" id="MJXp-Span-722">2</span><span class="MJXp-mo" id="MJXp-Span-723" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724">L</span><span class="MJXp-mo" id="MJXp-Span-725" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-726">R</span></span></span><script type="math/tex" id="MathJax-Element-110">2\cdot L\ge R</script> always holds. Now, can you construct the second query?</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution (Easy)</b><div class="spoiler-content" style="display: block;"><p>In the first query, we will input <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-727"><span class="MJXp-msubsup" id="MJXp-Span-728"><span class="MJXp-mn" id="MJXp-Span-729" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-730" style="vertical-align: 0.5em;">5</span></span></span></span><script type="math/tex" id="MathJax-Element-111">10^5</script> copies of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-731"><span class="MJXp-mn" id="MJXp-Span-732">1</span></span></span><script type="math/tex" id="MathJax-Element-112">1</script>. And the result will be equal to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-733"><span class="MJXp-msubsup" id="MJXp-Span-734"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-735" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-736" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-737" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-738"><span class="MJXp-mo" id="MJXp-Span-739" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.23em;">⌈</span></span><span class="MJXp-mfrac" id="MJXp-Span-740" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-741"><span class="MJXp-mn" id="MJXp-Span-742" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-743" style="vertical-align: 0.5em;">5</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744">W</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-745" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.23em;">⌉</span></span></span></span></span><script type="math/tex" id="MathJax-Element-113">r_1 = \left\lceil\frac{10^5}{W}\right\rceil</script>. By solving the equation <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-746"><span class="MJXp-mrow" id="MJXp-Span-747"><span class="MJXp-mo" id="MJXp-Span-748" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.23em;">⌈</span></span><span class="MJXp-mfrac" id="MJXp-Span-749" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-750"><span class="MJXp-mn" id="MJXp-Span-751" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-752" style="vertical-align: 0.5em;">5</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-753">x</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-754" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.678em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.711em; margin-left: -0.23em;">⌉</span></span></span><span class="MJXp-mo" id="MJXp-Span-755" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-756"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-758" style="vertical-align: -0.4em;">1</span></span></span></span><script type="math/tex" id="MathJax-Element-114">\left\lceil\frac{10^5}{x}\right\rceil = r_1</script>, we can get</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-759"><span class="MJXp-mstyle" id="MJXp-Span-760"><span class="MJXp-mrow" id="MJXp-Span-761"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-762">W</span><span class="MJXp-mo" id="MJXp-Span-763" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mrow" id="MJXp-Span-764"><span class="MJXp-mo" id="MJXp-Span-765" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.17em;">[</span></span><span class="MJXp-mrow" id="MJXp-Span-766"><span class="MJXp-mo" id="MJXp-Span-767" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.23em;">⌈</span></span><span class="MJXp-mfrac" id="MJXp-Span-768" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-769"><span class="MJXp-mn" id="MJXp-Span-770" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-771" style="vertical-align: 0.5em;">5</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-772"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-774" style="vertical-align: -0.4em;">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-775" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.23em;">⌉</span></span></span><span class="MJXp-mo" id="MJXp-Span-776" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-777"><span class="MJXp-mo" id="MJXp-Span-778" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.23em;">⌈</span></span><span class="MJXp-mfrac" id="MJXp-Span-779" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-780"><span class="MJXp-mn" id="MJXp-Span-781" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-782" style="vertical-align: 0.5em;">5</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-783"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-784" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-785" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-786" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-787">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-788" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.23em;">⌉</span></span></span><span class="MJXp-mo" id="MJXp-Span-789" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-790">1</span><span class="MJXp-mo" id="MJXp-Span-791" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.689em;"><span class="MJXp-right MJXp-scale4" style="font-size: 3.756em; margin-left: -0.17em;">]</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-792" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span><script type="math/tex" id="MathJax-Element-115"> \displaystyle{W\in \left [ \left\lceil\frac{10^5}{r_1}\right\rceil, \left\lceil \frac{10^5}{r_1 - 1} \right\rceil - 1 \right ]}. </script></center><p>For example, if:</p> <ul>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-793"><span class="MJXp-msubsup" id="MJXp-Span-794"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-796" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-797" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-798">1</span></span></span><script type="math/tex" id="MathJax-Element-116">r_1 = 1</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-799"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-800">W</span><span class="MJXp-mo" id="MJXp-Span-801" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-802">100</span><span class="MJXp-mspace" id="MJXp-Span-803" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-804">000</span></span></span><script type="math/tex" id="MathJax-Element-117">W=100\,000</script>;</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-805"><span class="MJXp-msubsup" id="MJXp-Span-806"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-808" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-809" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-810">2</span></span></span><script type="math/tex" id="MathJax-Element-118">r_1 = 2</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-811"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">W</span><span class="MJXp-mo" id="MJXp-Span-813" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-814" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-815">50</span><span class="MJXp-mspace" id="MJXp-Span-816" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-817">000</span><span class="MJXp-mo" id="MJXp-Span-818" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-819">99</span><span class="MJXp-mspace" id="MJXp-Span-820" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-821">999</span><span class="MJXp-mo" id="MJXp-Span-822" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-119">W\in [50\,000, 99\,999]</script>;</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-823"><span class="MJXp-msubsup" id="MJXp-Span-824"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-825" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-826" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-827" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-828">3</span></span></span><script type="math/tex" id="MathJax-Element-120">r_1 = 3</script>, then <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-829"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-830">W</span><span class="MJXp-mo" id="MJXp-Span-831" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-832" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-833">33</span><span class="MJXp-mspace" id="MJXp-Span-834" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-835">334</span><span class="MJXp-mo" id="MJXp-Span-836" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-837">49</span><span class="MJXp-mspace" id="MJXp-Span-838" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-839">999</span><span class="MJXp-mo" id="MJXp-Span-840" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-121">W\in [33\,334, 49\,999]</script>;</li>   <li>...</li> </ul><p>For each interval <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-841"><span class="MJXp-mo" id="MJXp-Span-842" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-843">L</span><span class="MJXp-mo" id="MJXp-Span-844" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845">R</span><span class="MJXp-mo" id="MJXp-Span-846" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-122">[L, R]</script> above, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-847"><span class="MJXp-mn" id="MJXp-Span-848">2</span><span class="MJXp-mo" id="MJXp-Span-849" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-850">L</span><span class="MJXp-mo" id="MJXp-Span-851" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-852">R</span></span></span><script type="math/tex" id="MathJax-Element-123">2\cdot L > R</script> always holds, which is because <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-853"><span class="MJXp-mo" id="MJXp-Span-854" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-855" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-856">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-857">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-858">L</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-859" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-860" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-861" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-862" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mo" id="MJXp-Span-863">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-864" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-865">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866">L</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-867">⌋</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-868">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-869" style="margin-left: 0em; margin-right: 0em;">⌋</span><span class="MJXp-mo" id="MJXp-Span-870" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mo" id="MJXp-Span-871" style="margin-left: 0em; margin-right: 0em;">⌊</span><span class="MJXp-mfrac" id="MJXp-Span-872" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-873">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">L</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-875" style="margin-left: 0em; margin-right: 0em;">⌋</span></span></span><script type="math/tex" id="MathJax-Element-124">\lfloor \frac{n}{2L} \rfloor = \lfloor \frac{\lfloor \frac{n}{L} \rfloor}{2} \rfloor \neq \lfloor \frac{n}{L} \rfloor</script>.</p><p>Thus, we can input the following article in the second query:</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-876"><span class="MJXp-mo" id="MJXp-Span-877" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-munderover" id="MJXp-Span-878"><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-879">L</span><span class="MJXp-mo" id="MJXp-Span-880" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-881">1</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-882" style="margin-left: 0px; margin-right: 0.333em;">_</span></span></span><span class="MJXp-mo" id="MJXp-Span-883" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-munderover" id="MJXp-Span-884"><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885">L</span><span class="MJXp-mo" id="MJXp-Span-886" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-887">2</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-888" style="margin-left: 0px; margin-right: 0.333em;">_</span></span></span><span class="MJXp-mo" id="MJXp-Span-889" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-890" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-891" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-munderover" id="MJXp-Span-892"><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-893">L</span><span class="MJXp-mo" id="MJXp-Span-894" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-895">R</span><span class="MJXp-mo" id="MJXp-Span-896" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897">L</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-898" style="margin-left: 0px; margin-right: 0.333em;">_</span></span></span><span class="MJXp-mo" id="MJXp-Span-899" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-900" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><script type="math/tex" id="MathJax-Element-125"> [\underline{L, 1}, \underline{L, 2}, \ldots, \underline{L, R - L}]. </script></center><p>For each of the underlined group <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-901"><span class="MJXp-mo" id="MJXp-Span-902" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903">L</span><span class="MJXp-mo" id="MJXp-Span-904" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-905">x</span><span class="MJXp-mo" id="MJXp-Span-906" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-126">(L, x)</script>:</p> <ul>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-907"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-908">L</span><span class="MJXp-mo" id="MJXp-Span-909" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910">x</span><span class="MJXp-mo" id="MJXp-Span-911" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-912">W</span></span></span><script type="math/tex" id="MathJax-Element-127">L + x \le W</script>, the two words in this group will be displayed in the same line;</li>   <li>Otherwise, they will be displayed in different lines.</li> </ul><p>Note that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-913"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-914">L</span><span class="MJXp-mo" id="MJXp-Span-915" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-916">x</span><span class="MJXp-mo" id="MJXp-Span-917" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-918">L</span><span class="MJXp-mo" id="MJXp-Span-919" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-920">2</span><span class="MJXp-mo" id="MJXp-Span-921" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922">L</span><span class="MJXp-mo" id="MJXp-Span-923" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-924">R</span><span class="MJXp-mo" id="MJXp-Span-925" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">W</span></span></span><script type="math/tex" id="MathJax-Element-128">L + x + L > 2\cdot L > R \ge W</script>, so for each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-927"><span class="MJXp-mn" id="MJXp-Span-928">1</span><span class="MJXp-mo" id="MJXp-Span-929" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-930">x</span><span class="MJXp-mo" id="MJXp-Span-931" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932">W</span><span class="MJXp-mo" id="MJXp-Span-933" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-934">L</span></span></span><script type="math/tex" id="MathJax-Element-129">1\le x \le W - L</script>, the group <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-935"><span class="MJXp-mo" id="MJXp-Span-936" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-937">L</span><span class="MJXp-mo" id="MJXp-Span-938" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939">x</span><span class="MJXp-mo" id="MJXp-Span-940" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-130">(L, x)</script> takes a single line, and for each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-941"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942">W</span><span class="MJXp-mo" id="MJXp-Span-943" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-944">L</span><span class="MJXp-mo" id="MJXp-Span-945" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946">x</span><span class="MJXp-mo" id="MJXp-Span-947" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948">R</span><span class="MJXp-mo" id="MJXp-Span-949" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-950">L</span></span></span><script type="math/tex" id="MathJax-Element-131">W - L < x \le R - L</script>, the group <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-951"><span class="MJXp-mo" id="MJXp-Span-952" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953">L</span><span class="MJXp-mo" id="MJXp-Span-954" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-955">x</span><span class="MJXp-mo" id="MJXp-Span-956" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-132">(L, x)</script> always take two lines. So the result of the query is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-957"><span class="MJXp-msubsup" id="MJXp-Span-958"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-960" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-961" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-962" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-963">W</span><span class="MJXp-mo" id="MJXp-Span-964" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965">L</span><span class="MJXp-mo" id="MJXp-Span-966" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-967" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-968">2</span><span class="MJXp-mo" id="MJXp-Span-969" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-970" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-971">R</span><span class="MJXp-mo" id="MJXp-Span-972" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973">W</span><span class="MJXp-mo" id="MJXp-Span-974" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-133">r_2 = (W - L) + 2\cdot (R - W)</script>. Hence, we get <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-975"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-976">W</span><span class="MJXp-mo" id="MJXp-Span-977" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-978">2</span><span class="MJXp-mo" id="MJXp-Span-979" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">R</span><span class="MJXp-mo" id="MJXp-Span-981" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982">L</span><span class="MJXp-mo" id="MJXp-Span-983" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-984"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-985" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-986" style="vertical-align: -0.4em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-134">W = 2\cdot R - L - r_2</script>. And we need to use <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-987"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-988">n</span><span class="MJXp-mo" id="MJXp-Span-989" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-990">2</span><span class="MJXp-mo" id="MJXp-Span-991" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-992" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-993">R</span><span class="MJXp-mo" id="MJXp-Span-994" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-995">L</span><span class="MJXp-mo" id="MJXp-Span-996" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-997" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-998"><span class="MJXp-mn" id="MJXp-Span-999" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1000" style="vertical-align: 0.5em;">5</span></span></span></span><script type="math/tex" id="MathJax-Element-135">n = 2\cdot (R - L)\le 10^5</script> words in this query.</p><p>Thus, we solved the problem in at most <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1001"><span class="MJXp-mn" id="MJXp-Span-1002">2</span></span></span><script type="math/tex" id="MathJax-Element-136">2</script> queries, which fits the constraints of the Easy Version.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (Easy, C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;ext/pb_ds/assoc_container.hpp&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;ext/pb_ds/tree_policy.hpp&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> __gnu_pbds</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">template</span><span class="pln"> </span><span class="pun">&lt;</span><span class="kwd">class</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Tree</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tree</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">,</span><span class="pln"> null_type</span><span class="pun">,</span><span class="pln"> less</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;,</span><span class="pln"> rb_tree_tag</span><span class="pun">,</span><span class="pln"> tree_order_statistics_node_update</span><span class="pun">&gt;;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> all</span><span class="pun">(</span><span class="pln">v</span><span class="pun">)</span><span class="pln"> v</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> v</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">()</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> logg</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="lit">31</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> __builtin_clz</span><span class="pun">(</span><span class="pln">x</span><span class="pun">))</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> llogg</span><span class="pun">(</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="lit">63</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> __builtin_clzll</span><span class="pun">(</span><span class="pln">x</span><span class="pun">))</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> mini</span><span class="pun">(</span><span class="pln">v</span><span class="pun">)</span><span class="pln"> min_element</span><span class="pun">(</span><span class="pln">v</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> v</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">())</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> maxi</span><span class="pun">(</span><span class="pln">v</span><span class="pun">)</span><span class="pln"> max_element</span><span class="pun">(</span><span class="pln">v</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> v</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">())</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> TIME cerr </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="kwd">double</span><span class="pun">(</span><span class="pln">clock</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> st</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">double</span><span class="pun">)</span><span class="pln">CLOCKS_PER_SEC
</span><span class="com">#define</span><span class="pln"> sq</span><span class="pun">(</span><span class="pln">a</span><span class="pun">)</span><span class="pln"> </span><span class="pun">((</span><span class="pln">a</span><span class="pun">)*(</span><span class="pln">a</span><span class="pun">))</span><span class="pln">
</span><span class="com">#ifdef</span><span class="pln"> hocln
</span><span class="com">#include</span><span class="pln"> </span><span class="str">"deb.h"</span><span class="pln">
</span><span class="com">#else</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> imie</span><span class="pun">(...)</span><span class="pln"> </span><span class="str">""</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> debug</span><span class="pun">()</span><span class="pln"> cerr
</span><span class="com">#endif</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> pair</span><span class="pun">&lt;</span><span class="pln">ll</span><span class="pun">,</span><span class="pln"> ll</span><span class="pun">&gt;</span><span class="pln"> pll</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> pair</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">&gt;</span><span class="pln"> pii</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">double</span><span class="pln"> ld</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> tuple</span><span class="pun">&lt;</span><span class="pln">ll</span><span class="pun">,</span><span class="pln"> ll</span><span class="pun">,</span><span class="pln"> ll</span><span class="pun">&gt;</span><span class="pln"> triple</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> tuple</span><span class="pun">&lt;</span><span class="pln">ll</span><span class="pun">,</span><span class="pln"> ll</span><span class="pun">,</span><span class="pln"> ll</span><span class="pun">,</span><span class="pln"> ll</span><span class="pun">,</span><span class="pln"> ll</span><span class="pun">&gt;</span><span class="pln"> five</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ull</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> INF </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4e18</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> inf </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2e9</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MN </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3e5</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">15</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MX </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2e6</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">15</span><span class="pun">;</span><span class="pln">
</span><span class="com">//const long long MOD = 1e9 + 7;</span><span class="pln">
</span><span class="com">//const long long MOD = 998244353;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">double</span><span class="pln"> PI </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3.141592653589793238462643383279502884197</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">typename</span><span class="pln"> T2</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">bool</span><span class="pln"> chmax</span><span class="pun">(</span><span class="pln">T</span><span class="pun">&amp;</span><span class="pln"> a</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> T2</span><span class="pun">&amp;</span><span class="pln"> b</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> a </span><span class="pun">&lt;</span><span class="pln"> b </span><span class="pun">?</span><span class="pln"> a </span><span class="pun">=</span><span class="pln"> b</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">typename</span><span class="pln"> T2</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">bool</span><span class="pln"> chmin</span><span class="pun">(</span><span class="pln">T</span><span class="pun">&amp;</span><span class="pln"> a</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> T2</span><span class="pun">&amp;</span><span class="pln"> b</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> a </span><span class="pun">&gt;</span><span class="pln"> b </span><span class="pun">?</span><span class="pln"> a </span><span class="pun">=</span><span class="pln"> b</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln"> </span><span class="kwd">using</span><span class="pln"> vector2 </span><span class="pun">=</span><span class="pln"> vector</span><span class="pun">&lt;</span><span class="pln">vector</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;&gt;;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> dx</span><span class="pun">[]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pln"> </span><span class="pun">};</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> dy</span><span class="pun">[]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">};</span><span class="pln">
std</span><span class="pun">::</span><span class="pln">random_device rd</span><span class="pun">;</span><span class="pln">
std</span><span class="pun">::</span><span class="pln">mt19937 gen</span><span class="pun">(</span><span class="pln">rd</span><span class="pun">());</span><span class="pln">
ll random</span><span class="pun">(</span><span class="pln">ll low</span><span class="pun">,</span><span class="pln"> ll high</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> uniform_int_distribution</span><span class="pun">&lt;&gt;</span><span class="pln"> dist</span><span class="pun">(</span><span class="pln">low</span><span class="pun">,</span><span class="pln"> high</span><span class="pun">);</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> dist</span><span class="pun">(</span><span class="pln">gen</span><span class="pun">);</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T1</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">typename</span><span class="pln"> T2</span><span class="pun">&gt;</span><span class="pln"> istream</span><span class="pun">&amp;</span><span class="pln"> </span><span class="kwd">operator</span><span class="pun">&gt;&gt;(</span><span class="pln">istream</span><span class="pun">&amp;</span><span class="pln"> </span><span class="kwd">is</span><span class="pun">,</span><span class="pln"> pair</span><span class="pun">&lt;</span><span class="pln">T1</span><span class="pun">,</span><span class="pln"> T2</span><span class="pun">&gt;&amp;</span><span class="pln"> p</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">is</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">first</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">is</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> p</span><span class="pun">.</span><span class="pln">second</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">template</span><span class="pun">&lt;</span><span class="kwd">typename</span><span class="pln"> T</span><span class="pun">&gt;</span><span class="pln"> ostream</span><span class="pun">&amp;</span><span class="pln"> </span><span class="kwd">operator</span><span class="pun">&lt;&lt;(</span><span class="pln">ostream</span><span class="pun">&amp;</span><span class="pln"> os</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">const</span><span class="pln"> vector</span><span class="pun">&lt;</span><span class="pln">T</span><span class="pun">&gt;&amp;</span><span class="pln"> v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">i</span><span class="pun">:</span><span class="pln"> v</span><span class="pun">)</span><span class="pln"> os </span><span class="pun">&lt;&lt;</span><span class="pln"> i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> os</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> tc </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="kwd">get</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> len </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">-</span><span class="pln">l</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"? "</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> len </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> len</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		cout </span><span class="pun">&lt;&lt;</span><span class="pln"> l </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> i </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	cout </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
	cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"! "</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> len </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> x </span><span class="pun">+</span><span class="pln"> l </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> solve_test</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">=</span><span class="lit">1e5</span><span class="pun">;</span><span class="pln">
	cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"? "</span><span class="pun">;</span><span class="pln">
	cout </span><span class="pun">&lt;&lt;</span><span class="pln"> n </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln"> cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"1 "</span><span class="pun">;</span><span class="pln">
	cout </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">x </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"! "</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> n </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> l </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">((</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> i </span><span class="pun">==</span><span class="pln"> x </span><span class="pun">&amp;&amp;</span><span class="pln"> l </span><span class="pun">==</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> l </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">((</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> i </span><span class="pun">==</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> r </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">get</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln">r</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">cout</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> tt </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> tt</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pun">(</span><span class="pln">tt</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="pun">++</span><span class="pln">tc</span><span class="pun">;</span><span class="pln">
        solve_test</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>Can you do something better than <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1003"><span class="MJXp-msubsup" id="MJXp-Span-1004"><span class="MJXp-mn" id="MJXp-Span-1005" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1006" style="vertical-align: 0.5em;">5</span></span><span class="MJXp-mtext" id="MJXp-Span-1007">&nbsp;</span><span class="MJXp-mn" id="MJXp-Span-1008">1</span><span class="MJXp-mtext" id="MJXp-Span-1009">&nbsp;</span><span class="MJXp-mn" id="MJXp-Span-1010">1</span><span class="MJXp-mtext" id="MJXp-Span-1011">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-1012" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mtext" id="MJXp-Span-1013">&nbsp;</span><span class="MJXp-mn" id="MJXp-Span-1014">1</span></span></span><script type="math/tex" id="MathJax-Element-137">10^5~1~1~\ldots~1</script> in the first query, so that the interval length will be reduced for the second query?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 4</b><div class="spoiler-content" style="display: block;"><p>Change the first query to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1015"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">N</span></span></span><script type="math/tex" id="MathJax-Element-138">N</script> copies of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1017"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018">B</span></span></span><script type="math/tex" id="MathJax-Element-139">B</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1019"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020">N</span></span></span><script type="math/tex" id="MathJax-Element-140">N</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1021"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022">B</span></span></span><script type="math/tex" id="MathJax-Element-141">B</script> are both undetermined constants.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 5</b><div class="spoiler-content" style="display: block;"><p>Brute force to find the optimal value of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1023"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024">N</span></span></span><script type="math/tex" id="MathJax-Element-142">N</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1025"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026">B</span></span></span><script type="math/tex" id="MathJax-Element-143">B</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution (Hard)</b><div class="spoiler-content" style="display: block;"><p>We want to cut down the total length of <em>articles</em>. So here comes a new strategy for the first query: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1027"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1028">N</span></span></span><script type="math/tex" id="MathJax-Element-144">N</script> copies of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1029"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">B</span></span></span><script type="math/tex" id="MathJax-Element-145">B</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1031"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">N</span></span></span><script type="math/tex" id="MathJax-Element-146">N</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1033"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034">B</span></span></span><script type="math/tex" id="MathJax-Element-147">B</script> are both undetermined constants.</p><p>Now, the result for the first query is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1035"><span class="MJXp-msubsup" id="MJXp-Span-1036"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1038" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1039" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mstyle" id="MJXp-Span-1040"><span class="MJXp-mrow" id="MJXp-Span-1041"><span class="MJXp-mo" id="MJXp-Span-1042" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.333em;"><span class="MJXp-right MJXp-scale2" style="font-size: 6.333em; margin-left: -0.33em;">⌈</span></span><span class="MJXp-mfrac" id="MJXp-Span-1043" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044">N</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1045"><span class="MJXp-mo" id="MJXp-Span-1046" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌊</span></span><span class="MJXp-mfrac" id="MJXp-Span-1047" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1048">W</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049">B</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1050" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌋</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1051" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.333em;"><span class="MJXp-right MJXp-scale2" style="font-size: 6.333em; margin-left: -0.33em;">⌉</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-148">r_1 = \displaystyle\left\lceil \frac{N}{\left \lfloor\frac{W}{B}\right\rfloor} \right\rceil</script>.</p><p>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1052"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053">W</span><span class="MJXp-mo" id="MJXp-Span-1054" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-1055" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1056">1</span><span class="MJXp-mo" id="MJXp-Span-1057" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058">B</span><span class="MJXp-mo" id="MJXp-Span-1059" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1060">1</span><span class="MJXp-mo" id="MJXp-Span-1061" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-149">W\in [1, B - 1]</script>, the editor will be unable to display the <em>article</em>, and unfortunately our original strategy for the second query will not work in this case. But we can still use the strategy in the first query! Now we can query <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1062"><span class="MJXp-msubsup" id="MJXp-Span-1063"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064" style="margin-right: 0.05em;">B</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1065" style="vertical-align: 0.5em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-150">B^2</script> copies of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1066"><span class="MJXp-mn" id="MJXp-Span-1067">1</span></span></span><script type="math/tex" id="MathJax-Element-151">1</script>, and it's easy to show that the results for each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1068"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1069">W</span><span class="MJXp-mo" id="MJXp-Span-1070" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1071">1</span><span class="MJXp-mo" id="MJXp-Span-1072" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1073">2</span><span class="MJXp-mo" id="MJXp-Span-1074" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1075" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1076" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1077">B</span><span class="MJXp-mo" id="MJXp-Span-1078" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1079">1</span></span></span><script type="math/tex" id="MathJax-Element-152">W=1,2,\ldots,B - 1</script> will be distinct.</p><p>Otherwise, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1080"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081">W</span><span class="MJXp-mo" id="MJXp-Span-1082" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mo" id="MJXp-Span-1083" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084">B</span><span class="MJXp-mo" id="MJXp-Span-1085" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1086"><span class="MJXp-mn" id="MJXp-Span-1087" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1088" style="vertical-align: 0.5em;">5</span></span><span class="MJXp-mo" id="MJXp-Span-1089" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-153">W\in [B, 10^5]</script>, similar to the easy version, we will get an interval <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1090"><span class="MJXp-mo" id="MJXp-Span-1091" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092">L</span><span class="MJXp-mo" id="MJXp-Span-1093" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094">R</span><span class="MJXp-mo" id="MJXp-Span-1095" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-154">[L, R]</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1096"><span class="MJXp-mn" id="MJXp-Span-1097">2</span><span class="MJXp-mo" id="MJXp-Span-1098" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099">L</span><span class="MJXp-mo" id="MJXp-Span-1100" style="margin-left: 0.333em; margin-right: 0.333em;">≥</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1101">R</span></span></span><script type="math/tex" id="MathJax-Element-155">2\cdot L\ge R</script> always holds. Then, we can use the same strategy as the second query in the easy version and get a solution with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1102"><span class="MJXp-mn" id="MJXp-Span-1103">2</span><span class="MJXp-mo" id="MJXp-Span-1104" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-1105" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106">R</span><span class="MJXp-mo" id="MJXp-Span-1107" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1108">L</span><span class="MJXp-mo" id="MJXp-Span-1109" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-156">2\cdot(R - L)</script> queries. To calculate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1111">L</span></span></span><script type="math/tex" id="MathJax-Element-157">L</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1112"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">R</span></span></span><script type="math/tex" id="MathJax-Element-158">R</script>, you can simply use binary search, or do some math work to get </p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1114"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">W</span><span class="MJXp-mo" id="MJXp-Span-1116" style="margin-left: 0.333em; margin-right: 0.333em;">∈</span><span class="MJXp-mstyle" id="MJXp-Span-1117"><span class="MJXp-mrow" id="MJXp-Span-1118"><span class="MJXp-mo" id="MJXp-Span-1119" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">[</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120">B</span><span class="MJXp-mo" id="MJXp-Span-1121" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mrow" id="MJXp-Span-1122"><span class="MJXp-mo" id="MJXp-Span-1123" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-1124"><span class="MJXp-mo" id="MJXp-Span-1125" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌊</span></span><span class="MJXp-mfrac" id="MJXp-Span-1126" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1127">N</span><span class="MJXp-mo" id="MJXp-Span-1128" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1129">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130">r</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1131" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1132">1</span><span class="MJXp-mo" id="MJXp-Span-1133" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌋</span></span></span><span class="MJXp-mo" id="MJXp-Span-1134" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1135" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1136">B</span><span class="MJXp-mo" id="MJXp-Span-1137" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mrow" id="MJXp-Span-1138"><span class="MJXp-mo" id="MJXp-Span-1139" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-mrow" id="MJXp-Span-1140"><span class="MJXp-mo" id="MJXp-Span-1141" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌊</span></span><span class="MJXp-mfrac" id="MJXp-Span-1142" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1143">N</span><span class="MJXp-mo" id="MJXp-Span-1144" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1145">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146">r</span><span class="MJXp-mo" id="MJXp-Span-1147" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1148">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1149" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1150">1</span><span class="MJXp-mo" id="MJXp-Span-1151" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.18em;">⌋</span></span></span><span class="MJXp-mo" id="MJXp-Span-1152" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1153" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1154">1</span><span class="MJXp-mo" id="MJXp-Span-1155" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">]</span></span></span><span class="MJXp-mo" id="MJXp-Span-1156" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span><script type="math/tex" id="MathJax-Element-159"> W\in \displaystyle \left[B\cdot \left(\left\lfloor\frac{N - 1}{r} + 1\right\rfloor \right), B\cdot \left(\left\lfloor\frac{N - 1}{r - 1} + 1\right\rfloor \right) - 1\right]. </script></center><p>There is also a fact that the rightmost interval will be cut off by the upper bound of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1157"><span class="MJXp-msubsup" id="MJXp-Span-1158"><span class="MJXp-mn" id="MJXp-Span-1159" style="margin-right: 0.05em;">10</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1160" style="vertical-align: 0.5em;">5</span></span></span></span><script type="math/tex" id="MathJax-Element-160">10^5</script>. </p><p>We can use brute force to find suitable values for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162">N</span></span></span><script type="math/tex" id="MathJax-Element-161">N</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1163"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1164">B</span></span></span><script type="math/tex" id="MathJax-Element-162">B</script>. In the main correct solution, we choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1165"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1166">N</span><span class="MJXp-mo" id="MJXp-Span-1167" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1168">11</span><span class="MJXp-mspace" id="MJXp-Span-1169" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-1170">343</span></span></span><script type="math/tex" id="MathJax-Element-163">N = 11\,343</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1172">B</span><span class="MJXp-mo" id="MJXp-Span-1173" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1174">116</span></span></span><script type="math/tex" id="MathJax-Element-164">B = 116</script>, and the maximal interval length is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1175"><span class="MJXp-mn" id="MJXp-Span-1176">6</span><span class="MJXp-mspace" id="MJXp-Span-1177" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-1178">263</span></span></span><script type="math/tex" id="MathJax-Element-165">6\,263</script>. Thus, the total length of <em>articles</em> won't exceed <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1179"><span class="MJXp-mn" id="MJXp-Span-1180">11</span><span class="MJXp-mspace" id="MJXp-Span-1181" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-1182">343</span><span class="MJXp-mo" id="MJXp-Span-1183" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1184" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1185" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1186">2</span><span class="MJXp-mo" id="MJXp-Span-1187" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mn" id="MJXp-Span-1188">6</span><span class="MJXp-mspace" id="MJXp-Span-1189" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-1190">263</span><span class="MJXp-mo" id="MJXp-Span-1191" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1192"><span class="MJXp-mn" id="MJXp-Span-1193" style="margin-right: 0.05em;">116</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1194" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1195" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1196" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1197">24</span><span class="MJXp-mspace" id="MJXp-Span-1198" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-1199">799</span><span class="MJXp-mo" id="MJXp-Span-1200" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-1201">25</span><span class="MJXp-mspace" id="MJXp-Span-1202" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-1203">000</span></span></span><script type="math/tex" id="MathJax-Element-166">11\,343 + \max(2\cdot 6\,263, 116^2) = 24\,799\le 25\,000</script>.</p><p>By some further optimization we can reduce <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1204"><span class="MJXp-msubsup" id="MJXp-Span-1205"><span class="MJXp-mn" id="MJXp-Span-1206" style="margin-right: 0.05em;">116</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1207" style="vertical-align: 0.5em;">2</span></span></span></span><script type="math/tex" id="MathJax-Element-167">116^2</script> a little to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1208"><span class="MJXp-mo" id="MJXp-Span-1209" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-1210">12</span><span class="MJXp-mspace" id="MJXp-Span-1211" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-1212">526</span></span></span><script type="math/tex" id="MathJax-Element-168">\le 12\, 526</script>, so the total length of <em>articles</em> can be reduced to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1213"><span class="MJXp-mn" id="MJXp-Span-1214">23</span><span class="MJXp-mspace" id="MJXp-Span-1215" style="width: 0.167em; height: 0em;"></span><span class="MJXp-mn" id="MJXp-Span-1216">869</span></span></span><script type="math/tex" id="MathJax-Element-169">23\,869</script>, but that's not needed.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (Hard, C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MAXW </span><span class="pun">=</span><span class="pln"> </span><span class="lit">100</span><span class="str">'000;
const int MAXSUM = 25'</span><span class="lit">000</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> B </span><span class="pun">=</span><span class="pln"> </span><span class="lit">116</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> K </span><span class="pun">=</span><span class="pln"> </span><span class="lit">11343</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> ask</span><span class="pun">(</span><span class="pln">vector</span><span class="str">&lt;int&gt;</span><span class="pln"> v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"? "</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> v</span><span class="pun">.</span><span class="pln">size</span><span class="pun">();</span><span class="pln">
  </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">:</span><span class="pln"> v</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">' '</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  cout </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
  cin </span><span class="pun">&gt;&gt;</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">==</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">exit</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
  </span><span class="kwd">return</span><span class="pln"> x</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> answer</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> cout </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">"! "</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> x </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    vector</span><span class="str">&lt;int&gt;</span><span class="pln"> v_qry1</span><span class="pun">(</span><span class="pln">K</span><span class="pun">,</span><span class="pln"> B</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> res_qry1 </span><span class="pun">=</span><span class="pln"> ask</span><span class="pun">(</span><span class="pln">v_qry1</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">res_qry1 </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="com">// W &lt; B</span><span class="pln">
      vector</span><span class="str">&lt;int&gt;</span><span class="pln"> v_qry2</span><span class="pun">(</span><span class="pln">B </span><span class="pun">*</span><span class="pln"> B</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
      </span><span class="kwd">int</span><span class="pln"> res_qry2 </span><span class="pun">=</span><span class="pln"> ask</span><span class="pun">(</span><span class="pln">v_qry2</span><span class="pun">);</span><span class="pln">
      </span><span class="kwd">int</span><span class="pln"> w </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">B </span><span class="pun">*</span><span class="pln"> B </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="pun">(</span><span class="pln">res_qry2 </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
      answer</span><span class="pun">(</span><span class="pln">w</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="com">// W &gt;= B</span><span class="pln">
      </span><span class="kwd">int</span><span class="pln"> min_w </span><span class="pun">=</span><span class="pln"> </span><span class="pun">((</span><span class="pln">K </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> res_qry1 </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> B</span><span class="pun">,</span><span class="pln">
          max_w </span><span class="pun">=</span><span class="pln"> </span><span class="pun">((</span><span class="pln">K </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="pun">(</span><span class="pln">res_qry1 </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> B </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
      max_w </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">max_w</span><span class="pun">,</span><span class="pln"> MAXW</span><span class="pun">);</span><span class="pln">
      </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> w </span><span class="pun">=</span><span class="pln"> B</span><span class="pun">;</span><span class="pln"> w </span><span class="pun">&lt;=</span><span class="pln"> MAXW</span><span class="pun">;</span><span class="pln"> w</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> h </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">K </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="pun">(</span><span class="pln">w </span><span class="pun">/</span><span class="pln"> B</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">h </span><span class="pun">==</span><span class="pln"> res_qry1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
          </span><span class="kwd">assert</span><span class="pun">(</span><span class="pln">min_w </span><span class="pun">&lt;=</span><span class="pln"> w</span><span class="pun">);</span><span class="pln">
          </span><span class="kwd">assert</span><span class="pun">(</span><span class="pln">w </span><span class="pun">&lt;=</span><span class="pln"> max_w</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
          </span><span class="kwd">assert</span><span class="pun">(</span><span class="pln">w </span><span class="pun">&lt;</span><span class="pln"> min_w </span><span class="pun">||</span><span class="pln"> w </span><span class="pun">&gt;</span><span class="pln"> max_w</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
      </span><span class="pun">}</span><span class="pln">

      </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">min_w </span><span class="pun">==</span><span class="pln"> max_w</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        answer</span><span class="pun">(</span><span class="pln">min_w</span><span class="pun">);</span><span class="pln">
      </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        vector</span><span class="str">&lt;int&gt;</span><span class="pln"> v_qry2</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> min_w </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> max_w</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
          v_qry2</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">min_w </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
          v_qry2</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> min_w </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v_qry2</span><span class="pun">.</span><span class="pln">empty</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
          v_qry2</span><span class="pun">.</span><span class="pln">push_back</span><span class="pun">(</span><span class="pln">min_w </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> res_qry2 </span><span class="pun">=</span><span class="pln"> ask</span><span class="pun">(</span><span class="pln">v_qry2</span><span class="pun">);</span><span class="pln">

        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">res_qry2 </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
          answer</span><span class="pun">(</span><span class="pln">min_w</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
          answer</span><span class="pun">(</span><span class="pln">min_w </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">((</span><span class="kwd">int</span><span class="pun">)</span><span class="pln">v_qry2</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> res_qry2</span><span class="pun">));</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
      </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate the Problem! (Easy)</b><div class="spoiler-content" style="display: block;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11661">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="220">220</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11662">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="30">30</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11663">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="12">12</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11664">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="7">7</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11665">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="15">15</span>
            </i>
        </a>
    </span>


</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Rate the Problem! (Hard)</b><div class="spoiler-content" style="display: block;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11666">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="61">61</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11667">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="28">28</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11668">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="9">9</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11669">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="21">21</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11670">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="164">164</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2135/problem/E1" title="Codeforces Round 1046 (Div. 1)">2135E1 - Beyond the Palindrome (Easy Version)</a></p><p><a href="https://codeforces.com/contest/2135/problem/E2" title="Codeforces Round 1046 (Div. 1)">2135E2 - Beyond the Palindrome (Hard Version)</a></p><p>Idea &amp; Preparation: <a class="rated-user user-orange" href="https://codeforces.com/profile/Register" title="Master Register">Register</a><br>Full Solution: <a class="rated-user user-red" href="https://codeforces.com/profile/STUDENT0" title="Grandmaster STUDENT0">STUDENT0</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Replace <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1217"><span class="MJXp-mn MJXp-mono" id="MJXp-Span-1218">0</span></span></span><script type="math/tex" id="MathJax-Element-170">\tt 0</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1219"><span class="MJXp-mn" id="MJXp-Span-1220">1</span></span></span><script type="math/tex" id="MathJax-Element-171">1</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1221"><span class="MJXp-mn MJXp-mono" id="MJXp-Span-1222">1</span></span></span><script type="math/tex" id="MathJax-Element-172">\tt 1</script> with <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1223"><span class="MJXp-mo" id="MJXp-Span-1224" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-1225">1</span></span></span><script type="math/tex" id="MathJax-Element-173">-1</script>. Try to find a sufficient and necessary condition of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1226"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1227">s</span></span></span><script type="math/tex" id="MathJax-Element-174">s</script> <em>almost-palindrome</em>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Denote the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1228"><span class="MJXp-mo" id="MJXp-Span-1229" style="margin-left: 0em; margin-right: 0.111em;">±</span><span class="MJXp-mn" id="MJXp-Span-1230">1</span></span></span><script type="math/tex" id="MathJax-Element-175">\pm 1</script>-s you get in <strong>Hint 1</strong> as array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1231"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232">a</span></span></span><script type="math/tex" id="MathJax-Element-176">a</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1233"><span class="MJXp-msubsup" id="MJXp-Span-1234"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1235" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1236" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1237" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1238"><span class="MJXp-mo" id="MJXp-Span-1239" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1244">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1240"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1241">j</span><span class="MJXp-mo" id="MJXp-Span-1242">=</span><span class="MJXp-mn" id="MJXp-Span-1243">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1245"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1247" style="vertical-align: -0.4em;">j</span></span></span></span><script type="math/tex" id="MathJax-Element-177">b_i = \sum_{j=1}^n a_j</script>. (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1248"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1249">s</span></span></span><script type="math/tex" id="MathJax-Element-178">s</script> is <em>almost-palindrome</em>) <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1250"><span class="MJXp-mo" id="MJXp-Span-1251" style="margin-left: 0.333em; margin-right: 0.333em;">⟺</span></span></span><script type="math/tex" id="MathJax-Element-179">\Longleftrightarrow</script> (<span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1252"><span class="MJXp-mo" id="MJXp-Span-1253" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-msubsup" id="MJXp-Span-1254"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1255" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1256" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1257" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1258" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-msubsup" id="MJXp-Span-1259"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1261" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1262" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1263"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1264" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1265" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-180">\min b_i + \max b_i = b_n</script>),</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>You will need to solve the following subproblem:</p><p>You are on an infinite 2D plane, initially at <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1266"><span class="MJXp-mo" id="MJXp-Span-1267" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1268">0</span><span class="MJXp-mo" id="MJXp-Span-1269" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1270">0</span><span class="MJXp-mo" id="MJXp-Span-1271" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-181">(0, 0)</script>. You can only move up/right by <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1272"><span class="MJXp-mn" id="MJXp-Span-1273">1</span></span></span><script type="math/tex" id="MathJax-Element-182">1</script> unit in one step. Also, you cannot touch the line <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1274"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">y</span><span class="MJXp-mo" id="MJXp-Span-1276" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277">x</span><span class="MJXp-mo" id="MJXp-Span-1278" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279">l</span></span></span><script type="math/tex" id="MathJax-Element-183">y=x + l</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1280"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1281">y</span><span class="MJXp-mo" id="MJXp-Span-1282" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">x</span><span class="MJXp-mo" id="MJXp-Span-1284" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1285">r</span></span></span><script type="math/tex" id="MathJax-Element-184">y = x+ r</script> during your move. Count the number of ways to travel to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1286"><span class="MJXp-mo" id="MJXp-Span-1287" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288">n</span><span class="MJXp-mo" id="MJXp-Span-1289" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1290">m</span><span class="MJXp-mo" id="MJXp-Span-1291" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-185">(n, m)</script>.</p><p>We can solve the subproblem by a technique called "reflection inclusion-exclusion" in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1292"><span class="MJXp-mrow" id="MJXp-Span-1293"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1294">O</span></span><span class="MJXp-mrow" id="MJXp-Span-1295"><span class="MJXp-mo" id="MJXp-Span-1296" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-1297" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1298">n</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1299"><span class="MJXp-mo" id="MJXp-Span-1300">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1301">l</span><span class="MJXp-mo" id="MJXp-Span-1302">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1303">r</span><span class="MJXp-mrow" id="MJXp-Span-1304"><span class="MJXp-mo" id="MJXp-Span-1305">|</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1306" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-186">\mathcal{O}\left(\frac{n}{|l - r|}\right)</script> time complexity. You can view more details in problem E1 part of this blog: <a href="https://codeforces.com/blog/entry/129027">https://codeforces.com/blog/entry/129027</a></p><p>Or here is a detailed explanation in Chinese: <a href="https://www.cnblogs.com/Hanghang007/p/18159154">https://www.cnblogs.com/Hanghang007/p/18159154</a></p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 4</b><div class="spoiler-content" style="display: block;"><p>Try to compress sums by processing all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1307"><span class="MJXp-mo" id="MJXp-Span-1308" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-msubsup" id="MJXp-Span-1309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1310" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1311" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1312" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-1313" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-msubsup" id="MJXp-Span-1314"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1315" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1316" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1317" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1318">k</span></span></span><script type="math/tex" id="MathJax-Element-187">\max b_i - \min b_i = k</script> together.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution (Easy)</b><div class="spoiler-content" style="display: block;"><p>Read the hints first.</p><p>Recall the answer for the subproblem in <strong>Hint 3</strong> as <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1319"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1320">f</span><span class="MJXp-mo" id="MJXp-Span-1321" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322">n</span><span class="MJXp-mo" id="MJXp-Span-1323" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324">m</span><span class="MJXp-mo" id="MJXp-Span-1325" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1326">l</span><span class="MJXp-mo" id="MJXp-Span-1327" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1328">r</span><span class="MJXp-mo" id="MJXp-Span-1329" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-188">f(n, m, l, r)</script>, we have</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1330"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1331">f</span><span class="MJXp-mo" id="MJXp-Span-1332" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1333">n</span><span class="MJXp-mo" id="MJXp-Span-1334" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335">m</span><span class="MJXp-mo" id="MJXp-Span-1336" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1337">l</span><span class="MJXp-mo" id="MJXp-Span-1338" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1339">r</span><span class="MJXp-mo" id="MJXp-Span-1340" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1341" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mstyle" id="MJXp-Span-1342"><span class="MJXp-munderover" id="MJXp-Span-1343"><span class=""><span class="MJXp-mo" id="MJXp-Span-1344" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1345" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1346">k</span><span class="MJXp-mo" id="MJXp-Span-1347">∈</span><span class="MJXp-mrow" id="MJXp-Span-1348"><span class="MJXp-mi undefined" id="MJXp-Span-1349">Z</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1350"><span class="MJXp-mrow" id="MJXp-Span-1351"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1352"><span class="MJXp-mstyle" id="MJXp-Span-1353"><span class="MJXp-mrow" id="MJXp-Span-1354"><span class="MJXp-mo" id="MJXp-Span-1355" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1356"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1357"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1358">n</span><span class="MJXp-mo" id="MJXp-Span-1359" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1360">m</span></span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1361"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1362">n</span><span class="MJXp-mo" id="MJXp-Span-1363" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1364">k</span><span class="MJXp-mo" id="MJXp-Span-1365" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-1366" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1367">r</span><span class="MJXp-mo" id="MJXp-Span-1368" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1369">l</span><span class="MJXp-mo" id="MJXp-Span-1370" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1371"><span class="MJXp-mstyle" id="MJXp-Span-1372"><span class="MJXp-mrow" id="MJXp-Span-1373"><span class="MJXp-mo" id="MJXp-Span-1374" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1375" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-1376"><span class="MJXp-mrow" id="MJXp-Span-1377"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1378"><span class="MJXp-mstyle" id="MJXp-Span-1379"><span class="MJXp-mrow" id="MJXp-Span-1380"><span class="MJXp-mo" id="MJXp-Span-1381" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1382"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1384">n</span><span class="MJXp-mo" id="MJXp-Span-1385" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1386">m</span></span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1387"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1388">n</span><span class="MJXp-mo" id="MJXp-Span-1389" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1390">k</span><span class="MJXp-mo" id="MJXp-Span-1391" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-1392" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1393">r</span><span class="MJXp-mo" id="MJXp-Span-1394" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1395">l</span><span class="MJXp-mo" id="MJXp-Span-1396" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1397" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398">r</span></span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1399"><span class="MJXp-mstyle" id="MJXp-Span-1400"><span class="MJXp-mrow" id="MJXp-Span-1401"><span class="MJXp-mo" id="MJXp-Span-1402" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1403" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span><script type="math/tex" id="MathJax-Element-189"> f(n, m, l, r) = \displaystyle \sum_{k\in \mathbb Z} {n + m\choose n - k\cdot (r - l)} - {n + m\choose n -k\cdot (r - l) + r}. </script></center><p>Suppose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1404"><span class="MJXp-mo" id="MJXp-Span-1405" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-msubsup" id="MJXp-Span-1406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1408" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1409" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1410">l</span></span></span><script type="math/tex" id="MathJax-Element-190">\min b_i = l</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1411"><span class="MJXp-mo" id="MJXp-Span-1412" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-msubsup" id="MJXp-Span-1413"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1415" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1416" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1417">r</span></span></span><script type="math/tex" id="MathJax-Element-191">\max b_i = r</script>, the number of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1418"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1419">b</span></span></span><script type="math/tex" id="MathJax-Element-192">b</script>-s is the number of ways to travel from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1420"><span class="MJXp-mo" id="MJXp-Span-1421" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1422">0</span><span class="MJXp-mo" id="MJXp-Span-1423" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1424">0</span><span class="MJXp-mo" id="MJXp-Span-1425" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-193">(0, 0)</script> to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1426"><span class="MJXp-mo" id="MJXp-Span-1427" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1428">n</span><span class="MJXp-mo" id="MJXp-Span-1429" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1430">m</span><span class="MJXp-mo" id="MJXp-Span-1431" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-194">(n, m)</script>, "exactly" touching <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1432"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433">y</span><span class="MJXp-mo" id="MJXp-Span-1434" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1435">x</span><span class="MJXp-mo" id="MJXp-Span-1436" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1437">l</span></span></span><script type="math/tex" id="MathJax-Element-195">y=x+l</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1438"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1439">y</span><span class="MJXp-mo" id="MJXp-Span-1440" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1441">x</span><span class="MJXp-mo" id="MJXp-Span-1442" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1443">r</span></span></span><script type="math/tex" id="MathJax-Element-196">y=x+r</script>, that is, </p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1444"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1445">f</span><span class="MJXp-mrow" id="MJXp-Span-1446"><span class="MJXp-mo" id="MJXp-Span-1447" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-1448" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1449">n</span><span class="MJXp-mo" id="MJXp-Span-1450">−</span><span class="MJXp-mo" id="MJXp-Span-1451">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1452">l</span><span class="MJXp-mo" id="MJXp-Span-1453">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1454">r</span><span class="MJXp-mo" id="MJXp-Span-1455">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1456">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1457" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mfrac" id="MJXp-Span-1458" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1459">n</span><span class="MJXp-mo" id="MJXp-Span-1460">+</span><span class="MJXp-mo" id="MJXp-Span-1461">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1462">l</span><span class="MJXp-mo" id="MJXp-Span-1463">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464">r</span><span class="MJXp-mo" id="MJXp-Span-1465">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1466">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1467" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1468">l</span><span class="MJXp-mo" id="MJXp-Span-1469" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1470">r</span><span class="MJXp-mo" id="MJXp-Span-1471" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1472" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1473">f</span><span class="MJXp-mrow" id="MJXp-Span-1474"><span class="MJXp-mo" id="MJXp-Span-1475" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-1476" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1477">n</span><span class="MJXp-mo" id="MJXp-Span-1478">−</span><span class="MJXp-mo" id="MJXp-Span-1479">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480">l</span><span class="MJXp-mo" id="MJXp-Span-1481">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482">r</span><span class="MJXp-mo" id="MJXp-Span-1483">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1484">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1485" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mfrac" id="MJXp-Span-1486" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1487">n</span><span class="MJXp-mo" id="MJXp-Span-1488">+</span><span class="MJXp-mo" id="MJXp-Span-1489">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490">l</span><span class="MJXp-mo" id="MJXp-Span-1491">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1492">r</span><span class="MJXp-mo" id="MJXp-Span-1493">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1494">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1495" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1496">l</span><span class="MJXp-mo" id="MJXp-Span-1497" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1498">1</span><span class="MJXp-mo" id="MJXp-Span-1499" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500">r</span><span class="MJXp-mo" id="MJXp-Span-1501" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">)</span></span></span><span class="MJXp-mspace" id="MJXp-Span-1502" style="width: 0em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1503" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1504">f</span><span class="MJXp-mrow" id="MJXp-Span-1505"><span class="MJXp-mo" id="MJXp-Span-1506" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-1507" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1508">n</span><span class="MJXp-mo" id="MJXp-Span-1509">−</span><span class="MJXp-mo" id="MJXp-Span-1510">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1511">l</span><span class="MJXp-mo" id="MJXp-Span-1512">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1513">r</span><span class="MJXp-mo" id="MJXp-Span-1514">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1515">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1516" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mfrac" id="MJXp-Span-1517" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1518">n</span><span class="MJXp-mo" id="MJXp-Span-1519">+</span><span class="MJXp-mo" id="MJXp-Span-1520">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521">l</span><span class="MJXp-mo" id="MJXp-Span-1522">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1523">r</span><span class="MJXp-mo" id="MJXp-Span-1524">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1525">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1526" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1527">l</span><span class="MJXp-mo" id="MJXp-Span-1528" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1529">r</span><span class="MJXp-mo" id="MJXp-Span-1530" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1531">1</span><span class="MJXp-mo" id="MJXp-Span-1532" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1533" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1534">f</span><span class="MJXp-mrow" id="MJXp-Span-1535"><span class="MJXp-mo" id="MJXp-Span-1536" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-1537" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1538">n</span><span class="MJXp-mo" id="MJXp-Span-1539">−</span><span class="MJXp-mo" id="MJXp-Span-1540">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1541">l</span><span class="MJXp-mo" id="MJXp-Span-1542">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1543">r</span><span class="MJXp-mo" id="MJXp-Span-1544">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1545">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1546" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mfrac" id="MJXp-Span-1547" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548">n</span><span class="MJXp-mo" id="MJXp-Span-1549">+</span><span class="MJXp-mo" id="MJXp-Span-1550">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1551">l</span><span class="MJXp-mo" id="MJXp-Span-1552">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1553">r</span><span class="MJXp-mo" id="MJXp-Span-1554">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1555">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1556" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1557">l</span><span class="MJXp-mo" id="MJXp-Span-1558" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1559">1</span><span class="MJXp-mo" id="MJXp-Span-1560" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1561">r</span><span class="MJXp-mo" id="MJXp-Span-1562" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1563">1</span><span class="MJXp-mo" id="MJXp-Span-1564" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1565" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><script type="math/tex" id="MathJax-Element-197">f\left(\frac{n-(l+r)}{2},\frac{n+(l+r)}{2},l,r\right) - f\left(\frac{n-(l+r)}{2},\frac{n+(l+r)}{2},l-1,r\right) \\ -f\left(\frac{n-(l+r)}{2},\frac{n+(l+r)}{2},l,r+1\right)+f\left(\frac{n-(l+r)}{2},\frac{n+(l+r)}{2},l-1,r+1\right). </script></center><p>Now we can compress the sums by processing all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1566"><span class="MJXp-mo" id="MJXp-Span-1567" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-msubsup" id="MJXp-Span-1568"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1569" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1570" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1571" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-1572" style="margin-left: 0.333em; margin-right: 0.333em;">min</span><span class="MJXp-msubsup" id="MJXp-Span-1573"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1574" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1575" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1576" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1577">k</span></span></span><script type="math/tex" id="MathJax-Element-198">\max b_i - \min b_i = k</script> together. Let's enumerate on <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1578"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1579">k</span></span></span><script type="math/tex" id="MathJax-Element-199">k</script>, and note that the upper index of binomials is always <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1580"><span class="MJXp-mfrac" id="MJXp-Span-1581" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1582">n</span><span class="MJXp-mo" id="MJXp-Span-1583">−</span><span class="MJXp-mo" id="MJXp-Span-1584">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1585">l</span><span class="MJXp-mo" id="MJXp-Span-1586">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1587">r</span><span class="MJXp-mo" id="MJXp-Span-1588">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1589">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1590" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-1591" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1592">n</span><span class="MJXp-mo" id="MJXp-Span-1593">+</span><span class="MJXp-mo" id="MJXp-Span-1594">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1595">l</span><span class="MJXp-mo" id="MJXp-Span-1596">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1597">r</span><span class="MJXp-mo" id="MJXp-Span-1598">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1599">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1600" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1601">n</span></span></span><script type="math/tex" id="MathJax-Element-200">\frac{n-(l+r)}{2}+\frac{n+(l+r)}{2}=n</script>, and the lower index moves contiguously with the same <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1602"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1603">k</span></span></span><script type="math/tex" id="MathJax-Element-201">k</script>. </p><p>Thus, we have solved the problem in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1604"><span class="MJXp-mrow" id="MJXp-Span-1605"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-1606">O</span></span><span class="MJXp-mo" id="MJXp-Span-1607" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1608">n</span><span class="MJXp-mi" id="MJXp-Span-1609">log</span><span class="MJXp-mo" id="MJXp-Span-1610" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1611">n</span><span class="MJXp-mo" id="MJXp-Span-1612" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-202">\mathcal{O}(n\log n)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (Easy, C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
 
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MAXN </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e6</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">10</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> mod </span><span class="pun">=</span><span class="pln"> </span><span class="lit">998244353</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> x </span><span class="pun">+=</span><span class="pln"> y</span><span class="pun">,</span><span class="pln"> x </span><span class="pun">&lt;</span><span class="pln"> mod </span><span class="pun">?</span><span class="pln"> x </span><span class="pun">:</span><span class="pln"> x </span><span class="pun">-</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">sub</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> x </span><span class="pun">-=</span><span class="pln"> y</span><span class="pun">,</span><span class="pln"> x </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> x </span><span class="pun">+</span><span class="pln"> mod </span><span class="pun">:</span><span class="pln"> x</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> cadd</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> x </span><span class="pun">+=</span><span class="pln"> y</span><span class="pun">,</span><span class="pln"> x </span><span class="pun">&lt;</span><span class="pln"> mod </span><span class="pun">||</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">-=</span><span class="pln"> mod</span><span class="pun">);</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> csub</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> x </span><span class="pun">-=</span><span class="pln"> y</span><span class="pun">,</span><span class="pln"> x </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">+=</span><span class="pln"> mod</span><span class="pun">);</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> inv</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">],</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">],</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">];</span><span class="pln">
 
</span><span class="kwd">inline</span><span class="pln"> 
</span><span class="kwd">void</span><span class="pln"> init</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	inv</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> inv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll</span><span class="pun">)(</span><span class="pln">mod </span><span class="pun">-</span><span class="pln"> mod </span><span class="pun">/</span><span class="pln"> i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> inv</span><span class="pun">[</span><span class="pln">mod </span><span class="pun">%</span><span class="pln"> i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">inline</span><span class="pln"> 
</span><span class="kwd">int</span><span class="pln"> ask</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	l </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">),</span><span class="pln"> r </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> l </span><span class="pun">?</span><span class="pln"> </span><span class="kwd">sub</span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">r</span><span class="pun">],</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">l </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">])</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">r</span><span class="pun">];</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">inline</span><span class="pln"> 
</span><span class="kwd">int</span><span class="pln"> calc</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> sum </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> k </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> p </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> t</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		cadd</span><span class="pun">(</span><span class="pln">sum</span><span class="pun">,</span><span class="pln"> ask</span><span class="pun">((</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> k </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> p </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> t</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> k </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> t </span><span class="pun">-</span><span class="pln"> p </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> t</span><span class="pun">)));</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> k </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> p </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> t</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		csub</span><span class="pun">(</span><span class="pln">sum</span><span class="pun">,</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll</span><span class="pun">)(</span><span class="pln">k </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> t</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> a</span><span class="pun">[(</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> k </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> p </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> t</span><span class="pun">)]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> mod</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> k </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> p </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> t</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		cadd</span><span class="pun">(</span><span class="pln">sum</span><span class="pun">,</span><span class="pln"> ask</span><span class="pun">((</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> k </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> p </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> t</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> k </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> t </span><span class="pun">+</span><span class="pln"> p </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> t</span><span class="pun">)));</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> k </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> t </span><span class="pun">+</span><span class="pln"> p </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> t</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> p</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		csub</span><span class="pun">(</span><span class="pln">sum</span><span class="pun">,</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll</span><span class="pun">)(</span><span class="pln">k </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> t</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> a</span><span class="pun">[(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> k </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> t </span><span class="pun">+</span><span class="pln"> p </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> t</span><span class="pun">)]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> mod</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> sum</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">,</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">T</span><span class="pun">),</span><span class="pln"> init</span><span class="pun">(</span><span class="lit">1e6</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln"> T</span><span class="pun">--;</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">),</span><span class="pln"> </span><span class="pun">*</span><span class="pln">a </span><span class="pun">=</span><span class="pln"> </span><span class="pun">*</span><span class="pln">s </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll</span><span class="pun">)</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> inv</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> mod </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
			s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">],</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> y </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">+</span><span class="pln"> i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
			cadd</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">),</span><span class="pln"> cadd</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">,</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> calc</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">));</span><span class="pln">
			y </span><span class="pun">=</span><span class="pln"> calc</span><span class="pun">(</span><span class="pln">i</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">),</span><span class="pln"> csub</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">y</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">));</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln"> ans</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Hint 5</b><div class="spoiler-content" style="display: block;"><p>List out the coefficients of all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1613"><span class="MJXp-mrow" id="MJXp-Span-1614"><span class="MJXp-mrow" id="MJXp-Span-1615"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1616"><span class="MJXp-mstyle" id="MJXp-Span-1617"><span class="MJXp-mrow" id="MJXp-Span-1618"><span class="MJXp-mo" id="MJXp-Span-1619" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1620"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1621">n</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1622">m</span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1623"><span class="MJXp-mstyle" id="MJXp-Span-1624"><span class="MJXp-mrow" id="MJXp-Span-1625"><span class="MJXp-mo" id="MJXp-Span-1626" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-203">{n\choose m}</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 6</b><div class="spoiler-content" style="display: block;"><p>Try linear sieve.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution (Hard)</b><div class="spoiler-content" style="display: block;"><p>Read the hints and E1 editorial first. We'll try to speed up in a different way.</p><p>Let's consider <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1627"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1628">f</span><span class="MJXp-mrow" id="MJXp-Span-1629"><span class="MJXp-mo" id="MJXp-Span-1630" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-1631" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1632">n</span><span class="MJXp-mo" id="MJXp-Span-1633">−</span><span class="MJXp-mo" id="MJXp-Span-1634">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1635">l</span><span class="MJXp-mo" id="MJXp-Span-1636">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1637">r</span><span class="MJXp-mo" id="MJXp-Span-1638">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1639">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1640" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mfrac" id="MJXp-Span-1641" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1642">n</span><span class="MJXp-mo" id="MJXp-Span-1643">+</span><span class="MJXp-mo" id="MJXp-Span-1644">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1645">l</span><span class="MJXp-mo" id="MJXp-Span-1646">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1647">r</span><span class="MJXp-mo" id="MJXp-Span-1648">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1649">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1650" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1651">l</span><span class="MJXp-mo" id="MJXp-Span-1652" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1653">r</span><span class="MJXp-mo" id="MJXp-Span-1654" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-204">f\left(\frac{n-(l+r)}{2},\frac{n+(l+r)}{2},l,r\right)</script> first. Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1655"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1656">k</span><span class="MJXp-mo" id="MJXp-Span-1657" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1658">r</span><span class="MJXp-mo" id="MJXp-Span-1659" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1660">l</span></span></span><script type="math/tex" id="MathJax-Element-205">k=r-l</script>. For each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1661"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1662">k</span><span class="MJXp-mo" id="MJXp-Span-1663" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1664">1</span><span class="MJXp-mo" id="MJXp-Span-1665" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1666">2</span><span class="MJXp-mo" id="MJXp-Span-1667" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1668" style="margin-left: 0em; margin-right: 0em;">…</span><span class="MJXp-mo" id="MJXp-Span-1669" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1670">n</span></span></span><script type="math/tex" id="MathJax-Element-206">k=1,2,\ldots,n</script>, we have</p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1671"><span class="MJXp-mstyle" id="MJXp-Span-1672"><span class="MJXp-munderover" id="MJXp-Span-1673"><span class=""><span class="MJXp-mo" id="MJXp-Span-1674" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1675" style="margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-1676">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1677">k</span><span class="MJXp-mo" id="MJXp-Span-1678">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1679">l</span><span class="MJXp-mo" id="MJXp-Span-1680">≤</span><span class="MJXp-mn" id="MJXp-Span-1681">0</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1682">f</span><span class="MJXp-mrow" id="MJXp-Span-1683"><span class="MJXp-mo" id="MJXp-Span-1684" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-mfrac" id="MJXp-Span-1685" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1686">n</span><span class="MJXp-mo" id="MJXp-Span-1687" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-1688" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1689">l</span><span class="MJXp-mo" id="MJXp-Span-1690" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1691">r</span><span class="MJXp-mo" id="MJXp-Span-1692" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1693">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1694" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mfrac" id="MJXp-Span-1695" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696">n</span><span class="MJXp-mo" id="MJXp-Span-1697" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1698" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1699">l</span><span class="MJXp-mo" id="MJXp-Span-1700" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1701">r</span><span class="MJXp-mo" id="MJXp-Span-1702" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1703">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1704" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1705">l</span><span class="MJXp-mo" id="MJXp-Span-1706" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1707">r</span><span class="MJXp-mo" id="MJXp-Span-1708" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">)</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-207">\displaystyle\sum_{-k\le l\le 0}f\left(\frac{n-(l+r)}{2},\frac{n+(l+r)}{2},l,r\right)</script></p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1709"><span class="MJXp-mo" id="MJXp-Span-1710" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mstyle" id="MJXp-Span-1711"><span class="MJXp-munderover" id="MJXp-Span-1712"><span class=""><span class="MJXp-mo" id="MJXp-Span-1713" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1714" style="margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-1715">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1716">k</span><span class="MJXp-mo" id="MJXp-Span-1717">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1718">l</span><span class="MJXp-mo" id="MJXp-Span-1719">≤</span><span class="MJXp-mn" id="MJXp-Span-1720">0</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1721"><span class=""><span class="MJXp-mo" id="MJXp-Span-1722" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1723" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1724">z</span><span class="MJXp-mo" id="MJXp-Span-1725">∈</span><span class="MJXp-mrow" id="MJXp-Span-1726"><span class="MJXp-mi undefined" id="MJXp-Span-1727">Z</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1728"><span class="MJXp-mrow" id="MJXp-Span-1729"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1730"><span class="MJXp-mstyle" id="MJXp-Span-1731"><span class="MJXp-mrow" id="MJXp-Span-1732"><span class="MJXp-mo" id="MJXp-Span-1733" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1734"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1735">n</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1736"><span class="MJXp-mo" id="MJXp-Span-1737" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1738">n</span><span class="MJXp-mo" id="MJXp-Span-1739" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-1740" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1741">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1742">z</span><span class="MJXp-mo" id="MJXp-Span-1743" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1744">1</span><span class="MJXp-mo" id="MJXp-Span-1745" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1746" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1747">k</span><span class="MJXp-mo" id="MJXp-Span-1748" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1749"><span class="MJXp-mo" id="MJXp-Span-1750" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-1751">2</span><span class="MJXp-mo" id="MJXp-Span-1752" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1753">l</span></span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1754"><span class="MJXp-mstyle" id="MJXp-Span-1755"><span class="MJXp-mrow" id="MJXp-Span-1756"><span class="MJXp-mo" id="MJXp-Span-1757" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1758" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-1759"><span class="MJXp-mrow" id="MJXp-Span-1760"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1761"><span class="MJXp-mstyle" id="MJXp-Span-1762"><span class="MJXp-mrow" id="MJXp-Span-1763"><span class="MJXp-mo" id="MJXp-Span-1764" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1765"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1766">n</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1767"><span class="MJXp-mo" id="MJXp-Span-1768" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1769">n</span><span class="MJXp-mo" id="MJXp-Span-1770" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-1771" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1772">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1773">z</span><span class="MJXp-mo" id="MJXp-Span-1774" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1775">1</span><span class="MJXp-mo" id="MJXp-Span-1776" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1777" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1778">k</span><span class="MJXp-mo" id="MJXp-Span-1779" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1780"><span class="MJXp-mo" id="MJXp-Span-1781" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-1782">2</span></span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1783"><span class="MJXp-mstyle" id="MJXp-Span-1784"><span class="MJXp-mrow" id="MJXp-Span-1785"><span class="MJXp-mo" id="MJXp-Span-1786" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-208">=\displaystyle\sum_{-k\le l\le 0}\sum_{z\in\mathbb Z} {n\choose (n-(2z+1)\cdot k) / 2-l}-{n\choose (n-(2z-1)\cdot k) / 2}</script></p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1787"><span class="MJXp-mo" id="MJXp-Span-1788" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mstyle" id="MJXp-Span-1789"><span class="MJXp-munderover" id="MJXp-Span-1790"><span class=""><span class="MJXp-mo" id="MJXp-Span-1791" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1792" style="margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-1793">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1794">k</span><span class="MJXp-mo" id="MJXp-Span-1795">+</span><span class="MJXp-mn" id="MJXp-Span-1796">1</span><span class="MJXp-mo" id="MJXp-Span-1797">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1798">l</span><span class="MJXp-mo" id="MJXp-Span-1799">≤</span><span class="MJXp-mn" id="MJXp-Span-1800">0</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1801"><span class=""><span class="MJXp-mo" id="MJXp-Span-1802" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1803" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1804">z</span><span class="MJXp-mo" id="MJXp-Span-1805">∈</span><span class="MJXp-mrow" id="MJXp-Span-1806"><span class="MJXp-mi undefined" id="MJXp-Span-1807">Z</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1808"><span class="MJXp-mstyle" id="MJXp-Span-1809" style="color: red;"><span class="MJXp-mrow" id="MJXp-Span-1810"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1811"><span class="MJXp-mstyle" id="MJXp-Span-1812"><span class="MJXp-mrow" id="MJXp-Span-1813"><span class="MJXp-mo" id="MJXp-Span-1814" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1815"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1816">n</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1817"><span class="MJXp-mo" id="MJXp-Span-1818" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1819">n</span><span class="MJXp-mo" id="MJXp-Span-1820" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-1821" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1822">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1823">z</span><span class="MJXp-mo" id="MJXp-Span-1824" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-1825">1</span><span class="MJXp-mo" id="MJXp-Span-1826" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1827" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1828">k</span><span class="MJXp-mo" id="MJXp-Span-1829" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1830"><span class="MJXp-mo" id="MJXp-Span-1831" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-1832">2</span><span class="MJXp-mo" id="MJXp-Span-1833" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1834">l</span></span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1835"><span class="MJXp-mstyle" id="MJXp-Span-1836"><span class="MJXp-mrow" id="MJXp-Span-1837"><span class="MJXp-mo" id="MJXp-Span-1838" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1839" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mrow" id="MJXp-Span-1840"><span class="MJXp-mstyle" id="MJXp-Span-1841" style="color: blue;"><span class="MJXp-mrow" id="MJXp-Span-1842"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1843"><span class="MJXp-mstyle" id="MJXp-Span-1844"><span class="MJXp-mrow" id="MJXp-Span-1845"><span class="MJXp-mo" id="MJXp-Span-1846" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1847"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1848">n</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1849"><span class="MJXp-mo" id="MJXp-Span-1850" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1851">n</span><span class="MJXp-mo" id="MJXp-Span-1852" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-1853" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1854">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1855">z</span><span class="MJXp-mo" id="MJXp-Span-1856" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1857">1</span><span class="MJXp-mo" id="MJXp-Span-1858" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1859" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1860">k</span><span class="MJXp-mo" id="MJXp-Span-1861" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1862"><span class="MJXp-mo" id="MJXp-Span-1863" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-1864">2</span></span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1865"><span class="MJXp-mstyle" id="MJXp-Span-1866"><span class="MJXp-mrow" id="MJXp-Span-1867"><span class="MJXp-mo" id="MJXp-Span-1868" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-209">=\displaystyle\sum_{-k+1\le l\le 0}\sum_{z\in\mathbb Z} {\color{red}{n\choose (n-(2z+1)\cdot k) / 2-l}}-{\color{blue}{n\choose (n-(2z-1)\cdot k) / 2}}</script></p><p><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1869"><span class="MJXp-mo" id="MJXp-Span-1870" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1871"><span class="MJXp-msubsup" id="MJXp-Span-1872"><span class="MJXp-mstyle" id="MJXp-Span-1873" style="color: red; margin-right: 0.05em;"><span class="MJXp-mn" id="MJXp-Span-1874">2</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1875" style="vertical-align: 0.5em;"><span class="MJXp-mstyle MJXp-script" id="MJXp-Span-1876" style="color: red;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1877">n</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1878" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mstyle" id="MJXp-Span-1879"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1880">k</span><span class="MJXp-mo" id="MJXp-Span-1881" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mrow" id="MJXp-Span-1882"><span class="MJXp-munderover" id="MJXp-Span-1883"><span class=""><span class="MJXp-mo" id="MJXp-Span-1884" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1885" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1886">z</span><span class="MJXp-mo" id="MJXp-Span-1887">∈</span><span class="MJXp-mrow" id="MJXp-Span-1888"><span class="MJXp-mi undefined" id="MJXp-Span-1889">Z</span></span></span></span></span><span class="MJXp-mstyle" id="MJXp-Span-1890" style="color: blue;"><span class="MJXp-mrow" id="MJXp-Span-1891"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1892"><span class="MJXp-mstyle" id="MJXp-Span-1893"><span class="MJXp-mrow" id="MJXp-Span-1894"><span class="MJXp-mo" id="MJXp-Span-1895" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1896"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1897">n</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1898"><span class="MJXp-mo" id="MJXp-Span-1899" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1900">n</span><span class="MJXp-mo" id="MJXp-Span-1901" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-1902" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1903">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1904">z</span><span class="MJXp-mo" id="MJXp-Span-1905" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1906">1</span><span class="MJXp-mo" id="MJXp-Span-1907" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1908" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1909">k</span><span class="MJXp-mo" id="MJXp-Span-1910" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1911"><span class="MJXp-mo" id="MJXp-Span-1912" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-1913">2</span></span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1914"><span class="MJXp-mstyle" id="MJXp-Span-1915"><span class="MJXp-mrow" id="MJXp-Span-1916"><span class="MJXp-mo" id="MJXp-Span-1917" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-210">={\color{red}2^{\color{red}n}}-\displaystyle k\cdot { \sum_{z\in\mathbb Z}\color{blue}{n\choose (n-(2z-1)\cdot k) / 2}}</script></p><p>We will consider the coefficient of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1918"><span class="MJXp-mrow" id="MJXp-Span-1919"><span class="MJXp-mrow" id="MJXp-Span-1920"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1921"><span class="MJXp-mstyle" id="MJXp-Span-1922"><span class="MJXp-mrow" id="MJXp-Span-1923"><span class="MJXp-mo" id="MJXp-Span-1924" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1925"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1926">n</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1927">m</span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1928"><span class="MJXp-mstyle" id="MJXp-Span-1929"><span class="MJXp-mrow" id="MJXp-Span-1930"><span class="MJXp-mo" id="MJXp-Span-1931" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-211">{n\choose m}</script> in the blue part. Note that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1932"><span class="MJXp-mo" id="MJXp-Span-1933" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1934">n</span><span class="MJXp-mo" id="MJXp-Span-1935" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-1936" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1937">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1938">z</span><span class="MJXp-mo" id="MJXp-Span-1939" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1940">1</span><span class="MJXp-mo" id="MJXp-Span-1941" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1942" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1943">k</span><span class="MJXp-mo" id="MJXp-Span-1944" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1945"><span class="MJXp-mo" id="MJXp-Span-1946" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-1947">2</span><span class="MJXp-mo" id="MJXp-Span-1948" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1949">m</span><span class="MJXp-mo" id="MJXp-Span-1950" style="margin-left: 0.333em; margin-right: 0.333em;">⟺</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1951">k</span><span class="MJXp-mo" id="MJXp-Span-1952" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1953" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1954">n</span><span class="MJXp-mo" id="MJXp-Span-1955" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1956">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1957">m</span><span class="MJXp-mo" id="MJXp-Span-1958" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1959"><span class="MJXp-mo" id="MJXp-Span-1960" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-1961" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1962">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1963">z</span><span class="MJXp-mo" id="MJXp-Span-1964" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-1965">1</span><span class="MJXp-mo" id="MJXp-Span-1966" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-212">(n-(2z-1)\cdot k) / 2 = m\Longleftrightarrow k=(n-2m)/(2z-1)</script>. Define <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1967"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1968">g</span><span class="MJXp-mo" id="MJXp-Span-1969" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1970">n</span><span class="MJXp-mo" id="MJXp-Span-1971" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1972" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1973"><span class="MJXp-mo" id="MJXp-Span-1974" style="margin-left: 0.111em; margin-right: 0.05em;">∑</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1975" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1976">d</span><span class="MJXp-mo" id="MJXp-Span-1977">∣</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1978">n</span><span class="MJXp-mo" id="MJXp-Span-1979">,</span><span class="MJXp-mn" id="MJXp-Span-1980">2</span><span class="MJXp-mo" id="MJXp-Span-1981">∤</span><span class="MJXp-mo" id="MJXp-Span-1982">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1983">n</span><span class="MJXp-mrow" id="MJXp-Span-1984"><span class="MJXp-mo" id="MJXp-Span-1985">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1986">d</span><span class="MJXp-mo" id="MJXp-Span-1987">)</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1988">d</span></span></span><script type="math/tex" id="MathJax-Element-213">g(n)=\sum_{d\mid n,2\nmid(n/d)} d</script>, then the coefficient of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1989"><span class="MJXp-mrow" id="MJXp-Span-1990"><span class="MJXp-mrow" id="MJXp-Span-1991"><span class="MJXp-TeXmathchoice" id="MJXp-Span-1992"><span class="MJXp-mstyle" id="MJXp-Span-1993"><span class="MJXp-mrow" id="MJXp-Span-1994"><span class="MJXp-mo" id="MJXp-Span-1995" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1996"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1997">n</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1998">m</span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-1999"><span class="MJXp-mstyle" id="MJXp-Span-2000"><span class="MJXp-mrow" id="MJXp-Span-2001"><span class="MJXp-mo" id="MJXp-Span-2002" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.083em;"><span class="MJXp-right MJXp-scale10" style="font-size: 1.333em; margin-left: 0.07em;">)</span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-214">{n\choose m}</script> is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2003"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2004">g</span><span class="MJXp-mo" id="MJXp-Span-2005" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2006"><span class="MJXp-mo" id="MJXp-Span-2007" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2008">n</span><span class="MJXp-mo" id="MJXp-Span-2009" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2010">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2011">m</span><span class="MJXp-mrow" id="MJXp-Span-2012"><span class="MJXp-mo" id="MJXp-Span-2013" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2014" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-215">g(|n-2m|)</script>.</p><p>The other 3 parts are similar. </p><p>Summing all, we got the final answer is</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2015"><span class="MJXp-mstyle" id="MJXp-Span-2016"><span class="MJXp-mrow" id="MJXp-Span-2017"><span class="MJXp-mo" id="MJXp-Span-2018" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-2019" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2020">1</span><span class="MJXp-msubsup" id="MJXp-Span-2021"><span class="MJXp-mo" id="MJXp-Span-2022" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2023" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2024">n</span><span class="MJXp-mo" id="MJXp-Span-2025">+</span><span class="MJXp-mn" id="MJXp-Span-2026">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2027" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-msubsup" id="MJXp-Span-2028"><span class="MJXp-mn" id="MJXp-Span-2029" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2030" style="vertical-align: 0.5em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-2031" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2032">2</span><span class="MJXp-munderover" id="MJXp-Span-2033"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2039" style="margin-right: 0px; margin-left: 0px;">n</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-2034" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">∑</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2035" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2036">i</span><span class="MJXp-mo" id="MJXp-Span-2037">=</span><span class="MJXp-mn" id="MJXp-Span-2038">0</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-2040"><span class="MJXp-TeXmathchoice" id="MJXp-Span-2041"><span class="MJXp-mstyle" id="MJXp-Span-2042"><span class="MJXp-mrow" id="MJXp-Span-2043"><span class="MJXp-mo" id="MJXp-Span-2044" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">(</span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2045"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2046">n</span></span><span class="MJXp-box" style="margin-top: -0.7em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2047">i</span></span></span></span></span></span><span class="MJXp-TeXmathchoice" id="MJXp-Span-2048"><span class="MJXp-mstyle" id="MJXp-Span-2049"><span class="MJXp-mrow" id="MJXp-Span-2050"><span class="MJXp-mo" id="MJXp-Span-2051" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.319em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.274em; margin-left: -0.09em;">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2052" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2053">g</span><span class="MJXp-mo" id="MJXp-Span-2054" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2055"><span class="MJXp-mo" id="MJXp-Span-2056" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2057">n</span><span class="MJXp-mo" id="MJXp-Span-2058" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2059">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2060">i</span><span class="MJXp-mo" id="MJXp-Span-2061" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2062">1</span><span class="MJXp-mrow" id="MJXp-Span-2063"><span class="MJXp-mo" id="MJXp-Span-2064" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2065" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2066" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2067">g</span><span class="MJXp-mo" id="MJXp-Span-2068" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2069"><span class="MJXp-mo" id="MJXp-Span-2070" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2071">n</span><span class="MJXp-mo" id="MJXp-Span-2072" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-2073">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2074">i</span><span class="MJXp-mrow" id="MJXp-Span-2075"><span class="MJXp-mo" id="MJXp-Span-2076" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-2077" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2078" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2079" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span><script type="math/tex" id="MathJax-Element-216"> \displaystyle{(-1)^{n+1}\cdot2^n+2\sum^n_{i=0}\binom ni(g(|n-2i-1|)-g(|n-2i|)).} </script></center><p>And we can use linear sieve to precalculate <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2080"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2081">g</span><span class="MJXp-mo" id="MJXp-Span-2082" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2083">n</span><span class="MJXp-mo" id="MJXp-Span-2084" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-217">g(n)</script>. Thus, the whole problem is solved in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2085"><span class="MJXp-mrow" id="MJXp-Span-2086"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2087">O</span></span><span class="MJXp-mo" id="MJXp-Span-2088" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2089">n</span><span class="MJXp-mo" id="MJXp-Span-2090" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-218">\mathcal{O}(n)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (Hard, C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
 
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MAXN </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2e7</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">10</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> mod </span><span class="pun">=</span><span class="pln"> </span><span class="lit">998244353</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> x </span><span class="pun">+=</span><span class="pln"> y</span><span class="pun">,</span><span class="pln"> x </span><span class="pun">&lt;</span><span class="pln"> mod </span><span class="pun">?</span><span class="pln"> x </span><span class="pun">:</span><span class="pln"> x </span><span class="pun">-</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">sub</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> x </span><span class="pun">-=</span><span class="pln"> y</span><span class="pun">,</span><span class="pln"> x </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> x </span><span class="pun">+</span><span class="pln"> mod </span><span class="pun">:</span><span class="pln"> x</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> cadd</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> x </span><span class="pun">+=</span><span class="pln"> y</span><span class="pun">,</span><span class="pln"> x </span><span class="pun">&lt;</span><span class="pln"> mod </span><span class="pun">||</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">-=</span><span class="pln"> mod</span><span class="pun">);</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> csub</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> x </span><span class="pun">-=</span><span class="pln"> y</span><span class="pun">,</span><span class="pln"> x </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">+=</span><span class="pln"> mod</span><span class="pun">);</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">inline</span><span class="pln"> 
</span><span class="kwd">int</span><span class="pln"> qpow</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> b</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(;</span><span class="pln"> p</span><span class="pun">;</span><span class="pln"> b </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll</span><span class="pun">)</span><span class="pln">b </span><span class="pun">*</span><span class="pln"> b </span><span class="pun">%</span><span class="pln"> mod</span><span class="pun">,</span><span class="pln"> p </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll</span><span class="pun">)</span><span class="pln">res </span><span class="pun">*</span><span class="pln"> b </span><span class="pun">%</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> res</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> f</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">],</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">],</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">],</span><span class="pln"> tot</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> fac</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">],</span><span class="pln"> ifac</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">];</span><span class="pln">
 
</span><span class="kwd">inline</span><span class="pln"> 
</span><span class="kwd">void</span><span class="pln"> init</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	f</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">f</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> p</span><span class="pun">[++</span><span class="pln">tot</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> f</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">2</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;=</span><span class="pln"> tot</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> n</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">%</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
				g</span><span class="pun">[</span><span class="pln">i </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
				f</span><span class="pun">[</span><span class="pln">i </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> f</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> g</span><span class="pun">[</span><span class="pln">i </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]];</span><span class="pln">
				</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			f</span><span class="pun">[</span><span class="pln">i </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> f</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">));</span><span class="pln">
			g</span><span class="pun">[</span><span class="pln">i </span><span class="pun">*</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">*</span><span class="pln">fac </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> fac</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll</span><span class="pun">)</span><span class="pln">fac</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">%</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
	ifac</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> qpow</span><span class="pun">(</span><span class="pln">fac</span><span class="pun">[</span><span class="pln">n</span><span class="pun">],</span><span class="pln"> mod </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">--)</span><span class="pln"> ifac</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll</span><span class="pun">)</span><span class="pln">ifac</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">%</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">T</span><span class="pun">),</span><span class="pln"> init</span><span class="pun">(</span><span class="lit">2e7</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln"> T</span><span class="pun">--;</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">),</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			ans </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ans </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll</span><span class="pun">)</span><span class="pln">ifac</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> ifac</span><span class="pun">[</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> mod </span><span class="pun">*</span><span class="pln"> </span><span class="kwd">sub</span><span class="pun">(</span><span class="pln">f</span><span class="pun">[</span><span class="pln">abs</span><span class="pun">(</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)],</span><span class="pln"> f</span><span class="pun">[</span><span class="pln">abs</span><span class="pun">(</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)]))</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		ans </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ll</span><span class="pun">)</span><span class="pln">ans </span><span class="pun">*</span><span class="pln"> fac</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> mod</span><span class="pun">;</span><span class="pln">
		cadd</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">,</span><span class="pln"> ans</span><span class="pun">),</span><span class="pln"> </span><span class="pun">(</span><span class="pln">n </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> cadd </span><span class="pun">:</span><span class="pln"> csub</span><span class="pun">)(</span><span class="pln">ans</span><span class="pun">,</span><span class="pln"> qpow</span><span class="pun">(</span><span class="lit">2</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">));</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln"> ans</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate the Problem! (Easy)</b><div class="spoiler-content" style="display: block;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11671">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="17">17</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11672">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="8">8</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11673">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="5">5</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11674">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="1">1</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11675">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="31">31</span>
            </i>
        </a>
    </span>


</li> </ul></div></div> <div class="spoiler"><b class="spoiler-title">Rate the Problem! (Hard)</b><div class="spoiler-content" style="display: block;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11676">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="17">17</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11677">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="3">3</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11678">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="3">3</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11679">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="2">2</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11680">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="33">33</span>
            </i>
        </a>
    </span>


</li> </ul></div></div><p><a href="https://codeforces.com/contest/2135/problem/F" title="Codeforces Round 1046 (Div. 1)">2135F - To the Infinity</a></p><p>Idea: <a class="rated-user user-red" href="https://codeforces.com/profile/STUDENT0" title="Grandmaster STUDENT0">STUDENT0</a><br>Preparation: <a class="rated-user user-orange" href="https://codeforces.com/profile/Register" title="Master Register">Register</a></p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>How to compare two <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2091"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2092">f</span></span></span><script type="math/tex" id="MathJax-Element-219">f</script> values? Since this function grows extremely fast, try to compare <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2093"><span class="MJXp-mi" id="MJXp-Span-2094">ln</span><span class="MJXp-mo" id="MJXp-Span-2095" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2096">f</span></span></span><script type="math/tex" id="MathJax-Element-220">\ln f</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2097"><span class="MJXp-mi" id="MJXp-Span-2098">ln</span><span class="MJXp-mo" id="MJXp-Span-2099" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi" id="MJXp-Span-2100">ln</span><span class="MJXp-mo" id="MJXp-Span-2101" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2102">f</span></span></span><script type="math/tex" id="MathJax-Element-221">\ln \ln f</script> and so on.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>You only need to compare lexicographical order.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>How to quickly compare lexicographical order? Try using hashing.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 4</b><div class="spoiler-content" style="display: block;"><p>Use a data structure to maintain the hash value for each point.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 5</b><div class="spoiler-content" style="display: block;"><p>Consider performing a topological sort on the tree from the bottom up. Then, when a node needs to be inserted into another tree, its ranking is already determined. A segment tree can be used instead of a balanced tree.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>First, define the concept of a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2103"><span class="MJXp-mrow" id="MJXp-Span-2104"><span class="MJXp-mtext MJXp-bold" id="MJXp-Span-2105">power tower</span></span></span></span><script type="math/tex" id="MathJax-Element-222">\textbf{power tower}</script>. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2106"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2107">X</span></span></span><script type="math/tex" id="MathJax-Element-223">X</script> is a power tower if and only if one of the following holds:</p> <ul>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2109">X</span><span class="MJXp-mo" id="MJXp-Span-2110" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2111">x</span></span></span><script type="math/tex" id="MathJax-Element-224">X = x</script>.</li>   <li><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2112"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2113">X</span><span class="MJXp-mo" id="MJXp-Span-2114" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2115"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2116" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2117" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-2118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2119" style="margin-right: 0.05em;">X</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2120" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-msubsup" id="MJXp-Span-2121"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2122" style="margin-right: 0.05em;">X</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2123" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2124">⋯</span><span class="MJXp-msubsup" id="MJXp-Span-2125"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2126" style="margin-right: 0.05em;">X</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2127" style="vertical-align: -0.4em;">m</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-225">X = x^{X_1X_2\cdots X_m}</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2128"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2129">m</span></span></span><script type="math/tex" id="MathJax-Element-226">m</script> is a constant independent of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2130"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2131">x</span></span></span><script type="math/tex" id="MathJax-Element-227">x</script>, and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2132"><span class="MJXp-msubsup" id="MJXp-Span-2133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2134" style="margin-right: 0.05em;">X</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2135" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2136" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2138" style="margin-right: 0.05em;">X</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2139" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2140" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2141" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-2142" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2143"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2144" style="margin-right: 0.05em;">X</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2145" style="vertical-align: -0.4em;">m</span></span></span></span><script type="math/tex" id="MathJax-Element-228">X_1, X_2, \cdots, X_m</script> are all power towers.</li> </ul><p>Clearly, for power towers <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2147">X</span></span></span><script type="math/tex" id="MathJax-Element-229">X</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2148"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2149">Y</span></span></span><script type="math/tex" id="MathJax-Element-230">Y</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2150"><span class="MJXp-msubsup" id="MJXp-Span-2151"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2152" style="margin-right: 0.05em;">X</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2153" style="vertical-align: 0.5em;">Y</span></span></span></span><script type="math/tex" id="MathJax-Element-231">X^Y</script> is also a power tower. Therefore, in this problem, any <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2154"><span class="MJXp-msubsup" id="MJXp-Span-2155"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2156" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2157" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-2158" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2159">x</span><span class="MJXp-mo" id="MJXp-Span-2160" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-232">f_u(x)</script> is a power tower.</p><p>First, consider how to compare two power towers <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2162">X</span></span></span><script type="math/tex" id="MathJax-Element-233">X</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2163"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2164">Y</span></span></span><script type="math/tex" id="MathJax-Element-234">Y</script>. The steps are as follows:</p> <ul>   <li>If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2165"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2166">X</span><span class="MJXp-mo" id="MJXp-Span-2167" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2168">x</span></span></span><script type="math/tex" id="MathJax-Element-235">X = x</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2169"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2170">Y</span><span class="MJXp-mo" id="MJXp-Span-2171" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2172">x</span></span></span><script type="math/tex" id="MathJax-Element-236">Y = x</script>, directly return their magnitudes.</li>   <li>Otherwise, let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2173"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2174">X</span><span class="MJXp-mo" id="MJXp-Span-2175" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2176"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2177" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2178" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-2179"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2180" style="margin-right: 0.05em;">X</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2181" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-msubsup" id="MJXp-Span-2182"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2183" style="margin-right: 0.05em;">X</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2184" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2185">⋯</span><span class="MJXp-msubsup" id="MJXp-Span-2186"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2187" style="margin-right: 0.05em;">X</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2188" style="vertical-align: -0.4em;">p</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-237">X = x^{X_1X_2\cdots X_p}</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2189"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2190">Y</span><span class="MJXp-mo" id="MJXp-Span-2191" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2192"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2193" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2194" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-2195"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2196" style="margin-right: 0.05em;">Y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2197" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-msubsup" id="MJXp-Span-2198"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2199" style="margin-right: 0.05em;">Y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2200" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2201">⋯</span><span class="MJXp-msubsup" id="MJXp-Span-2202"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2203" style="margin-right: 0.05em;">Y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2204" style="vertical-align: -0.4em;">q</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-238">Y = x^{Y_1Y_2\cdots Y_q}</script>, where the quantities in the exponents are power towers.   <ul>     <li>Sort <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2205"><span class="MJXp-msubsup" id="MJXp-Span-2206"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2207" style="margin-right: 0.05em;">X</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2208" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2209" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2210"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2211" style="margin-right: 0.05em;">X</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2212" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2213" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2214" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-2215" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2216"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2217" style="margin-right: 0.05em;">X</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2218" style="vertical-align: -0.4em;">p</span></span></span></span><script type="math/tex" id="MathJax-Element-239">X_1, X_2, \cdots, X_p</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2219"><span class="MJXp-msubsup" id="MJXp-Span-2220"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2221" style="margin-right: 0.05em;">Y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2222" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2223" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2224"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2225" style="margin-right: 0.05em;">Y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2226" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2227" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2228" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-2229" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2231" style="margin-right: 0.05em;">Y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2232" style="vertical-align: -0.4em;">q</span></span></span></span><script type="math/tex" id="MathJax-Element-240">Y_1, Y_2, \cdots, Y_q</script> in descending order.</li>     <li>Compare their lexicographical order. If the lexicographical orders are equal, return that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2233"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2234">X</span></span></span><script type="math/tex" id="MathJax-Element-241">X</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2235"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2236">Y</span></span></span><script type="math/tex" id="MathJax-Element-242">Y</script> are equal; otherwise, return that the power tower with the larger lexicographical order is greater than the one with the smaller lexicographical order.</li>   </ul></li> </ul><p>This gives a solution that can determine the relative sizes of two power towers in polynomial complexity. However, this is far from sufficient.</p><p>To optimize the complexity, when comparing <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2237"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2238">X</span></span></span><script type="math/tex" id="MathJax-Element-243">X</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2239"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2240">Y</span></span></span><script type="math/tex" id="MathJax-Element-244">Y</script>, we at least need to know the sorted order of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2241"><span class="MJXp-msubsup" id="MJXp-Span-2242"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2243" style="margin-right: 0.05em;">X</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2244" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2245" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2246"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2247" style="margin-right: 0.05em;">X</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2248" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2249" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2250" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-2251" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2252"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2253" style="margin-right: 0.05em;">X</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2254" style="vertical-align: -0.4em;">p</span></span></span></span><script type="math/tex" id="MathJax-Element-245">X_1, X_2, \cdots, X_p</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2255"><span class="MJXp-msubsup" id="MJXp-Span-2256"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2257" style="margin-right: 0.05em;">Y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2258" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2259" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2260"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2261" style="margin-right: 0.05em;">Y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2262" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2263" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2264" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-2265" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2266"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2267" style="margin-right: 0.05em;">Y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2268" style="vertical-align: -0.4em;">q</span></span></span></span><script type="math/tex" id="MathJax-Element-246">Y_1, Y_2, \cdots, Y_q</script>. This is equivalent to knowing the size relationships among them.</p><p>A key property of the tree can be easily observed: Let <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2270">f</span><span class="MJXp-msubsup" id="MJXp-Span-2271"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2272" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2273" style="vertical-align: -0.4em;">u</span></span></span></span><script type="math/tex" id="MathJax-Element-247">fa_u</script> be the father of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2274"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2275">u</span></span></span><script type="math/tex" id="MathJax-Element-248">u</script> in the tree. Then, it must hold that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2276"><span class="MJXp-msubsup" id="MJXp-Span-2277"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2278" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2279" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-2280" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2281">x</span><span class="MJXp-mo" id="MJXp-Span-2282" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2283" style="margin-left: 0.333em; margin-right: 0.333em;">≺</span><span class="MJXp-msubsup" id="MJXp-Span-2284"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2285" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2286" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2287">f</span><span class="MJXp-msubsup" id="MJXp-Span-2288"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2289" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2290" style="vertical-align: -0.4em;">u</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2291" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2292">x</span><span class="MJXp-mo" id="MJXp-Span-2293" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-249">f_u(x) \prec f_{fa_u}(x)</script>. Consider performing a topological sort on the original tree and using a heap to maintain the current queue. Each time, the smallest node is taken out to update the others. For any node <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2294"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2295">u</span></span></span><script type="math/tex" id="MathJax-Element-250">u</script> in the queue, the corresponding power tower <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2296"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2297">X</span><span class="MJXp-mo" id="MJXp-Span-2298" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2300" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2301" style="vertical-align: -0.4em;">u</span></span><span class="MJXp-mo" id="MJXp-Span-2302" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2303">x</span><span class="MJXp-mo" id="MJXp-Span-2304" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-251">X = f_u(x)</script> already has known rankings for <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2305"><span class="MJXp-msubsup" id="MJXp-Span-2306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2307" style="margin-right: 0.05em;">X</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2308" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2309" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2310"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2311" style="margin-right: 0.05em;">X</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2312" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2313" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2314" style="margin-left: 0em; margin-right: 0em;">⋯</span><span class="MJXp-mo" id="MJXp-Span-2315" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2317" style="margin-right: 0.05em;">X</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-2318" style="vertical-align: -0.4em;">p</span></span></span></span><script type="math/tex" id="MathJax-Element-252">X_1, X_2, \cdots, X_p</script>. A persistent segment tree can then be used to maintain prefix-sum hashes. When comparing two power towers, binary search can be performed on the segment tree to quickly find the first position where their exponent power towers differ, achieving a fast comparison in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2319"><span class="MJXp-mrow" id="MJXp-Span-2320"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2321">O</span></span><span class="MJXp-mo" id="MJXp-Span-2322" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi" id="MJXp-Span-2323">log</span><span class="MJXp-mo" id="MJXp-Span-2324" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2325">n</span><span class="MJXp-mo" id="MJXp-Span-2326" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-253">\mathcal{O}(\log n)</script> time per operation. </p><p>Time complexity: <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2327"><span class="MJXp-mrow" id="MJXp-Span-2328"><span class="MJXp-mi MJXp-cal" id="MJXp-Span-2329">O</span></span><span class="MJXp-mo" id="MJXp-Span-2330" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2331">n</span><span class="MJXp-msubsup" id="MJXp-Span-2332"><span class="MJXp-mi" id="MJXp-Span-2333" style="margin-right: 0.05em;">log</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2334" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-2335" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2336">n</span><span class="MJXp-mo" id="MJXp-Span-2337" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-254">\mathcal{O}(n\log^2 n)</script> per test case.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
 
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ull</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MAXN </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4e5</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">10</span><span class="pun">;</span><span class="pln">
 
ull A </span><span class="pun">=</span><span class="pln"> mt19937_64</span><span class="pun">(</span><span class="pln">time</span><span class="pun">(</span><span class="lit">0</span><span class="pun">))();</span><span class="pln">
 
</span><span class="kwd">inline</span><span class="pln"> ull shift</span><span class="pun">(</span><span class="pln">ull x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> x </span><span class="pun">^=</span><span class="pln"> A</span><span class="pun">,</span><span class="pln"> x </span><span class="pun">^=</span><span class="pln"> x </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">13</span><span class="pun">,</span><span class="pln"> x </span><span class="pun">^=</span><span class="pln"> x </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">7</span><span class="pun">,</span><span class="pln"> x </span><span class="pun">^=</span><span class="pln"> x </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">11</span><span class="pun">,</span><span class="pln"> x </span><span class="pun">^=</span><span class="pln"> A</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">struct</span><span class="pln"> node </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> num</span><span class="pun">;</span><span class="pln"> ull val</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">MAXN </span><span class="pun">*</span><span class="pln"> </span><span class="lit">20</span><span class="pun">];</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> cnt</span><span class="pun">,</span><span class="pln"> rt</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">];</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">p</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> pre</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">,</span><span class="pln"> ull x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	t</span><span class="pun">[</span><span class="pln">p </span><span class="pun">=</span><span class="pln"> </span><span class="pun">++</span><span class="pln">cnt</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">pre</span><span class="pun">],</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">].</span><span class="pln">val </span><span class="pun">+=</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">].</span><span class="pln">num</span><span class="pun">++;</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">==</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> mid </span><span class="pun">=</span><span class="pln"> l </span><span class="pun">+</span><span class="pln"> r </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">&lt;=</span><span class="pln"> mid</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">].</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">pre</span><span class="pun">].</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> mid</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">add</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">].</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">pre</span><span class="pun">].</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> mid </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">,</span><span class="pln"> x</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">bool</span><span class="pln"> find</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> pre</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l </span><span class="pun">==</span><span class="pln"> r</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">].</span><span class="pln">num </span><span class="pun">&gt;</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">pre</span><span class="pun">].</span><span class="pln">num</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> mid </span><span class="pun">=</span><span class="pln"> l </span><span class="pun">+</span><span class="pln"> r </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">].</span><span class="pln">r</span><span class="pun">].</span><span class="pln">val </span><span class="pun">==</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">t</span><span class="pun">[</span><span class="pln">pre</span><span class="pun">].</span><span class="pln">r</span><span class="pun">].</span><span class="pln">val</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> find</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">].</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">pre</span><span class="pun">].</span><span class="pln">l</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">,</span><span class="pln"> mid</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> find</span><span class="pun">(</span><span class="pln">t</span><span class="pun">[</span><span class="pln">p</span><span class="pun">].</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">[</span><span class="pln">pre</span><span class="pun">].</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> mid </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> l</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">],</span><span class="pln"> r</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">],</span><span class="pln"> fa</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">],</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">];</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> rk</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">],</span><span class="pln"> tot</span><span class="pun">,</span><span class="pln"> lst</span><span class="pun">;</span><span class="pln"> ull h</span><span class="pun">[</span><span class="pln">MAXN</span><span class="pun">];</span><span class="pln">
 
</span><span class="kwd">struct</span><span class="pln"> cmp </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">bool</span><span class="pln"> </span><span class="kwd">operator</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> h</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> h</span><span class="pun">[</span><span class="pln">y</span><span class="pun">]</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> x </span><span class="pun">&gt;</span><span class="pln"> y </span><span class="pun">:</span><span class="pln"> find</span><span class="pun">(</span><span class="pln">rt</span><span class="pun">[</span><span class="pln">x</span><span class="pun">],</span><span class="pln"> rt</span><span class="pun">[</span><span class="pln">y</span><span class="pun">],</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">};</span><span class="pln"> priority_queue</span><span class="pun">&lt;</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> vector</span><span class="str">&lt;int&gt;</span><span class="pun">,</span><span class="pln"> cmp</span><span class="pun">&gt;</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
 
 
</span><span class="kwd">inline</span><span class="pln"> 
</span><span class="kwd">void</span><span class="pln"> upd</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	h</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> h</span><span class="pun">[</span><span class="pln">l</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> shift</span><span class="pun">(</span><span class="pln">h</span><span class="pun">[</span><span class="pln">r</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]]);</span><span class="pln">
	</span><span class="kwd">add</span><span class="pun">(</span><span class="pln">rt</span><span class="pun">[</span><span class="pln">u</span><span class="pun">],</span><span class="pln"> rt</span><span class="pun">[</span><span class="pln">l</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]],</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> rk</span><span class="pun">[</span><span class="pln">r</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]],</span><span class="pln"> shift</span><span class="pun">(</span><span class="pln">h</span><span class="pun">[</span><span class="pln">r</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]]));</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">T</span><span class="pun">);</span><span class="pln"> T</span><span class="pun">--;</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">),</span><span class="pln"> cnt </span><span class="pun">=</span><span class="pln"> lst </span><span class="pun">=</span><span class="pln"> tot </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> rt</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> 
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			scanf</span><span class="pun">(</span><span class="str">"%d%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">l</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">r</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
			d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">l</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> r</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">),</span><span class="pln"> fa</span><span class="pun">[</span><span class="pln">l</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> fa</span><span class="pun">[</span><span class="pln">r</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> h</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> q</span><span class="pun">.</span><span class="pln">emplace</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> u</span><span class="pun">;</span><span class="pln"> </span><span class="pun">!</span><span class="pln">q</span><span class="pun">.</span><span class="pln">empty</span><span class="pun">();</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			printf</span><span class="pun">(</span><span class="str">"%d "</span><span class="pun">,</span><span class="pln"> u </span><span class="pun">=</span><span class="pln"> q</span><span class="pun">.</span><span class="pln">top</span><span class="pun">()),</span><span class="pln"> q</span><span class="pun">.</span><span class="pln">pop</span><span class="pun">();</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">h</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> h</span><span class="pun">[</span><span class="pln">lst</span><span class="pun">])</span><span class="pln"> tot</span><span class="pun">++;</span><span class="pln"> lst </span><span class="pun">=</span><span class="pln"> u</span><span class="pun">,</span><span class="pln"> rk</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tot</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!--</span><span class="pln">d</span><span class="pun">[</span><span class="pln">fa</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]])</span><span class="pln"> upd</span><span class="pun">(</span><span class="pln">fa</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]),</span><span class="pln"> q</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">fa</span><span class="pun">[</span><span class="pln">u</span><span class="pun">]);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		puts</span><span class="pun">(</span><span class="str">""</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Rate the Problem!</b><div class="spoiler-content" style="display: block;"><ul>   <li>Amazing problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11681">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="34">34</span>
            </i>
        </a>
    </span>


</li>   <li>Good problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11682">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="0">0</span>
            </i>
        </a>
    </span>


</li>   <li>Average problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11683">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="3">3</span>
            </i>
        </a>
    </span>


</li>   <li>Bad problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11684">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="1">1</span>
            </i>
        </a>
    </span>


</li>   <li>Horrible problem: 

    <span class="likeForm ">
        <a class="likeActionLink" title="I like this" href="https://codeforces.com/data/like?action=like" data-likeableid="11685">
            <i class="likeState icon-thumbs-up">
                <span class="likeCount" data-value="6">6</span>
            </i>
        </a>
    </span>


</li> </ul></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2135" class="notice" style="text-decoration: none;">Codeforces Round 1046 (Div. 1)</a> </span>
        </div>
        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2136" class="notice" style="text-decoration: none;">Codeforces Round 1046 (Div. 2)</a> </span>
        </div>
        
            

  <script>
    // Make all spoilers toggleable
    document.querySelectorAll('.spoiler-title').forEach(title => {
      title.addEventListener('click', function() {
        const spoiler = this.closest('.spoiler');
        spoiler.classList.toggle('open');
      });
    });
    
    // Open all spoilers by default for easier reading
    document.querySelectorAll('.spoiler').forEach(spoiler => {
      spoiler.classList.add('open');
    });
  </script>
</body>
</html>