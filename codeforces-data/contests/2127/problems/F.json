{
  "contestId": 2127,
  "index": "F",
  "title": "Hamed and AghaBalaSar",
  "timeLimit": "2 seconds",
  "memoryLimit": "512 megabytes",
  "rating": 2800,
  "tags": [
    "brute force",
    "combinatorics",
    "dp",
    "math",
    "probabilities"
  ],
  "statementHtml": "<p> </p>\n<p><span class=\"tex-font-style-it\">Hamid wrote <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1\"><span class=\"MJXp-mn\" id=\"MJXp-Span-2\">3014</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-1-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-1\">3014</script> lines of code for the a+b problem and gave <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3\"><span class=\"MJXp-mn\" id=\"MJXp-Span-4\">10</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-2-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-2\">10</script> lines of it to Hamed; then the following problem came to Hamed's mind.</span></p>\n<p>You are given two integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-5\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-6\">n</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-3-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-3\">n</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-7\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-8\">m</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-4-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-4\">m</script>.</p>\n<p>An array <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-9\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-10\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-11\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-12\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-13\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-14\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-15\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-16\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-17\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mo\" id=\"MJXp-Span-18\" style=\"margin-left: 0em; margin-right: 0em;\">…</span><span class=\"MJXp-mo\" id=\"MJXp-Span-19\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-20\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-21\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-22\" style=\"vertical-align: -0.4em;\">n</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-5-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-5\">a_1,a_2,\\ldots,a_n</script> is called <span class=\"tex-font-style-it\">snake</span> if and only if all of the following conditions hold: </p>\n<p>We define <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-75\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-76\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-77\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-78\">a</span><span class=\"MJXp-mo\" id=\"MJXp-Span-79\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-11-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-11\">f(a)</script> as in the following pseudocode:</p>\n<p>Find the sum of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-80\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-81\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-82\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-83\">a</span><span class=\"MJXp-mo\" id=\"MJXp-Span-84\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-12-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-12\">f(a)</script> over all <span class=\"tex-font-style-it\">snake</span> arrays <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-85\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-86\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-87\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-88\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-89\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-90\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-91\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-92\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-93\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mo\" id=\"MJXp-Span-94\" style=\"margin-left: 0em; margin-right: 0em;\">…</span><span class=\"MJXp-mo\" id=\"MJXp-Span-95\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-96\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-97\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-98\" style=\"vertical-align: -0.4em;\">n</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-13\">a_1,a_2,\\ldots,a_n</script>, modulo <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-99\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-100\"><span class=\"MJXp-mn\" id=\"MJXp-Span-101\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-102\" style=\"vertical-align: 0.5em;\">9</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-103\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-104\">7</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-14-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-14\">10^9+7</script>.</p>",
  "inputSpecHtml": "<p>Each test contains multiple test cases. The first line contains the number of test cases <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-105\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-106\">t</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-15-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-15\">t</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-107\"><span class=\"MJXp-mn\" id=\"MJXp-Span-108\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-109\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-110\">t</span><span class=\"MJXp-mo\" id=\"MJXp-Span-111\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-112\"><span class=\"MJXp-mn\" id=\"MJXp-Span-113\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-114\" style=\"vertical-align: 0.5em;\">4</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-16\">1 \\le t \\le 10^4</script>). The description of the test cases follows. </p><p>The first line of each test case contains two integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-115\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-116\">n</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-17\">n</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-117\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-118\">m</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-18\">m</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-119\"><span class=\"MJXp-mn\" id=\"MJXp-Span-120\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-121\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-122\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-123\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mn\" id=\"MJXp-Span-124\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-125\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⋅</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-126\"><span class=\"MJXp-mn\" id=\"MJXp-Span-127\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-128\" style=\"vertical-align: 0.5em;\">5</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-19\">2 \\leq n \\leq 2 \\cdot 10^5</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-129\"><span class=\"MJXp-mn\" id=\"MJXp-Span-130\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-131\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-132\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-133\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mn\" id=\"MJXp-Span-134\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-135\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⋅</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-136\"><span class=\"MJXp-mn\" id=\"MJXp-Span-137\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-138\" style=\"vertical-align: 0.5em;\">5</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-20\">0 \\leq m \\leq 2 \\cdot 10^5</script>) — the length of a <span class=\"tex-font-style-it\">snake</span> array and the sum of all elements in a <span class=\"tex-font-style-it\">snake</span> array.</p><p>It is guaranteed that the sum of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-139\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-140\">m</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-21\">m</script> over all test cases does not exceed <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-141\"><span class=\"MJXp-mn\" id=\"MJXp-Span-142\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-143\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⋅</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-144\"><span class=\"MJXp-mn\" id=\"MJXp-Span-145\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-146\" style=\"vertical-align: 0.5em;\">5</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-22\">2 \\cdot 10^5</script>. </p>",
  "outputSpecHtml": "<p>For each test case, output a single integer — the sum of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-147\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-148\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-149\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-150\">a</span><span class=\"MJXp-mo\" id=\"MJXp-Span-151\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-23-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-23\">f(a)</script> over all <span class=\"tex-font-style-it\">snake</span> arrays <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-152\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-153\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-154\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-155\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-156\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-157\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-158\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-159\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-160\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mo\" id=\"MJXp-Span-161\" style=\"margin-left: 0em; margin-right: 0em;\">…</span><span class=\"MJXp-mo\" id=\"MJXp-Span-162\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-163\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-164\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-165\" style=\"vertical-align: -0.4em;\">n</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-24-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-24\">a_1,a_2,\\ldots,a_n</script>, modulo <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-166\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-167\"><span class=\"MJXp-mn\" id=\"MJXp-Span-168\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-169\" style=\"vertical-align: 0.5em;\">9</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-170\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-171\">7</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-25-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-25\">10^9+7</script>.</p>",
  "noteHtml": "<p>In the first test case, there are three <span class=\"tex-font-style-it\">snake</span> arrays:</p><ul> <li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-172\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-173\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-174\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mo\" id=\"MJXp-Span-175\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-176\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-177\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-178\">5</span><span class=\"MJXp-mo\" id=\"MJXp-Span-179\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-180\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-181\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-182\">5</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-26-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-26\">f([0, 5]) = 5</script>; </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-183\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-184\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-185\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mo\" id=\"MJXp-Span-186\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-187\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-188\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-189\">4</span><span class=\"MJXp-mo\" id=\"MJXp-Span-190\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-191\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-192\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-193\">3</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-27-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-27\">f([1, 4]) = 3</script>; </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-194\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-195\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-196\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mo\" id=\"MJXp-Span-197\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-198\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-199\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-200\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-201\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-202\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-203\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-204\">1</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-28\">f([2, 3]) = 1</script>. </li></ul><p>Thus, the answer is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-205\"><span class=\"MJXp-mn\" id=\"MJXp-Span-206\">5</span><span class=\"MJXp-mo\" id=\"MJXp-Span-207\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-208\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-209\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-210\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-211\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-212\">9</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-29-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-29\">5+3+1=9</script>.</p><p>In the second test case, there are six <span class=\"tex-font-style-it\">snake</span> arrays:</p><ul> <li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-213\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-214\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-215\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mo\" id=\"MJXp-Span-216\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-217\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-218\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-219\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-220\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-221\">4</span><span class=\"MJXp-mo\" id=\"MJXp-Span-222\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-223\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-224\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-225\">4</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-30-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-30\">f([0, 0, 4]) = 4</script>; </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-226\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-227\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-228\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mo\" id=\"MJXp-Span-229\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-230\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-231\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-232\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-233\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-234\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-235\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-236\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-237\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-238\">3</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-31-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-31\">f([0, 1, 3]) = 3</script>; </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-239\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-240\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-241\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mo\" id=\"MJXp-Span-242\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-243\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-244\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-245\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-246\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-247\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-248\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-249\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-250\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-251\">2</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-32-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-32\">f([1, 0, 3]) = 2</script>; </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-252\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-253\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-254\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mo\" id=\"MJXp-Span-255\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-256\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-257\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-258\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-259\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-260\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-261\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-262\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-263\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-264\">1</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-33-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-33\">f([1, 1, 2]) = 1</script>; </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-265\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-266\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-267\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mo\" id=\"MJXp-Span-268\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-269\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-270\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-271\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-272\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-273\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-274\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-275\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-276\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-277\">2</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-34-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-34\">f([0, 2, 2]) = 2</script>; </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-278\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-279\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-280\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mo\" id=\"MJXp-Span-281\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-282\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-283\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-284\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-285\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-286\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-287\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-288\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-289\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-290\">2</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-35-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-35\">f([2, 0, 2]) = 2</script>. </li></ul><p>Thus, the answer is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-291\"><span class=\"MJXp-mn\" id=\"MJXp-Span-292\">4</span><span class=\"MJXp-mo\" id=\"MJXp-Span-293\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-294\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-295\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-296\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-297\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-298\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-299\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-300\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-301\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-302\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-303\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-304\">14</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-36-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-36\">4+3+2+1+2+2=14</script>.</p><p>In the fifth test case, a possible <span class=\"tex-font-style-it\">snake</span> array is:</p><ul> <li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-305\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-306\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-307\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mo\" id=\"MJXp-Span-308\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-309\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-310\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-311\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-312\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-313\">4</span><span class=\"MJXp-mo\" id=\"MJXp-Span-314\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-315\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-316\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-317\">5</span><span class=\"MJXp-mo\" id=\"MJXp-Span-318\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-319\">9</span><span class=\"MJXp-mo\" id=\"MJXp-Span-320\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-321\" style=\"margin-left: 0em; margin-right: 0em;\">)</span><span class=\"MJXp-mo\" id=\"MJXp-Span-322\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-323\">6</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-37-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-37\">f([3, 1, 4, 1, 5, 9]) = 6</script>. </li></ul>",
  "samples": [
    {
      "input": "82 53 44 65 106 23100 100142857 33333200000 0",
      "output": "9\n14\n76\n985\n142112\n771227753\n865580631\n0"
    }
  ],
  "images": [],
  "url": "https://codeforces.com/contest/2127/problem/F"
}