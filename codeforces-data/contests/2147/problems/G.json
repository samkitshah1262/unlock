{
  "contestId": 2147,
  "index": "G",
  "title": "Modular Tetration",
  "timeLimit": "2 seconds",
  "memoryLimit": "256 megabytes",
  "rating": 3100,
  "tags": [
    "combinatorics",
    "math",
    "number theory"
  ],
  "statementHtml": "<p> </p>\n<p>For a positive integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2\">a</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-1-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-1\">a</script>, we define a recurrence <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3\"><span class=\"MJXp-mo\" id=\"MJXp-Span-4\" style=\"margin-left: 0em; margin-right: 0em;\">{</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-5\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-6\" style=\"margin-right: 0.05em;\">b</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-7\" style=\"vertical-align: -0.4em;\">n</span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-8\"><span class=\"MJXp-mo\" id=\"MJXp-Span-9\" style=\"margin-left: 0em; margin-right: 0.05em;\">}</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-10\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-11\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-12\">≥</span><span class=\"MJXp-mn\" id=\"MJXp-Span-13\">0</span></span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-2-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-2\">\\{b_n\\}_{n\\geq 0}</script> as <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-14\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-15\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-16\" style=\"margin-right: 0.05em;\">b</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-17\" style=\"vertical-align: -0.4em;\">n</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-18\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-19\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-20\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-21\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-22\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-23\" style=\"margin-right: 0.05em;\">b</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-24\" style=\"vertical-align: -0.4em;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-25\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-26\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-27\">1</span></span></span></span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-3-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-3\">b_n = a^{b_{n-1}}</script>, with <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-28\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-29\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-30\" style=\"margin-right: 0.05em;\">b</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-31\" style=\"vertical-align: -0.4em;\">0</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-32\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-33\">1</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-4-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-4\">b_0 = 1</script>.</p>\n<p>We say that a positive integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-34\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-35\">a</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-5-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-5\">a</script> is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-36\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-37\">m</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-6-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-6\">m</script>-<span class=\"tex-font-style-it\">tetrative</span> if the sequence <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-38\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-39\">b</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-7-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-7\">b</script> stabilizes to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-40\"><span class=\"MJXp-mn\" id=\"MJXp-Span-41\">1</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-8-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-8\">1</script> modulo <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-42\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-43\">m</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-9\">m</script>, that is, there exists <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-44\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-45\">N</span><span class=\"MJXp-mo\" id=\"MJXp-Span-46\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≥</span><span class=\"MJXp-mn\" id=\"MJXp-Span-47\">0</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-10-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-10\">N \\ge 0</script> such that <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-48\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-49\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-50\" style=\"margin-right: 0.05em;\">b</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-51\" style=\"vertical-align: -0.4em;\">n</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-52\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≡</span><span class=\"MJXp-mn\" id=\"MJXp-Span-53\">1</span><span class=\"MJXp-TeXmathchoice\" id=\"MJXp-Span-54\"><span class=\"MJXp-mspace\" id=\"MJXp-Span-55\" style=\"width: 0.444em; height: 0em;\"></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-56\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi\" id=\"MJXp-Span-57\">mod</span><span class=\"MJXp-mspace\" id=\"MJXp-Span-58\" style=\"width: 0.333em; height: 0em;\"></span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-59\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-60\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-11-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-11\">b_n \\equiv 1 \\pmod m</script> for all <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-61\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-62\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-63\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≥</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-64\">N</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-12-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-12\">n \\geq N</script>.</p>\n<p>For a given <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-65\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-66\">m</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-13\">m</script>, calculate the density of the <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-67\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-68\">m</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-14-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-14\">m</script>-<span class=\"tex-font-style-it\">tetrative</span> integers. Here, the density of a set <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-69\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-70\">S</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-15-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-15\">S</script> is the limit <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math MJXp-display\" id=\"MJXp-Span-74\"><span class=\"MJXp-munderover\" id=\"MJXp-Span-75\"><span class=\"\"><span class=\"MJXp-mo\" id=\"MJXp-Span-76\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">lim</span></span><span class=\" MJXp-script\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-77\" style=\"margin-left: 0px;\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-78\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-79\">→</span><span class=\"MJXp-mi\" id=\"MJXp-Span-80\">∞</span></span></span></span><span class=\"MJXp-mfrac\" id=\"MJXp-Span-81\" style=\"vertical-align: 0.25em;\"><span class=\"MJXp-box\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-82\"><span class=\"MJXp-mo\" id=\"MJXp-Span-83\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-84\">S</span><span class=\"MJXp-mo\" id=\"MJXp-Span-85\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">∩</span><span class=\"MJXp-mo\" id=\"MJXp-Span-86\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-87\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-88\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-89\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-90\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mo\" id=\"MJXp-Span-91\" style=\"margin-left: 0em; margin-right: 0em;\">…</span><span class=\"MJXp-mo\" id=\"MJXp-Span-92\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-93\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-94\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mrow\" id=\"MJXp-Span-95\"><span class=\"MJXp-mo\" id=\"MJXp-Span-96\" style=\"margin-left: 0.167em; margin-right: 0.167em;\">|</span></span></span><span class=\"MJXp-box\" style=\"margin-top: -0.9em;\"><span class=\"MJXp-denom\"><span><span class=\"MJXp-rule\" style=\"height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;\"></span></span><span><span class=\"MJXp-box\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-97\">n</span></span></span></span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-98\" style=\"margin-left: 0em; margin-right: 0.222em;\">.</span></span></span><div class=\"MathJax_Display MathJax_Processing\"><span class=\"MathJax\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\"></span></div><script type=\"math/tex; mode=display\" id=\"MathJax-Element-16\">\\lim\\limits_{n\\rightarrow \\infty}\\frac{|S\\cap [1,2,\\ldots,n]|}{n}.</script> Informally, it is the \"proportion\" of positive integers that are <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-99\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-100\">m</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-17\">m</script>-<span class=\"tex-font-style-it\">tetrative</span>.</p>\n<p>It can be proven (under the constraints of this problem) that the density is well-defined and is always a rational number, whose denominator is not divisible by <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-101\"><span class=\"MJXp-mn\" id=\"MJXp-Span-102\">998</span><span class=\"MJXp-mspace\" id=\"MJXp-Span-103\" style=\"width: 0.167em; height: 0em;\"></span><span class=\"MJXp-mn\" id=\"MJXp-Span-104\">244</span><span class=\"MJXp-mspace\" id=\"MJXp-Span-105\" style=\"width: 0.167em; height: 0em;\"></span><span class=\"MJXp-mn\" id=\"MJXp-Span-106\">353</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-18\">998\\,244\\,353</script>.</p>",
  "inputSpecHtml": "<p>Each test contains multiple test cases. The first line contains the number of test cases <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-107\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-108\">t</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-19\">t</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-109\"><span class=\"MJXp-mn\" id=\"MJXp-Span-110\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-111\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-112\">t</span><span class=\"MJXp-mo\" id=\"MJXp-Span-113\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-114\"><span class=\"MJXp-mn\" id=\"MJXp-Span-115\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-116\" style=\"vertical-align: 0.5em;\">4</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-20\">1 \\le t \\le 10^4</script>). The description of the test cases follows. </p><p>The number <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-117\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-118\">m</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-21\">m</script> will be given to you as a product of three integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-119\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-120\">x</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-22\">x</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-121\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-122\">y</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-23-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-23\">y</script>, and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-123\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-124\">z</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-24-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-24\">z</script>. The first and only line of each test case contains three integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-125\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-126\">x</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-25-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-25\">x</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-127\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-128\">y</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-26-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-26\">y</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-129\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-130\">z</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-27-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-27\">z</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-131\"><span class=\"MJXp-mn\" id=\"MJXp-Span-132\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-133\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-134\">x</span><span class=\"MJXp-mo\" id=\"MJXp-Span-135\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-136\">y</span><span class=\"MJXp-mo\" id=\"MJXp-Span-137\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-138\">z</span><span class=\"MJXp-mo\" id=\"MJXp-Span-139\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-140\"><span class=\"MJXp-mn\" id=\"MJXp-Span-141\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-142\" style=\"vertical-align: 0.5em;\">6</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-28\">1\\leq x,y,z \\leq 10^6</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-143\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-144\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-145\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-146\">x</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-147\">y</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-148\">z</span><span class=\"MJXp-mo\" id=\"MJXp-Span-149\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≥</span><span class=\"MJXp-mn\" id=\"MJXp-Span-150\">2</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-29-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-29\">m = xyz \\geq 2</script>).</p>",
  "outputSpecHtml": "<p>For each test case, print the density of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-151\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-152\">m</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-30-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-30\">m</script>-<span class=\"tex-font-style-it\">tetrative</span> integers (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-153\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-154\">a</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-31-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-31\">a</script> such that its corresponding sequence <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-155\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-156\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-157\" style=\"margin-right: 0.05em;\">b</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-158\" style=\"vertical-align: -0.4em;\">n</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-32-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-32\">b_n</script> converges to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-159\"><span class=\"MJXp-mn\" id=\"MJXp-Span-160\">1</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-33-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-33\">1</script> modulo <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-161\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-162\">m</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-34-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-34\">m</script>), modulo <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-163\"><span class=\"MJXp-mn\" id=\"MJXp-Span-164\">998</span><span class=\"MJXp-mspace\" id=\"MJXp-Span-165\" style=\"width: 0.167em; height: 0em;\"></span><span class=\"MJXp-mn\" id=\"MJXp-Span-166\">244</span><span class=\"MJXp-mspace\" id=\"MJXp-Span-167\" style=\"width: 0.167em; height: 0em;\"></span><span class=\"MJXp-mn\" id=\"MJXp-Span-168\">353</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-35-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-35\">998\\,244\\,353</script>.</p><p>Formally, let <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-169\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-170\">M</span><span class=\"MJXp-mo\" id=\"MJXp-Span-171\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-172\">998</span><span class=\"MJXp-mspace\" id=\"MJXp-Span-173\" style=\"width: 0.167em; height: 0em;\"></span><span class=\"MJXp-mn\" id=\"MJXp-Span-174\">244</span><span class=\"MJXp-mspace\" id=\"MJXp-Span-175\" style=\"width: 0.167em; height: 0em;\"></span><span class=\"MJXp-mn\" id=\"MJXp-Span-176\">353</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-36-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-36\">M = 998\\,244\\,353</script>. It can be shown that the exact answer can be expressed as an irreducible fraction <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-177\"><span class=\"MJXp-mfrac\" id=\"MJXp-Span-178\" style=\"vertical-align: 0.25em;\"><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-179\">p</span></span><span class=\"MJXp-box\" style=\"margin-top: -0.9em;\"><span class=\"MJXp-denom\"><span><span class=\"MJXp-rule\" style=\"height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;\"></span></span><span><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-180\">q</span></span></span></span></span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-37-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-37\">\\frac{p}{q}</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-181\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-182\">p</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-38-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-38\">p</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-183\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-184\">q</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-39-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-39\">q</script> are integers and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-188\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-189\">q</span><span class=\"MJXp-mo\" id=\"MJXp-Span-190\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≢</span><span class=\"MJXp-mn\" id=\"MJXp-Span-191\">0</span><span class=\"MJXp-TeXmathchoice\" id=\"MJXp-Span-192\"><span class=\"MJXp-mspace\" id=\"MJXp-Span-193\" style=\"width: 0.444em; height: 0em;\"></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-194\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi\" id=\"MJXp-Span-195\">mod</span><span class=\"MJXp-mspace\" id=\"MJXp-Span-196\" style=\"width: 0.333em; height: 0em;\"></span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-197\">M</span><span class=\"MJXp-mo\" id=\"MJXp-Span-198\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-40-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-40\">q \\not \\equiv 0 \\pmod{M}</script>. Output the integer equal to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-199\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-200\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-201\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⋅</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-202\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-203\" style=\"margin-right: 0.05em;\">q</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-204\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-mo\" id=\"MJXp-Span-205\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-206\">1</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-207\" style=\"margin-left: 0.278em; margin-right: 0.278em;\">mod</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-208\">M</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-41-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-41\">p \\cdot q^{-1} \\bmod M</script>. In other words, output such an integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-209\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-210\">x</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-42-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-42\">x</script> that <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-211\"><span class=\"MJXp-mn\" id=\"MJXp-Span-212\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-213\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-214\">x</span><span class=\"MJXp-mo\" id=\"MJXp-Span-215\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">&lt;</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-216\">M</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-43-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-43\">0 \\le x < M</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-217\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-218\">x</span><span class=\"MJXp-mo\" id=\"MJXp-Span-219\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⋅</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-220\">q</span><span class=\"MJXp-mo\" id=\"MJXp-Span-221\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≡</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-222\">p</span><span class=\"MJXp-TeXmathchoice\" id=\"MJXp-Span-223\"><span class=\"MJXp-mspace\" id=\"MJXp-Span-224\" style=\"width: 0.444em; height: 0em;\"></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-225\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi\" id=\"MJXp-Span-226\">mod</span><span class=\"MJXp-mspace\" id=\"MJXp-Span-227\" style=\"width: 0.333em; height: 0em;\"></span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-228\">M</span><span class=\"MJXp-mo\" id=\"MJXp-Span-229\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-44-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-44\">x \\cdot q \\equiv p \\pmod{M}</script>. </p>",
  "noteHtml": "<p>In the first test case, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-230\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-231\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-232\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-233\">5</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-45-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-45\">m = 5</script>. For example, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-234\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-235\">a</span><span class=\"MJXp-mo\" id=\"MJXp-Span-236\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-237\">1</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-46-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-46\">a=1</script> is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-238\"><span class=\"MJXp-mn\" id=\"MJXp-Span-239\">5</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-47-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-47\">5</script>-<span class=\"tex-font-style-it\">tetrative</span> since <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-240\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-241\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-242\" style=\"margin-right: 0.05em;\">b</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-243\" style=\"vertical-align: -0.4em;\">n</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-244\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-245\">1</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-48-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-48\">b_n = 1</script> for all <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-246\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-247\">n</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-49-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-49\">n</script>. For <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-248\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-249\">a</span><span class=\"MJXp-mo\" id=\"MJXp-Span-250\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-251\">8</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-50-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-50\">a= 8</script>, the sequence <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-252\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-253\">b</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-51-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-51\">b</script> is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-254\"><span class=\"MJXp-mo\" id=\"MJXp-Span-255\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-256\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-257\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-258\">8</span><span class=\"MJXp-mo\" id=\"MJXp-Span-259\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-260\"><span class=\"MJXp-mn\" id=\"MJXp-Span-261\" style=\"margin-right: 0.05em;\">8</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-262\" style=\"vertical-align: 0.5em;\">8</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-263\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-264\"><span class=\"MJXp-mn\" id=\"MJXp-Span-265\" style=\"margin-right: 0.05em;\">8</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-266\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-mo\" id=\"MJXp-Span-267\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-268\"><span class=\"MJXp-mn\" id=\"MJXp-Span-269\" style=\"margin-right: 0.05em;\">8</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-270\" style=\"vertical-align: 0.5em;\">8</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-271\">)</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-272\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mo\" id=\"MJXp-Span-273\" style=\"margin-left: 0em; margin-right: 0em;\">…</span><span class=\"MJXp-mo\" id=\"MJXp-Span-274\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-52-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-52\">[1, 8, 8^8, 8^{(8^8)}, \\ldots]</script>, which is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-275\"><span class=\"MJXp-mo\" id=\"MJXp-Span-276\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-277\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-278\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-279\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-280\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-281\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-282\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-283\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-284\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mo\" id=\"MJXp-Span-285\" style=\"margin-left: 0em; margin-right: 0em;\">…</span><span class=\"MJXp-mo\" id=\"MJXp-Span-286\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-53-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-53\">[1, 3, 1, 1, \\ldots]</script> if we look at it modulo <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-287\"><span class=\"MJXp-mn\" id=\"MJXp-Span-288\">5</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-54-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-54\">5</script>. It can be proven that the sequence is always <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-289\"><span class=\"MJXp-mn\" id=\"MJXp-Span-290\">1</span><span class=\"MJXp-TeXmathchoice\" id=\"MJXp-Span-291\"><span class=\"MJXp-mspace\" id=\"MJXp-Span-292\" style=\"width: 0.444em; height: 0em;\"></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-293\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi\" id=\"MJXp-Span-294\">mod</span><span class=\"MJXp-mspace\" id=\"MJXp-Span-295\" style=\"width: 0.333em; height: 0em;\"></span><span class=\"MJXp-mn\" id=\"MJXp-Span-296\">5</span><span class=\"MJXp-mo\" id=\"MJXp-Span-297\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-55-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-55\">1 \\pmod 5</script> for big enough <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-298\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-299\">n</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-56-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-56\">n</script>, so <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-300\"><span class=\"MJXp-mn\" id=\"MJXp-Span-301\">8</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-57-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-57\">8</script> is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-302\"><span class=\"MJXp-mn\" id=\"MJXp-Span-303\">5</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-58-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-58\">5</script>-<span class=\"tex-font-style-it\">tetrative</span>. For <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-304\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-305\">a</span><span class=\"MJXp-mo\" id=\"MJXp-Span-306\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-307\">10</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-59-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-59\">a=10</script>, the sequence <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-308\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-309\">b</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-60-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-60\">b</script> is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-310\"><span class=\"MJXp-mo\" id=\"MJXp-Span-311\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-312\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-313\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-314\">10</span><span class=\"MJXp-mo\" id=\"MJXp-Span-315\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-316\"><span class=\"MJXp-mn\" id=\"MJXp-Span-317\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-318\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-319\">10</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-320\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-321\"><span class=\"MJXp-mn\" id=\"MJXp-Span-322\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-323\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-mo\" id=\"MJXp-Span-324\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-325\"><span class=\"MJXp-mn\" id=\"MJXp-Span-326\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mrow MJXp-script\" id=\"MJXp-Span-327\" style=\"vertical-align: 0.5em;\"><span class=\"MJXp-mn\" id=\"MJXp-Span-328\">10</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-329\">)</span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-330\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mo\" id=\"MJXp-Span-331\" style=\"margin-left: 0em; margin-right: 0em;\">…</span><span class=\"MJXp-mo\" id=\"MJXp-Span-332\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-61-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-61\">[1, 10, 10^{10}, 10^{(10^{10})}, \\ldots]</script>, which is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-333\"><span class=\"MJXp-mo\" id=\"MJXp-Span-334\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-335\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-336\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-337\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-338\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-339\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-340\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-341\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-342\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mo\" id=\"MJXp-Span-343\" style=\"margin-left: 0em; margin-right: 0em;\">…</span><span class=\"MJXp-mo\" id=\"MJXp-Span-344\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-62-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-62\">[1, 0, 0, 0, \\ldots]</script> if we look at it modulo <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-345\"><span class=\"MJXp-mn\" id=\"MJXp-Span-346\">5</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-63-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-63\">5</script>. It can be proven that the sequence is always <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-347\"><span class=\"MJXp-mn\" id=\"MJXp-Span-348\">0</span><span class=\"MJXp-TeXmathchoice\" id=\"MJXp-Span-349\"><span class=\"MJXp-mspace\" id=\"MJXp-Span-350\" style=\"width: 0.444em; height: 0em;\"></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-351\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi\" id=\"MJXp-Span-352\">mod</span><span class=\"MJXp-mspace\" id=\"MJXp-Span-353\" style=\"width: 0.333em; height: 0em;\"></span><span class=\"MJXp-mn\" id=\"MJXp-Span-354\">5</span><span class=\"MJXp-mo\" id=\"MJXp-Span-355\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-64-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-64\">0 \\pmod 5</script> for big enough <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-356\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-357\">n</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-65-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-65\">n</script>, so <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-358\"><span class=\"MJXp-mn\" id=\"MJXp-Span-359\">10</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-66-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-66\">10</script> is not <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-360\"><span class=\"MJXp-mn\" id=\"MJXp-Span-361\">5</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-67-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-67\">5</script>-<span class=\"tex-font-style-it\">tetrative</span>. The answer for the first test case is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-362\"><span class=\"MJXp-mfrac\" id=\"MJXp-Span-363\" style=\"vertical-align: 0.25em;\"><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mn\" id=\"MJXp-Span-364\">1</span></span><span class=\"MJXp-box\" style=\"margin-top: -0.9em;\"><span class=\"MJXp-denom\"><span><span class=\"MJXp-rule\" style=\"height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;\"></span></span><span><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mn\" id=\"MJXp-Span-365\">2</span></span></span></span></span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-68-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-68\">\\frac{1}{2}</script>.</p><p> In the second test case, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-366\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-367\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-368\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-369\">10</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-69-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-69\">m= 10</script> and the answer is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-370\"><span class=\"MJXp-mfrac\" id=\"MJXp-Span-371\" style=\"vertical-align: 0.25em;\"><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mn\" id=\"MJXp-Span-372\">1</span></span><span class=\"MJXp-box\" style=\"margin-top: -0.9em;\"><span class=\"MJXp-denom\"><span><span class=\"MJXp-rule\" style=\"height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;\"></span></span><span><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mn\" id=\"MJXp-Span-373\">10</span></span></span></span></span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-70-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-70\">\\frac{1}{10}</script>. </p><p> In the third test case, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-374\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-375\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-376\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-377\">23</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-71-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-71\">m= 23</script> and the answer is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-378\"><span class=\"MJXp-mfrac\" id=\"MJXp-Span-379\" style=\"vertical-align: 0.25em;\"><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mn\" id=\"MJXp-Span-380\">63</span></span><span class=\"MJXp-box\" style=\"margin-top: -0.9em;\"><span class=\"MJXp-denom\"><span><span class=\"MJXp-rule\" style=\"height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;\"></span></span><span><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mn\" id=\"MJXp-Span-381\">506</span></span></span></span></span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-72-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-72\">\\frac{63}{506}</script>.</p><p> In the fourth test case, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-382\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-383\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-384\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-385\">200</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-73-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-73\">m= 200</script> and the answer is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-386\"><span class=\"MJXp-mfrac\" id=\"MJXp-Span-387\" style=\"vertical-align: 0.25em;\"><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mn\" id=\"MJXp-Span-388\">1</span></span><span class=\"MJXp-box\" style=\"margin-top: -0.9em;\"><span class=\"MJXp-denom\"><span><span class=\"MJXp-rule\" style=\"height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;\"></span></span><span><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mn\" id=\"MJXp-Span-389\">200</span></span></span></span></span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-74-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-74\">\\frac{1}{200}</script>. </p><p> In the fifth test case, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-390\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-391\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-392\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-393\">999</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-75-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-75\">m= 999</script> and the answer is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-394\"><span class=\"MJXp-mfrac\" id=\"MJXp-Span-395\" style=\"vertical-align: 0.25em;\"><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mn\" id=\"MJXp-Span-396\">1</span></span><span class=\"MJXp-box\" style=\"margin-top: -0.9em;\"><span class=\"MJXp-denom\"><span><span class=\"MJXp-rule\" style=\"height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;\"></span></span><span><span class=\"MJXp-box MJXp-script\"><span class=\"MJXp-mn\" id=\"MJXp-Span-397\">222</span></span></span></span></span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-76-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-76\">\\frac{1}{222}</script>.</p>",
  "samples": [
    {
      "input": "55 1 15 2 123 1 110 10 29 3 37",
      "output": "499122177299473306893685162913393583705965601"
    }
  ],
  "images": [],
  "url": "https://codeforces.com/contest/2147/problem/G",
  "tutorialHtml": "<div><div class=\"ttypography\"><div class=\"problem-statement\"><div><p>Suppose $$$a&gt;1$$$ and $$$\\gcd(a,m) = 1$$$. Observe that the sequence $$$b$$$ is of the form $$$a^{a^N}$$$ for a very big $$$N$$$ after $$$n&gt;3$$$. So $$$b_n \\equiv 1 \\pmod m$$$ is equivalent to $$$a^N \\equiv 0 \\pmod {ord_m(a)}$$$. Since $$$N$$$ goes to infinity as $$$n$$$ increases, it is equivalent to the condition $$$\\forall p| ord_m(a), p| a$$$ or $$$rad(ord_m(a))|a$$$. This implies that solutions are periodic: if $$$a$$$ is a solution, so is $$$a+m \\cdot ord_m(a)$$$, hence $$$m \\varphi(m)$$$ is a period. Fixing an $$$1\\leq a &lt; m$$$ try to find numbers of the form $$$a+ \\lambda m$$$ such that $$$rad(ord_a(m))| a+\\lambda m$$$. Since $$$gcd(a,m)=1$$$, as long as $$$\\gcd(ord_a(m),m) = 1$$$ we have by CRT that there exists a unique $$$\\lambda$$$ modulo $$$rad(ord_m(a))$$$ that satisfies that condition. Finally, grouping solutions by their order, the density can be written as follows: $$$$$$\\frac{1}{m} \\sum_{x | \\varphi(m), \\gcd(x,m)=1} \\frac{cnt(x)}{rad(x)}$$$$$$ Where $$$cnt(x)$$$ is the number of values $$$a$$$ that have order exactly $$$x$$$. The sum is over divisors of $$$\\varphi(m)$$$ since orders must divide it. </p><p>We are close to a $$$O(d(m))$$$ solution. The values of $$$cnt(x)$$$ are well known for odd prime power modulos: there are $$$\\varphi(x)$$$ values $$$a$$$ with order exactly $$$x$$$ modulo $$$p_i^{\\alpha_i}$$$ (and powers of $$$2$$$ do not matter since the order has to be coprime with $$$m$$$). Using that $$$ord_{xy}(a) = lcm(ord_x(a), ord_y(a))$$$ one can compute $$$cnt$$$ and have a $$$O(d(m))$$$ solution. This is however not enough to pass since there are $$$T = 10000$$$ tests.</p><p>So we had that the answer is $$$\\frac{1}{m} \\sum_{x | \\varphi(m), \\gcd(x,m)=1} \\frac{cnt(x)}{rad(x)}$$$ Where $$$cnt$$$ is the number of values a that have order exactly $$$x$$$. Our goal is to fix $$$rad(x)$$$ and compute $$$\\sum cnt(x)$$$ over $$$x$$$'s such that $$$rad(x) = k$$$. There might be an easier way to derive it but the following works: denoting $$$q_i$$$ the primes of $$$k$$$ and $$$q_i^{\\beta_i}$$$ the exponents of $$$q_i$$$ in $$$\\varphi(m)$$$, $$$$$$ \\sum_{x|\\varphi(m), rad(x) | k} cnt(x) = \\sum_{d_1| q_1^{\\beta_1}, \\ldots , d_t | q_t^{\\beta_t}} \\prod \\varphi(d_i) $$$$$$ $$$$$$= \\prod_i \\sum_{d | q_i^{\\beta_i}} \\varphi(d) $$$$$$ $$$$$$= \\prod q_i^{\\beta_i} $$$$$$ Möbius inversion (or inclusion exclusion) gives $$$$$$\\sum_{x|\\varphi(m), rad(x) = k} cnt(x) = \\sum_{I \\subset [t]} (-1)^{t-|I|}\\prod_{i \\in I}q_i^{\\beta_i} = \\prod (q_i^{\\beta_i}-1)$$$$$$ So the answer can be written as $$$$$$\\frac{1}{m} \\sum_{I \\subset [t]}\\sum_{rad(x) = \\prod q_i} \\frac{\\prod {(q_i^{\\beta_i} -1)}}{\\prod q_i }$$$$$$ Which can be factored as $$$\\frac{1}{m} \\prod (1 + \\frac{q_i^{\\beta_i}-1}{q_i})$$$, the product is over all prime factors $$$q_i^{\\beta_i}$$$ of $$$\\varphi(m)$$$ that are not of $$$m$$$. This formula can be computed in $$$O(\\log m)$$$ by factoring $$$m$$$ and $$$\\varphi(m)$$$.</p></div></div></div></div>"
}