<html lang="en"><head>
        <script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script type="text/javascript" async="" src="https://www.googletagmanager.com/gtag/js?id=G-K230KVN22K&amp;cx=c&amp;gtm=4e5ca1"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="67997b6b437facc02ce6bd4029c314a9">
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01">
    <meta name="robots" content="noai">
    <meta name="robots" content="noimageai">

    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="l3">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90">
    <meta property="fb:admins" content="100001352546622">
    <meta property="og:image" content="//codeforces.com/codeforces.org/s/52448/images/codeforces-sponsored-by-ton.png">
    <link rel="image_src" href="//codeforces.com/codeforces.org/s/52448/images/codeforces-sponsored-by-ton.png">
    <meta property="og:title" content="European Championship 2025 (EUC) Editorial - Codeforces">
    <meta property="og:description" content="">
    
    <meta property="og:site_name" content="Codeforces">
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00">
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2">
    <title>European Championship 2025 (EUC) Editorial - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community">
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup">
    <meta name="robots" content="index, follow">

    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/font-awesome.min.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/line-awesome.min.css" type="text/css" charset="utf-8">

        <link rel="preconnect" href="https://challenges.cloudflare.com">
        <link rel="dns-prefetch" href="https://challenges.cloudflare.com">
        <link href="//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&amp;subset=latin,cyrillic" rel="stylesheet" type="text/css">
        <link href="//fonts.googleapis.com/css?family=Cuprum&amp;subset=latin,cyrillic" rel="stylesheet" type="text/css">


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.com/codeforces.org/s/52448/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.com/codeforces.org/s/52448/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.com/codeforces.org/s/52448/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.com/codeforces.org/s/52448/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.com/codeforces.org/s/52448/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.com/codeforces.org/s/52448/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.com/codeforces.org/s/52448/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.com/codeforces.org/s/52448/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.com/codeforces.org/s/52448/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="//codeforces.com/codeforces.org/s/52448/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.com/codeforces.org/s/52448/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.com/codeforces.org/s/52448/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.com/codeforces.org/s/52448/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.com/codeforces.org/s/52448/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/prettify.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/clear.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/style.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/ttypography.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/problem-statement.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/second-level-menu.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/roundbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/datatable.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/table-form.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/topic.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/jquery.jgrowl.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/facebox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/jquery.wysiwyg.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/jquery.autocomplete.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/codeforces.datepick.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/colorbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/jquery.drafts.css" type="text/css" charset="utf-8">
        <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/community.css" type="text/css" charset="utf-8">

    <!-- MathJax -->
    <script type="text/x-mathjax-config;executed=true">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async="" src="https://codeforces.com/mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full">
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/5913b958cb6e1f2144469a313cc0ac6e/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/confetti.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/purify.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/markitup/skins/markitup/style.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/markitup/sets/markdown/style.css" type="text/css" charset="utf-8">


    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




<style type="text/css" media="screen">#swfcontainer {visibility:hidden}</style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888; display: contents}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none; box-sizing: content-box}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_test {font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.MathJax_test.mjx-test-display {display: table!important}
.MathJax_test.mjx-test-inline {display: inline!important; margin-right: -1px}
.MathJax_test.mjx-test-default {display: block!important; clear: both}
.MathJax_ex_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60ex}
.MathJax_em_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60em}
.mjx-test-inline .MathJax_left_box {display: inline-block; width: 0; float: left}
.mjx-test-inline .MathJax_right_box {display: inline-block; width: 0; float: right}
.mjx-test-display .MathJax_right_box {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.9') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body class=" "><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"><br><br><br><br><br><br><br></div></div><div id="MathJax_Message" style="display: none;"></div><span style="display:none;" class="csrf-token" data-csrf="67997b6b437facc02ce6bd4029c314a9">&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }, beforeSend: function(jqXHR, settings) {
        const url = new URL(settings.url, window.location.href);
        const urlHref = url.href;
        url.searchParams.set('rv', Math.random().toString(36).substr(2, 9)); // Generate a random value
        settings.url = url.href;
    }});

    window.updateTypography();
    Codeforces.signForms();
    Codeforces.applyDatatableJs("Hold Ctrl+Alt and click to hide column. Also, you can drag&drop columns to reorder them.");

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        if (json.t === "a") {
            setTimeout(function() {
               Codeforces.showAnnouncements(json.d, "en");
            }, Math.random() * 500);
        }
    }

    function showEventCatcherUserMessage(json) {
        if (json.t === "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        const title = $(this).attr("data-title");
        const clazz = $(this).attr("data-clazz");
        const props = {};
        if (typeof (clazz) !== 'undefined') {
            props['clazz'] = clazz;
        }
        if (title) {
            Codeforces.alert(title, null, null, props);
        } else {
            Codeforces.alert($(this).attr("title"), null, null, props);
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
        

<div class="side-bell" style="visibility: hidden; display: none; opacity: 0.7; width: 40px; position: fixed; right: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 1.5rem;">
    <span class="icon-stack" style="width: 100%;">
        <i class="icon-circle icon-stack-base"></i>
        <i class="icon-bell-alt icon-light"></i>
    </span>
    <br>
    <span class="side-bell__count" style="position: relative; top: -10px;"></span>
</div>


<div id="header" style="position: relative;">

    <div style="float:left; max-height: 60px;">
                            <a href="/"><img height="65" style="height: 65px;" alt="Codeforces" title="Codeforces" src="//codeforces.com/codeforces.org/s/52448/images/codeforces-sponsored-by-ton.png"></a>
    </div>
    <div class="lang-chooser">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.com/codeforces.org/s/52448/images/flags/24/gb.png" title="In English" alt="In English"></a>
                <a href="?locale=ru"><img src="//codeforces.com/codeforces.org/s/52448/images/flags/24/ru.png" title="По-русски" alt="По-русски"></a>
            </div>

        <div>
                        <a href="/enter?back=%2Fblog%2Fentry%2F140239">Enter</a>
                     | 
                        <a href="/register">Register</a>
                    
        </div>

    </div>
    <br style="clear: both;">
</div>

        


    <div class="roundbox menu-box borderTopRound borderBottomRound" style="">
    <div class="menu-list-container">
    <ul class="menu-list main-menu-list">
                <li class=""><a href="/">Home</a></li>
                <li class=""><a href="/top">Top</a></li>
                <li class=""><a href="/catalog">Catalog</a></li>
                <li class=""><a href="/contests">Contests</a></li>
                <li class=""><a href="/gyms">Gym</a></li>
                <li class=""><a href="/problemset">Problemset</a></li>
                <li class=""><a href="/groups">Groups</a></li>
                <li class=""><a href="/ratings">Rating</a></li>
                <li class=""><a href="/edu/courses"><span class="edu-menu-item">Edu</span></a></li>
                <li class=""><a href="/apiHelp">API</a></li>
                <li class=""><a href="/calendar">Calendar</a></li>
                <li class=""><a href="/help">Help</a></li>
    </ul>
        <form method="post" action="/search"><input type="hidden" name="csrf_token" value="67997b6b437facc02ce6bd4029c314a9">
            <input class="search" name="query" data-isplaceholder="true" value="">
        <input type="hidden" name="_tta" value="10"></form>
    <br style="clear: both;">
</div>

    </div>

    <script type="text/javascript">
        $(document).ready(function () {
            $("input.search").focus(function () {
                if ($(this).attr("data-isPlaceholder") === "true") {
                    $(this).val("");
                    $(this).removeAttr("data-isPlaceholder");
                }
            });
        });
    </script>
        
            <br style="height: 3em; clear: both;">

        <div style="position: relative;">
                        <div id="sidebar">

    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Pay attention
            <div class="top-links">
            </div>
        </div>
<div style="padding: 0.5em;">
        <div style="text-align:center;">
            <span class="contest-state-phase">Before contest</span><br><a href="/contests/2181">2025-2026 ICPC, NERC, Northern Eurasia Finals (Unrated, Online Mirror, ICPC Rules, Teams Preferred)</a><br><span class="countdown" home="//codeforces.com/codeforces.org/s/52448" noredirection="true" textbeforeredirect="" cdid="i1"><span title="66:47:07">3 days</span></span><br><a href="/contestRegistration/2181">Register now »</a>
        </div>
</div>
    </div>

<style data-nocturne="true" type="text/css">
._StreamsSidebarFrame_frame {
  padding: 0.5em 0.5em 0 0.5em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream {
  text-align: center;
  border-bottom: 1px solid #b9b9b9;
  margin: 0 -0.5em 0.5em -0.5em;
  padding: 0 1em 0.5em 1em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream ._StreamsSidebarFrame_user {
  margin: 0 0 0.5em 0;
  font-size: 0.8em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream ._StreamsSidebarFrame_timeMark {
  color: #777;
  font-size: 0.9em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream:last-of-type {
  border-bottom: unset;
  margin: unset;
  padding: 0 0.5em 0.5em 1em;
}
._StreamsSidebarFrame_frame ._viewAll {
  text-align: right;
}
.moreRunningStreamsSidebarNote {
  color: #777 !important;
  text-decoration: none;
}
</style>




    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Streams
            <div class="top-links">
            </div>
        </div>
            <div class="_StreamsSidebarFrame_frame">
                    <div class="_StreamsSidebarFrame_stream">
                        <div class="_StreamsSidebarFrame_name">
        <p class="_englishName _name">
            
            <a href="/stream/865">Repovive Opening Contest — Solution Discussion</a>
        </p>

                        </div>

                        <div class="_StreamsSidebarFrame_user">
                            By <a href="/profile/Shayan" title="International Grandmaster Shayan" class="rated-user user-red">Shayan</a>
                        </div>

                            <div class="_StreamsSidebarFrame_countdown _StreamsSidebarFrame_timeMark">
                                Before stream
                                <span class="countdown" noredirection="true" cdid="i2">04:22:06</span>
                            </div>
                    </div>
            </div>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="/streams">View all →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>

<script data-nocturne="true"> $(function () {

}); </script>


<div class="roundbox sidebox top-contributed borderTopRound " style="">
<div class="caption titled">→ Top rated
<div class="top-links">
</div>
</div>
<table class="rtable ">
<tbody>
<tr>
<th class="left" style="width:2.25em;">#</th>
<th class="">User</th>
<th class="" style="width:5em;">Rating</th>
</tr>
<tr>
<td class="left dark">1</td>
<td class=" dark"><a href="/profile/Kevin114514" title="Legendary Grandmaster Kevin114514" class="rated-user user-legendary"><span class="legendary-user-first-letter">K</span>evin114514</a></td>
<td class=" dark">3765</td>
</tr>
<tr>
<td class="left ">2</td>
<td class=""><a href="/profile/tourist" title="Legendary Grandmaster tourist" class="rated-user user-legendary"><span class="legendary-user-first-letter">t</span>ourist</a></td>
<td class="">3757</td>
</tr>
<tr>
<td class="left dark">3</td>
<td class=" dark"><a href="/profile/Benq" title="Legendary Grandmaster Benq" class="rated-user user-legendary"><span class="legendary-user-first-letter">B</span>enq</a></td>
<td class=" dark">3738</td>
</tr>
<tr>
<td class="left ">4</td>
<td class=""><a href="/profile/jiangly" title="Legendary Grandmaster jiangly" class="rated-user user-legendary"><span class="legendary-user-first-letter">j</span>iangly</a></td>
<td class="">3705</td>
</tr>
<tr>
<td class="left dark">5</td>
<td class=" dark"><a href="/profile/orzdevinwang" title="Legendary Grandmaster orzdevinwang" class="rated-user user-legendary"><span class="legendary-user-first-letter">o</span>rzdevinwang</a></td>
<td class=" dark">3670</td>
</tr>
<tr>
<td class="left ">6</td>
<td class=""><a href="/profile/ksun48" title="Legendary Grandmaster ksun48" class="rated-user user-legendary"><span class="legendary-user-first-letter">k</span>sun48</a></td>
<td class="">3668</td>
</tr>
<tr>
<td class="left dark">7</td>
<td class=" dark"><a href="/profile/Radewoosh" title="Legendary Grandmaster Radewoosh" class="rated-user user-legendary"><span class="legendary-user-first-letter">R</span>adewoosh</a></td>
<td class=" dark">3531</td>
</tr>
<tr>
<td class="left ">8</td>
<td class=""><a href="/profile/maroonrk" title="Legendary Grandmaster maroonrk" class="rated-user user-legendary"><span class="legendary-user-first-letter">m</span>aroonrk</a></td>
<td class="">3443</td>
</tr>
<tr>
<td class="left dark">9</td>
<td class=" dark"><a href="/profile/dXqwq" title="Legendary Grandmaster dXqwq" class="rated-user user-legendary"><span class="legendary-user-first-letter">d</span>Xqwq</a></td>
<td class=" dark">3436</td>
</tr>
<tr>
<td class="left bottom">10</td>
<td class="bottom"><a href="/profile/Nachia" title="Legendary Grandmaster Nachia" class="rated-user user-legendary"><span class="legendary-user-first-letter">N</span>achia</a></td>
<td class="bottom">3432</td>
</tr>
</tbody>
</table>
<div class="bottom-links">
<table style="width:100%;">
<tbody>
<tr>
<td style="text-align:left;">
<a href="/ratings/countries">Countries</a> |
<a href="/ratings/cities">Cities</a> |
<a href="/ratings/organizations">Organizations</a>
</td>
<td style="text-align:right;">
<a href="/ratings">View all →</a>
</td>
</tr>
</tbody>
</table>
</div>
</div>


    <div class="roundbox sidebox top-contributed borderTopRound " style="">
        <div class="caption titled">→ Top contributors
            <div class="top-links">
            </div>
        </div>
        <table class="rtable ">
            <tbody>
                <tr>
                            <th class="left" style="width:2.25em;">#</th>
                            <th class="">User</th>
                            <th class="" style="width:5em;">Contrib.</th>
                </tr>
                    <tr>
                                <td class="left  dark">1</td>
                                <td class=" dark"><a href="/profile/Um_nik" title="Legendary Grandmaster Um_nik" class="rated-user user-legendary"><span class="legendary-user-first-letter">U</span>m_nik</a></td>
                                <td class=" dark">169</td>
                    </tr>
                    <tr>
                                <td class="left ">2</td>
                                <td class=""><a href="/profile/Qingyu" title="Legendary Grandmaster Qingyu" class="rated-user user-legendary"><span class="legendary-user-first-letter">Q</span>ingyu</a></td>
                                <td class="">166</td>
                    </tr>
                    <tr>
                                <td class="left  dark">3</td>
                                <td class=" dark"><a href="/profile/errorgorn" title="Legendary Grandmaster errorgorn" class="rated-user user-legendary"><span class="legendary-user-first-letter">e</span>rrorgorn</a></td>
                                <td class=" dark">163</td>
                    </tr>
                    <tr>
                                <td class="left ">4</td>
                                <td class=""><a href="/profile/adamant" title="Master adamant" class="rated-user user-orange">adamant</a></td>
                                <td class="">156</td>
                    </tr>
                    <tr>
                                <td class="left  dark">5</td>
                                <td class=" dark"><a href="/profile/Proof_by_QED" title="Master Proof_by_QED" class="rated-user user-orange">Proof_by_QED</a></td>
                                <td class=" dark">152</td>
                    </tr>
                    <tr>
                                <td class="left ">6</td>
                                <td class=""><a href="/profile/Dominater069" title="Legendary Grandmaster Dominater069" class="rated-user user-legendary"><span class="legendary-user-first-letter">D</span>ominater069</a></td>
                                <td class="">150</td>
                    </tr>
                    <tr>
                                <td class="left  dark">7</td>
                                <td class=" dark"><a href="/profile/cry" title="International Master cry" class="rated-user user-orange">cry</a></td>
                                <td class=" dark">149</td>
                    </tr>
                    <tr>
                                <td class="left ">8</td>
                                <td class=""><a href="/profile/TheScrasse" title="Grandmaster TheScrasse" class="rated-user user-red">TheScrasse</a></td>
                                <td class="">144</td>
                    </tr>
                    <tr>
                                <td class="left  dark">9</td>
                                <td class=" dark"><a href="/profile/soullless" title="Master soullless" class="rated-user user-orange">soullless</a></td>
                                <td class=" dark">143</td>
                    </tr>
                    <tr>
                                <td class="left bottom">10</td>
                                <td class="bottom"><a href="/profile/Arpa" title="International Master Arpa" class="rated-user user-orange">Arpa</a></td>
                                <td class="bottom">141</td>
                    </tr>
            </tbody>
        </table>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="/top-contributed">View all →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function () {
        });
    </script>




    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Find user
            <div class="top-links">
            </div>
        </div>
        <form class="handleForm" method="post" autocomplete="off"><input type="hidden" name="csrf_token" value="67997b6b437facc02ce6bd4029c314a9">
            <div style="padding:1em;text-align:right;">
                <label style="padding-right:1em;">Handle:
                    <input style="width:12em;" type="text" class="handleBox ac_input" autocomplete="off">
                </label>
            </div>
            <div style="padding: 0 1em 1em 1em;text-align:right;">
                <input style="height:1.65em;padding:0 0.75em;" type="submit" value="Find">
            </div>
        <input type="hidden" name="_tta" value="10"></form>
    </div>
    <script type="text/javascript">
        $(document).ready(function () {
    $(".handleBox").autocompleteHandle();
    $(".handleForm").attr("autocomplete", "off").submit(function () {
        var link = "/profile/userHandle".replace(
            "userHandle", $(this).find(".handleBox").val()
        );
        window.location = link;
        return false;
    });
        });
    </script>





    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Recent actions
            <div class="top-links">
            </div>
        </div>
        <div class="recent-actions">
            <ul>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/phosphorqq" title="Newbie phosphorqq" class="rated-user user-gray">phosphorqq</a>        →
        <a href="/blog/entry/149227">дисциплина</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/ABalobanov" title="Expert ABalobanov" class="rated-user user-blue">ABalobanov</a>        →
        <a href="/blog/entry/149154">Codeforces Round 1070 (Div.2) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/atcoder_official" title="Unrated, atcoder_official" class="rated-user user-black">atcoder_official</a>        →
        <a href="/blog/entry/149183">AtCoder Beginner Contest 436 Announcement</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Priyansh31dec" title="Master Priyansh31dec" class="rated-user user-orange">Priyansh31dec</a>        →
        <a href="/blog/entry/149065">Video Solutions for CSES Problemset by TLE Eliminators</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="//codeforces.com/codeforces.org/s/52448/images/icons/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/SecondThread" title="Grandmaster SecondThread" class="rated-user user-red">SecondThread</a>        →
        <a href="/blog/entry/147893">Hacker Cup Round 1 Recap</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/ko_osaga" title="Legendary Grandmaster ko_osaga" class="rated-user user-legendary"><span class="legendary-user-first-letter">k</span>o_osaga</a>        →
        <a href="/blog/entry/146988">Squarepoint Challenge (Codeforces Round 1055, Div. 1 + Div. 2) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/chenhongrui" title="Master chenhongrui" class="rated-user user-orange">chenhongrui</a>        →
        <a href="/blog/entry/149032">A Concern Regarding AI</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="//codeforces.com/codeforces.org/s/52448/images/icons/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/kisuke_007" title="Pupil kisuke_007" class="rated-user user-green">kisuke_007</a>        →
        <a href="/blog/entry/110589">How to fix this?</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
        <img alt="Necropost" title="Necropost" src="//codeforces.com/codeforces.org/s/52448/images/icons/hourglass.png" style="vertical-align:middle; position: relative; top: 1px;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/MathModel" title="Expert MathModel" class="rated-user user-blue">MathModel</a>        →
        <a href="/blog/entry/149013">Invitation to Eolymp Blitz #8 (Rating Upto 1750)</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Coxin_Hor" title="Expert Coxin_Hor" class="rated-user user-blue">Coxin_Hor</a>        →
        <a href="/blog/entry/149220">A fun contest I created myself.</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/saPaul" title="Pupil saPaul" class="rated-user user-green">saPaul</a>        →
        <a href="/blog/entry/149221">[Update] CF FetchCodes v25.12.7: Smart Retries, Lazy Loading &amp; Instant Caching!</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/adamant" title="Master adamant" class="rated-user user-orange">adamant</a>        →
        <a href="/blog/entry/149218">Finding all primes up to half a billion in 83 ms</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/awoo" title="Grandmaster awoo" class="rated-user user-red">awoo</a>        →
        <a href="/blog/entry/117791">Educational Codeforces Round 151 Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
        <img alt="Necropost" title="Necropost" src="//codeforces.com/codeforces.org/s/52448/images/icons/hourglass.png" style="vertical-align:middle; position: relative; top: 1px;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/alireza_kaviani" title="International Grandmaster alireza_kaviani" class="rated-user user-red">alireza_kaviani</a>        →
        <a href="/blog/entry/148411">Repovive Opening Contest</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/flamestorm" title="International Master flamestorm" class="rated-user user-orange">flamestorm</a>        →
        <a href="/blog/entry/104310">Codeforces Round #803 (Div. 2) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
        <img alt="Necropost" title="Necropost" src="//codeforces.com/codeforces.org/s/52448/images/icons/hourglass.png" style="vertical-align:middle; position: relative; top: 1px;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/SilverTongue1729" title="Candidate Master SilverTongue1729" class="rated-user user-violet">SilverTongue1729</a>        →
        <a href="/blog/entry/149213">Codeforces Profile Preview — Chrome Extension</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Xiaohuba" title="Master Xiaohuba" class="rated-user user-orange">Xiaohuba</a>        →
        <a href="/blog/entry/148062">Codeforces Global Round 30</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Ashwanth.K" title="Master Ashwanth.K" class="rated-user user-orange">Ashwanth.K</a>        →
        <a href="/blog/entry/149201">SOS DP easy understanding</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/BreakingNut" title="Specialist BreakingNut" class="rated-user user-cyan">BreakingNut</a>        →
        <a href="/blog/entry/149177">Solved the Problem, Lost the Girlfriend</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/ProblemTerminator" title="International Master ProblemTerminator" class="rated-user user-orange">ProblemTerminator</a>        →
        <a href="/blog/entry/149005">pls ban cheater sinha_yash and rollback the rating</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/cry" title="International Master cry" class="rated-user user-orange">cry</a>        →
        <a href="/blog/entry/137325">GIFs in Problem Statements are Broken</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Um_nik" title="Legendary Grandmaster Um_nik" class="rated-user user-legendary"><span class="legendary-user-first-letter">U</span>m_nik</a>        →
        <a href="/blog/entry/146705">On AI ruining "solving math problems with computer" [a year later]</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/m_manasc" title="Pupil m_manasc" class="rated-user user-green">m_manasc</a>        →
        <a href="/blog/entry/149219">An interesting problem</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="//codeforces.com/codeforces.org/s/52448/images/icons/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/SecondThread" title="Grandmaster SecondThread" class="rated-user user-red">SecondThread</a>        →
        <a href="/blog/entry/148802">Meta Hacker Cup Round 3</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="//codeforces.com/codeforces.org/s/52448/images/icons/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Top12" title="Expert Top12" class="rated-user user-blue">Top12</a>        →
        <a href="/blog/entry/149216">From TLE to AC using magic!</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
            </ul>
        </div>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="/recent-actions">Detailed →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>
</div>
                        <div id="pageContent" class="content-with-sidebar">
                    <div class="second-level-menu">
<ul class="second-level-menu-list"><li class="backLava" style="position: absolute; display: block; margin: 0px; padding: 0px; left: 38.6094px; top: 0px; width: 39px; height: 20px;"><div class="leftLava"></div><div class="bottomLava"></div><div class="cornerLava"></div></li>
        <li><a href="/profile/Petr">Petr</a></li>
        <li class="current selectedLava"><a href="/blog/Petr">Blog</a></li>
        <li><a href="/teams/with/Petr">Teams</a></li>
        <li><a href="/submissions/Petr">Submissions</a></li>
        <li><a href="/groups/with/Petr">Groups</a></li>
        <li><a href="/contests/with/Petr">Contests</a></li>
        <li><a href="/contests/writer/Petr">Problemsetting</a></li>
</ul>
</div>
    <div style="margin-top:0;">
    <div>
        <h3><a href="/blog/Petr" style="text-decoration:none;color:black !important;">Petr's blog</a></h3>
    </div>
        <div style="margin-top:2em;">


<div class="has-topic-id topic" topicid="140865">
    <div class="title">
            <a href="/blog/entry/140239">            <p>European Championship 2025 (EUC) Editorial</p>
</a>
    </div>

        <div class="info" style="position:relative;">
                By&nbsp;<a href="/profile/Petr" title="Legendary Grandmaster Petr" class="rated-user user-legendary"><span class="legendary-user-first-letter">P</span>etr</a>,
                    <span class="format-humantime" title="Mar/02/2025 15:18 UTC">9 months ago</span>,
                
                <img style="position: relative;top: 5px;" src="//codeforces.com/codeforces.org/s/52448/images/flags/24/gb.png" alt="In English" title="In English">



            <div class="topic-actions smaller">
                <ul>


                </ul>
            </div>
        </div>

    <div class="content">
        <div class="ttypography"><ul>   <li>A: Author: <a class="rated-user user-red" href="/profile/cdkrot" title="International Grandmaster cdkrot">cdkrot</a>, Prepared by: <a class="rated-user user-red" href="/profile/cdkrot" title="International Grandmaster cdkrot">cdkrot</a></li> </ul> <div class="spoiler"><b class="spoiler-title">Open</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2068/problem/A" title="European Championship 2025 - Online Mirror (Unrated, ICPC Rules, Teams Preferred)">2068A - Condorcet Elections</a></h3><div class="ttypography"><div class="problem-statement"><div><p>This problem is inspired by Condorcet's paradox. To put it simply, Condorcet's paradox states that for certain voters preferences, it's impossible to always resolve the elections fairly. No matter the outcome, more than half of the voters would prefer to change the result to some other outcome. This is illustrated by the second example in the statement. </p><p>The problem's answer is always <span class="tex-font-style-tt">YES</span>. It's possible to construct a list of votes such that any (not trivially contradicting) list of statements "candidate $$$x_i$$$ has defeated candidate $$$y_i$$$" can be satisfied.</p><p>Let $$$S = \{(a, b) \mid 1 \leq a, b \leq n, \, a \ne b\}$$$, and let $$$R \subseteq S$$$ be the list of requirements. Let $$$\delta_{a,b}(\text{ans})$$$, where $$$(a, b) \in S$$$ and "$$$\text{ans}$$$" is our answer, be how many votes prefer $$$a$$$ to $$$b$$$ minus how many votes prefer $$$b$$$ to $$$a$$$. We want to ensure that $$$\delta_{a,b}(\text{ans}) &gt; 0$$$ for every $$$(a, b) \in R$$$.</p><p>For every $$$(a, b) \in S$$$, it's actually possible to construct votes $$$\pi_1$$$, $$$\pi_2$$$, such that: </p><ul> <li> $$$\delta_{a,b}(\{\pi_1, \pi_2\}) = 2$$$. </li><li> $$$\delta_{x,y}(\{\pi_1, \pi_2\}) = 0$$$ for all $$$(x, y) \in S$$$, $$$\{x, y\} \ne \{a, b\}$$$. </li></ul><p>Then clearly adding $$$\pi_1$$$, $$$\pi_2$$$ for every $$$(a, b) \in R$$$ results in a correct answer. Thus, the jury solution uses at most $$$2 {n \choose 2} \le n^2$$$ votes.</p><p>Let us construct $$$\pi_1$$$, $$$\pi_2$$$. For the sake of exposition, let us assume $$$a = 1$$$, $$$b = 2$$$. Observe that the $$$\pi_1$$$, $$$\pi_2$$$ given below satisfy the requirements. Votes $$$\pi$$$ for any $$$(a, b) \ne (1, 2)$$$ can be constructed by the re-numeration. </p><ul> <li> $$$\pi_1 = (1, 2, 3, 4, \ldots, n - 1, n)$$$ </li><li> $$$\pi_2 = (n, n - 1, \ldots, 4, 3, 1, 2)$$$ </li></ul></div></div></div></div></div></div> <ul>   <li>B: Author: <a class="rated-user user-legendary" href="/profile/Petr" title="Legendary Grandmaster Petr"><span class="legendary-user-first-letter">P</span>etr</a>, Prepared by: <a class="rated-user user-legendary" href="/profile/Petr" title="Legendary Grandmaster Petr"><span class="legendary-user-first-letter">P</span>etr</a></li> </ul> <div class="spoiler"><b class="spoiler-title">Open</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2068/problem/B" title="European Championship 2025 - Online Mirror (Unrated, ICPC Rules, Teams Preferred)">2068B - Urban Planning</a></h3><div class="ttypography"><div class="problem-statement"><div><p><span><span class="tex-font-style-bf">Solutions that do not work</span></span></p><p>First of all, let us consider a square with side $$$n$$$, consisting only of parks. It has $$$\left(\frac{n(n-1)}{2}\right)^2$$$ rectangular walks, since there are $$$\frac{n(n-1)}{2}$$$ ways to choose the top and bottom rows, and $$$\frac{n(n-1)}{2}$$$ ways to choose the left and right columns. We will denote this number of rectangular walks in a square park as $$$f(n)$$$.</p><p>Now the logical idea would be to find the largest $$$f(n)$$$ that does not exceed $$$k$$$, create a park with side $$$n$$$, and then try to create additional independent parks using the remaining space on the grid to achieve $$$k-f(n)$$$ rectangular walks there.</p><p>When $$$k=4\cdot10^{12}$$$, we would choose $$$n=2000$$$, get $$$f(2000)=3\,996\,001\,000\,000$$$ walks that way, and then we would need to squeeze the remaining $$$3\,999\,000\,000$$$ walks into the rest of the 2025 times 2025 grid, which looks like two overlapping 24 times 2025 rectangles after we cut out the 2000 times 2000 rectangle plus adjacent cells to make sure the additional parks do not interact with the big one. However, a 24 times 2025 rectangle has only $$$565\,606\,800$$$ rectangular walks, so even with two of those we have no chance to reach the required number. Therefore the idea to have a completely independent large square park is too crude, and we need to improve it.</p><p>Instead of stopping at $$$f(n)$$$, let us add more park cells one by one to go from a square with side $$$n$$$ to a square with side $$$n+1$$$, first completing column $$$n+1$$$ from top to bottom, then completing row $$$n+1$$$ from left to right. For each newly added park cell, the number of rectangular walks will increase by at most $$$n^2$$$. This way we can find an incomplete square with $$$x$$$ rectangular walks such that $$$k-x &lt; n^2$$$, so we will only need to squeeze less than $$$n^2$$$ additional walks in the remaining space.</p><p>In practical terms, when $$$k \le 4\cdot10^{12}$$$, at the first step we will get a (partial) square with side at most 2001, and have at most $$$3\,999\,999$$$ remaining walks, then at the second step we will get a square with side at most 64, at the third step at most 12, then at most 6, then at most 4, then at most 3, at which moment we would have at most 3 remaining walks, which we can address by at most 3 squares with side 2.</p><p>It is still impossible to put a square of side 2001 and a square of side 64 without overlapping into a grid with side 2025, but now it is clear that we have enough area in our grid for this, and it is only the shape that is the problem. Therefore we should use rectangles instead of squares.</p><p><span><span class="tex-font-style-bf">Solution that works for $$$k \le 4\cdot 10^{12}$$$</span></span></p><p>In the onsite version of the contest, the constraint was $$$k \le 4\cdot 10^{12}$$$, for which the following approach works.</p><p>Let us start with a rectangle with height 1 and width 2025, and add a second row to it cell by cell from left to right, then the third row, and so on until we would have exceeded $$$k$$$ rectangular walks. After this, let us skip one row and start a new rectangle with width 2025 in the same fashion for the remaining walks, and so on until we reach exactly $$$k$$$.</p><p>This way the first (partial) rectangle will be at most 1977 times 2025, the second at most 3 times 2025, and then at most six more 2 times 2025 ones, which fits into our grid even with the additional empty rows between them, so this is a working solution.</p><p><span><span class="tex-font-style-bf">Solution that works for $$$k \le 4.194\cdot 10^{12}$$$</span></span></p><p>In the online mirror of the contest, this problem had a higher constraint: $$$k \le 4.194\cdot 10^{12}$$$. Note that $$$f(2024) \approx 4.191\cdot 10^{12}$$$ and $$$f(2025) \approx 4.2\cdot 10^{12}$$$, meaning that we need a grid almost full of parks to achieve such high values of $$$k$$$, and we cannot afford to have several connected components.</p><p>First, we do the same as above: let us find a partial rectangle that has almost $$$k$$$ rectangular walks. Additionally, we will force the partial rectangle to have $$$n$$$ rows and $$$n+1$$$ columns for some value of $$$n$$$, and we force the removed cells (which make the rectangle partial) to all be in one corner. In other words, we start with a full $$$n$$$ times $$$n+1$$$ rectangle, and then remove cells in the following order: first $$$(0, 0)$$$, then $$$(0, 1)$$$, then $$$(1, 0)$$$, then $$$(1, 1)$$$, then the cells with coordinates $$$\le 2$$$, and so on until the number of rectangular walks becomes $$$\le k$$$.</p><p>Since removing each particular cell reduces the number of rectangular walks by at most $$$n(n-1)$$$, we will be able to find a partial rectangle with such number of rectangular walks $$$x$$$ that $$$0\le k-x&lt;n(n-1)$$$. However, for reasons that will become apparent soon, let us remove a few more cells to achieve $$$n(n-1)\le k-x&lt;2n(n-1)$$$.</p><p>Since $$$f(n+1)-f(n)=O(n^3)$$$, and removing a cell reduces the number of rectangular walks by $$$\Omega(n^2)$$$, we will only remove $$$O(n)$$$ cells from the full rectangle to achieve this. And because of the order in which we remove the cells, all removed cells will be concentrated in a $$$O(\sqrt{n})$$$ times $$$O(\sqrt{n})$$$ corner of the rectangle, which means that we will still have $$$n-O(\sqrt{n})$$$ completely untouched rows (with $$$n+1$$$ cells each) and $$$n-O(\sqrt{n})$$$ completely untouched columns (with $$$n$$$ cells each).</p><p>Now we will add the remaining $$$k-x$$$ rectangular walks by adding cells to the right of the untouched rows (in column $$$n+2$$$) and to the bottom of the untouched columns (in row $$$n+1$$$), so the entire city will fit inside the $$$n+1$$$ times $$$n+2$$$ grid. If we add $$$y$$$ consecutive cells to the right of the untouched rows, this will add $$$\frac{y(y-1)}{2}(n+1)$$$ rectangular walks, and adding $$$y$$$ consecutive cells to the bottom of the untouched columns will add $$$\frac{y(y-1)}{2}n$$$ rectangular walks.</p><p>Now, remember that every number $$$z\ge n(n-1)$$$ can be represented as $$$pn+q(n+1)$$$ for some non-negative $$$p$$$ and $$$q$$$. Since $$$k-x\ge n(n-1)$$$, we can find such non-negative $$$p$$$ and $$$q$$$ that $$$k-x=pn+q(n+1)$$$. And now we just need to represent $$$p$$$ and $$$q$$$ as the sum of values of the form $$$\frac{y(y-1)}{2}$$$, and for each such value add a corresponding segment of $$$y$$$ extra cells to the right or to the bottom. To represent a given number $$$p$$$ as a sum of values of the form $$$\frac{y(y-1)}{2}$$$ is a knapsack problem that we will solve greedily: take the largest value of the form $$$\frac{y(y-1)}{2}$$$ that does not exceed $$$p$$$, and repeat for the remainder.</p><p>Now since $$$k-x&lt;2n(n-1)$$$, both $$$p$$$ and $$$q$$$ will be $$$O(n)$$$, so the first value of $$$y$$$ we will get will be $$$O(\sqrt{n})$$$, the second will be $$$O(\sqrt[4]{n})$$$, and so on, so the output of the greedy knapsack will fit in the $$$n-O(\sqrt{n})$$$ untouched rows/columns.</p><p>This solution does not always work for very small values of $$$k$$$, since we need a big enough $$$n$$$ for the constant factors hidden in $$$O()$$$ notation above to not matter. For those values of $$$k$$$ we can either use the solution above for the smaller constraints, or implement a very simple solution for very small constraints. For example, when $$$k \le \lfloor\frac{2025}{3}\rfloor^2$$$, we can just output a grid of separate $$$2 \times 2$$$ squares with empty rows and columns between them.</p><p>Also, since the resulting grid has $$$n+2$$$ columns, it means that we must have $$$n \le 2023$$$, so for the values of $$$k$$$ that exceed the total number of rectangular walks in the 2023 times 2024 rectangle it will no longer be true that $$$k-x&lt;2n(n-1)$$$. However, one can more carefully examine how much space does the greedy knapsack above need, and find that it can still fit inside the $$$n-O(\sqrt{n})$$$ untouched rows/columns at least for $$$k \le 4.1948\cdot 10^{12}$$$, which is enough to solve this problem.</p><p><span><span class="tex-font-style-bf">Remarks</span></span></p><p>There are of course very many approaches that work in this problem; the above solutions are just one possibility.</p><p>The judges also had a solution that could get even closer to $$$f(2025)$$$, approximately to $$$k\le \frac{1}{3}f(2024) + \frac{2}{3}f(2025)$$$. However, we felt that the $$$k \le 4.194\cdot 10^{12}$$$ constraint is similarly challenging, and did not want to restrict the possible approaches too much.</p><p>The fact that we are counting hollow rectangular walks instead of rectangles that also have only parks inside them did not actually affect the above solutions. We made them hollow so that counting rectangles takes $$$O(n^2\log n)$$$ instead of $$$O(n^2)$$$, so hopefully simple hill-climbing solutions were less likely to work.</p></div></div></div></div></div></div> <ul>   <li>C: Author: <a class="rated-user user-orange" href="/profile/cip999" title="Master cip999">cip999</a>, Prepared by: <a class="rated-user user-orange" href="/profile/thocevar" title="Master thocevar">thocevar</a></li> </ul> <div class="spoiler"><b class="spoiler-title">Open</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2068/problem/C" title="European Championship 2025 - Online Mirror (Unrated, ICPC Rules, Teams Preferred)">2068C - Ads</a></h3><div class="ttypography"><div class="problem-statement"><div><p>The result is equal to $$$g-1$$$ where $$$g$$$ is the number of groups of videos. Therefore, you want to minimize the number of groups and you can do this by creating large groups: first of size 3, then of size 2 and of size 1 with whatever is left. To create groups of size 3, we will pick the shortest video ($$$m$$$) as the first element of the group, the longest video ($$$M$$$) as the last and for the middle one we choose the longest video of length $$$x$$$ such that $$$m+x&lt;k$$$. For groups of size 2, we pair the shortest video that is shorter than $$$k$$$ with the longest video. We can simulate this greedy process with a tree data structure (e.g. multiset in C++) to solve the problem in $$$O(n \log n)$$$.</p><p>Let's prove that this greedy approach gives us an optimal solution.</p><ul><li> We can consider a version of the problem where we can choose to watch an ad early if we wish. The optimal solution will be equivalent to the original problem with forced ads. This is because we can move an ad (that we watched early) forward as much as possible and the number of groups in the following videos can't be larger by induction on the number of viewed ads.</li><li> If the optimal solution contains a group of size 2 or 3, there is a solution that contains the shortest and longest video in the same group. If there wasn't, we can swap the longest video overall with the last video in the group of the shortest one (without affecting the number of groups).</li><li> If it's possible to create a group of size 3, there exists an optimal solution with such group. Indeed, suppose there is an optimal solution without such group. Clearly all groups can't be of size 1 in an optimal solution so there must be at least one group of size 2. We know there is a solution with a group of size 2 containing the shortest and longest video. If it's possible to insert a third video, the solution can't degrade.</li><li> If it's possible to construct a group of size 3, it can consist of the shortest ($$$m$$$) and longest ($$$M$$$) video in the first and last place, respectively. For the second video we can greedily choose the longest available video $$$x$$$ such that $$$m+x&lt;k$$$ to avoid triggering an early ad. We can prove that a greedy choice is valid with a similar swap argument as before.</li><li> If it's not possible to construct groups of size 3, and it's possible to create a group of size 2, then there exists an optimal solution with at least a group of size 2. Otherwise, we would have only groups of size 1 and merging two directly decreases the number of groups.</li><li> If it's not possible to construct groups of size 3, and it's possible to construct a group of size 2, then there exists an optimal solution where the shortest video is paired with the longest video. This can again be proved with a swap argument.</li></ul></div></div></div></div></div></div> <ul>   <li>D: Author: <a class="rated-user user-orange" href="/profile/Jorke" title="Master Jorke">Jorke</a>, Prepared by: <a class="rated-user user-orange" href="/profile/Jorke" title="Master Jorke">Jorke</a></li> </ul> <div class="spoiler"><b class="spoiler-title">Open</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2068/problem/D" title="European Championship 2025 - Online Mirror (Unrated, ICPC Rules, Teams Preferred)">2068D - Morse Code</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Any assignment of Morse codes to characters can be represented with a binary tree, where going to a left child appends a dot and going to a right child appends a dash. We then associate each character with a leaf in the tree. This ensures that the codes will not be prefixes of each other.</p><p>Each vertex, both leafs and internal vertices, has a depth in the tree. For this depth to correspond to the length of the associated Morse code, we declare that going to a right child increases the depth by two. Once we know what an optimal binary tree looks like, we can greedily match the characters to the leafs by assigning the most frequent characters to the leafs with the smallest depth.</p><p>The key observation is that we initially do not need to know what exactly the tree looks like. We only need to know how many leafs and internal vertices exist at each depth. This allows us to use dynamic programming (DP) to determine an optimal tree bottom up. In each state, we keep track of: </p><ul> <li> $$$v_c$$$, the number of vertices at the current depth level, where we can still decide whether they become leafs or internal vertices. </li><li> $$$v_n$$$, the number of vertices at the next (deeper) depth level, where we can still decide whether they become leafs or internal vertices. </li><li> $$$a$$$, the number of characters that have already been assigned a value </li></ul> The value of this state is how much the expected transmission length increases due to dashes and dots that correspond to edges at the current level or deeper.<p>The base state is $$$DP[0,0,0] = 0$$$, since transmitting nothing costs nothing. The value we want to know is $$$DP[1,0,n]$$$, the cost to transmit all characters from depth zero where we only have a root vertex.</p><p>The transition function is a minimum of two values. To determine $$$DP[v_c,v_n,a]$$$, we can either make a vertex a leaf and assign a character to it, or we can determine that we do not want anymore leafs at this depth by splitting all remaining vertices into two new vertices and going to the next depth. In the first case, this results in the value $$$DP[v_c-1,v_n,a-1]$$$ with no additional costs. In the second case, this results in the value $$$DP[v_n+v_c,v_c,a]$$$ plus the sum of the frequencies of the least frequent $$$a$$$ characters; the cost is caused by the fact that these characters are now placed one level deeper.</p><p>Finally, there are some boundary conditions where we assign the value infinity. If $$$v_c = v_n = 0$$$ and $$$a &gt; 0$$$ the state is unsolvable since there are some unassigned characters left but no more leafs can be created. If $$$v_c + v_n &gt; a$$$ then the state is trivially suboptimal since we will then obtain more leafs then needed.</p><p>After completing the DP, the final step is to actually construct an optimal tree. This can be done greedily by keeping track of two vectors of partial codes (one for the current depth, one for the next one) and backtracking through the DP.</p><p>Each parameter in the state description is bounded by $$$n$$$ and the transition function is constant, so overall this results in an $$$O(n^3)$$$ algorithm.</p></div></div></div></div></div></div> <ul>   <li>E: Author: <a class="rated-user user-orange" href="/profile/gangsterveggies" title="Master gangsterveggies">gangsterveggies</a>, Prepared by: <a class="rated-user user-orange" href="/profile/gangsterveggies" title="Master gangsterveggies">gangsterveggies</a></li> </ul> <div class="spoiler"><b class="spoiler-title">Open</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2068/problem/E" title="European Championship 2025 - Online Mirror (Unrated, ICPC Rules, Teams Preferred)">2068E - Porto Vs. Benfica</a></h3><div class="ttypography"><div class="problem-statement"><div><p>We start by making a few definitions that will help us:</p><p><span class="tex-font-style-bf">Definition.</span> Denote by $$$f(v)$$$ the minimum number of roads the supporters' club needs to travel if they start from vertex $$$v$$$ and want to end up at vertex $$$n$$$, and the police can still block exactly one road.</p><p>So $$$f(1)$$$ is the answer to the problem and $$$f(n) = 0$$$.</p><p><span class="tex-font-style-bf">Definition.</span> Denote by $$$g(v, \, e)$$$ the shortest path from $$$v$$$ to vertex $$$n$$$ that doesn't use edge $$$e$$$ and $$$g(v)$$$ as the maximum of $$$g(v, \, e)$$$ for all edges $$$e$$$ adjacent to $$$v$$$.</p><p>In other words, $$$g(v)$$$ is the shortest path from $$$v$$$ to $$$n$$$ that doesn't use the edge that leads to the shortest path from $$$v$$$ to $$$n$$$. Now we have the following:</p><p><span class="tex-font-style-bf">Lemma.</span> $$$f(v) = \max\{g(v), \, 1 + \min_{v \sim u} f(u)\}$$$, where $$$v \sim u$$$ denotes that the two vertices are adjacent.</p><p><span class="tex-font-style-it">Proof.</span> It's easy to see that the police only block an edge when the supporters' club is on a vertex adjacent to that edge; otherwise, they could have waited until they were adjacent to that edge to block it. So, when the supporters' club is at some vertex $$$v$$$, the police have two choices (and they want to pick the one that maximizes the number of traversed roads): either block some edge adjacent to $$$v$$$, or not block any edge and let the supporters' club decide where to go. If they decide to block road $$$e$$$, then the supporters' club takes $$$g(v, \, e)$$$ roads to reach $$$n$$$, so the police might as well pick $$$g(v)$$$ to maximize this. If they decide not to block a road, the number of roads is $$$1$$$ plus $$$f(u)$$$, where $$$u$$$ is the vertex the supporters' club ends up at. Since they want to minimize the number of roads taken, they best pick $$$u$$$ that minimizes $$$f(u)$$$.</p><p>Note that the values of $$$g$$$ can easily be found in $$$O(m^2)$$$ time, by running a BFS per vertex $$$v$$$. This is too slow to solve this problem, so we will see later how to compute $$$g$$$ more efficiently, which is the trickiest part. But first, let's see how to find efficiently the values of $$$f$$$ assuming we have already computed $$$g$$$.</p><p><span><span class="tex-font-style-bf">Computing $$$f$$$ assuming we know $$$g$$$</span></span></p><p>To find $$$f$$$, we can use a greedy algorithm that works exactly the same way as Dijkstra's algorithm. Consider an array $$$\texttt{f}[]$$$ that we will use to store the values of $$$f$$$. Set $$$\texttt{f}[n] = 0$$$ and $$$\texttt{f}[v] = g(v)$$$ for all other $$$v$$$. Now process each vertex in the following way. Pick the unprocessed vertex $$$v$$$ with the lowest current value of $$$\texttt{f}[v]$$$. Process $$$v$$$ by iterating through all vertices $$$u$$$ adjacent to $$$v$$$ and setting $$$\texttt{f}[v] = \max(g[v], \, \min(1 + \texttt{f}[u]))$$$. Intuitively, this processing step amounts to applying the formula of $$$f$$$ present in the lemma above, but considering only one pair of adjacent vertices at a time. To efficiently pick the unprocessed vertex $$$v$$$ with the lowest current value of $$$\texttt{}f[v]$$$, we can use a min-heap ordered by $$$\texttt{f}[v]$$$, which needs to be updated accordingly.</p><p>This algorithm runs in $$$O(m \log n)$$$ time, since we process each vertex once and for each vertex we look at its neighbors and potentially update the elements in a heap containing at most $$$n$$$ elements.</p><p><span class="tex-font-style-bf">Lemma.</span> After running the algorithm above, $$$\texttt{f}[v] = f(v)$$$.</p><p><span class="tex-font-style-it">Proof.</span> The correctness of this algorithm follows from an argument very similar to the correctness of Dijkstra's algorithm. The key observation is that if $$$v$$$ is an unprocessed vertex with the lowest current value of $$$\texttt{f}[v]$$$, then at this point we have that $$$\texttt{f}[v] = \max(g(v), \, 1 + \min(f(u)))$$$, where the minimum is over all $$$u$$$ that have been previously processed. Since $$$v$$$ has the lowest current value of $$$\texttt{f}[v]$$$, none of the remaining unprocessed vertices could increase the value of $$$\texttt{f}[v]$$$, which means that the current value of $$$\texttt{f}[v]$$$ is exactly $$$f(v)$$$.</p><p><span><span class="tex-font-style-bf">Computing $$$g$$$</span></span></p><p>Let's start with two quick definitions.</p><p><span class="tex-font-style-bf">Definition.</span> Denote by $$$\text{dist}(v, \, u)$$$ the distance between vertices $$$v$$$ and $$$u$$$ in the road network graph.</p><p><span class="tex-font-style-bf">Definition.</span> Let $$$b(v)$$$ be any neighbor of $$$v$$$ such that $$$\text{dist}(v, \, n) = 1 + \text{dist}(b(v), \, n)$$$, and break ties arbitrarily.</p><p>So, we can think of $$$g(v)$$$ as the distance from $$$v$$$ to $$$n$$$ that doesn't use the edge $$$\{v, \, b(v)\}$$$.</p><p>Consider the BFS tree from $$$n$$$, which is the same as saying the tree consisting of the edges given by $$$\{v, \, b(v)\}$$$ for all $$$v \neq n$$$, and root the tree on $$$n$$$. Observe that the path that corresponds to $$$g(v)$$$ has to necessarily be a path that uses at least one non-tree edge (otherwise it would be a path that uses $$$\{v, \, b(v)\}$$$, which is invalid). Furthermore, such a path will look like the following: start at $$$v$$$, go down the subtree rooted on $$$v$$$ some number of steps (potentially $$$0$$$), take one non-tree edge that ends in a vertex that isn't in the subtree rooted at $$$v$$$ and then take the shortest path from that vertex to $$$n$$$. Note that we can easily precompute the shortest path from any vertex to $$$n$$$ by running a single BFS from $$$n$$$.</p><p>To prove the above, note that once we are outside of the subtree rooted at $$$v$$$ we are free to take the shortest path to $$$n$$$ since it won't use the $$$\{v, \, b(v)\}$$$ edge. Additionally, note that we don't want to ever take a non-tree edge to end up at another vertex in the subtree of $$$v$$$, since we can always take the tree path and that will always be at most as short (by definition of BFS tree).</p><p>So we are left with computing for each $$$v$$$ the shortest among all paths that take some number of steps down the tree, then takes some non-tree edge, and then takes the shortest path to $$$n$$$. Let's first see an inefficient way of doing to, and then we'll make it efficient.</p><p>For each vertex $$$v$$$, compute a list of all the paths of the desired form, and store this in a set (so each vertex gets a set). In particular, we store pairs of two things in this set: the distance to $$$n$$$ of the corresponding path, the endpoint of the non-tree edge we are taking. We can do so recursively (in a DFS fashion), so let's start by considering the leaves of the tree.</p><p>If $$$v$$$ is a leaf, then the path can't go down the tree, so it is of the form "take some non-tree edge and then take the shortest path to $$$n$$$". For each non-tree edge $$$\{v, \, u\}$$$, add the pair $$$(1 + \text{dist}(u), \, u)$$$ to the set. So now we know that $$$g(v)$$$ is the minimum element in the set.</p><p>If $$$v$$$ isn't a leaf, first recursively compute the distances of all of the children of $$$v$$$. Initialize the set corresponding to $$$v$$$ by going through each non-tree edge $$$\{v, \, u\}$$$, and adding the pair $$$(1 + \text{dist}(u), \, u)$$$. Now "merge" this set with all the sets of all of $$$v$$$'s children. To merge two sets, we take all pairs $$$(d, \, u)$$$ of the children sets and add $$$(d + 1, \, u)$$$ to $$$v$$$'s set, which corresponds to extending each path from each of the children by taking the edge from $$$v$$$ to them. Suppose the minimum element is $$$(d, \, u)$$$. Then $$$u$$$ could be in the subtree rooted at $$$v$$$, which is an invalid path. If that's the case, we delete $$$(d, \, u)$$$ from the set and keep deleting the top element until we find one which isn't in the subtree of $$$v$$$. Note that this doesn't affect the computation of ancestors of $$$v$$$ since $$$u$$$ would be in their subtree too. To determine whether $$$u$$$ is in the subtree of $$$v$$$ we can use DSU (Disjoint Set Union). Initially, all vertices are their own set, and as we go down the tree we merge $$$v$$$ with its children. Like before, now we know that $$$g(v)$$$ is the minimum element in the remaining set.</p><p>We are almost done, but there is one inefficient step here: merging the sets of the children of $$$v$$$ could take $$$O(n)$$$ time since each set could have up to $$$n$$$ elements. To implement this step efficiently, we can do "small-to-large merging", just like the union by size merge in a DSU data structure. When merging two sets, don't touch the largest of the two, and copy the elements of the smallest one into the largest one. However, recall that when merging two sets, we take all pairs $$$(d, \, u)$$$ of the children sets and add $$$(d + 1, \, u)$$$ to $$$v$$$'s set, so we need to potentially alter the elements in the largest set if this is one of the children's sets. We can do this by assuming that each set comes with a "modifier", which is an integer $$$m$$$ such that if we have an element $$$(d, \, u)$$$ in the set, the real distance is $$$d + m$$$. Intuitively, this modifier acts as a "lazy propagator", so that we don't have to actually change the elements in the children's sets. When we take a set from a child, we first increment its modifier, and then merge its set with $$$v$$$'s set.</p><p>The total running time of this step is $$$O(n \log^2 m)$$$, since the small-to-large merge makes sure we only move an element between sets $$$O(\log m)$$$ times, and each move costs $$$O(\log m)$$$.</p></div></div></div></div></div></div> <ul>   <li>F: Author: <a class="rated-user user-red" href="/profile/dario2994" title="International Grandmaster dario2994">dario2994</a>, Prepared by: <a class="rated-user user-red" href="/profile/dario2994" title="International Grandmaster dario2994">dario2994</a></li> </ul> <div class="spoiler"><b class="spoiler-title">Open</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2068/problem/F" title="European Championship 2025 - Online Mirror (Unrated, ICPC Rules, Teams Preferred)">2068F - Mascot Naming</a></h3><div class="ttypography"><div class="problem-statement"><div><p>This problem requires constructing a string that contains each of the given strings $$$s_1, s_2, \dots, s_n$$$ as subsequences but does not contain $$$t$$$ as a subsequence.</p><p><span class="tex-font-style-bf">Key Observation.</span> If $$$t$$$ is a subsequence of any $$$s_i$$$, then any string containing $$$s_i$$$ as a subsequence must also contain $$$t$$$. In this case, the answer is $$$\texttt{NO}$$$. Otherwise, we can construct a valid string using a greedy approach.</p><p><span class="tex-font-style-bf">Checking for Subsequences.</span> Before solving the main problem, we describe a simple method to check if a string $$$b$$$ is a subsequence of another string $$$a$$$. We iterate through $$$a$$$, trying to match its characters to $$$b$$$ in order: </p><ul> <li> If the first characters of $$$a$$$ and $$$b$$$ match, remove the first character from both. </li><li> Otherwise, remove only the first character from $$$a$$$. </li><li> Repeat until $$$a$$$ is empty. </li><li> If $$$b$$$ becomes empty, it was a subsequence of $$$a$$$; otherwise, it was not. </li></ul><p><span class="tex-font-style-bf">Constructing the Answer.</span> We build the answer string $$$\mathrm{ans}$$$ by appending characters one by one. Initially, $$$\mathrm{ans}$$$ is empty. We repeat the following steps until all $$$s_i$$$ are empty: </p><ul> <li> If there exists a character $$$c$$$ such that at least one $$$s_i$$$ starts with $$$c$$$ and $$$t$$$ does not start with $$$c$$$, append $$$c$$$ to $$$\mathrm{ans}$$$ and remove the first character from all $$$s_i$$$ that start with $$$c$$$. </li><li> Otherwise, all $$$s_i$$$ start with the same character as $$$t$$$. Append this character to $$$\mathrm{ans}$$$ and remove the first character from all $$$s_i$$$ and $$$t$$$. </li></ul><p>At the end of this process, $$$\mathrm{ans}$$$ contains all $$$s_i$$$ as subsequences.</p><p>Let us understand why $$$t$$$ is not a subsequence of $$$\mathrm{ans}$$$. Let $$$s_i$$$ be the last string to become empty during the process. Consider the steps taken for $$$s_i$$$ and $$$t$$$ alone. The sequence of character deletions mirrors the subsequence checking algorithm. Since $$$t$$$ is not a subsequence of $$$s_i$$$, it remains non-empty at the end, ensuring that $$$t$$$ is not a subsequence of $$$\mathrm{ans}$$$ either.</p><p>Thus, if $$$t$$$ is not a subsequence of any $$$s_i$$$, the algorithm constructs a valid $$$\mathrm{ans}$$$, and the answer is $$$\texttt{YES}$$$.</p><p>The solution described is linear in the total length of all strings given in input.</p></div></div></div></div></div></div> <ul>   <li>G: Author: <a class="rated-user user-red" href="/profile/dario2994" title="International Grandmaster dario2994">dario2994</a>, Prepared by: <a class="rated-user user-red" href="/profile/dario2994" title="International Grandmaster dario2994">dario2994</a></li> </ul> <div class="spoiler"><b class="spoiler-title">Open</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2068/problem/G" title="European Championship 2025 - Online Mirror (Unrated, ICPC Rules, Teams Preferred)">2068G - A Very Long Hike</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Before diving into the solution, let us make a few key observations to build intuition for tackling the problem.</p><ul> <li> Our goal is to count the number of distinct cells that can be reached within a time limit of $$$10^{20}$$$. To gain insight into this, consider first the simpler question: given a distant cell $$$(x, y)$$$ (where $$$x, y$$$ are large), how can we estimate the shortest time required to reach it from the origin? </li><li> Since we do not need an exact answer but only a sufficiently precise approximation, we can reframe the previous question: how can we efficiently approximate the distance from the origin to $$$(x, y)$$$? </li><li> Consider any path from $$$(0,0)$$$ to $$$(x, y)$$$. If this path visits the same position modulo $$$n$$$ at both the $$$i$$$-th and $$$j$$$-th steps, then removing the portion of the path between these two steps does not change the total cost of the remaining path. </li></ul><p>The last observation is particularly powerful and will be crucial in approximating distances efficiently. We will leverage it to resolve the subproblem identified in the first two observations.</p><p>Afterward, we will use this approximation to count (approximately) the number of reachable cells within the given time constraint.</p><p>Finally, we will describe how to translate these results into an algorithm with time complexity $$$O(n^5)$$$.</p><p>It is worth noting that this editorial is relatively long because we rigorously prove that our approximations maintain a relative error smaller than $$$10^{-6}$$$. However, in practice, we expect that any reasonable implementation with sufficient numerical precision will be far more accurate than required. As such, contestants do not need to be overly concerned about precision.</p><p>Lastly, many of the statements we prove here are significantly easier to intuit than to rigorously justify. We recommend that readers focus on understanding the core ideas on their first read and not get too caught up in the technical details. If you grasp the reasoning behind Lemma 5 and Lemma 6, you should already have the essential insights needed to solve the problem. </p><p> <span><span class="tex-font-style-bf">Approximating the distance</span></span></p><p>Let us denote by $$$D := 1545+1$$$ the maximum distance between two adjacent cells (i.e., the maximum altitude difference plus one). </p><p>For any integers $$$i, j$$$ with $$$|i|+|j| \le n$$$, let $$$t$$$ be the minimum number such that, for some $$$(a, b)$$$, the distance from $$$(a, b)$$$ to $$$(a+in, b+jn)$$$ is $$$t$$$. Define $$$T(i, j):=t/n$$$. This captures the idea that moving by $$$(i, j)$$$ costs $$$T(i, j)$$$.</p><p>For any $$$x, y$$$, we define $$$f(x, y)$$$ as the infimum of $$$\sum_{|i|+|j|\le n} \lambda_{ij}T(i, j)$$$, for any nonnegative real numbers $$$\lambda_{ij}\ge 0$$$, under the constraint that $$$\sum_{|i|+|j| \le n}\lambda_{ij}(i, j) = (x, y)$$$. Observe that $$$|x|+|y|\le f(x, y)\le D(|x|+|y|)$$$.</p><p><span class="tex-font-style-bf">Lemma 1.</span> For any cell $$$(x, y)$$$ such that both coordinates are divisible by $$$n$$$, we have $$$$$$ \text{dist}((0, 0), (x, y)) \ge f(x, y). $$$$$$</p><p><span class="tex-font-style-it">Proof.</span> We show it by induction on the distance from $$$(0, 0)$$$ to $$$(x, y)$$$.</p><p>Consider a shortest path from $$$(0, 0)$$$ to $$$(x, y)$$$. Since $$$(0, 0)\equiv(x, y) \pmod{n}$$$, we can consider the two closest cells $$$(x_1, y_1)$$$ and $$$(x_2, y_2)$$$ along the path such that $$$(x_1, y_1)\equiv(x_2, y_2) \pmod{n}$$$. Let $$$(x', y') = (x_2-x_1, y_2-y_1)$$$. By construction, the segment of the path from $$$(x_1, y_1)$$$ to $$$(x_2, y_2)$$$ contains no two positions (besides the endpoints) that are congruent modulo $$$n$$$, so it must have at most $$$n^2$$$ steps. Thus, we obtain $$$|x'|+|y'|\le n^2$$$.</p><p>Using our third key observation from the introduction, we deduce that $$$$$$ \text{dist}((0, 0), (x, y)) = \text{dist}((x_1, y_1), (x_2, y_2)) + \text{dist}((0, 0), (x-x', y-y')). $$$$$$ By the definition of $$$T$$$, we obtain $$$$$$ \text{dist}((x_1, y_1), (x_2, y_2)) \ge n T(x'/n, y'/n). $$$$$$ By the induction hypothesis, we also have $$$$$$ \text{dist}((0, 0), (x-x', y-y')) \ge f(x-x', y-y') .$$$$$$ Combining these inequalities, we conclude $$$$$$ \text{dist}((0, 0), (x, y)) \ge n T(x'/n, y'/n) + f(x-x', y-y') \ge f(x, y). $$$$$$</p><p><span class="tex-font-style-bf">Lemma 2.</span> For any cell $$$(x, y)$$$, we have $$$$$$ \text{dist}((0, 0), (x, y)) \ge f(x, y) - 2Dn. $$$$$$</p><p><span class="tex-font-style-it">Proof.</span> Let $$$(\bar x, \bar y)$$$ be a cell such that its coordinates are divisible by $$$n$$$ and the Manhattan distance from $$$(x, y)$$$ to $$$(\bar x, \bar y)$$$ is $$$\le n$$$. We have $$$$$$ \text{dist}((0, 0), (x, y)) \ge \text{dist}((0, 0), (\bar x, \bar y)) - \text{dist}((\bar x, \bar y), (x, y)) \ge f(\bar x, \bar y) - Dn . $$$$$$ Furthermore, observe that $$$$$$ f(x, y) \le f(\bar x, \bar y) + f(x-\bar x, y-\bar y) \le f(\bar x, \bar y) + T(x-\bar x, y-\bar y) \le f(\bar x, \bar y) + Dn . $$$$$$ Joining the last two inequalities, we infer, $$$$$$ \text{dist}((0, 0), (x, y)) \ge f(x, y) - 2Dn. $$$$$$</p><p>We have shown that $$$f$$$ provides a lower bound for the distance of $$$(x, y)$$$ to the origin. Now we turn to proving that it provides an upper bound.</p><p><span class="tex-font-style-bf">Lemma 3.</span> Fix a nonnegative integer $$$k\ge 0$$$ and two integers $$$i, j$$$ with $$$|i|+|j|\le n$$$. For any cell $$$(x, y)$$$, we have $$$$$$ \text{dist}((x, y), (x, y) + k(in, jn)) \le kn T(i, j) + 2Dn. $$$$$$</p><p><span class="tex-font-style-it">Proof.</span> Without loss of generality, we may assume that $$$(x, y) = (0, 0)$$$.</p><p>By definition of $$$T(i, j)$$$, there exists $$$(a, b)$$$ such that $$$\text{dist}((a, b), (a, b) + (in, jn))=T(i, j)$$$. Without loss of generality, we may assume that $$$|a|+|b|\le n$$$.</p><p>Consider the path that goes from $$$(0, 0)$$$ to $$$(a, b)$$$, then to $$$(a, b) + k(in, jn)$$$ repeating $$$k$$$ times the path that defines $$$T(i, j)$$$, and finally from $$$(a, b)+k(in, jn)$$$ to $$$k(in, jn)$$$. The total length of this path is at most $$$Dn + kn T(i, j) + Dn$$$ as desired.</p><p>Now that we have seen in which cases $$$T$$$ provides an upper bound, we deduce how $$$f$$$ always provides an upper bound. One can show (it follows from the argument in the next section of this editorial) that the value of $$$f$$$ does not change if we require that at most two values of $$$\lambda_{ij}$$$ are nonzero. </p><p><span class="tex-font-style-bf">Lemma 4.</span> For any cell $$$(x, y)$$$, we have $$$$$$ \text{dist}((0, 0), (x, y)) \le f(x, y) + 2Dn(n+1). $$$$$$</p><p><span class="tex-font-style-it">Proof.</span> Let $$$(x, y) = a(i, j) + a'(i', j')$$$ so that $$$a,a'\ge 0$$$ and $$$f(x, y) = aT(i, j) + a'T(i', j')$$$. Consider the cell $$$$$$ (\bar x, \bar y) := \big\lfloor a/n \big\rfloor (in, jn) + \big\lfloor a'/n \big\rfloor (i'n, j'n). $$$$$$ Thanks to the previous lemma, we have $$$$$$ \text{dist}((0, 0), (\bar x, \bar y)) \le \big\lfloor a/n \big\rfloor n T(i, j) + \big\lfloor a'/n \big\rfloor n T(i', j') \le f(x, y) + 2Dn. $$$$$$ Since the Manhattan distance from $$$(\bar x, \bar y)$$$ to $$$(x, y)$$$ is at most $$$2n^2$$$, we deduce that $$$$$$ \text{dist}((0, 0), (x, y)) \le \text{dist}((0, 0), (\bar x, \bar y)) + \text{dist}((\bar x, \bar y), (x, y)) \le f(x, y) + 2Dn + 2n^2D. $$$$$$</p><p>The results of this section can be summarized in the following statement.</p><p><span class="tex-font-style-bf">Lemma 5.</span> For any cell $$$(x, y)$$$, we have $$$$$$ f(x, y) - 2Dn \le \text{dist}((0, 0), (x, y)) \le f(x, y) + 2Dn(n+1) . $$$$$$ </p><p> <span><span class="tex-font-style-bf">Counting the cells with distance $$$\le R$$$</span></span></p><p>Let $$$R=10^{20}$$$. Our goal is to count the number of cells $$$(x, y)$$$ with $$$\text{dist}((0, 0), (x, y))\le R$$$. Let $$$q(r)$$$ be the number of cells $$$(x, y)$$$ with $$$f(x, y)\le r$$$. In view of <span class="tex-font-style-bf">Lemma 5</span>, we have (setting $$$R_1 := R-2Dn(n+1)$$$ and $$$R_2:=R+2Dn$$$), $$$$$$ q(R_1) \le \#\{(x, y): \text{dist}((0, 0), (x, y)) \le R \} \le q(R_2) . \quad (\ast) $$$$$$ Our plan is to first compute $$$q(r)$$$, and then to show that the relative discrepancy between $$$q(R_1)$$$ and $$$q(R_2)$$$ is small enough. In order to fully understand the behavior of $$$q(r)$$$ we must investigate better how to compute the function $$$f(x, y)$$$. We are going to make some algebraic manipulations that transform the computation of $$$f$$$ into finding whether a point belongs to a convex polygon.</p><p>Recall that $$$f(x, y)$$$ is defined as $$$$$$ \inf\left\{\sum_{|i|+|j|\le n} \lambda_{ij}T(i, j):\, \lambda_{ij}\ge 0\text{ and } \sum_{|i|+|j|\le n} \lambda_{ij}(i, j) = (x, y)\right\} . $$$$$$ Observe that this formula is equivalent to (for $$$(x, y)\not=0$$$) $$$$$$ \inf\left\{\sum_{|i|+|j|\le n} \mu_{ij}:\, \mu_{ij}\ge 0\text{ and } \sum_{|i|+|j|\le n} \mu_{ij}\left(\frac{i}{T(i,j)}, \frac{j}{T(i,j)}\right) = (x, y)\right\} . $$$$$$ Define $$$p_{ij}:= \left(\frac{i}{T(i,j)}, \frac{j}{T(i,j)} \right)$$$. The latter formula is equivalent to $$$$$$ \inf\left\{t\ge 0:\, \text{there are }\mu_{ij}\ge 0\text{ with } \sum_{|i|+|j|\le n}\mu_{ij} \le 1\text{ such that } \sum_{|i|+|j|\le n} \mu_{ij}p_{ij} = \frac1t(x, y)\right\} . $$$$$$</p><p>Let $$$P$$$ be the convex hull of the points $$$p_{ij}$$$. We have proven that $$$f(x, y)$$$ is the minimum value $$$t\ge 0$$$ such that $$$(x/t, y/t)$$$ belongs to $$$P$$$. Therefore, we have proven that</p><p><span class="tex-font-style-bf">Lemma 6.</span> Let $$$P$$$ be the convex hull of the points $$$p_{ij}:= \left(\frac{i}{T(i,j)}, \frac{j}{T(i,j)}\right)$$$. For any $$$r&gt;0$$$, the number of lattice points in $$$rP$$$ (here, $$$rP$$$ represents the scaling of $$$P$$$ by a factor $$$r$$$) coincides with $$$q(r)$$$. </p><p>So, it remains only to (approximately) compute the lattice points inside $$$rP$$$. The standard way to approximate the number of lattice points in a convex subset is by computing the area of the subset. Let us check that it is precise enough in our setting. For any convex polygon, we have</p><p><span class="tex-font-style-bf">Lemma 7.</span> Let $$$P$$$ be an arbitrary convex polygon. We have $$$$$$ \text{area}(P) - \text{perimeter}(P) - \pi \le \#\{(x, y)\in P: \, x,y\text{ are integers}\} \le \text{area}(P) + \text{perimeter}(P) + \pi. $$$$$$</p><p><span class="tex-font-style-it">Proof.</span> Denote by $$$d(x, X)$$$ the Euclidean distance between a point $$$x$$$ and a subset $$$X$$$ of the plane. For $$$r&gt;0$$$, let $$$P_r$$$ be the <span class="tex-font-style-underline">enlargement</span> of $$$P$$$ given by $$$\{p: d(p, P)\le r\}$$$. For $$$r&lt;0$$$, let $$$P_r$$$ be the <span class="tex-font-style-underline">reduction</span> of $$$P$$$ given by $$$\{p: d(p, P^c) &gt; r\}$$$. Observe that if $$$r_1, r_2$$$ have the same sign, then $$$(P_{r_1})_{r_2} = P_{r_1+r_2}$$$.</p><p>Consider the disjoint squares centered at all lattice points in $$$P$$$. We have $$$$$$ P_{-\frac1{\sqrt2}} \subseteq [-0.5, 0.5)\times[-0.5,0.5) + \{(x, y)\in P:\, x, y\text{ integers}\} \subseteq P_{\frac1{\sqrt2}}. $$$$$$ By taking the area of these three domains, we obtain $$$$$$ \text{area}\left(P_{-\frac1{\sqrt2}}\right) \le \#\{(x, y)\in P:\, x, y\text{ integers}\} \le \text{area}\left(P_{\frac1{\sqrt2}}\right). $$$$$$ Thus, we have reduced the problem to estimating the area of $$$P_r$$$ for $$$r$$$ positive and negative. The estimates necessary to conclude the current lemma are proven in the next lemma. We don't need the lower bound on the perimeter and the upper bound on the area for $$$r&lt;0$$$ that are stated in the next lemma; we decided to include them for completeness.</p><p><span class="tex-font-style-bf">Lemma 8.</span> For $$$r&gt;0$$$, we have $$$$$$ \text{perimeter}(P_r) = \text{perimeter}(P) + 2\pi r,\quad \text{area}(P_r) = \text{area}(P) + r\cdot\text{perimeter}(P) + \pi r^2, $$$$$$ while for $$$r&lt;0$$$, we have $$$$$$ 2\sqrt{\pi}\sqrt{\text{area}(P_r)}\le \text{perimeter}(P_r) \le \text{perimeter}(P),\quad \text{area}(P) + r\cdot\text{perimeter}(P) - \pi r^2 \le \text{area}(P_r) \le \pi (R+r)^2 ,$$$$$$ where $$$R&gt;0$$$ is such that $$$\text{area}(P)=\pi R^2$$$.</p><p><span class="tex-font-style-it">Proof.</span> Let us observe that, for any $$$r$$$, $$$\frac{d}{dr}\text{area}(P_r)=\text{perimeter}(P_r)$$$. The formulas for the area follow from those for the perimeter using this differential equation. The formula for the perimeter when $$$r&gt;0$$$ is left to the reader. For $$$r&lt;0$$$, since $$$P_r\subseteq P$$$ we deduce $$$\text{perimeter}(P_r)\le \text{perimeter}(P)$$$ and the lower bound for $$$\text{perimeter}(P_r)$$$ is the isoperimetric inequality.</p><p>Concatenating Lemma 6 and Lemma 7 together with $$$(\ast)$$$, we have $$$$$$ R_1^2 \text{area}(P)-R_1\text{perimeter}(P)-\pi \le \#\{(x, y): \text{dist}((0, 0), (x, y)) \le R \} \le R_2^2 \text{area}(P)+R_2\text{perimeter}(P)+\pi. $$$$$$ If the right-hand side over the left-hand side is smaller than $$$1+10^{-6}$$$, a correct answer to the problem is given by $$$R^2\text{area}(P)$$$. In order to show it, we shall prove that the perimeter of $$$P$$$ is not disproportionately larger than the area of $$$P$$$. (One could prove a stronger lemma, showing that the ratio between perimeter and area is $$$O(D)$$$ instead of $$$O(D^2)$$$, but it is harder to show and we don't need it.)</p><p><span class="tex-font-style-bf">Lemma 9.</span> We have $$$\text{perimeter}(P) \le 4 D^2\text{area}(P)$$$ and also $$$\text{area}(P) \ge 2D^{-2}$$$.</p><p><span class="tex-font-style-it">Proof.</span> By definition of $$$P$$$, it is not hard to check that $$$$$$ \{(x, y): |x|+|y| \le D^{-1}\} \subseteq P \subseteq \{(x, y): |x|+|y| \le 1\} . $$$$$$ In particular, we deduce that $$$\text{perimeter}(P)\le 4\sqrt{2} \le 8$$$ and $$$\text{area}(P)\ge 2D^{-2}$$$.</p><p>Thanks to this lemma, we obtain $$$$$$ (R_1^2-4D^2 R_1-2D^2) \text{area}(P) \le \#\{(x, y): \text{dist}((0, 0), (x, y)) \le R \} \le (R_2^2 + 4D^2R_2 + 2D^2) \text{area}(P). $$$$$$</p><p>Given the constraints of the problem, one can check that $$$$$$ \frac{R_2^2 + 4D^2R_2 + 2D^2}{R_1^2-4D^2 R_1-2D^2} &lt; 1 + 10^{-12}, $$$$$$ so a correct answer to this problem is given by $$$R^2\cdot\text{area}(P)$$$. </p><p> <span><span class="tex-font-style-bf">Computing the polygon $$$P$$$ fast enough</span></span></p><p>Solving the problem is straightforward once we have computed $$$T(i, j)$$$ for the $$$O(n^2)$$$ pairs $$$(i, j)$$$ such that $$$|i|+|j|\le n$$$. Indeed, once we have these values: </p><ul> <li> We can compute the family of points $$$p_{ij}$$$ in $$$O(n^2)$$$. </li><li> We can compute its convex hull in $$$O(n^2\log(n))$$$. </li><li> Finally, computing the area of the resulting polygon is straightforward. </li></ul><p>To compute $$$T(i, j)$$$ for all $$$i, j$$$ with $$$|i|+|j|\le n$$$, a naive approach would be: </p><ul> <li> Iterate over all $$$O(n^2)$$$ interesting pairs $$$(i, j)$$$. </li><li> For each such pair, iterate over all $$$O(n^2)$$$ interesting pairs $$$(a, b)$$$. </li><li> Compute the distance between $$$(a, b)$$$ and $$$(a+in, b+jn)$$$ using Dijkstra's algorithm, which takes $$$O(n^4\log(n))$$$. </li></ul><p>This results in a total complexity of $$$O(n^8\log(n))$$$, which is too slow.</p><p><span class="tex-font-style-it">Optimization 1: Batch processing in Dijkstra.</span> Instead of computing $$$T(i, j)$$$ separately for each pair, we observe that once $$$(a, b)$$$ is fixed, we can compute the answer for all relevant $$$(i, j)$$$ in one run of Dijkstra's algorithm. This reduces the complexity to $$$O(n^6\log(n))$$$, which is still likely too slow. Let us remark that, when running Dijkstra's algorithm, we can completely ignore all cells at a Manhattan distance greater than $$$n^2$$$ from $$$(a, b)$$$. This is because we are only interested in paths where no two points share the same position modulo $$$n$$$. Otherwise, the path could be decomposed into multiple shorter segments, each obeying this property.</p><p><span class="tex-font-style-it">Optimization 2: Reducing the search space using modulo $$$n$$$ properties.</span> A key observation is that any path whose endpoints are equivalent modulo $$$n$$$ must contain a cell where at least one coordinate is divisible by $$$n$$$. Thus, we may assume that either $$$a$$$ or $$$b$$$ is $$$0$$$. This reduces the complexity to $$$O(n^5\log(n))$$$, which might be sufficient to get accepted.</p><p><span class="tex-font-style-it">Optimization 3: Removing the logarithmic factor.</span> To further improve performance, note that the maximum weight is $$$D$$$. We can replace Dijkstra's priority queue with a bucket-based shortest path algorithm (similar to 0-1 BFS). This reduces the complexity per Dijkstra run to $$$O(n^5 + D)$$$.</p></div></div></div></div></div></div> <ul>   <li>H: Author: <a class="rated-user user-red" href="/profile/dario2994" title="International Grandmaster dario2994">dario2994</a> and <a class="rated-user user-orange" href="/profile/Giove" title="Master Giove">Giove</a>, Prepared by: <a class="rated-user user-orange" href="/profile/Giove" title="Master Giove">Giove</a></li> </ul> <div class="spoiler"><b class="spoiler-title">Open</b><div class="spoiler-content" style="display: none;"><div class="problemTutorial" problemcode="2068H">Tutorial is loading...</div></div></div> <ul>   <li>I: Author: <a class="rated-user user-red" href="/profile/bicsi" title="Grandmaster bicsi">bicsi</a>, Prepared by: <a class="rated-user user-red" href="/profile/bicsi" title="Grandmaster bicsi">bicsi</a></li> </ul> <div class="spoiler"><b class="spoiler-title">Open</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2068/problem/I" title="European Championship 2025 - Online Mirror (Unrated, ICPC Rules, Teams Preferred)">2068I - Pinball</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Let's decompose the whole grid into regions delimited by the movement of the ball without altering the walls. These regions are depicted in the picture below by colored lines. The path described by the solution is bolded.</p><center> <img class="tex-graphics" src="https://espresso.codeforces.com/c21cb44cc313ae74978173201a266a2f5a5c48dc.png" style="zoom: 75.0%;max-width: 100.0%;max-height: 100.0%;"> </center><p>Let's build a graph over the set of all regions where we add an edge $$$(i, j)$$$ if regions $$$i$$$ and $$$j$$$ share an oblique wall. In the picture above, the <span class="tex-font-style-bf">red</span> and <span class="tex-font-style-bf">blue</span> regions will be connected by an edge. Similarly, the <span class="tex-font-style-bf">blue</span> and <span class="tex-font-style-bf">purple</span> regions, as well as the <span class="tex-font-style-bf">blue</span> and <span class="tex-font-style-bf">green</span> regions and the <span class="tex-font-style-bf">red</span> and <span class="tex-font-style-bf">orange</span> regions are adjacent in this formulation.</p><p>Furthermore, let's compute the minimum distance between any of the two initial regions where the ball is located, and any of the regions that go outside the grid in this above described graph. Intuitively, this distance is a lower bound for our answer, as destroying $$$k$$$ walls can only let the ball travel to regions at distance at most $$$k$$$ from the initial regions. For a more formal proof, consider the relaxation of the problem where instead of destroying $$$k$$$ walls, we can choose $$$k$$$ walls and allow each of them to independently be <span class="tex-font-style-it">active</span> or <span class="tex-font-style-it">inactive</span> at any moment in time. Clearly, under this relaxation, the ball can only reach regions at distance at most $$$k$$$ from its initial position.</p><p>Next, we can prove that this lower bound is, in fact, the answer to our problem, by providing a construction that allows the ball to escape under this minimum number of destroyed walls. There are multiple ways of solving the reconstruction problem. The easiest is perhaps to first find any sequence of $$$k$$$ regions that end up with the ball escaping. Then, starting from the most distant ($$$k$$$-th) region, simulate the game in reverse order, and once you first reach the oblique wall that connects the $$$k$$$-th and $$$(k-1)$$$-th regions, "destroy" such wall (in reverse, the correct formulation is to "restore" the already-destroyed wall), and continue the process until the ball reaches its initial position.</p><p>Finally, an important aspect to quickly solve this problem is implementation. In order to simplify the implementation, one may skip constructing the graph described above and instead use it implicitly by keeping information over triplets of the form $$$(i, j, d)$$$ where $$$(i, j)$$$ is the position of the ball, and $$$d \in \{ \texttt{U}, \texttt{D}, \texttt{L}, \texttt{R} \}$$$ is the direction where the ball is heading, and using 0-1 BFS or even Dijkstra to compute the minimum number of walls that need to be destroyed to reach any such state.</p></div></div></div></div></div></div> <ul>   <li>J: Author: <a class="rated-user user-orange" href="/profile/cip999" title="Master cip999">cip999</a>, Prepared by: <a class="rated-user user-orange" href="/profile/cip999" title="Master cip999">cip999</a></li> </ul> <div class="spoiler"><b class="spoiler-title">Open</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2068/problem/J" title="European Championship 2025 - Online Mirror (Unrated, ICPC Rules, Teams Preferred)">2068J - The Ultimate Wine Tasting Event</a></h3><div class="ttypography"><div class="problem-statement"><div><p>We will find a simple necessary and sufficient condition on the string $$$s$$$ for the operation to be successful. Then, it will be trivial to check whether this condition is satisfied.</p><p>First, suppose that it is possible to rearrange the bottles as described in the statement. That is, there esist two subsets $$$A = \{a_1, \, \dots, \, a_n\}$$$ and $$$B = \{b_1, \, \, \dots, \, b_n\}$$$ of $$$\{1, \, 2, \, \dots, \, 2n\}$$$, each of size $$$n$$$ and disjoint, such that swapping $$$s_{a_i}$$$ and $$$s_{b_i}$$$ (assuming the elements are sorted in each subset) results in the string $$$\texttt{WW} \dots \texttt{WWRR} \dots \texttt{RR}$$$.</p><p>Let $$$h$$$ be the last index such that $$$a_h \le n$$$, and similarly let $$$k$$$ be the last index such that $$$b_k \le n$$$. If either of them do not exist, set it equal to $$$0$$$. Note that, by definition, $$$h + k = n$$$. Modulo swapping $$$A$$$ and $$$B$$$, we can assume that $$$h \le k$$$. Then, upon swapping $$$a_i$$$ with $$$b_i$$$ for $$$1 \le i \le n$$$, all the bottles at indices $$$a_1, \, \dots, \, a_h$$$ will occupy positions among the leftmost $$$n$$$, which means that $$$s_{a_i} = \texttt{W}$$$ for all $$$1 \le i \le h$$$. Also, after swapping, all bottles at indices $$$b_1, \, \dots, \, b_h$$$ will occupy positions among the first $$$n$$$, and therefore $$$s_{b_i} = \texttt{W}$$$ for $$$1 \le i \le h$$$. On the other hand, the bottles at indices $$$b_{h + 1}, \, \dots, \, b_k$$$ will occupy positions greater than $$$n$$$, so that $$$s_{b_i} = \texttt{R}$$$ for each $$$h + 1 \le i \le k$$$. This implies that, among the first $$$n$$$ bottles, the white ones are $$$2h$$$ and the red ones are $$$k - h = n - 2h$$$.</p><p>Finally, consider the first $$$h$$$ bottles in the initial arrangement. Each of these belongs to either $$$\{a_1, \, \dots, \, a_h\}$$$ or $$$\{b_1, \, \dots, \, b_h\}$$$, and therefore, when swapped, it will end up in one of the first $$$n$$$ positions. This implies that $$$s_i = \texttt{W}$$$ for $$$1 \le i \le h$$$.</p><p>We deduced that a necessary condition is: the number of white bottles in the first half is even, say $$$2h$$$, and the first $$$h$$$ bottles are white. Note that the number of red bottles in the second half is also $$$2h$$$ and, by the same argument, the last $$$h$$$ bottles have to be red.</p><p>Let's now prove that this condition is also sufficient. We construct $$$A$$$ and $$$B$$$ as follows:</p><ul> <li> $$$A$$$ contains the first $$$h$$$ positions (which are white wines), and the first $$$n - h$$$ positions with red wines. </li><li> $$$B$$$ contains everything else, that is, all positions with white wines except the first $$$h$$$, and the last $$$h$$$ positions (with red wines). </li></ul><p>It is easy to see that the operation of swapping $$$A$$$ and $$$B$$$ places all white wines in the first half and all red wines in the second half.</p><p>Checking whether this condition is satisfied is trivial and can be done in time $$$O(n)$$$.</p><p><span class="tex-font-style-bf">Remark.</span> Arrangements such as $$$\texttt{WWRWWRRRRW}$$$ ($$$n = 5$$$), where only the "first-half" condition is satisfied, do not work. One needs to check that both the white wines in the first half as well as the red wines in the second half satisfy the condition.</p></div></div></div></div></div></div> <ul>   <li>K: Author: <a class="rated-user user-legendary" href="/profile/Egor" title="Legendary Grandmaster Egor"><span class="legendary-user-first-letter">E</span>gor</a>, Prepared by: <a class="rated-user user-legendary" href="/profile/Egor" title="Legendary Grandmaster Egor"><span class="legendary-user-first-letter">E</span>gor</a></li> </ul> <div class="spoiler"><b class="spoiler-title">Open</b><div class="spoiler-content" style="display: none;"><div><h3><a href="/contest/2068/problem/K" title="European Championship 2025 - Online Mirror (Unrated, ICPC Rules, Teams Preferred)">2068K - Amusement Park Rides</a></h3><div class="ttypography"><div class="problem-statement"><div><p>Assume that among the numbers $$$a_i$$$ there are $$$k$$$ distinct values, denoted by $$$p_1, p_2, \dots, p_k$$$. Suppose each $$$p_j$$$ appears $$$q_j$$$ times in the sequence $$$\{a_i\}$$$.</p><p>We now construct a flow graph as follows:</p><ol> <li> Define the vertex set as $$$V = \{S, T\} \cup \{A_1, A_2, \dots, A_k\}$$$. </li><li> For each vertex $$$A_i$$$ (with $$$1 \le i \le k$$$), add an edge from $$$S$$$ to $$$A_i$$$ with capacity $$$q_i$$$. </li><li> For each positive integer $$$i$$$, introduce a vertex $$$B_i$$$. For every vertex $$$A_j$$$ (with $$$1 \le j \le k$$$), if $$$i \equiv 0 \pmod{p_j}$$$, then add an edge from $$$A_j$$$ to $$$B_i$$$ with capacity $$$1$$$. In addition, add an edge from $$$B_i$$$ to $$$T$$$ with capacity $$$1$$$. </li></ol><p>We continue adding vertices $$$B_i$$$ (in increasing order of $$$i$$$) until the maximum flow from $$$S$$$ to $$$T$$$ reaches $$$n$$$. The answer to the problem is the largest index $$$i$$$ for which a vertex $$$B_i$$$ was added.</p><p>This approach has a running time of $$$O(\mathrm{ans} \cdot E)$$$, where $$$\mathrm{ans}$$$ denotes the final value of $$$i$$$ and $$$E$$$ is the number of edges. However, this is too slow since it requires creating a vertex $$$B_i$$$ for every positive integer $$$i$$$.</p><p>We can improve efficiency by avoiding the creation of every $$$B_i$$$. Instead, we maintain a mapping $$$M: \mathbb{Z}^+ \to \{\mathrm{indices}\}$$$, where $$$M(i)$$$ is a set of indices. Initially, for each $$$1 \le j \le k$$$, we set $$$M(p_j) = \{j\}$$$.</p><p>At each step, perform the following: </p><ul> <li> Find the smallest $$$i$$$ for which $$$M(i)$$$ is nonempty. </li><li> Add the vertex $$$B_i$$$ along with its edge to $$$T$$$ and add edges from $$$A_j$$$ to $$$B_i$$$ for every $$$j \in M(i)$$$. </li><li> If adding these edges increases the maximum flow, then for each $$$j \in M(i)$$$ insert $$$j$$$ into $$$M(i+p_j)$$$. This means that a future vertex $$$B_{i+p_j}$$$ may also need to be connected to $$$A_j$$$. Otherwise, if the maximum flow does not increase, no additional edges from $$$A_j$$$ (for $$$j \in M(i)$$$) will be needed. </li><li> Finally, clear the set $$$M(i)$$$. </li></ul><p>Note that we examine at most $$$n+k$$$ distinct values of $$$i$$$ (because in each step we either increase the maximum flow or remove at least one element from $$$\bigcup_i M(i)$$$). Therefore, the overall time complexity of the solution is $$$O(n \cdot E)$$$, and it can be shown that $$$E = O(n \log n)$$$.</p></div></div></div></div></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="/contest/2068" class="notice" style="text-decoration: none;">European Championship 2025 - Online Mirror (Unrated, ICPC Rules, Teams Preferred)</a> </span>
        </div>
        
            <script type="text/javascript">
    $(document).ready(function () {
        $(".delete-resource-link-281-140865").click(function() {
            var that = this;
            Codeforces.confirm("Are you sure you want to detach a contest?", function () {
                $.post("/data/blogAndContest", {
                    action: "detachBlogFromContest",
                    blogId: "281",
                    blogEntryId: "140239",
                    contestId: $(that).attr("data-contestId"),
                    resourceIds: $(that).attr("data-resourceIds")
                }, function(json) {        
                    Codeforces.reloadAndShowMessageOrShowError(json, "Contest detached");
                });
            }, function () {}, "Yes", "No");
        });
    });
</script>
        

        <div style="font-size: 1.1rem;line-height: 11px;">
            <img style="vertical-align: middle;" src="//codeforces.com/codeforces.org/s/52448/images/blog/tags.png" title="Tags" alt="Tags">
                <span style="padding: 0 0.35em;">
    <a href="/search?query=icpc" class="tag notice" style="text-decoration: none;">icpc</a>,
                </span>
                <span style="padding: 0 0.35em;">
    <a href="/search?query=euc" class="tag notice" style="text-decoration: none;">euc</a>,
                </span>
                <span style="padding: 0 0.35em;">
    <a href="/search?query=euc-icpc" class="tag notice" style="text-decoration: none;">euc-icpc</a>,
                </span>
                <span style="padding: 0 0.35em;">
    <a href="/search?query=porto" class="tag notice" style="text-decoration: none;">porto</a>,
                </span>
                <span style="padding: 0 0.35em;">
    <a href="/search?query=euc2025" class="tag notice" style="text-decoration: none;">euc2025</a>,
                </span>
                <span style="padding: 0 0.35em;">
    <a href="/search?query=icpc2025" class="tag notice" style="text-decoration: none;">icpc2025</a>,
                </span>
                <span style="padding: 0 0.35em;">
    <a href="/search?query=editorial" class="tag notice" style="text-decoration: none;">editorial</a>,
                </span>
                <span style="padding: 0 0.35em;">
    <a href="/search?query=tutorial" class="tag notice" style="text-decoration: none;">tutorial</a>
                </span>
        </div>


    <div class="roundbox meta borderTopRound borderBottomRound" style="">
        <div class="left-meta">
            <ul>
                    <li style="line-height: 1.6em;">        <a href="#" class="topic-vote-up-140865"><img style="vertical-align:middle;position:relative;top:-0.2em" src="//codeforces.com/codeforces.org/s/52448/images/actions/voteup-gray.png" alt="Vote: I like it" title="Vote: I like it"></a>


</li>
                    <li style="line-height: 1.6em;">

        
        <span class="topic-rating topic-rating-140865" title="Topic rating" data-topicid="140865" data-rawrating="103" style="font-size:larger;position:relative;bottom:1px;font-weight:bold;color:green">+103</span>
        
</li>
                    <li style="line-height: 1.6em;">        <a href="#" class="topic-vote-down-140865"><img style="vertical-align:middle;position:relative;top:-0.2em" src="//codeforces.com/codeforces.org/s/52448/images/actions/votedown-gray.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>


</li>
            </ul>
        </div>


            <span style="position: relative; line-height: 1.65em; top: 0.75rem; left: 0.8em;">
            </span>

        <div class="right-meta">
            <ul>
                    <li>        <a href="/profile/Petr"><img style="vertical-align:middle;position:relative;top:-1px" src="//codeforces.com/codeforces.org/s/52448/images/blog/user_16x16.png" alt="Author" title="Author"></a>


        <a href="/profile/Petr">
        Petr
        </a>
</li>
                    <li>        <img style="vertical-align:middle;position:relative;top:-1px" src="//codeforces.com/codeforces.org/s/52448/images/blog/date_16x16.png" alt="Publication date" title="Publication date">


        
        <span class="format-humantime" title="Mar/02/2025 15:18 UTC">9 months ago</span>
        
</li>
                    <li>        <a href="/blog/entry/140239#comments"><img style="vertical-align:middle;position:relative;top:-1px" src="//codeforces.com/codeforces.org/s/52448/images/blog/comments_16x16.png" alt="Comments" title="Comments"></a>


        <a href="/blog/entry/140239#comments">
        32
        </a>
</li>
            </ul>
        </div>

        <br style="clear:both;">
    </div>


<style type="text/css">
    .comments .title {
        float: left;
    }

    .comments .comments-actions-div {
        float: right;
        margin-top: 3rem;
        margin-right: 0.5em;
    }

    .comments .comments-actions-div .separator {
        margin: 0 1rem;
    }

    .comments label.show-archived {
    }

    .comments label.show-archived, .comments label.show-archived * {
        font-size: 1.4rem !important;
        color: black !important;
        /*position: relative !important;*/
        /*bottom: 0.4rem !important;*/
    }

    .comments label.show-archived input {
        height: 1.4rem !important;
        width: 1.4rem !important;
        position: relative;
        top: 0.25rem;
    }

    .new-root-comment {
        font-size: 1.4rem !important;
    }
</style>

    <div class="comments" commentableid="154723">
        <div style="display: flow-root">
            <div class="title">
                <img src="//codeforces.com/codeforces.org/s/52448/images/icons/comments-48x48.png" alt="Comments" title="Comments" style="position:relative;top:0.6em;">
                <a name="comments">Comments (32)</a>

            </div>
            <div class="comments-actions-div">
                <a href="#" class="new-root-comment">Write comment?</a>
            </div>
        </div>

<div class="comment" commentid="1252261">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252261" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/arnavra3" title="Expert arnavra3" class="rated-user user-blue">arnavra3</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/02/2025 16:24 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252261" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/arnavra3" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3532161/avatar/b514d1e3bc6d85c9.jpg">        </a>
        <div><a href="/profile/arnavra3" title="Expert arnavra3" class="rated-user user-blue">arnavra3</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/02/2025 16:24 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252261" href="?#comment-1252261" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252261" class="CommentVoteFrame" myvotedirection="0" data-commentrating="6" data-commentuserid="3532161" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+6</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252261">
                        <div class="moveup">
                        <div class="ttypography"><p>I have a probabilistic solution for Problem A (optimised) <a href="https://codeforces.com/contest/2068/submission/308681793">https://codeforces.com/contest/2068/submission/308681793</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252261 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252261 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252261">
        </ul>
    </div>
</div>

<div class="comment" commentid="1252268">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252268" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/rolandpetrean" title="Grandmaster rolandpetrean" class="rated-user user-red">rolandpetrean</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/02/2025 16:37 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">3</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252268" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/rolandpetrean" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2419781/avatar/7151cad368e63445.jpg">        </a>
        <div><a href="/profile/rolandpetrean" title="Grandmaster rolandpetrean" class="rated-user user-red">rolandpetrean</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/02/2025 16:37 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252268" href="?#comment-1252268" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252268" class="CommentVoteFrame" myvotedirection="0" data-commentrating="32" data-commentuserid="2419781" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+32</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252268">
                        <div class="moveup">
                        <div class="ttypography"><p>E is, supposedly, <a href="https://kilonova.ro/problems/211">well known</a> in romania</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252268 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252268 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252268">
                <li>
<div class="comment" commentid="1252272">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252272" commentparentid="1252268">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/dario2994" title="International Grandmaster dario2994" class="rated-user user-red">dario2994</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/02/2025 16:44 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">2</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252272" commentparentid="1252268">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/dario2994" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/dario2994" title="International Grandmaster dario2994" class="rated-user user-red">dario2994</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/02/2025 16:44 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252272" href="?#comment-1252272" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1252268" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252272" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="50632" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252272">
                        <div class="moveup">
                        <div class="ttypography"><p>Right, we understood it very early in the mirror and it became a bit of a meme among the judges :D But, we could not really find the source so thanks for sharing. Could you also tell us where the problem appeared? I could not understand it immediately from the link.</p><p>We were lucky, because among the Romanian teams participating to the onsite, none sent a submission.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252272 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252272 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252272">
                <li>
<div class="comment" commentid="1252274">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252274" commentparentid="1252272">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/rolandpetrean" title="Grandmaster rolandpetrean" class="rated-user user-red">rolandpetrean</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/02/2025 16:47 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252274" commentparentid="1252272">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/rolandpetrean" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2419781/avatar/7151cad368e63445.jpg">        </a>
        <div><a href="/profile/rolandpetrean" title="Grandmaster rolandpetrean" class="rated-user user-red">rolandpetrean</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/02/2025 16:47 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252274" href="?#comment-1252274" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1252272" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252274" class="CommentVoteFrame" myvotedirection="0" data-commentrating="18" data-commentuserid="2419781" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+18</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252274">
                        <div class="moveup">
                        <div class="ttypography"><p>It's from the first contest of the 2022 TST ("Lot")</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252274 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252274 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252274">
        </ul>
    </div>
</div>
</li>
                <li>
<div class="comment" commentid="1252634">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252634" commentparentid="1252272">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/SomethingNew" title="Legendary Grandmaster SomethingNew" class="rated-user user-legendary"><span class="legendary-user-first-letter">S</span>omethingNew</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/04/2025 12:59 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252634" commentparentid="1252272">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/SomethingNew" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/1297842/avatar/62e708ed1a975ccc.jpg">        </a>
        <div><a href="/profile/SomethingNew" title="Legendary Grandmaster SomethingNew" class="rated-user user-legendary"><span class="legendary-user-first-letter">S</span>omethingNew</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/04/2025 12:59 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252634" href="?#comment-1252634" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1252272" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252634" class="CommentVoteFrame" myvotedirection="0" data-commentrating="24" data-commentuserid="1297842" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+24</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252634">
                        <div class="moveup">
                        <div class="ttypography"><p>Hehehe, I saw this exact task at the Russian IOI training camp in 2023, and an even bigger hehehe is that we only qualified for WF thanks to it.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252634 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252634 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252634">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1252279">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252279" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/peti1234" title="International Grandmaster peti1234" class="rated-user user-red">peti1234</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/02/2025 17:11 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252279" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/peti1234" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/424529/avatar/9e80f0cb477a329c.jpg">        </a>
        <div><a href="/profile/peti1234" title="International Grandmaster peti1234" class="rated-user user-red">peti1234</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/02/2025 17:11 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252279" href="?#comment-1252279" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252279" class="CommentVoteFrame" myvotedirection="0" data-commentrating="10" data-commentuserid="424529" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+10</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252279">
                        <div class="moveup">
                        <div class="ttypography"><p>H when the distances are the same. <a href="https://atcoder.jp/contests/abc135/tasks/abc135_e">https://atcoder.jp/contests/abc135/tasks/abc135_e</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252279 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252279 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252279">
        </ul>
    </div>
</div>

<div class="comment" commentid="1252293">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252293" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/jtnydv25" title="Grandmaster jtnydv25" class="rated-user user-red">jtnydv25</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/02/2025 18:12 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">3</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252293" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/jtnydv25" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/jtnydv25" title="Grandmaster jtnydv25" class="rated-user user-red">jtnydv25</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/02/2025 18:12 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252293" href="?#comment-1252293" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252293" class="CommentVoteFrame" myvotedirection="0" data-commentrating="31" data-commentuserid="364427" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+31</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252293">
                        <div class="moveup">
                        <div class="ttypography"><p>Btw A can be solved with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-1" style="width: 3.634em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.895em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1002.89em, 2.403em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mn" id="MathJax-Span-3" style="font-family: MathJax_Main;">4</span><span class="mi" id="MathJax-Span-4" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-5" style="font-family: MathJax_Main; padding-left: 0.249em;">−</span><span class="mn" id="MathJax-Span-6" style="font-family: MathJax_Main; padding-left: 0.249em;">7</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.15em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">4n - 7</script> votes: <a href="/contest/2068/submission/308693499" title="Submission 308693499 by jtnydv25">308693499</a>. </p><p>This can be proven inductively. WLOG, assume <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-7" style="width: 4.557em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.634em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1003.51em, 2.834em, -999.997em); top: -2.274em; left: 0em;"><span class="mrow" id="MathJax-Span-8"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math-italic;">m</span><span class="mo" id="MathJax-Span-10" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mrow" id="MathJax-Span-11" style="padding-left: 0.311em;"><span class="TeXmathchoice" id="MathJax-Span-12"><span class="mstyle" id="MathJax-Span-13"><span class="mrow" id="MathJax-Span-14"><span class="texatom" id="MathJax-Span-15"><span class="mrow" id="MathJax-Span-16"><span class="mo" id="MathJax-Span-17" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">(</span></span></span></span></span></span></span><span class="mfrac" id="MathJax-Span-18"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px;"><span style="position: absolute; clip: rect(3.511em, 1000.43em, 4.188em, -999.997em); top: -4.428em; left: 50%; margin-left: -0.182em;"><span class="mi" id="MathJax-Span-19" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(3.326em, 1000.31em, 4.188em, -999.997em); top: -3.628em; left: 50%; margin-left: -0.182em;"><span class="mn" id="MathJax-Span-20" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="TeXmathchoice" id="MathJax-Span-21"><span class="mstyle" id="MathJax-Span-22"><span class="mrow" id="MathJax-Span-23"><span class="texatom" id="MathJax-Span-24"><span class="mrow" id="MathJax-Span-25"><span class="mo" id="MathJax-Span-26" style="vertical-align: 0em;"><span style="font-family: MathJax_Size1;">)</span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.28em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.535em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">m = \binom{n}{2}</script>. The <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-27" style="width: 3.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.526em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1002.47em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-28"><span class="mi" id="MathJax-Span-29" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-30" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mn" id="MathJax-Span-31" style="font-family: MathJax_Main; padding-left: 0.311em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">n=2</script> case is trivial. For <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-32" style="width: 3.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.526em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1002.47em, 2.465em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-33"><span class="mi" id="MathJax-Span-34" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-35" style="font-family: MathJax_Main; padding-left: 0.311em;">≥</span><span class="mn" id="MathJax-Span-36" style="font-family: MathJax_Main; padding-left: 0.311em;">3</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.227em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">n \ge 3</script>, from the inductive hypothesis, say we have a set <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-37" style="width: 1.049em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.803em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1000.8em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-38"><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.188em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">V</script> of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-40" style="width: 4.249em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.388em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1003.33em, 2.403em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-41"><span class="mn" id="MathJax-Span-42" style="font-family: MathJax_Main;">4</span><span class="mi" id="MathJax-Span-43" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-44" style="font-family: MathJax_Main; padding-left: 0.249em;">−</span><span class="mn" id="MathJax-Span-45" style="font-family: MathJax_Main; padding-left: 0.249em;">11</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.15em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">4n - 11</script> votes getting the desired facts concerning only the candidates <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-46" style="width: 7.08em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.665em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1005.6em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-47"><span class="mn" id="MathJax-Span-48" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-49" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-50" style="font-family: MathJax_Main; padding-left: 0.188em;">2</span><span class="mo" id="MathJax-Span-51" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-52" style="font-family: MathJax_Main; padding-left: 0.188em;">…</span><span class="mi" id="MathJax-Span-53" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">n</span><span class="mo" id="MathJax-Span-54" style="font-family: MathJax_Main; padding-left: 0.249em;">−</span><span class="mn" id="MathJax-Span-55" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">1, 2, \ldots n-1</script>. Now, let <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-56" style="width: 0.865em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1000.68em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-57"><span class="mi" id="MathJax-Span-58" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">S</script> be the set of candidates who we want to beat <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-59" style="width: 0.803em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.618em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.62em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-60"><span class="mi" id="MathJax-Span-61" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">n</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-62" style="width: 0.926em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1000.74em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-63"><span class="mi" id="MathJax-Span-64" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.126em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">T</script> be the set of candidates who we want to be beaten by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-65" style="width: 0.803em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.618em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.62em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-66"><span class="mi" id="MathJax-Span-67" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">n</script>. Let <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-68" style="width: 1.418em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1001.11em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-69"><span class="msubsup" id="MathJax-Span-70"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.56em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-71" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.812em; left: 0.557em;"><span class="mi" id="MathJax-Span-72" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">\sigma_S</script> be any ordering of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-73" style="width: 0.865em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.68em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1000.68em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-74"><span class="mi" id="MathJax-Span-75" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">S</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-76" style="width: 1.48em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.172em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1001.17em, 2.465em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-77"><span class="msubsup" id="MathJax-Span-78"><span style="display: inline-block; position: relative; width: 1.172em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.56em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-79" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.557em;"><span class="mi" id="MathJax-Span-80" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.227em; border-left: 0px solid; width: 0px; height: 0.85em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">\sigma_T</script> be any ordering of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-81" style="width: 0.926em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1000.74em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-82"><span class="mi" id="MathJax-Span-83" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.126em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">T</script>. For <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-84" style="width: 3.634em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.895em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1002.83em, 2.403em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-85"><span class="mn" id="MathJax-Span-86" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-87" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-88" style="font-family: MathJax_Main; padding-left: 0.249em;">−</span><span class="mn" id="MathJax-Span-89" style="font-family: MathJax_Main; padding-left: 0.249em;">6</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.15em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">2n-6</script> of the votes from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-90" style="width: 1.049em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.803em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1000.8em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-91"><span class="mi" id="MathJax-Span-92" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.188em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-17">V</script>, make <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-93" style="width: 0.803em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.618em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.62em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-94"><span class="mi" id="MathJax-Span-95" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">n</script> the most preferred candidate, and for the remaining <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-96" style="width: 3.634em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.895em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1002.83em, 2.403em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-97"><span class="mn" id="MathJax-Span-98" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-99" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-100" style="font-family: MathJax_Main; padding-left: 0.249em;">−</span><span class="mn" id="MathJax-Span-101" style="font-family: MathJax_Main; padding-left: 0.249em;">5</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.15em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-19">2n-5</script> votes, make <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-102" style="width: 0.803em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.618em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.62em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-103"><span class="mi" id="MathJax-Span-104" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-20">n</script> the least preferred candidate (keeping their ranking among <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-105" style="width: 7.08em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.665em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1005.6em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-106"><span class="texatom" id="MathJax-Span-107"><span class="mrow" id="MathJax-Span-108"><span class="mn" id="MathJax-Span-109" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-110" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-111" style="font-family: MathJax_Main; padding-left: 0.188em;">2</span><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-113" style="font-family: MathJax_Main; padding-left: 0.188em;">…</span><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">n</span><span class="mo" id="MathJax-Span-115" style="font-family: MathJax_Main; padding-left: 0.249em;">−</span><span class="mn" id="MathJax-Span-116" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21">{1, 2, \ldots n-1}</script> the same). Let <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-117" style="width: 3.511em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.772em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1002.77em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-118"><span class="texatom" id="MathJax-Span-119"><span class="mrow" id="MathJax-Span-120"><span class="munderover" id="MathJax-Span-121"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1001.11em, 4.372em, -999.997em); top: -3.997em; left: 0em;"><span class="msubsup" id="MathJax-Span-122"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.56em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-123" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.812em; left: 0.557em;"><span class="mi" id="MathJax-Span-124" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(3.142em, 1000.37em, 3.634em, -999.997em); top: -4.058em; left: 0.311em;"><span class="mo" id="MathJax-Span-125" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-126" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-127" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-128"><span class="munderover" id="MathJax-Span-129"><span style="display: inline-block; position: relative; width: 1.172em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1001.17em, 4.311em, -999.997em); top: -3.997em; left: 0em;"><span class="msubsup" id="MathJax-Span-130"><span style="display: inline-block; position: relative; width: 1.172em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.56em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-131" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.557em;"><span class="mi" id="MathJax-Span-132" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(3.142em, 1000.37em, 3.634em, -999.997em); top: -4.058em; left: 0.311em;"><span class="mo" id="MathJax-Span-133" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.312em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22">\hat{\sigma_S}, \hat{\sigma_T}</script> denote the reverse of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-134" style="width: 3.511em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.772em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1002.77em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-135"><span class="msubsup" id="MathJax-Span-136"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.56em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-137" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.812em; left: 0.557em;"><span class="mi" id="MathJax-Span-138" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-139" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-140" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.172em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.56em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-141" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.557em;"><span class="mi" id="MathJax-Span-142" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">\sigma_S, \sigma_T</script> respectively.</p><p>Now, we add four more votes, with the following rankings:</p> <ol>   <li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-143" style="width: 4.803em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.818em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1003.82em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-144"><span class="msubsup" id="MathJax-Span-145"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.56em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-146" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.812em; left: 0.557em;"><span class="mi" id="MathJax-Span-147" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-148" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-149" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">n</span><span class="mo" id="MathJax-Span-150" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-151" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.172em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.56em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-152" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.557em;"><span class="mi" id="MathJax-Span-153" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-24">\sigma_S, n, \sigma_T</script></li>   <li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-154" style="width: 4.803em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.818em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1003.82em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-155"><span class="texatom" id="MathJax-Span-156"><span class="mrow" id="MathJax-Span-157"><span class="munderover" id="MathJax-Span-158"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1001.11em, 4.372em, -999.997em); top: -3.997em; left: 0em;"><span class="msubsup" id="MathJax-Span-159"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.56em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-160" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.812em; left: 0.557em;"><span class="mi" id="MathJax-Span-161" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(3.142em, 1000.37em, 3.634em, -999.997em); top: -4.058em; left: 0.311em;"><span class="mo" id="MathJax-Span-162" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-163" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-164" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">n</span><span class="mo" id="MathJax-Span-165" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-166" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-167"><span class="munderover" id="MathJax-Span-168"><span style="display: inline-block; position: relative; width: 1.172em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1001.17em, 4.311em, -999.997em); top: -3.997em; left: 0em;"><span class="msubsup" id="MathJax-Span-169"><span style="display: inline-block; position: relative; width: 1.172em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.56em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-170" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.557em;"><span class="mi" id="MathJax-Span-171" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(3.142em, 1000.37em, 3.634em, -999.997em); top: -4.058em; left: 0.311em;"><span class="mo" id="MathJax-Span-172" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.312em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">\hat{\sigma_S}, n, \hat{\sigma_T}</script></li>   <li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-173" style="width: 4.803em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.818em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1003.82em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-174"><span class="msubsup" id="MathJax-Span-175"><span style="display: inline-block; position: relative; width: 1.172em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.56em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-176" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.557em;"><span class="mi" id="MathJax-Span-177" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-178" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-179" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.56em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-180" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.812em; left: 0.557em;"><span class="mi" id="MathJax-Span-181" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-182" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-183" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">n</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-26">\sigma_T, \sigma_S, n</script></li>   <li><span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-184" style="width: 4.803em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.818em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1003.82em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-185"><span class="mi" id="MathJax-Span-186" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-187" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-188" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-189"><span class="munderover" id="MathJax-Span-190"><span style="display: inline-block; position: relative; width: 1.172em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1001.17em, 4.311em, -999.997em); top: -3.997em; left: 0em;"><span class="msubsup" id="MathJax-Span-191"><span style="display: inline-block; position: relative; width: 1.172em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.56em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-192" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.557em;"><span class="mi" id="MathJax-Span-193" style="font-size: 70.7%; font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(3.142em, 1000.37em, 3.634em, -999.997em); top: -4.058em; left: 0.311em;"><span class="mo" id="MathJax-Span-194" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-195" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-196" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-197"><span class="munderover" id="MathJax-Span-198"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1001.11em, 4.372em, -999.997em); top: -3.997em; left: 0em;"><span class="msubsup" id="MathJax-Span-199"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.56em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-200" style="font-family: MathJax_Math-italic;">σ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.812em; left: 0.557em;"><span class="mi" id="MathJax-Span-201" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(3.142em, 1000.37em, 3.634em, -999.997em); top: -4.058em; left: 0.311em;"><span class="mo" id="MathJax-Span-202" style="font-family: MathJax_Main;">^</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.312em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-27">n, \hat{\sigma_T}, \hat{\sigma_S}</script></li> </ol><p>Intersetingly, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-203" style="width: 6.157em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.926em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1004.8em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-204"><span class="mi" id="MathJax-Span-205" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-206" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-207" style="font-family: MathJax_Math-italic;">n</span><span class="texatom" id="MathJax-Span-208"><span class="mrow" id="MathJax-Span-209"><span class="mo" id="MathJax-Span-210" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-211" style="font-family: MathJax_Main; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-212"></span><span class="texatom" id="MathJax-Span-213" style="padding-left: 0.188em;"><span class="mrow" id="MathJax-Span-214"><span class="mi" id="MathJax-Span-215" style="font-family: MathJax_Math-italic;">n</span></span></span><span class="mo" id="MathJax-Span-216" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-28">O(n/ \log{n})</script> votes <a href="https://www.renyi.hu/~p_erdos/1964-22.pdf">suffice and are asymptotically optimal</a>.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252293 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252293 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252293">
                <li>
<div class="comment" commentid="1252300">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252300" commentparentid="1252293">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/dario2994" title="International Grandmaster dario2994" class="rated-user user-red">dario2994</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/02/2025 18:32 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252300" commentparentid="1252293">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/dario2994" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/dario2994" title="International Grandmaster dario2994" class="rated-user user-red">dario2994</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/02/2025 18:32 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252300" href="?#comment-1252300" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1252293" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252300" class="CommentVoteFrame" myvotedirection="0" data-commentrating="18" data-commentuserid="50632" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+18</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252300">
                        <div class="moveup">
                        <div class="ttypography"><p>Ohhhhh, super cool that it can be done in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-217" style="width: 6.157em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.926em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1004.8em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-218"><span class="mi" id="MathJax-Span-219" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-220" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-221" style="font-family: MathJax_Math-italic;">n</span><span class="texatom" id="MathJax-Span-222"><span class="mrow" id="MathJax-Span-223"><span class="mo" id="MathJax-Span-224" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-225" style="font-family: MathJax_Main; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-226"></span><span class="mi" id="MathJax-Span-227" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">n</span><span class="mo" id="MathJax-Span-228" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-29">O(n/\log n)</script>. This Erdos guy must be strong!</p><p>We knew about the fact it could be done with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-229" style="width: 2.711em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.157em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1002.03em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-230"><span class="mi" id="MathJax-Span-231" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-232" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-233" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-234" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-30">O(n)</script> voters, but we thought it would make the problem harder without really making it more interesting.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252300 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252300 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252300">
        </ul>
    </div>
</div>
</li>
                <li>
<div class="comment" commentid="1252345">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252345" commentparentid="1252293">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Benq" title="Legendary Grandmaster Benq" class="rated-user user-legendary"><span class="legendary-user-first-letter">B</span>enq</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/02/2025 23:24 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252345" commentparentid="1252293">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Benq" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/312472/avatar/5716ac69aea8159a.jpg"><img title="Badge of honor for supporting Codeforces on its 10th anniversary" src="//codeforces.com/codeforces.org/s/52448/images/if_medal-bronze-blue_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="/profile/Benq" title="Legendary Grandmaster Benq" class="rated-user user-legendary"><span class="legendary-user-first-letter">B</span>enq</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/02/2025 23:24 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252345" href="?#comment-1252345" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1252293" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252345" class="CommentVoteFrame" myvotedirection="0" data-commentrating="28" data-commentuserid="312472" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+28</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252345">
                        <div class="moveup">
                        <div class="ttypography"><p>I think an easier way to get to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-235" style="width: 2.711em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.157em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1002.03em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-236"><span class="mi" id="MathJax-Span-237" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-238" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-239" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-240" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-31">O(n)</script> votes (specifically, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-241" style="width: 1.418em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.111em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1001.11em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-242"><span class="mn" id="MathJax-Span-243" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-244" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-32">2n</script>) is to just color the edges of the graph with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-245" style="width: 0.803em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.618em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.62em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-246"><span class="mi" id="MathJax-Span-247" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-33">n</script> colors (according to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-248" style="width: 9.049em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.203em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1007.08em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-249"><span class="mo" id="MathJax-Span-250" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-251" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-252" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mi" id="MathJax-Span-253" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">b</span><span class="mo" id="MathJax-Span-254" style="font-family: MathJax_Main;">)</span><span class="TeXmathchoice" id="MathJax-Span-255"><span class="mspace" id="MathJax-Span-256" style="height: 0em; vertical-align: 0em; width: 0.434em; display: inline-block; overflow: hidden;"></span></span><span class="mo" id="MathJax-Span-257" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-258" style="font-family: MathJax_Main;">mod</span><span class="mspace" id="MathJax-Span-259" style="height: 0em; vertical-align: 0em; width: 0.311em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-260" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">n</span><span class="mo" id="MathJax-Span-261" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-34">(a+b)\pmod n</script>), and then for each color process all the edges of that color simultaneously.</p><p><a href="/contest/2068/submission/308721319" title="Submission 308721319 by Benq">308721319</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252345 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252345 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252345">
        </ul>
    </div>
</div>
</li>
                <li>
<div class="comment" commentid="1252558">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252558" commentparentid="1252293">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/cdkrot" title="International Grandmaster cdkrot" class="rated-user user-red">cdkrot</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/03/2025 20:42 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252558" commentparentid="1252293">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/cdkrot" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/205473/avatar/d9abc7e83e4c1979.jpg">        </a>
        <div><a href="/profile/cdkrot" title="International Grandmaster cdkrot" class="rated-user user-red">cdkrot</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/03/2025 20:42 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252558" href="?#comment-1252558" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1252293" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1252558" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252558" class="CommentVoteFrame" myvotedirection="0" data-commentrating="16" data-commentuserid="205473" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+16</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252558">
                        <div class="moveup">
                        <div class="ttypography"><p>This is remarkable <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-262" style="width: 6.157em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.926em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1004.8em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-263"><span class="mi" id="MathJax-Span-264" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-265" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-266" style="font-family: MathJax_Math-italic;">n</span><span class="texatom" id="MathJax-Span-267"><span class="mrow" id="MathJax-Span-268"><span class="mo" id="MathJax-Span-269" style="font-family: MathJax_Main;">/</span></span></span><span class="mi" id="MathJax-Span-270" style="font-family: MathJax_Main; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-271"></span><span class="mi" id="MathJax-Span-272" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">n</span><span class="mo" id="MathJax-Span-273" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-35">O(n / \log n)</script> bound is possible! I would've been shy to propose the problem if I realized it's solved in 1964's paper. </p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252558 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252558 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252558">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1252329">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252329" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Coder" title="International Grandmaster Coder" class="rated-user user-red">Coder</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/02/2025 21:30 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">2</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252329" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Coder" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/715/avatar/d31faffb4f8f21a.jpg">        </a>
        <div><a href="/profile/Coder" title="International Grandmaster Coder" class="rated-user user-red">Coder</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/02/2025 21:30 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252329" href="?#comment-1252329" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252329" class="CommentVoteFrame" myvotedirection="0" data-commentrating="13" data-commentuserid="715" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+13</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252329">
                        <div class="moveup">
                        <div class="ttypography"><p>Interestingly, I came up with pretty much same problem as D. Morse Code for another contest some years ago, it got rejected (reason: it appeared in some shortlist very long time ago, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-274" style="width: 3.695em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.957em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.111em, 1002.83em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-275"><span class="mi" id="MathJax-Span-276" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-277" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-278"><span style="display: inline-block; position: relative; width: 1.418em; height: 0px;"><span style="position: absolute; clip: rect(3.142em, 1000.87em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-279" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.988em;"><span class="mn" id="MathJax-Span-280" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-281" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.542em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-36">O(N^4)</script> intended solution IIRC)</p><p>Later I discovered <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-282" style="width: 3.695em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.957em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.111em, 1002.83em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-283"><span class="mi" id="MathJax-Span-284" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-285" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-286"><span style="display: inline-block; position: relative; width: 1.418em; height: 0px;"><span style="position: absolute; clip: rect(3.142em, 1000.87em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-287" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.988em;"><span class="mn" id="MathJax-Span-288" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-289" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.542em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-37">O(N^2)</script> solution in a paper.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252329 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252329 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252329">
                <li>
<div class="comment" commentid="1252330">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252330" commentparentid="1252329">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/dario2994" title="International Grandmaster dario2994" class="rated-user user-red">dario2994</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/02/2025 21:52 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252330" commentparentid="1252329">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/dario2994" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/dario2994" title="International Grandmaster dario2994" class="rated-user user-red">dario2994</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/02/2025 21:52 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252330" href="?#comment-1252330" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1252329" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252330" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="50632" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252330">
                        <div class="moveup">
                        <div class="ttypography"><p>I know about a paper on the problem (linked from the wiki page about Huffman) but I don't know an <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-290" style="width: 3.265em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.588em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.111em, 1002.47em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-291"><span class="mi" id="MathJax-Span-292" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-293" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-294"><span style="display: inline-block; position: relative; width: 1.049em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.56em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-295" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.618em;"><span class="mn" id="MathJax-Span-296" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-297" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.542em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-38">O(n^2)</script> solution. Do you have a reference?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252330 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252330 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252330">
                <li>
<div class="comment" commentid="1252338">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252338" commentparentid="1252330">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Coder" title="International Grandmaster Coder" class="rated-user user-red">Coder</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/02/2025 22:41 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252338" commentparentid="1252330">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Coder" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/715/avatar/d31faffb4f8f21a.jpg">        </a>
        <div><a href="/profile/Coder" title="International Grandmaster Coder" class="rated-user user-red">Coder</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/02/2025 22:41 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252338" href="?#comment-1252338" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1252330" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252338" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="715" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252338">
                        <div class="moveup">
                        <div class="ttypography"><p>I read in this <a href="https://web.cs.unlv.edu/larmore/Research/lopsided.pdf">article</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252338 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252338 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252338">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1252496">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252496" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Adhithyasena" title="Newbie Adhithyasena" class="rated-user user-gray">Adhithyasena</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/03/2025 14:46 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252496" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Adhithyasena" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/Adhithyasena" title="Newbie Adhithyasena" class="rated-user user-gray">Adhithyasena</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/03/2025 14:46 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252496" href="?#comment-1252496" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252496" class="CommentVoteFrame" myvotedirection="0" data-commentrating="-31" data-commentuserid="3805646" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-31</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252496">
                        <div class="moveup">
                        <div class="ttypography"><p>I have used ide one so it may be the reason for coinciding the solution</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252496 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252496 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252496">
        </ul>
    </div>
</div>

<div class="comment" commentid="1252619">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252619" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/KiKoS" title="Candidate Master KiKoS" class="rated-user user-violet">KiKoS</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/04/2025 11:21 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">7</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252619" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/KiKoS" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/473219/avatar/a382879284586aa0.jpg">        </a>
        <div><a href="/profile/KiKoS" title="Candidate Master KiKoS" class="rated-user user-violet">KiKoS</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/04/2025 11:21 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252619" href="?#comment-1252619" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1252619" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252619" class="CommentVoteFrame" myvotedirection="0" data-commentrating="18" data-commentuserid="473219" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+18</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252619">
                        <div class="moveup">
                        <div class="ttypography"><p>I have two solutions for K: the one we didn't believe in during the onsite (passing in 1930ms on CF) and the one that I think more or less matches the intended:</p><p>AC 1900ms: Kuhn on graph where left part has numbers we are matching to (<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-298" style="width: 3.326em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.649em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1002.65em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-299"><span class="mi" id="MathJax-Span-300" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-301" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-302" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-303" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-304" style="font-family: MathJax_Main; padding-left: 0.249em;">⋅</span><span class="mi" id="MathJax-Span-305" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">j</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-39">a[i] \cdot j</script>), right part is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-306" style="width: 0.495em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.372em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1000.31em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-307"><span class="mi" id="MathJax-Span-308" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-40">i</script>. We build <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-309" style="width: 3.265em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.588em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.111em, 1002.47em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-310"><span class="mi" id="MathJax-Span-311" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-312" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-313"><span style="display: inline-block; position: relative; width: 1.049em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.56em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-314" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.618em;"><span class="mn" id="MathJax-Span-315" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-316" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.542em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-41">O(n^2)</script> edges in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-317" style="width: 5.111em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.065em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.111em, 1003.94em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-318"><span class="mi" id="MathJax-Span-319" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-320" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-321"><span style="display: inline-block; position: relative; width: 1.049em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.56em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-322" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.618em;"><span class="mn" id="MathJax-Span-323" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mi" id="MathJax-Span-324" style="font-family: MathJax_Main; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-325" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.542em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-42">O(n^2\log)</script> (or with hashtable lookup, but it seems sorting would be faster). Then Kuhn with 2 default optimizations: timer-based <code class="tt">used[v]</code> for O(1) clear on each successful path found, and <code class="tt">shuffle(all(g[v]), rng)</code> so we don't go too often into the same vertex and hopefully find a free index to pair with in first elements of adjacency list. Overall it should be <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-326" style="width: 3.265em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.588em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.111em, 1002.47em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-327"><span class="mi" id="MathJax-Span-328" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-329" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-330"><span style="display: inline-block; position: relative; width: 1.049em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.56em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-331" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.618em;"><span class="mn" id="MathJax-Span-332" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-333" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.542em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-43">O(n^3)</script> as we have <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-334" style="width: 0.803em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.618em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.62em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-335"><span class="mi" id="MathJax-Span-336" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-44">n</script> vertices and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-337" style="width: 1.357em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.049em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.111em, 1001.05em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-338"><span class="msubsup" id="MathJax-Span-339"><span style="display: inline-block; position: relative; width: 1.049em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.56em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-340" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.618em;"><span class="mn" id="MathJax-Span-341" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-45">n^2</script> edges, but in reality <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-342" style="width: 3.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.526em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.111em, 1002.53em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-343"><span class="msubsup" id="MathJax-Span-344"><span style="display: inline-block; position: relative; width: 1.049em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.56em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-345" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.618em;"><span class="mn" id="MathJax-Span-346" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mi" id="MathJax-Span-347" style="font-family: MathJax_Main; padding-left: 0.188em;">log</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.465em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-46">n^2\log</script> construction part took most of the time in my TL upsolving attempts. <a href="/contest/2068/submission/308915147" title="Submission 308915147 by KiKoS">308915147</a></p><p>AC 1300ms: on failed path push, remove all future and existing edges to right-part vertices that we failed to propagate the path from. Each time we fail we watched X edges and we remove more than X edges, and we succeeded <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-348" style="width: 0.803em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.618em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.62em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-349"><span class="mi" id="MathJax-Span-350" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-47">n</script> times so it's more or less clear why it's <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-351" style="width: 3.634em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.895em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1002.77em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-352"><span class="mi" id="MathJax-Span-353" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-354" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-355" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-356" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-357" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-48">O(nE)</script> and it's also fast because most of successful steps require much less than <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-358" style="width: 0.926em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1000.74em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-359"><span class="mi" id="MathJax-Span-360" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-49">E</script> for dfs. Here <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-361" style="width: 0.926em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1000.74em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-362"><span class="mi" id="MathJax-Span-363" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-50">E</script> should be something close to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-364" style="width: 5.48em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.372em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1004.25em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-365"><span class="mi" id="MathJax-Span-366" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-367" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-368" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-369" style="font-family: MathJax_Main; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-370"></span><span class="mi" id="MathJax-Span-371" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">n</span><span class="mo" id="MathJax-Span-372" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-51">O(n\log n)</script> as this is pretty close to the jury's solution (though it is done a bit backwards). <a href="/contest/2068/submission/308914819" title="Submission 308914819 by KiKoS">308914819</a></p><p>Is it supposed to be this way? The gap between two solutions in terms of how hard it is to come up with is pretty big. The first one really just squeezes in TL tightly. The second one is not so fast itself. Was it the same experience for the onsite participants with 5+ attempts?</p><p>Would appreciate some comments in general as well. I am thinking a lot now on this "remove edges for not-pushed vertices" optimization and how useful it could be in other problems</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252619 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252619 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252619">
                <li>
<div class="comment" commentid="1252662">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252662" commentparentid="1252619">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Egor" title="International Grandmaster Egor" class="rated-user user-red">Egor</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/04/2025 15:30 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">3</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252662" commentparentid="1252619">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Egor" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/838/avatar/6976bef0cdef7d5c.jpg"><img title="Badge of honor for supporting Codeforces on its 10th anniversary" src="//codeforces.com/codeforces.org/s/52448/images/if_medal-bronze-blue_46108.png" style="position:absolute;bottom:-4px;right:-6px">        </a>
        <div><a href="/profile/Egor" title="International Grandmaster Egor" class="rated-user user-red">Egor</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/04/2025 15:30 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252662" href="?#comment-1252662" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1252619" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252662" class="CommentVoteFrame" myvotedirection="0" data-commentrating="8" data-commentuserid="838" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+8</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252662">
                        <div class="moveup">
                        <div class="ttypography"><p>We wanted second kind of solution to pass, unfortunately that meant that some very optimized aproaches like first one would pass as well</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252662 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252662 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252662">
                <li>
<div class="comment" commentid="1252668">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252668" commentparentid="1252662">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/KiKoS" title="Candidate Master KiKoS" class="rated-user user-violet">KiKoS</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/04/2025 16:37 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">2</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252668" commentparentid="1252662">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/KiKoS" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/473219/avatar/a382879284586aa0.jpg">        </a>
        <div><a href="/profile/KiKoS" title="Candidate Master KiKoS" class="rated-user user-violet">KiKoS</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/04/2025 16:37 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252668" href="?#comment-1252668" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1252662" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1252668" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252668" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="473219" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252668">
                        <div class="moveup">
                        <div class="ttypography"><p>Is it true, btw, that the second solution is exactly the same as maxflow from the editorial to the extent where one node is split into several? Instead of left to right it makes the graph right to left, but seems like no extra steps are involved (maybe additional <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-373" style="width: 1.972em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.542em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1001.54em, 2.403em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-374"><span class="mo" id="MathJax-Span-375" style="font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-376" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.15em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-52">+E</script>)</p><p>TBH I still don't get the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-377" style="width: 5.48em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.372em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1004.25em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-378"><span class="mi" id="MathJax-Span-379" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-380" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-381" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-382" style="font-family: MathJax_Main; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-383"></span><span class="mi" id="MathJax-Span-384" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">n</span><span class="mo" id="MathJax-Span-385" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-53">O(n\log n)</script> bound on edges so for me both solutions seem like a hyper-optimized cubic one :)</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252668 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252668 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252668">
                <li>
<div class="comment" commentid="1252819">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252819" commentparentid="1252668">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/dario2994" title="International Grandmaster dario2994" class="rated-user user-red">dario2994</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/05/2025 14:54 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252819" commentparentid="1252668">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/dario2994" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/dario2994" title="International Grandmaster dario2994" class="rated-user user-red">dario2994</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/05/2025 14:54 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252819" href="?#comment-1252819" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1252668" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252819" class="CommentVoteFrame" myvotedirection="0" data-commentrating="18" data-commentuserid="50632" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+18</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252819">
                        <div class="moveup">
                        <div class="ttypography"><p>I don't know if <a class="rated-user user-legendary" href="/profile/Egor" title="Legendary Grandmaster Egor"><span class="legendary-user-first-letter">E</span>gor</a> can prove the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-386" style="width: 5.48em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.372em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1004.25em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-387"><span class="mi" id="MathJax-Span-388" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-389" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-390" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-391" style="font-family: MathJax_Main; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-392"></span><span class="mi" id="MathJax-Span-393" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">n</span><span class="mo" id="MathJax-Span-394" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-54">O(n\log n)</script> bound. As far as I know, the best we can show is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-395" style="width: 6.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.418em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.111em, 1005.29em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-396"><span class="mi" id="MathJax-Span-397" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-398" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-399" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-400" style="font-family: MathJax_Main; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-401"></span><span class="mo" id="MathJax-Span-402" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-403" style="font-family: MathJax_Math-italic;">n</span><span class="msubsup" id="MathJax-Span-404"><span style="display: inline-block; position: relative; width: 0.803em; height: 0px;"><span style="position: absolute; clip: rect(3.08em, 1000.31em, 4.434em, -999.997em); top: -3.997em; left: 0em;"><span class="mo" id="MathJax-Span-405" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -4.366em; left: 0.372em;"><span class="mn" id="MathJax-Span-406" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-407" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.542em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-55">O(n\log(n)^2)</script>. The proof is a bit long and the crucial step is contained in <a href="https://glaudo.github.io/files/hap_bound.pdf">this short note</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252819 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252819 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252819">
                <li>
<div class="comment" commentid="1252820">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252820" commentparentid="1252819">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/bicsi" title="Grandmaster bicsi" class="rated-user user-red">bicsi</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/05/2025 15:03 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252820" commentparentid="1252819">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/bicsi" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/288135/avatar/2734fdad1c791b13.jpg">        </a>
        <div><a href="/profile/bicsi" title="Grandmaster bicsi" class="rated-user user-red">bicsi</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/05/2025 15:03 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252820" href="?#comment-1252820" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1252819" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252820" class="CommentVoteFrame" myvotedirection="0" data-commentrating="16" data-commentuserid="288135" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+16</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252820">
                        <div class="moveup">
                        <div class="ttypography"><p>Citing oneself like a true researcher.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252820 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252820 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252820">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
                <li>
<div class="comment" commentid="1252746">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252746" commentparentid="1252619">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/tfg" title="International Master tfg" class="rated-user user-orange">tfg</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/05/2025 05:02 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252746" commentparentid="1252619">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/tfg" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/tfg" title="International Master tfg" class="rated-user user-orange">tfg</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/05/2025 05:02 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252746" href="?#comment-1252746" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1252619" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252746" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="456977" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252746">
                        <div class="moveup">
                        <div class="ttypography"><p>I did Kuhn using bitsets instead of adjacency lists just simulating the problem in the stupidest way possible and it passed in 671ms <a href="https://codeforces.com/contest/2068/submission/309010517">https://codeforces.com/contest/2068/submission/309010517</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252746 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252746 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252746">
        </ul>
    </div>
</div>
</li>
                <li>
<div class="comment" commentid="1252825">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252825" commentparentid="1252619">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/miss_robot" title="Master miss_robot" class="rated-user user-orange">miss_robot</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/05/2025 16:03 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252825" commentparentid="1252619">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/miss_robot" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/911077/avatar/42c90a741eb7e8a7.jpg">        </a>
        <div><a href="/profile/miss_robot" title="Master miss_robot" class="rated-user user-orange">miss_robot</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/05/2025 16:03 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252825" href="?#comment-1252825" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1252619" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252825" class="CommentVoteFrame" myvotedirection="0" data-commentrating="16" data-commentuserid="911077" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+16</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252825">
                        <div class="moveup">
                        <div class="ttypography"><p>We implemented the binary search plus Kuhn's algorithm with standard optimizations in the onsite contest with one additional observation: You can always match the first occurrence of some a_i with time a_i, which basically halves n. To our surprise, this got accepted first try although its complexity should be O(n^3 log n). I experimented with it a little on Codeforces <a href="https://codeforces.com/contest/2068/submission/309081742">https://codeforces.com/contest/2068/submission/309081742</a> and it's not even close to the timelimit (0.5 seconds). Even when disabling one of the optimizations, it still comfortably fits the timelimit, multiple optimizations have to be removed for it to fail. I wonder if that was intended :)</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252825 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252825 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252825">
                <li>
<div class="comment" commentid="1252845">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252845" commentparentid="1252825">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/KiKoS" title="Candidate Master KiKoS" class="rated-user user-violet">KiKoS</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/05/2025 18:28 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252845" commentparentid="1252825">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/KiKoS" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/473219/avatar/a382879284586aa0.jpg">        </a>
        <div><a href="/profile/KiKoS" title="Candidate Master KiKoS" class="rated-user user-violet">KiKoS</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/05/2025 18:28 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252845" href="?#comment-1252845" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1252825" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1252845" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252845" class="CommentVoteFrame" myvotedirection="0" data-commentrating="16" data-commentuserid="473219" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+16</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252845">
                        <div class="moveup">
                        <div class="ttypography"><p>OMG it feels like bravery was rewarded in this problem. We got too scared by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-408" style="width: 5.049em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.003em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1003.94em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-409"><span class="mi" id="MathJax-Span-410" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-411" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mn" id="MathJax-Span-412" style="font-family: MathJax_Main; padding-left: 0.311em;">2000</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-56">n = 2000</script> and completely ignored our binsearch + perfect matching idea. And it even runs faster than my implementation of what I thought to be the same as model solution...</p><p>I can see why it runs fast. If everything is the same, you basically get <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-413" style="width: 0.803em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.618em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.62em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-414"><span class="mi" id="MathJax-Span-415" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-57">n</script> edges. If everything is different, you get perfect matching from the first try. And in between — well, yeah, it halves, and also you should have enough vacant numbers when you take <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-416" style="width: 1.049em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.803em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1000.8em, 2.711em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-417"><span class="mfrac" id="MathJax-Span-418"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px; margin-right: 0.126em; margin-left: 0.126em;"><span style="position: absolute; clip: rect(3.511em, 1000.43em, 4.188em, -999.997em); top: -4.428em; left: 50%; margin-left: -0.182em;"><span class="mi" id="MathJax-Span-419" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(3.326em, 1000.31em, 4.188em, -999.997em); top: -3.628em; left: 50%; margin-left: -0.182em;"><span class="mn" id="MathJax-Span-420" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(0.865em, 1000.56em, 1.295em, -999.997em); top: -1.351em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.557em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.111em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.535em; border-left: 0px solid; width: 0px; height: 1.619em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-58">\frac{n}{2}</script> different <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-421" style="width: 1.111em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.87em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-422"><span class="msubsup" id="MathJax-Span-423"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-424" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.557em;"><span class="mi" id="MathJax-Span-425" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-59">a_i</script>'s and generate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-426" style="width: 3.203em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.526em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1002.53em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-427"><span class="msubsup" id="MathJax-Span-428"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-429" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.557em;"><span class="mi" id="MathJax-Span-430" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-431" style="font-family: MathJax_Main; padding-left: 0.249em;">×</span><span class="mi" id="MathJax-Span-432" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">j</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-60">a_i \times j</script>, as each two generator's can't overlap on more than half occurrences.</p><p>What can I say, well-deserved qualification to WF, congrats!</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252845 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252845 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252845">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1252630">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252630" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/SomethingNew" title="Legendary Grandmaster SomethingNew" class="rated-user user-legendary"><span class="legendary-user-first-letter">S</span>omethingNew</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/04/2025 12:40 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252630" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/SomethingNew" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/1297842/avatar/62e708ed1a975ccc.jpg">        </a>
        <div><a href="/profile/SomethingNew" title="Legendary Grandmaster SomethingNew" class="rated-user user-legendary"><span class="legendary-user-first-letter">S</span>omethingNew</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/04/2025 12:40 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252630" href="?#comment-1252630" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252630" class="CommentVoteFrame" myvotedirection="0" data-commentrating="18" data-commentuserid="1297842" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+18</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252630">
                        <div class="moveup">
                        <div class="ttypography"><p>there is O((n+m) log (n+m)) solution in E if we consider edges not in the BFS traversal as taking the minimum along vertical paths and update all of them offline using binary lifting.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252630 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252630 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252630">
                <li>
<div class="comment" commentid="1252808">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252808" commentparentid="1252630">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/jeroenodb" title="Legendary Grandmaster jeroenodb" class="rated-user user-legendary"><span class="legendary-user-first-letter">j</span>eroenodb</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/05/2025 13:41 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252808" commentparentid="1252630">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/jeroenodb" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/jeroenodb" title="Legendary Grandmaster jeroenodb" class="rated-user user-legendary"><span class="legendary-user-first-letter">j</span>eroenodb</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/05/2025 13:41 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252808" href="?#comment-1252808" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1252630" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1252808" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252808" class="CommentVoteFrame" myvotedirection="0" data-commentrating="18" data-commentuserid="1522219" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+18</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252808">
                        <div class="moveup">
                        <div class="ttypography"><p>And with the linear memory lifting <a href="https://codeforces.com/blog/entry/74847">Blog</a>, you can even make it <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-433" style="width: 2.711em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.157em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1002.03em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-434"><span class="mi" id="MathJax-Span-435" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-436" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-437" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-438" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-61">O(n)</script> memory, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-439" style="width: 5.48em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.372em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1004.25em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-440"><span class="mi" id="MathJax-Span-441" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-442" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-443" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-444" style="font-family: MathJax_Main; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-445"></span><span class="mi" id="MathJax-Span-446" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">n</span><span class="mo" id="MathJax-Span-447" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-62">O(n \log n)</script> time, with a low constant. </p><p>I wonder if the algorithm (theoretically) can be optimized to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-448" style="width: 5.418em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.311em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1004.19em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-449"><span class="mi" id="MathJax-Span-450" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-451" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-452" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-453" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mi" id="MathJax-Span-454" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">m</span><span class="mo" id="MathJax-Span-455" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-63">O(n+m)</script> overall (the dijkstra part probably can be, as all the distances will stay <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-456" style="width: 2.711em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.157em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1002.03em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-457"><span class="mi" id="MathJax-Span-458" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-459" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-460" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-461" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-64">O(n)</script>). But this tree DS part is maybe hard. LCA's can be calculated with some complicated stuff in linear time. There are some <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-462" style="width: 0.618em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.495em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1000.5em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-463"><span class="mi" id="MathJax-Span-464" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-65">k</script>th ancestor algorithms that work in linear build time, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-465" style="width: 2.588em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.034em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1001.91em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-466"><span class="mi" id="MathJax-Span-467" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-468" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-469" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-470" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-66">O(1)</script> queries, but I don't know if they can be augmented to also do the offline range min= path queries.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252808 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252808 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252808">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1252645">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252645" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/tfgs" title="Expert tfgs" class="rated-user user-blue">tfgs</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/04/2025 13:49 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252645" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/tfgs" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/tfgs" title="Expert tfgs" class="rated-user user-blue">tfgs</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/04/2025 13:49 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252645" href="?#comment-1252645" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252645" class="CommentVoteFrame" myvotedirection="0" data-commentrating="10" data-commentuserid="2374914" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+10</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252645">
                        <div class="moveup">
                        <div class="ttypography"><p>Why is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-471" style="width: 8.188em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.526em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1006.4em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-472"><span class="mi" id="MathJax-Span-473" style="font-family: MathJax_Math-italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-474" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mi" id="MathJax-Span-475" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">O</span><span class="mo" id="MathJax-Span-476" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-477" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-478" style="font-family: MathJax_Main; padding-left: 0.188em;">log</span><span class="mo" id="MathJax-Span-479"></span><span class="mi" id="MathJax-Span-480" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">n</span><span class="mo" id="MathJax-Span-481" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-67">E = O(n \log n)</script> in problem K?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252645 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252645 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252645">
        </ul>
    </div>
</div>

<div class="comment" commentid="1252697">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252697" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/vidhitts" title="Newbie vidhitts" class="rated-user user-gray">vidhitts</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/04/2025 19:03 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252697" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/vidhitts" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/vidhitts" title="Newbie vidhitts" class="rated-user user-gray">vidhitts</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/04/2025 19:03 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252697" href="?#comment-1252697" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252697" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4174727" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252697">
                        <div class="moveup">
                        <div class="ttypography"><p>nice solution</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252697 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252697 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252697">
        </ul>
    </div>
</div>

<div class="comment" commentid="1252806">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1252806" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/lotusblume" title="International Grandmaster lotusblume" class="rated-user user-red">lotusblume</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/05/2025 13:16 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1252806" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/lotusblume" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/lotusblume" title="International Grandmaster lotusblume" class="rated-user user-red">lotusblume</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/05/2025 13:16 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1252806" href="?#comment-1252806" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1252806" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1252806" class="CommentVoteFrame" myvotedirection="0" data-commentrating="19" data-commentuserid="2487141" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+19</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1252806">
                        <div class="moveup">
                        <div class="ttypography"><p>In the editorial for problem E, in the part for "Computing f assuming we know g" it says:</p> <blockquote><p>Set <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-482" style="width: 4.557em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.634em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1003.57em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-483"><span class="mi" id="MathJax-Span-484" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-485" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-486" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-487" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-488" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mn" id="MathJax-Span-489" style="font-family: MathJax_Main; padding-left: 0.311em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-68">f[n]=0</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-490" style="width: 5.972em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.742em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1004.62em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-491"><span class="mi" id="MathJax-Span-492" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-493" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-494" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-495" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-496" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mi" id="MathJax-Span-497" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-498" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-499" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-500" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-69">f[v]=g(v)</script> for all other <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-501" style="width: 0.618em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.495em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.5em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-502"><span class="mi" id="MathJax-Span-503" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-70">v</script>. Now process each vertex in the following way. Pick the unprocessed vertex <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-504" style="width: 0.618em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.495em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.5em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-505"><span class="mi" id="MathJax-Span-506" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-71">v</script> with the lowest current value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-507" style="width: 2.034em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.603em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1001.48em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-508"><span class="mi" id="MathJax-Span-509" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-510" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-511" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-512" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-72">f[v]</script>. Process <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-513" style="width: 0.618em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.495em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.5em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-514"><span class="mi" id="MathJax-Span-515" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-73">v</script> by iterating through all vertices <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-516" style="width: 0.742em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.56em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-517"><span class="mi" id="MathJax-Span-518" style="font-family: MathJax_Math-italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-74">u</script> adjacent to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-519" style="width: 0.618em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.495em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.5em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-520"><span class="mi" id="MathJax-Span-521" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-75">v</script> and setting <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-522" style="width: 17.234em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.788em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1013.66em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-523"><span class="mi" id="MathJax-Span-524" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-525" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-526" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-527" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-528" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mi" id="MathJax-Span-529" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">m</span><span class="mi" id="MathJax-Span-530" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-531" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-532" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-533" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-534" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-535" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-536" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-537" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-538" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">m</span><span class="mi" id="MathJax-Span-539" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-540" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-541" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-542" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-543" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mi" id="MathJax-Span-544" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-545" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-546" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-547" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-548" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-549" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-76">f[v]=max(g[v],min(1+f[u]))</script>.</p> </blockquote><p>I don't think this works on the first sample. </p> <div class="spoiler"><b class="spoiler-title">Graph of first sample with g values</b><div class="spoiler-content" style="display: none;"><p><a href="https://ibb.co/Xx4XPp8L"><img alt="signal-2025-03-05-133057-002" border="0" src="/predownloaded/f4/22/f422e6509f30c7a051d7143a656f65c68e0863ac.jpg" style="max-width: 100.0%;max-height: 100.0%;"></a></p></div></div><p>The procedure would do the following:</p> <ol>   <li><p>Initialize <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-550" style="width: 0.742em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1000.56em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-551"><span class="mi" id="MathJax-Span-552" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.312em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-77">f</script> as <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-553" style="width: 24.311em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.449em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1019.39em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-554"><span class="mi" id="MathJax-Span-555" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-556" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-557" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-558" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-559" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mn" id="MathJax-Span-560" style="font-family: MathJax_Main; padding-left: 0.311em;">3</span><span class="mo" id="MathJax-Span-561" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-562" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-563" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-564" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-565" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-566" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mn" id="MathJax-Span-567" style="font-family: MathJax_Main; padding-left: 0.311em;">4</span><span class="mo" id="MathJax-Span-568" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-569" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-570" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-571" style="font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-572" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-573" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mn" id="MathJax-Span-574" style="font-family: MathJax_Main; padding-left: 0.311em;">3</span><span class="mo" id="MathJax-Span-575" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-576" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-577" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-578" style="font-family: MathJax_Main;">4</span><span class="mo" id="MathJax-Span-579" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-580" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mn" id="MathJax-Span-581" style="font-family: MathJax_Main; padding-left: 0.311em;">4</span><span class="mo" id="MathJax-Span-582" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-583" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-584" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-585" style="font-family: MathJax_Main;">5</span><span class="mo" id="MathJax-Span-586" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-587" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mn" id="MathJax-Span-588" style="font-family: MathJax_Main; padding-left: 0.311em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-78">f[1] = 3, f[2] = 4, f[3] = 3, f[4] = 4, f[5] = 0</script></p></li>   <li><p>Pick <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-589" style="width: 3.018em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.403em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1002.34em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-590"><span class="mi" id="MathJax-Span-591" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-592" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mn" id="MathJax-Span-593" style="font-family: MathJax_Main; padding-left: 0.311em;">5</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-79">v = 5</script> and set <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-594" style="width: 24.434em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.511em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1019.45em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-595"><span class="mi" id="MathJax-Span-596" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-597" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-598" style="font-family: MathJax_Main;">5</span><span class="mo" id="MathJax-Span-599" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-600" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mi" id="MathJax-Span-601" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">m</span><span class="mi" id="MathJax-Span-602" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-603" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-604" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-605" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-606" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-607" style="font-family: MathJax_Main;">5</span><span class="mo" id="MathJax-Span-608" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-609" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-610" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">m</span><span class="mi" id="MathJax-Span-611" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-612" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-613" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-614" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-615" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mi" id="MathJax-Span-616" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-617" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-618" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-619" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-620" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-621" style="font-family: MathJax_Main; padding-left: 0.188em;">1</span><span class="mo" id="MathJax-Span-622" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mi" id="MathJax-Span-623" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-624" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-625" style="font-family: MathJax_Main;">4</span><span class="mo" id="MathJax-Span-626" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-627" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-628" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-629" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mn" id="MathJax-Span-630" style="font-family: MathJax_Main; padding-left: 0.311em;">5</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-80">f[5] = max(g[5], min(1 + f[2], 1 + f[4])) = 5</script></p></li>   <li><p>Pick <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-631" style="width: 3.018em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.403em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1002.34em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-632"><span class="mi" id="MathJax-Span-633" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-634" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mn" id="MathJax-Span-635" style="font-family: MathJax_Main; padding-left: 0.311em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-81">v = 1</script> and set <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-636" style="width: 24.434em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.511em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1019.51em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-637"><span class="mi" id="MathJax-Span-638" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-639" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-640" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-641" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-642" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mi" id="MathJax-Span-643" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">m</span><span class="mi" id="MathJax-Span-644" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-645" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-646" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-647" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-648" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-649" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-650" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-651" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-652" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">m</span><span class="mi" id="MathJax-Span-653" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-654" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-655" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-656" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-657" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mi" id="MathJax-Span-658" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-659" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-660" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-661" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-662" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-663" style="font-family: MathJax_Main; padding-left: 0.188em;">1</span><span class="mo" id="MathJax-Span-664" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mi" id="MathJax-Span-665" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.065em;"></span></span><span class="mo" id="MathJax-Span-666" style="font-family: MathJax_Main;">[</span><span class="mn" id="MathJax-Span-667" style="font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-668" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-669" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-670" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-671" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mn" id="MathJax-Span-672" style="font-family: MathJax_Main; padding-left: 0.311em;">4</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-82">f[1] = max(g[1], min(1 + f[2], 1 + f[3])) = 4</script></p></li>   <li><p>...</p></li> </ol><p>But the correct answer of f[1] should be 5. Am I misunderstanding something?</p><p>I got AC by modifying the procedure to </p> <div class="spoiler"><b class="spoiler-title">this</b><div class="spoiler-content" style="display: none;"><p>Set <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-673" style="width: 4.656em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.52em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1003.47em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-674"><span class="mi" id="MathJax-Span-675" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-676" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-677" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-678" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-679" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mn" id="MathJax-Span-680" style="font-family: MathJax_Main; padding-left: 0.273em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-83">f[n]=0</script> <s>and f[v]=g(v) for all other v</s> <strong>and set n active</strong>. Now process each vertex in the following way. Pick the unprocessed <strong>active</strong> vertex <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-681" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.49em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-682"><span class="mi" id="MathJax-Span-683" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-84">v</script> with the lowest <s>current</s> value of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-684" style="width: 2.113em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.572em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1001.46em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-685"><span class="mi" id="MathJax-Span-686" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-687" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-688" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-689" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-85">f[v]</script>. Process <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-690" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.49em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-691"><span class="mi" id="MathJax-Span-692" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-86">v</script> by iterating through all <strong>inactive</strong> vertices <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-693" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-694"><span class="mi" id="MathJax-Span-695" style="font-family: MathJax_Math-italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-87">u</script> adjacent to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-696" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.49em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-697"><span class="mi" id="MathJax-Span-698" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-88">v</script> and setting <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-699" style="width: 16.074em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.178em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1012.07em, 2.654em, -999.997em); top: -2.216em; left: 0em;"><span class="mrow" id="MathJax-Span-700"><span class="texatom" id="MathJax-Span-701"><span class="mrow" id="MathJax-Span-702"><span class="mi" id="MathJax-Span-703" style="font-family: MathJax_Main-bold;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.111em;"></span></span><span class="mo" id="MathJax-Span-704" style="font-family: MathJax_Main-bold;">[</span><span class="mi" id="MathJax-Span-705" style="font-family: MathJax_Main-bold;">u</span><span class="mo" id="MathJax-Span-706" style="font-family: MathJax_Main-bold;">]</span><span class="mo" id="MathJax-Span-707" style="font-family: MathJax_Main-bold; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-708" style="font-family: MathJax_Main-bold; padding-left: 0.273em;">m</span><span class="mi" id="MathJax-Span-709" style="font-family: MathJax_Main-bold;">a</span><span class="mi" id="MathJax-Span-710" style="font-family: MathJax_Main-bold;">x</span><span class="mo" id="MathJax-Span-711" style="font-family: MathJax_Main-bold;">(</span><span class="mi" id="MathJax-Span-712" style="font-family: MathJax_Main-bold;">g</span><span class="mo" id="MathJax-Span-713" style="font-family: MathJax_Main-bold;">[</span><span class="mi" id="MathJax-Span-714" style="font-family: MathJax_Main-bold;">u</span><span class="mo" id="MathJax-Span-715" style="font-family: MathJax_Main-bold;">]</span><span class="mo" id="MathJax-Span-716" style="font-family: MathJax_Main-bold;">,</span><span class="mn" id="MathJax-Span-717" style="font-family: MathJax_Main-bold; padding-left: 0.165em;">1</span><span class="mo" id="MathJax-Span-718" style="font-family: MathJax_Main-bold; padding-left: 0.219em;">+</span><span class="mi" id="MathJax-Span-719" style="font-family: MathJax_Main-bold; padding-left: 0.219em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.111em;"></span></span><span class="mo" id="MathJax-Span-720" style="font-family: MathJax_Main-bold;">[</span><span class="mi" id="MathJax-Span-721" style="font-family: MathJax_Main-bold;">v</span><span class="mo" id="MathJax-Span-722" style="font-family: MathJax_Main-bold;">]</span><span class="mo" id="MathJax-Span-723" style="font-family: MathJax_Main-bold;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.221em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-89">\mathbf{f[u]=max(g[u],1+f[v])}</script> <strong>and setting u active</strong>.</p></div></div></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1252806 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1252806 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1252806">
                <li>
<div class="comment" commentid="1253856">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1253856" commentparentid="1252806">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/gangsterveggies" title="Master gangsterveggies" class="rated-user user-orange">gangsterveggies</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/10/2025 18:16 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1253856" commentparentid="1252806">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/gangsterveggies" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/gangsterveggies" title="Master gangsterveggies" class="rated-user user-orange">gangsterveggies</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/10/2025 18:16 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1253856" href="?#comment-1253856" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1252806" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1253856" class="CommentVoteFrame" myvotedirection="0" data-commentrating="10" data-commentuserid="45323" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+10</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1253856">
                        <div class="moveup">
                        <div class="ttypography"><p>You're right, there is a typo, thanks for pointing it out! The vertex being updated should be <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-724" style="width: 0.742em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.56em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-725"><span class="mi" id="MathJax-Span-726" style="font-family: MathJax_Math-italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-90">u</script> and not <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-727" style="width: 0.618em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.495em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.5em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-728"><span class="mi" id="MathJax-Span-729" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-91">v</script>, like you pointed out in the modified procedure (otherwise this isn't compatible with the proof of the lemma). I believe the rest can stay the same. Your modified version is correct, but unless I am missing something, the initial version can be fixed if we just fix the update method.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1253856 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1253856 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1253856">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1253674">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1253674" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/miss_robot" title="Master miss_robot" class="rated-user user-orange">miss_robot</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/10/2025 11:24 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1253674" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/miss_robot" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/911077/avatar/42c90a741eb7e8a7.jpg">        </a>
        <div><a href="/profile/miss_robot" title="Master miss_robot" class="rated-user user-orange">miss_robot</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/10/2025 11:24 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1253674" href="?#comment-1253674" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1253674" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="911077" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1253674">
                        <div class="moveup">
                        <div class="ttypography"><p>E is a really beautiful problem, thank you! I found an easier way to calculate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-730" style="width: 2.157em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.726em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1001.6em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-731"><span class="mi" id="MathJax-Span-732" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-733" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-734" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-735" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-92">g(v)</script> that doesn't need DSU or the lazy propagator (though I don't understand what exactly it does in the editorial).</p><p>If we want to use a non-tree edge <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-736" style="width: 2.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.28em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1002.16em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-737"><span class="mo" id="MathJax-Span-738" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-739" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-740" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-741" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">v</span><span class="mo" id="MathJax-Span-742" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-93">(u,v)</script> at some node <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-743" style="width: 0.926em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.74em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-744"><span class="mi" id="MathJax-Span-745" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-94">w</script>, then exactly one of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-746" style="width: 0.742em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.56em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-747"><span class="mi" id="MathJax-Span-748" style="font-family: MathJax_Math-italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-95">u</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-749" style="width: 0.618em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.495em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.5em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-750"><span class="mi" id="MathJax-Span-751" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-96">v</script> must be in the subtree of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-752" style="width: 0.926em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.74em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-753"><span class="mi" id="MathJax-Span-754" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-97">w</script>, which is equivalent to saying that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-98-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-755" style="width: 0.926em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.74em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-756"><span class="mi" id="MathJax-Span-757" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-98">w</script> is in the subtree of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-758" style="width: 4.495em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.572em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1003.45em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-759"><span class="mi" id="MathJax-Span-760" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-761" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-762" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-763" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-764" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-765" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-766" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">v</span><span class="mo" id="MathJax-Span-767" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-99">lca(u,v)</script>, but is not the LCA itself, and at least one of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-100-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-768" style="width: 0.742em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.56em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-769"><span class="mi" id="MathJax-Span-770" style="font-family: MathJax_Math-italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-100">u</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-101-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-771" style="width: 0.618em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.495em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.5em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-772"><span class="mi" id="MathJax-Span-773" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-101">v</script> is in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-102-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-774" style="width: 0.926em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.74em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-775"><span class="mi" id="MathJax-Span-776" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-102">w</script>'s subtree. If we denote by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-103-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-777" style="width: 3.265em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.588em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1002.47em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-778"><span class="mi" id="MathJax-Span-779" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-780" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-781" style="font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-782" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-783" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-784" style="font-family: MathJax_Main;">[</span><span class="mo" id="MathJax-Span-785" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-103">level[]</script> the distance to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-104-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-786" style="width: 0.803em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.618em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.62em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-787"><span class="mi" id="MathJax-Span-788" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-104">n</script>, then the path using the non-tree edge <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-105-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-789" style="width: 2.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.28em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1002.16em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-790"><span class="mo" id="MathJax-Span-791" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-792" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-793" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-794" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">v</span><span class="mo" id="MathJax-Span-795" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-105">(u,v)</script> from <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-106-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-796" style="width: 0.926em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.742em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.74em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-797"><span class="mi" id="MathJax-Span-798" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-106">w</script> will have length <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-107-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-799" style="width: 17.357em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.849em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1013.73em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-800"><span class="mi" id="MathJax-Span-801" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-802" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-803" style="font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-804" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-805" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-806" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-807" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-808" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-809" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mi" id="MathJax-Span-810" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">l</span><span class="mi" id="MathJax-Span-811" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-812" style="font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-813" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-814" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-815" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-816" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-817" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-818" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mn" id="MathJax-Span-819" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span><span class="mo" id="MathJax-Span-820" style="font-family: MathJax_Main; padding-left: 0.249em;">−</span><span class="mi" id="MathJax-Span-821" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">l</span><span class="mi" id="MathJax-Span-822" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-823" style="font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-824" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-825" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-826" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-827" style="font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-828" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-107">level[u] + level[v] + 1 - level[w]</script>. Now we can store the pair <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-108-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-829" style="width: 20.311em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.249em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1016.13em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-830"><span class="mo" id="MathJax-Span-831" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-832" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-833" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-834" style="font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-835" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-836" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-837" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-838" style="font-family: MathJax_Math-italic;">u</span><span class="mo" id="MathJax-Span-839" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-840" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mi" id="MathJax-Span-841" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">l</span><span class="mi" id="MathJax-Span-842" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-843" style="font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-844" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-845" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-846" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-847" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-848" style="font-family: MathJax_Main;">]</span><span class="mo" id="MathJax-Span-849" style="font-family: MathJax_Main; padding-left: 0.249em;">+</span><span class="mn" id="MathJax-Span-850" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span><span class="mo" id="MathJax-Span-851" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-852" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">e</span><span class="mi" id="MathJax-Span-853" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-854" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-855" style="font-family: MathJax_Math-italic;">e</span><span class="mo" id="MathJax-Span-856" style="font-family: MathJax_Main; padding-left: 0.249em;">−</span><span class="mi" id="MathJax-Span-857" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">i</span><span class="mi" id="MathJax-Span-858" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-859" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-860" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-861" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-862" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-108">(level[u] + level[v] + 1, edge-index)</script> in the sets for both <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-109-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-863" style="width: 0.742em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.56em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-864"><span class="mi" id="MathJax-Span-865" style="font-family: MathJax_Math-italic;">u</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-109">u</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-110-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-866" style="width: 0.618em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.495em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.5em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-867"><span class="mi" id="MathJax-Span-868" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-110">v</script>. Just like in the editorial, we calculate the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-111-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-869" style="width: 2.157em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.726em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1001.6em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-870"><span class="mi" id="MathJax-Span-871" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-872" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-873" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-874" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-111">g(v)</script> using DFS, doing smaller-into-larger merging. When merging, if <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-112-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-875" style="width: 7.634em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.095em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1005.97em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-876"><span class="mo" id="MathJax-Span-877" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-878" style="font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-879" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-880" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-881" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-882" style="font-family: MathJax_Math-italic;">e</span><span class="mo" id="MathJax-Span-883" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-884" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">i</span><span class="mi" id="MathJax-Span-885" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-886" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-887" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-888" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-889" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-112">(value, index)</script> is already contained in the other set, it means we are at the LCA, so we delete it instead, otherwise we insert it. After processing all children, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-113-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-890" style="width: 2.157em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.726em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1001.6em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-891"><span class="mi" id="MathJax-Span-892" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-893" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-894" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-895" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-113">g(v)</script> will be the minimum in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-114-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-896" style="width: 0.618em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.495em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.5em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-897"><span class="mi" id="MathJax-Span-898" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-114">v</script>'s set minus <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-115-Frame" tabindex="0" style=""><nobr><span class="math" id="MathJax-Span-899" style="width: 3.88em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.08em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1002.96em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-900"><span class="mi" id="MathJax-Span-901" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-902" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-903" style="font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-904" style="font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-905" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-906" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-907" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-908" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-115">level[v]</script>.</p><p><a href="https://codeforces.com/contest/2068/submission/309738458">Implementation</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1253674 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1253674 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1253674">
        </ul>
    </div>
</div>

<div class="comment" commentid="1255040">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1255040" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/cube_escape" title="Expert cube_escape" class="rated-user user-blue">cube_escape</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/13/2025 14:11 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1255040" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/cube_escape" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2127394/avatar/dfd02e640ca00e84.jpg">        </a>
        <div><a href="/profile/cube_escape" title="Expert cube_escape" class="rated-user user-blue">cube_escape</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Mar/13/2025 14:11 UTC">9 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1255040" href="?#comment-1255040" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1255040" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2127394" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1255040">
                        <div class="moveup">
                        <div class="ttypography"><p>Could someone explain Problem H to me more clearly,I cannot understand the editorial very well,very please</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1255040 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1255040 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1255040">
        </ul>
    </div>
</div>

<div class="comment" commentid="1262006">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1262006" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/AnirudhBharatiya" title="Expert AnirudhBharatiya" class="rated-user user-blue">AnirudhBharatiya</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/03/2025 07:50 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1262006" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/AnirudhBharatiya" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3483563/avatar/87f9c58605a8e7d0.jpg">        </a>
        <div><a href="/profile/AnirudhBharatiya" title="Expert AnirudhBharatiya" class="rated-user user-blue">AnirudhBharatiya</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/03/2025 07:50 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1262006" href="?#comment-1262006" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1262006" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3483563" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1262006">
                        <div class="moveup">
                        <div class="ttypography"><p>Can someone explain the dp solution for problem J used in this <a href="https://codeforces.com/contest/2068/submission/308640170">Submission</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1262006 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1262006 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1262006">
        </ul>
    </div>
</div>

<div class="comment" commentid="1271210">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1271210" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/jeroenodb" title="Legendary Grandmaster jeroenodb" class="rated-user user-legendary"><span class="legendary-user-first-letter">j</span>eroenodb</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/29/2025 12:56 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1271210" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/jeroenodb" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/jeroenodb" title="Legendary Grandmaster jeroenodb" class="rated-user user-legendary"><span class="legendary-user-first-letter">j</span>eroenodb</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Apr/29/2025 12:56 UTC">8 months ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1271210" href="?#comment-1271210" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1271210" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="1522219" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1271210">
                        <div class="moveup">
                        <div class="ttypography"><p>What's up with the checker of problem I?</p><p>I have some submission <a href="/contest/2068/submission/317737217" title="Submission 317737217 by jeroenodb">317737217</a> (which still has some bugs), but to me the output of the program seems clearly correct on the third testcase (remove the wall above the start immediately and roll the bar towards it). </p><p>Why is it graded as "Wrong answer Ball did not escape"?</p><p>pinging <a class="rated-user user-red" href="/profile/bicsi" title="Grandmaster bicsi">bicsi</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1271210 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1271210 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1271210">
        </ul>
    </div>
</div>
        <br>

<div id="editBox-154723" style="width:50em;display:none;">
    <div class="previewBody" style="border: 1px solid #d4d4d4; margin-bottom: 0.5em; padding: 0.25em; display:none;">&nbsp;</div>
    <div style="width: 1px">&nbsp;</div>
    <div class="commentLocale" style="position: relative; top: 0.5em;left:4px;display: none;">
        <input type="radio" name="locale" value="en"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In English</span>
        <input style="margin-left:1em" type="radio" name="locale" value="ru"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In Russian</span>
    </div>
    <textarea data-drafts-id="CommentReplyFrame" class="wysiwyg" name="editContent" rows="20" style="width:99%;"></textarea>
    <div class="error error__content"></div>
    <div style="text-align:center;">
        <input type="button" name="preview" style="padding: 0.25em 1em; margin-top: 1em; min-width: 6.5em;" value="Preview">
        <input type="button" name="save" style="padding: 0.25em 1em; margin-top: 1em; min-width: 6.5em;" value="Save">
    </div>
</div>

    <script type="text/javascript">
        $(document).ready(function () {

var firstPreview154723 = true;
var lastPreviewContent154723 = '';

if (!window.moveCommentRevision) {
    moveCommentRevision = function(e, dir) {
        var p = e.parent();
        var revisionCount = parseInt(p.attr("revisionCount"));
        var revision = parseInt(p.attr("revision"));
        var next = revision + dir;
        var commentId = p.attr("commentId");
        if (next >= 1 && next <= revisionCount) {
            $.post(
                "/data/comment-data",
                {action: "revision", commentId: commentId, revision: next},
                function(json) {
                    if (json.success == "true") {
                        var parentDiv = e;

                        while (parentDiv !== null && (parentDiv[0].nodeName.toLowerCase() !== "td" || !parentDiv.hasClass("right"))) {
                            parentDiv = parentDiv.parent();
                        }

                        if (parentDiv === null) {
                            return;
                        }

                        parentDiv.find("div.comment-content-" + commentId + " .moveup").html(json.content);
                        Codeforces.setupSpoilers(parentDiv.find("div.comment-content-" + commentId + " .moveup"));
                        p.attr("revision", next);
                        p.find("span.revision").text(next);
                        if (next == 1) {
                            p.find("a.leftRevision").css("visibility", "hidden");
                        } else {
                            p.find("a.leftRevision").css("visibility", "visible");
                        }
                        if (next == revisionCount) {
                            p.find("a.rightRevision").css("visibility", "hidden");
                        } else {
                            p.find("a.rightRevision").css("visibility", "visible");
                        }

                        window.updateTypography();
                        MathJax.Hub.Typeset();
                    } else {
                        alert(e.error);
                    }
                },
                "json"
            );
        }
    };
}

$("div[commentableId=154723] a.leftRevision").click(function () {
    window.moveCommentRevision($(this), -1);
    return false;
});

$("div[commentableId=154723] a.rightRevision").click(function () {
    window.moveCommentRevision($(this), +1);
    return false;
});



        });
    </script>


        <script src="//codeforces.com/codeforces.org/s/52448/js/swfobject-2.2.min.js" type="text/javascript"></script>
        <script src="//codeforces.com/codeforces.org/s/52448/js/ftaa.js" type="text/javascript"></script>
        <script type="text/javascript">
            $(function() {
                if (window.evercookie) {
                    var ec = new evercookie({
                        history: false,
                        silverlight: false,
                        baseurl: '',
                        asseturi: '/assets',
                        phpuri: '/2fdcd78',
                        pngPath: '/eps',
                        etagPath: '/ees',
                        cachePath: '/ecs'
                    });

                    var randomNumber = function () {
                        return Math.random().toString(36).substr(2);
                    };

                    var randomToken = function () {
                        return (randomNumber() + randomNumber()).substring(0, 18);
                    };

                    window._ftaa = "";

                    ec.get("70a7c28f3de", function (value) {
                        window._ftaa = value;
                        if (!window._ftaa) {
                            window._ftaa = randomToken();
                            ec.set("70a7c28f3de", window._ftaa);
                        }
                        $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                    });
                } else {
                    window._ftaa = "n/a";
                    $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                }
            });
        </script>

        <script src="//codeforces.com/codeforces.org/s/52448/js/bfaa.js" type="text/javascript"></script>
        <script type="text/javascript">
            $(function() {
                var fpCallback = function() {
                    Fingerprint2.get({}, function(components) {
                        window._bfaa = Fingerprint2.x64hash128(components.map(function (pair) { return pair.value }).join(), 31);
                        $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                    });
                };
                if (typeof Fingerprint2 !== 'undefined') {
                    if (window.requestIdleCallback) {
                        requestIdleCallback(fpCallback)
                    } else {
                        setTimeout(fpCallback, 500)
                    }
                } else {
                    window._bfaa = "n/a";
                    $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                }
            });
        </script>

    <script type="text/javascript">
        $(document).ready(function () {
    $("a.new-root-comment").click(function () {
            window.location = "/enter";
        return false;
    });

    $(".comment-table .reply a").click(function () {
            window.location = "/enter";
        return false;
    });
        });
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
    function updateImg(element, direction, activated) {
        var votedDirection = element.closest(".CommentVoteFrame").attr("myVoteDirection");
        var directionString = direction == 1 ? "up" : "down";
        element.attr("src", "//codeforces.com/codeforces.org/s/52448/images/actions/comment-vote" + directionString + (activated ? "" : "-blue") + ".png");
        element.css("opacity", activated ? "1.0" : "0.35");
        var title;
        if (votedDirection == direction) {
            title = "Cancel vote";
        } else if (direction == 1) {
            title = "Vote: I like it";
        } else {
            title = "Vote: I do not like it";
        }
        element.attr("alt", title);
        element.attr("title", title);
    }

    $(".vote-for-comment").mouseover(function () {
        var vote = $(this);
        var voteFrame = $(this).closest(".CommentVoteFrame");
        var direction = vote.attr("voteDirection");
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = false;
        if (!ownComment) {
            updateImg(vote.find("img"), direction, true);
        }
    });

    $(".vote-for-comment").mouseout(function () {
        var vote = $(this);
        var voteFrame = $(this).closest(".CommentVoteFrame");
        var direction = vote.attr("voteDirection");
        var myVoteDirection = voteFrame.attr("myVoteDirection");
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = false;
        if (myVoteDirection != direction && !ownComment) {
            updateImg(vote.find("img"), direction, false);
        }
    });

    $(".vote-for-comment").click(function () {
        if ($(this).closest(".hidden-comment").length) {
            Codeforces.showMessage("Show the comment before voting");
            return;
        }
        var vote = $(this);
        var voteFrame = $(this).closest(".CommentVoteFrame");
        var commentId = $(this).parent().attr("commentid");
        var commentRating = $(this).parent().attr("data-commentRating");
        var myVoteDirection = voteFrame.attr("myVoteDirection");
        var direction = $(this).attr("voteDirection");
        var newDirection = direction;
        if (direction == myVoteDirection) {
            newDirection = 0; // Clicking same direction twice cancels the vote
        }
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = false;
        $.post("/data/comment/vote", {commentId: commentId, _tta: Codeforces.tta(), vote: newDirection, commentRating: commentRating}, function(data) {
            if (data["success"] == "true") {
                voteFrame.attr("myVoteDirection", newDirection);
                updateImg(voteFrame.find("[voteDirection=-1]>img"), -1, newDirection == -1);
                updateImg(voteFrame.find("[voteDirection=1]>img"), 1, newDirection == 1);
                if (newDirection == -1) {
                    voteFrame.find(".ComplaintFrame").css("display", "inline-block");
                } else {
                    voteFrame.find(".ComplaintFrame").hide();
                }
                vote.parent().find(".commentRating").html(data["commentRating"]);
            }
            Codeforces.showMessage(data["message"]);
        }, "json");
        return false;
    });

    $(".negative-comment-vote").closest(".comment-table").addClass("comment-bad");

    $(".troll-comment-vote").closest(".comment").css("display", "none");

    $(".too-negative-comment-vote").closest(".comment-table").each(function () {
        var e = $(this);
        e.addClass("comment-too-bad");
        var commentId = e.attr("commentId");
        $("<div class='bad-comment-replacement ttypography'>The comment is hidden because of too negative feedback, click <a href=# class=show-bad-comment-link>here</a> to view it</div>").appendTo(
            e.find(".right")
        );
        e.find(".comment-content").hide();
        e.find(".show-bad-comment-link").click(function () {
            e.find(".comment-content").show();
            e.find(".bad-comment-replacement").hide();
            return false;
        });
    });
        });
    </script>
    </div>

    <style type="text/css">
        .new-comments-box {
            padding: 0.5em;
            width: 22px;
            font-size: 1.3rem;
            font-weight: bold !important;

            position: fixed;
            top: 40%;
            right: 0;
            opacity: 0.2;
            color: white;
            text-align: center;

            border: 1px solid #222;
            background-color: #888 !important;
            border-radius: 3px;
            -moz-border-radius: 3px;
            -webkit-border-radius: 3px;
        }

        .new-comments-box:hover {
            opacity: 1;
        }

        .new-comments-box .dir:hover {
            background: #3B5998 !important;
            cursor: pointer;
        }
    </style>

    <div class="new-comments-box" data-position="outside" data-index="-1" style="display: none;">
        <div class="up dir" title="Ctrl+Up">↑<hr>
        </div>
        <div class="info" title="New comments"></div>
        <div class="down dir" title="Ctrl+Down">
            <hr>↓
        </div>
    </div>

    <script>
        function makeSureElementIsShown(target) {
            let e = target;
            while (true) {
                e = e.parent().closest(".comment");
                if (e.length === 0) {
                    break;
                }
                e.find(">.hidden-comment").hide();
                e.find(">.shown-comment").show();
            }
        }

        $(function() {
            const hash = window.location.hash;
            if (hash) {
                const target = $(hash);
                if (target) {
                    makeSureElementIsShown(target);
                    setTimeout(() => target.scrollIntoView());
                }
            }
        });

        $(".show-archived-checkbox").change(function () {
            const checked = $(this).is(":checked");
            $.post("/data/comment-data", {action: "setShowArchived", checked}, function (json) {
                if (json["success"] !== "true") {
                    alert(json["error"]);
                } else {
                    if (checked) {
                        Codeforces.reloadAndShowMessage("Archived comments are now displayed")
                    } else {
                        Codeforces.reloadAndShowMessage("Archived comments are no longer displayed")
                    }
                }
            });
            return false;
        });

        function gotoComment(direction) {
            var box = $(".new-comments-box");
            var index = parseInt(box.attr("data-index"));
            if (index == -1)
                index = 0;
            else
                index = Math.max(0, Math.min(parseInt(box.find(".info").text()) - 1, index + direction));
            box.attr("data-index", index);
            var comment = $($(".comment>.shown-comment>.highlight-blue[commentId]").get(index));
            makeSureElementIsShown(comment);
            $('html, body').animate({
                'scrollTop': Math.max(0, comment.offset().top - ($(window).height() - comment.height()) / 2)
            });
            return false;
        }

        $(".new-comments-box .down").click(function () {
            return gotoComment(1);
        });

        $(".new-comments-box .up").click(function () {
            return gotoComment(-1);
        });

        $(document).keydown(function (e) {
            var code = (e.keyCode ? e.keyCode : e.which);
            if (e.ctrlKey) {
                if (code == 38 || code == 40) {
                    gotoComment(code - 39);
                }
            }
        });

        var newCommentCount = $(".comment>.shown-comment>.highlight-blue[commentId]").length;
        if (newCommentCount > 0) {
            $(".new-comments-box .info").text(newCommentCount);
            $(".new-comments-box").show();
        }

        $('table.comment-table').mouseenter(function () {
            var comment = $(this);
            var cnt = 0;
            while (true) {
                var id = comment.attr("commentId");
                var parentId = comment.attr("commentParentId");
                comment.find(".comment-indent-holder:first .comment-no-indent").addClass("comment-indent");
                if (parentId == -1) {
                    break;
                }
                comment = $("table.comment-table[commentId=" + parentId + "]");
            }
            return false;
        });

        $('table.comment-table').mouseleave(function () {
            var comment = $(this);
            var cnt = 0;
            while (true) {
                var id = comment.attr("commentId");
                var parentId = comment.attr("commentParentId");
                comment.find(".comment-indent-holder:first .comment-no-indent").removeClass("comment-indent");
                if (parentId == -1) {
                    break;
                }
                comment = $("table.comment-table[commentId=" + parentId + "]");
            }
            return false;
        });

        const commentVoteFrameHolderSelector = ">.comment-table .commentVoteFrameHolder";
        $(".hidden-comment").each(function() {
            const comment = $(this).closest(".comment");
            $(this).find(".hidden-children").text(comment.find(".comment").length);
        });
        $('.hideComment').click(function () {
            const comment = $(this).closest(".comment");
            const shownComment = comment.find("> .shown-comment");
            const hiddenComment = comment.find("> .hidden-comment");
            shownComment.hide();
            hiddenComment.show();
            shownComment.find(commentVoteFrameHolderSelector).children()
                .appendTo(hiddenComment.find(commentVoteFrameHolderSelector));
            return false;
        });
        $('.showComment').click(function () {
            const comment = $(this).closest(".comment");
            const hiddenComment = comment.find("> .hidden-comment");
            const shownComment = comment.find("> .shown-comment");
            hiddenComment.hide();
            shownComment.show();
            hiddenComment.find(commentVoteFrameHolderSelector).children()
                .appendTo(shownComment.find(commentVoteFrameHolderSelector));
            return false;
        });
    </script>



    <script>
        function adjustTopicComplainFrames() {
            let topicIds = [];

            $(".has-topic-id").each(function () {
                const $this = $(this);
                const topicId = $this.attr("topicId");
                if (topicId) {
                    topicIds.push(topicId);
                }
            });

            $.post("/data/topics", {
                action: "findComplainableTopicIds",
                topicIds: topicIds.join(",")
            }, function (json) {
                if (json["success"] === "true") {
                    for (const topicId of json["complainableTopicIds"].split(",")) {
                        $(".has-topic-id[topicId=" + topicId + "]").each(function () {
                            $(this).find(".meta .ComplaintFrame").css("display", "inline-block");
                        });
                    }
                }
            }, "json");
        }

        function updateTopicVote(topicId, voteDirection, processed) {
            let ratingElement = $(".topic-rating-" + topicId);
            let newRating = parseInt(ratingElement.attr("data-rawRating"));
            if (!processed) newRating += voteDirection;
            if (newRating > 0) {
                ratingElement.text("+" + newRating.toString());
                ratingElement.css("color", "green");
            } else {
                ratingElement.text(newRating.toString());
                ratingElement.css("color", "gray");
            }
            let voteUpImg = $(".topic-vote-up-" + topicId + " img");
            voteUpImg.attr("src", "//codeforces.com/codeforces.org/s/52448/"
                + (voteDirection === 1 ? "images/actions/voteup-voted.png" : "images/actions/voteup-gray.png"));
            voteUpImg.attr("title", voteDirection === 1 ? "Cancel vote" : "Vote: I like it");
            let voteDownImg = $(".topic-vote-down-" + topicId + " img");
            voteDownImg.attr("src", "//codeforces.com/codeforces.org/s/52448/"
                + (voteDirection === -1 ? "images/actions/votedown-voted.png" : "images/actions/votedown-gray.png"));
            voteDownImg.attr("title", voteDirection === -1 ? "Cancel vote" : "Vote: I do not like it");
        }

        function getMyVotes() {
            let topicIds = [];
            $(".topic-rating").each(function () {
                topicIds.push($(this).attr("data-topicId"))
            });
            $.post("/data/topic/vote", {
                topicIds: topicIds.join(","),
                _tta: Codeforces.tta(),
                action: "getMyVotes"
            }, function (data) {
                if (data.success === "true") {
                    votes = JSON.parse(data.votes);
                    for (const vote of votes) {
                        updateTopicVote(vote.topicId, vote.direction, vote.processed);
                    }
                }
            }, "json");
        }

        $(function () {
        });
    </script>

<script type="text/javascript">
    $(document).ready(function () {
        let voteDirection = 0;

        function clickVote(direction) {
            if (direction === voteDirection) {
                direction = 0;
            }
            $.post("/data/topic/vote", {
                topicId: 140865,
                _tta: Codeforces.tta(),
                topicRevisionId: 385386,
                vote: direction,
            }, function (data) {
                if (data.success === "true") {
                    voteDirection = parseInt(data.voteDirection);
                    updateTopicVote(140865, voteDirection, data.processed === "true");
                }
                Codeforces.showMessage(data.message);
            }, "json");
        }

        $(".topic-vote-up-140865").click(function () {
            clickVote(+1);
            return false;
        });
        $(".topic-vote-down-140865").click(function () {
            clickVote(-1);
            return false;
        });
    });
</script></div>

    <script>
        $(function () {
            $(".topic-action-a").click(function () {
                const action = $(this).data("action");
                const topicTitle = $(this).data("topic-title");

                if (confirm("Are you sure you want to perform the action '" + action.toUpperCase()
                        + "' on the topic '" + topicTitle + "'?")) {
                    const topicId = $(this).data("topic-id");
                    const locale = $(this).data("topic-locale");
                    $.post("/data/topic", {action, topicId, locale}, function (json) {
                        Codeforces.reloadAndShowMessageOrShowError(json, json["message"]);
                    });
                }

                return false;
            });
        });
    </script>
        </div>
    </div>
                </div>
        </div>
            <br style="clear: both;">
            <div id="footer">
                <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2025 Mike Mirzayanov</div>
                <div>The only programming contests Web 2.0 platform</div>
                    <div>Server time: Dec/14/2025 13:17:54<sup title="timezone offset" style="font-size:8px;">UTC</sup> (l3).</div>
                    <div>Desktop version, switch to <a rel="nofollow" class="switchToMobile" href="?mobile=true">mobile version</a>.</div>
                <div class="smaller">
                    <a href="/privacy">Privacy Policy</a>
                    |
                    <a href="/terms">Terms and Conditions</a>
                </div>

                    <div style="margin-top: 25px;">
                        Supported by
                    </div>
                    <div class="footer-logo-div" style="left: 30px;">
                        <a href="https://ton.org/"><img style="margin-right: 2em; width: 60px;" src="//codeforces.com/codeforces.org/s/52448/images/ton-100x100.png" alt="TON" title="TON"></a>
                        <div class="sep">&nbsp;</div>
                        <a href="https://en.itmo.ru/en/" class="itmo-logo"><img style="width: 140px;" src="//codeforces.com/codeforces.org/s/52448/images/itmo_small_en-logo.png" alt="ITMO University" title="ITMO University"></a>
                    </div>

            </div>
        <script type="text/javascript">
            $(function() {
                $(".switchToMobile").click(function() {
                    Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", "true"));
                    return false;
                });
                $(".switchToDesktop").click(function() {
                    Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", "false"));
                    return false;
                });
            });
        </script>
    <script type="text/javascript">
        $(document).ready(function () {
            if ($(window).width() < 1600) {
                $('.button-up').css('width', '30px').css('line-height', '30px').css('font-size', '20px');
            }

            if ($(window).width() >= 1200) {
                $ (window).scroll (function () {
                    if ($ (this).scrollTop () > 100) {
                        $ ('.button-up').fadeIn();
                    } else {
                        $ ('.button-up').fadeOut();
                    }
                });

                $('.button-up').click(function () {
                    $('body,html').animate({
                        scrollTop: 0
                    }, 500);
                    return false;
                });

                $('.button-up').hover(function () {
                    $(this).animate({
                        'opacity':'1'
                    }).css({'background-color':'#e7ebf0','color':'#6a86a4'});
                }, function () {
                    $(this).animate({
                        'opacity':'0.7'
                    }).css({'background':'none','color':'#d3dbe4'});;
                });
            }

            Codeforces.focusOnError();

            Codeforces.setCopiedToClipboardText("Copied to clipboard");
            Codeforces.listenCopyable();
        });
    </script>
    <div class="userListsFacebox" style="display:none;">
        <div style="padding: 0.5em; width: 600px; max-height: 200px; overflow-y: auto">
<div class="datatable" style="background-color: #E1E1E1; padding-bottom: 3px;">
            <div class="lt">&nbsp;</div>
            <div class="rt">&nbsp;</div>
            <div class="lb">&nbsp;</div>
            <div class="rb">&nbsp;</div>

            <div style="padding: 4px 0 0 6px;font-size:1.4rem;position:relative;">
                User lists

                <div style="position:absolute;right:0.25em;top:0.35em;">
                    <span style="padding:0;position:relative;bottom:2px;" class="rowCount"></span>

                    <img class="closed" src="//codeforces.com/codeforces.org/s/52448/images/icons/magnifier-medium.png">

                    <span class="filter" style="display:none;">
                        <img class="opened" src="//codeforces.com/codeforces.org/s/52448/images/icons/control-270.png">
                        <input style="padding:0 0 0 20px;position:relative;bottom:2px;border:1px solid #aaa;height:17px;font-size:1.3rem;">
                    </span>
                </div>
            </div>
            <div style="background-color: white;margin:0.3em 3px 0 3px;position:relative;">
            <div class="ilt">&nbsp;</div>
            <div class="irt">&nbsp;</div>
            <table class="">
                <thead>
                <tr>
                    <th draggable="true" class="top left right">Name</th>
                </tr>
                </thead>
                <tbody>
                <tr class="no-items visible"><td style="text-align:left;" colspan="32" class="bottom dark left right">No items</td></tr></tbody>
            </table>
            </div>
        </div>
    <script type="text/javascript">
        $(document).ready(function () {
                // Create new ':containsIgnoreCase' selector for search
                jQuery.expr[':'].containsIgnoreCase = function(a, i, m) {
                    return jQuery(a).text().toUpperCase()
                            .indexOf(m[3].toUpperCase()) >= 0;
                };

                if (window.updateDatatableFilter == undefined) {
                    window.updateDatatableFilter = function(i) {
                        var parent = $(i).parent().parent().parent().parent();
                        $("tr.no-items", parent).remove();
                        $("tr", parent).hide().removeClass('visible');
                        var text = $(i).val();
                        if (text) {
                            $("tr" + ":containsIgnoreCase('" + text + "')", parent).show().addClass('visible');
                        } else {
                            parent.find(".rowCount").text("");
                            $("tr", parent).show().addClass('visible');
                        }

                        var found = false;
                        var visibleRowCount = 0;
                        $("tr", parent).each(function () {
                            if (!found) {
                                if ($(this).find("th").size() > 0) {
                                    $(this).show().addClass('visible');
                                    found = true;
                                }
                            }
                            if ($(this).hasClass('visible')) {
                                visibleRowCount++;
                            }
                        });
                        if (text) {
                            parent.find(".rowCount").text("Matches: " + (visibleRowCount - (found ? 1 : 0)));
                        }
                        if (visibleRowCount == (found ? 1 : 0)) {
                            $("<tr class='no-items visible'><td style=\"text-align:left;\"colspan=\"32\">No items<\/td><\/tr>").appendTo($(parent).find('table'));
                        }
                        $(parent).find("tr td").removeClass("dark");
                        $(parent).find("tr.visible:odd td").addClass("dark");
                    }

                    $(".datatable .closed").click(function () {
                        var parent = $(this).parent();
                        $(this).hide();
                        $(".filter", parent).fadeIn(function () {
                            $("input", parent).val("").focus().css("border", "1px solid #aaa");
                        });
                    });

                    $(".datatable .opened").click(function () {
                        var parent = $(this).parent().parent();
                        $(".filter", parent).fadeOut(function () {
                            $(".closed", parent).show();
                            $("input", parent).val("").each(function () {
                                window.updateDatatableFilter(this);
                            });
                        });
                    });

                    $(".datatable .filter input").keyup(function(e) {
                        window.updateDatatableFilter(this);
                        e.preventDefault();
                        e.stopPropagation();
                    });

                    $(".datatable table").each(function () {
                        var found = false;
                        $("tr", this).each(function () {
                            if (!found && $(this).find("th").size() == 0) {
                                found = true;
                            }
                        });
                        if (!found) {
                            $("<tr class='no-items visible'><td style=\"text-align:left;\"colspan=\"32\">No items<\/td><\/tr>").appendTo(this);
                        }
                    });

                    // Applies styles to datatables.
                    $(".datatable").each(function () {
                        $(this).find("tr:first th").addClass("top");
                        $(this).find("tr:last td").addClass("bottom");
                        $(this).find("tr:odd td").addClass("dark");
                        $(this).find("tr td:first-child, tr th:first-child").addClass("left");
                        $(this).find("tr td:last-child, tr th:last-child").addClass("right");
                    });

                    $(".datatable table.tablesorter").each(function () {
                        $(this).bind("sortEnd", function () {
                            $(".datatable").each(function () {
                                $(this).find("th, td")
                                    .removeClass("top").removeClass("bottom")
                                    .removeClass("left").removeClass("right")
                                    .removeClass("dark");
                                $(this).find("tr:first th").addClass("top");
                                $(this).find("tr:last td").addClass("bottom");
                                $(this).find("tr:odd td").addClass("dark");
                                $(this).find("tr td:first-child, tr th:first-child").addClass("left");
                                $(this).find("tr td:last-child, tr th:last-child").addClass("right");
                            });
                        });
                    });
                }
        });
    </script>
        </div>
    </div>
    <script type="application/javascript">
        $(function() {
            $(".userListMarker").click(function() {
                $.post("/data/lists", {action: "findTouched"}, function(json) {
                    Codeforces.facebox(".userListsFacebox");
                    var tbody = $("#facebox tbody");
                    tbody.empty();
                    for (var i in json) {
                        tbody.append(
                            $("<tr></tr>").append(
                                $("<td></td>").attr("data-readKey", json[i].readKey).text(json[i].name)
                            )
                        );
                    }
                    Codeforces.updateDatatables();
                    tbody.find("td").css("cursor", "pointer").click(function() {
                        document.location = Codeforces.updateUrlParameter(document.location.href, "list", $(this).attr("data-readKey"));
                    });
                }, "json");
            });
        });
    </script>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-52448.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script defer="" src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon="{&quot;version&quot;:&quot;2024.11.0&quot;,&quot;token&quot;:&quot;316c29dfa3804effb5a91c52a59b5bd0&quot;,&quot;server_timing&quot;:{&quot;name&quot;:{&quot;cfCacheStatus&quot;:true,&quot;cfEdge&quot;:true,&quot;cfExtPri&quot;:true,&quot;cfL4&quot;:true,&quot;cfOrigin&quot;:true,&quot;cfSpeedBrain&quot;:true},&quot;location_startswith&quot;:null}}" crossorigin="anonymous"></script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9addfbeddd8ba758',t:'MTc2NTcxODI3NA=='};var a=document.createElement('script');a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><iframe height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: none; visibility: hidden;"></iframe>

<div id="datepick-div" style="display: none;"></div><div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" style="display: none; padding-bottom: 42px; padding-right: 42px;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxLoadedContent" style="width: 0px; height: 0px; overflow: hidden; float: left;"></div><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><div id="cboxNext" style="float: left;"></div><div id="cboxPrevious" style="float: left;"></div><div id="cboxSlideshow" style="float: left;"></div><div id="cboxClose" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none;"></div></div><div id="swfcontainer" style="visibility: visible;"></div><div id="userdata_el" style="visibility: hidden; position: absolute;"></div><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; min-width: 0px; max-width: none; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: MathJax_Main-bold, sans-serif;"></div></div></body></html>