{
  "contestId": 2068,
  "index": "K",
  "title": "Amusement Park Rides",
  "timeLimit": "2 seconds",
  "memoryLimit": "1024 megabytes",
  "rating": 3000,
  "tags": [
    "flows",
    "graphs"
  ],
  "statementHtml": "<p>Ivan, Dmitrii, and Pjotr are celebrating Ivan's birthday at an amusement park with <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2\">n</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-1-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-2\"><span class=\"mi\" id=\"MathJax-Span-3\" style=\"font-family: MathJax_Math-italic;\">n</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-1\">n</script> attractions. The <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-4\">i</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-2-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-4\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-5\"><span class=\"mi\" id=\"MathJax-Span-6\" style=\"font-family: MathJax_Math-italic;\">i</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-2\">i</script>-th attraction operates at minutes <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-5\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-6\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-7\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-8\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-9\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-10\">2</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-11\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-12\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-13\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-14\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mn\" id=\"MJXp-Span-15\">3</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-16\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-17\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-18\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-19\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mo\" id=\"MJXp-Span-20\" style=\"margin-left: 0em; margin-right: 0em;\">…</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-3-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-7\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-8\"><span class=\"msubsup\" id=\"MathJax-Span-9\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-10\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-11\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-12\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-13\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">2</span><span class=\"msubsup\" id=\"MathJax-Span-14\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-15\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-16\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-17\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-18\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">3</span><span class=\"msubsup\" id=\"MathJax-Span-19\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-20\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-21\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-22\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mo\" id=\"MathJax-Span-23\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">…</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-3\">a_i, 2a_i, 3a_i, \\dots</script> (i.e., every <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-21\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-22\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-23\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-24\" style=\"vertical-align: -0.4em;\">i</span></span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-4-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-24\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-25\"><span class=\"msubsup\" id=\"MathJax-Span-26\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-27\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-28\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-4\">a_i</script> minutes).</p>\n<p>Each minute, the friends can either ride exactly one available attraction <span class=\"tex-font-style-bf\">together</span> or wait. Since the rides are very short, they can board another attraction the next minute. They may ride the attractions in any order.</p>\n<p>They want to experience each ride exactly once before heading off to enjoy the birthday cake. What is the earliest time by which they can finish all <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-25\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-26\">n</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-5-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-29\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-30\"><span class=\"mi\" id=\"MathJax-Span-31\" style=\"font-family: MathJax_Math-italic;\">n</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-5\">n</script> attractions?</p>",
  "inputSpecHtml": "<p>Each test contains multiple test cases. The first line contains an integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-27\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-28\">t</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-6-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-32\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-33\"><span class=\"mi\" id=\"MathJax-Span-34\" style=\"font-family: MathJax_Math-italic;\">t</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-6\">t</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-29\"><span class=\"MJXp-mn\" id=\"MJXp-Span-30\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-31\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-32\">t</span><span class=\"MJXp-mo\" id=\"MJXp-Span-33\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mn\" id=\"MJXp-Span-34\">2000</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-7-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-35\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-36\"><span class=\"mn\" id=\"MathJax-Span-37\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-38\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-39\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">t</span><span class=\"mo\" id=\"MathJax-Span-40\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mn\" id=\"MathJax-Span-41\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">2000</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-7\">1\\le t\\le 2000</script>) — the number of test cases. The descriptions of the <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-35\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-36\">t</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-8-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-42\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-43\"><span class=\"mi\" id=\"MathJax-Span-44\" style=\"font-family: MathJax_Math-italic;\">t</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-8\">t</script> test cases follow.</p><p>The first line contains an integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-37\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-38\">n</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-45\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-46\"><span class=\"mi\" id=\"MathJax-Span-47\" style=\"font-family: MathJax_Math-italic;\">n</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-9\">n</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-39\"><span class=\"MJXp-mn\" id=\"MJXp-Span-40\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-41\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-42\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-43\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mn\" id=\"MJXp-Span-44\">2000</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-10-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-48\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-49\"><span class=\"mn\" id=\"MathJax-Span-50\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-51\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-52\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span><span class=\"mo\" id=\"MathJax-Span-53\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mn\" id=\"MathJax-Span-54\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">2000</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-10\">1\\le n \\le 2000</script>) — the number of attractions. </p><p>The second line contains <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-45\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-46\">n</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-11-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-55\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-56\"><span class=\"mi\" id=\"MathJax-Span-57\" style=\"font-family: MathJax_Math-italic;\">n</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-11\">n</script> integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-47\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-48\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-49\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-50\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-51\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mspace\" id=\"MJXp-Span-52\" style=\"width: 0.167em; height: 0em;\"></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-53\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-54\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-55\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-56\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mspace\" id=\"MJXp-Span-57\" style=\"width: 0.167em; height: 0em;\"></span><span class=\"MJXp-mo\" id=\"MJXp-Span-58\" style=\"margin-left: 0em; margin-right: 0em;\">…</span><span class=\"MJXp-mo\" id=\"MJXp-Span-59\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mspace\" id=\"MJXp-Span-60\" style=\"width: 0.167em; height: 0em;\"></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-61\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-62\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-63\" style=\"vertical-align: -0.4em;\">n</span></span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-12-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-58\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-59\"><span class=\"msubsup\" id=\"MathJax-Span-60\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-61\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mn\" id=\"MathJax-Span-62\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-63\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mspace\" id=\"MathJax-Span-64\" style=\"height: 0em; vertical-align: 0em; width: 0.165em; display: inline-block; overflow: hidden;\"></span><span class=\"msubsup\" id=\"MathJax-Span-65\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-66\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mn\" id=\"MathJax-Span-67\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-68\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mspace\" id=\"MathJax-Span-69\" style=\"height: 0em; vertical-align: 0em; width: 0.165em; display: inline-block; overflow: hidden;\"></span><span class=\"mo\" id=\"MathJax-Span-70\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">…</span><span class=\"mo\" id=\"MathJax-Span-71\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">,</span><span class=\"mspace\" id=\"MathJax-Span-72\" style=\"height: 0em; vertical-align: 0em; width: 0.165em; display: inline-block; overflow: hidden;\"></span><span class=\"msubsup\" id=\"MathJax-Span-73\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 1.031em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-74\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-75\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-12\">a_1,\\, a_2,\\,\\ldots,\\, a_n</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-64\"><span class=\"MJXp-mn\" id=\"MJXp-Span-65\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-66\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-67\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-68\" style=\"margin-right: 0.05em;\">a</span><span class=\"MJXp-mi MJXp-italic MJXp-script\" id=\"MJXp-Span-69\" style=\"vertical-align: -0.4em;\">i</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-70\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-71\"><span class=\"MJXp-mn\" id=\"MJXp-Span-72\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-73\" style=\"vertical-align: 0.5em;\">9</span></span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-76\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-77\"><span class=\"mn\" id=\"MathJax-Span-78\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-79\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-80\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-81\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-82\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-83\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-84\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-85\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"mn\" id=\"MathJax-Span-86\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">9</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-13\">1 \\le a_i \\le 10^9</script>) — the values determining when the various attractions operate.</p><p>It is guaranteed that the sum of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-74\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-75\">n</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-14-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-87\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-88\"><span class=\"mi\" id=\"MathJax-Span-89\" style=\"font-family: MathJax_Math-italic;\">n</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-14\">n</script> over all test cases does not exceed <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-76\"><span class=\"MJXp-mn\" id=\"MJXp-Span-77\">2000</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-15-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-90\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-91\"><span class=\"mn\" id=\"MathJax-Span-92\" style=\"font-family: MathJax_Main;\">2000</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-15\">2000</script>.</p>",
  "outputSpecHtml": "<p>For each test case, print the earliest time the three friends can finish all <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-78\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-79\">n</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-93\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-94\"><span class=\"mi\" id=\"MathJax-Span-95\" style=\"font-family: MathJax_Math-italic;\">n</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-16\">n</script> attractions.</p>",
  "noteHtml": "<p>In the <span class=\"tex-font-style-bf\">first test case</span>, the three friends can ride the <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-80\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-81\">i</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-96\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-97\"><span class=\"mi\" id=\"MathJax-Span-98\" style=\"font-family: MathJax_Math-italic;\">i</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-17\">i</script>-th attraction at the <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-82\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-83\">i</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-99\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-100\"><span class=\"mi\" id=\"MathJax-Span-101\" style=\"font-family: MathJax_Math-italic;\">i</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-18\">i</script>-th minute. Since there are <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-84\"><span class=\"MJXp-mn\" id=\"MJXp-Span-85\">4</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-102\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-103\"><span class=\"mn\" id=\"MathJax-Span-104\" style=\"font-family: MathJax_Main;\">4</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-19\">4</script> attractions, they need <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-86\"><span class=\"MJXp-mn\" id=\"MJXp-Span-87\">4</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-105\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-106\"><span class=\"mn\" id=\"MathJax-Span-107\" style=\"font-family: MathJax_Main;\">4</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-20\">4</script> minutes to ride them all.</p><p>In the <span class=\"tex-font-style-bf\">third test case</span>, the three friends can ride the attractions in order at minutes <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-88\"><span class=\"MJXp-mn\" id=\"MJXp-Span-89\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-90\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mspace\" id=\"MJXp-Span-91\" style=\"width: 0.167em; height: 0em;\"></span><span class=\"MJXp-mn\" id=\"MJXp-Span-92\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-93\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mspace\" id=\"MJXp-Span-94\" style=\"width: 0.167em; height: 0em;\"></span><span class=\"MJXp-mn\" id=\"MJXp-Span-95\">3</span><span class=\"MJXp-mo\" id=\"MJXp-Span-96\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mspace\" id=\"MJXp-Span-97\" style=\"width: 0.167em; height: 0em;\"></span><span class=\"MJXp-mn\" id=\"MJXp-Span-98\">4</span><span class=\"MJXp-mo\" id=\"MJXp-Span-99\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mspace\" id=\"MJXp-Span-100\" style=\"width: 0.167em; height: 0em;\"></span><span class=\"MJXp-mn\" id=\"MJXp-Span-101\">6</span><span class=\"MJXp-mo\" id=\"MJXp-Span-102\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mspace\" id=\"MJXp-Span-103\" style=\"width: 0.167em; height: 0em;\"></span><span class=\"MJXp-mn\" id=\"MJXp-Span-104\">8</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-108\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-109\"><span class=\"mn\" id=\"MathJax-Span-110\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-111\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mspace\" id=\"MathJax-Span-112\" style=\"height: 0em; vertical-align: 0em; width: 0.165em; display: inline-block; overflow: hidden;\"></span><span class=\"mn\" id=\"MathJax-Span-113\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">2</span><span class=\"mo\" id=\"MathJax-Span-114\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mspace\" id=\"MathJax-Span-115\" style=\"height: 0em; vertical-align: 0em; width: 0.165em; display: inline-block; overflow: hidden;\"></span><span class=\"mn\" id=\"MathJax-Span-116\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">3</span><span class=\"mo\" id=\"MathJax-Span-117\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mspace\" id=\"MathJax-Span-118\" style=\"height: 0em; vertical-align: 0em; width: 0.165em; display: inline-block; overflow: hidden;\"></span><span class=\"mn\" id=\"MathJax-Span-119\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">4</span><span class=\"mo\" id=\"MathJax-Span-120\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mspace\" id=\"MathJax-Span-121\" style=\"height: 0em; vertical-align: 0em; width: 0.165em; display: inline-block; overflow: hidden;\"></span><span class=\"mn\" id=\"MathJax-Span-122\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">6</span><span class=\"mo\" id=\"MathJax-Span-123\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mspace\" id=\"MathJax-Span-124\" style=\"height: 0em; vertical-align: 0em; width: 0.165em; display: inline-block; overflow: hidden;\"></span><span class=\"mn\" id=\"MathJax-Span-125\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">8</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-21\">1,\\, 2,\\, 3,\\, 4,\\, 6,\\, 8</script> respectively. Therefore, they can ride all attractions in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-105\"><span class=\"MJXp-mn\" id=\"MJXp-Span-106\">8</span></span></span><span class=\"MathJax MathJax_Processed\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-126\"><span style=\"display: inline-block; position: relative; width: 0em; height: 0px; font-size: 132%;\"><span style=\"position: absolute;\"><span class=\"mrow\" id=\"MathJax-Span-127\"><span class=\"mn\" id=\"MathJax-Span-128\" style=\"font-family: MathJax_Main;\">8</span></span></span></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-22\">8</script> minutes. One can show that it is impossible to finish all the attractions earlier.</p>",
  "samples": [
    {
      "input": "341 2 3 441 1 1 161 2 1 2 2 2",
      "output": "4\n4\n8"
    }
  ],
  "images": [],
  "url": "https://codeforces.com/contest/2068/problem/K",
  "tutorialHtml": "<div><div class=\"ttypography\"><div class=\"problem-statement\"><div><p>Assume that among the numbers $$$a_i$$$ there are $$$k$$$ distinct values, denoted by $$$p_1, p_2, \\dots, p_k$$$. Suppose each $$$p_j$$$ appears $$$q_j$$$ times in the sequence $$$\\{a_i\\}$$$.</p><p>We now construct a flow graph as follows:</p><ol> <li> Define the vertex set as $$$V = \\{S, T\\} \\cup \\{A_1, A_2, \\dots, A_k\\}$$$. </li><li> For each vertex $$$A_i$$$ (with $$$1 \\le i \\le k$$$), add an edge from $$$S$$$ to $$$A_i$$$ with capacity $$$q_i$$$. </li><li> For each positive integer $$$i$$$, introduce a vertex $$$B_i$$$. For every vertex $$$A_j$$$ (with $$$1 \\le j \\le k$$$), if $$$i \\equiv 0 \\pmod{p_j}$$$, then add an edge from $$$A_j$$$ to $$$B_i$$$ with capacity $$$1$$$. In addition, add an edge from $$$B_i$$$ to $$$T$$$ with capacity $$$1$$$. </li></ol><p>We continue adding vertices $$$B_i$$$ (in increasing order of $$$i$$$) until the maximum flow from $$$S$$$ to $$$T$$$ reaches $$$n$$$. The answer to the problem is the largest index $$$i$$$ for which a vertex $$$B_i$$$ was added.</p><p>This approach has a running time of $$$O(\\mathrm{ans} \\cdot E)$$$, where $$$\\mathrm{ans}$$$ denotes the final value of $$$i$$$ and $$$E$$$ is the number of edges. However, this is too slow since it requires creating a vertex $$$B_i$$$ for every positive integer $$$i$$$.</p><p>We can improve efficiency by avoiding the creation of every $$$B_i$$$. Instead, we maintain a mapping $$$M: \\mathbb{Z}^+ \\to \\{\\mathrm{indices}\\}$$$, where $$$M(i)$$$ is a set of indices. Initially, for each $$$1 \\le j \\le k$$$, we set $$$M(p_j) = \\{j\\}$$$.</p><p>At each step, perform the following: </p><ul> <li> Find the smallest $$$i$$$ for which $$$M(i)$$$ is nonempty. </li><li> Add the vertex $$$B_i$$$ along with its edge to $$$T$$$ and add edges from $$$A_j$$$ to $$$B_i$$$ for every $$$j \\in M(i)$$$. </li><li> If adding these edges increases the maximum flow, then for each $$$j \\in M(i)$$$ insert $$$j$$$ into $$$M(i+p_j)$$$. This means that a future vertex $$$B_{i+p_j}$$$ may also need to be connected to $$$A_j$$$. Otherwise, if the maximum flow does not increase, no additional edges from $$$A_j$$$ (for $$$j \\in M(i)$$$) will be needed. </li><li> Finally, clear the set $$$M(i)$$$. </li></ul><p>Note that we examine at most $$$n+k$$$ distinct values of $$$i$$$ (because in each step we either increase the maximum flow or remove at least one element from $$$\\bigcup_i M(i)$$$). Therefore, the overall time complexity of the solution is $$$O(n \\cdot E)$$$, and it can be shown that $$$E = O(n \\log n)$$$.</p></div></div></div></div>"
}