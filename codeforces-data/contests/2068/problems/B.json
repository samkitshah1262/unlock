{
  "contestId": 2068,
  "index": "B",
  "title": "Urban Planning",
  "timeLimit": "2 seconds",
  "memoryLimit": "1024 megabytes",
  "rating": 3100,
  "tags": [
    "constructive algorithms"
  ],
  "statementHtml": "<p>You are responsible for planning a new city! The city will be represented by a rectangular grid, where each cell is either a park or a built-up area.</p>\n<p>The residents will naturally want to go for walks in the city parks. In particular, a <span class=\"tex-font-style-underline\">rectangular walk</span> is a rectangle consisting of the grid cells, which is at least 2 cells long both horizontally and vertically, such that all cells on the boundary of the rectangle are parks. Note that the cells inside the rectangle can be arbitrary.</p>\n<p>Your favourite number is <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-1-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1\" style=\"width: 0.76em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2\"><span class=\"mi\" id=\"MathJax-Span-3\" style=\"font-family: MathJax_Math-italic;\">k</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>k</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-1\">k</script>. To leave a long-lasting signature, you want to design the city in such a way that it has exactly <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-2-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4\" style=\"width: 0.76em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5\"><span class=\"mi\" id=\"MathJax-Span-6\" style=\"font-family: MathJax_Math-italic;\">k</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>k</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-2\">k</script> rectangular walks.</p>",
  "inputSpecHtml": "<p>The input contains a single integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-3-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-7\" style=\"width: 0.76em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-8\"><span class=\"mi\" id=\"MathJax-Span-9\" style=\"font-family: MathJax_Math-italic;\">k</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>k</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-3\">k</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-4-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;4.194&lt;/mn&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-10\" style=\"width: 11.15em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 8.444em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1008.44em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-11\"><span class=\"mn\" id=\"MathJax-Span-12\" style=\"font-family: MathJax_Main;\">0</span><span class=\"mo\" id=\"MathJax-Span-13\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-14\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">k</span><span class=\"mo\" id=\"MathJax-Span-15\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mn\" id=\"MathJax-Span-16\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">4.194</span><span class=\"mo\" id=\"MathJax-Span-17\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">⋅</span><span class=\"msubsup\" id=\"MathJax-Span-18\" style=\"padding-left: 0.219em;\"><span style=\"display: inline-block; position: relative; width: 1.788em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-19\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"texatom\" id=\"MathJax-Span-20\"><span class=\"mrow\" id=\"MathJax-Span-21\"><span class=\"mn\" id=\"MathJax-Span-22\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">12</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>0</mn><mo>≤</mo><mi>k</mi><mo>≤</mo><mn>4.194</mn><mo>⋅</mo><msup><mn>10</mn><mrow class=\"MJX-TeXAtom-ORD\"><mn>12</mn></mrow></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-4\">0 \\le k \\le 4.194\\cdot 10^{12}</script>).</p>",
  "outputSpecHtml": "<p>On the first line, print two integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-5-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-23\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-24\"><span class=\"mi\" id=\"MathJax-Span-25\" style=\"font-family: MathJax_Math-italic;\">h</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>h</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-5\">h</script> and <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-6-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-26\" style=\"width: 0.923em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.706em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.71em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-27\"><span class=\"mi\" id=\"MathJax-Span-28\" style=\"font-family: MathJax_Math-italic;\">w</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>w</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-6\">w</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-7-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;2025&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-29\" style=\"width: 9.094em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.875em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1006.82em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-30\"><span class=\"mn\" id=\"MathJax-Span-31\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-32\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-33\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">h</span><span class=\"mo\" id=\"MathJax-Span-34\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-35\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">w</span><span class=\"mo\" id=\"MathJax-Span-36\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mn\" id=\"MathJax-Span-37\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">2025</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn><mo>≤</mo><mi>h</mi><mo>,</mo><mi>w</mi><mo>≤</mo><mn>2025</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-7\">1 \\le h, w \\le 2025</script>), the height and width of the grid. On the next <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-8-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-38\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-39\"><span class=\"mi\" id=\"MathJax-Span-40\" style=\"font-family: MathJax_Math-italic;\">h</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>h</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-8\">h</script> lines, print a string with <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-41\" style=\"width: 0.923em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.706em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.71em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-42\"><span class=\"mi\" id=\"MathJax-Span-43\" style=\"font-family: MathJax_Math-italic;\">w</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>w</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-9\">w</script> characters each, with each character being <span class=\"tex-font-style-tt\">#</span>, denoting a park, or <span class=\"tex-font-style-tt\">.</span>, denoting a built-up area.</p><p>It is guaranteed that for any value of <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-10-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-44\" style=\"width: 0.76em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-45\"><span class=\"mi\" id=\"MathJax-Span-46\" style=\"font-family: MathJax_Math-italic;\">k</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>k</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-10\">k</script> within the given limits, there exists a solution with height and width within the given limits. Any city within the given limits and with exactly <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-11-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-47\" style=\"width: 0.76em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-48\"><span class=\"mi\" id=\"MathJax-Span-49\" style=\"font-family: MathJax_Math-italic;\">k</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>k</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-11\">k</script> rectangular walks will be accepted.</p>",
  "noteHtml": "<p>In the <span class=\"tex-font-style-bf\">sample</span>, here are the five possible rectangular walks:</p><p></p><table class=\"tex-tabular bordertable\"><tbody><tr><td class=\"tex-tabular-text-align-center\"><img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/340921781be319f3c670e5440c52401ee34b1663.png\" style=\"max-width: 100.0%;max-height: 100.0%;\" width=\"96px\"></td><td class=\"tex-tabular-text-align-center\"><img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/7722bc090409d46c9452a931f166a7428ef126a1.png\" style=\"max-width: 100.0%;max-height: 100.0%;\" width=\"96px\"></td><td class=\"tex-tabular-text-align-center\"><img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/1f9092851277f30e4761c6d7afcf18e5c3aa8bd5.png\" style=\"max-width: 100.0%;max-height: 100.0%;\" width=\"96px\"></td><td class=\"tex-tabular-text-align-center\"><img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/60e60b033f81796edcd7ce68707bf8c911f50ea4.png\" style=\"max-width: 100.0%;max-height: 100.0%;\" width=\"96px\"></td><td class=\"tex-tabular-text-align-center\"><img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/f21732012ca9c9b6bdf2f14d965d9024985a7fd5.png\" style=\"max-width: 100.0%;max-height: 100.0%;\" width=\"96px\"></td></tr></tbody></table><p></p>",
  "samples": [
    {
      "input": "5",
      "output": "3 4\n####\n#.##\n####"
    }
  ],
  "images": [
    "images/B_1.png",
    "images/B_3.png",
    "images/B_4.png",
    "images/B_5.png"
  ],
  "url": "https://codeforces.com/contest/2068/problem/B",
  "tutorialHtml": "<div><div class=\"ttypography\"><div class=\"problem-statement\"><div><p><span><span class=\"tex-font-style-bf\">Solutions that do not work</span></span></p><p>First of all, let us consider a square with side $$$n$$$, consisting only of parks. It has $$$\\left(\\frac{n(n-1)}{2}\\right)^2$$$ rectangular walks, since there are $$$\\frac{n(n-1)}{2}$$$ ways to choose the top and bottom rows, and $$$\\frac{n(n-1)}{2}$$$ ways to choose the left and right columns. We will denote this number of rectangular walks in a square park as $$$f(n)$$$.</p><p>Now the logical idea would be to find the largest $$$f(n)$$$ that does not exceed $$$k$$$, create a park with side $$$n$$$, and then try to create additional independent parks using the remaining space on the grid to achieve $$$k-f(n)$$$ rectangular walks there.</p><p>When $$$k=4\\cdot10^{12}$$$, we would choose $$$n=2000$$$, get $$$f(2000)=3\\,996\\,001\\,000\\,000$$$ walks that way, and then we would need to squeeze the remaining $$$3\\,999\\,000\\,000$$$ walks into the rest of the 2025 times 2025 grid, which looks like two overlapping 24 times 2025 rectangles after we cut out the 2000 times 2000 rectangle plus adjacent cells to make sure the additional parks do not interact with the big one. However, a 24 times 2025 rectangle has only $$$565\\,606\\,800$$$ rectangular walks, so even with two of those we have no chance to reach the required number. Therefore the idea to have a completely independent large square park is too crude, and we need to improve it.</p><p>Instead of stopping at $$$f(n)$$$, let us add more park cells one by one to go from a square with side $$$n$$$ to a square with side $$$n+1$$$, first completing column $$$n+1$$$ from top to bottom, then completing row $$$n+1$$$ from left to right. For each newly added park cell, the number of rectangular walks will increase by at most $$$n^2$$$. This way we can find an incomplete square with $$$x$$$ rectangular walks such that $$$k-x &lt; n^2$$$, so we will only need to squeeze less than $$$n^2$$$ additional walks in the remaining space.</p><p>In practical terms, when $$$k \\le 4\\cdot10^{12}$$$, at the first step we will get a (partial) square with side at most 2001, and have at most $$$3\\,999\\,999$$$ remaining walks, then at the second step we will get a square with side at most 64, at the third step at most 12, then at most 6, then at most 4, then at most 3, at which moment we would have at most 3 remaining walks, which we can address by at most 3 squares with side 2.</p><p>It is still impossible to put a square of side 2001 and a square of side 64 without overlapping into a grid with side 2025, but now it is clear that we have enough area in our grid for this, and it is only the shape that is the problem. Therefore we should use rectangles instead of squares.</p><p><span><span class=\"tex-font-style-bf\">Solution that works for $$$k \\le 4\\cdot 10^{12}$$$</span></span></p><p>In the onsite version of the contest, the constraint was $$$k \\le 4\\cdot 10^{12}$$$, for which the following approach works.</p><p>Let us start with a rectangle with height 1 and width 2025, and add a second row to it cell by cell from left to right, then the third row, and so on until we would have exceeded $$$k$$$ rectangular walks. After this, let us skip one row and start a new rectangle with width 2025 in the same fashion for the remaining walks, and so on until we reach exactly $$$k$$$.</p><p>This way the first (partial) rectangle will be at most 1977 times 2025, the second at most 3 times 2025, and then at most six more 2 times 2025 ones, which fits into our grid even with the additional empty rows between them, so this is a working solution.</p><p><span><span class=\"tex-font-style-bf\">Solution that works for $$$k \\le 4.194\\cdot 10^{12}$$$</span></span></p><p>In the online mirror of the contest, this problem had a higher constraint: $$$k \\le 4.194\\cdot 10^{12}$$$. Note that $$$f(2024) \\approx 4.191\\cdot 10^{12}$$$ and $$$f(2025) \\approx 4.2\\cdot 10^{12}$$$, meaning that we need a grid almost full of parks to achieve such high values of $$$k$$$, and we cannot afford to have several connected components.</p><p>First, we do the same as above: let us find a partial rectangle that has almost $$$k$$$ rectangular walks. Additionally, we will force the partial rectangle to have $$$n$$$ rows and $$$n+1$$$ columns for some value of $$$n$$$, and we force the removed cells (which make the rectangle partial) to all be in one corner. In other words, we start with a full $$$n$$$ times $$$n+1$$$ rectangle, and then remove cells in the following order: first $$$(0, 0)$$$, then $$$(0, 1)$$$, then $$$(1, 0)$$$, then $$$(1, 1)$$$, then the cells with coordinates $$$\\le 2$$$, and so on until the number of rectangular walks becomes $$$\\le k$$$.</p><p>Since removing each particular cell reduces the number of rectangular walks by at most $$$n(n-1)$$$, we will be able to find a partial rectangle with such number of rectangular walks $$$x$$$ that $$$0\\le k-x&lt;n(n-1)$$$. However, for reasons that will become apparent soon, let us remove a few more cells to achieve $$$n(n-1)\\le k-x&lt;2n(n-1)$$$.</p><p>Since $$$f(n+1)-f(n)=O(n^3)$$$, and removing a cell reduces the number of rectangular walks by $$$\\Omega(n^2)$$$, we will only remove $$$O(n)$$$ cells from the full rectangle to achieve this. And because of the order in which we remove the cells, all removed cells will be concentrated in a $$$O(\\sqrt{n})$$$ times $$$O(\\sqrt{n})$$$ corner of the rectangle, which means that we will still have $$$n-O(\\sqrt{n})$$$ completely untouched rows (with $$$n+1$$$ cells each) and $$$n-O(\\sqrt{n})$$$ completely untouched columns (with $$$n$$$ cells each).</p><p>Now we will add the remaining $$$k-x$$$ rectangular walks by adding cells to the right of the untouched rows (in column $$$n+2$$$) and to the bottom of the untouched columns (in row $$$n+1$$$), so the entire city will fit inside the $$$n+1$$$ times $$$n+2$$$ grid. If we add $$$y$$$ consecutive cells to the right of the untouched rows, this will add $$$\\frac{y(y-1)}{2}(n+1)$$$ rectangular walks, and adding $$$y$$$ consecutive cells to the bottom of the untouched columns will add $$$\\frac{y(y-1)}{2}n$$$ rectangular walks.</p><p>Now, remember that every number $$$z\\ge n(n-1)$$$ can be represented as $$$pn+q(n+1)$$$ for some non-negative $$$p$$$ and $$$q$$$. Since $$$k-x\\ge n(n-1)$$$, we can find such non-negative $$$p$$$ and $$$q$$$ that $$$k-x=pn+q(n+1)$$$. And now we just need to represent $$$p$$$ and $$$q$$$ as the sum of values of the form $$$\\frac{y(y-1)}{2}$$$, and for each such value add a corresponding segment of $$$y$$$ extra cells to the right or to the bottom. To represent a given number $$$p$$$ as a sum of values of the form $$$\\frac{y(y-1)}{2}$$$ is a knapsack problem that we will solve greedily: take the largest value of the form $$$\\frac{y(y-1)}{2}$$$ that does not exceed $$$p$$$, and repeat for the remainder.</p><p>Now since $$$k-x&lt;2n(n-1)$$$, both $$$p$$$ and $$$q$$$ will be $$$O(n)$$$, so the first value of $$$y$$$ we will get will be $$$O(\\sqrt{n})$$$, the second will be $$$O(\\sqrt[4]{n})$$$, and so on, so the output of the greedy knapsack will fit in the $$$n-O(\\sqrt{n})$$$ untouched rows/columns.</p><p>This solution does not always work for very small values of $$$k$$$, since we need a big enough $$$n$$$ for the constant factors hidden in $$$O()$$$ notation above to not matter. For those values of $$$k$$$ we can either use the solution above for the smaller constraints, or implement a very simple solution for very small constraints. For example, when $$$k \\le \\lfloor\\frac{2025}{3}\\rfloor^2$$$, we can just output a grid of separate $$$2 \\times 2$$$ squares with empty rows and columns between them.</p><p>Also, since the resulting grid has $$$n+2$$$ columns, it means that we must have $$$n \\le 2023$$$, so for the values of $$$k$$$ that exceed the total number of rectangular walks in the 2023 times 2024 rectangle it will no longer be true that $$$k-x&lt;2n(n-1)$$$. However, one can more carefully examine how much space does the greedy knapsack above need, and find that it can still fit inside the $$$n-O(\\sqrt{n})$$$ untouched rows/columns at least for $$$k \\le 4.1948\\cdot 10^{12}$$$, which is enough to solve this problem.</p><p><span><span class=\"tex-font-style-bf\">Remarks</span></span></p><p>There are of course very many approaches that work in this problem; the above solutions are just one possibility.</p><p>The judges also had a solution that could get even closer to $$$f(2025)$$$, approximately to $$$k\\le \\frac{1}{3}f(2024) + \\frac{2}{3}f(2025)$$$. However, we felt that the $$$k \\le 4.194\\cdot 10^{12}$$$ constraint is similarly challenging, and did not want to restrict the possible approaches too much.</p><p>The fact that we are counting hollow rectangular walks instead of rectangles that also have only parks inside them did not actually affect the above solutions. We made them hollow so that counting rectangles takes $$$O(n^2\\log n)$$$ instead of $$$O(n^2)$$$, so hopefully simple hill-climbing solutions were less likely to work.</p></div></div></div></div>"
}