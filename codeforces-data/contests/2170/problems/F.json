{
  "contestId": 2170,
  "index": "F",
  "title": "Build XOR on a Segment",
  "timeLimit": "5 seconds",
  "memoryLimit": "512 megabytes",
  "rating": null,
  "tags": [
    "bitmasks",
    "dp"
  ],
  "statementHtml": "<p>You are given an array of <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-1-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-1\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-2\"><span class=\"mi\" id=\"MathJax-Span-3\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-1\">n</script> integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-2-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-4\" style=\"width: 7.47em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.63em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.572em, 1005.63em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-5\"><span class=\"msubsup\" id=\"MathJax-Span-6\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-7\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mn\" id=\"MathJax-Span-8\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-9\" style=\"font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-10\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-11\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mn\" id=\"MathJax-Span-12\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-13\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mo\" id=\"MathJax-Span-14\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">…</span><span class=\"mo\" id=\"MathJax-Span-15\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-16\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 1.031em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-17\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-18\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>a</mi><mi>n</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-2\">a_1, a_2, \\dots, a_n</script>, where all numbers are from <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-3-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-19\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-20\"><span class=\"mn\" id=\"MathJax-Span-21\" style=\"font-family: MathJax_Main;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-3\">1</script> to <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-4-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-22\" style=\"width: 4.007em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.033em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1002.98em, 2.438em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-23\"><span class=\"msubsup\" id=\"MathJax-Span-24\"><span style=\"display: inline-block; position: relative; width: 1.301em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-25\" style=\"font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.49em;\"><span class=\"texatom\" id=\"MathJax-Span-26\"><span class=\"mrow\" id=\"MathJax-Span-27\"><span class=\"mn\" id=\"MathJax-Span-28\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">12</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-29\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mn\" id=\"MathJax-Span-30\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.361em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mn>2</mn><mrow class=\"MJX-TeXAtom-ORD\"><mn>12</mn></mrow></msup><mo>−</mo><mn>1</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-4\">2^{12} - 1</script>.</p>\n<p>You have to process <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-5-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-31\" style=\"width: 0.598em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.44em, 2.492em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-32\"><span class=\"mi\" id=\"MathJax-Span-33\" style=\"font-family: MathJax_Math-italic;\">q<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>q</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-5\">q</script> queries. Each query is defined by three integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-6-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-34\" style=\"width: 4.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.141em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1003.14em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-35\"><span class=\"msubsup\" id=\"MathJax-Span-36\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-37\" style=\"font-family: MathJax_Math-italic;\">l</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.327em;\"><span class=\"mi\" id=\"MathJax-Span-38\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-39\" style=\"font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-40\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-41\" style=\"font-family: MathJax_Math-italic;\">r</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mi\" id=\"MathJax-Span-42\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-43\" style=\"font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-44\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-45\" style=\"font-family: MathJax_Math-italic;\">x</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.598em;\"><span class=\"mi\" id=\"MathJax-Span-46\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>l</mi><mi>i</mi></msub><mo>,</mo><msub><mi>r</mi><mi>i</mi></msub><mo>,</mo><msub><mi>x</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-6\">l_i, r_i, x_i</script>: you need to find the smallest set <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-7-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-47\" style=\"width: 11.15em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 8.444em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1008.39em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-48\"><span class=\"mi\" id=\"MathJax-Span-49\" style=\"font-family: MathJax_Math-italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-50\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mo\" id=\"MathJax-Span-51\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">{</span><span class=\"msubsup\" id=\"MathJax-Span-52\"><span style=\"display: inline-block; position: relative; width: 0.923em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-53\" style=\"font-family: MathJax_Math-italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.49em;\"><span class=\"mn\" id=\"MathJax-Span-54\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-55\" style=\"font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-56\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.923em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-57\" style=\"font-family: MathJax_Math-italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.49em;\"><span class=\"mn\" id=\"MathJax-Span-58\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-59\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mo\" id=\"MathJax-Span-60\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">…</span><span class=\"mo\" id=\"MathJax-Span-61\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-62\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.923em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-63\" style=\"font-family: MathJax_Math-italic;\">s</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.49em;\"><span class=\"mi\" id=\"MathJax-Span-64\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">k</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-65\" style=\"font-family: MathJax_Main;\">}</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>S</mi><mo>=</mo><mo fence=\"false\" stretchy=\"false\">{</mo><msub><mi>s</mi><mn>1</mn></msub><mo>,</mo><msub><mi>s</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>s</mi><mi>k</mi></msub><mo fence=\"false\" stretchy=\"false\">}</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-7\">S = \\{s_1, s_2, \\dots, s_k\\}</script> that satisfies the following conditions:</p>",
  "inputSpecHtml": "<p>The first line contains one integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-103\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-104\"><span class=\"mi\" id=\"MathJax-Span-105\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-13\">n</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-14-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-106\" style=\"width: 6.821em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.143em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1005.14em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-107\"><span class=\"mn\" id=\"MathJax-Span-108\" style=\"font-family: MathJax_Main;\">2</span><span class=\"mo\" id=\"MathJax-Span-109\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-110\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span><span class=\"mo\" id=\"MathJax-Span-111\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-112\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-113\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"mn\" id=\"MathJax-Span-114\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">4</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>2</mn><mo>≤</mo><mi>n</mi><mo>≤</mo><msup><mn>10</mn><mn>4</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-14\">2 \\le n \\le 10^4</script>).</p><p>The second line contains <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-15-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-115\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-116\"><span class=\"mi\" id=\"MathJax-Span-117\" style=\"font-family: MathJax_Math-italic;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-15\">n</script> integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-118\" style=\"width: 7.47em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.63em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.572em, 1005.63em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-119\"><span class=\"msubsup\" id=\"MathJax-Span-120\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-121\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mn\" id=\"MathJax-Span-122\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">1</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-123\" style=\"font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-124\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.977em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-125\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mn\" id=\"MathJax-Span-126\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-127\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mo\" id=\"MathJax-Span-128\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">…</span><span class=\"mo\" id=\"MathJax-Span-129\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-130\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 1.031em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-131\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-132\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">n</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>a</mi><mi>n</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-16\">a_1, a_2, \\dots, a_n</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-133\" style=\"width: 9.31em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.037em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1006.98em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-134\"><span class=\"mn\" id=\"MathJax-Span-135\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-136\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-137\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-138\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-139\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-140\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-141\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 1.301em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-142\" style=\"font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.49em;\"><span class=\"texatom\" id=\"MathJax-Span-143\"><span class=\"mrow\" id=\"MathJax-Span-144\"><span class=\"mn\" id=\"MathJax-Span-145\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">12</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-146\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mn\" id=\"MathJax-Span-147\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn><mo>≤</mo><msub><mi>a</mi><mi>i</mi></msub><mo>≤</mo><msup><mn>2</mn><mrow class=\"MJX-TeXAtom-ORD\"><mn>12</mn></mrow></msup><mo>−</mo><mn>1</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-17\">1 \\le a_i \\le 2^{12} - 1</script>).</p><p>The third line contains one integer <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-148\" style=\"width: 0.598em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.44em, 2.492em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-149\"><span class=\"mi\" id=\"MathJax-Span-150\" style=\"font-family: MathJax_Math-italic;\">q<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>q</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-18\">q</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-151\" style=\"width: 6.604em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.981em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1004.98em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-152\"><span class=\"mn\" id=\"MathJax-Span-153\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-154\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-155\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">q<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-156\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-157\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 1.41em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.98em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-158\" style=\"font-family: MathJax_Main;\">10</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.977em;\"><span class=\"mn\" id=\"MathJax-Span-159\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">6</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.575em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn><mo>≤</mo><mi>q</mi><mo>≤</mo><msup><mn>10</mn><mn>6</mn></msup></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-19\">1 \\le q \\le 10^6</script>).</p><p>Then <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-160\" style=\"width: 0.598em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.44em, 2.492em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-161\"><span class=\"mi\" id=\"MathJax-Span-162\" style=\"font-family: MathJax_Math-italic;\">q<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>q</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-20\">q</script> lines follow. The <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-163\" style=\"width: 0.436em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-164\"><span class=\"mi\" id=\"MathJax-Span-165\" style=\"font-family: MathJax_Math-italic;\">i</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>i</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-21\">i</script>-th of them contains three integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-166\" style=\"width: 4.169em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.141em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1003.14em, 2.546em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-167\"><span class=\"msubsup\" id=\"MathJax-Span-168\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-169\" style=\"font-family: MathJax_Math-italic;\">l</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.327em;\"><span class=\"mi\" id=\"MathJax-Span-170\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-171\" style=\"font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-172\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-173\" style=\"font-family: MathJax_Math-italic;\">r</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mi\" id=\"MathJax-Span-174\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-175\" style=\"font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-176\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-177\" style=\"font-family: MathJax_Math-italic;\">x</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.598em;\"><span class=\"mi\" id=\"MathJax-Span-178\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>l</mi><mi>i</mi></msub><mo>,</mo><msub><mi>r</mi><mi>i</mi></msub><mo>,</mo><msub><mi>x</mi><mi>i</mi></msub></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-22\">l_i, r_i, x_i</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-23-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-179\" style=\"width: 8.498em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.442em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1006.44em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-180\"><span class=\"mn\" id=\"MathJax-Span-181\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-182\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-183\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-184\" style=\"font-family: MathJax_Math-italic;\">l</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.327em;\"><span class=\"mi\" id=\"MathJax-Span-185\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-186\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-187\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-188\" style=\"font-family: MathJax_Math-italic;\">r</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.436em;\"><span class=\"mi\" id=\"MathJax-Span-189\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-190\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"mi\" id=\"MathJax-Span-191\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">n</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn><mo>≤</mo><msub><mi>l</mi><mi>i</mi></msub><mo>≤</mo><msub><mi>r</mi><mi>i</mi></msub><mo>≤</mo><mi>n</mi></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-23\">1 \\le l_i \\le r_i \\le n</script>; <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-24-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;12&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-192\" style=\"width: 9.31em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.037em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1006.98em, 2.492em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-193\"><span class=\"mn\" id=\"MathJax-Span-194\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-195\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-196\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-197\" style=\"font-family: MathJax_Math-italic;\">x</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.598em;\"><span class=\"mi\" id=\"MathJax-Span-198\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-199\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≤</span><span class=\"msubsup\" id=\"MathJax-Span-200\" style=\"padding-left: 0.273em;\"><span style=\"display: inline-block; position: relative; width: 1.301em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-201\" style=\"font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.49em;\"><span class=\"texatom\" id=\"MathJax-Span-202\"><span class=\"mrow\" id=\"MathJax-Span-203\"><span class=\"mn\" id=\"MathJax-Span-204\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">12</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-205\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mn\" id=\"MathJax-Span-206\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn><mo>≤</mo><msub><mi>x</mi><mi>i</mi></msub><mo>≤</mo><msup><mn>2</mn><mrow class=\"MJX-TeXAtom-ORD\"><mn>12</mn></mrow></msup><mo>−</mo><mn>1</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-24\">1 \\le x_i \\le 2^{12} - 1</script>).</p>",
  "outputSpecHtml": "<p>For each query, print one integer — the minimum size of the required set. If such a set does not exist, print <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-25-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-207\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-208\"><span class=\"mn\" id=\"MathJax-Span-209\" style=\"font-family: MathJax_Main;\">0</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>0</mn></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-25\">0</script>.</p>",
  "noteHtml": "<p>Consider the queries from the example:</p><ul> <li> in the first query, you can choose <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-26-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-210\" style=\"width: 5.901em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.44em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1004.39em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-211\"><span class=\"mi\" id=\"MathJax-Span-212\" style=\"font-family: MathJax_Math-italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-213\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mo\" id=\"MathJax-Span-214\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">{</span><span class=\"mn\" id=\"MathJax-Span-215\" style=\"font-family: MathJax_Main;\">5</span><span class=\"mo\" id=\"MathJax-Span-216\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-217\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">4</span><span class=\"mo\" id=\"MathJax-Span-218\" style=\"font-family: MathJax_Main;\">}</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>S</mi><mo>=</mo><mo fence=\"false\" stretchy=\"false\">{</mo><mn>5</mn><mo>,</mo><mn>4</mn><mo fence=\"false\" stretchy=\"false\">}</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-26\">S = \\{5, 4\\}</script>; </li><li> in the second query, you can choose <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-27-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-219\" style=\"width: 4.656em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.52em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1003.47em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-220\"><span class=\"mi\" id=\"MathJax-Span-221\" style=\"font-family: MathJax_Math-italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-222\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mo\" id=\"MathJax-Span-223\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">{</span><span class=\"mn\" id=\"MathJax-Span-224\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-225\" style=\"font-family: MathJax_Main;\">}</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>S</mi><mo>=</mo><mo fence=\"false\" stretchy=\"false\">{</mo><mn>1</mn><mo fence=\"false\" stretchy=\"false\">}</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-27\">S = \\{1\\}</script>; </li><li> in the third query, you can choose <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-28-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-226\" style=\"width: 7.091em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.36em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1005.31em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-227\"><span class=\"mi\" id=\"MathJax-Span-228\" style=\"font-family: MathJax_Math-italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-229\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mo\" id=\"MathJax-Span-230\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">{</span><span class=\"mn\" id=\"MathJax-Span-231\" style=\"font-family: MathJax_Main;\">4</span><span class=\"mo\" id=\"MathJax-Span-232\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-233\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">3</span><span class=\"mo\" id=\"MathJax-Span-234\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-235\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">5</span><span class=\"mo\" id=\"MathJax-Span-236\" style=\"font-family: MathJax_Main;\">}</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>S</mi><mo>=</mo><mo fence=\"false\" stretchy=\"false\">{</mo><mn>4</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>5</mn><mo fence=\"false\" stretchy=\"false\">}</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-28\">S = \\{4, 3, 5\\}</script>; </li><li> in the fourth query, you can choose <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-29-Frame\" tabindex=\"0\" data-mathml=\"&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/math&gt;\" role=\"presentation\" style=\"position: relative;\"><nobr aria-hidden=\"true\"><span class=\"math\" id=\"MathJax-Span-237\" style=\"width: 7.091em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.36em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1005.31em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-238\"><span class=\"mi\" id=\"MathJax-Span-239\" style=\"font-family: MathJax_Math-italic;\">S<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.057em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-240\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mo\" id=\"MathJax-Span-241\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">{</span><span class=\"mn\" id=\"MathJax-Span-242\" style=\"font-family: MathJax_Main;\">1</span><span class=\"mo\" id=\"MathJax-Span-243\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-244\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">3</span><span class=\"mo\" id=\"MathJax-Span-245\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-246\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">7</span><span class=\"mo\" id=\"MathJax-Span-247\" style=\"font-family: MathJax_Main;\">}</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>S</mi><mo>=</mo><mo fence=\"false\" stretchy=\"false\">{</mo><mn>1</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>7</mn><mo fence=\"false\" stretchy=\"false\">}</mo></math></span></span><script type=\"math/tex\" id=\"MathJax-Element-29\">S = \\{1, 3, 7\\}</script>. </li></ul>",
  "samples": [
    {
      "input": "73 5 4 1 7 3 151 3 11 4 11 3 24 7 51 7 8",
      "output": "2 1 3 3 0"
    }
  ],
  "images": [],
  "url": "https://codeforces.com/contest/2170/problem/F",
  "tutorialHtml": "<div><div class=\"ttypography\"><div class=\"problem-statement\"><div><p>This looks like a problem that requires linear algebra and XOR bases. However, we only need one fact from linear algebra: the size of the XOR base does not exceed the number of bits in the integers we are working with, so the answer to each query does not exceed <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-137-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1025\" style=\"width: 4.115em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.087em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1003.03em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1026\"><span class=\"mi\" id=\"MathJax-Span-1027\" style=\"font-family: MathJax_Math-italic;\">B</span><span class=\"mo\" id=\"MathJax-Span-1028\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-1029\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">12</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-137\">B = 12</script>.</p><p>Let's try to write a dynamic programming solution: <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-138-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1030\" style=\"width: 6.226em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.71em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1004.6em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1031\"><span class=\"mi\" id=\"MathJax-Span-1032\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1033\" style=\"font-family: MathJax_Math-italic;\">p</span><span class=\"mo\" id=\"MathJax-Span-1034\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mi\" id=\"MathJax-Span-1035\" style=\"font-family: MathJax_Math-italic;\">l</span><span class=\"mo\" id=\"MathJax-Span-1036\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1037\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">r</span><span class=\"mo\" id=\"MathJax-Span-1038\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1039\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">x</span><span class=\"mo\" id=\"MathJax-Span-1040\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1041\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1042\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-138\">dp[l,r,x,y]</script> — can we form the number <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-139-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1043\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1044\"><span class=\"mi\" id=\"MathJax-Span-1045\" style=\"font-family: MathJax_Math-italic;\">x</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-139\">x</script> in the interval <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-140-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1046\" style=\"width: 2.438em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.843em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1001.73em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1047\"><span class=\"mo\" id=\"MathJax-Span-1048\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mi\" id=\"MathJax-Span-1049\" style=\"font-family: MathJax_Math-italic;\">l</span><span class=\"mo\" id=\"MathJax-Span-1050\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1051\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">r</span><span class=\"mo\" id=\"MathJax-Span-1052\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-140\">[l, r)</script> using <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-141-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1053\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.49em, 2.492em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1054\"><span class=\"mi\" id=\"MathJax-Span-1055\" style=\"font-family: MathJax_Math-italic;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-141\">y</script> elements (the value of the dynamic programming will be <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-142-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1056\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1057\"><span class=\"mn\" id=\"MathJax-Span-1058\" style=\"font-family: MathJax_Main;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-142\">1</script> if it is possible, or <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-143-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1059\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1060\"><span class=\"mn\" id=\"MathJax-Span-1061\" style=\"font-family: MathJax_Main;\">0</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-143\">0</script> if it is not). For now, we won't go into detail about how this dynamic programming is implemented; we just need to understand that it exists and that we can compute the answer to each query as follows: we need to find the minimum <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-144-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1062\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.49em, 2.492em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1063\"><span class=\"mi\" id=\"MathJax-Span-1064\" style=\"font-family: MathJax_Math-italic;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-144\">y</script> such <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-145-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1065\" style=\"width: 8.661em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.55em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1006.5em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1066\"><span class=\"mi\" id=\"MathJax-Span-1067\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1068\" style=\"font-family: MathJax_Math-italic;\">p</span><span class=\"mo\" id=\"MathJax-Span-1069\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mi\" id=\"MathJax-Span-1070\" style=\"font-family: MathJax_Math-italic;\">l</span><span class=\"mo\" id=\"MathJax-Span-1071\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1072\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">r</span><span class=\"mo\" id=\"MathJax-Span-1073\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1074\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">x</span><span class=\"mo\" id=\"MathJax-Span-1075\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1076\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1077\" style=\"font-family: MathJax_Main;\">]</span><span class=\"mo\" id=\"MathJax-Span-1078\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-1079\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-145\">dp[l,r,x,y] = 1</script>.</p><p>This dynamic programming has the following property: if <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-146-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1080\" style=\"width: 8.661em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.55em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1006.5em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1081\"><span class=\"mi\" id=\"MathJax-Span-1082\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1083\" style=\"font-family: MathJax_Math-italic;\">p</span><span class=\"mo\" id=\"MathJax-Span-1084\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mi\" id=\"MathJax-Span-1085\" style=\"font-family: MathJax_Math-italic;\">l</span><span class=\"mo\" id=\"MathJax-Span-1086\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1087\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">r</span><span class=\"mo\" id=\"MathJax-Span-1088\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1089\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">x</span><span class=\"mo\" id=\"MathJax-Span-1090\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1091\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1092\" style=\"font-family: MathJax_Main;\">]</span><span class=\"mo\" id=\"MathJax-Span-1093\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-1094\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-146\">dp[l,r,x,y] = 1</script>, then <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-147-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1095\" style=\"width: 10.933em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 8.282em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1008.23em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1096\"><span class=\"mi\" id=\"MathJax-Span-1097\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1098\" style=\"font-family: MathJax_Math-italic;\">p</span><span class=\"mo\" id=\"MathJax-Span-1099\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mi\" id=\"MathJax-Span-1100\" style=\"font-family: MathJax_Math-italic;\">l</span><span class=\"mo\" id=\"MathJax-Span-1101\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mn\" id=\"MathJax-Span-1102\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span><span class=\"mo\" id=\"MathJax-Span-1103\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1104\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">r</span><span class=\"mo\" id=\"MathJax-Span-1105\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1106\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">x</span><span class=\"mo\" id=\"MathJax-Span-1107\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1108\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1109\" style=\"font-family: MathJax_Main;\">]</span><span class=\"mo\" id=\"MathJax-Span-1110\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-1111\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-147\">dp[l-1,r,x,y] = 1</script>, because we can use all the same elements in the segment <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-148-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1112\" style=\"width: 4.602em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.466em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1003.36em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1113\"><span class=\"mo\" id=\"MathJax-Span-1114\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mi\" id=\"MathJax-Span-1115\" style=\"font-family: MathJax_Math-italic;\">l</span><span class=\"mo\" id=\"MathJax-Span-1116\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">−</span><span class=\"mn\" id=\"MathJax-Span-1117\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span><span class=\"mo\" id=\"MathJax-Span-1118\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1119\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">r</span><span class=\"mo\" id=\"MathJax-Span-1120\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-148\">[l-1,r]</script>. Therefore, for each triple <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-149-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1121\" style=\"width: 4.223em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 3.195em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1003.09em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1122\"><span class=\"mo\" id=\"MathJax-Span-1123\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-1124\" style=\"font-family: MathJax_Math-italic;\">r</span><span class=\"mo\" id=\"MathJax-Span-1125\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1126\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">x</span><span class=\"mo\" id=\"MathJax-Span-1127\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1128\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1129\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-149\">(r,x,y)</script>, there exists a maximum value of <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-150-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1130\" style=\"width: 0.436em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1131\"><span class=\"mi\" id=\"MathJax-Span-1132\" style=\"font-family: MathJax_Math-italic;\">l</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-150\">l</script> such that <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-151-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1133\" style=\"width: 8.661em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.55em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1006.5em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1134\"><span class=\"mi\" id=\"MathJax-Span-1135\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1136\" style=\"font-family: MathJax_Math-italic;\">p</span><span class=\"mo\" id=\"MathJax-Span-1137\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mi\" id=\"MathJax-Span-1138\" style=\"font-family: MathJax_Math-italic;\">l</span><span class=\"mo\" id=\"MathJax-Span-1139\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1140\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">r</span><span class=\"mo\" id=\"MathJax-Span-1141\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1142\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">x</span><span class=\"mo\" id=\"MathJax-Span-1143\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1144\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1145\" style=\"font-family: MathJax_Main;\">]</span><span class=\"mo\" id=\"MathJax-Span-1146\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mn\" id=\"MathJax-Span-1147\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-151\">dp[l,r,x,y] = 1</script>. This means we can move this state of the dynamic programming to its value: we will obtain a new dynamic programming <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-152-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1148\" style=\"width: 5.576em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.223em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1004.12em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1149\"><span class=\"mi\" id=\"MathJax-Span-1150\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msup\" id=\"MathJax-Span-1151\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1152\" style=\"font-family: MathJax_Math-italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.49em;\"><span class=\"mo\" id=\"MathJax-Span-1153\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">′</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1154\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mi\" id=\"MathJax-Span-1155\" style=\"font-family: MathJax_Math-italic;\">r</span><span class=\"mo\" id=\"MathJax-Span-1156\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1157\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">x</span><span class=\"mo\" id=\"MathJax-Span-1158\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1159\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1160\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-152\">dp'[r,x,y]</script> — the maximum <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-153-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1161\" style=\"width: 0.436em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1162\"><span class=\"mi\" id=\"MathJax-Span-1163\" style=\"font-family: MathJax_Math-italic;\">l</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-153\">l</script> such that we can form the number <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-154-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1164\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1165\"><span class=\"mi\" id=\"MathJax-Span-1166\" style=\"font-family: MathJax_Math-italic;\">x</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-154\">x</script> out of <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-155-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1167\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.49em, 2.492em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1168\"><span class=\"mi\" id=\"MathJax-Span-1169\" style=\"font-family: MathJax_Math-italic;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-155\">y</script> elements in the interval <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-156-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1170\" style=\"width: 2.438em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.843em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1001.73em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1171\"><span class=\"mo\" id=\"MathJax-Span-1172\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mi\" id=\"MathJax-Span-1173\" style=\"font-family: MathJax_Math-italic;\">l</span><span class=\"mo\" id=\"MathJax-Span-1174\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1175\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">r</span><span class=\"mo\" id=\"MathJax-Span-1176\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-156\">[l, r)</script>. It is also easy to answer queries based on this: to answer a query, we need the minimum <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-157-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1177\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.49em, 2.492em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1178\"><span class=\"mi\" id=\"MathJax-Span-1179\" style=\"font-family: MathJax_Math-italic;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-157\">y</script> for which <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-158-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1180\" style=\"width: 7.741em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.847em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1005.79em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1181\"><span class=\"mi\" id=\"MathJax-Span-1182\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msup\" id=\"MathJax-Span-1183\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1184\" style=\"font-family: MathJax_Math-italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.49em;\"><span class=\"mo\" id=\"MathJax-Span-1185\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">′</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1186\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mi\" id=\"MathJax-Span-1187\" style=\"font-family: MathJax_Math-italic;\">r</span><span class=\"mo\" id=\"MathJax-Span-1188\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1189\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">x</span><span class=\"mo\" id=\"MathJax-Span-1190\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1191\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1192\" style=\"font-family: MathJax_Main;\">]</span><span class=\"mo\" id=\"MathJax-Span-1193\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">≥</span><span class=\"mi\" id=\"MathJax-Span-1194\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">l</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-158\">dp'[r,x,y] \\ge l</script>.</p><p>Let's try to understand how to compute this dynamic programming. We initialize <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-159-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1195\" style=\"width: 8.282em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 6.28em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1006.23em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1196\"><span class=\"mi\" id=\"MathJax-Span-1197\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mi\" id=\"MathJax-Span-1198\" style=\"font-family: MathJax_Math-italic;\">p</span><span class=\"mo\" id=\"MathJax-Span-1199\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mn\" id=\"MathJax-Span-1200\" style=\"font-family: MathJax_Main;\">0</span><span class=\"mo\" id=\"MathJax-Span-1201\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-1202\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">0</span><span class=\"mo\" id=\"MathJax-Span-1203\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-1204\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">0</span><span class=\"mo\" id=\"MathJax-Span-1205\" style=\"font-family: MathJax_Main;\">]</span><span class=\"mo\" id=\"MathJax-Span-1206\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mi\" id=\"MathJax-Span-1207\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">∞</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-159\">dp[0,0,0] = \\infty</script>, and for all other states we set <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-160-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1208\" style=\"width: 2.384em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 1.788em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.41em, 1001.73em, 2.438em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1209\"><span class=\"mo\" id=\"MathJax-Span-1210\" style=\"font-family: MathJax_Main;\">−</span><span class=\"mi\" id=\"MathJax-Span-1211\" style=\"font-family: MathJax_Main;\">∞</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-160\">-\\infty</script>. How do the values of dp change when transitioning from the <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-161-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1212\" style=\"width: 0.436em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1213\"><span class=\"mi\" id=\"MathJax-Span-1214\" style=\"font-family: MathJax_Math-italic;\">i</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-161\">i</script>-th layer to the <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-162-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1215\" style=\"width: 3.736em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.817em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1002.71em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1216\"><span class=\"mo\" id=\"MathJax-Span-1217\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-1218\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-1219\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">+</span><span class=\"mn\" id=\"MathJax-Span-1220\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span><span class=\"mo\" id=\"MathJax-Span-1221\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-162\">(i+1)</script>-th layer? First, we can set that <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-163-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1222\" style=\"width: 6.496em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.927em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1004.93em, 2.708em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1223\"><span class=\"mi\" id=\"MathJax-Span-1224\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-1225\"><span style=\"display: inline-block; position: relative; width: 1.734em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1226\" style=\"font-family: MathJax_Math-italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; clip: rect(3.466em, 1000.27em, 4.115em, -999.997em); top: -4.326em; left: 0.49em;\"><span class=\"mo\" id=\"MathJax-Span-1227\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">′</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; clip: rect(3.358em, 1001.25em, 4.223em, -999.997em); top: -3.677em; left: 0.49em;\"><span class=\"texatom\" id=\"MathJax-Span-1228\"><span class=\"mrow\" id=\"MathJax-Span-1229\"><span class=\"mi\" id=\"MathJax-Span-1230\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-1231\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">+</span><span class=\"mn\" id=\"MathJax-Span-1232\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">1</span></span></span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1233\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mi\" id=\"MathJax-Span-1234\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msubsup\" id=\"MathJax-Span-1235\"><span style=\"display: inline-block; position: relative; width: 0.814em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1236\" style=\"font-family: MathJax_Math-italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; clip: rect(3.466em, 1000.27em, 4.115em, -999.997em); top: -4.326em; left: 0.49em;\"><span class=\"mo\" id=\"MathJax-Span-1237\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">′</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; clip: rect(3.358em, 1000.33em, 4.169em, -999.997em); top: -3.677em; left: 0.49em;\"><span class=\"mi\" id=\"MathJax-Span-1238\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.575em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-163\">dp'_{i+1} = dp'_i</script> for all pairs <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-164-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1239\" style=\"width: 3.033em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.275em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1002.17em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1240\"><span class=\"mo\" id=\"MathJax-Span-1241\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-1242\" style=\"font-family: MathJax_Math-italic;\">x</span><span class=\"mo\" id=\"MathJax-Span-1243\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1244\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1245\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-164\">(x,y)</script> (all subsets available with the right boundary <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-165-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1246\" style=\"width: 0.436em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1247\"><span class=\"mi\" id=\"MathJax-Span-1248\" style=\"font-family: MathJax_Math-italic;\">i</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-165\">i</script> remain available with the right boundary <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-166-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1249\" style=\"width: 2.708em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.059em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1002em, 2.438em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1250\"><span class=\"mi\" id=\"MathJax-Span-1251\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-1252\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">+</span><span class=\"mn\" id=\"MathJax-Span-1253\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-166\">i+1</script>), and then we will try to \"improve\" it using the new element.</p><p>How can the new element <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-167-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1254\" style=\"width: 1.139em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.87em, 2.438em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1255\"><span class=\"msubsup\" id=\"MathJax-Span-1256\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1257\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-1258\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-167\">a_i</script> \"improve\" the values of the dynamic programming? For some <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-168-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1259\" style=\"width: 3.033em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 2.275em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1002.17em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1260\"><span class=\"mo\" id=\"MathJax-Span-1261\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-1262\" style=\"font-family: MathJax_Math-italic;\">x</span><span class=\"mo\" id=\"MathJax-Span-1263\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1264\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1265\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-168\">(x,y)</script>, there may be a way to form <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-169-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1266\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1267\"><span class=\"mi\" id=\"MathJax-Span-1268\" style=\"font-family: MathJax_Math-italic;\">x</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-169\">x</script> using <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-170-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1269\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.49em, 2.492em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1270\"><span class=\"mi\" id=\"MathJax-Span-1271\" style=\"font-family: MathJax_Math-italic;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-170\">y</script> elements with a more optimal left boundary. Firstly, the way to form <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-171-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1272\" style=\"width: 1.139em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.87em, 2.438em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1273\"><span class=\"msubsup\" id=\"MathJax-Span-1274\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1275\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-1276\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-171\">a_i</script> using <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-172-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1277\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1278\"><span class=\"mn\" id=\"MathJax-Span-1279\" style=\"font-family: MathJax_Main;\">1</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-172\">1</script> element will definitely improve, so we can assign <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-173-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1280\" style=\"width: 10.392em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 7.849em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1007.79em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1281\"><span class=\"mi\" id=\"MathJax-Span-1282\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msup\" id=\"MathJax-Span-1283\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1284\" style=\"font-family: MathJax_Math-italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.49em;\"><span class=\"mo\" id=\"MathJax-Span-1285\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">′</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1286\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mi\" id=\"MathJax-Span-1287\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-1288\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">+</span><span class=\"mn\" id=\"MathJax-Span-1289\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span><span class=\"mo\" id=\"MathJax-Span-1290\" style=\"font-family: MathJax_Main;\">,</span><span class=\"msubsup\" id=\"MathJax-Span-1291\" style=\"padding-left: 0.165em;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1292\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-1293\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1294\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mn\" id=\"MathJax-Span-1295\" style=\"font-family: MathJax_Main; padding-left: 0.165em;\">1</span><span class=\"mo\" id=\"MathJax-Span-1296\" style=\"font-family: MathJax_Main;\">]</span><span class=\"mo\" id=\"MathJax-Span-1297\" style=\"font-family: MathJax_Main; padding-left: 0.273em;\">=</span><span class=\"mi\" id=\"MathJax-Span-1298\" style=\"font-family: MathJax_Math-italic; padding-left: 0.273em;\">i</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-173\">dp'[i+1,a_i,1] = i</script>. Secondly, we can take some set that is reachable for the right boundary <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-174-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1299\" style=\"width: 0.436em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1300\"><span class=\"mi\" id=\"MathJax-Span-1301\" style=\"font-family: MathJax_Math-italic;\">i</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-174\">i</script> and add the element <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-175-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1302\" style=\"width: 1.139em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.87em, 2.438em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1303\"><span class=\"msubsup\" id=\"MathJax-Span-1304\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1305\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-1306\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-175\">a_i</script> to it; that is, we transition from <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-176-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1307\" style=\"width: 5.468em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.115em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1004.01em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1308\"><span class=\"mi\" id=\"MathJax-Span-1309\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msup\" id=\"MathJax-Span-1310\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1311\" style=\"font-family: MathJax_Math-italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.49em;\"><span class=\"mo\" id=\"MathJax-Span-1312\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">′</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1313\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mi\" id=\"MathJax-Span-1314\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-1315\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1316\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">x</span><span class=\"mo\" id=\"MathJax-Span-1317\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1318\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1319\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-176\">dp'[i,x,y]</script> to <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-177-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1320\" style=\"width: 12.719em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.635em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1009.53em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1321\"><span class=\"mi\" id=\"MathJax-Span-1322\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msup\" id=\"MathJax-Span-1323\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1324\" style=\"font-family: MathJax_Math-italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.49em;\"><span class=\"mo\" id=\"MathJax-Span-1325\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">′</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1326\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mi\" id=\"MathJax-Span-1327\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-1328\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">+</span><span class=\"mn\" id=\"MathJax-Span-1329\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span><span class=\"mo\" id=\"MathJax-Span-1330\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1331\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">x</span><span class=\"mo\" id=\"MathJax-Span-1332\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">⊕</span><span class=\"msubsup\" id=\"MathJax-Span-1333\" style=\"padding-left: 0.219em;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1334\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-1335\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1336\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1337\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1338\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">+</span><span class=\"mn\" id=\"MathJax-Span-1339\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span><span class=\"mo\" id=\"MathJax-Span-1340\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-177\">dp'[i+1, x \\oplus a_i, y+1]</script>. The minimum index of the number that we will use in such a set will still be <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-178-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1341\" style=\"width: 5.468em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.115em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1004.01em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1342\"><span class=\"mi\" id=\"MathJax-Span-1343\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msup\" id=\"MathJax-Span-1344\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1345\" style=\"font-family: MathJax_Math-italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.49em;\"><span class=\"mo\" id=\"MathJax-Span-1346\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">′</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1347\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mi\" id=\"MathJax-Span-1348\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-1349\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1350\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">x</span><span class=\"mo\" id=\"MathJax-Span-1351\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1352\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1353\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-178\">dp'[i,x,y]</script>, because the new number <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-179-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1354\" style=\"width: 1.139em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.87em, 2.438em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1355\"><span class=\"msubsup\" id=\"MathJax-Span-1356\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1357\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-1358\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-179\">a_i</script> has a higher index than all the previous numbers we have used. Therefore, if there is a way to form <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-180-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1359\" style=\"width: 0.814em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1360\"><span class=\"mi\" id=\"MathJax-Span-1361\" style=\"font-family: MathJax_Math-italic;\">x</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-180\">x</script> using <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-181-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1362\" style=\"width: 0.652em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.518em, 1000.49em, 2.492em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1363\"><span class=\"mi\" id=\"MathJax-Span-1364\" style=\"font-family: MathJax_Math-italic;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-181\">y</script> elements with the right boundary <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-182-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1365\" style=\"width: 0.436em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1366\"><span class=\"mi\" id=\"MathJax-Span-1367\" style=\"font-family: MathJax_Math-italic;\">i</span></span><span style=\"display: inline-block; width: 0px; height: 2.113em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-182\">i</script> and the left boundary <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-183-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1368\" style=\"width: 5.468em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.115em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1004.01em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1369\"><span class=\"mi\" id=\"MathJax-Span-1370\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msup\" id=\"MathJax-Span-1371\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1372\" style=\"font-family: MathJax_Math-italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.49em;\"><span class=\"mo\" id=\"MathJax-Span-1373\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">′</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1374\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mi\" id=\"MathJax-Span-1375\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-1376\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1377\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">x</span><span class=\"mo\" id=\"MathJax-Span-1378\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1379\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1380\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-183\">dp'[i,x,y]</script>, we can form <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-184-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1381\" style=\"width: 12.719em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 9.635em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.247em, 1009.53em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1382\"><span class=\"mi\" id=\"MathJax-Span-1383\" style=\"font-family: MathJax_Math-italic;\">d<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"msup\" id=\"MathJax-Span-1384\"><span style=\"display: inline-block; position: relative; width: 0.76em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1385\" style=\"font-family: MathJax_Math-italic;\">p</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.49em;\"><span class=\"mo\" id=\"MathJax-Span-1386\" style=\"font-size: 70.7%; font-family: MathJax_Main;\">′</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1387\" style=\"font-family: MathJax_Main;\">[</span><span class=\"mi\" id=\"MathJax-Span-1388\" style=\"font-family: MathJax_Math-italic;\">i</span><span class=\"mo\" id=\"MathJax-Span-1389\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">+</span><span class=\"mn\" id=\"MathJax-Span-1390\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span><span class=\"mo\" id=\"MathJax-Span-1391\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1392\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">x</span><span class=\"mo\" id=\"MathJax-Span-1393\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">⊕</span><span class=\"msubsup\" id=\"MathJax-Span-1394\" style=\"padding-left: 0.219em;\"><span style=\"display: inline-block; position: relative; width: 0.869em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mi\" id=\"MathJax-Span-1395\" style=\"font-family: MathJax_Math-italic;\">a</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -3.839em; left: 0.544em;\"><span class=\"mi\" id=\"MathJax-Span-1396\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">i</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1397\" style=\"font-family: MathJax_Main;\">,</span><span class=\"mi\" id=\"MathJax-Span-1398\" style=\"font-family: MathJax_Math-italic; padding-left: 0.165em;\">y<span style=\"display: inline-block; overflow: hidden; height: 1px; width: 0.003em;\"></span></span><span class=\"mo\" id=\"MathJax-Span-1399\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">+</span><span class=\"mn\" id=\"MathJax-Span-1400\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">1</span><span class=\"mo\" id=\"MathJax-Span-1401\" style=\"font-family: MathJax_Main;\">]</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.504em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-184\">dp'[i+1, x \\oplus a_i, y+1]</script> with the same left boundary.</p><p>This dynamic programming has a complexity of <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-185-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1402\" style=\"width: 7.254em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 5.468em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1005.36em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1403\"><span class=\"mi\" id=\"MathJax-Span-1404\" style=\"font-family: MathJax_Math-italic;\">O</span><span class=\"mo\" id=\"MathJax-Span-1405\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-1406\" style=\"font-family: MathJax_Math-italic;\">n</span><span class=\"mo\" id=\"MathJax-Span-1407\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">⋅</span><span class=\"mi\" id=\"MathJax-Span-1408\" style=\"font-family: MathJax_Math-italic; padding-left: 0.219em;\">B</span><span class=\"mo\" id=\"MathJax-Span-1409\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">⋅</span><span class=\"msubsup\" id=\"MathJax-Span-1410\" style=\"padding-left: 0.219em;\"><span style=\"display: inline-block; position: relative; width: 1.139em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-1411\" style=\"font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.49em;\"><span class=\"mi\" id=\"MathJax-Span-1412\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">B</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1413\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.646em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-185\">O(n \\cdot B \\cdot 2^B)</script>, which is quite fast but does not fit into memory limits. To fix this, let's group all queries according to their right boundaries, and store only two (or even only one!) layer of dynamic programming, moving the right boundary and answering all queries for the current right boundary. This will reduce memory usage to <span class=\"MathJax_Preview\" style=\"color: inherit;\"></span><span class=\"MathJax\" id=\"MathJax-Element-186-Frame\" tabindex=\"0\" style=\"\"><nobr><span class=\"math\" id=\"MathJax-Span-1414\" style=\"width: 5.522em; display: inline-block;\"><span style=\"display: inline-block; position: relative; width: 4.169em; height: 0px; font-size: 132%;\"><span style=\"position: absolute; clip: rect(1.139em, 1004.06em, 2.6em, -999.997em); top: -2.162em; left: 0em;\"><span class=\"mrow\" id=\"MathJax-Span-1415\"><span class=\"mi\" id=\"MathJax-Span-1416\" style=\"font-family: MathJax_Math-italic;\">O</span><span class=\"mo\" id=\"MathJax-Span-1417\" style=\"font-family: MathJax_Main;\">(</span><span class=\"mi\" id=\"MathJax-Span-1418\" style=\"font-family: MathJax_Math-italic;\">B</span><span class=\"mo\" id=\"MathJax-Span-1419\" style=\"font-family: MathJax_Main; padding-left: 0.219em;\">⋅</span><span class=\"msubsup\" id=\"MathJax-Span-1420\" style=\"padding-left: 0.219em;\"><span style=\"display: inline-block; position: relative; width: 1.139em; height: 0px;\"><span style=\"position: absolute; clip: rect(3.195em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;\"><span class=\"mn\" id=\"MathJax-Span-1421\" style=\"font-family: MathJax_Main;\">2</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span><span style=\"position: absolute; top: -4.38em; left: 0.49em;\"><span class=\"mi\" id=\"MathJax-Span-1422\" style=\"font-size: 70.7%; font-family: MathJax_Math-italic;\">B</span><span style=\"display: inline-block; width: 0px; height: 4.007em;\"></span></span></span></span><span class=\"mo\" id=\"MathJax-Span-1423\" style=\"font-family: MathJax_Main;\">)</span></span><span style=\"display: inline-block; width: 0px; height: 2.167em;\"></span></span></span><span style=\"display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.646em;\"></span></span></nobr></span><script type=\"math/tex\" id=\"MathJax-Element-186\">O(B \\cdot 2^B)</script>, which fits within the constraints.</p></div></div></div></div>"
}