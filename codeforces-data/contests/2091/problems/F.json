{
  "contestId": 2091,
  "index": "F",
  "title": "Igor and Mountain",
  "timeLimit": "5 seconds",
  "memoryLimit": "512 megabytes",
  "rating": 1800,
  "tags": [
    "binary search",
    "brute force",
    "dp"
  ],
  "statementHtml": "<p>The visitors of the IT Campus \"NEIMARK\" are not only strong programmers but also physically robust individuals! Some practice swimming, some rowing, and some rock climbing!</p>\n<p>Master Igor is a prominent figure in the local rock climbing community. One day, he went on a mountain hike to ascend one of the peaks. As an experienced climber, Igor decided not to follow the established trails but to use his skills to climb strictly vertically.</p>\n<p>Igor found a rectangular vertical section of the mountain and mentally divided it into <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-2\">n</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-1-Frame\" tabindex=\"0\" style=\"\"></span><script type=\"math/tex\" id=\"MathJax-Element-1\">n</script> horizontal levels. He then split each level into <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-3\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-4\">m</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-2-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-2\">m</script> segments using vertical partitions. Upon inspecting these segments, Igor discovered convenient protrusions that can be grasped (hereafter referred to as <span class=\"tex-font-style-it\">holds</span>). Thus, the selected part of the mountain can be represented as an <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-5\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-6\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-7\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">×</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-8\">m</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-3-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-3\">n \\times m</script> rectangle, with some cells containing holds.</p>\n<p>Being an experienced programmer, Igor decided to count the number of valid <span class=\"tex-font-style-it\">routes</span>. A route is defined as a sequence of <span class=\"tex-font-style-bf\">distinct</span> holds. A route is considered valid if the following conditions are satisfied: </p>\n<p>Igor's arm span is <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-13\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-14\">d</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-6-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-6\">d</script>, which means he can move from one hold to another if the <span class=\"tex-font-style-bf\">Euclidean distance</span> between the centers of the corresponding segments does not exceed <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-15\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-16\">d</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-7-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-7\">d</script>. The distance between sections (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-17\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-18\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-19\" style=\"margin-right: 0.05em;\">i</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-20\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-21\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-22\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-23\" style=\"margin-right: 0.05em;\">j</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-24\" style=\"vertical-align: -0.4em;\">1</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-8-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-8\">i_1, j_1</script>) and (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-25\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-26\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-27\" style=\"margin-right: 0.05em;\">i</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-28\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-29\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-30\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-31\" style=\"margin-right: 0.05em;\">j</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-32\" style=\"vertical-align: -0.4em;\">2</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-9-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-9\">i_2, j_2</script>) is given by <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-33\"><span class=\"MJXp-msqrt\" id=\"MJXp-Span-34\"><span class=\"MJXp-surd\"><span class=\"MJXp-right MJXp-scale8\" style=\"font-size: 201%; margin-top: 0.07em; margin-left: -0.109em;\">√</span></span><span class=\"MJXp-root\"><span class=\"MJXp-rule\" style=\"border-top: 0.089em solid;\"></span><span class=\"MJXp-box\"><span class=\"MJXp-mo\" id=\"MJXp-Span-35\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-36\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-37\" style=\"margin-right: 0.05em;\">i</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-38\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-39\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-40\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-41\" style=\"margin-right: 0.05em;\">i</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-42\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-43\"><span class=\"MJXp-mo\" id=\"MJXp-Span-44\" style=\"margin-left: 0em; margin-right: 0.05em;\">)</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-45\" style=\"vertical-align: 0.5em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-46\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mo\" id=\"MJXp-Span-47\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-48\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-49\" style=\"margin-right: 0.05em;\">j</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-50\" style=\"vertical-align: -0.4em;\">1</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-51\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-52\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-53\" style=\"margin-right: 0.05em;\">j</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-54\" style=\"vertical-align: -0.4em;\">2</span></span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-55\"><span class=\"MJXp-mo\" id=\"MJXp-Span-56\" style=\"margin-left: 0em; margin-right: 0.05em;\">)</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-57\" style=\"vertical-align: 0.5em;\">2</span></span></span></span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-10-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-10\">\\sqrt{(i_1 - i_2) ^ 2 + (j_1 - j_2) ^ 2}</script>.</p>\n<p>Calculate the number of different valid routes. Two routes are considered different if they differ in the list of holds used or in the order in which these holds are visited.</p>",
  "inputSpecHtml": "<p>Each test contains multiple test cases. The first line contains the number of test cases <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-58\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-59\">t</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-11-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-11\">t</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-60\"><span class=\"MJXp-mn\" id=\"MJXp-Span-61\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-62\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-63\">t</span><span class=\"MJXp-mo\" id=\"MJXp-Span-64\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-65\"><span class=\"MJXp-mn\" id=\"MJXp-Span-66\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-67\" style=\"vertical-align: 0.5em;\">3</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-12-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-12\">1 \\leq t \\leq 10^3</script>). The description of the test cases follows.</p><p>The first line of each test case contains three integers <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-68\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-69\">n</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-13-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-13\">n</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-70\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-71\">m</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-14-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-14\">m</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-72\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-73\">d</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-15-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-15\">d</script> (<span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-74\"><span class=\"MJXp-mn\" id=\"MJXp-Span-75\">2</span><span class=\"MJXp-mo\" id=\"MJXp-Span-76\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-77\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-78\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mn\" id=\"MJXp-Span-79\">2000</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-16-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-16\">2 \\leq n \\leq 2000</script>, <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-80\"><span class=\"MJXp-mn\" id=\"MJXp-Span-81\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-82\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-83\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-84\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-85\">d</span><span class=\"MJXp-mo\" id=\"MJXp-Span-86\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">≤</span><span class=\"MJXp-mn\" id=\"MJXp-Span-87\">2000</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-17-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-17\">1 \\leq m, d \\leq 2000</script>).</p><p>Each of the following <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-88\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-89\">n</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-18-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-18\">n</script> lines contains <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-90\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-91\">m</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-19-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-19\">m</script> characters&nbsp;— the description of the corresponding level of the mountain. The symbol '#' represents an empty section, and the symbol 'X' represents a section with a hold. The levels are described from top to bottom.</p><p>It is guaranteed that the sum of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-92\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-93\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-94\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⋅</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-95\">m</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-20-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-20\">n \\cdot m</script> over all test cases does not exceed <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-96\"><span class=\"MJXp-mn\" id=\"MJXp-Span-97\">4</span><span class=\"MJXp-mo\" id=\"MJXp-Span-98\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⋅</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-99\"><span class=\"MJXp-mn\" id=\"MJXp-Span-100\" style=\"margin-right: 0.05em;\">10</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-101\" style=\"vertical-align: 0.5em;\">6</span></span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-21-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-21\">4 \\cdot 10^6</script>.</p>",
  "outputSpecHtml": "<p>For each test case, output the number of different routes modulo <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-102\"><span class=\"MJXp-mn\" id=\"MJXp-Span-103\">998244353</span></span></span><span class=\"MathJax MathJax_Processing\" id=\"MathJax-Element-22-Frame\" tabindex=\"0\"></span><script type=\"math/tex\" id=\"MathJax-Element-22\">998244353</script>.</p>",
  "noteHtml": "<p>Possible routes in the first case: </p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/690658303fd506886aca153e80ac4c6db61d7cb8.png\" style=\"zoom: 75.0%;max-width: 100.0%;max-height: 100.0%;\"> </center><p>In the second example, Igor's arm span has become larger, so new routes are available to him, for example this one: </p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/5fd7b97b8ba5036d98b5afe1eef30b846d9c67fd.png\" style=\"zoom: 75.0%;max-width: 100.0%;max-height: 100.0%;\"> </center><p>In the third example, there are no holds on the lower level, so there are no correct routes.</p>",
  "samples": [
    {
      "input": "33 4 1XX#X#XX##X#X3 4 2XX#X#XX##X#X3 1 3XX#",
      "output": "2\n60\n0"
    }
  ],
  "images": [
    "images/F_1.png",
    "images/F_2.png"
  ],
  "url": "https://codeforces.com/contest/2091/problem/F",
  "tutorialHtml": "<div><div class=\"ttypography\"><div class=\"problem-statement\"><div><p>Let's use the dynamic programming method <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1471\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1472\">d</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1473\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1474\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1475\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1476\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1477\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1478\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1479\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1480\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1481\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1482\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-213\">dp[i][j][f]</script>:</p><ul> <li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1483\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1484\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-214\">i</script>&nbsp;— row number. </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1485\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1486\">j</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-215\">j</script>&nbsp;— column number. </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1487\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1488\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1489\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1490\">0</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-216\">f = 0</script> means that exactly one hold has already been selected in the current row, and a second one can still be added (since there are a maximum of two holds per level). </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1491\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1492\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1493\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1494\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-217\">f = 1</script> means that two holds have already been used in this level. </li><li> <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1495\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1496\">d</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1497\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1498\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1499\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1500\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1501\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1502\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1503\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1504\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1505\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1506\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-218\">dp[i][j][f]</script>&nbsp;— the number of ways to construct a correct route starting with a hold in cell <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1507\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1508\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1509\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1510\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1511\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1512\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-219\">(i,j)</script>, given that <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1513\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1514\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1515\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1516\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-220\">f + 1</script> holds are already used in row <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1517\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1518\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-221\">i</script>. </li></ul><p>For a cell <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1519\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1520\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1521\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1522\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1523\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1524\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-222\">(i,j)</script> with a hold (i.e. <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1525\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1526\">s</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1527\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1528\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1529\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1530\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1531\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1532\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1533\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-223\">s[i][j] =</script> 'X'): </p><ul> <li> At the lower level, i.e. <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1534\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1535\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1536\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1537\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1538\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1539\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-224\">i = n - 1</script>, this hold can serve as the start of the route, so all such <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1540\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1541\">d</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1542\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1543\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1544\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1545\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1546\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1547\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1548\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1549\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1550\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1551\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1552\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1553\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1554\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1555\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-225\">dp[n - 1][j][f] = 1</script>.</li><li> If one hold <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1556\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1557\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1558\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1559\">0</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-226\">f = 0</script> is already selected at the current level, then you can take the second hold at the same level at a distance of no more than <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1560\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1561\">d</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-227\">d</script>, i.e. <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1562\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1563\">d</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1564\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1565\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1566\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1567\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1568\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1569\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1570\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1571\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1572\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1573\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1574\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1575\">d</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1576\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1577\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1578\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1579\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1580\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1581\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1582\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1583\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1584\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1585\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1586\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1587\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1588\" style=\"margin-left: 0.111em; margin-right: 0.05em;\">∑</span><span class=\"MJXp-script-box\" style=\"height: 1.86em; vertical-align: -0.64em;\"><span class=\" MJXp-script\"><span><span style=\"margin-bottom: -0.25em;\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-1595\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1596\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1597\">+</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1598\">d</span></span></span></span></span><span class=\" MJXp-script\"><span><span style=\"margin-top: -0.85em;\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-1589\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1590\">y</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1591\">=</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1592\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1593\">−</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1594\">d</span></span></span></span></span></span></span><span class=\"MJXp-mrow\" id=\"MJXp-Span-1599\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1600\">d</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1601\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1602\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1603\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1604\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1605\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1606\">y</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1607\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1608\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1609\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1610\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1611\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1612\">d</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1613\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1614\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1615\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1616\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1617\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1618\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1619\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1620\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1621\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1622\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-228\">dp[i][j][f]= dp[i][j][f] + \\sum_{y = j - d}^{j + d}{dp[i][y][1]} - dp[i][j][1]</script> (let's not forget to exclude the point <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1623\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1624\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1625\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1626\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1627\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1628\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-229\">(i, j)</script> from the sum, so as not to count it twice).</li><li> The transition to the next level (if possible) <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1629\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1630\">i</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-230\">i</script> in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1631\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1632\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1633\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1634\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-231\">i+1</script> takes a vertical distance equal to <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1635\"><span class=\"MJXp-mn\" id=\"MJXp-Span-1636\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-232\">1</script>. So the range of <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1637\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1638\">j</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-233\">j</script> for the transition will be <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1639\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1640\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1641\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1642\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1643\">d</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1644\">x</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1645\" style=\"margin-left: 0em; margin-right: 0.222em;\">,</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1646\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1647\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1648\">d</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1649\">x</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1650\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-234\">[j - dx, j + dx]</script>, where <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1651\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1652\">d</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1653\">x</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1654\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1655\" style=\"margin-left: 0em; margin-right: 0em;\">⌊</span><span class=\"MJXp-msqrt\" id=\"MJXp-Span-1656\"><span class=\"MJXp-surd\"><span class=\"MJXp-right MJXp-scale10\" style=\"font-size: 166%; margin-top: 0.084em; margin-left: 0em;\">√</span></span><span class=\"MJXp-root\"><span class=\"MJXp-rule\" style=\"border-top: 0.08em solid;\"></span><span class=\"MJXp-box\"><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1657\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1658\" style=\"margin-right: 0.05em;\">d</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-1659\" style=\"vertical-align: 0.5em;\">2</span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1660\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1661\"><span class=\"MJXp-mn\" id=\"MJXp-Span-1662\" style=\"margin-right: 0.05em;\">1</span><span class=\"MJXp-mn MJXp-script\" id=\"MJXp-Span-1663\" style=\"vertical-align: 0.5em;\">2</span></span></span></span></span><span class=\"MJXp-mo\" id=\"MJXp-Span-1664\" style=\"margin-left: 0em; margin-right: 0em;\">⌋</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1665\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1666\">d</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1667\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">−</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1668\">1</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-235\">dx = \\lfloor \\sqrt{d^2 - 1^2} \\rfloor = d - 1</script><p><span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1669\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1670\">d</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1671\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1672\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1673\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1674\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1675\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1676\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1677\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1678\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1679\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1680\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1681\" style=\"margin-left: 0.333em; margin-right: 0.333em;\">=</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1682\">d</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1683\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1684\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1685\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1686\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1687\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1688\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1689\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1690\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1691\">f</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1692\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1693\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-msubsup\" id=\"MJXp-Span-1694\"><span class=\"MJXp-mo\" id=\"MJXp-Span-1695\" style=\"margin-left: 0.111em; margin-right: 0.05em;\">∑</span><span class=\"MJXp-script-box\" style=\"height: 1.86em; vertical-align: -0.64em;\"><span class=\" MJXp-script\"><span><span style=\"margin-bottom: -0.25em;\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-1703\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1704\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1705\">+</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1706\">d</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1707\">x</span></span></span></span></span><span class=\" MJXp-script\"><span><span style=\"margin-top: -0.85em;\"><span class=\"MJXp-mrow\" id=\"MJXp-Span-1696\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1697\">y</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1698\">=</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1699\">j</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1700\">−</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1701\">d</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1702\">x</span></span></span></span></span></span></span><span class=\"MJXp-mrow\" id=\"MJXp-Span-1708\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1709\">d</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1710\">p</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1711\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1712\">i</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1713\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">+</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1714\">1</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1715\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1716\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1717\">y</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1718\" style=\"margin-left: 0em; margin-right: 0em;\">]</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1719\" style=\"margin-left: 0em; margin-right: 0em;\">[</span><span class=\"MJXp-mn\" id=\"MJXp-Span-1720\">0</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1721\" style=\"margin-left: 0em; margin-right: 0em;\">]</span></span></span></span><script type=\"math/tex\" id=\"MathJax-Element-236\">dp[i][j][f]= dp[i][j][f] + \\sum_{y = j - dx}^{j + dx}{dp[i + 1][y][0]}</script> </p></li></ul><p>This solution recalculates each state in <span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1722\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1723\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1724\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1725\">d</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1726\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-237\">O(d)</script>, to make it more efficient&nbsp;— you need to use prefix sums.</p><p><span class=\"MathJax_Preview\" style=\"color: inherit;\"><span class=\"MJXp-math\" id=\"MJXp-Span-1727\"><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1728\">O</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1729\" style=\"margin-left: 0em; margin-right: 0em;\">(</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1730\">n</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1731\" style=\"margin-left: 0.267em; margin-right: 0.267em;\">⋅</span><span class=\"MJXp-mi MJXp-italic\" id=\"MJXp-Span-1732\">m</span><span class=\"MJXp-mo\" id=\"MJXp-Span-1733\" style=\"margin-left: 0em; margin-right: 0em;\">)</span></span></span><script type=\"math/tex\" id=\"MathJax-Element-238\">O(n \\cdot m)</script>.</p></div></div></div></div>"
}