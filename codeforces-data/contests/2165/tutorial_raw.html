<html lang="en"><head>
        <script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script type="text/javascript" async="" src="https://www.googletagmanager.com/gtag/js?id=G-K230KVN22K&amp;cx=c&amp;gtm=4e5ca1"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-743380-5"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-743380-5');
        </script>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="ec60a538c257e1eefc500c98d4a47a17">
    <meta id="viewport" name="viewport" content="width=device-width, initial-scale=0.01">
    <meta name="robots" content="noai">
    <meta name="robots" content="noimageai">

    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery-1.8.3.js"></script>
    <script type="application/javascript">
        window.locale = "en";
        window.standaloneContest = false;
        function adjustViewport() {
            var screenWidthPx = Math.min($(window).width(), window.screen.width);
            var siteWidthPx = 1100; // min width of site
            var ratio = Math.min(screenWidthPx / siteWidthPx, 1.0);
            var viewport = "width=device-width, initial-scale=" + ratio;
            $('#viewport').attr('content', viewport);
            var style = $('<style>html * { max-height: 1000000px; }</style>');
            $('html > head').append(style);
        }

        if ( /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) ) {
            adjustViewport();
        }

        /* Protection against trailing dot in domain. */
        let hostLength = window.location.host.length;
        if (hostLength > 1 && window.location.host[hostLength - 1] === '.') {
            window.location = window.location.protocol + "//" + window.location.host.substring(0, hostLength - 1);
        }
    </script>

    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="l3">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90">
    <meta property="fb:admins" content="100001352546622">
    <meta property="og:image" content="//codeforces.com/codeforces.org/s/52448/images/codeforces-sponsored-by-ton.png">
    <link rel="image_src" href="//codeforces.com/codeforces.org/s/52448/images/codeforces-sponsored-by-ton.png">
    <meta property="og:title" content="Codeforces Round 1064 (Div. 1, Div. 2) Editorial - Codeforces">
    <meta property="og:description" content="">
    
    <meta property="og:site_name" content="Codeforces">
    
    
    
    
    
    
    <meta name="utc_offset" content="+03:00">
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2">
    <title>Codeforces Round 1064 (Div. 1, Div. 2) Editorial - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community">
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup">
    <meta name="robots" content="index, follow">

    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/font-awesome.min.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/line-awesome.min.css" type="text/css" charset="utf-8">

        <link rel="preconnect" href="https://challenges.cloudflare.com">
        <link rel="dns-prefetch" href="https://challenges.cloudflare.com">
        <link href="//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700&amp;subset=latin,cyrillic" rel="stylesheet" type="text/css">
        <link href="//fonts.googleapis.com/css?family=Cuprum&amp;subset=latin,cyrillic" rel="stylesheet" type="text/css">


    <link rel="apple-touch-icon" sizes="57x57" href="//codeforces.com/codeforces.org/s/52448/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//codeforces.com/codeforces.org/s/52448/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//codeforces.com/codeforces.org/s/52448/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//codeforces.com/codeforces.org/s/52448/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//codeforces.com/codeforces.org/s/52448/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//codeforces.com/codeforces.org/s/52448/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//codeforces.com/codeforces.org/s/52448/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//codeforces.com/codeforces.org/s/52448/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//codeforces.com/codeforces.org/s/52448/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="//codeforces.com/codeforces.org/s/52448/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//codeforces.com/codeforces.org/s/52448/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//codeforces.com/codeforces.org/s/52448/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//codeforces.com/codeforces.org/s/52448/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="//codeforces.com/codeforces.org/s/52448/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/prettify.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/clear.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/style.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/ttypography.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/problem-statement.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/second-level-menu.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/roundbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/datatable.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/table-form.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/topic.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/jquery.jgrowl.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/facebox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/jquery.wysiwyg.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/jquery.autocomplete.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/codeforces.datepick.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/colorbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/jquery.drafts.css" type="text/css" charset="utf-8">
        <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/css/community.css" type="text/css" charset="utf-8">

    <!-- MathJax -->
    <script type="text/x-mathjax-config;executed=true">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$$$','$$$']], displayMath: [['$$$$$$','$$$$$$']]}
    });
    MathJax.Hub.Register.StartupHook("End", function () {
        Codeforces.runMathJaxListeners();
    });
    </script>
    <script type="text/javascript" async="" src="https://codeforces.com/mathjax.codeforces.org/MathJax.js?config=TeX-AMS_HTML-full">
    </script>
    <!-- /MathJax -->

    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/prettify/prettify.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/moment-with-locales.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/pushstream.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.easing.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.lavalamp.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.jgrowl.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.swipe.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.hotkeys.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/facebox.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.wysiwyg.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/controls/wysiwyg.colorpicker.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/controls/wysiwyg.table.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/controls/wysiwyg.image.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/controls/wysiwyg.link.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.autocomplete.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.datepick.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.ie6blocker.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.colorbox-min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.ba-bbq.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/jquery.drafts.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/clipboard.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/autosize.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/sjcl.js"></script>
    <script type="text/javascript" src="/scripts/5913b958cb6e1f2144469a313cc0ac6e/en/codeforces-options.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/codeforces.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/EventCatcher.js?v=20160131"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/preparedVerdictFormats-en.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/confetti.min.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/js/purify.min.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/markitup/skins/markitup/style.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="//codeforces.com/codeforces.org/s/52448/markitup/sets/markdown/style.css" type="text/css" charset="utf-8">


    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/markitup/jquery.markitup.js"></script>
    <script type="text/javascript" src="//codeforces.com/codeforces.org/s/52448/markitup/sets/markdown/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->




<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888; display: contents}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css" media="screen">#swfcontainer {visibility:hidden}</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover, .MJXp-munder {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > *, .MJXp-munder > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none; box-sizing: content-box}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_test {font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.MathJax_test.mjx-test-display {display: table!important}
.MathJax_test.mjx-test-inline {display: inline!important; margin-right: -1px}
.MathJax_test.mjx-test-default {display: block!important; clear: both}
.MathJax_ex_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60ex}
.MathJax_em_box {display: inline-block!important; position: absolute; overflow: hidden; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0; width: 1px; height: 60em}
.mjx-test-inline .MathJax_left_box {display: inline-block; width: 0; float: left}
.mjx-test-inline .MathJax_right_box {display: inline-block; width: 0; float: right}
.mjx-test-display .MathJax_right_box {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.9') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.9') format('woff'), url('https://codeforces.com/mathjax.codeforces.org/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.9') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body class=" "><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div></div><div id="MathJax_Message" style="display: none;"></div><span style="display:none;" class="csrf-token" data-csrf="ec60a538c257e1eefc500c98d4a47a17">&nbsp;</span>

<!-- .notificationTextCleaner used in Codeforces.showAnnouncements() -->
<div class="notificationTextCleaner" style="font-size: 0"></div>
<div class="button-up" style="display: none; opacity: 0.7; width: 50px; height:100%; position: fixed; left: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 3.0rem;"><i class="icon-circle-arrow-up"></i></div>
<div class="verdictPrototypeDiv" style="display: none;"></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    String.prototype.hashCode = function() {
        var hash = 0, i, chr;
        if (this.length === 0) return hash;
        for (i = 0; i < this.length; i++) {
            chr   = this.charCodeAt(i);
            hash  = ((hash << 5) - hash) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        return hash;
    };

    var queryMobile = Codeforces.queryString.mobile;
    if (queryMobile === "true" || queryMobile === "false") {
        Codeforces.putToStorage("useMobile", queryMobile === "true");
    } else {
        var useMobile = Codeforces.getFromStorage("useMobile");
        if (useMobile === true || useMobile === false) {
            if (useMobile != false) {
                Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", useMobile));
            }
        }
    }
</script>

<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>





    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }, beforeSend: function(jqXHR, settings) {
        const url = new URL(settings.url, window.location.href);
        const urlHref = url.href;
        url.searchParams.set('rv', Math.random().toString(36).substr(2, 9)); // Generate a random value
        settings.url = url.href;
    }});

    window.updateTypography();
    Codeforces.signForms();
    Codeforces.applyDatatableJs("Hold Ctrl+Alt and click to hide column. Also, you can drag&drop columns to reorder them.");

    setTimeout(function() {
        $(".second-level-menu-list").lavaLamp({
            fx: "backout",
            speed: 700
        });
    }, 100);


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();


    function showAnnouncements(json) {
        if (json.t === "a") {
            setTimeout(function() {
               Codeforces.showAnnouncements(json.d, "en");
            }, Math.random() * 500);
        }
    }

    function showEventCatcherUserMessage(json) {
        if (json.t === "s") {
            var points = json.d[5];
            var passedTestCount = json.d[7];
            var judgedTestCount = json.d[8];
            var verdict = preparedVerdictFormats[json.d[12]];
            var verdictPrototypeDiv = $(".verdictPrototypeDiv");
            verdictPrototypeDiv.html(verdict);
            if (judgedTestCount != null && judgedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-judged").text(judgedTestCount);
            }
            if (passedTestCount != null && passedTestCount != undefined) {
                verdictPrototypeDiv.find(".verdict-format-passed").text(passedTestCount);
            }
            if (points != null && points != undefined) {
                verdictPrototypeDiv.find(".verdict-format-points").text(points);
            }
            Codeforces.showMessage(verdictPrototypeDiv.text());
        }
    }

    $(".clickable-title").each(function() {
        var title = $(this).attr("data-title");
        if (title) {
            var tmp = document.createElement("DIV");
            tmp.innerHTML = title;
            $(this).attr("title", tmp.textContent || tmp.innerText || "");
        }
    });

    $(".clickable-title").click(function() {
        const title = $(this).attr("data-title");
        const clazz = $(this).attr("data-clazz");
        const props = {};
        if (typeof (clazz) !== 'undefined') {
            props['clazz'] = clazz;
        }
        if (title) {
            Codeforces.alert(title, null, null, props);
        } else {
            Codeforces.alert($(this).attr("title"), null, null, props);
        }
    }).css("position", "relative").css("bottom", "3px");

        Codeforces.showDelayedMessage();

    Codeforces.reformatTimes();

    //Codeforces.initializePubSub();
    if (window.codeforcesOptions.subscribeServerUrl) {
        window.eventCatcher = new EventCatcher(
            window.codeforcesOptions.subscribeServerUrl,
            [
                Codeforces.getGlobalChannel(),
                Codeforces.getUserChannel(),
                Codeforces.getUserShowMessageChannel(),
                Codeforces.getContestChannel(),
                Codeforces.getParticipantChannel(),
                Codeforces.getTalkChannel()
            ]
        );

        if (Codeforces.getParticipantChannel()) {
            window.eventCatcher.subscribe(Codeforces.getParticipantChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getContestChannel()) {
            window.eventCatcher.subscribe(Codeforces.getContestChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getGlobalChannel()) {
            window.eventCatcher.subscribe(Codeforces.getGlobalChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserChannel(), function(json) {
                showAnnouncements(json);
            });
        }

        if (Codeforces.getUserShowMessageChannel()) {
            window.eventCatcher.subscribe(Codeforces.getUserShowMessageChannel(), function(json) {
                showEventCatcherUserMessage(json);
            });
        }
    }

    Codeforces.setupContestTimes("/data/contests");
    Codeforces.setupSpoilers();
    Codeforces.setupTutorials("/data/problemTutorial");
        });
    </script>


<div id="body">
        

<div class="side-bell" style="visibility: hidden; display: none; opacity: 0.7; width: 40px; position: fixed; right: 0; top: 0; cursor: pointer; text-align: center; line-height: 35px; color: #d3dbe4; font-weight: bold; font-size: 1.5rem;">
    <span class="icon-stack" style="width: 100%;">
        <i class="icon-circle icon-stack-base"></i>
        <i class="icon-bell-alt icon-light"></i>
    </span>
    <br>
    <span class="side-bell__count" style="position: relative; top: -10px;"></span>
</div>


<div id="header" style="position: relative;">

    <div style="float:left; max-height: 60px;">
                            <a href="/"><img height="65" style="height: 65px;" alt="Codeforces" title="Codeforces" src="//codeforces.com/codeforces.org/s/52448/images/codeforces-sponsored-by-ton.png"></a>
    </div>
    <div class="lang-chooser">
            <div style="text-align: right;">
                <a href="?locale=en"><img src="//codeforces.com/codeforces.org/s/52448/images/flags/24/gb.png" title="In English" alt="In English"></a>
                <a href="?locale=ru"><img src="//codeforces.com/codeforces.org/s/52448/images/flags/24/ru.png" title="По-русски" alt="По-русски"></a>
            </div>

        <div>
                        <a href="/enter?back=%2Fblog%2Fentry%2F148452">Enter</a>
                     | 
                        <a href="/register">Register</a>
                    
        </div>

    </div>
    <br style="clear: both;">
</div>

        


    <div class="roundbox menu-box borderTopRound borderBottomRound" style="">
    <div class="menu-list-container">
    <ul class="menu-list main-menu-list">
                <li class=""><a href="/">Home</a></li>
                <li class=""><a href="/top">Top</a></li>
                <li class=""><a href="/catalog">Catalog</a></li>
                <li class=""><a href="/contests">Contests</a></li>
                <li class=""><a href="/gyms">Gym</a></li>
                <li class=""><a href="/problemset">Problemset</a></li>
                <li class=""><a href="/groups">Groups</a></li>
                <li class=""><a href="/ratings">Rating</a></li>
                <li class=""><a href="/edu/courses"><span class="edu-menu-item">Edu</span></a></li>
                <li class=""><a href="/apiHelp">API</a></li>
                <li class=""><a href="/calendar">Calendar</a></li>
                <li class=""><a href="/help">Help</a></li>
    </ul>
        <form method="post" action="/search"><input type="hidden" name="csrf_token" value="ec60a538c257e1eefc500c98d4a47a17">
            <input class="search" name="query" data-isplaceholder="true" value="">
        <input type="hidden" name="_tta" value="863"></form>
    <br style="clear: both;">
</div>

    </div>

    <script type="text/javascript">
        $(document).ready(function () {
            $("input.search").focus(function () {
                if ($(this).attr("data-isPlaceholder") === "true") {
                    $(this).val("");
                    $(this).removeAttr("data-isPlaceholder");
                }
            });
        });
    </script>
        
            <br style="height: 3em; clear: both;">

        <div style="position: relative;">
                        <div id="sidebar">

    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Pay attention
            <div class="top-links">
            </div>
        </div>
<div style="padding: 0.5em;">
        <div style="text-align:center;">
            <span class="contest-state-phase">Before contest</span><br><a href="/contests/2181">2025-2026 ICPC, NERC, Northern Eurasia Finals (Unrated, Online Mirror, ICPC Rules, Teams Preferred)</a><br><span class="countdown" home="//codeforces.com/codeforces.org/s/52448" noredirection="true" textbeforeredirect="" cdid="i1"><span title="68:51:42">3 days</span></span><br><a href="/contestRegistration/2181">Register now »</a>
        </div>
</div>
    </div>

<style data-nocturne="true" type="text/css">
._StreamsSidebarFrame_frame {
  padding: 0.5em 0.5em 0 0.5em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream {
  text-align: center;
  border-bottom: 1px solid #b9b9b9;
  margin: 0 -0.5em 0.5em -0.5em;
  padding: 0 1em 0.5em 1em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream ._StreamsSidebarFrame_user {
  margin: 0 0 0.5em 0;
  font-size: 0.8em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream ._StreamsSidebarFrame_timeMark {
  color: #777;
  font-size: 0.9em;
}
._StreamsSidebarFrame_frame ._StreamsSidebarFrame_stream:last-of-type {
  border-bottom: unset;
  margin: unset;
  padding: 0 0.5em 0.5em 1em;
}
._StreamsSidebarFrame_frame ._viewAll {
  text-align: right;
}
.moreRunningStreamsSidebarNote {
  color: #777 !important;
  text-decoration: none;
}
</style>




    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Streams
            <div class="top-links">
            </div>
        </div>
            <div class="_StreamsSidebarFrame_frame">
                    <div class="_StreamsSidebarFrame_stream">
                        <div class="_StreamsSidebarFrame_name">
        <p class="_englishName _name">
            
            <a href="/stream/865">Repovive Opening Contest — Solution Discussion</a>
        </p>

                        </div>

                        <div class="_StreamsSidebarFrame_user">
                            By <a href="/profile/Shayan" title="International Grandmaster Shayan" class="rated-user user-red">Shayan</a>
                        </div>

                            <div class="_StreamsSidebarFrame_countdown _StreamsSidebarFrame_timeMark">
                                Before stream
                                <span class="countdown" noredirection="true" cdid="i2">06:26:41</span>
                            </div>
                    </div>
            </div>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="/streams">View all →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>

<script data-nocturne="true"> $(function () {

}); </script>


<div class="roundbox sidebox top-contributed borderTopRound " style="">
<div class="caption titled">→ Top rated
<div class="top-links">
</div>
</div>
<table class="rtable ">
<tbody>
<tr>
<th class="left" style="width:2.25em;">#</th>
<th class="">User</th>
<th class="" style="width:5em;">Rating</th>
</tr>
<tr>
<td class="left dark">1</td>
<td class=" dark"><a href="/profile/Kevin114514" title="Legendary Grandmaster Kevin114514" class="rated-user user-legendary"><span class="legendary-user-first-letter">K</span>evin114514</a></td>
<td class=" dark">3765</td>
</tr>
<tr>
<td class="left ">2</td>
<td class=""><a href="/profile/tourist" title="Legendary Grandmaster tourist" class="rated-user user-legendary"><span class="legendary-user-first-letter">t</span>ourist</a></td>
<td class="">3757</td>
</tr>
<tr>
<td class="left dark">3</td>
<td class=" dark"><a href="/profile/Benq" title="Legendary Grandmaster Benq" class="rated-user user-legendary"><span class="legendary-user-first-letter">B</span>enq</a></td>
<td class=" dark">3738</td>
</tr>
<tr>
<td class="left ">4</td>
<td class=""><a href="/profile/jiangly" title="Legendary Grandmaster jiangly" class="rated-user user-legendary"><span class="legendary-user-first-letter">j</span>iangly</a></td>
<td class="">3705</td>
</tr>
<tr>
<td class="left dark">5</td>
<td class=" dark"><a href="/profile/orzdevinwang" title="Legendary Grandmaster orzdevinwang" class="rated-user user-legendary"><span class="legendary-user-first-letter">o</span>rzdevinwang</a></td>
<td class=" dark">3670</td>
</tr>
<tr>
<td class="left ">6</td>
<td class=""><a href="/profile/ksun48" title="Legendary Grandmaster ksun48" class="rated-user user-legendary"><span class="legendary-user-first-letter">k</span>sun48</a></td>
<td class="">3668</td>
</tr>
<tr>
<td class="left dark">7</td>
<td class=" dark"><a href="/profile/Radewoosh" title="Legendary Grandmaster Radewoosh" class="rated-user user-legendary"><span class="legendary-user-first-letter">R</span>adewoosh</a></td>
<td class=" dark">3531</td>
</tr>
<tr>
<td class="left ">8</td>
<td class=""><a href="/profile/maroonrk" title="Legendary Grandmaster maroonrk" class="rated-user user-legendary"><span class="legendary-user-first-letter">m</span>aroonrk</a></td>
<td class="">3443</td>
</tr>
<tr>
<td class="left dark">9</td>
<td class=" dark"><a href="/profile/dXqwq" title="Legendary Grandmaster dXqwq" class="rated-user user-legendary"><span class="legendary-user-first-letter">d</span>Xqwq</a></td>
<td class=" dark">3436</td>
</tr>
<tr>
<td class="left bottom">10</td>
<td class="bottom"><a href="/profile/Nachia" title="Legendary Grandmaster Nachia" class="rated-user user-legendary"><span class="legendary-user-first-letter">N</span>achia</a></td>
<td class="bottom">3432</td>
</tr>
</tbody>
</table>
<div class="bottom-links">
<table style="width:100%;">
<tbody>
<tr>
<td style="text-align:left;">
<a href="/ratings/countries">Countries</a> |
<a href="/ratings/cities">Cities</a> |
<a href="/ratings/organizations">Organizations</a>
</td>
<td style="text-align:right;">
<a href="/ratings">View all →</a>
</td>
</tr>
</tbody>
</table>
</div>
</div>


    <div class="roundbox sidebox top-contributed borderTopRound " style="">
        <div class="caption titled">→ Top contributors
            <div class="top-links">
            </div>
        </div>
        <table class="rtable ">
            <tbody>
                <tr>
                            <th class="left" style="width:2.25em;">#</th>
                            <th class="">User</th>
                            <th class="" style="width:5em;">Contrib.</th>
                </tr>
                    <tr>
                                <td class="left  dark">1</td>
                                <td class=" dark"><a href="/profile/Um_nik" title="Legendary Grandmaster Um_nik" class="rated-user user-legendary"><span class="legendary-user-first-letter">U</span>m_nik</a></td>
                                <td class=" dark">169</td>
                    </tr>
                    <tr>
                                <td class="left ">2</td>
                                <td class=""><a href="/profile/Qingyu" title="Legendary Grandmaster Qingyu" class="rated-user user-legendary"><span class="legendary-user-first-letter">Q</span>ingyu</a></td>
                                <td class="">166</td>
                    </tr>
                    <tr>
                                <td class="left  dark">3</td>
                                <td class=" dark"><a href="/profile/errorgorn" title="Legendary Grandmaster errorgorn" class="rated-user user-legendary"><span class="legendary-user-first-letter">e</span>rrorgorn</a></td>
                                <td class=" dark">163</td>
                    </tr>
                    <tr>
                                <td class="left ">4</td>
                                <td class=""><a href="/profile/adamant" title="Master adamant" class="rated-user user-orange">adamant</a></td>
                                <td class="">156</td>
                    </tr>
                    <tr>
                                <td class="left  dark">5</td>
                                <td class=" dark"><a href="/profile/Proof_by_QED" title="Master Proof_by_QED" class="rated-user user-orange">Proof_by_QED</a></td>
                                <td class=" dark">152</td>
                    </tr>
                    <tr>
                                <td class="left ">6</td>
                                <td class=""><a href="/profile/Dominater069" title="Legendary Grandmaster Dominater069" class="rated-user user-legendary"><span class="legendary-user-first-letter">D</span>ominater069</a></td>
                                <td class="">150</td>
                    </tr>
                    <tr>
                                <td class="left  dark">7</td>
                                <td class=" dark"><a href="/profile/cry" title="International Master cry" class="rated-user user-orange">cry</a></td>
                                <td class=" dark">149</td>
                    </tr>
                    <tr>
                                <td class="left ">8</td>
                                <td class=""><a href="/profile/TheScrasse" title="Grandmaster TheScrasse" class="rated-user user-red">TheScrasse</a></td>
                                <td class="">144</td>
                    </tr>
                    <tr>
                                <td class="left  dark">9</td>
                                <td class=" dark"><a href="/profile/soullless" title="Master soullless" class="rated-user user-orange">soullless</a></td>
                                <td class=" dark">143</td>
                    </tr>
                    <tr>
                                <td class="left bottom">10</td>
                                <td class="bottom"><a href="/profile/Arpa" title="International Master Arpa" class="rated-user user-orange">Arpa</a></td>
                                <td class="bottom">141</td>
                    </tr>
            </tbody>
        </table>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="/top-contributed">View all →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>

    <script type="text/javascript">
        $(document).ready(function () {
        });
    </script>




    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Find user
            <div class="top-links">
            </div>
        </div>
        <form class="handleForm" method="post" autocomplete="off"><input type="hidden" name="csrf_token" value="ec60a538c257e1eefc500c98d4a47a17">
            <div style="padding:1em;text-align:right;">
                <label style="padding-right:1em;">Handle:
                    <input style="width:12em;" type="text" class="handleBox ac_input" autocomplete="off">
                </label>
            </div>
            <div style="padding: 0 1em 1em 1em;text-align:right;">
                <input style="height:1.65em;padding:0 0.75em;" type="submit" value="Find">
            </div>
        <input type="hidden" name="_tta" value="863"></form>
    </div>
    <script type="text/javascript">
        $(document).ready(function () {
    $(".handleBox").autocompleteHandle();
    $(".handleForm").attr("autocomplete", "off").submit(function () {
        var link = "/profile/userHandle".replace(
            "userHandle", $(this).find(".handleBox").val()
        );
        window.location = link;
        return false;
    });
        });
    </script>





    <div class="roundbox sidebox borderTopRound " style="">
        <div class="caption titled">→ Recent actions
            <div class="top-links">
            </div>
        </div>
        <div class="recent-actions">
            <ul>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/atcoder_official" title="Unrated, atcoder_official" class="rated-user user-black">atcoder_official</a>        →
        <a href="/blog/entry/149183">AtCoder Beginner Contest 436 Announcement</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/SecondThread" title="Grandmaster SecondThread" class="rated-user user-red">SecondThread</a>        →
        <a href="/blog/entry/147893">Hacker Cup Round 1 Recap</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/MathModel" title="Expert MathModel" class="rated-user user-blue">MathModel</a>        →
        <a href="/blog/entry/149013">Invitation to Eolymp Blitz #8 (Rating Upto 1750)</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Coxin_Hor" title="Expert Coxin_Hor" class="rated-user user-blue">Coxin_Hor</a>        →
        <a href="/blog/entry/149220">A fun contest I created myself.</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/saPaul" title="Pupil saPaul" class="rated-user user-green">saPaul</a>        →
        <a href="/blog/entry/149221">[Update] CF FetchCodes v25.12.7: Smart Retries, Lazy Loading &amp; Instant Caching!</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/ABalobanov" title="Expert ABalobanov" class="rated-user user-blue">ABalobanov</a>        →
        <a href="/blog/entry/149154">Codeforces Round 1070 (Div.2) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/adamant" title="Master adamant" class="rated-user user-orange">adamant</a>        →
        <a href="/blog/entry/149218">Finding all primes up to half a billion in 83 ms</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/awoo" title="Grandmaster awoo" class="rated-user user-red">awoo</a>        →
        <a href="/blog/entry/117791">Educational Codeforces Round 151 Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
        <img alt="Necropost" title="Necropost" src="//codeforces.com/codeforces.org/s/52448/images/icons/hourglass.png" style="vertical-align:middle; position: relative; top: 1px;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/alireza_kaviani" title="International Grandmaster alireza_kaviani" class="rated-user user-red">alireza_kaviani</a>        →
        <a href="/blog/entry/148411">Repovive Opening Contest</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/flamestorm" title="International Master flamestorm" class="rated-user user-orange">flamestorm</a>        →
        <a href="/blog/entry/104310">Codeforces Round #803 (Div. 2) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
        <img alt="Necropost" title="Necropost" src="//codeforces.com/codeforces.org/s/52448/images/icons/hourglass.png" style="vertical-align:middle; position: relative; top: 1px;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/SilverTongue1729" title="Candidate Master SilverTongue1729" class="rated-user user-violet">SilverTongue1729</a>        →
        <a href="/blog/entry/149213">Codeforces Profile Preview — Chrome Extension</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Xiaohuba" title="Master Xiaohuba" class="rated-user user-orange">Xiaohuba</a>        →
        <a href="/blog/entry/148062">Codeforces Global Round 30</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Ashwanth.K" title="Master Ashwanth.K" class="rated-user user-orange">Ashwanth.K</a>        →
        <a href="/blog/entry/149201">SOS DP easy understanding</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/BreakingNut" title="Specialist BreakingNut" class="rated-user user-cyan">BreakingNut</a>        →
        <a href="/blog/entry/149177">Solved the Problem, Lost the Girlfriend</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/ProblemTerminator" title="International Master ProblemTerminator" class="rated-user user-orange">ProblemTerminator</a>        →
        <a href="/blog/entry/149005">pls ban cheater sinha_yash and rollback the rating</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/cry" title="International Master cry" class="rated-user user-orange">cry</a>        →
        <a href="/blog/entry/137325">GIFs in Problem Statements are Broken</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Um_nik" title="Legendary Grandmaster Um_nik" class="rated-user user-legendary"><span class="legendary-user-first-letter">U</span>m_nik</a>        →
        <a href="/blog/entry/146705">On AI ruining "solving math problems with computer" [a year later]</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/m_manasc" title="Pupil m_manasc" class="rated-user user-green">m_manasc</a>        →
        <a href="/blog/entry/149219">An interesting problem</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="//codeforces.com/codeforces.org/s/52448/images/icons/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/SecondThread" title="Grandmaster SecondThread" class="rated-user user-red">SecondThread</a>        →
        <a href="/blog/entry/148802">Meta Hacker Cup Round 3</a>
&nbsp;&nbsp;<img alt="Text created or updated" title="Text created or updated" src="//codeforces.com/codeforces.org/s/52448/images/icons/x-update-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Top12" title="Expert Top12" class="rated-user user-blue">Top12</a>        →
        <a href="/blog/entry/149216">From TLE to AC using magic!</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/TheScrasse" title="Grandmaster TheScrasse" class="rated-user user-red">TheScrasse</a>        →
        <a href="/blog/entry/148631">Codeforces Round 1066 (Div. 1 + Div. 2) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/MohamedAboOkail" title="Specialist MohamedAboOkail" class="rated-user user-cyan">MohamedAboOkail</a>        →
        <a href="/blog/entry/149116">Removing the cheaters</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/ibrm" title="Candidate Master ibrm" class="rated-user user-violet">ibrm</a>        →
        <a href="/blog/entry/147532">Bots?</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/Shisuko" title="Master Shisuko" class="rated-user user-orange">Shisuko</a>        →
        <a href="/blog/entry/149199">2025 ICPC Asia Manila Regional (Gym) Editorial</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
                        <li><div style="font-size:0.9em;padding:0.5em 0;">
<a href="/profile/amankbps" title="Specialist amankbps" class="rated-user user-cyan">amankbps</a>        →
        <a href="/blog/entry/142846">sliding window or(CSES)</a>
&nbsp;&nbsp;<img alt="New comment(s)" title="New comment(s)" src="//codeforces.com/codeforces.org/s/52448/images/icons/comment-12x12.png" style="vertical-align:middle;">
</div>
</li>
            </ul>
        </div>
            <div class="bottom-links">
                <table style="width:100%;">
                    <tbody>
                        <tr>
                            <td style="text-align:left;">
                            </td>
                            <td style="text-align:right;">
                                    <a href="/recent-actions">Detailed →</a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
    </div>
</div>
                        <div id="pageContent" class="content-with-sidebar">
                    <div class="second-level-menu">
<ul class="second-level-menu-list"><li class="backLava" style="position: absolute; display: block; margin: 0px; padding: 0px; left: 54.2969px; top: 0px; width: 39px; height: 20px;"><div class="leftLava"></div><div class="bottomLava"></div><div class="cornerLava"></div></li>
        <li><a href="/profile/Flamire">Flamire</a></li>
        <li class="current selectedLava"><a href="/blog/Flamire">Blog</a></li>
        <li><a href="/teams/with/Flamire">Teams</a></li>
        <li><a href="/submissions/Flamire">Submissions</a></li>
        <li><a href="/groups/with/Flamire">Groups</a></li>
        <li><a href="/contests/with/Flamire">Contests</a></li>
        <li><a href="/contests/writer/Flamire">Problemsetting</a></li>
</ul>
</div>
    <div style="margin-top:0;">
    <div>
        <h3><a href="/blog/Flamire" style="text-decoration:none;color:black !important;">Flamire's blog</a></h3>
    </div>
        <div style="margin-top:2em;">


<div class="has-topic-id topic" topicid="149093">
    <div class="title">
            <a href="/blog/entry/148452">            <p>Codeforces Round 1064 (Div. 1, Div. 2) Editorial</p>
</a>
    </div>

        <div class="info" style="position:relative;">
                By&nbsp;<a href="/profile/Flamire" title="Legendary Grandmaster Flamire" class="rated-user user-legendary"><span class="legendary-user-first-letter">F</span>lamire</a>,
                    <a href="/topic/149093/en7">history</a>,
                    <span class="format-humantime" title="Nov/17/2025 09:12 UTC">4 weeks ago</span>,
                
                <img style="position: relative;top: 5px;" src="//codeforces.com/codeforces.org/s/52448/images/flags/24/gb.png" alt="In English" title="In English">



            <div class="topic-actions smaller">
                <ul>


                </ul>
            </div>
        </div>

    <div class="content">
        <div class="ttypography"><p><a href="https://codeforces.com/contest/2166/problem/A">2166A — Same Difference</a></p><p>idea &amp; solution: <a class="rated-user user-legendary" href="/profile/le0n" title="Legendary Grandmaster le0n"><span class="legendary-user-first-letter">l</span>e0n</a></p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: none;"><p>It can be observed that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 1.301em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.98em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="msubsup" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-4" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-5" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mi>n</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-1">s_n</script> will not change throughout the operations, therefore, for the final string to have every character the same, every character must be equal to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6" style="width: 1.301em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.98em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-7"><span class="msubsup" id="MathJax-Span-8"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-10" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mi>n</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-2">s_n</script>.</p><p>To change every character to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-11" style="width: 1.301em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.98em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-12"><span class="msubsup" id="MathJax-Span-13"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-14" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-15" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mi>n</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-3">s_n</script>, we can iterate over all characters from right to left, repeatedly setting <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2190;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-16" style="width: 5.36em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.061em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1004.06em, 2.546em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-17"><span class="msubsup" id="MathJax-Span-18"><span style="display: inline-block; position: relative; width: 1.68em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-19" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="texatom" id="MathJax-Span-20"><span class="mrow" id="MathJax-Span-21"><span class="mi" id="MathJax-Span-22" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-23" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-24" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-25" style="font-family: MathJax_Main; padding-left: 0.273em;">←</span><span class="msubsup" id="MathJax-Span-26" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 0.814em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-27" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-28" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="false">←</mo><msub><mi>s</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-4">s_{i-1}\leftarrow s_i</script> if <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-29" style="width: 5.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.007em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1004.01em, 2.546em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-30"><span class="msubsup" id="MathJax-Span-31"><span style="display: inline-block; position: relative; width: 1.68em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-32" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="texatom" id="MathJax-Span-33"><span class="mrow" id="MathJax-Span-34"><span class="mi" id="MathJax-Span-35" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-36" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-37" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-38" style="font-family: MathJax_Main; padding-left: 0.273em;">≠</span><span class="msubsup" id="MathJax-Span-39" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-40" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-41" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.361em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>≠</mo><msub><mi>s</mi><mi>n</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-5">s_{i-1}\neq s_n</script>. Through this, we can need one operation for every character not equal to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-42" style="width: 1.301em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.98em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-43"><span class="msubsup" id="MathJax-Span-44"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.44em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-45" style="font-family: MathJax_Math-italic;">s</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="mi" id="MathJax-Span-46" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mi>n</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-6">s_n</script>, which is also obvious as a lower bound.</p><p>Time complexity: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-47" style="width: 2.871em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.167em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1002.06em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-48"><span class="mi" id="MathJax-Span-49" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-50" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-51" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-52" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-7">O(n)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">

</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">char</span><span class="pln"> s</span><span class="pun">[</span><span class="lit">100005</span><span class="pun">];</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> t</span><span class="pun">,</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">t</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%s"</span><span class="pun">,</span><span class="pln"> s </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		m </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
			m </span><span class="pun">+=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> s</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]);</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2166/problem/B">2166B — Tab Closing</a></p><p>idea &amp; solution: <a class="rated-user user-legendary" href="/profile/le0n" title="Legendary Grandmaster le0n"><span class="legendary-user-first-letter">l</span>e0n</a></p><p>The problem statement arised naturally from closing tabs in any modern browser.</p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: none;"><p>After some experimenting, it can be seen that the answer does not exceed <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-53" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-54"><span class="mn" id="MathJax-Span-55" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-8">2</script>. Simply click at <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-56" style="width: 0.76em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-57"><span class="mi" id="MathJax-Span-58" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">a</script> as long as there's still a tab at that point. After that, each tab must have length of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-59" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-60"><span class="mi" id="MathJax-Span-61" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">b</script>, move the cursor to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-62" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-63"><span class="mi" id="MathJax-Span-64" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">b</script>, and click until all tabs have been closed.</p><p>Now it remains to be seen under what scenarios we can achieve <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-65" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-66"><span class="mn" id="MathJax-Span-67" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-12">1</script> move. Since the last tab closed will have length <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-68" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-69"><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">b</script>, our cursor should be moved to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-71" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-72"><span class="mi" id="MathJax-Span-73" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">b</script>. Therefore, the answer will be <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-74" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-75"><span class="mn" id="MathJax-Span-76" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-15">1</script> when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-77" style="width: 3.791em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.871em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1002.87em, 2.492em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-78"><span class="mi" id="MathJax-Span-79" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-80" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-81" style="font-family: MathJax_Main; padding-left: 0.273em;">≤</span><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">a</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mi>b</mi><mo>≤</mo><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">nb\le a</script>, or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-83" style="width: 3.033em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.275em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1002.27em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-84"><span class="mi" id="MathJax-Span-85" style="font-family: MathJax_Math-italic;">b</span><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-87" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">a</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi><mo>=</mo><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-17">b=a</script>, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-88" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-89"><span class="mn" id="MathJax-Span-90" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-18">2</script> otherwise.</p><p>Remember to use long long if using multiplication to calculate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-91" style="width: 1.356em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1001.03em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-92"><span class="mi" id="MathJax-Span-93" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-94" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">nb</script>.</p><p>Time Complexity: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-95" style="width: 2.708em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.059em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1001.95em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-96"><span class="mi" id="MathJax-Span-97" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-98" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-99" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-100" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-20">O(1)</script> per test case.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">

</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">,</span><span class="pln"> b</span><span class="pun">;</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">t</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%d%d%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">a</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">b</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
		printf</span><span class="pun">(((</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">)</span><span class="pln">b </span><span class="pun">*</span><span class="pln"> n </span><span class="pun">&lt;=</span><span class="pln"> a </span><span class="pun">||</span><span class="pln"> b </span><span class="pun">&gt;=</span><span class="pln"> a</span><span class="pun">)</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> </span><span class="str">"1\n"</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">"2\n"</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2165/problem/A">2165A — Cyclic Merging</a></p><p>idea &amp; solution: <a class="rated-user user-legendary" href="/profile/le0n" title="Legendary Grandmaster le0n"><span class="legendary-user-first-letter">l</span>e0n</a></p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: none;"><p>We consider a simple strategy: repeatedly merge the smallest element onto the smaller of its two neighbours.</p><p>We will prove this greedy is correct: For any merge sequence, consider the smallest element <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-101" style="width: 1.951em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1001.46em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-102"><span class="mi" id="MathJax-Span-103" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-104" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-21">mn</script>, it must be merged into a larger element at some point in the future. However, its neighbour will not be smaller, which means that we can simply modify the merge sequence to merge <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-105" style="width: 1.951em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.464em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1001.46em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-106"><span class="mi" id="MathJax-Span-107" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-108" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">mn</script> into its neighbours at the very first.</p><p>Further observation will show that this value is equal to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-109" style="width: 31.821em; display: inline-block;"><span style="display: inline-block; position: relative; width: 24.083em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.031em, 1023.98em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-110"><span class="munderover" id="MathJax-Span-111"><span style="display: inline-block; position: relative; width: 2.438em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1000.98em, 4.44em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.41em, 4.223em, -999.997em); top: -4.489em; left: 1.085em;"><span class="texatom" id="MathJax-Span-113"><span class="mrow" id="MathJax-Span-114"><span class="mi" id="MathJax-Span-115" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-116" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-117" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.25em, 4.169em, -999.997em); top: -3.731em; left: 1.085em;"><span class="texatom" id="MathJax-Span-118"><span class="mrow" id="MathJax-Span-119"><span class="mi" id="MathJax-Span-120" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-121" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-122" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-123" style="font-family: MathJax_Main; padding-left: 0.165em;">max</span><span class="mo" id="MathJax-Span-124" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-125"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-126" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-127" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-128" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-129" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.734em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-130" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="texatom" id="MathJax-Span-131"><span class="mrow" id="MathJax-Span-132"><span class="mi" id="MathJax-Span-133" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-134" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-135" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-136" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-137" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mo" id="MathJax-Span-138" style="font-family: MathJax_Main; padding-left: 0.219em;">max</span><span class="mo" id="MathJax-Span-139" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-140"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-141" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-142" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-143" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-144" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-145" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mn" id="MathJax-Span-146" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-148" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mo" id="MathJax-Span-149" style="font-family: MathJax_Main; padding-left: 0.219em;">max</span><span class="mo" id="MathJax-Span-150" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-151"><span class="mrow" id="MathJax-Span-152"><span class="msubsup" id="MathJax-Span-153"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-154" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mn" id="MathJax-Span-155" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-156" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-157" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-158" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mn" id="MathJax-Span-159" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-160" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-161" style="font-family: MathJax_Main; padding-left: 0.165em;">⋯</span><span class="mo" id="MathJax-Span-162" style="font-family: MathJax_Main; padding-left: 0.165em;">,</span><span class="msubsup" id="MathJax-Span-163" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-164" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-165" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-166" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.789em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></munderover><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>+</mo><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mi>n</mi></msub><mo>,</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>−</mo><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi>a</mi><mn>1</mn></msub><mo>,</mo><msub><mi>a</mi><mn>2</mn></msub><mo>,</mo><mo>⋯</mo><mo>,</mo><msub><mi>a</mi><mi>n</mi></msub></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-23">\sum_{i=1}^{n-1}\max(a_i,a_{i+1})+\max(a_n,a_1)-\max({a_1,a_2,\cdots,a_n})</script>. A brief sketch of the proof is as follows: It can be shown that we can break the ring into a sequence at an arbitrary maxima, since the maxima will not be merged into others.</p><p>For the problem on a sequence, consider each element <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-167" style="width: 1.139em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.87em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-168"><span class="msubsup" id="MathJax-Span-169"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-170" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-171" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-24">a_i</script>, find the closest element <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-172" style="width: 1.356em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1001.03em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-173"><span class="msubsup" id="MathJax-Span-174"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-175" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-176" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>x</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-25">a_x</script> to the left of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-177" style="width: 1.139em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.87em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-178"><span class="msubsup" id="MathJax-Span-179"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-180" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-181" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-26">a_i</script>, such that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-182" style="width: 4.332em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.249em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.464em, 1003.25em, 2.492em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-183"><span class="msubsup" id="MathJax-Span-184"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-185" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-186" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-187" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="msubsup" id="MathJax-Span-188" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-189" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-190" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>x</mi></msub><mo>&gt;</mo><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-27">a_x>a_i</script> (when equal, break ties according to index). If there are elements between <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-191" style="width: 1.356em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1001.03em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-192"><span class="msubsup" id="MathJax-Span-193"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-194" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-195" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>x</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-28">a_x</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-196" style="width: 1.139em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.87em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-197"><span class="msubsup" id="MathJax-Span-198"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-199" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-200" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-29">a_i</script>, then it's clear that in performing the aforementioned greedy, at some point we will merge everything in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-201" style="width: 9.689em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.308em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.572em, 1007.31em, 2.546em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-202"><span class="msubsup" id="MathJax-Span-203"><span style="display: inline-block; position: relative; width: 1.897em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-204" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="texatom" id="MathJax-Span-205"><span class="mrow" id="MathJax-Span-206"><span class="mi" id="MathJax-Span-207" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-208" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-209" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-210" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-211" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.897em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-212" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="texatom" id="MathJax-Span-213"><span class="mrow" id="MathJax-Span-214"><span class="mi" id="MathJax-Span-215" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-216" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-217" style="font-size: 70.7%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-218" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-219" style="font-family: MathJax_Main; padding-left: 0.165em;">⋯</span><span class="mo" id="MathJax-Span-220" style="font-family: MathJax_Main; padding-left: 0.165em;">,</span><span class="msubsup" id="MathJax-Span-221" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-222" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-223" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>+</mo><mn>2</mn></mrow></msub><mo>,</mo><mo>⋯</mo><mo>,</mo><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-30">a_{x+1},a_{x+2},\cdots,a_i</script> into a single element, and then merge it into <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-224" style="width: 1.139em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.87em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-225"><span class="msubsup" id="MathJax-Span-226"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-227" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-228" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-31">a_i</script>. Therefore the answer will be increased by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-229" style="width: 1.139em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.87em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-230"><span class="msubsup" id="MathJax-Span-231"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-232" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-233" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-32">a_i</script> if <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-234" style="width: 5.252em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.953em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.464em, 1003.95em, 2.546em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-235"><span class="msubsup" id="MathJax-Span-236"><span style="display: inline-block; position: relative; width: 1.734em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-237" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="texatom" id="MathJax-Span-238"><span class="mrow" id="MathJax-Span-239"><span class="mi" id="MathJax-Span-240" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-241" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-242" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-243" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="msubsup" id="MathJax-Span-244" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-245" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-246" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>&lt;</mo><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-33">a_{i-1}<a_i</script>. The same thing will happen to the right of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-247" style="width: 1.139em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.87em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-248"><span class="msubsup" id="MathJax-Span-249"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-250" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-251" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-34">a_i</script>. Therefore the answer is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-252" style="width: 20.078em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.208em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.031em, 1015.21em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-253"><span class="munderover" id="MathJax-Span-254"><span style="display: inline-block; position: relative; width: 2.438em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1000.98em, 4.44em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-255" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.41em, 4.223em, -999.997em); top: -4.489em; left: 1.085em;"><span class="texatom" id="MathJax-Span-256"><span class="mrow" id="MathJax-Span-257"><span class="mi" id="MathJax-Span-258" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-259" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-260" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.25em, 4.169em, -999.997em); top: -3.731em; left: 1.085em;"><span class="texatom" id="MathJax-Span-261"><span class="mrow" id="MathJax-Span-262"><span class="mi" id="MathJax-Span-263" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-264" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-265" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-266" style="font-family: MathJax_Main;">[</span><span class="msubsup" id="MathJax-Span-267"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-268" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-269" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-270" style="font-family: MathJax_Main; padding-left: 0.273em;">≥</span><span class="msubsup" id="MathJax-Span-271" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 1.734em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-272" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="texatom" id="MathJax-Span-273"><span class="mrow" id="MathJax-Span-274"><span class="mi" id="MathJax-Span-275" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-276" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-277" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-278" style="font-family: MathJax_Main;">]</span><span class="msubsup" id="MathJax-Span-279"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-280" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-281" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-282" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mo" id="MathJax-Span-283" style="font-family: MathJax_Main; padding-left: 0.219em;">[</span><span class="msubsup" id="MathJax-Span-284"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-285" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-286" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-287" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="msubsup" id="MathJax-Span-288" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 1.734em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-289" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="texatom" id="MathJax-Span-290"><span class="mrow" id="MathJax-Span-291"><span class="mi" id="MathJax-Span-292" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-293" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-294" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-295" style="font-family: MathJax_Main;">]</span><span class="msubsup" id="MathJax-Span-296"><span style="display: inline-block; position: relative; width: 1.734em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-297" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="texatom" id="MathJax-Span-298"><span class="mrow" id="MathJax-Span-299"><span class="mi" id="MathJax-Span-300" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-301" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-302" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.789em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></munderover><mo stretchy="false">[</mo><msub><mi>a</mi><mi>i</mi></msub><mo>≥</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">]</mo><msub><mi>a</mi><mi>i</mi></msub><mo>+</mo><mo stretchy="false">[</mo><msub><mi>a</mi><mi>i</mi></msub><mo>&lt;</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">]</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-35">\sum_{i=1}^{n-1}[a_i\ge a_{i+1}]a_i+[a_i<a_{i+1}]a_{i+1}</script>, which can be rephrased as <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-303" style="width: 10.933em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.282em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.031em, 1008.17em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-304"><span class="munderover" id="MathJax-Span-305"><span style="display: inline-block; position: relative; width: 2.438em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1000.98em, 4.44em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-306" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.41em, 4.223em, -999.997em); top: -4.489em; left: 1.085em;"><span class="texatom" id="MathJax-Span-307"><span class="mrow" id="MathJax-Span-308"><span class="mi" id="MathJax-Span-309" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-310" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-311" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1001.25em, 4.169em, -999.997em); top: -3.731em; left: 1.085em;"><span class="texatom" id="MathJax-Span-312"><span class="mrow" id="MathJax-Span-313"><span class="mi" id="MathJax-Span-314" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-315" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-316" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-317" style="font-family: MathJax_Main; padding-left: 0.165em;">max</span><span class="mo" id="MathJax-Span-318" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-319"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-320" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-321" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-322" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-323" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.734em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-324" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="texatom" id="MathJax-Span-325"><span class="mrow" id="MathJax-Span-326"><span class="mi" id="MathJax-Span-327" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-328" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-329" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-330" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.789em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mo>−</mo><mn>1</mn></mrow></munderover><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-36">\sum_{i=1}^{n-1}\max(a_i,a_{i+1})</script>, which in turn is the formula above.</p><p>However, this is not needed to pass the problem. We expected participants to pass using doubly linked lists, sets, or any other data structures which can support the operations needed.</p><p>Time Complexity: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-331" style="width: 2.871em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.167em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1002.06em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-332"><span class="mi" id="MathJax-Span-333" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-334" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-335" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-336" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-37">O(n)</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-337" style="width: 5.739em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.332em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1004.22em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-338"><span class="mi" id="MathJax-Span-339" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-340" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-341" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-342" style="font-family: MathJax_Main; padding-left: 0.165em;">log</span><span class="mo" id="MathJax-Span-343"></span><span class="mi" id="MathJax-Span-344" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">n</span><span class="mo" id="MathJax-Span-345" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-38">O(n\log n)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">

</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ll</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e6</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">5</span><span class="pun">;</span><span class="pln">
ll a</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> m</span><span class="pun">,</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
	ll k</span><span class="pun">;</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">t</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
		m </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			scanf</span><span class="pun">(</span><span class="str">"%lld"</span><span class="pun">,</span><span class="pln"> a </span><span class="pun">+</span><span class="pln"> i</span><span class="pun">);</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">m</span><span class="pun">])</span><span class="pln">
				m </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		a</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
		k </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="pln">a</span><span class="pun">[</span><span class="pln">m</span><span class="pun">];</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
			k </span><span class="pun">+=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"%lld\n"</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Solution (linked lists, by Arpa)</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">// In the name of Allah.</span><span class="pln">
 
</span><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
    cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="kwd">nullptr</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    cin </span><span class="pun">&gt;&gt;</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
    </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
        cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
        list</span><span class="str">&lt;int&gt;</span><span class="pln"> alive</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">n</span><span class="pun">];</span><span class="pln">
        list</span><span class="str">&lt;int&gt;</span><span class="pun">::</span><span class="pln">iterator w</span><span class="pun">[</span><span class="pln">n</span><span class="pun">];</span><span class="pln">
        </span><span class="kwd">auto</span><span class="pln"> c_next </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[&amp;</span><span class="pln">alive</span><span class="pun">](</span><span class="kwd">const</span><span class="pln"> list</span><span class="str">&lt;int&gt;</span><span class="pun">::</span><span class="pln">iterator</span><span class="pun">&amp;</span><span class="pln"> it</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">next</span><span class="pun">(</span><span class="pln">it</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> alive</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">()</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> alive</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">()</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="kwd">next</span><span class="pun">(</span><span class="pln">it</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">};</span><span class="pln">
        </span><span class="kwd">auto</span><span class="pln"> c_prev </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[&amp;</span><span class="pln">alive</span><span class="pun">](</span><span class="kwd">const</span><span class="pln"> list</span><span class="str">&lt;int&gt;</span><span class="pun">::</span><span class="pln">iterator</span><span class="pun">&amp;</span><span class="pln"> it</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> it </span><span class="pun">==</span><span class="pln"> alive</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">()</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> </span><span class="pun">--</span><span class="pln">alive</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">()</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> prev</span><span class="pun">(</span><span class="pln">it</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">};</span><span class="pln">
        </span><span class="kwd">auto</span><span class="pln"> hole </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[&amp;](</span><span class="kwd">const</span><span class="pln"> list</span><span class="str">&lt;int&gt;</span><span class="pun">::</span><span class="pln">iterator</span><span class="pun">&amp;</span><span class="pln"> it</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> a</span><span class="pun">[*</span><span class="pln">it</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[*</span><span class="pln">c_next</span><span class="pun">(</span><span class="pln">it</span><span class="pun">)],</span><span class="pln"> a</span><span class="pun">[*</span><span class="pln">c_prev</span><span class="pun">(</span><span class="pln">it</span><span class="pun">)]);</span><span class="pln">
        </span><span class="pun">};</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
            w</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> alive</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">(</span><span class="pln">alive</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">(),</span><span class="pln"> i</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        queue</span><span class="str">&lt;int&gt;</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> it </span><span class="pun">=</span><span class="pln"> alive</span><span class="pun">.</span><span class="kwd">begin</span><span class="pun">();</span><span class="pln"> it </span><span class="pun">!=</span><span class="pln"> alive</span><span class="pun">.</span><span class="kwd">end</span><span class="pun">();</span><span class="pln"> </span><span class="pun">++</span><span class="pln">it</span><span class="pun">,</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
                </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">hole</span><span class="pun">(</span><span class="pln">it</span><span class="pun">))</span><span class="pln">
                    q</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">bool</span><span class="pln"> mark</span><span class="pun">[</span><span class="pln">n</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{};</span><span class="pln">
        </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">alive</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">auto</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> q</span><span class="pun">.</span><span class="pln">front</span><span class="pun">();</span><span class="pln">
            q</span><span class="pun">.</span><span class="pln">pop</span><span class="pun">();</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">mark</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">
                </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">
            mark</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">auto</span><span class="pln"> it </span><span class="pun">=</span><span class="pln"> w</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
            ans </span><span class="pun">+=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[*</span><span class="pln">c_next</span><span class="pun">(</span><span class="pln">it</span><span class="pun">)],</span><span class="pln"> a</span><span class="pun">[*</span><span class="pln">c_prev</span><span class="pun">(</span><span class="pln">it</span><span class="pun">)]);</span><span class="pln">
            </span><span class="kwd">auto</span><span class="pln"> jt </span><span class="pun">=</span><span class="pln"> c_next</span><span class="pun">(</span><span class="pln">it</span><span class="pun">);</span><span class="pln">
            alive</span><span class="pun">.</span><span class="pln">erase</span><span class="pun">(</span><span class="pln">it</span><span class="pun">);</span><span class="pln">
            it </span><span class="pun">=</span><span class="pln"> jt</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">hole</span><span class="pun">(</span><span class="pln">it</span><span class="pun">))</span><span class="pln">
                q</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(*</span><span class="pln">it</span><span class="pun">);</span><span class="pln">
            it </span><span class="pun">=</span><span class="pln"> c_prev</span><span class="pun">(</span><span class="pln">it</span><span class="pun">);</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">hole</span><span class="pun">(</span><span class="pln">it</span><span class="pun">))</span><span class="pln">
                q</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(*</span><span class="pln">it</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="str">'\n'</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2165/problem/B">2165B — Marble Council</a></p><p>idea &amp; solution: <a class="rated-user user-legendary" href="/profile/Flamire" title="Legendary Grandmaster Flamire"><span class="legendary-user-first-letter">F</span>lamire</a></p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: none;"><p>For a multiset <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-346" style="width: 0.869em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.652em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.65em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-347"><span class="mi" id="MathJax-Span-348" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-39">S</script>, we will find a check to determine whether it can be generated.</p><p>For each color <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-349" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-350"><span class="mi" id="MathJax-Span-351" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-40">x</script> not in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-352" style="width: 0.869em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.652em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.65em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-353"><span class="mi" id="MathJax-Span-354" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-41">S</script>, we need to somehow "hide" all of the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-355" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-356"><span class="mi" id="MathJax-Span-357" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-42">x</script>'s in other sets. That is, for every partitioned set, the occurrence of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-358" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-359"><span class="mi" id="MathJax-Span-360" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-43">x</script> must be less than or equal to the occurrence of the modes.</p><p>For each color <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-361" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-362"><span class="mi" id="MathJax-Span-363" style="font-family: MathJax_Math-italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-44">c</script> in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-364" style="width: 0.869em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.652em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.65em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-365"><span class="mi" id="MathJax-Span-366" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-45">S</script>, no matter how many times <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-367" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-368"><span class="mi" id="MathJax-Span-369" style="font-family: MathJax_Math-italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-46">c</script> appeared in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-370" style="width: 0.869em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.652em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.65em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-371"><span class="mi" id="MathJax-Span-372" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>S</mi></math></span></span><script type="math/tex" id="MathJax-Element-47">S</script>, or how we partition these <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-373" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-374"><span class="mi" id="MathJax-Span-375" style="font-family: MathJax_Math-italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-48">c</script> into different sets, the color <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-376" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-377"><span class="mi" id="MathJax-Span-378" style="font-family: MathJax_Math-italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-49">c</script> can provide at most <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-379" style="width: 2.384em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1001.79em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-380"><span class="mi" id="MathJax-Span-381" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-382" style="font-family: MathJax_Math-italic;">n</span><span class="msubsup" id="MathJax-Span-383"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.33em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-384" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.381em;"><span class="mi" id="MathJax-Span-385" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mi>n</mi><msub><mi>t</mi><mi>c</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-50">cnt_c</script> "chances" to hide an element of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-386" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-387"><span class="mi" id="MathJax-Span-388" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-51">x</script>.</p><p>Therefore, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-389" style="width: 10.014em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.578em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1007.58em, 2.654em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-390"><span class="mi" id="MathJax-Span-391" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-392" style="font-family: MathJax_Math-italic;">n</span><span class="msubsup" id="MathJax-Span-393"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.33em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-394" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.381em;"><span class="mi" id="MathJax-Span-395" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-396" style="font-family: MathJax_Main; padding-left: 0.273em;">≤</span><span class="munderover" id="MathJax-Span-397" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 2.384em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1000.98em, 4.44em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-398" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.731em; left: 1.085em;"><span class="texatom" id="MathJax-Span-399"><span class="mrow" id="MathJax-Span-400"><span class="mi" id="MathJax-Span-401" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-402" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-403" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mi" id="MathJax-Span-404" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">c</span><span class="mi" id="MathJax-Span-405" style="font-family: MathJax_Math-italic;">n</span><span class="msubsup" id="MathJax-Span-406"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.33em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-407" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.381em;"><span class="mi" id="MathJax-Span-408" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.496em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mi>n</mi><msub><mi>t</mi><mi>x</mi></msub><mo>≤</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mo>∈</mo><mi>S</mi></mrow></munder><mi>c</mi><mi>n</mi><msub><mi>t</mi><mi>c</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-52">cnt_x\le\sum_{c\in S}cnt_c</script> must hold.</p><p>It is easy to construct a partition once this condition is held for all <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-409" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-410"><span class="mi" id="MathJax-Span-411" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-53">x</script>. Thus, we only need to count sets that satisfy <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;munder&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2209;&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-412" style="width: 14.505em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.988em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1010.99em, 2.654em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-413"><span class="munderover" id="MathJax-Span-414"><span style="display: inline-block; position: relative; width: 3.249em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1001.84em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-415" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 1.843em;"><span class="texatom" id="MathJax-Span-416"><span class="mrow" id="MathJax-Span-417"><span class="mi" id="MathJax-Span-418" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-419" style="font-size: 70.7%; font-family: MathJax_Main;">∉</span><span class="mi" id="MathJax-Span-420" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mi" id="MathJax-Span-421" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">c</span><span class="mi" id="MathJax-Span-422" style="font-family: MathJax_Math-italic;">n</span><span class="msubsup" id="MathJax-Span-423"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.33em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-424" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.381em;"><span class="mi" id="MathJax-Span-425" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-426" style="font-family: MathJax_Main; padding-left: 0.273em;">≤</span><span class="munderover" id="MathJax-Span-427" style="padding-left: 0.273em;"><span style="display: inline-block; position: relative; width: 2.384em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1000.98em, 4.44em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-428" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.731em; left: 1.085em;"><span class="texatom" id="MathJax-Span-429"><span class="mrow" id="MathJax-Span-430"><span class="mi" id="MathJax-Span-431" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-432" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-433" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mi" id="MathJax-Span-434" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">c</span><span class="mi" id="MathJax-Span-435" style="font-family: MathJax_Math-italic;">n</span><span class="msubsup" id="MathJax-Span-436"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.33em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-437" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.381em;"><span class="mi" id="MathJax-Span-438" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.496em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><munder><mo movablelimits="true" form="prefix">max</mo><mrow class="MJX-TeXAtom-ORD"><mi>x</mi><mo>∉</mo><mi>S</mi></mrow></munder><mi>c</mi><mi>n</mi><msub><mi>t</mi><mi>x</mi></msub><mo>≤</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mo>∈</mo><mi>S</mi></mrow></munder><mi>c</mi><mi>n</mi><msub><mi>t</mi><mi>c</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-54">\max_{x\not\in S} cnt_x\le\sum_{c\in S} cnt_c</script>.</p><p>This is a simple knapsack dp problem from here, you can either add elements in increasing order of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-439" style="width: 1.897em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.41em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1001.36em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-440"><span class="mi" id="MathJax-Span-441" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-442" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-443" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mi>n</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-55">cnt</script> and keep track if the last color is used at all, or observe that the condition is just <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-444" style="width: 12.016em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.094em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1009.04em, 2.654em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-445"><span class="munderover" id="MathJax-Span-446"><span style="display: inline-block; position: relative; width: 2.384em; height: 0px;"><span style="position: absolute; clip: rect(3.087em, 1000.98em, 4.44em, -999.997em); top: -4.002em; left: 0em;"><span class="mo" id="MathJax-Span-447" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.731em; left: 1.085em;"><span class="texatom" id="MathJax-Span-448"><span class="mrow" id="MathJax-Span-449"><span class="mi" id="MathJax-Span-450" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span class="mo" id="MathJax-Span-451" style="font-size: 70.7%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-452" style="font-size: 70.7%; font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mi" id="MathJax-Span-453" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">c</span><span class="mi" id="MathJax-Span-454" style="font-family: MathJax_Math-italic;">n</span><span class="msubsup" id="MathJax-Span-455"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px;"><span style="position: absolute; clip: rect(3.195em, 1000.33em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-456" style="font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.381em;"><span class="mi" id="MathJax-Span-457" style="font-size: 70.7%; font-family: MathJax_Math-italic;">c</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-458" style="font-family: MathJax_Main; padding-left: 0.273em;">≥</span><span class="mo" id="MathJax-Span-459" style="font-family: MathJax_Main; padding-left: 0.273em;">max</span><span class="mi" id="MathJax-Span-460" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">c</span><span class="mi" id="MathJax-Span-461" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-462" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.496em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mo>∈</mo><mi>S</mi></mrow></munder><mi>c</mi><mi>n</mi><msub><mi>t</mi><mi>c</mi></msub><mo>≥</mo><mo movablelimits="true" form="prefix">max</mo><mi>c</mi><mi>n</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-56">\sum_{c\in S}cnt_c\ge\max cnt</script>, and just running a completely vanilla knapsack dp.</p><p>Time Complexity: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-463" style="width: 3.466em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.6em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.193em, 1002.49em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-464"><span class="mi" id="MathJax-Span-465" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-466" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-467"><span style="display: inline-block; position: relative; width: 1.031em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.6em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-468" style="font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.38em; left: 0.598em;"><span class="mn" id="MathJax-Span-469" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-470" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-57">O(n^2)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution (By ZhouYuHang)</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N </span><span class="pun">=</span><span class="pln"> </span><span class="lit">5e3</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">5</span><span class="pun">,</span><span class="pln"> P </span><span class="pun">=</span><span class="pln"> </span><span class="lit">998244353</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
 
</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> cin </span><span class="pun">&gt;&gt;</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
	
	memset</span><span class="pun">(</span><span class="pln">cnt</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">sizeof</span><span class="pln"> cnt</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> max_cnt </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		max_cnt </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">max_cnt</span><span class="pun">,</span><span class="pln"> </span><span class="pun">++</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
 
	memset</span><span class="pun">(</span><span class="pln">dp</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">sizeof</span><span class="pln"> dp</span><span class="pun">),</span><span class="pln"> dp</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&gt;=</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln"> </span><span class="pun">--</span><span class="pln">j</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			dp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">j </span><span class="pun">-</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]])</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> P</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	
	</span><span class="kwd">int</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> max_cnt</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ans </span><span class="pun">+=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">%=</span><span class="pln"> P</span><span class="pun">;</span><span class="pln">
	cout </span><span class="pun">&lt;&lt;</span><span class="pln"> ans </span><span class="pun">&lt;&lt;</span><span class="pln"> endl</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	ios</span><span class="pun">::</span><span class="pln">sync_with_stdio</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">
	cin</span><span class="pun">.</span><span class="pln">tie</span><span class="pun">(</span><span class="kwd">nullptr</span><span class="pun">);</span><span class="pln">
 
	</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">	
	cin </span><span class="pun">&gt;&gt;</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		solve</span><span class="pun">();</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
 
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2165/problem/C">2165C — Binary Wine</a></p><p>idea &amp; solution: <a class="rated-user user-legendary" href="/profile/le0n" title="Legendary Grandmaster le0n"><span class="legendary-user-first-letter">l</span>e0n</a></p><p>Some participants mentioned that similar ideas have appeared recently. We knew of at least one such problem, however, the problem was already proposed and accepted at that time.</p><p>I believe that the problems are not identical, though similar ideas were used, it is also a show of skill to remember and reuse ideas learnt from previous problems. Therefore, I would like to think the problem does have a place in the contest.</p><p>There was an oversight on the preparation of this problem, the tests did not include enough small tests, which allowed some codes with wrong implementation to pass. We apologize for the inconvenience.</p> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: none;"><p>There are many ways to approach this problem, my personal approach is as follows:</p><p>Consider what kind of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-471" style="width: 0.76em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-472"><span class="mi" id="MathJax-Span-473" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-58">a</script> would satisfy the requirements, after some exploring, we can arrive at the following check: Sum each bit of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-474" style="width: 0.76em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-475"><span class="mi" id="MathJax-Span-476" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-59">a</script>, resulting in an integer sequence, if this sequence is lexicographically larger or equal to the binary representation of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-477" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-478"><span class="mi" id="MathJax-Span-479" style="font-family: MathJax_Math-italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-60">c</script>, then <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-480" style="width: 0.76em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-481"><span class="mi" id="MathJax-Span-482" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-61">a</script> is ok.</p><p>This can be explained by considering bits from high to low:</p> <ul>   <li>If at some point we have more <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-483" style="width: 0.76em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-484"><span class="mi" id="MathJax-Span-485" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-62">a</script>'s than <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-486" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-487"><span class="mi" id="MathJax-Span-488" style="font-family: MathJax_Math-italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-63">c</script>, we can use a 1-bit on this position to fix everything under this bit.</li>   <li>If at some point we have <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-489" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-490"><span class="mn" id="MathJax-Span-491" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-64">0</script> a's and the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-492" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-493"><span class="mi" id="MathJax-Span-494" style="font-family: MathJax_Math-italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-65">c</script> bit is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-495" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-496"><span class="mn" id="MathJax-Span-497" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-66">1</script>, it's then obvious that we cannot satisfy the conditions, since we also cannot use higher bits to change the situation, as this will cause higher bits to be less than <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-498" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-499"><span class="mi" id="MathJax-Span-500" style="font-family: MathJax_Math-italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-67">c</script>.</li> </ul><p>Thus, we have obtained a clean check to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-501" style="width: 0.76em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-502"><span class="mi" id="MathJax-Span-503" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-68">a</script>.</p><p>To minimize the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-504" style="width: 1.734em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1001.25em, 2.438em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-505"><span class="mo" id="MathJax-Span-506" style="font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-507" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-69">+1</script> operations, we will iterate bits from high to low, if the current <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-508" style="width: 0.76em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-509"><span class="mi" id="MathJax-Span-510" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-70">a</script>'s is less than <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-511" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-512"><span class="mi" id="MathJax-Span-513" style="font-family: MathJax_Math-italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-71">c</script>, we will have to select a single <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-514" style="width: 0.76em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-515"><span class="mi" id="MathJax-Span-516" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-72">a</script> element, and increase it to the point that the current bit is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-517" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-518"><span class="mn" id="MathJax-Span-519" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-73">1</script>. Note that we will not increase two <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-520" style="width: 0.76em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-521"><span class="mi" id="MathJax-Span-522" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-74">a</script> elements, since in reaching the state, we will inevitably reach the state where one of the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-523" style="width: 0.76em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-524"><span class="mi" id="MathJax-Span-525" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-75">a</script> is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1000&lt;/mn&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mn&gt;00&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-526" style="width: 5.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.494em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1004.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-527"><span class="mn" id="MathJax-Span-528" style="font-family: MathJax_Main;">1000</span><span class="mo" id="MathJax-Span-529" style="font-family: MathJax_Main; padding-left: 0.165em;">⋯</span><span class="mn" id="MathJax-Span-530" style="font-family: MathJax_Main; padding-left: 0.165em;">00</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1000</mn><mo>⋯</mo><mn>00</mn></math></span></span><script type="math/tex" id="MathJax-Element-76">1000\cdots00</script>, and the other one is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0111&lt;/mn&gt;&lt;mo&gt;&amp;#x22EF;&lt;/mo&gt;&lt;mn&gt;11&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-531" style="width: 5.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.494em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1004.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-532"><span class="mn" id="MathJax-Span-533" style="font-family: MathJax_Main;">0111</span><span class="mo" id="MathJax-Span-534" style="font-family: MathJax_Main; padding-left: 0.165em;">⋯</span><span class="mn" id="MathJax-Span-535" style="font-family: MathJax_Main; padding-left: 0.165em;">11</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0111</mn><mo>⋯</mo><mn>11</mn></math></span></span><script type="math/tex" id="MathJax-Element-77">0111\cdots11</script>, this is already enough.</p><p>From here, observe that only the maximum <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-536" style="width: 4.927em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.736em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1003.63em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-537"><span class="mi" id="MathJax-Span-538" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-539" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-540" style="font-family: MathJax_Main;">log</span><span class="mo" id="MathJax-Span-541"></span><span class="mi" id="MathJax-Span-542" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.165em;"></span></span><span class="mo" id="MathJax-Span-543" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>V</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-78">O(\log V)</script> elements are used, we can easily achieve a complexity of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-544" style="width: 11.637em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.823em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.139em, 1008.72em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-545"><span class="mi" id="MathJax-Span-546" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-547" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-548" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-549" style="font-family: MathJax_Main; padding-left: 0.165em;">log</span><span class="mo" id="MathJax-Span-550"></span><span class="mi" id="MathJax-Span-551" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">n</span><span class="mo" id="MathJax-Span-552" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mi" id="MathJax-Span-553" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-554" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.734em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1001.25em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-555" style="font-family: MathJax_Main;">log</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -4.435em; left: 1.301em;"><span class="mn" id="MathJax-Span-556" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-557"></span><span class="mi" id="MathJax-Span-558" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.165em;"></span></span><span class="mo" id="MathJax-Span-559" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.646em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo>+</mo><mi>q</mi><msup><mi>log</mi><mn>2</mn></msup><mo>⁡</mo><mi>V</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-79">O(n\log n+q\log^2V)</script>, or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-560" style="width: 16.074em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.178em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1012.07em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-561"><span class="mi" id="MathJax-Span-562" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-563" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-564" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-565" style="font-family: MathJax_Main; padding-left: 0.165em;">log</span><span class="mo" id="MathJax-Span-566"></span><span class="mi" id="MathJax-Span-567" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">n</span><span class="mo" id="MathJax-Span-568" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mi" id="MathJax-Span-569" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-570" style="font-family: MathJax_Main; padding-left: 0.165em;">log</span><span class="mo" id="MathJax-Span-571"></span><span class="mi" id="MathJax-Span-572" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.165em;"></span></span><span class="mi" id="MathJax-Span-573" style="font-family: MathJax_Main; padding-left: 0.165em;">log</span><span class="mo" id="MathJax-Span-574"></span><span class="mi" id="MathJax-Span-575" style="font-family: MathJax_Main; padding-left: 0.165em;">log</span><span class="mo" id="MathJax-Span-576"></span><span class="mi" id="MathJax-Span-577" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.165em;"></span></span><span class="mo" id="MathJax-Span-578" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo>+</mo><mi>q</mi><mi>log</mi><mo>⁡</mo><mi>V</mi><mi>log</mi><mo>⁡</mo><mi>log</mi><mo>⁡</mo><mi>V</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-80">O(n\log n+q\log V\log\log V)</script> with heaps.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> N </span><span class="lit">500011</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> ll </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="pln">q</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,&amp;</span><span class="pln">T</span><span class="pun">);</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%d%d"</span><span class="pun">,&amp;</span><span class="pln">n</span><span class="pun">,&amp;</span><span class="pln">q</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln">a</span><span class="pun">+</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
		sort</span><span class="pun">(</span><span class="pln">a</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">a</span><span class="pun">+</span><span class="lit">1</span><span class="pun">+</span><span class="pln">n</span><span class="pun">,</span><span class="pln">greater</span><span class="str">&lt;int&gt;</span><span class="pun">());</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> nn</span><span class="pun">=</span><span class="pln">min</span><span class="pun">(</span><span class="pln">n</span><span class="pun">,</span><span class="lit">32</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">q</span><span class="pun">--)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">int</span><span class="pln"> c</span><span class="pun">;</span><span class="pln">scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,&amp;</span><span class="pln">c</span><span class="pun">);</span><span class="pln">
			</span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> b</span><span class="pun">[</span><span class="lit">44</span><span class="pun">];</span><span class="pln">ll ans</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">nn</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">29</span><span class="pun">;~</span><span class="pln">i</span><span class="pun">;--</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				</span><span class="kwd">int</span><span class="pln"> cc</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">nn</span><span class="pun">;++</span><span class="pln">j</span><span class="pun">)</span><span class="pln">cc</span><span class="pun">+=</span><span class="pln">b</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]&gt;&gt;</span><span class="pln">i</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">cc</span><span class="pun">&gt;(</span><span class="pln">c</span><span class="pun">&gt;&gt;</span><span class="pln">i</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">))</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">cc</span><span class="pun">&lt;(</span><span class="pln">c</span><span class="pun">&gt;&gt;</span><span class="pln">i</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">))</span><span class="pln">
				</span><span class="pun">{</span><span class="pln">
					</span><span class="kwd">int</span><span class="pln"> id</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
					</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">2</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">nn</span><span class="pun">;++</span><span class="pln">j</span><span class="pun">)</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">b</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]&gt;</span><span class="pln">b</span><span class="pun">[</span><span class="pln">id</span><span class="pun">])</span><span class="pln">id</span><span class="pun">=</span><span class="pln">j</span><span class="pun">;</span><span class="pln">
					ans</span><span class="pun">+=(</span><span class="lit">1</span><span class="pun">&lt;&lt;</span><span class="pln">i</span><span class="pun">)-</span><span class="pln">b</span><span class="pun">[</span><span class="pln">id</span><span class="pun">];</span><span class="pln">
					b</span><span class="pun">[</span><span class="pln">id</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
				</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;=</span><span class="pln">nn</span><span class="pun">;++</span><span class="pln">j</span><span class="pun">)</span><span class="pln">b</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]&amp;=~(</span><span class="lit">1</span><span class="pun">&lt;&lt;</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			printf</span><span class="pun">(</span><span class="str">"%lld\n"</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2165/problem/D">2165D — Path Split</a></p><p>idea &amp; solution: <a class="rated-user user-legendary" href="/profile/le0n" title="Legendary Grandmaster le0n"><span class="legendary-user-first-letter">l</span>e0n</a></p><p>Some participants mentioned that similar ideas have appeared recently, we did not know of this.</p><p>This problem was initially proposed with a Hall-dp solution, also with complexity <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-579" style="width: 2.871em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.167em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1002.06em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-580"><span class="mi" id="MathJax-Span-581" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-582" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-583" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-584" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-81">O(n)</script>, but testers told us of a simpler greedy solution.</p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: none;"><p>Reduce the problem to bipartite matching.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: none;"><p>Devise a greedy algorithm to solve the matching problem, and prove it (or not).</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: none;"><p>The problem can be formulated as a minimum path cover, which in turn can be converted into a bipartite matching problem:</p> <ul>   <li>For each element in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-585" style="width: 0.76em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-586"><span class="mi" id="MathJax-Span-587" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-82">a</script>, create both a left side vertex and a right side vertex, each left side vertex with value <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-588" style="width: 1.139em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.87em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-589"><span class="msubsup" id="MathJax-Span-590"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-591" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-592" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-83">a_i</script> can match right side vertices with index larger than <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-593" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-594"><span class="mi" id="MathJax-Span-595" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-84">i</script>, and with value <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-596" style="width: 3.466em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.6em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1002.55em, 2.492em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-597"><span class="msubsup" id="MathJax-Span-598"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-599" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-600" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-601" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-602" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-85">a_i-1</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-603" style="width: 3.466em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.6em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1002.55em, 2.492em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-604"><span class="msubsup" id="MathJax-Span-605"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-606" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-607" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-608" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-609" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-86">a_i+1</script>.</li> </ul><p>It can be observed that the graph can be partitioned into two unconnected components by parity.</p><p>A certain intuition the matching for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-610" style="width: 3.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.708em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1002.65em, 2.492em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-611"><span class="msubsup" id="MathJax-Span-612"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-613" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-614" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-615" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mn" id="MathJax-Span-616" style="font-family: MathJax_Main; padding-left: 0.273em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-87">a_i=1</script> stricter than <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-617" style="width: 3.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.708em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1002.65em, 2.492em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-618"><span class="msubsup" id="MathJax-Span-619"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-620" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-621" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-622" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mn" id="MathJax-Span-623" style="font-family: MathJax_Main; padding-left: 0.273em;">3</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mn>3</mn></math></span></span><script type="math/tex" id="MathJax-Element-88">a_i=3</script>, maybe we can try just letting the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-624" style="width: 3.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.708em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1002.65em, 2.492em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-625"><span class="msubsup" id="MathJax-Span-626"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-627" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-628" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-629" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mn" id="MathJax-Span-630" style="font-family: MathJax_Main; padding-left: 0.273em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-89">a_i=1</script> greedily choose the next element, and just believe that it will work out.</p><p>Therefore, we can propose a greedy algorithm: we iterate values <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-631" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.49em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-632"><span class="mi" id="MathJax-Span-633" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-90">v</script> from small to large, for every vertex with value <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-634" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.49em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-635"><span class="mi" id="MathJax-Span-636" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-91">v</script> on the left side, if it is unmatched, we match it with a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-637" style="width: 2.925em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.221em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1002.17em, 2.438em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-638"><span class="mi" id="MathJax-Span-639" style="font-family: MathJax_Math-italic;">v</span><span class="mo" id="MathJax-Span-640" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-641" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi><mo>+</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-92">v+1</script> on the right side with index closest to it, we do the same for value <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-642" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.49em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-643"><span class="mi" id="MathJax-Span-644" style="font-family: MathJax_Math-italic;">v</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></span></span><script type="math/tex" id="MathJax-Element-93">v</script> vertices on the right side.</p><p>We can prove that this is correct: Consider an element with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-645" style="width: 3.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.708em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1002.65em, 2.492em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-646"><span class="msubsup" id="MathJax-Span-647"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-648" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-649" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-650" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mn" id="MathJax-Span-651" style="font-family: MathJax_Main; padding-left: 0.273em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-94">a_i=1</script>, if it did not match the closest <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-652" style="width: 3.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.708em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1002.65em, 2.492em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-653"><span class="msubsup" id="MathJax-Span-654"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-655" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-656" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-657" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mn" id="MathJax-Span-658" style="font-family: MathJax_Main; padding-left: 0.273em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-95">a_i=2</script> on the right, we will try to substitute this pair into the final matching.</p><p>Suppose our <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-659" style="width: 3.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.708em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1002.65em, 2.492em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-660"><span class="msubsup" id="MathJax-Span-661"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-662" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-663" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-664" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mn" id="MathJax-Span-665" style="font-family: MathJax_Main; padding-left: 0.273em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-96">a_i=1</script> vertex is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-666" style="width: 1.031em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.76em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-667"><span class="mi" id="MathJax-Span-668" style="font-family: MathJax_Math-italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-97">A</script>, the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-98-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-669" style="width: 3.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.708em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1002.65em, 2.492em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-670"><span class="msubsup" id="MathJax-Span-671"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-672" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-673" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-674" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mn" id="MathJax-Span-675" style="font-family: MathJax_Main; padding-left: 0.273em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-98">a_i=2</script> vertex on the right is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-676" style="width: 1.031em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.76em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-677"><span class="mi" id="MathJax-Span-678" style="font-family: MathJax_Math-italic;">B</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-99">B</script>. If we insert <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-100-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-679" style="width: 3.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.708em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1002.71em, 2.438em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-680"><span class="mi" id="MathJax-Span-681" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-682" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mi" id="MathJax-Span-683" style="font-family: MathJax_Math-italic; padding-left: 0.219em;">B</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>−</mo><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-100">A-B</script> into the matching, and discard any preexisting matches with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-101-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-684" style="width: 1.031em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.76em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-685"><span class="mi" id="MathJax-Span-686" style="font-family: MathJax_Math-italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-101">A</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-102-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-687" style="width: 1.031em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.76em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-688"><span class="mi" id="MathJax-Span-689" style="font-family: MathJax_Math-italic;">B</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-102">B</script>, the only case where we our matching size decreases is when <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-103-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-690" style="width: 1.031em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.76em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-691"><span class="mi" id="MathJax-Span-692" style="font-family: MathJax_Math-italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-103">A</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-104-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-693" style="width: 1.031em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.76em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-694"><span class="mi" id="MathJax-Span-695" style="font-family: MathJax_Math-italic;">B</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-104">B</script> are both matched with some <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-105-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-696" style="width: 1.031em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.76em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-697"><span class="mi" id="MathJax-Span-698" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-105">C</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-106-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-699" style="width: 1.085em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.814em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.81em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-700"><span class="mi" id="MathJax-Span-701" style="font-family: MathJax_Math-italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-106">D</script>, respectively.</p><p>It can then be shown by simple reasoning that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-107-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-702" style="width: 1.031em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.76em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.76em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-703"><span class="mi" id="MathJax-Span-704" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-107">C</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-108-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-705" style="width: 1.085em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.814em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.81em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-706"><span class="mi" id="MathJax-Span-707" style="font-family: MathJax_Math-italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-108">D</script> can be matched, which means our matching size will not be reduced.</p><p>Therefore, we can choose any <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-109-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-708" style="width: 3.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.708em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1002.65em, 2.492em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-709"><span class="msubsup" id="MathJax-Span-710"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-711" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-712" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-713" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mn" id="MathJax-Span-714" style="font-family: MathJax_Main; padding-left: 0.273em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-109">a_i=1</script> and the closest <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-110-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-715" style="width: 3.574em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.708em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1002.65em, 2.492em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-716"><span class="msubsup" id="MathJax-Span-717"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-718" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-719" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-720" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mn" id="MathJax-Span-721" style="font-family: MathJax_Main; padding-left: 0.273em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-110">a_i=2</script>, and simply delete them from the graph.</p><p>Thus, the greedy is proved.</p><p>Implementation should be easy. Time Complexity: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-111-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-722" style="width: 5.739em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.332em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1004.22em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-723"><span class="mi" id="MathJax-Span-724" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-725" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-726" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-727" style="font-family: MathJax_Main; padding-left: 0.165em;">log</span><span class="mo" id="MathJax-Span-728"></span><span class="mi" id="MathJax-Span-729" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">n</span><span class="mo" id="MathJax-Span-730" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-111">O(n\log n)</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-112-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-731" style="width: 2.871em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.167em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1002.06em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-732"><span class="mi" id="MathJax-Span-733" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-734" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-735" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-736" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-112">O(n)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial (Hall-dp)</b><div class="spoiler-content" style="display: none;"><p>Observation: construct a bipartite graph with <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-113-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-737" style="width: 1.464em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.085em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1001.09em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-738"><span class="mn" id="MathJax-Span-739" style="font-family: MathJax_Main;">2</span><span class="mi" id="MathJax-Span-740" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-113">2n</script> vertices, named <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-114-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-741" style="width: 8.065em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.117em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1006.12em, 2.546em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-742"><span class="msubsup" id="MathJax-Span-743"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-744" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mn" id="MathJax-Span-745" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-746" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-747" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-748" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mn" id="MathJax-Span-749" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-750" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-751" style="font-family: MathJax_Main; padding-left: 0.165em;">…</span><span class="mo" id="MathJax-Span-752" style="font-family: MathJax_Main; padding-left: 0.165em;">,</span><span class="msubsup" id="MathJax-Span-753" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-754" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mi" id="MathJax-Span-755" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>L</mi><mn>1</mn></msub><mo>,</mo><msub><mi>L</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>L</mi><mi>n</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-114">L_1,L_2,\dots,L_n</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-115-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-756" style="width: 8.282em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.28em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1006.28em, 2.546em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-757"><span class="msubsup" id="MathJax-Span-758"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.76em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-759" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.76em;"><span class="mn" id="MathJax-Span-760" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-761" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-762" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.76em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-763" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.76em;"><span class="mn" id="MathJax-Span-764" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-765" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-766" style="font-family: MathJax_Main; padding-left: 0.165em;">…</span><span class="mo" id="MathJax-Span-767" style="font-family: MathJax_Main; padding-left: 0.165em;">,</span><span class="msubsup" id="MathJax-Span-768" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.247em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.76em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-769" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.76em;"><span class="mi" id="MathJax-Span-770" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mn>1</mn></msub><mo>,</mo><msub><mi>R</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>R</mi><mi>n</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-115">R_1,R_2,\dots,R_n</script>. There is an edge between <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-116-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-771" style="width: 1.301em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.98em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-772"><span class="msubsup" id="MathJax-Span-773"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-774" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mi" id="MathJax-Span-775" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>L</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-116">L_i</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-117-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-776" style="width: 1.518em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1001.14em, 2.546em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-777"><span class="msubsup" id="MathJax-Span-778"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.76em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-779" style="font-family: MathJax_Math-italic;">R</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.76em;"><span class="mi" id="MathJax-Span-780" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mi>j</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-117">R_j</script> iff <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-118-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-781" style="width: 2.708em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.059em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1002.06em, 2.546em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-782"><span class="mi" id="MathJax-Span-783" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-784" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="mi" id="MathJax-Span-785" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">j</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>&lt;</mo><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-118">i<j</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-119-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-786" style="width: 7.146em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.414em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1005.36em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-787"><span class="texatom" id="MathJax-Span-788"><span class="mrow" id="MathJax-Span-789"><span class="mo" id="MathJax-Span-790" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-791"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-792" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-793" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-794" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="msubsup" id="MathJax-Span-795" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 0.923em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-796" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-797" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="texatom" id="MathJax-Span-798"><span class="mrow" id="MathJax-Span-799"><span class="mo" id="MathJax-Span-800" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-801" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mn" id="MathJax-Span-802" style="font-family: MathJax_Main; padding-left: 0.273em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.504em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>a</mi><mi>i</mi></msub><mo>−</mo><msub><mi>a</mi><mi>j</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-119">|a_i-a_j|=1</script>. The answer to the original problem is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-120-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-803" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-804"><span class="mi" id="MathJax-Span-805" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-120">n</script> minus the size of the maximum matching of this graph.</p><p>Consider using hall theorem on <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-121-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-806" style="width: 8.065em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.117em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1006.12em, 2.546em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-807"><span class="msubsup" id="MathJax-Span-808"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-809" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mn" id="MathJax-Span-810" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-811" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-812" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-813" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mn" id="MathJax-Span-814" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-815" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-816" style="font-family: MathJax_Main; padding-left: 0.165em;">…</span><span class="mo" id="MathJax-Span-817" style="font-family: MathJax_Main; padding-left: 0.165em;">,</span><span class="msubsup" id="MathJax-Span-818" style="padding-left: 0.165em;"><span style="display: inline-block; position: relative; width: 1.193em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-819" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mi" id="MathJax-Span-820" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>L</mi><mn>1</mn></msub><mo>,</mo><msub><mi>L</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>L</mi><mi>n</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-121">L_1,L_2,\dots,L_n</script>, thus we only need to calculate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-122-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-821" style="width: 9.743em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.362em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1007.25em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-822"><span class="mo" id="MathJax-Span-823" style="font-family: MathJax_Main;">max</span><span class="texatom" id="MathJax-Span-824" style="padding-left: 0.165em;"><span class="mrow" id="MathJax-Span-825"><span class="mo" id="MathJax-Span-826" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-827" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="texatom" id="MathJax-Span-828"><span class="mrow" id="MathJax-Span-829"><span class="mo" id="MathJax-Span-830" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-831" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="texatom" id="MathJax-Span-832" style="padding-left: 0.219em;"><span class="mrow" id="MathJax-Span-833"><span class="mo" id="MathJax-Span-834" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-835" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.111em;"></span></span><span class="mo" id="MathJax-Span-836" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-837" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-838" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-839"><span class="mrow" id="MathJax-Span-840"><span class="mo" id="MathJax-Span-841" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo movablelimits="true" form="prefix">max</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>N</mi><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-122">\max |S|-|N(S)|</script>.</p><p>Separate <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-123-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-842" style="width: 0.923em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.65em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-843"><span class="mi" id="MathJax-Span-844" style="font-family: MathJax_Math-italic;">L</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-123">L</script> into <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-124-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-845" style="width: 2.438em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.843em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1001.84em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-846"><span class="msubsup" id="MathJax-Span-847"><span style="display: inline-block; position: relative; width: 1.843em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-848" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="texatom" id="MathJax-Span-849"><span class="mrow" id="MathJax-Span-850"><span class="mi" id="MathJax-Span-851" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-852" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-853" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>d</mi><mi>d</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-124">L_{odd}</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-125-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-854" style="width: 2.871em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.167em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1002.17em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-855"><span class="msubsup" id="MathJax-Span-856"><span style="display: inline-block; position: relative; width: 2.167em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-857" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="texatom" id="MathJax-Span-858"><span class="mrow" id="MathJax-Span-859"><span class="mi" id="MathJax-Span-860" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-861" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-862" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-863" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>e</mi><mi>v</mi><mi>e</mi><mi>n</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-125">L_{even}</script>, which contains all the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-126-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-864" style="width: 1.301em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.98em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-865"><span class="msubsup" id="MathJax-Span-866"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-867" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="mi" id="MathJax-Span-868" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>L</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-126">L_i</script> with odd <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-127-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-869" style="width: 1.139em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.87em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-870"><span class="msubsup" id="MathJax-Span-871"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-872" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-873" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-127">a_i</script> and vice versa. Let <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-128-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-874" style="width: 8.877em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.713em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1006.71em, 2.492em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-875"><span class="msubsup" id="MathJax-Span-876"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-877" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="texatom" id="MathJax-Span-878"><span class="mrow" id="MathJax-Span-879"><span class="mi" id="MathJax-Span-880" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-881" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-882" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-883" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-884" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-885" style="font-family: MathJax_Main; padding-left: 0.219em;">∩</span><span class="msubsup" id="MathJax-Span-886" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 1.843em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-887" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="texatom" id="MathJax-Span-888"><span class="mrow" id="MathJax-Span-889"><span class="mi" id="MathJax-Span-890" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-891" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-892" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>d</mi><mi>d</mi></mrow></msub><mo>=</mo><mi>S</mi><mo>∩</mo><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>d</mi><mi>d</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-128">S_{odd}=S\cap L_{odd}</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-129-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo&gt;&amp;#x2229;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-893" style="width: 9.743em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.362em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1007.36em, 2.492em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-894"><span class="msubsup" id="MathJax-Span-895"><span style="display: inline-block; position: relative; width: 2.113em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-896" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="texatom" id="MathJax-Span-897"><span class="mrow" id="MathJax-Span-898"><span class="mi" id="MathJax-Span-899" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-900" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-901" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-902" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-903" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="mi" id="MathJax-Span-904" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-905" style="font-family: MathJax_Main; padding-left: 0.219em;">∩</span><span class="msubsup" id="MathJax-Span-906" style="padding-left: 0.219em;"><span style="display: inline-block; position: relative; width: 2.167em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-907" style="font-family: MathJax_Math-italic;">L</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.706em;"><span class="texatom" id="MathJax-Span-908"><span class="mrow" id="MathJax-Span-909"><span class="mi" id="MathJax-Span-910" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-911" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-912" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-913" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>e</mi><mi>v</mi><mi>e</mi><mi>n</mi></mrow></msub><mo>=</mo><mi>S</mi><mo>∩</mo><msub><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mi>e</mi><mi>v</mi><mi>e</mi><mi>n</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-129">S_{even}=S\cap L_{even}</script> we can see that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-130-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-914" style="width: 31.388em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.758em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1023.65em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-915"><span class="texatom" id="MathJax-Span-916"><span class="mrow" id="MathJax-Span-917"><span class="mo" id="MathJax-Span-918" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-919" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="texatom" id="MathJax-Span-920"><span class="mrow" id="MathJax-Span-921"><span class="mo" id="MathJax-Span-922" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-923" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="texatom" id="MathJax-Span-924" style="padding-left: 0.219em;"><span class="mrow" id="MathJax-Span-925"><span class="mo" id="MathJax-Span-926" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-927" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.111em;"></span></span><span class="mo" id="MathJax-Span-928" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-929" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-930" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-931"><span class="mrow" id="MathJax-Span-932"><span class="mo" id="MathJax-Span-933" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-934" style="font-family: MathJax_Main; padding-left: 0.273em;">=</span><span class="texatom" id="MathJax-Span-935" style="padding-left: 0.273em;"><span class="mrow" id="MathJax-Span-936"><span class="mo" id="MathJax-Span-937" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-938"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-939" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="texatom" id="MathJax-Span-940"><span class="mrow" id="MathJax-Span-941"><span class="mi" id="MathJax-Span-942" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-943" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-944" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="texatom" id="MathJax-Span-945"><span class="mrow" id="MathJax-Span-946"><span class="mo" id="MathJax-Span-947" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-948" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="texatom" id="MathJax-Span-949" style="padding-left: 0.219em;"><span class="mrow" id="MathJax-Span-950"><span class="mo" id="MathJax-Span-951" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-952" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.111em;"></span></span><span class="mo" id="MathJax-Span-953" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-954"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-955" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="texatom" id="MathJax-Span-956"><span class="mrow" id="MathJax-Span-957"><span class="mi" id="MathJax-Span-958" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-959" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-960" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-961" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-962"><span class="mrow" id="MathJax-Span-963"><span class="mo" id="MathJax-Span-964" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-965" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="texatom" id="MathJax-Span-966" style="padding-left: 0.219em;"><span class="mrow" id="MathJax-Span-967"><span class="mo" id="MathJax-Span-968" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-969"><span style="display: inline-block; position: relative; width: 2.113em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-970" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="texatom" id="MathJax-Span-971"><span class="mrow" id="MathJax-Span-972"><span class="mi" id="MathJax-Span-973" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-974" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-975" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-976" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="texatom" id="MathJax-Span-977"><span class="mrow" id="MathJax-Span-978"><span class="mo" id="MathJax-Span-979" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-980" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="texatom" id="MathJax-Span-981" style="padding-left: 0.219em;"><span class="mrow" id="MathJax-Span-982"><span class="mo" id="MathJax-Span-983" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-984" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.111em;"></span></span><span class="mo" id="MathJax-Span-985" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-986"><span style="display: inline-block; position: relative; width: 2.113em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-987" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="texatom" id="MathJax-Span-988"><span class="mrow" id="MathJax-Span-989"><span class="mi" id="MathJax-Span-990" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-991" style="font-size: 70.7%; font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-992" style="font-size: 70.7%; font-family: MathJax_Math-italic;">e</span><span class="mi" id="MathJax-Span-993" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-994" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-995"><span class="mrow" id="MathJax-Span-996"><span class="mo" id="MathJax-Span-997" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>N</mi><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>d</mi><mi>d</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>N</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>d</mi><mi>d</mi></mrow></msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>e</mi><mi>v</mi><mi>e</mi><mi>n</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>N</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>e</mi><mi>v</mi><mi>e</mi><mi>n</mi></mrow></msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-130">|S|-|N(S)|=|S_{odd}|-|N(S_{odd})|+|S_{even}|-|N(S_{even})|</script>, so we can calculate the two parts separately.</p><p>For <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-131-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-998" style="width: 12.719em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.635em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1009.53em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-999"><span class="mo" id="MathJax-Span-1000" style="font-family: MathJax_Main;">max</span><span class="texatom" id="MathJax-Span-1001" style="padding-left: 0.165em;"><span class="mrow" id="MathJax-Span-1002"><span class="mo" id="MathJax-Span-1003" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1004"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1005" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1006"><span class="mrow" id="MathJax-Span-1007"><span class="mi" id="MathJax-Span-1008" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-1009" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1010" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1011"><span class="mrow" id="MathJax-Span-1012"><span class="mo" id="MathJax-Span-1013" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1014" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="texatom" id="MathJax-Span-1015" style="padding-left: 0.219em;"><span class="mrow" id="MathJax-Span-1016"><span class="mo" id="MathJax-Span-1017" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1018" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.111em;"></span></span><span class="mo" id="MathJax-Span-1019" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1020"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1021" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1022"><span class="mrow" id="MathJax-Span-1023"><span class="mi" id="MathJax-Span-1024" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-1025" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1026" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1027" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1028"><span class="mrow" id="MathJax-Span-1029"><span class="mo" id="MathJax-Span-1030" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo movablelimits="true" form="prefix">max</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>d</mi><mi>d</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>N</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>d</mi><mi>d</mi></mrow></msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-131">\max |S_{odd}|-|N(S_{odd})|</script>, if adding an element to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-132-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1031" style="width: 2.384em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1001.79em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1032"><span class="msubsup" id="MathJax-Span-1033"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1034" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1035"><span class="mrow" id="MathJax-Span-1036"><span class="mi" id="MathJax-Span-1037" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-1038" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1039" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>d</mi><mi>d</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-132">S_{odd}</script> doesn't make <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-133-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1040" style="width: 4.602em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.466em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1003.36em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1041"><span class="mi" id="MathJax-Span-1042" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.111em;"></span></span><span class="mo" id="MathJax-Span-1043" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1044"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1045" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1046"><span class="mrow" id="MathJax-Span-1047"><span class="mi" id="MathJax-Span-1048" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-1049" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1050" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1051" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>d</mi><mi>d</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-133">N(S_{odd})</script> bigger, we can always add it. So we only need to consider <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-134-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1052" style="width: 2.384em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1001.79em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1053"><span class="msubsup" id="MathJax-Span-1054"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1055" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1056"><span class="mrow" id="MathJax-Span-1057"><span class="mi" id="MathJax-Span-1058" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-1059" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1060" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>d</mi><mi>d</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-134">S_{odd}</script> that for every odd value <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-135-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1061" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1062"><span class="mi" id="MathJax-Span-1063" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-135">x</script>, all the elements in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-136-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1064" style="width: 2.384em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1001.79em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1065"><span class="msubsup" id="MathJax-Span-1066"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1067" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1068"><span class="mrow" id="MathJax-Span-1069"><span class="mi" id="MathJax-Span-1070" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-1071" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1072" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>d</mi><mi>d</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-136">S_{odd}</script> with value <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-137-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1073" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1074"><span class="mi" id="MathJax-Span-1075" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-137">x</script> forms a suffix of all appearances of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-138-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1076" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1077"><span class="mi" id="MathJax-Span-1078" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-138">x</script> in array <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-139-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1079" style="width: 0.76em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1080"><span class="mi" id="MathJax-Span-1081" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-139">a</script>.</p><p>We can define <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-140-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1082" style="width: 2.438em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.843em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1001.84em, 2.546em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1083"><span class="mi" id="MathJax-Span-1084" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="msubsup" id="MathJax-Span-1085"><span style="display: inline-block; position: relative; width: 1.301em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.386em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1086" style="font-family: MathJax_Math-italic;">p</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.49em;"><span class="texatom" id="MathJax-Span-1087"><span class="mrow" id="MathJax-Span-1088"><span class="mi" id="MathJax-Span-1089" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1090" style="font-size: 70.7%; font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1091" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><msub><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-140">dp_{i,j}</script> as the maximum <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-141-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1092" style="width: 10.014em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.578em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1007.47em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1093"><span class="texatom" id="MathJax-Span-1094"><span class="mrow" id="MathJax-Span-1095"><span class="mo" id="MathJax-Span-1096" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-1097"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1098" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1099"><span class="mrow" id="MathJax-Span-1100"><span class="mi" id="MathJax-Span-1101" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-1102" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1103" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="texatom" id="MathJax-Span-1104"><span class="mrow" id="MathJax-Span-1105"><span class="mo" id="MathJax-Span-1106" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-1107" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="texatom" id="MathJax-Span-1108" style="padding-left: 0.219em;"><span class="mrow" id="MathJax-Span-1109"><span class="mo" id="MathJax-Span-1110" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-1111" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.111em;"></span></span><span class="mo" id="MathJax-Span-1112" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1113"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1114" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1115"><span class="mrow" id="MathJax-Span-1116"><span class="mi" id="MathJax-Span-1117" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-1118" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1119" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1120" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1121"><span class="mrow" id="MathJax-Span-1122"><span class="mo" id="MathJax-Span-1123" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>d</mi><mi>d</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>N</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>d</mi><mi>d</mi></mrow></msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-141">|S_{odd}|-|N(S_{odd})|</script> when only considering elements with value <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-142-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1124" style="width: 1.897em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.41em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1001.36em, 2.492em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1125"><span class="mo" id="MathJax-Span-1126" style="font-family: MathJax_Main;">≤</span><span class="mi" id="MathJax-Span-1127" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">i</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.218em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≤</mo><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-142">\leq i</script> in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-143-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1128" style="width: 2.384em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1001.79em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1129"><span class="msubsup" id="MathJax-Span-1130"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1131" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1132"><span class="mrow" id="MathJax-Span-1133"><span class="mi" id="MathJax-Span-1134" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-1135" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1136" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>d</mi><mi>d</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-143">S_{odd}</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-144-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;S&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1137" style="width: 4.602em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.466em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1003.36em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1138"><span class="mi" id="MathJax-Span-1139" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.111em;"></span></span><span class="mo" id="MathJax-Span-1140" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1141"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.65em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1142" style="font-family: MathJax_Math-italic;">S<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1143"><span class="mrow" id="MathJax-Span-1144"><span class="mi" id="MathJax-Span-1145" style="font-size: 70.7%; font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-1146" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1147" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1148" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mo stretchy="false">(</mo><msub><mi>S</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>d</mi><mi>d</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-144">N(S_{odd})</script> (where <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-145-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1149" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1150"><span class="mi" id="MathJax-Span-1151" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-145">i</script> is always odd), and the elements with value <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-146-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1152" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1153"><span class="mi" id="MathJax-Span-1154" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-146">i</script> forms the suffix starting from position <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-147-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1155" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1000.44em, 2.492em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1156"><span class="mi" id="MathJax-Span-1157" style="font-family: MathJax_Math-italic;">j</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-147">j</script>. Since <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-148-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1158" style="width: 3.466em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.6em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1002.55em, 2.654em, -999.997em); top: -2.216em; left: 0em;"><span class="mrow" id="MathJax-Span-1159"><span class="mo" id="MathJax-Span-1160" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span class="mi" id="MathJax-Span-1161" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">c</span><span class="mi" id="MathJax-Span-1162" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1163" style="font-family: MathJax_Math-italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.221em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>∑</mo><mi>c</mi><mi>n</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-148">\sum cnt</script> is bounded by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-149-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1164" style="width: 2.871em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.167em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1002.06em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1165"><span class="mi" id="MathJax-Span-1166" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-1167" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1168" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1169" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-149">O(n)</script>, we have a total of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-150-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1170" style="width: 2.871em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.167em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1002.06em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1171"><span class="mi" id="MathJax-Span-1172" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-1173" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1174" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1175" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-150">O(n)</script> states. The dp transitions between <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-151-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1176" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1177"><span class="mi" id="MathJax-Span-1178" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-151">i</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-152-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1179" style="width: 2.708em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.059em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1002em, 2.438em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1180"><span class="mi" id="MathJax-Span-1181" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1182" style="font-family: MathJax_Main; padding-left: 0.219em;">+</span><span class="mn" id="MathJax-Span-1183" style="font-family: MathJax_Main; padding-left: 0.219em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.211em; border-left: 0px solid; width: 0px; height: 1.146em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mo>+</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-152">i+2</script> can be done easily in linear time, so the total complexity is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-153-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1184" style="width: 2.871em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.167em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1002.06em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1185"><span class="mi" id="MathJax-Span-1186" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-1187" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1188" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1189" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-153">O(n)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
 
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e6</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">5</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">bool</span><span class="pln"> vis</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
vector</span><span class="str">&lt;int&gt;</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">N </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	vector</span><span class="str">&lt;int&gt;</span><span class="pln"> tmp</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">i </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			p </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> o</span><span class="pun">:</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">p </span><span class="pun">&lt;</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> o</span><span class="pun">)</span><span class="pln">
					p</span><span class="pun">++;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">p </span><span class="pun">&lt;</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">].</span><span class="pln">size</span><span class="pun">())</span><span class="pln">
					vis</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">p</span><span class="pun">++]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">else</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			p </span><span class="pun">=</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">].</span><span class="pln">size</span><span class="pun">();</span><span class="pln">
			reverse</span><span class="pun">(</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="kwd">begin</span><span class="pun">(),</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="kwd">end</span><span class="pun">());</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> o</span><span class="pun">:</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">
			</span><span class="pun">{</span><span class="pln">
				</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">p </span><span class="pun">&amp;&amp;</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][</span><span class="pln">p </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> o</span><span class="pun">)</span><span class="pln">
					p</span><span class="pun">--;</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">p</span><span class="pun">)</span><span class="pln">
					vis</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">][--</span><span class="pln">p</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		tmp</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> o</span><span class="pun">:</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">])</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">vis</span><span class="pun">[</span><span class="pln">o</span><span class="pun">])</span><span class="pln">
				ans</span><span class="pun">++;</span><span class="pln">
			</span><span class="kwd">else</span><span class="pln">
				tmp</span><span class="pun">.</span><span class="pln">emplace_back</span><span class="pun">(</span><span class="pln">o</span><span class="pun">);</span><span class="pln">
		pos</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> tmp</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">,</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">t</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
			scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> a </span><span class="pun">+</span><span class="pln"> i</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
			vis</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
			pos</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
			pos</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]].</span><span class="pln">emplace_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
		ans </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
		reverse</span><span class="pun">(</span><span class="pln">a </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> a </span><span class="pun">+</span><span class="pln"> n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
			vis</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
			pos</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
			pos</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]].</span><span class="pln">emplace_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
		ans </span><span class="pun">-=</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln"> ans</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div> <div class="spoiler"><b class="spoiler-title">Solution (Hall-dp)</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><br><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">

</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e6</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">5</span><span class="pun">,</span><span class="pln"> inf </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e9</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln"> lp</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln"> rp</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln"> </span><span class="typ">Lp</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln"> m</span><span class="pun">;</span><span class="pln">
vector</span><span class="str">&lt;int&gt;</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">N </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pun">],</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">N </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pun">],</span><span class="pln"> tmp</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> j</span><span class="pun">,</span><span class="pln"> u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">;</span><span class="pln">
	dp</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">resize</span><span class="pun">(</span><span class="pln">pos</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">size</span><span class="pun">());</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> pos</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="pln">size</span><span class="pun">();</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
		dp</span><span class="pun">[</span><span class="lit">1</span><span class="pun">][</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> m</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		u </span><span class="pun">=</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		v </span><span class="pun">=</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		tmp</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
		tmp</span><span class="pun">.</span><span class="pln">resize</span><span class="pun">(</span><span class="pln">u </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
		dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">].</span><span class="pln">resize</span><span class="pun">(</span><span class="pln">v </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;=</span><span class="pln"> u</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln">
			tmp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> rp</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]];</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">j </span><span class="pun">=</span><span class="pln"> u</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">--)</span><span class="pln">
			tmp</span><span class="pun">[</span><span class="pln">j </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">tmp</span><span class="pun">[</span><span class="pln">j </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">],</span><span class="pln"> tmp</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;=</span><span class="pln"> v</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			p </span><span class="pun">=</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">][</span><span class="pln">j</span><span class="pun">];</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">j</span><span class="pun">)</span><span class="pln">
				dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">][</span><span class="pln">j </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="typ">Lp</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> u</span><span class="pun">)</span><span class="pln">
				dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">][</span><span class="pln">j</span><span class="pun">],</span><span class="pln"> j </span><span class="pun">+</span><span class="pln"> tmp</span><span class="pun">[</span><span class="typ">Lp</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
			dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">][</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">dp</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">][</span><span class="pln">j</span><span class="pun">],</span><span class="pln"> j </span><span class="pun">-</span><span class="pln"> lp</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">][</span><span class="typ">Lp</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]]);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> dp</span><span class="pun">[</span><span class="pln">m</span><span class="pun">].</span><span class="pln">back</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">t</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
		m </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		ans </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> a </span><span class="pun">+</span><span class="pln"> i</span><span class="pun">);</span><span class="pln">
			m </span><span class="pun">=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">m</span><span class="pun">,</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
			ans </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		m </span><span class="pun">|=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> m</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
			pos</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="lit">0</span><span class="pun">};</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			pos</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]].</span><span class="pln">emplace_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
			lp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
			rp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> m </span><span class="pun">?</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
			</span><span class="typ">Lp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		ans </span><span class="pun">+=</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
		reverse</span><span class="pun">(</span><span class="pln">a </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> a </span><span class="pun">+</span><span class="pln"> n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> m</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
			pos</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="lit">0</span><span class="pun">};</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			pos</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]].</span><span class="pln">emplace_back</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
			lp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
			rp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> m </span><span class="pun">?</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
			</span><span class="typ">Lp</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> pos</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">2</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		ans </span><span class="pun">+=</span><span class="pln"> solve</span><span class="pun">();</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln"> ans</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2165/problem/E">2165E — Rainbow Branch</a></p><p>idea &amp; solution: <a class="rated-user user-legendary" href="/profile/Flamire" title="Legendary Grandmaster Flamire"><span class="legendary-user-first-letter">F</span>lamire</a></p><p>Our testers had vastly different opinions on the difficulty on this problems, some were able to solve within 20mins, and others failed to solve within a sufficiently long time. We eventually decided to put it at E, and it seems to have did its work.</p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: none;"><p>The answer is increasing, try solve for the maximum number of colors for a certain inconvenience <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-154-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1190" style="width: 0.76em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1191"><span class="mi" id="MathJax-Span-1192" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-154">d</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: none;"><p>Every color is a connected component.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: none;"><p>There exists a diameter-midpoint like structure.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 4</b><div class="spoiler-content" style="display: none;"><p>The optimal answer has a certain structure, try finding it.</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: none;"><p>We switch the answer and the parameter, and solve for the maximum number of colors for a given diameter <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-155-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1193" style="width: 0.76em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1194"><span class="mi" id="MathJax-Span-1195" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-155">d</script>.</p><p>A simple intuition is that each color should be a connected component, this is also easily provable: If some color is not connected, we can choose one of its "outermost" components (a more rigorous definition would be the leaves of the auxiliary tree of its components), and change it to the color of its adjacent component. In doing this, the number of different components is decreased, and our inconvenience has not increased. Therefore, after enough changes, each color will be a connected component.</p><p>The problem asks for a diameter-like value, therefore, we can try to find a diameter-midpoint-like structure:</p> <ul>   <li>When <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-156-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1196" style="width: 0.76em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1197"><span class="mi" id="MathJax-Span-1198" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-156">d</script> is odd, there exists a color component such that the distance to all other vertices does not exceed <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-157-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1199" style="width: 2.167em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.626em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(0.977em, 1001.63em, 2.654em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1200"><span class="mfrac" id="MathJax-Span-1201"><span style="display: inline-block; position: relative; width: 1.41em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;"><span style="position: absolute; clip: rect(3.358em, 1001.25em, 4.223em, -999.997em); top: -4.489em; left: 50%; margin-left: -0.647em;"><span class="mrow" id="MathJax-Span-1202"><span class="mi" id="MathJax-Span-1203" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1204" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1205" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1000.33em, 4.169em, -999.997em); top: -3.623em; left: 50%; margin-left: -0.16em;"><span class="mn" id="MathJax-Span-1206" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(0.869em, 1001.41em, 1.247em, -999.997em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.41em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.085em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi>d</mi><mo>−</mo><mn>1</mn></mrow><mn>2</mn></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-157">\frac{d-1}2</script>.</li>   <li>When <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-158-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1207" style="width: 0.76em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1208"><span class="mi" id="MathJax-Span-1209" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-158">d</script> is even, there exists a vertex such that the distance to all other vertices does not exceed <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-159-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1210" style="width: 0.923em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.031em, 1000.71em, 2.654em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1211"><span class="mfrac" id="MathJax-Span-1212"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; margin-right: 0.111em; margin-left: 0.111em;"><span style="position: absolute; clip: rect(3.358em, 1000.38em, 4.169em, -999.997em); top: -4.435em; left: 50%; margin-left: -0.16em;"><span class="mi" id="MathJax-Span-1213" style="font-size: 70.7%; font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(3.358em, 1000.33em, 4.169em, -999.997em); top: -3.623em; left: 50%; margin-left: -0.16em;"><span class="mn" id="MathJax-Span-1214" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; clip: rect(0.869em, 1000.49em, 1.247em, -999.997em); top: -1.296em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.49em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.085em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.861em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mi>d</mi><mn>2</mn></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-159">\frac d2</script>.</li> </ul><p>Now, observe that we can "push" colors away from the midpoint and out to the leaves, to increase the number of color used, our optimal solution would look something like this:</p><p><img alt=" " src="/predownloaded/12/54/125496eeb0e48ca5847492df46c65a8dddf79702.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p>Therefore, the optimal solution is:</p> <ul>   <li>For odd <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-160-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1215" style="width: 0.76em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1216"><span class="mi" id="MathJax-Span-1217" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-160">d</script>, remove the outermost <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-161-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1218" style="width: 5.306em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.007em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1003.95em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1219"><span class="mo" id="MathJax-Span-1220" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1221" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1222" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-1223" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span><span class="mo" id="MathJax-Span-1224" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1225"><span class="mrow" id="MathJax-Span-1226"><span class="mo" id="MathJax-Span-1227" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-1228" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>d</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-161">(d-1)/2</script> levels of leaves.</li>   <li>For even <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-162-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1229" style="width: 0.76em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.544em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.54em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1230"><span class="mi" id="MathJax-Span-1231" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi></math></span></span><script type="math/tex" id="MathJax-Element-162">d</script>, remove the outermost <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-163-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1232" style="width: 4.332em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.249em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1003.2em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1233"><span class="mi" id="MathJax-Span-1234" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-1235"><span class="mrow" id="MathJax-Span-1236"><span class="mo" id="MathJax-Span-1237" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-1238" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-1239" style="font-family: MathJax_Main; padding-left: 0.219em;">−</span><span class="mn" id="MathJax-Span-1240" style="font-family: MathJax_Main; padding-left: 0.219em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-163">d/2-1</script> levels of leaves, and choose a maximum degree vertex in the remaining tree.</li> </ul><p>Time Complexity: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-164-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1241" style="width: 5.739em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.332em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1004.22em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1242"><span class="mi" id="MathJax-Span-1243" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-1244" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1245" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1246" style="font-family: MathJax_Main; padding-left: 0.165em;">log</span><span class="mo" id="MathJax-Span-1247"></span><span class="mi" id="MathJax-Span-1248" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">n</span><span class="mo" id="MathJax-Span-1249" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-164">O(n\log n)</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-165-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1250" style="width: 2.871em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.167em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1002.06em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1251"><span class="mi" id="MathJax-Span-1252" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-1253" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1254" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1255" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-165">O(n)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
 
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
 
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3e5</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">5</span><span class="pun">;</span><span class="pln">
vector</span><span class="str">&lt;int&gt;</span><span class="pln"> e</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> val</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln"> deg</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln"> h</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln"> d</span><span class="pun">;</span><span class="pln">
queue</span><span class="str">&lt;int&gt;</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">del</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	cnt</span><span class="pun">[</span><span class="pln">deg</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]]--;</span><span class="pln">
	cnt</span><span class="pun">[--</span><span class="pln">deg</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]]++;</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> deg</span><span class="pun">[</span><span class="pln">x</span><span class="pun">];</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> i</span><span class="pun">,</span><span class="pln"> u</span><span class="pun">,</span><span class="pln"> v</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">,</span><span class="pln"> c</span><span class="pun">;</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">t</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
			e</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			scanf</span><span class="pun">(</span><span class="str">"%d%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">u</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
			e</span><span class="pun">[</span><span class="pln">u</span><span class="pun">].</span><span class="pln">emplace_back</span><span class="pun">(</span><span class="pln">v</span><span class="pun">);</span><span class="pln">
			e</span><span class="pun">[</span><span class="pln">v</span><span class="pun">].</span><span class="pln">emplace_back</span><span class="pun">(</span><span class="pln">u</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			val</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e9</span><span class="pun">;</span><span class="pln">
			cnt</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			h</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
			cnt</span><span class="pun">[</span><span class="pln">deg</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> e</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="pln">size</span><span class="pun">()]++;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">deg</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
				q</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
		c </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		d </span><span class="pun">=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">while</span><span class="pun">(!</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">d</span><span class="pun">])</span><span class="pln">
			d</span><span class="pun">--;</span><span class="pln">
		val</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">val</span><span class="pun">[</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		val</span><span class="pun">[</span><span class="pln">d</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">val</span><span class="pun">[</span><span class="pln">d</span><span class="pun">],</span><span class="pln"> </span><span class="lit">2</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">while</span><span class="pun">(!</span><span class="pln">q</span><span class="pun">.</span><span class="pln">empty</span><span class="pun">())</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			k </span><span class="pun">=</span><span class="pln"> q</span><span class="pun">.</span><span class="pln">front</span><span class="pun">();</span><span class="pln">
			q</span><span class="pun">.</span><span class="pln">pop</span><span class="pun">();</span><span class="pln">
			</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">auto</span><span class="pln"> o</span><span class="pun">:</span><span class="pln"> e</span><span class="pun">[</span><span class="pln">k</span><span class="pun">])</span><span class="pln">
				</span><span class="kwd">if</span><span class="pun">(</span><span class="kwd">del</span><span class="pun">(</span><span class="pln">o</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
				</span><span class="pun">{</span><span class="pln">
					h</span><span class="pun">[</span><span class="pln">o</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> h</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
					q</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">o</span><span class="pun">);</span><span class="pln">
				</span><span class="pun">}</span><span class="pln">
			</span><span class="pun">++</span><span class="pln">c</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">while</span><span class="pun">(!</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">d</span><span class="pun">])</span><span class="pln">
				d</span><span class="pun">--;</span><span class="pln">
			val</span><span class="pun">[</span><span class="pln">c </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">val</span><span class="pun">[</span><span class="pln">c </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">],</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> h</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
			val</span><span class="pun">[</span><span class="pln">c </span><span class="pun">+</span><span class="pln"> d</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">val</span><span class="pun">[</span><span class="pln">c </span><span class="pun">+</span><span class="pln"> d</span><span class="pun">],</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> h</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">--)</span><span class="pln">
			val</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">val</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> val</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
			printf</span><span class="pun">(</span><span class="str">"%d "</span><span class="pun">,</span><span class="pln"> val</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"\n"</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><p><a href="https://codeforces.com/contest/2165/problem/F">2165F — Arctic Acquisition</a></p><p>idea &amp; solution: <a class="rated-user user-legendary" href="/profile/Flamire" title="Legendary Grandmaster Flamire"><span class="legendary-user-first-letter">F</span>lamire</a></p><p>No, we did not propose a paper problem. We knew of the paper on permutation pattern matching in advance, but we assumed the paper would not help much in solving the problem, either due to coding complexity, or constants hidden by the notation that would make it impractical. I'll admit that I did not read the paper in full (procrastination), but from what I gathered, it seemed that understanding the paper would be harder than solving the problem in itself.</p><p>If I am mistaken, please let me know.</p> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: none;"><p>We only need to calculate the minimum <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-166-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1256" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1257"><span class="mi" id="MathJax-Span-1258" style="font-family: MathJax_Math-italic;">r</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-166">r</script> for each <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-167-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1259" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1260"><span class="mi" id="MathJax-Span-1261" style="font-family: MathJax_Math-italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-167">l</script>, try breaking <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-168-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;21435&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1262" style="width: 3.304em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1002.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1263"><span class="mn" id="MathJax-Span-1264" style="font-family: MathJax_Main;">21435</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>21435</mn></math></span></span><script type="math/tex" id="MathJax-Element-168">21435</script> into smaller parts.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: none;"><p>When we fix the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-169-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;21&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1265" style="width: 1.301em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.92em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1266"><span class="mn" id="MathJax-Span-1267" style="font-family: MathJax_Main;">21</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>21</mn></math></span></span><script type="math/tex" id="MathJax-Element-169">21</script>-part, we need to append a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-170-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;435&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1268" style="width: 2.005em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.518em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1001.46em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1269"><span class="mn" id="MathJax-Span-1270" style="font-family: MathJax_Main;">435</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>435</mn></math></span></span><script type="math/tex" id="MathJax-Element-170">435</script>-part such that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-171-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1271" style="width: 6.28em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.765em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1004.76em, 2.492em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1272"><span class="mi" id="MathJax-Span-1273" style="font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-1274" style="font-family: MathJax_Math-italic;">a</span><span class="msubsup" id="MathJax-Span-1275"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1276" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.327em;"><span class="mn" id="MathJax-Span-1277" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1278" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="mi" id="MathJax-Span-1279" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">v</span><span class="mi" id="MathJax-Span-1280" style="font-family: MathJax_Math-italic;">a</span><span class="msubsup" id="MathJax-Span-1281"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1282" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.327em;"><span class="mn" id="MathJax-Span-1283" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi><mi>a</mi><msub><mi>l</mi><mn>3</mn></msub><mo>&gt;</mo><mi>v</mi><mi>a</mi><msub><mi>l</mi><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-171">val_3>val_2</script>, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-172-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1284" style="width: 9.472em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.146em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1007.15em, 2.492em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1285"><span class="mi" id="MathJax-Span-1286" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1287" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1288" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1289" style="font-family: MathJax_Math-italic;">e</span><span class="msubsup" id="MathJax-Span-1290"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1291" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="mn" id="MathJax-Span-1292" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1293" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="mi" id="MathJax-Span-1294" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">i</span><span class="mi" id="MathJax-Span-1295" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1296" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1297" style="font-family: MathJax_Math-italic;">e</span><span class="msubsup" id="MathJax-Span-1298"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1299" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="mn" id="MathJax-Span-1300" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mi>n</mi><mi>d</mi><mi>e</mi><msub><mi>x</mi><mn>4</mn></msub><mo>&gt;</mo><mi>i</mi><mi>n</mi><mi>d</mi><mi>e</mi><msub><mi>x</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-172">index_4>index_1</script>. (Here the footnotes refer to the value order, rather than index order.)</p><p>Therefore, we need to find <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-173-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;435&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1301" style="width: 2.005em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.518em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1001.46em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1302"><span class="mn" id="MathJax-Span-1303" style="font-family: MathJax_Main;">435</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>435</mn></math></span></span><script type="math/tex" id="MathJax-Element-173">435</script>-subsequences that are Left-Right-Min minimal, that is, there does not exist another <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-174-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;435&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1304" style="width: 2.005em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.518em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1001.46em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1305"><span class="mn" id="MathJax-Span-1306" style="font-family: MathJax_Main;">435</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>435</mn></math></span></span><script type="math/tex" id="MathJax-Element-174">435</script>-subsequence that is better in all three aspects.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: none;"><p>The number of such <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-175-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;435&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1307" style="width: 2.005em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.518em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1001.46em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1308"><span class="mn" id="MathJax-Span-1309" style="font-family: MathJax_Main;">435</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>435</mn></math></span></span><script type="math/tex" id="MathJax-Element-175">435</script>-subsequences is small. Try analyzing what kind of subsequence are minimal.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 4</b><div class="spoiler-content" style="display: none;"><p>Perform scanline on the value of "<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-176-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1310" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1311"><span class="mn" id="MathJax-Span-1312" style="font-family: MathJax_Main;">3</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>3</mn></math></span></span><script type="math/tex" id="MathJax-Element-176">3</script>" from large to small, at most one <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-177-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;435&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1313" style="width: 2.005em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.518em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1001.46em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1314"><span class="mn" id="MathJax-Span-1315" style="font-family: MathJax_Main;">435</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>435</mn></math></span></span><script type="math/tex" id="MathJax-Element-177">435</script> will be added each time.</p></div></div> <div class="spoiler"><b class="spoiler-title">Tutorial</b><div class="spoiler-content" style="display: none;"><p>It suffices to find the minimal <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-178-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1316" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1317"><span class="mi" id="MathJax-Span-1318" style="font-family: MathJax_Math-italic;">r</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-178">r</script> such that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-179-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;[&lt;/mo&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;]&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1319" style="width: 2.33em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.734em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1001.63em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1320"><span class="mo" id="MathJax-Span-1321" style="font-family: MathJax_Main;">[</span><span class="mi" id="MathJax-Span-1322" style="font-family: MathJax_Math-italic;">l</span><span class="mo" id="MathJax-Span-1323" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1324" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">r</span><span class="mo" id="MathJax-Span-1325" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mi>l</mi><mo>,</mo><mi>r</mi><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-179">[l,r]</script> contains a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-180-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;21435&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1326" style="width: 3.304em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.492em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1002.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1327"><span class="mn" id="MathJax-Span-1328" style="font-family: MathJax_Main;">21435</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>21435</mn></math></span></span><script type="math/tex" id="MathJax-Element-180">21435</script>-avoiding subsequence for every <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-181-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1329" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1330"><span class="mi" id="MathJax-Span-1331" style="font-family: MathJax_Math-italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-181">l</script>.</p><p>We will refer to the elements by value order, instead of index order, in the following text, i.e. "<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-182-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1332" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1333"><span class="mn" id="MathJax-Span-1334" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-182">2</script>"-element refers to the leftmost element, with the second smallest value.</p><p>When we have fixed <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-183-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1335" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1336"><span class="mi" id="MathJax-Span-1337" style="font-family: MathJax_Math-italic;">l</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-183">l</script>, the "<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-184-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1338" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1339"><span class="mn" id="MathJax-Span-1340" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-184">2</script>"-element will be fixed, the "<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-185-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1341" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1342"><span class="mn" id="MathJax-Span-1343" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-185">1</script>"-element will just be the next element that is smaller than it, therefore, we only need to append a <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-186-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;435&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1344" style="width: 2.005em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.518em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1001.46em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1345"><span class="mn" id="MathJax-Span-1346" style="font-family: MathJax_Main;">435</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>435</mn></math></span></span><script type="math/tex" id="MathJax-Element-186">435</script>-subsequence to it.</p><p>As we need to minimize <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-187-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1347" style="width: 0.598em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.436em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.44em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1348"><span class="mi" id="MathJax-Span-1349" style="font-family: MathJax_Math-italic;">r</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>r</mi></math></span></span><script type="math/tex" id="MathJax-Element-187">r</script>, and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-188-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1350" style="width: 16.291em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.34em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1012.34em, 2.546em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1351"><span class="mi" id="MathJax-Span-1352" style="font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-1353" style="font-family: MathJax_Math-italic;">a</span><span class="msubsup" id="MathJax-Span-1354"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1355" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.327em;"><span class="mn" id="MathJax-Span-1356" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1357" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="mi" id="MathJax-Span-1358" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">v</span><span class="mi" id="MathJax-Span-1359" style="font-family: MathJax_Math-italic;">a</span><span class="msubsup" id="MathJax-Span-1360"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1361" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.327em;"><span class="mn" id="MathJax-Span-1362" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1363" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1364" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">i</span><span class="mi" id="MathJax-Span-1365" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1366" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1367" style="font-family: MathJax_Math-italic;">e</span><span class="msubsup" id="MathJax-Span-1368"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1369" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="mn" id="MathJax-Span-1370" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1371" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="mi" id="MathJax-Span-1372" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">i</span><span class="mi" id="MathJax-Span-1373" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1374" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1375" style="font-family: MathJax_Math-italic;">e</span><span class="msubsup" id="MathJax-Span-1376"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1377" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="mn" id="MathJax-Span-1378" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.354em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi><mi>a</mi><msub><mi>l</mi><mn>3</mn></msub><mo>&gt;</mo><mi>v</mi><mi>a</mi><msub><mi>l</mi><mn>2</mn></msub><mo>,</mo><mi>i</mi><mi>n</mi><mi>d</mi><mi>e</mi><msub><mi>x</mi><mn>4</mn></msub><mo>&gt;</mo><mi>i</mi><mi>n</mi><mi>d</mi><mi>e</mi><msub><mi>x</mi><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-188">val_3>val_2,index_4>index_1</script> should be satisfied, we will need to consider all Left-Right-Min minimal <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-189-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;435&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1379" style="width: 2.005em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.518em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1001.46em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1380"><span class="mn" id="MathJax-Span-1381" style="font-family: MathJax_Main;">435</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>435</mn></math></span></span><script type="math/tex" id="MathJax-Element-189">435</script>'s, that is, the ones where there does not exist another <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-190-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;435&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1382" style="width: 2.005em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.518em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1001.46em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1383"><span class="mn" id="MathJax-Span-1384" style="font-family: MathJax_Main;">435</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>435</mn></math></span></span><script type="math/tex" id="MathJax-Element-190">435</script> that is better in all three aspects.</p><p>To analyze this, we can try performing scanline on the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-191-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1385" style="width: 2.33em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.734em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1001.73em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1386"><span class="mi" id="MathJax-Span-1387" style="font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-1388" style="font-family: MathJax_Math-italic;">a</span><span class="msubsup" id="MathJax-Span-1389"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1390" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.327em;"><span class="mn" id="MathJax-Span-1391" style="font-size: 70.7%; font-family: MathJax_Main;">3</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 1.289em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi><mi>a</mi><msub><mi>l</mi><mn>3</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-191">val_3</script> from large to small, we can perform some substitutions to reduce the number of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-192-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;435&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1392" style="width: 2.005em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.518em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1001.46em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1393"><span class="mn" id="MathJax-Span-1394" style="font-family: MathJax_Main;">435</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>435</mn></math></span></span><script type="math/tex" id="MathJax-Element-192">435</script>'s we need to consider.</p><p>Through this, we can find a surprisingly strong restriction on minimal <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-193-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;435&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1395" style="width: 2.005em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.518em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1001.46em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1396"><span class="mn" id="MathJax-Span-1397" style="font-family: MathJax_Main;">435</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>435</mn></math></span></span><script type="math/tex" id="MathJax-Element-193">435</script>'s: For each <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-194-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1398" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1399"><span class="mi" id="MathJax-Span-1400" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-194">i</script> being considered as the "<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-195-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1401" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1402"><span class="mn" id="MathJax-Span-1403" style="font-family: MathJax_Main;">3</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>3</mn></math></span></span><script type="math/tex" id="MathJax-Element-195">3</script>"-element, the "<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-196-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1404" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1405"><span class="mn" id="MathJax-Span-1406" style="font-family: MathJax_Main;">5</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>5</mn></math></span></span><script type="math/tex" id="MathJax-Element-196">5</script>"-element must be <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-197-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1407" style="width: 3.52em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.654em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1002.55em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1408"><span class="mi" id="MathJax-Span-1409" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1410" style="font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-1411" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1412" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1413" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1414" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mi>x</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-197">nxt(i)</script>, the closest element to the right of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-198-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1415" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1416"><span class="mi" id="MathJax-Span-1417" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-198">i</script>, with value greater than <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-199-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1418" style="width: 1.139em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.87em, 2.438em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1419"><span class="msubsup" id="MathJax-Span-1420"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.49em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1421" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.544em;"><span class="mi" id="MathJax-Span-1422" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.282em; border-left: 0px solid; width: 0px; height: 0.932em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-199">a_i</script>.</p><p>We perform substitutions as follows:</p><p><img alt=" " src="/predownloaded/0c/f3/0cf36d8c5e3c93c6c85a8ac91ef191898bf411ac.png" style="max-width: 100.0%;max-height: 100.0%;"></p><p>The three cases corresponds to:</p> <ul>   <li>Left: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-200-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1423" style="width: 8.39em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.334em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1006.33em, 2.708em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1424"><span class="mi" id="MathJax-Span-1425" style="font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-1426" style="font-family: MathJax_Math-italic;">a</span><span class="msubsup" id="MathJax-Span-1427"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1428" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.327em;"><span class="mn" id="MathJax-Span-1429" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1430" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="mi" id="MathJax-Span-1431" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">v</span><span class="mi" id="MathJax-Span-1432" style="font-family: MathJax_Math-italic;">a</span><span class="msubsup" id="MathJax-Span-1433"><span style="display: inline-block; position: relative; width: 2.275em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1434" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.327em;"><span class="texatom" id="MathJax-Span-1435"><span class="mrow" id="MathJax-Span-1436"><span class="mi" id="MathJax-Span-1437" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1438" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-1439" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1440" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1441" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1442" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi><mi>a</mi><msub><mi>l</mi><mn>5</mn></msub><mo>&lt;</mo><mi>v</mi><mi>a</mi><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>x</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-200">val_5<val_{nxt(i)}</script>, by definition, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-201-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1443" style="width: 11.529em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.715em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1008.72em, 2.708em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1444"><span class="mi" id="MathJax-Span-1445" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-1446" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1447" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1448" style="font-family: MathJax_Math-italic;">e</span><span class="msubsup" id="MathJax-Span-1449"><span style="display: inline-block; position: relative; width: 0.977em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1450" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="mn" id="MathJax-Span-1451" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1452" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="mi" id="MathJax-Span-1453" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">i</span><span class="mi" id="MathJax-Span-1454" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1455" style="font-family: MathJax_Math-italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-1456" style="font-family: MathJax_Math-italic;">e</span><span class="msubsup" id="MathJax-Span-1457"><span style="display: inline-block; position: relative; width: 2.546em; height: 0px;"><span style="position: absolute; clip: rect(3.412em, 1000.54em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1458" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.598em;"><span class="texatom" id="MathJax-Span-1459"><span class="mrow" id="MathJax-Span-1460"><span class="mi" id="MathJax-Span-1461" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1462" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-1463" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1464" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1465" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1466" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mi>n</mi><mi>d</mi><mi>e</mi><msub><mi>x</mi><mn>5</mn></msub><mo>&gt;</mo><mi>i</mi><mi>n</mi><mi>d</mi><mi>e</mi><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>x</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-201">index_5>index_{nxt(i)}</script>, substitute "<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-202-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1467" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1468"><span class="mn" id="MathJax-Span-1469" style="font-family: MathJax_Main;">5</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>5</mn></math></span></span><script type="math/tex" id="MathJax-Element-202">5</script>" by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-203-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1470" style="width: 3.52em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.654em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1002.55em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1471"><span class="mi" id="MathJax-Span-1472" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1473" style="font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-1474" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1475" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1476" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1477" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mi>x</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-203">nxt(i)</script>.</li>   <li>Middle: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-204-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1478" style="width: 17.319em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.098em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1013.1em, 2.708em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1479"><span class="mi" id="MathJax-Span-1480" style="font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-1481" style="font-family: MathJax_Math-italic;">a</span><span class="msubsup" id="MathJax-Span-1482"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1483" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.327em;"><span class="mn" id="MathJax-Span-1484" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1485" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="mi" id="MathJax-Span-1486" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">v</span><span class="mi" id="MathJax-Span-1487" style="font-family: MathJax_Math-italic;">a</span><span class="msubsup" id="MathJax-Span-1488"><span style="display: inline-block; position: relative; width: 2.275em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1489" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.327em;"><span class="texatom" id="MathJax-Span-1490"><span class="mrow" id="MathJax-Span-1491"><span class="mi" id="MathJax-Span-1492" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1493" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-1494" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1495" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1496" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1497" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1498" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1499" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">v</span><span class="mi" id="MathJax-Span-1500" style="font-family: MathJax_Math-italic;">a</span><span class="msubsup" id="MathJax-Span-1501"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1502" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.327em;"><span class="mn" id="MathJax-Span-1503" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1504" style="font-family: MathJax_Main; padding-left: 0.273em;">&lt;</span><span class="mi" id="MathJax-Span-1505" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">v</span><span class="mi" id="MathJax-Span-1506" style="font-family: MathJax_Math-italic;">a</span><span class="msubsup" id="MathJax-Span-1507"><span style="display: inline-block; position: relative; width: 2.275em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1508" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.327em;"><span class="texatom" id="MathJax-Span-1509"><span class="mrow" id="MathJax-Span-1510"><span class="mi" id="MathJax-Span-1511" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1512" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-1513" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1514" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1515" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1516" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi><mi>a</mi><msub><mi>l</mi><mn>5</mn></msub><mo>&gt;</mo><mi>v</mi><mi>a</mi><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>x</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msub><mo>,</mo><mi>v</mi><mi>a</mi><msub><mi>l</mi><mn>4</mn></msub><mo>&lt;</mo><mi>v</mi><mi>a</mi><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>x</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-204">val_5>val_{nxt(i)},val_4<val_{nxt(i)}</script>, substitute "<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-205-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1517" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1518"><span class="mn" id="MathJax-Span-1519" style="font-family: MathJax_Main;">5</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>5</mn></math></span></span><script type="math/tex" id="MathJax-Element-205">5</script>" by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-206-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1520" style="width: 3.52em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.654em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1002.55em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1521"><span class="mi" id="MathJax-Span-1522" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1523" style="font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-1524" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1525" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1526" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1527" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mi>x</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-206">nxt(i)</script>.</li>   <li>Right: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-207-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1528" style="width: 17.319em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.098em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1013.1em, 2.708em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1529"><span class="mi" id="MathJax-Span-1530" style="font-family: MathJax_Math-italic;">v</span><span class="mi" id="MathJax-Span-1531" style="font-family: MathJax_Math-italic;">a</span><span class="msubsup" id="MathJax-Span-1532"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1533" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.327em;"><span class="mn" id="MathJax-Span-1534" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1535" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="mi" id="MathJax-Span-1536" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">v</span><span class="mi" id="MathJax-Span-1537" style="font-family: MathJax_Math-italic;">a</span><span class="msubsup" id="MathJax-Span-1538"><span style="display: inline-block; position: relative; width: 2.275em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1539" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.327em;"><span class="texatom" id="MathJax-Span-1540"><span class="mrow" id="MathJax-Span-1541"><span class="mi" id="MathJax-Span-1542" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1543" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-1544" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1545" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1546" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1547" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1548" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1549" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">v</span><span class="mi" id="MathJax-Span-1550" style="font-family: MathJax_Math-italic;">a</span><span class="msubsup" id="MathJax-Span-1551"><span style="display: inline-block; position: relative; width: 0.706em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1552" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.327em;"><span class="mn" id="MathJax-Span-1553" style="font-size: 70.7%; font-family: MathJax_Main;">4</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span><span class="mo" id="MathJax-Span-1554" style="font-family: MathJax_Main; padding-left: 0.273em;">&gt;</span><span class="mi" id="MathJax-Span-1555" style="font-family: MathJax_Math-italic; padding-left: 0.273em;">v</span><span class="mi" id="MathJax-Span-1556" style="font-family: MathJax_Math-italic;">a</span><span class="msubsup" id="MathJax-Span-1557"><span style="display: inline-block; position: relative; width: 2.275em; height: 0px;"><span style="position: absolute; clip: rect(3.141em, 1000.27em, 4.169em, -999.997em); top: -4.002em; left: 0em;"><span class="mi" id="MathJax-Span-1558" style="font-family: MathJax_Math-italic;">l</span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.327em;"><span class="texatom" id="MathJax-Span-1559"><span class="mrow" id="MathJax-Span-1560"><span class="mi" id="MathJax-Span-1561" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1562" style="font-size: 70.7%; font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-1563" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1564" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1565" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1566" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.007em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.568em; border-left: 0px solid; width: 0px; height: 1.575em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi><mi>a</mi><msub><mi>l</mi><mn>5</mn></msub><mo>&gt;</mo><mi>v</mi><mi>a</mi><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>x</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msub><mo>,</mo><mi>v</mi><mi>a</mi><msub><mi>l</mi><mn>4</mn></msub><mo>&gt;</mo><mi>v</mi><mi>a</mi><msub><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>x</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-207">val_5>val_{nxt(i)},val_4>val_{nxt(i)}</script>, substitute <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-208-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1567" style="width: 0.436em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.327em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1000.27em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1568"><span class="mi" id="MathJax-Span-1569" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-208">i</script> by <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-209-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1570" style="width: 3.52em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.654em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1002.55em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1571"><span class="mi" id="MathJax-Span-1572" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1573" style="font-family: MathJax_Math-italic;">x</span><span class="mi" id="MathJax-Span-1574" style="font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-1575" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1576" style="font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1577" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mi>x</mi><mi>t</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-209">nxt(i)</script>.</li> </ul><p>When "<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-210-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1578" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1579"><span class="mn" id="MathJax-Span-1580" style="font-family: MathJax_Main;">3</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>3</mn></math></span></span><script type="math/tex" id="MathJax-Element-210">3</script>" and "<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-211-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1581" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.356em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1582"><span class="mn" id="MathJax-Span-1583" style="font-family: MathJax_Main;">5</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>5</mn></math></span></span><script type="math/tex" id="MathJax-Element-211">5</script>" are fixed, "<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-212-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1584" style="width: 0.652em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.49em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1000.44em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1585"><span class="mn" id="MathJax-Span-1586" style="font-family: MathJax_Main;">4</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>4</mn></math></span></span><script type="math/tex" id="MathJax-Element-212">4</script>" is also fixed. Therefore, there are at most <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-213-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1587" style="width: 0.814em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.598em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.518em, 1000.6em, 2.275em, -999.997em); top: -2.108em; left: 0em;"><span class="mrow" id="MathJax-Span-1588"><span class="mi" id="MathJax-Span-1589" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.113em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 0.718em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-213">n</script> minimal <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-214-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;435&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1590" style="width: 2.005em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.518em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1001.46em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1591"><span class="mn" id="MathJax-Span-1592" style="font-family: MathJax_Main;">435</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>435</mn></math></span></span><script type="math/tex" id="MathJax-Element-214">435</script>'s, and they can be found by simple data structure techniques.</p><p>After finding the minimal <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-215-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;435&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1593" style="width: 2.005em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.518em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.301em, 1001.46em, 2.33em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1594"><span class="mn" id="MathJax-Span-1595" style="font-family: MathJax_Main;">435</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.068em; border-left: 0px solid; width: 0px; height: 1.075em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>435</mn></math></span></span><script type="math/tex" id="MathJax-Element-215">435</script>'s, the problem can be reduced to simple 2D-queries.</p><p>Time Complexity: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-216-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1596" style="width: 5.739em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.332em; height: 0px; font-size: 132%;"><span style="position: absolute; clip: rect(1.247em, 1004.22em, 2.6em, -999.997em); top: -2.162em; left: 0em;"><span class="mrow" id="MathJax-Span-1597"><span class="mi" id="MathJax-Span-1598" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-1599" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1600" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-1601" style="font-family: MathJax_Main; padding-left: 0.165em;">log</span><span class="mo" id="MathJax-Span-1602"></span><span class="mi" id="MathJax-Span-1603" style="font-family: MathJax_Math-italic; padding-left: 0.165em;">n</span><span class="mo" id="MathJax-Span-1604" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.167em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.425em; border-left: 0px solid; width: 0px; height: 1.432em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-216">O(n\log n)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: none;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln">bits</span><span class="pun">/</span><span class="pln">stdc</span><span class="pun">++.</span><span class="pln">h</span><span class="pun">&gt;</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> N </span><span class="lit">1000011</span><span class="pln">
</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">,</span><span class="pln">n</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln">id</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> R</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">struct</span><span class="pln"> sgt
</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> D</span><span class="pun">,</span><span class="pln">mx</span><span class="pun">[</span><span class="pln">N</span><span class="pun">*</span><span class="lit">4</span><span class="pun">];</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> query</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> l</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		l</span><span class="pun">+=</span><span class="pln">D</span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln">r</span><span class="pun">+=</span><span class="pln">D</span><span class="pun">+</span><span class="lit">1</span><span class="pun">;</span><span class="kwd">int</span><span class="pln"> ans</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">l</span><span class="pun">^</span><span class="pln">r</span><span class="pun">^</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(!(</span><span class="pln">l</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">))</span><span class="pln">ans</span><span class="pun">=</span><span class="pln">max</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">,</span><span class="pln">mx</span><span class="pun">[</span><span class="pln">l</span><span class="pun">^</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">r</span><span class="pun">&amp;</span><span class="lit">1</span><span class="pun">)</span><span class="pln">ans</span><span class="pun">=</span><span class="pln">max</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">,</span><span class="pln">mx</span><span class="pun">[</span><span class="pln">r</span><span class="pun">^</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
			l</span><span class="pun">&gt;&gt;=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">r</span><span class="pun">&gt;&gt;=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">return</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">void</span><span class="pln"> modi</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		k</span><span class="pun">+=</span><span class="pln">D</span><span class="pun">;</span><span class="pln">mx</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]=</span><span class="pln">p</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">k</span><span class="pun">&gt;&gt;=</span><span class="lit">1</span><span class="pun">)</span><span class="pln">mx</span><span class="pun">[</span><span class="pln">k</span><span class="pun">]=</span><span class="pln">max</span><span class="pun">(</span><span class="pln">mx</span><span class="pun">[</span><span class="pln">k</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">],</span><span class="pln">mx</span><span class="pun">[</span><span class="pln">k</span><span class="pun">&lt;&lt;</span><span class="lit">1</span><span class="pun">|</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">void</span><span class="pln"> clear</span><span class="pun">()</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		D</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">D</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">+</span><span class="lit">10</span><span class="pun">)</span><span class="pln">D</span><span class="pun">&lt;&lt;=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="pln">D</span><span class="pun">+</span><span class="pln">D</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">mx</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">T1</span><span class="pun">,</span><span class="pln">T2</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> pl</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln">res</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln">curr</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> </span><span class="typ">Rmn</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">void</span><span class="pln"> proc</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">R</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="typ">Rmn</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">i</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">id</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]=</span><span class="pln">i</span><span class="pun">,</span><span class="pln">pl</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">;--</span><span class="pln">i</span><span class="pun">)</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">R</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]&lt;=</span><span class="pln">n</span><span class="pun">&amp;&amp;</span><span class="pln">a</span><span class="pun">[</span><span class="pln">R</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]&lt;</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="pln">R</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">R</span><span class="pun">[</span><span class="pln">R</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]];</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">;--</span><span class="pln">i</span><span class="pun">)</span><span class="kwd">while</span><span class="pun">(</span><span class="typ">Rmn</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]&lt;=</span><span class="pln">n</span><span class="pun">&amp;&amp;</span><span class="pln">a</span><span class="pun">[</span><span class="typ">Rmn</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]&gt;</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])</span><span class="typ">Rmn</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="typ">Rmn</span><span class="pun">[</span><span class="typ">Rmn</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]];</span><span class="pln">
	T1</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">R</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]&lt;=</span><span class="pln">n</span><span class="pun">)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">=</span><span class="pln">T1</span><span class="pun">.</span><span class="pln">query</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">a</span><span class="pun">[</span><span class="pln">R</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
			pl</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">k</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		T1</span><span class="pun">.</span><span class="pln">modi</span><span class="pun">(</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	T2</span><span class="pun">.</span><span class="pln">clear</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">curr</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">res</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="pln">n</span><span class="pun">;</span><span class="pln">i</span><span class="pun">;--</span><span class="pln">i</span><span class="pun">)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">=</span><span class="pln">id</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln">y</span><span class="pun">=</span><span class="typ">Rmn</span><span class="pun">[</span><span class="pln">x</span><span class="pun">];</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">y</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">)</span><span class="pln">
		</span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">int</span><span class="pln"> rr</span><span class="pun">=</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">-</span><span class="pln">T2</span><span class="pun">.</span><span class="pln">query</span><span class="pun">(</span><span class="pln">y</span><span class="pun">+</span><span class="lit">1</span><span class="pun">,</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
			</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">rr</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">)</span><span class="pln">res</span><span class="pun">[</span><span class="pln">rr</span><span class="pun">]=</span><span class="pln">max</span><span class="pun">(</span><span class="pln">res</span><span class="pun">[</span><span class="pln">rr</span><span class="pun">],</span><span class="pln">x</span><span class="pun">);</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">pl</span><span class="pun">[</span><span class="pln">x</span><span class="pun">])</span><span class="pln">T2</span><span class="pun">.</span><span class="pln">modi</span><span class="pun">(</span><span class="pln">pl</span><span class="pun">[</span><span class="pln">x</span><span class="pun">],</span><span class="pln">curr</span><span class="pun">[</span><span class="pln">pl</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]]=</span><span class="pln">max</span><span class="pun">(</span><span class="pln">curr</span><span class="pun">[</span><span class="pln">pl</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]],</span><span class="pln">n</span><span class="pun">+</span><span class="lit">1</span><span class="pun">-</span><span class="pln">R</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]));</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">res</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]=</span><span class="pln">max</span><span class="pun">(</span><span class="pln">res</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln">res</span><span class="pun">[</span><span class="pln">i</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,&amp;</span><span class="pln">T</span><span class="pun">);</span><span class="kwd">while</span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln">
	</span><span class="pun">{</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,&amp;</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln">a</span><span class="pun">+</span><span class="pln">i</span><span class="pun">);</span><span class="pln">
		proc</span><span class="pun">();</span><span class="pln">
		</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ans</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;=</span><span class="pln">n</span><span class="pun">;++</span><span class="pln">i</span><span class="pun">)</span><span class="pln">ans</span><span class="pun">+=</span><span class="pln">res</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"%lld\n"</span><span class="pun">,</span><span class="pln">ans</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="/contest/2165" class="notice" style="text-decoration: none;">Codeforces Round 1064 (Div. 1)</a> </span>
        </div>
        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="/contest/2166" class="notice" style="text-decoration: none;">Codeforces Round 1064 (Div. 2)</a> </span>
        </div>
        
            <script type="text/javascript">
    $(document).ready(function () {
        $(".delete-resource-link-120401-149093").click(function() {
            var that = this;
            Codeforces.confirm("Are you sure you want to detach a contest?", function () {
                $.post("/data/blogAndContest", {
                    action: "detachBlogFromContest",
                    blogId: "120401",
                    blogEntryId: "148452",
                    contestId: $(that).attr("data-contestId"),
                    resourceIds: $(that).attr("data-resourceIds")
                }, function(json) {        
                    Codeforces.reloadAndShowMessageOrShowError(json, "Contest detached");
                });
            }, function () {}, "Yes", "No");
        });
    });
</script>
        



    <div class="roundbox meta borderTopRound borderBottomRound" style="">
        <div class="left-meta">
            <ul>
                    <li style="line-height: 1.6em;">        <a href="#" class="topic-vote-up-149093"><img style="vertical-align:middle;position:relative;top:-0.2em" src="//codeforces.com/codeforces.org/s/52448/images/actions/voteup-gray.png" alt="Vote: I like it" title="Vote: I like it"></a>


</li>
                    <li style="line-height: 1.6em;">

        
        <span class="topic-rating topic-rating-149093" title="Topic rating" data-topicid="149093" data-rawrating="203" style="font-size:larger;position:relative;bottom:1px;font-weight:bold;color:green">+203</span>
        
</li>
                    <li style="line-height: 1.6em;">        <a href="#" class="topic-vote-down-149093"><img style="vertical-align:middle;position:relative;top:-0.2em" src="//codeforces.com/codeforces.org/s/52448/images/actions/votedown-gray.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>


</li>
            </ul>
        </div>


            <span style="position: relative; line-height: 1.65em; top: 0.75rem; left: 0.8em;">
            </span>

        <div class="right-meta">
            <ul>
                    <li>        <a href="/profile/Flamire"><img style="vertical-align:middle;position:relative;top:-1px" src="//codeforces.com/codeforces.org/s/52448/images/blog/user_16x16.png" alt="Author" title="Author"></a>


        <a href="/profile/Flamire">
        Flamire
        </a>
</li>
                    <li>        <img style="vertical-align:middle;position:relative;top:-1px" src="//codeforces.com/codeforces.org/s/52448/images/blog/date_16x16.png" alt="Publication date" title="Publication date">


        
        <span class="format-humantime" title="Nov/17/2025 09:12 UTC">4 weeks ago</span>
        
</li>
                    <li>        <a href="/blog/entry/148452#comments"><img style="vertical-align:middle;position:relative;top:-1px" src="//codeforces.com/codeforces.org/s/52448/images/blog/comments_16x16.png" alt="Comments" title="Comments"></a>


        <a href="/blog/entry/148452#comments">
        27
        </a>
</li>
            </ul>
        </div>

        <br style="clear:both;">
    </div>


<style type="text/css">
    .comments .title {
        float: left;
    }

    .comments .comments-actions-div {
        float: right;
        margin-top: 3rem;
        margin-right: 0.5em;
    }

    .comments .comments-actions-div .separator {
        margin: 0 1rem;
    }

    .comments label.show-archived {
    }

    .comments label.show-archived, .comments label.show-archived * {
        font-size: 1.4rem !important;
        color: black !important;
        /*position: relative !important;*/
        /*bottom: 0.4rem !important;*/
    }

    .comments label.show-archived input {
        height: 1.4rem !important;
        width: 1.4rem !important;
        position: relative;
        top: 0.25rem;
    }

    .new-root-comment {
        font-size: 1.4rem !important;
    }
</style>

    <div class="comments" commentableid="163879">
        <div style="display: flow-root">
            <div class="title">
                <img src="//codeforces.com/codeforces.org/s/52448/images/icons/comments-48x48.png" alt="Comments" title="Comments" style="position:relative;top:0.6em;">
                <a name="comments">Comments (27)</a>

            </div>
            <div class="comments-actions-div">
                <a href="#" class="new-root-comment">Write comment?</a>
            </div>
        </div>

<div class="comment" commentid="1326610">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1326610" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/123gjweq2" title="Master 123gjweq2" class="rated-user user-orange">123gjweq2</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 09:16 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1326610" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/123gjweq2" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3361150/avatar/d0ddb6bbaeb86990.jpg">        </a>
        <div><a href="/profile/123gjweq2" title="Master 123gjweq2" class="rated-user user-orange">123gjweq2</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 09:16 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1326610" href="?#comment-1326610" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1326610" revisioncount="3" revision="3">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">3</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1326610" class="CommentVoteFrame" myvotedirection="0" data-commentrating="-89" data-commentuserid="3361150" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-89</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1326610">
                        <div class="moveup">
                        <div class="ttypography"><p>first.</p><p>By the way, I was sure that there was some sort of pattern in the problem names, but I could not figure it out. Maybe there is, if there is I just don't see it. But I do think that the name of C. Binary Wine does not fit in with the other names.</p><p>First of all, all of the names except for Binary Wine and Arctic Acquisition afaik stand for common competitive programming things when said forward or in reverse.</p><p>Same Difference = Data Structures</p><p>Tab Closing = Time Complexity</p><p>Cyclic Merging = Candidate Master</p><p>Marble Council = ^</p><p>Binary Wine = ???</p><p>Path Split = Shortest Path</p><p>Rainbow Branch = Regular Bracket (sequence)</p><p>Arctic Acquisition = Alcoholics Anonymous..?</p><p>So from here it looks like Arctic Acquisition and Binary Wine don't belong. However, we can insert the common beginning vowel in Arctic Acquisition into the middle of the acronyms of the other titles (and possibly reverse the result to get these):</p><p>SAD, CAT, CAM, MAC, SAP, BAR</p><p>but then for Binary Wine neither BAW or WAB is a word.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1326610 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1326610 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1326610">
        </ul>
    </div>
</div>

<div class="comment" commentid="1326617">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1326617" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Nyemot" title="Candidate Master Nyemot" class="rated-user user-violet">Nyemot</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 09:22 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1326617" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Nyemot" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/Nyemot" title="Candidate Master Nyemot" class="rated-user user-violet">Nyemot</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 09:22 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1326617" href="?#comment-1326617" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1326617" class="CommentVoteFrame" myvotedirection="0" data-commentrating="37" data-commentuserid="2794085" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+37</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1326617">
                        <div class="moveup">
                        <div class="ttypography"><p>D2C/D1A, <br></p> <blockquote><p>"We expected participants to pass using doubly linked list, ..."</p> </blockquote><p>But the solution didn't use doubly linked list.<br> Another day of linked list being forgotten.<br> <img alt="It's over meme" src="/predownloaded/bf/d9/bfd9446d6ba43a8e4a6859ae2db1d7097a7ddddf.gif" style="max-width: 100.0%;max-height: 100.0%;"></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1326617 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1326617 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1326617">
        </ul>
    </div>
</div>

<div class="comment" commentid="1326630">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1326630" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/zhuquanlin" title="Specialist zhuquanlin" class="rated-user user-cyan">zhuquanlin</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 09:39 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">2</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1326630" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/zhuquanlin" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3621958/avatar/a89366a7c66cba47.jpg">        </a>
        <div><a href="/profile/zhuquanlin" title="Specialist zhuquanlin" class="rated-user user-cyan">zhuquanlin</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 09:39 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1326630" href="?#comment-1326630" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1326630" class="CommentVoteFrame" myvotedirection="0" data-commentrating="5" data-commentuserid="3621958" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1326630">
                        <div class="moveup">
                        <div class="ttypography"><p>I think D2E is easier than D2D,it's solution more natually. And I used doubly linked lists in D2C,it's obviously harder to code.The official solution is better </p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1326630 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1326630 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1326630">
                <li>
<div class="comment" commentid="1326704">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1326704" commentparentid="1326630">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/esh_war2" title="Pupil esh_war2" class="rated-user user-green">esh_war2</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 13:48 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1326704" commentparentid="1326630">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/esh_war2" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/esh_war2" title="Pupil esh_war2" class="rated-user user-green">esh_war2</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 13:48 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1326704" href="?#comment-1326704" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1326630" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1326704" class="CommentVoteFrame" myvotedirection="0" data-commentrating="4" data-commentuserid="3754662" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+4</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1326704">
                        <div class="moveup">
                        <div class="ttypography"><p>harder to code but coming up with that fancy logic is tougher than implementing a double linked list if you have some practice before of DLL.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1326704 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1326704 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1326704">
                <li>
<div class="comment" commentid="1326898">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1326898" commentparentid="1326704">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/zhuquanlin" title="Specialist zhuquanlin" class="rated-user user-cyan">zhuquanlin</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/18/2025 08:29 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1326898" commentparentid="1326704">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/zhuquanlin" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3621958/avatar/a89366a7c66cba47.jpg">        </a>
        <div><a href="/profile/zhuquanlin" title="Specialist zhuquanlin" class="rated-user user-cyan">zhuquanlin</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/18/2025 08:29 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1326898" href="?#comment-1326898" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1326704" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1326898" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3621958" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1326898">
                        <div class="moveup">
                        <div class="ttypography"><p>Maybe. I didn't think to much and write the DLL.But without doubt,it has much details.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1326898 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1326898 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1326898">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1326631">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1326631" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Karim__2" title="Specialist Karim__2" class="rated-user user-cyan">Karim__2</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 09:39 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1326631" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Karim__2" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3471960/avatar/e2a2b983692a7d86.jpg">        </a>
        <div><a href="/profile/Karim__2" title="Specialist Karim__2" class="rated-user user-cyan">Karim__2</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 09:39 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1326631" href="?#comment-1326631" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1326631" class="CommentVoteFrame" myvotedirection="0" data-commentrating="11" data-commentuserid="3471960" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+11</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1326631">
                        <div class="moveup">
                        <div class="ttypography"><p>top 3 reasons for depression</p> <ol>   <li><p>breakup</p></li>   <li><p>Substance Abuse</p></li>   <li><p>WA in div2 A</p></li> </ol></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1326631 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1326631 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1326631">
        </ul>
    </div>
</div>

<div class="comment" commentid="1326683">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1326683" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/LightGran" title="Expert LightGran" class="rated-user user-blue">LightGran</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 12:38 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1326683" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/LightGran" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/LightGran" title="Expert LightGran" class="rated-user user-blue">LightGran</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 12:38 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1326683" href="?#comment-1326683" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1326683" class="CommentVoteFrame" myvotedirection="0" data-commentrating="31" data-commentuserid="4100394" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+31</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1326683">
                        <div class="moveup">
                        <div class="ttypography"><p>what is Hall-dp solution in Div1 — D ? <a class="rated-user user-legendary" href="/profile/Flamire" title="Legendary Grandmaster Flamire"><span class="legendary-user-first-letter">F</span>lamire</a></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1326683 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1326683 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1326683">
                <li>
<div class="comment" commentid="1326800">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1326800" commentparentid="1326683">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Flamire" title="Legendary Grandmaster Flamire" class="rated-user user-legendary"><span class="legendary-user-first-letter">F</span>lamire</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/18/2025 01:34 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1326800" commentparentid="1326683">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Flamire" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/850613/avatar/14b045f09557c96c.jpg">        </a>
        <div><a href="/profile/Flamire" title="Legendary Grandmaster Flamire" class="rated-user user-legendary"><span class="legendary-user-first-letter">F</span>lamire</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/18/2025 01:34 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1326800" href="?#comment-1326800" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1326683" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1326800" class="CommentVoteFrame" myvotedirection="0" data-commentrating="29" data-commentuserid="850613" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+29</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1326800">
                        <div class="moveup">
                        <div class="ttypography"><p>Added.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1326800 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1326800 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1326800">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1326711">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1326711" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Neweuler" title="Unrated, Neweuler" class="rated-user user-black">Neweuler</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 14:19 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">4</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1326711" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Neweuler" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/Neweuler" title="Unrated, Neweuler" class="rated-user user-black">Neweuler</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 14:19 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1326711" href="?#comment-1326711" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1326711" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="5079073" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1326711">
                        <div class="moveup">
                        <div class="ttypography"><p>Guys, i think there is error in solution to problem B(Closing tabs). Why there can't answer be greater than 2? Take a look at test case 6, i think for this, we will have to move the cursor 6 times. Kindly take a look at it.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1326711 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1326711 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1326711">
                <li>
<div class="comment" commentid="1326713">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1326713" commentparentid="1326711">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/BonnieCaledonia" title="Expert BonnieCaledonia" class="rated-user user-blue">BonnieCaledonia</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 14:32 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1326713" commentparentid="1326711">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/BonnieCaledonia" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/BonnieCaledonia" title="Expert BonnieCaledonia" class="rated-user user-blue">BonnieCaledonia</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 14:32 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1326713" href="?#comment-1326713" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1326711" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1326713" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3322125" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1326713">
                        <div class="moveup">
                        <div class="ttypography"><p>We can prove that the only positions that we need to click are the end position a and the max size of tab b.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1326713 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1326713 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1326713">
        </ul>
    </div>
</div>
</li>
                <li>
<div class="comment" commentid="1326750">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1326750" commentparentid="1326711">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Osamu_os" title="Newbie Osamu_os" class="rated-user user-gray">Osamu_os</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 17:14 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">2</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1326750" commentparentid="1326711">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Osamu_os" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/4717767/avatar/b8f2df0f664f2f92.jpg">        </a>
        <div><a href="/profile/Osamu_os" title="Newbie Osamu_os" class="rated-user user-gray">Osamu_os</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 17:14 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1326750" href="?#comment-1326750" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1326711" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1326750" class="CommentVoteFrame" myvotedirection="0" data-commentrating="1" data-commentuserid="4717767" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+1</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1326750">
                        <div class="moveup">
                        <div class="ttypography"><p>yeah , i hope someone could provide a mathmatical proof on why it couldnt be greater than 2 ;</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1326750 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1326750 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1326750">
                <li>
<div class="comment" commentid="1326901">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1326901" commentparentid="1326750">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Om_patel123" title="Specialist Om_patel123" class="rated-user user-cyan">Om_patel123</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/18/2025 08:44 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1326901" commentparentid="1326750">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Om_patel123" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/Om_patel123" title="Specialist Om_patel123" class="rated-user user-cyan">Om_patel123</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/18/2025 08:44 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1326901" href="?#comment-1326901" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1326750" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1326901" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4565881" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1326901">
                        <div class="moveup">
                        <div class="ttypography"><p>Suppose there are initially x tabs, each with width n / x. Your mouse is currently on the close button of the last tab.</p><p>After closing one tab, the number of tabs becomes x − 1, and each tab gets new width n / (x − 1).</p><p>Now consider two cases:</p><p>Case 1: n / (x − 1) &gt; b</p><p>tab's size is b now !</p><p>⟹ you must move the mouse to the new location of the first tab’s close button.</p><p>Case 2: n / (x − 1) ≤ b</p><p>Then tab's size will be n / (x − 1)</p><p>Your previous cursor position was at the right edge of the last tab:</p><p>old_pos = (n / x) * x (we have x tab with n/x len)</p><p>new_pos = (n / (x-1)) * (x — 1) (we have x-1 tab with n/(x-1) len)</p><p>So the close button ends up exactly at the same position as before. ⟹ No need to move the mouse.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1326901 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1326901 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1326901">
        </ul>
    </div>
</div>
</li>
                <li>
<div class="comment" commentid="1327061">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1327061" commentparentid="1326750">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/NWm" title="Expert NWm" class="rated-user user-blue">NWm</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/18/2025 18:27 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1327061" commentparentid="1326750">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/NWm" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/NWm" title="Expert NWm" class="rated-user user-blue">NWm</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/18/2025 18:27 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1327061" href="?#comment-1327061" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1326750" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1327061" revisioncount="3" revision="3">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">3</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1327061" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="86202" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1327061">
                        <div class="moveup">
                        <div class="ttypography"><p>there are 2 exclsuive situations and they spends of 2/1 moves, therefore we are guaranteed to have the problem solved in at most 2 moves: 1. the total length of tabs greater than window size e.g:</p> <pre><code class="prettyprint prettyprinted" style=""><span class="pln">b</span><span class="pun">|</span><span class="pln">b</span><span class="pun">|</span><span class="pln">b</span><span class="pun">|</span><span class="pln">b</span><span class="pun">|</span><span class="pln">b</span><span class="pun">|</span><span class="pln">b </span><span class="com"># &lt; move your curor here and close tabs</span><span class="pln">
wwwwwwwwwww</span></code></pre><p>then you'll have to move the cursor to the right most tab and close tabs until it reachs situation 2.</p> <ol>   <li>the total length of tabs less or equal than window size:</li> </ol> <pre><code class="prettyprint prettyprinted" style=""><span class="pln"> </span><span class="com">#v move your cursor here and close all tabs.</span><span class="pln">
bbb</span><span class="pun">|</span><span class="pln">bbb
wwwwwwwwwwww</span></code></pre><p>hope that gives you some intuition</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1327061 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1327061 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1327061">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1326725">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1326725" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/CJor_feg" title="Specialist CJor_feg" class="rated-user user-cyan">CJor_feg</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 15:57 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1326725" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/CJor_feg" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/CJor_feg" title="Specialist CJor_feg" class="rated-user user-cyan">CJor_feg</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 15:57 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1326725" href="?#comment-1326725" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1326725" class="CommentVoteFrame" myvotedirection="0" data-commentrating="3" data-commentuserid="5085219" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1326725">
                        <div class="moveup">
                        <div class="ttypography"><p>Shouldn't the last line of the tutorial of Div2D/1B be <code class="tt">max cnt &lt;= \sum_{i \in S} cnt_i</code> ? </p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1326725 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1326725 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1326725">
        </ul>
    </div>
</div>

<div class="comment" commentid="1326729">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1326729" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Axial-Tilted" title="Master Axial-Tilted" class="rated-user user-orange">Axial-Tilted</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 16:05 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1326729" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Axial-Tilted" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/1928304/avatar/bc92df289ad241f5.jpg">        </a>
        <div><a href="/profile/Axial-Tilted" title="Master Axial-Tilted" class="rated-user user-orange">Axial-Tilted</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 16:05 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1326729" href="?#comment-1326729" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1326729" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1326729" class="CommentVoteFrame" myvotedirection="0" data-commentrating="3" data-commentuserid="1928304" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+3</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1326729">
                        <div class="moveup">
                        <div class="ttypography"><p>could you add abit more context to hall-dp mentioned in problem D's editorial ?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1326729 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1326729 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1326729">
        </ul>
    </div>
</div>

<div class="comment" commentid="1326756">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1326756" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/DarkDevilVaqif" title="Specialist DarkDevilVaqif" class="rated-user user-cyan">DarkDevilVaqif</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 17:39 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1326756" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/DarkDevilVaqif" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3736341/avatar/9955a45edb8480bd.jpg">        </a>
        <div><a href="/profile/DarkDevilVaqif" title="Specialist DarkDevilVaqif" class="rated-user user-cyan">DarkDevilVaqif</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 17:39 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1326756" href="?#comment-1326756" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1326756" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3736341" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1326756">
                        <div class="moveup">
                        <div class="ttypography"><p>Could you link the editorial to the contest?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1326756 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1326756 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1326756">
        </ul>
    </div>
</div>

<div class="comment" commentid="1326757">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1326757" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/PastPrime" title="Expert PastPrime" class="rated-user user-blue">PastPrime</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 17:58 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1326757" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/PastPrime" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/PastPrime" title="Expert PastPrime" class="rated-user user-blue">PastPrime</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 17:58 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1326757" href="?#comment-1326757" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1326757" revisioncount="4" revision="4">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">4</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1326757" class="CommentVoteFrame" myvotedirection="0" data-commentrating="6" data-commentuserid="5043250" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+6</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1326757">
                        <div class="moveup">
                        <div class="ttypography"><p>I'm a bit disappointed with the editorial, especially after waiting for 24 hours.</p><p>For 2165A — Cyclic Merging, it would have been interesting to see:</p> <ul>   <li>the expected double-linked list implementation</li>   <li>a proof of the mathematical formula</li> </ul><p>rather than the straightforward implementation of the formula, which doesn't bring any added value.</p><p>I think an explanation could be the following: consider a graph of <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-217-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1605" style="width: 0.803em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.618em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.62em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1606"><span class="mi" id="MathJax-Span-1607" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-217">n</script> edges of weight <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-218-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1608" style="width: 14.034em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.203em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1011.14em, 2.711em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1609"><span class="msubsup" id="MathJax-Span-1610"><span style="display: inline-block; position: relative; width: 1.049em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.68em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1611" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="mi" id="MathJax-Span-1612" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-1613" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mo" id="MathJax-Span-1614" style="font-family: MathJax_Main; padding-left: 0.311em;">max</span><span class="mo" id="MathJax-Span-1615" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1616"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1617" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.557em;"><span class="mi" id="MathJax-Span-1618" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-1619" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1620" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 4.495em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1621" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.812em; left: 0.557em;"><span class="texatom" id="MathJax-Span-1622"><span class="mrow" id="MathJax-Span-1623"><span class="mo" id="MathJax-Span-1624" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1625" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1626" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1627" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1628" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1629" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.311em; padding-right: 0.311em;">mod</span><span class="mi" id="MathJax-Span-1630" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-1631" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1632" style="font-family: MathJax_Main;">,</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.535em; border-left: 0px solid; width: 0px; height: 1.542em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>n</mi></mrow></msub><mo stretchy="false">)</mo><mo>,</mo></math></span></span><script type="math/tex" id="MathJax-Element-218">w_i = \max(a_i, a_{(i+1)\bmod n}),</script> connecting vertices <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-219-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1633" style="width: 1.111em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.87em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1634"><span class="msubsup" id="MathJax-Span-1635"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1636" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.557em;"><span class="mi" id="MathJax-Span-1637" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-219">a_i</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-220-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo lspace=&quot;thickmathspace&quot; rspace=&quot;thickmathspace&quot;&gt;mod&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1638" style="width: 5.665em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.495em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1004.5em, 2.711em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1639"><span class="msubsup" id="MathJax-Span-1640"><span style="display: inline-block; position: relative; width: 4.495em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1641" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.812em; left: 0.557em;"><span class="texatom" id="MathJax-Span-1642"><span class="mrow" id="MathJax-Span-1643"><span class="mo" id="MathJax-Span-1644" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1645" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1646" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1647" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1648" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1649" style="font-size: 70.7%; font-family: MathJax_Main; padding-left: 0.311em; padding-right: 0.311em;">mod</span><span class="mi" id="MathJax-Span-1650" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.535em; border-left: 0px solid; width: 0px; height: 1.158em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo lspace="thickmathspace" rspace="thickmathspace">mod</mo><mi>n</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-220">a_{(i+1)\bmod n}</script>. You want to build a minimum spanning tree over it. Using Kruskal's algorithm, you pick <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-221-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1651" style="width: 3.018em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.403em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1002.34em, 2.403em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1652"><span class="mi" id="MathJax-Span-1653" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1654" style="font-family: MathJax_Main; padding-left: 0.249em;">−</span><span class="mn" id="MathJax-Span-1655" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.15em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-221">n-1</script> edges: all except one having weight <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-222-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;munder&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1656" style="width: 4.249em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.388em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1003.39em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1657"><span class="munderover" id="MathJax-Span-1658"><span style="display: inline-block; position: relative; width: 2.157em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1001.85em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mo" id="MathJax-Span-1659" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 1.849em;"><span class="mi" id="MathJax-Span-1660" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1661" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.049em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.68em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1662" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="mi" id="MathJax-Span-1663" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><munder><mo movablelimits="true" form="prefix">max</mo><mi>i</mi></munder><msub><mi>w</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-222">\max_i w_i</script>. Therefore, the total weight is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-223-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;munder&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1664" style="width: 10.28em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.188em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.172em, 1008.19em, 2.649em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1665"><span class="texatom" id="MathJax-Span-1666"><span class="mrow" id="MathJax-Span-1667"><span class="munderover" id="MathJax-Span-1668"><span style="display: inline-block; position: relative; width: 2.28em; height: 0px;"><span style="position: absolute; clip: rect(3.08em, 1000.99em, 4.434em, -999.997em); top: -3.997em; left: 0em;"><span class="mo" id="MathJax-Span-1669" style="font-family: MathJax_Size1; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(3.511em, 1000.5em, 4.188em, -999.997em); top: -4.489em; left: 1.049em;"><span class="mi" id="MathJax-Span-1670" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; clip: rect(3.326em, 1001.23em, 4.188em, -999.997em); top: -3.689em; left: 1.049em;"><span class="texatom" id="MathJax-Span-1671"><span class="mrow" id="MathJax-Span-1672"><span class="mi" id="MathJax-Span-1673" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1674" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-1675" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1676" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.049em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.68em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1677" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="mi" id="MathJax-Span-1678" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-1679" style="font-family: MathJax_Main; padding-left: 0.249em;">−</span><span class="munderover" id="MathJax-Span-1680" style="padding-left: 0.249em;"><span style="display: inline-block; position: relative; width: 2.157em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1001.85em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mo" id="MathJax-Span-1681" style="font-family: MathJax_Main;">max</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 1.849em;"><span class="mi" id="MathJax-Span-1682" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-1683" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.049em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.68em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1684" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="mi" id="MathJax-Span-1685" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.458em; border-left: 0px solid; width: 0px; height: 1.542em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub></mrow><mo>−</mo><munder><mo movablelimits="true" form="prefix">max</mo><mi>i</mi></munder><msub><mi>w</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-223">{\sum_{i=1}^n w_i} - \max_i w_i</script>.</p><p>You could think that this problem is not equivalent to the original one, because after picking an edge <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-224-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1686" style="width: 4.803em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.818em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1003.7em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1687"><span class="mo" id="MathJax-Span-1688" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1689"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1690" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.557em;"><span class="mi" id="MathJax-Span-1691" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-1692" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-1693" style="padding-left: 0.188em;"><span style="display: inline-block; position: relative; width: 1.726em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1694" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.557em;"><span class="texatom" id="MathJax-Span-1695"><span class="mrow" id="MathJax-Span-1696"><span class="mi" id="MathJax-Span-1697" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1698" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1699" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-1700" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>,</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-224">(a_i, a_{i+1})</script> (aka merging <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-225-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1701" style="width: 1.111em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.87em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1702"><span class="msubsup" id="MathJax-Span-1703"><span style="display: inline-block; position: relative; width: 0.865em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1704" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.557em;"><span class="mi" id="MathJax-Span-1705" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-225">a_i</script> and <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-226-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1706" style="width: 2.157em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.726em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1001.73em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1707"><span class="msubsup" id="MathJax-Span-1708"><span style="display: inline-block; position: relative; width: 1.726em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.5em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1709" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.557em;"><span class="texatom" id="MathJax-Span-1710"><span class="mrow" id="MathJax-Span-1711"><span class="mi" id="MathJax-Span-1712" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1713" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1714" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-226">a_{i+1}</script>), <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-227-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1715" style="width: 2.465em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.972em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1001.97em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1716"><span class="msubsup" id="MathJax-Span-1717"><span style="display: inline-block; position: relative; width: 1.972em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.68em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1718" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="texatom" id="MathJax-Span-1719"><span class="mrow" id="MathJax-Span-1720"><span class="mi" id="MathJax-Span-1721" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1722" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1723" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-227">w_{i-1}</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-228-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1724" style="width: 2.465em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.972em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1001.97em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1725"><span class="msubsup" id="MathJax-Span-1726"><span style="display: inline-block; position: relative; width: 1.972em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.68em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1727" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="texatom" id="MathJax-Span-1728"><span class="mrow" id="MathJax-Span-1729"><span class="mi" id="MathJax-Span-1730" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1731" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1732" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-228">w_{i+1}</script> might increase to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-229-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1733" style="width: 1.357em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.049em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1001.05em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1734"><span class="msubsup" id="MathJax-Span-1735"><span style="display: inline-block; position: relative; width: 1.049em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.68em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1736" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="mi" id="MathJax-Span-1737" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 0.927em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-229">w_i</script>, if <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-230-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1738" style="width: 5.542em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.434em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.418em, 1004.43em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1739"><span class="msubsup" id="MathJax-Span-1740"><span style="display: inline-block; position: relative; width: 1.049em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.68em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1741" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="mi" id="MathJax-Span-1742" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-1743" style="font-family: MathJax_Main; padding-left: 0.311em;">&gt;</span><span class="msubsup" id="MathJax-Span-1744" style="padding-left: 0.311em;"><span style="display: inline-block; position: relative; width: 1.972em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.68em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1745" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="texatom" id="MathJax-Span-1746"><span class="mrow" id="MathJax-Span-1747"><span class="mi" id="MathJax-Span-1748" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1749" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1750" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mi>i</mi></msub><mo>&gt;</mo><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-230">w_i > w_{i-1}</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-231-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1751" style="width: 5.542em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.434em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.418em, 1004.43em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1752"><span class="msubsup" id="MathJax-Span-1753"><span style="display: inline-block; position: relative; width: 1.049em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.68em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1754" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="mi" id="MathJax-Span-1755" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-1756" style="font-family: MathJax_Main; padding-left: 0.311em;">&gt;</span><span class="msubsup" id="MathJax-Span-1757" style="padding-left: 0.311em;"><span style="display: inline-block; position: relative; width: 1.972em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.68em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1758" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="texatom" id="MathJax-Span-1759"><span class="mrow" id="MathJax-Span-1760"><span class="mi" id="MathJax-Span-1761" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1762" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1763" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mi>i</mi></msub><mo>&gt;</mo><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-231">w_i > w_{i+1}</script>, but Kruskal picks edges ordered by weight, so this is not possible (i.e. you are guaranteed that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-232-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1764" style="width: 5.542em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.434em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.357em, 1004.43em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1765"><span class="msubsup" id="MathJax-Span-1766"><span style="display: inline-block; position: relative; width: 1.972em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.68em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1767" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="texatom" id="MathJax-Span-1768"><span class="mrow" id="MathJax-Span-1769"><span class="mi" id="MathJax-Span-1770" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1771" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1772" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span><span class="mo" id="MathJax-Span-1773" style="font-family: MathJax_Main; padding-left: 0.311em;">≥</span><span class="msubsup" id="MathJax-Span-1774" style="padding-left: 0.311em;"><span style="display: inline-block; position: relative; width: 1.049em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.68em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1775" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="texatom" id="MathJax-Span-1776"><span class="mrow" id="MathJax-Span-1777"><span class="mi" id="MathJax-Span-1778" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>≥</mo><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-232">w_{i-1} \ge w_{i}</script> or that <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-233-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1779" style="width: 2.465em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.972em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1001.97em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1780"><span class="msubsup" id="MathJax-Span-1781"><span style="display: inline-block; position: relative; width: 1.972em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.68em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1782" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="texatom" id="MathJax-Span-1783"><span class="mrow" id="MathJax-Span-1784"><span class="mi" id="MathJax-Span-1785" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1786" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-1787" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-233">w_{i-1}</script> was already picked, same for <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-234-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1788" style="width: 2.465em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.972em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1001.97em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1789"><span class="msubsup" id="MathJax-Span-1790"><span style="display: inline-block; position: relative; width: 1.972em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.68em, 4.188em, -999.997em); top: -3.997em; left: 0em;"><span class="mi" id="MathJax-Span-1791" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span><span style="position: absolute; top: -3.874em; left: 0.742em;"><span class="texatom" id="MathJax-Span-1792"><span class="mrow" id="MathJax-Span-1793"><span class="mi" id="MathJax-Span-1794" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-1795" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-1796" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.003em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-234">w_{i+1}</script>, therefore at every step the weights remain unchanged).</p><p>I feel there’s a nicer explanation, but I'm unable to find it; if you have one, I’d really appreciate if you could share it.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1326757 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1326757 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1326757">
                <li>
<div class="comment" commentid="1326798">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1326798" commentparentid="1326757">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/Flamire" title="Legendary Grandmaster Flamire" class="rated-user user-legendary"><span class="legendary-user-first-letter">F</span>lamire</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/18/2025 01:26 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1326798" commentparentid="1326757">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/Flamire" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/850613/avatar/14b045f09557c96c.jpg">        </a>
        <div><a href="/profile/Flamire" title="Legendary Grandmaster Flamire" class="rated-user user-legendary"><span class="legendary-user-first-letter">F</span>lamire</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/18/2025 01:26 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1326798" href="?#comment-1326798" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1326757" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1326798" class="CommentVoteFrame" myvotedirection="0" data-commentrating="22" data-commentuserid="850613" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+22</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1326798">
                        <div class="moveup">
                        <div class="ttypography"><p>Thanks for your feedback, I have added my proof of the formula, which I hope will be understandable. I have also sourced a greedy implementation from the testers, please check it out.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1326798 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1326798 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1326798">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1326762">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1326762" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/tryingoutcp" title="Expert tryingoutcp" class="rated-user user-blue">tryingoutcp</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 18:47 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1326762" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/tryingoutcp" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/tryingoutcp" title="Expert tryingoutcp" class="rated-user user-blue">tryingoutcp</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/17/2025 18:47 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1326762" href="?#comment-1326762" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1326762" class="CommentVoteFrame" myvotedirection="0" data-commentrating="2" data-commentuserid="3236813" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+2</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1326762">
                        <div class="moveup">
                        <div class="ttypography"><p>Here's how I did div2C. I started off with the same idea as the editorial, greedily merge the two adjacent elements with the smallest max. However, I couldn't think of a nice way to implement this, so I tried to make some more observations.</p><p>Assume we have a set which stores the max of every pair of adjacent elements, and observe how it changes after we merge the elements with the smallest max.</p><p>Let these elements be <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-235-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1797" style="width: 1.788em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.418em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1001.42em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1798"><span class="mi" id="MathJax-Span-1799" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1800" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1801" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>,</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-235">a,b</script>, WLOG <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-236-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1802" style="width: 2.957em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.342em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1002.34em, 2.465em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1803"><span class="mi" id="MathJax-Span-1804" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1805" style="font-family: MathJax_Main; padding-left: 0.311em;">≤</span><span class="mi" id="MathJax-Span-1806" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.227em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>≤</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-236">a \leq b</script>. Let the element adjacent to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-237-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1807" style="width: 0.742em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.56em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1808"><span class="mi" id="MathJax-Span-1809" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-237">a</script> (and is not <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-238-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1810" style="width: 0.557em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1000.43em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1811"><span class="mi" id="MathJax-Span-1812" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-238">b</script>) be <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-239-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1813" style="width: 0.742em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.557em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.5em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1814"><span class="mi" id="MathJax-Span-1815" style="font-family: MathJax_Math-italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 0.696em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-239">x</script>, and let the element adjacent to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-240-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1816" style="width: 0.557em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1000.43em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1817"><span class="mi" id="MathJax-Span-1818" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-240">b</script> similarly be <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-241-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1819" style="width: 0.618em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.495em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.542em, 1000.5em, 2.526em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1820"><span class="mi" id="MathJax-Span-1821" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.304em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-241">y</script>. If we merge <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-242-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1822" style="width: 2.772em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.218em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1002.1em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1823"><span class="mo" id="MathJax-Span-1824" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1825" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1826" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1827" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">b</span><span class="mo" id="MathJax-Span-1828" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-242">(a,b)</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-243-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1829" style="width: 0.557em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1000.43em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1830"><span class="mi" id="MathJax-Span-1831" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-243">b</script>, the only max of our set which could change is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-244-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1832" style="width: 5.234em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.188em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1004.07em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1833"><span class="mo" id="MathJax-Span-1834" style="font-family: MathJax_Main;">max</span><span class="mo" id="MathJax-Span-1835" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1836" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1837" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1838" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-1839" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-244">\max(x,a)</script> to <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-245-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo movablelimits=&quot;true&quot; form=&quot;prefix&quot;&gt;max&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1840" style="width: 5.172em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.126em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1004em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1841"><span class="mo" id="MathJax-Span-1842" style="font-family: MathJax_Main;">max</span><span class="mo" id="MathJax-Span-1843" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1844" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1845" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1846" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">b</span><span class="mo" id="MathJax-Span-1847" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo movablelimits="true" form="prefix">max</mo><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-245">\max(x,b)</script>. But since <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-246-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1848" style="width: 0.557em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.434em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1000.43em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1849"><span class="mi" id="MathJax-Span-1850" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-246">b</script> was the smallest max, <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-247-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1851" style="width: 12.434em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.911em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1009.79em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1852"><span class="mi" id="MathJax-Span-1853" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-1854" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1855" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1856" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1857" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1858" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1859" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">a</span><span class="mo" id="MathJax-Span-1860" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1861" style="font-family: MathJax_Main; padding-left: 0.311em;">≥</span><span class="mi" id="MathJax-Span-1862" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">m</span><span class="mi" id="MathJax-Span-1863" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-1864" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1865" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1866" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1867" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-1868" style="font-family: MathJax_Math-italic; padding-left: 0.188em;">b</span><span class="mo" id="MathJax-Span-1869" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo><mo>≥</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-247">max(x,a) \geq max(a,b)</script>. Taking cases whether <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-248-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1870" style="width: 2.957em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.342em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1002.34em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1871"><span class="mi" id="MathJax-Span-1872" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1873" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mi" id="MathJax-Span-1874" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>=</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-248">a = b</script> or not, we get either <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-249-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1875" style="width: 2.957em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.342em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1002.34em, 2.342em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1876"><span class="mi" id="MathJax-Span-1877" style="font-family: MathJax_Math-italic;">a</span><span class="mo" id="MathJax-Span-1878" style="font-family: MathJax_Main; padding-left: 0.311em;">=</span><span class="mi" id="MathJax-Span-1879" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.073em; border-left: 0px solid; width: 0px; height: 1.004em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>=</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-249">a = b</script> or <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-250-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1880" style="width: 3.018em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.403em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1002.4em, 2.465em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1881"><span class="mi" id="MathJax-Span-1882" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-1883" style="font-family: MathJax_Main; padding-left: 0.311em;">≥</span><span class="mi" id="MathJax-Span-1884" style="font-family: MathJax_Math-italic; padding-left: 0.311em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.227em; border-left: 0px solid; width: 0px; height: 1.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>≥</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-250">x \geq b</script>, and in both cases the element of our set doesn't change. </p><p>So our answer is just the <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-251-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1885" style="width: 3.018em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.403em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1002.34em, 2.403em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1886"><span class="mi" id="MathJax-Span-1887" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1888" style="font-family: MathJax_Main; padding-left: 0.249em;">−</span><span class="mn" id="MathJax-Span-1889" style="font-family: MathJax_Main; padding-left: 0.249em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.15em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-251">n-1</script> smallest elements of the original set. The largest element of the set is just the max of the array, so just subtract that from the sum of the set. This solves it in <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-252-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1890" style="width: 2.711em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.157em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.234em, 1002.03em, 2.588em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1891"><span class="mi" id="MathJax-Span-1892" style="font-family: MathJax_Math-italic;">O</span><span class="mo" id="MathJax-Span-1893" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1894" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-1895" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.381em; border-left: 0px solid; width: 0px; height: 1.388em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-252">O(n)</script>, and doesn't really involve any extra knowledge like cartesian trees. </p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1326762 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1326762 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1326762">
        </ul>
    </div>
</div>

<div class="comment" commentid="1326788">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1326788" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/JR-OIer" title="Specialist JR-OIer" class="rated-user user-cyan">JR-OIer</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/18/2025 00:25 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1326788" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/JR-OIer" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2673353/avatar/7a557c13dc74bce2.jpg">        </a>
        <div><a href="/profile/JR-OIer" title="Specialist JR-OIer" class="rated-user user-cyan">JR-OIer</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/18/2025 00:25 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1326788" href="?#comment-1326788" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            <span style="" commentid="1326788" revisioncount="2" revision="2">
                                <a href="#" style="text-decoration:none;font-size:1.4rem;color:#bebebe;" class="leftRevision">←</a>
                                Rev. <span class="revision">2</span>
                                <a href="#" style="text-decoration:none;font-size:1.4rem;visibility:hidden;color:#bebebe;" class="rightRevision">→</a>
                            </span>
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1326788" class="CommentVoteFrame" myvotedirection="0" data-commentrating="-11" data-commentuserid="2673353" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-11</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1326788">
                        <div class="moveup">
                        <div class="ttypography"><p><em>Comment canceled because of downvotes.</em></p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1326788 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1326788 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1326788">
        </ul>
    </div>
</div>

<div class="comment" commentid="1326796">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1326796" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/sach_in_sigma" title="Newbie sach_in_sigma" class="rated-user user-gray">sach_in_sigma</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/18/2025 01:20 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1326796" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/sach_in_sigma" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/3689842/avatar/7295697ae7ac15a3.jpg">        </a>
        <div><a href="/profile/sach_in_sigma" title="Newbie sach_in_sigma" class="rated-user user-gray">sach_in_sigma</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/18/2025 01:20 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1326796" href="?#comment-1326796" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1326796" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3689842" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1326796">
                        <div class="moveup">
                        <div class="ttypography"><p>In the div2C instead of checking for smallest element, what if we check for the neighbours of max element. Those can only pair with the other guy (not the maximum). So answer should be the sum of max of all pairs to the left of max cyclically. But could anyone proof that this is always true? For me it passed all the test cases...</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1326796 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1326796 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1326796">
        </ul>
    </div>
</div>

<div class="comment" commentid="1326868">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1326868" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/LightGran" title="Expert LightGran" class="rated-user user-blue">LightGran</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/18/2025 06:08 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1326868" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/LightGran" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/LightGran" title="Expert LightGran" class="rated-user user-blue">LightGran</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/18/2025 06:08 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1326868" href="?#comment-1326868" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1326868" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="4100394" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1326868">
                        <div class="moveup">
                        <div class="ttypography"><p>I had misinterpreted DIV1 — D as we can also rearrange the elements within subsequence. In other words, we have to partition elements into subsets and each subset's elements can be rearranged in a sequence and they satisfy the required property. Is this version solvable ? </p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1326868 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1326868 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1326868">
        </ul>
    </div>
</div>

<div class="comment" commentid="1326870">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1326870" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/GreenKite" title="Expert GreenKite" class="rated-user user-blue">GreenKite</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/18/2025 06:18 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1326870" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/GreenKite" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/2164386/avatar/3baf225c3af6e35d.jpg">        </a>
        <div><a href="/profile/GreenKite" title="Expert GreenKite" class="rated-user user-blue">GreenKite</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/18/2025 06:18 UTC">4 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1326870" href="?#comment-1326870" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1326870" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="2164386" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1326870">
                        <div class="moveup">
                        <div class="ttypography"><p>amazing</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1326870 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1326870 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1326870">
        </ul>
    </div>
</div>

<div class="comment" commentid="1327813">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1327813" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/fft_enjoyer" title="Pupil fft_enjoyer" class="rated-user user-green">fft_enjoyer</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/21/2025 23:48 UTC">3 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1327813" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/fft_enjoyer" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/fft_enjoyer" title="Pupil fft_enjoyer" class="rated-user user-green">fft_enjoyer</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/21/2025 23:48 UTC">3 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1327813" href="?#comment-1327813" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1327813" class="CommentVoteFrame" myvotedirection="0" data-commentrating="-15" data-commentuserid="3916051" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">-15</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1327813">
                        <div class="moveup">
                        <div class="ttypography"><p>Why did you provide such a hard tutorial to the D1D (Hall-dp) when it's just greedy?</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1327813 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1327813 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1327813">
                <li>
<div class="comment" commentid="1328977">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1328977" commentparentid="1327813">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/fft_enjoyer" title="Pupil fft_enjoyer" class="rated-user user-green">fft_enjoyer</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/28/2025 18:12 UTC">2 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1328977" commentparentid="1327813">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/fft_enjoyer" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/fft_enjoyer" title="Pupil fft_enjoyer" class="rated-user user-green">fft_enjoyer</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/28/2025 18:12 UTC">2 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1328977" href="?#comment-1328977" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1327813" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1328977" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3916051" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1328977">
                        <div class="moveup">
                        <div class="ttypography"><p>Any reason why undervoting me?</p><p>P. S. When I wrote this comment there was no "disclaimer" saying anything about greedy.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1328977 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1328977 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1328977">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>

<div class="comment" commentid="1327815">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1327815" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/shsh" title="Master shsh" class="rated-user user-orange">shsh</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/22/2025 00:09 UTC">3 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show (+<span class="hidden-children">1</span>)</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1327815" commentparentid="-1">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/shsh" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/1687643/avatar/a7c9bef19b3557e3.jpg">        </a>
        <div><a href="/profile/shsh" title="Master shsh" class="rated-user user-orange">shsh</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/22/2025 00:09 UTC">3 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1327815" href="?#comment-1327815" style="font-size:1.2em;">#</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1327815" class="CommentVoteFrame" myvotedirection="0" data-commentrating="5" data-commentuserid="1687643" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:green;font-weight:bold;">+5</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1327815">
                        <div class="moveup">
                        <div class="ttypography"><p>Can you provide some good resources about minimum path cover and how to translate it to bipartite matching? The Wikipedia article is not very illuminating.</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1327815 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1327815 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1327815">
                <li>
<div class="comment" commentid="1328613">
    <div class="hidden-comment" style="display: none;">
        <table class="comment-table" commentid="1328613" commentparentid="1327815">
            <tbody><tr>
                <td class="left">
                        <div style="position: absolute; left: 0;" class="comment-indent-holder">
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                                <div class="comment-no-indent">
                                    <span>»</span>
                                </div>
                        </div>
                     <div class="avatar"><a href="/profile/_totoro" title="Expert _totoro" class="rated-user user-blue">_totoro</a></div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/26/2025 21:44 UTC">3 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="showComment">show</a></span>
                        <span class="item" style="visibility: hidden"><a style="font-size:1.2em;">#</a></span>

                        <div style="position:absolute;right:0;top:0;">
                            <div class="commentVoteFrameHolder">
                            </div>
                        </div>
                    </div>
                </td>
            </tr>
        </tbody></table>
    </div>
    <div class="shown-comment">
        <table class="comment-table" commentid="1328613" commentparentid="1327815">
            <tbody><tr>
                <td class="left">
                    <div style="position: absolute; left: 0;" class="comment-indent-holder">
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                            <div class="comment-no-indent">
                                <span>»</span>
                            </div>
                    </div>
    <div class="avatar">
        <a href="/profile/_totoro" style="position: relative;">
<img src="https://codeforces.com/userpic.codeforces.org/no-avatar.jpg">        </a>
        <div><a href="/profile/_totoro" title="Expert _totoro" class="rated-user user-blue">_totoro</a></div>
    </div>
                </td>
                <td class="right">
                    <div class="info">
                        
                        <span class="item"><span class="format-humantime" title="Nov/26/2025 21:44 UTC">3 weeks ago</span>,</span>
                        <span class="item"><a href="#" class="hideComment">hide</a></span>
                        <span class="item"><a title="Link to comment" id="comment-1328613" href="?#comment-1328613" style="font-size:1.2em;">#</a></span>
                            <span class="item"><a title="Parent comment" href="#comment-1327815" style="font-size:1.2em;">^</a></span>
                        <span class="item">|</span>
                        <span style="position: relative; top: 2px;">
</span>
                        <div style="position:absolute;right:0;top:0;">
                            &nbsp;
                            <div class="commentVoteFrameHolder">

<span commentid="1328613" class="CommentVoteFrame" myvotedirection="0" data-commentrating="0" data-commentuserid="3963485" style="position:relative;">
<a href="#" class="vote-for-comment" votedirection="1" dd="x"><img style="position:relative;top:3px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-voteup-blue.png" alt="Vote: I like it" title="Vote: I like it"></a>
<span class="commentRating"><span style="color:gray;font-weight:bold;">0</span></span>
<a href="#" class="vote-for-comment" votedirection="-1" dd="y"><img style="position:relative;top:2px;opacity:0.35;" src="//codeforces.com/codeforces.org/s/52448/images/actions/comment-votedown-blue.png" alt="Vote: I do not like it" title="Vote: I do not like it"></a>
</span>
                            </div>
                        </div>
                    </div>
                    <div class="comment-content comment-content-1328613">
                        <div class="moveup">
                        <div class="ttypography"><p>Ok I've spent a while looking into this now, and idk how helpful it will be but here's the way I understand it.</p><p>A path cover is just any set of (directed) edges, such that each vertex has at most one incoming and one outgoing edge in the set.*</p><p>The minimal path cover corresponds to the set with the most edges, since the number of paths in that cover is <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-253-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1896" style="width: 3.511em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.772em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.295em, 1002.77em, 2.403em, -999.997em); top: -2.151em; left: 0em;"><span class="mrow" id="MathJax-Span-1897"><span class="mi" id="MathJax-Span-1898" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.188em;"></span></span><span class="mo" id="MathJax-Span-1899" style="font-family: MathJax_Main; padding-left: 0.249em;">−</span><span class="mi" id="MathJax-Span-1900" style="font-family: MathJax_Math-italic; padding-left: 0.249em;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.157em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.15em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>V</mi><mo>−</mo><mi>E</mi></math></span></span><script type="math/tex" id="MathJax-Element-253">V-E</script>.</p><p>If we create two copies of the vertices, one copy on the 'left' and one on the 'right,' then we'll start drawing edges between them, and let's say that an (undirected) edge from left to right represents outgoing from the vertex represented on the left and incoming into the one on the right. What's cool is that our constraint "at most one incoming and one outgoing per vertex" now translates into "at most one (undirected) edge per vertex in this new copy graph." One vertex copy represents the incoming edge and the other represents the outgoing one. And this is EXACTLY the condition of a bipartite matching.</p><p>So if we build a bipartite matching on the new graph (which in this round's problem the graph is created implicitly), it represents a path cover (at most one incoming and outgoing edge per vertex in the original graph), with the same number of edges (we sort of just 'glue' the left and right halves back together or superimpose them or whatever)! And if we build the MAXIMAL bipartite matching, then this will be the minimum path cover (since it has the most edges).</p><p>The solution for 2165D in the editorial does this matching in two passes, first finding the outgoing edges from odd vertices to even ones (effectively only odd on the left and even on the right, basically ignoring all implicit evens on the left half), then finding all the outgoing edges from evens on the left incoming into odds on the right. These two matchings can be composed using simple addition since the Even-&gt;Odd graphs and Odd-&gt;Even graphs don't interfere with each other.</p> <hr><p>* I think this reframing of the problem was the key to me finally getting that Eureka moment</p></div>
                        </div>
                    </div>
                    <div class="reply info">
                        <a class="comment-1328613 en false" href="#" style="text-decoration: none;"><span class="arrow">→</span></a>
                        <a class="comment-1328613 en false" href="#">Reply</a>
                    </div>
                </td>
            </tr>
        </tbody></table>
        <ul class="comment-children comment-1328613">
        </ul>
    </div>
</div>
</li>
        </ul>
    </div>
</div>
        <br>

<div id="editBox-163879" style="width:50em;display:none;">
    <div class="previewBody" style="border: 1px solid #d4d4d4; margin-bottom: 0.5em; padding: 0.25em; display:none;">&nbsp;</div>
    <div style="width: 1px">&nbsp;</div>
    <div class="commentLocale" style="position: relative; top: 0.5em;left:4px;display: none;">
        <input type="radio" name="locale" value="en"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In English</span>
        <input style="margin-left:1em" type="radio" name="locale" value="ru"><span style="font-size: 1.2rem;position: relative; bottom: 3px;">In Russian</span>
    </div>
    <textarea data-drafts-id="CommentReplyFrame" class="wysiwyg" name="editContent" rows="20" style="width:99%;"></textarea>
    <div class="error error__content"></div>
    <div style="text-align:center;">
        <input type="button" name="preview" style="padding: 0.25em 1em; margin-top: 1em; min-width: 6.5em;" value="Preview">
        <input type="button" name="save" style="padding: 0.25em 1em; margin-top: 1em; min-width: 6.5em;" value="Save">
    </div>
</div>

    <script type="text/javascript">
        $(document).ready(function () {

var firstPreview163879 = true;
var lastPreviewContent163879 = '';

if (!window.moveCommentRevision) {
    moveCommentRevision = function(e, dir) {
        var p = e.parent();
        var revisionCount = parseInt(p.attr("revisionCount"));
        var revision = parseInt(p.attr("revision"));
        var next = revision + dir;
        var commentId = p.attr("commentId");
        if (next >= 1 && next <= revisionCount) {
            $.post(
                "/data/comment-data",
                {action: "revision", commentId: commentId, revision: next},
                function(json) {
                    if (json.success == "true") {
                        var parentDiv = e;

                        while (parentDiv !== null && (parentDiv[0].nodeName.toLowerCase() !== "td" || !parentDiv.hasClass("right"))) {
                            parentDiv = parentDiv.parent();
                        }

                        if (parentDiv === null) {
                            return;
                        }

                        parentDiv.find("div.comment-content-" + commentId + " .moveup").html(json.content);
                        Codeforces.setupSpoilers(parentDiv.find("div.comment-content-" + commentId + " .moveup"));
                        p.attr("revision", next);
                        p.find("span.revision").text(next);
                        if (next == 1) {
                            p.find("a.leftRevision").css("visibility", "hidden");
                        } else {
                            p.find("a.leftRevision").css("visibility", "visible");
                        }
                        if (next == revisionCount) {
                            p.find("a.rightRevision").css("visibility", "hidden");
                        } else {
                            p.find("a.rightRevision").css("visibility", "visible");
                        }

                        window.updateTypography();
                        MathJax.Hub.Typeset();
                    } else {
                        alert(e.error);
                    }
                },
                "json"
            );
        }
    };
}

$("div[commentableId=163879] a.leftRevision").click(function () {
    window.moveCommentRevision($(this), -1);
    return false;
});

$("div[commentableId=163879] a.rightRevision").click(function () {
    window.moveCommentRevision($(this), +1);
    return false;
});



        });
    </script>


        <script src="//codeforces.com/codeforces.org/s/52448/js/swfobject-2.2.min.js" type="text/javascript"></script>
        <script src="//codeforces.com/codeforces.org/s/52448/js/ftaa.js" type="text/javascript"></script>
        <script type="text/javascript">
            $(function() {
                if (window.evercookie) {
                    var ec = new evercookie({
                        history: false,
                        silverlight: false,
                        baseurl: '',
                        asseturi: '/assets',
                        phpuri: '/2fdcd78',
                        pngPath: '/eps',
                        etagPath: '/ees',
                        cachePath: '/ecs'
                    });

                    var randomNumber = function () {
                        return Math.random().toString(36).substr(2);
                    };

                    var randomToken = function () {
                        return (randomNumber() + randomNumber()).substring(0, 18);
                    };

                    window._ftaa = "";

                    ec.get("70a7c28f3de", function (value) {
                        window._ftaa = value;
                        if (!window._ftaa) {
                            window._ftaa = randomToken();
                            ec.set("70a7c28f3de", window._ftaa);
                        }
                        $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                    });
                } else {
                    window._ftaa = "n/a";
                    $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                }
            });
        </script>

        <script src="//codeforces.com/codeforces.org/s/52448/js/bfaa.js" type="text/javascript"></script>
        <script type="text/javascript">
            $(function() {
                var fpCallback = function() {
                    Fingerprint2.get({}, function(components) {
                        window._bfaa = Fingerprint2.x64hash128(components.map(function (pair) { return pair.value }).join(), 31);
                        $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                    });
                };
                if (typeof Fingerprint2 !== 'undefined') {
                    if (window.requestIdleCallback) {
                        requestIdleCallback(fpCallback)
                    } else {
                        setTimeout(fpCallback, 500)
                    }
                } else {
                    window._bfaa = "n/a";
                    $.post("/data/empty", {bfaa: window._bfaa, ftaa: window._ftaa});
                }
            });
        </script>

    <script type="text/javascript">
        $(document).ready(function () {
    $("a.new-root-comment").click(function () {
            window.location = "/enter";
        return false;
    });

    $(".comment-table .reply a").click(function () {
            window.location = "/enter";
        return false;
    });
        });
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
    function updateImg(element, direction, activated) {
        var votedDirection = element.closest(".CommentVoteFrame").attr("myVoteDirection");
        var directionString = direction == 1 ? "up" : "down";
        element.attr("src", "//codeforces.com/codeforces.org/s/52448/images/actions/comment-vote" + directionString + (activated ? "" : "-blue") + ".png");
        element.css("opacity", activated ? "1.0" : "0.35");
        var title;
        if (votedDirection == direction) {
            title = "Cancel vote";
        } else if (direction == 1) {
            title = "Vote: I like it";
        } else {
            title = "Vote: I do not like it";
        }
        element.attr("alt", title);
        element.attr("title", title);
    }

    $(".vote-for-comment").mouseover(function () {
        var vote = $(this);
        var voteFrame = $(this).closest(".CommentVoteFrame");
        var direction = vote.attr("voteDirection");
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = false;
        if (!ownComment) {
            updateImg(vote.find("img"), direction, true);
        }
    });

    $(".vote-for-comment").mouseout(function () {
        var vote = $(this);
        var voteFrame = $(this).closest(".CommentVoteFrame");
        var direction = vote.attr("voteDirection");
        var myVoteDirection = voteFrame.attr("myVoteDirection");
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = false;
        if (myVoteDirection != direction && !ownComment) {
            updateImg(vote.find("img"), direction, false);
        }
    });

    $(".vote-for-comment").click(function () {
        if ($(this).closest(".hidden-comment").length) {
            Codeforces.showMessage("Show the comment before voting");
            return;
        }
        var vote = $(this);
        var voteFrame = $(this).closest(".CommentVoteFrame");
        var commentId = $(this).parent().attr("commentid");
        var commentRating = $(this).parent().attr("data-commentRating");
        var myVoteDirection = voteFrame.attr("myVoteDirection");
        var direction = $(this).attr("voteDirection");
        var newDirection = direction;
        if (direction == myVoteDirection) {
            newDirection = 0; // Clicking same direction twice cancels the vote
        }
        var commentUserId = $(this).parent().attr("data-commentUserId");
        var ownComment = false;
        $.post("/data/comment/vote", {commentId: commentId, _tta: Codeforces.tta(), vote: newDirection, commentRating: commentRating}, function(data) {
            if (data["success"] == "true") {
                voteFrame.attr("myVoteDirection", newDirection);
                updateImg(voteFrame.find("[voteDirection=-1]>img"), -1, newDirection == -1);
                updateImg(voteFrame.find("[voteDirection=1]>img"), 1, newDirection == 1);
                if (newDirection == -1) {
                    voteFrame.find(".ComplaintFrame").css("display", "inline-block");
                } else {
                    voteFrame.find(".ComplaintFrame").hide();
                }
                vote.parent().find(".commentRating").html(data["commentRating"]);
            }
            Codeforces.showMessage(data["message"]);
        }, "json");
        return false;
    });

    $(".negative-comment-vote").closest(".comment-table").addClass("comment-bad");

    $(".troll-comment-vote").closest(".comment").css("display", "none");

    $(".too-negative-comment-vote").closest(".comment-table").each(function () {
        var e = $(this);
        e.addClass("comment-too-bad");
        var commentId = e.attr("commentId");
        $("<div class='bad-comment-replacement ttypography'>The comment is hidden because of too negative feedback, click <a href=# class=show-bad-comment-link>here</a> to view it</div>").appendTo(
            e.find(".right")
        );
        e.find(".comment-content").hide();
        e.find(".show-bad-comment-link").click(function () {
            e.find(".comment-content").show();
            e.find(".bad-comment-replacement").hide();
            return false;
        });
    });
        });
    </script>
    </div>

    <style type="text/css">
        .new-comments-box {
            padding: 0.5em;
            width: 22px;
            font-size: 1.3rem;
            font-weight: bold !important;

            position: fixed;
            top: 40%;
            right: 0;
            opacity: 0.2;
            color: white;
            text-align: center;

            border: 1px solid #222;
            background-color: #888 !important;
            border-radius: 3px;
            -moz-border-radius: 3px;
            -webkit-border-radius: 3px;
        }

        .new-comments-box:hover {
            opacity: 1;
        }

        .new-comments-box .dir:hover {
            background: #3B5998 !important;
            cursor: pointer;
        }
    </style>

    <div class="new-comments-box" data-position="outside" data-index="-1" style="display: none;">
        <div class="up dir" title="Ctrl+Up">↑<hr>
        </div>
        <div class="info" title="New comments"></div>
        <div class="down dir" title="Ctrl+Down">
            <hr>↓
        </div>
    </div>

    <script>
        function makeSureElementIsShown(target) {
            let e = target;
            while (true) {
                e = e.parent().closest(".comment");
                if (e.length === 0) {
                    break;
                }
                e.find(">.hidden-comment").hide();
                e.find(">.shown-comment").show();
            }
        }

        $(function() {
            const hash = window.location.hash;
            if (hash) {
                const target = $(hash);
                if (target) {
                    makeSureElementIsShown(target);
                    setTimeout(() => target.scrollIntoView());
                }
            }
        });

        $(".show-archived-checkbox").change(function () {
            const checked = $(this).is(":checked");
            $.post("/data/comment-data", {action: "setShowArchived", checked}, function (json) {
                if (json["success"] !== "true") {
                    alert(json["error"]);
                } else {
                    if (checked) {
                        Codeforces.reloadAndShowMessage("Archived comments are now displayed")
                    } else {
                        Codeforces.reloadAndShowMessage("Archived comments are no longer displayed")
                    }
                }
            });
            return false;
        });

        function gotoComment(direction) {
            var box = $(".new-comments-box");
            var index = parseInt(box.attr("data-index"));
            if (index == -1)
                index = 0;
            else
                index = Math.max(0, Math.min(parseInt(box.find(".info").text()) - 1, index + direction));
            box.attr("data-index", index);
            var comment = $($(".comment>.shown-comment>.highlight-blue[commentId]").get(index));
            makeSureElementIsShown(comment);
            $('html, body').animate({
                'scrollTop': Math.max(0, comment.offset().top - ($(window).height() - comment.height()) / 2)
            });
            return false;
        }

        $(".new-comments-box .down").click(function () {
            return gotoComment(1);
        });

        $(".new-comments-box .up").click(function () {
            return gotoComment(-1);
        });

        $(document).keydown(function (e) {
            var code = (e.keyCode ? e.keyCode : e.which);
            if (e.ctrlKey) {
                if (code == 38 || code == 40) {
                    gotoComment(code - 39);
                }
            }
        });

        var newCommentCount = $(".comment>.shown-comment>.highlight-blue[commentId]").length;
        if (newCommentCount > 0) {
            $(".new-comments-box .info").text(newCommentCount);
            $(".new-comments-box").show();
        }

        $('table.comment-table').mouseenter(function () {
            var comment = $(this);
            var cnt = 0;
            while (true) {
                var id = comment.attr("commentId");
                var parentId = comment.attr("commentParentId");
                comment.find(".comment-indent-holder:first .comment-no-indent").addClass("comment-indent");
                if (parentId == -1) {
                    break;
                }
                comment = $("table.comment-table[commentId=" + parentId + "]");
            }
            return false;
        });

        $('table.comment-table').mouseleave(function () {
            var comment = $(this);
            var cnt = 0;
            while (true) {
                var id = comment.attr("commentId");
                var parentId = comment.attr("commentParentId");
                comment.find(".comment-indent-holder:first .comment-no-indent").removeClass("comment-indent");
                if (parentId == -1) {
                    break;
                }
                comment = $("table.comment-table[commentId=" + parentId + "]");
            }
            return false;
        });

        const commentVoteFrameHolderSelector = ">.comment-table .commentVoteFrameHolder";
        $(".hidden-comment").each(function() {
            const comment = $(this).closest(".comment");
            $(this).find(".hidden-children").text(comment.find(".comment").length);
        });
        $('.hideComment').click(function () {
            const comment = $(this).closest(".comment");
            const shownComment = comment.find("> .shown-comment");
            const hiddenComment = comment.find("> .hidden-comment");
            shownComment.hide();
            hiddenComment.show();
            shownComment.find(commentVoteFrameHolderSelector).children()
                .appendTo(hiddenComment.find(commentVoteFrameHolderSelector));
            return false;
        });
        $('.showComment').click(function () {
            const comment = $(this).closest(".comment");
            const hiddenComment = comment.find("> .hidden-comment");
            const shownComment = comment.find("> .shown-comment");
            hiddenComment.hide();
            shownComment.show();
            hiddenComment.find(commentVoteFrameHolderSelector).children()
                .appendTo(shownComment.find(commentVoteFrameHolderSelector));
            return false;
        });
    </script>



    <script>
        function adjustTopicComplainFrames() {
            let topicIds = [];

            $(".has-topic-id").each(function () {
                const $this = $(this);
                const topicId = $this.attr("topicId");
                if (topicId) {
                    topicIds.push(topicId);
                }
            });

            $.post("/data/topics", {
                action: "findComplainableTopicIds",
                topicIds: topicIds.join(",")
            }, function (json) {
                if (json["success"] === "true") {
                    for (const topicId of json["complainableTopicIds"].split(",")) {
                        $(".has-topic-id[topicId=" + topicId + "]").each(function () {
                            $(this).find(".meta .ComplaintFrame").css("display", "inline-block");
                        });
                    }
                }
            }, "json");
        }

        function updateTopicVote(topicId, voteDirection, processed) {
            let ratingElement = $(".topic-rating-" + topicId);
            let newRating = parseInt(ratingElement.attr("data-rawRating"));
            if (!processed) newRating += voteDirection;
            if (newRating > 0) {
                ratingElement.text("+" + newRating.toString());
                ratingElement.css("color", "green");
            } else {
                ratingElement.text(newRating.toString());
                ratingElement.css("color", "gray");
            }
            let voteUpImg = $(".topic-vote-up-" + topicId + " img");
            voteUpImg.attr("src", "//codeforces.com/codeforces.org/s/52448/"
                + (voteDirection === 1 ? "images/actions/voteup-voted.png" : "images/actions/voteup-gray.png"));
            voteUpImg.attr("title", voteDirection === 1 ? "Cancel vote" : "Vote: I like it");
            let voteDownImg = $(".topic-vote-down-" + topicId + " img");
            voteDownImg.attr("src", "//codeforces.com/codeforces.org/s/52448/"
                + (voteDirection === -1 ? "images/actions/votedown-voted.png" : "images/actions/votedown-gray.png"));
            voteDownImg.attr("title", voteDirection === -1 ? "Cancel vote" : "Vote: I do not like it");
        }

        function getMyVotes() {
            let topicIds = [];
            $(".topic-rating").each(function () {
                topicIds.push($(this).attr("data-topicId"))
            });
            $.post("/data/topic/vote", {
                topicIds: topicIds.join(","),
                _tta: Codeforces.tta(),
                action: "getMyVotes"
            }, function (data) {
                if (data.success === "true") {
                    votes = JSON.parse(data.votes);
                    for (const vote of votes) {
                        updateTopicVote(vote.topicId, vote.direction, vote.processed);
                    }
                }
            }, "json");
        }

        $(function () {
        });
    </script>

<script type="text/javascript">
    $(document).ready(function () {
        let voteDirection = 0;

        function clickVote(direction) {
            if (direction === voteDirection) {
                direction = 0;
            }
            $.post("/data/topic/vote", {
                topicId: 149093,
                _tta: Codeforces.tta(),
                topicRevisionId: 413329,
                vote: direction,
            }, function (data) {
                if (data.success === "true") {
                    voteDirection = parseInt(data.voteDirection);
                    updateTopicVote(149093, voteDirection, data.processed === "true");
                }
                Codeforces.showMessage(data.message);
            }, "json");
        }

        $(".topic-vote-up-149093").click(function () {
            clickVote(+1);
            return false;
        });
        $(".topic-vote-down-149093").click(function () {
            clickVote(-1);
            return false;
        });
    });
</script></div>

    <script>
        $(function () {
            $(".topic-action-a").click(function () {
                const action = $(this).data("action");
                const topicTitle = $(this).data("topic-title");

                if (confirm("Are you sure you want to perform the action '" + action.toUpperCase()
                        + "' on the topic '" + topicTitle + "'?")) {
                    const topicId = $(this).data("topic-id");
                    const locale = $(this).data("topic-locale");
                    $.post("/data/topic", {action, topicId, locale}, function (json) {
                        Codeforces.reloadAndShowMessageOrShowError(json, json["message"]);
                    });
                }

                return false;
            });
        });
    </script>
        </div>
    </div>
                </div>
        </div>
            <br style="clear: both;">
            <div id="footer">
                <div><a href="https://codeforces.com/">Codeforces</a> (c) Copyright 2010-2025 Mike Mirzayanov</div>
                <div>The only programming contests Web 2.0 platform</div>
                    <div>Server time: Dec/14/2025 11:13:19<sup title="timezone offset" style="font-size:8px;">UTC</sup> (l3).</div>
                    <div>Desktop version, switch to <a rel="nofollow" class="switchToMobile" href="?mobile=true">mobile version</a>.</div>
                <div class="smaller">
                    <a href="/privacy">Privacy Policy</a>
                    |
                    <a href="/terms">Terms and Conditions</a>
                </div>

                    <div style="margin-top: 25px;">
                        Supported by
                    </div>
                    <div class="footer-logo-div" style="left: 30px;">
                        <a href="https://ton.org/"><img style="margin-right: 2em; width: 60px;" src="//codeforces.com/codeforces.org/s/52448/images/ton-100x100.png" alt="TON" title="TON"></a>
                        <div class="sep">&nbsp;</div>
                        <a href="https://en.itmo.ru/en/" class="itmo-logo"><img style="width: 140px;" src="//codeforces.com/codeforces.org/s/52448/images/itmo_small_en-logo.png" alt="ITMO University" title="ITMO University"></a>
                    </div>

            </div>
        <script type="text/javascript">
            $(function() {
                $(".switchToMobile").click(function() {
                    Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", "true"));
                    return false;
                });
                $(".switchToDesktop").click(function() {
                    Codeforces.redirect(Codeforces.updateUrlParameter(document.location.href, "mobile", "false"));
                    return false;
                });
            });
        </script>
    <script type="text/javascript">
        $(document).ready(function () {
            if ($(window).width() < 1600) {
                $('.button-up').css('width', '30px').css('line-height', '30px').css('font-size', '20px');
            }

            if ($(window).width() >= 1200) {
                $ (window).scroll (function () {
                    if ($ (this).scrollTop () > 100) {
                        $ ('.button-up').fadeIn();
                    } else {
                        $ ('.button-up').fadeOut();
                    }
                });

                $('.button-up').click(function () {
                    $('body,html').animate({
                        scrollTop: 0
                    }, 500);
                    return false;
                });

                $('.button-up').hover(function () {
                    $(this).animate({
                        'opacity':'1'
                    }).css({'background-color':'#e7ebf0','color':'#6a86a4'});
                }, function () {
                    $(this).animate({
                        'opacity':'0.7'
                    }).css({'background':'none','color':'#d3dbe4'});;
                });
            }

            Codeforces.focusOnError();

            Codeforces.setCopiedToClipboardText("Copied to clipboard");
            Codeforces.listenCopyable();
        });
    </script>
    <div class="userListsFacebox" style="display:none;">
        <div style="padding: 0.5em; width: 600px; max-height: 200px; overflow-y: auto">
<div class="datatable" style="background-color: #E1E1E1; padding-bottom: 3px;">
            <div class="lt">&nbsp;</div>
            <div class="rt">&nbsp;</div>
            <div class="lb">&nbsp;</div>
            <div class="rb">&nbsp;</div>

            <div style="padding: 4px 0 0 6px;font-size:1.4rem;position:relative;">
                User lists

                <div style="position:absolute;right:0.25em;top:0.35em;">
                    <span style="padding:0;position:relative;bottom:2px;" class="rowCount"></span>

                    <img class="closed" src="//codeforces.com/codeforces.org/s/52448/images/icons/magnifier-medium.png">

                    <span class="filter" style="display:none;">
                        <img class="opened" src="//codeforces.com/codeforces.org/s/52448/images/icons/control-270.png">
                        <input style="padding:0 0 0 20px;position:relative;bottom:2px;border:1px solid #aaa;height:17px;font-size:1.3rem;">
                    </span>
                </div>
            </div>
            <div style="background-color: white;margin:0.3em 3px 0 3px;position:relative;">
            <div class="ilt">&nbsp;</div>
            <div class="irt">&nbsp;</div>
            <table class="">
                <thead>
                <tr>
                    <th draggable="true" class="top left right">Name</th>
                </tr>
                </thead>
                <tbody>
                <tr class="no-items visible"><td style="text-align:left;" colspan="32" class="bottom dark left right">No items</td></tr></tbody>
            </table>
            </div>
        </div>
    <script type="text/javascript">
        $(document).ready(function () {
                // Create new ':containsIgnoreCase' selector for search
                jQuery.expr[':'].containsIgnoreCase = function(a, i, m) {
                    return jQuery(a).text().toUpperCase()
                            .indexOf(m[3].toUpperCase()) >= 0;
                };

                if (window.updateDatatableFilter == undefined) {
                    window.updateDatatableFilter = function(i) {
                        var parent = $(i).parent().parent().parent().parent();
                        $("tr.no-items", parent).remove();
                        $("tr", parent).hide().removeClass('visible');
                        var text = $(i).val();
                        if (text) {
                            $("tr" + ":containsIgnoreCase('" + text + "')", parent).show().addClass('visible');
                        } else {
                            parent.find(".rowCount").text("");
                            $("tr", parent).show().addClass('visible');
                        }

                        var found = false;
                        var visibleRowCount = 0;
                        $("tr", parent).each(function () {
                            if (!found) {
                                if ($(this).find("th").size() > 0) {
                                    $(this).show().addClass('visible');
                                    found = true;
                                }
                            }
                            if ($(this).hasClass('visible')) {
                                visibleRowCount++;
                            }
                        });
                        if (text) {
                            parent.find(".rowCount").text("Matches: " + (visibleRowCount - (found ? 1 : 0)));
                        }
                        if (visibleRowCount == (found ? 1 : 0)) {
                            $("<tr class='no-items visible'><td style=\"text-align:left;\"colspan=\"32\">No items<\/td><\/tr>").appendTo($(parent).find('table'));
                        }
                        $(parent).find("tr td").removeClass("dark");
                        $(parent).find("tr.visible:odd td").addClass("dark");
                    }

                    $(".datatable .closed").click(function () {
                        var parent = $(this).parent();
                        $(this).hide();
                        $(".filter", parent).fadeIn(function () {
                            $("input", parent).val("").focus().css("border", "1px solid #aaa");
                        });
                    });

                    $(".datatable .opened").click(function () {
                        var parent = $(this).parent().parent();
                        $(".filter", parent).fadeOut(function () {
                            $(".closed", parent).show();
                            $("input", parent).val("").each(function () {
                                window.updateDatatableFilter(this);
                            });
                        });
                    });

                    $(".datatable .filter input").keyup(function(e) {
                        window.updateDatatableFilter(this);
                        e.preventDefault();
                        e.stopPropagation();
                    });

                    $(".datatable table").each(function () {
                        var found = false;
                        $("tr", this).each(function () {
                            if (!found && $(this).find("th").size() == 0) {
                                found = true;
                            }
                        });
                        if (!found) {
                            $("<tr class='no-items visible'><td style=\"text-align:left;\"colspan=\"32\">No items<\/td><\/tr>").appendTo(this);
                        }
                    });

                    // Applies styles to datatables.
                    $(".datatable").each(function () {
                        $(this).find("tr:first th").addClass("top");
                        $(this).find("tr:last td").addClass("bottom");
                        $(this).find("tr:odd td").addClass("dark");
                        $(this).find("tr td:first-child, tr th:first-child").addClass("left");
                        $(this).find("tr td:last-child, tr th:last-child").addClass("right");
                    });

                    $(".datatable table.tablesorter").each(function () {
                        $(this).bind("sortEnd", function () {
                            $(".datatable").each(function () {
                                $(this).find("th, td")
                                    .removeClass("top").removeClass("bottom")
                                    .removeClass("left").removeClass("right")
                                    .removeClass("dark");
                                $(this).find("tr:first th").addClass("top");
                                $(this).find("tr:last td").addClass("bottom");
                                $(this).find("tr:odd td").addClass("dark");
                                $(this).find("tr td:first-child, tr th:first-child").addClass("left");
                                $(this).find("tr td:last-child, tr th:last-child").addClass("right");
                            });
                        });
                    });
                }
        });
    </script>
        </div>
    </div>
    <script type="application/javascript">
        $(function() {
            $(".userListMarker").click(function() {
                $.post("/data/lists", {action: "findTouched"}, function(json) {
                    Codeforces.facebox(".userListsFacebox");
                    var tbody = $("#facebox tbody");
                    tbody.empty();
                    for (var i in json) {
                        tbody.append(
                            $("<tr></tr>").append(
                                $("<td></td>").attr("data-readKey", json[i].readKey).text(json[i].name)
                            )
                        );
                    }
                    Codeforces.updateDatatables();
                    tbody.find("td").css("cursor", "pointer").click(function() {
                        document.location = Codeforces.updateUrlParameter(document.location.href, "list", $(this).attr("data-readKey"));
                    });
                }, "json");
            });
        });
    </script>
</div>
    <script type="application/javascript">
        if ('serviceWorker' in navigator && 'fetch' in window && 'caches' in window) {
            navigator.serviceWorker.register('/service-worker-52448.js')
                .then(function (registration) {
                    console.log('Service worker registered: ', registration);
                })
                .catch(function (error) {
                    console.log('Registration failed: ', error);
                });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9add456f6c948fa6',t:'MTc2NTcxMDc5OQ=='};var a=document.createElement('script');a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script><iframe height="1" width="1" style="position: absolute; top: 0px; left: 0px; border: none; visibility: hidden;"></iframe><script defer="" src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon="{&quot;version&quot;:&quot;2024.11.0&quot;,&quot;token&quot;:&quot;316c29dfa3804effb5a91c52a59b5bd0&quot;,&quot;server_timing&quot;:{&quot;name&quot;:{&quot;cfCacheStatus&quot;:true,&quot;cfEdge&quot;:true,&quot;cfExtPri&quot;:true,&quot;cfL4&quot;:true,&quot;cfOrigin&quot;:true,&quot;cfSpeedBrain&quot;:true},&quot;location_startswith&quot;:null}}" crossorigin="anonymous"></script>


<div id="datepick-div" style="display: none;"></div><div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" style="display: none; padding-bottom: 42px; padding-right: 42px;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxLoadedContent" style="width: 0px; height: 0px; overflow: hidden; float: left;"></div><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><div id="cboxNext" style="float: left;"></div><div id="cboxPrevious" style="float: left;"></div><div id="cboxSlideshow" style="float: left;"></div><div id="cboxClose" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none;"></div></div><div id="swfcontainer" style="visibility: visible;"></div><div id="userdata_el" style="visibility: hidden; position: absolute;"></div><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; min-width: 0px; max-width: none; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: MathJax_Size1, sans-serif;"></div></div></body></html>