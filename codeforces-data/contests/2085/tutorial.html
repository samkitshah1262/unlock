<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tutorial</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
      color: #333;
      background: #fafafa;
    }
    .ttypography {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    h3 {
      color: #1a1a1a;
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
    }
    h3 a {
      color: #0066cc;
      text-decoration: none;
    }
    h3 a:hover {
      text-decoration: underline;
    }
    .spoiler {
      margin: 15px 0;
      border: 1px solid #ddd;
      border-radius: 6px;
      overflow: hidden;
    }
    .spoiler-title {
      display: block;
      padding: 12px 15px;
      background: #f0f0f0;
      cursor: pointer;
      font-weight: 600;
      user-select: none;
      border-bottom: 1px solid #ddd;
    }
    .spoiler-title:hover {
      background: #e8e8e8;
    }
    .spoiler-title::before {
      content: '▶ ';
      font-size: 0.8em;
      transition: transform 0.2s;
      display: inline-block;
    }
    .spoiler.open .spoiler-title::before {
      content: '▼ ';
    }
    .spoiler-content {
      padding: 15px;
      background: #fff;
      display: none;
    }
    .spoiler.open .spoiler-content {
      display: block;
    }
    pre, code {
      background: #f5f5f5;
      font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
      font-size: 0.85em;
    }
    pre {
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
    code {
      padding: 2px 5px;
      border-radius: 3px;
    }
    p {
      margin: 10px 0;
    }
    .MathJax {
      font-size: 1.1em;
    }
  </style>
</head>
<body>
  <h1>Editorial</h1>
  <p><a href="https://codeforces.com/blog/entry/140933" target="_blank">View on Codeforces →</a></p>
  
  <div class="ttypography"><div class="spoiler"><b class="spoiler-title">Fun Fact 0</b><div class="spoiler-content" style="display: block;"><p><a href="https://arxiv.org/abs/1706.03762">Attention is all you need</a>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Fun Fact 1</b><div class="spoiler-content" style="display: block;"><p>The current problems are the original A A B C D E, respectively.</p></div></div> <div class="spoiler"><b class="spoiler-title">Fun Fact 2</b><div class="spoiler-content" style="display: block;"><p>The idea for problem D came up after eating at Sushiro, and the idea for problem E came up after eating at McDonald's. However, Sushiro is not a buffet restaurant. :(</p></div></div> <div class="spoiler"><b class="spoiler-title">Fun Fact 3</b><div class="spoiler-content" style="display: block;"><p>The intended solutions are short.</p></div></div> <div class="spoiler"><b class="spoiler-title">Fun Fact 4</b><div class="spoiler-content" style="display: block;"><p>Some (very) strong testers couldn't solve E when testing, and that's why we gave E so much score.</p></div></div> <div class="spoiler"><b class="spoiler-title">Fun Fact suggested by testers</b><div class="spoiler-content" style="display: block;"><p><img alt="..." src="https://codeforces.com/predownloaded/61/a0/61a03f0e26b325e41dd12a2aa483b30b9e9e7c30.png" style="max-width: 100.0%;max-height: 100.0%;"></p></div></div><h4><a href="https://codeforces.com/contest/2085/problem/A" title="Codeforces Round 1011 (Div. 2)">2085A - Сервал и теория строк</a></h4> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">s</span></span></span><script type="math/tex" id="MathJax-Element-1">s</script> is lexicographically equal to or greater than the reversal of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">s</span></span></span><script type="math/tex" id="MathJax-Element-2">s</script>, is it possible to make <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">s</span></span></span><script type="math/tex" id="MathJax-Element-3">s</script> <em>universal</em> by performing the operations?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>If possible, what is the minimum number of the operations required to make <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-7"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">s</span></span></span><script type="math/tex" id="MathJax-Element-4">s</script> <em>universal</em>?</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p><strong>Case 1.</strong> If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">s</span></span></span><script type="math/tex" id="MathJax-Element-5">s</script> contains only one kind of letter, the answer will be <code class="tt">NO</code>.</p><p><strong>Case 2.</strong> If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-11"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">s</span></span></span><script type="math/tex" id="MathJax-Element-6">s</script> is <em>universal</em> already, no operation is needed, and the answer will be <code class="tt">YES</code>.</p><p>Otherwise, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-13"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14">s</span></span></span><script type="math/tex" id="MathJax-Element-7">s</script> falls into the following <strong>Case 3</strong>.</p><p><strong>Case 3.1.</strong> When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-15"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16">s</span></span></span><script type="math/tex" id="MathJax-Element-8">s</script> is not a palindrome, one can make <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-17"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">s</span></span></span><script type="math/tex" id="MathJax-Element-9">s</script> <em>universal</em> in one operation by swapping the first pair of different letters of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-19"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">s</span></span></span><script type="math/tex" id="MathJax-Element-10">s</script> and its reversal.</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-21"><span class="MJXp-mrow" id="MJXp-Span-22"><span class="MJXp-mo" id="MJXp-Span-23" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mtable" id="MJXp-Span-24"><span><span class="MJXp-mtr" id="MJXp-Span-25" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-26" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27">s</span><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-29"></span></span><span class="MJXp-mtd" id="MJXp-Span-30" style="padding-left: 0em; text-align: left;"><span class="MJXp-mrow" id="MJXp-Span-31"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-32">s</span></span><span class="MJXp-mrow" id="MJXp-Span-33"><span class="MJXp-mstyle" id="MJXp-Span-34" style="color: red;"><span class="MJXp-munderover" id="MJXp-Span-35"><span class=""><span class="MJXp-mrow" id="MJXp-Span-36"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-37">t</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-38" style="margin-left: 0px; margin-right: 0.333em;">_</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-39"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-40">rings</span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-41" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-42" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mtext" id="MJXp-Span-43">reversal of&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">s</span><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-46"></span></span><span class="MJXp-mtd" id="MJXp-Span-47" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mrow" id="MJXp-Span-48"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-49">s</span></span><span class="MJXp-mrow" id="MJXp-Span-50"><span class="MJXp-mstyle" id="MJXp-Span-51" style="color: red;"><span class="MJXp-munderover" id="MJXp-Span-52"><span class=""><span class="MJXp-mrow" id="MJXp-Span-53"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-54">g</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-55" style="margin-left: 0px; margin-right: 0.333em;">_</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-56"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-57">nirts</span></span></span></span></span></span><span class="MJXp-mspace" id="MJXp-Span-58" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-59" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.033em;"><span class="MJXp-right MJXp-scale3" style="font-size: 5.133em; margin-left: -0.336em;">}</span></span></span><span class="MJXp-munderover" id="MJXp-Span-60"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mpadded" id="MJXp-Span-62" style="vertical-align: 0.15em; margin-right: 0px; margin-left: 0px;"><span class="MJXp-box" style="margin: -0.15em 0.333em 0.15em 0.278em;"><span class="MJXp-mtext" id="MJXp-Span-63">swap</span></span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-61" style="margin-left: 0.333em; margin-right: 0.333em;">→</span></span></span></span></span><span class="MJXp-menclose" id="MJXp-Span-64"><span class="MJXp-mrow" id="MJXp-Span-65"><span class="MJXp-mstyle" id="MJXp-Span-66"><span class="MJXp-mrow" id="MJXp-Span-67"><span class="MJXp-mrow" id="MJXp-Span-68"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-69">sgrints</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-11"> \left.\begin{aligned} s ={}& \texttt{s}{\color{red}{\underline{\texttt{t}}}}\texttt{rings} \\ \text{reversal of } s ={}& \texttt{s}{\color{red}{\underline{\texttt{g}}}}\texttt{nirts} \end{aligned}\;\right\} \xrightarrow{\text{swap}} \boxed{\texttt{sgrints}} </script></center><p><strong>Case 3.2.</strong> When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-70"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71">s</span></span></span><script type="math/tex" id="MathJax-Element-12">s</script> is a palindrome, swapping any two distinct letters will make <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-72"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73">s</span></span></span><script type="math/tex" id="MathJax-Element-13">s</script> no longer a palindrome. Note that the reversal of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-74"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">s</span></span></span><script type="math/tex" id="MathJax-Element-14">s</script> after the swap can be obtained by swapping the letters in the symmetric positions of the original <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-76"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77">s</span></span></span><script type="math/tex" id="MathJax-Element-15">s</script>. Since either <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-78"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79">s</span></span></span><script type="math/tex" id="MathJax-Element-16">s</script> or its reversal is <em>universal</em>, the original <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-80"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81">s</span></span></span><script type="math/tex" id="MathJax-Element-17">s</script> can be made <em>universal</em> in one operation.</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-82"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">s</span><span class="MJXp-mo" id="MJXp-Span-84" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-85"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-86">l</span></span><span class="MJXp-mrow" id="MJXp-Span-87"><span class="MJXp-mstyle" id="MJXp-Span-88" style="color: red;"><span class="MJXp-munderover" id="MJXp-Span-89"><span class=""><span class="MJXp-mrow" id="MJXp-Span-90"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-91">e</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-92" style="margin-left: 0px; margin-right: 0.333em;">_</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-93"><span class="MJXp-mstyle" id="MJXp-Span-94" style="color: blue;"><span class="MJXp-munderover" id="MJXp-Span-95"><span class=""><span class="MJXp-mrow" id="MJXp-Span-96"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-97">v</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-98" style="margin-left: 0px; margin-right: 0.333em;">_</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-99"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-100">el</span></span><span class="MJXp-munderover" id="MJXp-Span-101"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mpadded" id="MJXp-Span-103" style="vertical-align: 0.15em; margin-right: 0px; margin-left: 0px;"><span class="MJXp-box" style="margin: -0.15em 0.333em 0.15em 0.278em;"><span class="MJXp-mtext" id="MJXp-Span-104">swap</span></span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-102" style="margin-left: 0.333em; margin-right: 0.333em;">→</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-105"><span class="MJXp-mo" id="MJXp-Span-106" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.211em;"><span class="MJXp-right MJXp-scale3" style="font-size: 5.844em; margin-left: -0.336em;">{</span></span><span class="MJXp-mspace" id="MJXp-Span-107" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mtable" id="MJXp-Span-108"><span><span class="MJXp-mtr" id="MJXp-Span-109" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-110" style="text-align: right;"><span class="MJXp-msup" id="MJXp-Span-111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-113" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-114" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-115"></span></span><span class="MJXp-mtd" id="MJXp-Span-116" style="padding-left: 0em; text-align: left;"><span class="MJXp-mrow" id="MJXp-Span-117"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-118">l</span></span><span class="MJXp-mrow" id="MJXp-Span-119"><span class="MJXp-mstyle" id="MJXp-Span-120" style="color: blue;"><span class="MJXp-munderover" id="MJXp-Span-121"><span class=""><span class="MJXp-mrow" id="MJXp-Span-122"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-123">v</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-124" style="margin-left: 0px; margin-right: 0.333em;">_</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-125"><span class="MJXp-mstyle" id="MJXp-Span-126" style="color: red;"><span class="MJXp-munderover" id="MJXp-Span-127"><span class=""><span class="MJXp-mrow" id="MJXp-Span-128"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-129">e</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-130" style="margin-left: 0px; margin-right: 0.333em;">_</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-131"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-132">el</span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-133" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-134" style="padding-top: 0.3em; text-align: right;"><span class="MJXp-mtext" id="MJXp-Span-135">reversal of&nbsp;</span><span class="MJXp-msup" id="MJXp-Span-136"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137" style="margin-right: 0.05em;">s</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-138" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-139" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-140"></span></span><span class="MJXp-mtd" id="MJXp-Span-141" style="padding-left: 0em; padding-top: 0.3em; text-align: left;"><span class="MJXp-mrow" id="MJXp-Span-142"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-143">le</span></span><span class="MJXp-mrow" id="MJXp-Span-144"><span class="MJXp-mstyle" id="MJXp-Span-145" style="color: red;"><span class="MJXp-munderover" id="MJXp-Span-146"><span class=""><span class="MJXp-mrow" id="MJXp-Span-147"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-148">e</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-149" style="margin-left: 0px; margin-right: 0.333em;">_</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-150"><span class="MJXp-mstyle" id="MJXp-Span-151" style="color: blue;"><span class="MJXp-munderover" id="MJXp-Span-152"><span class=""><span class="MJXp-mrow" id="MJXp-Span-153"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-154">v</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-155" style="margin-left: 0px; margin-right: 0.333em;">_</span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-156"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-157">l</span></span></span></span></span></span><span class="MJXp-mspace" id="MJXp-Span-158" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-159" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.211em;"><span class="MJXp-right MJXp-scale3" style="font-size: 5.844em; margin-left: -0.336em;">}</span></span></span><span class="MJXp-mspace" id="MJXp-Span-160" style="width: 0.278em; height: 0em;"></span><span class="MJXp-menclose" id="MJXp-Span-161"><span class="MJXp-mrow" id="MJXp-Span-162"><span class="MJXp-mstyle" id="MJXp-Span-163"><span class="MJXp-mrow" id="MJXp-Span-164"><span class="MJXp-mrow" id="MJXp-Span-165"><span class="MJXp-mtext MJXp-mono" id="MJXp-Span-166">leevl</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-18"> s = \texttt{l}{\color{red}{\underline{\texttt{e}}}}{\color{blue}{\underline{\texttt{v}}}}\texttt{el} \xrightarrow{\text{swap}} \left\{\;\begin{aligned} s' ={}& \texttt{l}{\color{blue}{\underline{\texttt{v}}}}{\color{red}{\underline{\texttt{e}}}}\texttt{el} \\ \text{reversal of } s' ={}& \texttt{le}{\color{red}{\underline{\texttt{e}}}}{\color{blue}{\underline{\texttt{v}}}}\texttt{l} \end{aligned}\;\right\} \;\boxed{\texttt{leevl}} </script></center><p>Thus, for <strong>Case 3</strong>, the answer will be <code class="tt">NO</code> if no operation can be performed; otherwise, the answer will be <code class="tt">YES</code>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (Python)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="pln">getint </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
getints </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">())</span><span class="pln">

</span><span class="kwd">def</span><span class="pln"> solve</span><span class="pun">():</span><span class="pln">
	n</span><span class="pun">,</span><span class="pln"> k </span><span class="pun">=</span><span class="pln"> getints</span><span class="pun">()</span><span class="pln">
	s </span><span class="pun">=</span><span class="pln"> input</span><span class="pun">().</span><span class="pln">strip</span><span class="pun">()</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> s </span><span class="pun">&lt;</span><span class="pln"> s</span><span class="pun">[::-</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="kwd">or</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">s</span><span class="pun">)</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">s</span><span class="pun">)):</span><span class="pln">
		</span><span class="kwd">print</span><span class="pun">(</span><span class="str">'YES'</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
		</span><span class="kwd">print</span><span class="pun">(</span><span class="str">'NO'</span><span class="pun">)</span><span class="pln">

t </span><span class="pun">=</span><span class="pln"> getint</span><span class="pun">()</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">t</span><span class="pun">):</span><span class="pln">
	solve</span><span class="pun">()</span></code></pre></div></div><h4><a href="https://codeforces.com/contest/2085/problem/B" title="Codeforces Round 1011 (Div. 2)">2085B - Сервал и итоговый MEX</a></h4> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Before the last operation, what should the array be to obtain <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-167"><span class="MJXp-mn" id="MJXp-Span-168">0</span></span></span><script type="math/tex" id="MathJax-Element-19">0</script>?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>How to make all the elements in the array non-zero?</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Note that before the last operation, all the integers in the array should be positive. Thus, we aim to turn the zeroes in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-169"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">a</span></span></span><script type="math/tex" id="MathJax-Element-20">a</script> into non-zeroes. To achieve this, we split the given array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-171"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">a</span></span></span><script type="math/tex" id="MathJax-Element-21">a</script> into two halves and perform the operations on the halves that contain zeroes. After that, there will be no zeroes in either of the two halves. The final <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-173"><span class="MJXp-mn" id="MJXp-Span-174">0</span></span></span><script type="math/tex" id="MathJax-Element-22">0</script> can be obtained by performing the last operation on the entire array.</p> <center><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-175"><span class="MJXp-mo" id="MJXp-Span-176" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mrow" id="MJXp-Span-177"><span class="MJXp-mstyle" id="MJXp-Span-178" style="color: red;"><span class="MJXp-munderover" id="MJXp-Span-179"><span class=""><span class="MJXp-mn" id="MJXp-Span-180">1</span><span class="MJXp-mo" id="MJXp-Span-181" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-182">0</span><span class="MJXp-mo" id="MJXp-Span-183" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-184">1</span><span class="MJXp-mo" id="MJXp-Span-185" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-186">1</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-187" style="margin-left: 0px; margin-right: 0.333em;">_</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-189"><span class="MJXp-mstyle" id="MJXp-Span-190" style="color: blue;"><span class="MJXp-mn" id="MJXp-Span-191">2</span><span class="MJXp-mo" id="MJXp-Span-192" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-193">0</span><span class="MJXp-mo" id="MJXp-Span-194" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-195">8</span><span class="MJXp-mo" id="MJXp-Span-196" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-197">5</span></span></span><span class="MJXp-mo" id="MJXp-Span-198" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-199" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mo" id="MJXp-Span-200" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mrow" id="MJXp-Span-201"><span class="MJXp-mstyle" id="MJXp-Span-202" style="color: red;"><span class="MJXp-mn" id="MJXp-Span-203">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-204" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-205"><span class="MJXp-mstyle" id="MJXp-Span-206" style="color: blue;"><span class="MJXp-munderover" id="MJXp-Span-207"><span class=""><span class="MJXp-mn" id="MJXp-Span-208">2</span><span class="MJXp-mo" id="MJXp-Span-209" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-210">0</span><span class="MJXp-mo" id="MJXp-Span-211" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-212">8</span><span class="MJXp-mo" id="MJXp-Span-213" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-214">5</span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-215" style="margin-left: 0px; margin-right: 0.333em;">_</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-216" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-217" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mo" id="MJXp-Span-218" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-munderover" id="MJXp-Span-219"><span class=""><span class="MJXp-mrow" id="MJXp-Span-220"><span class="MJXp-mstyle" id="MJXp-Span-221" style="color: red;"><span class="MJXp-mn" id="MJXp-Span-222">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-223" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mrow" id="MJXp-Span-224"><span class="MJXp-mstyle" id="MJXp-Span-225" style="color: blue;"><span class="MJXp-mn" id="MJXp-Span-226">1</span></span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-227" style="margin-left: 0px; margin-right: 0.333em;">_</span></span></span><span class="MJXp-mo" id="MJXp-Span-228" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-229" style="margin-left: 0.333em; margin-right: 0.333em;">→</span><span class="MJXp-mo" id="MJXp-Span-230" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-231">0</span><span class="MJXp-mo" id="MJXp-Span-232" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><script type="math/tex" id="MathJax-Element-23"> [{\color{red}{\underline{1, 0, 1, 1}}}, {\color{blue}{2, 0, 8, 5}}] \to [{\color{red}{2}}, {\color{blue}{\underline{2, 0, 8, 5}}}] \to [\underline{{\color{red}{2}}, {\color{blue}{1}}}] \to [0] </script></center></div></div> <div class="spoiler"><b class="spoiler-title">Another Hint</b><div class="spoiler-content" style="display: block;"><p>In fact, the final element can be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-233"><span class="MJXp-mn" id="MJXp-Span-234">0</span></span></span><script type="math/tex" id="MathJax-Element-24">0</script> after the operations for any array of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-235"><span class="MJXp-mn" id="MJXp-Span-236">4</span></span></span><script type="math/tex" id="MathJax-Element-25">4</script>. Can you solve the problem under the constraint of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-237"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">n</span><span class="MJXp-mo" id="MJXp-Span-239" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-240">4</span></span></span><script type="math/tex" id="MathJax-Element-26">n=4</script>?</p></div></div> <div class="spoiler"><b class="spoiler-title">Another Solution</b><div class="spoiler-content" style="display: block;"><p>When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-241"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">n</span><span class="MJXp-mo" id="MJXp-Span-243" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-244">4</span></span></span><script type="math/tex" id="MathJax-Element-27">n>4</script>, you can perform the operation on any subarray of length <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-245"><span class="MJXp-mo" id="MJXp-Span-246" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">n</span><span class="MJXp-mo" id="MJXp-Span-248" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-249">3</span><span class="MJXp-mo" id="MJXp-Span-250" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-28">(n-3)</script>. After the operation, the array <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-251"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252">a</span></span></span><script type="math/tex" id="MathJax-Element-29">a</script> will contain only <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-253"><span class="MJXp-mn" id="MJXp-Span-254">4</span></span></span><script type="math/tex" id="MathJax-Element-30">4</script> integers, which can be solved by brute force.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (Python)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="pln">getint </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
getints </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">())</span><span class="pln">

</span><span class="kwd">def</span><span class="pln"> solve</span><span class="pun">():</span><span class="pln">
	n </span><span class="pun">=</span><span class="pln"> getint</span><span class="pun">()</span><span class="pln">
	a </span><span class="pun">=</span><span class="pln"> list</span><span class="pun">(</span><span class="pln">getints</span><span class="pun">())</span><span class="pln">
	op </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[]</span><span class="pln">
	mid</span><span class="pun">,</span><span class="pln"> r </span><span class="pun">=</span><span class="pln"> n </span><span class="com">// 2, n</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">mid</span><span class="pun">:]:</span><span class="pln">
		op</span><span class="pun">.</span><span class="pln">append</span><span class="pun">([</span><span class="pln">mid </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> n</span><span class="pun">])</span><span class="pln">
		r </span><span class="pun">-=</span><span class="pln"> n </span><span class="pun">-</span><span class="pln"> mid </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> a</span><span class="pun">[:</span><span class="pln">mid</span><span class="pun">]:</span><span class="pln">
		op</span><span class="pun">.</span><span class="pln">append</span><span class="pun">([</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> mid</span><span class="pun">])</span><span class="pln">
		r </span><span class="pun">-=</span><span class="pln"> mid </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
	op</span><span class="pun">.</span><span class="pln">append</span><span class="pun">([</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">])</span><span class="pln">
	</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">len</span><span class="pun">(</span><span class="pln">op</span><span class="pun">))</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> o </span><span class="kwd">in</span><span class="pln"> op</span><span class="pun">:</span><span class="pln">
		</span><span class="kwd">print</span><span class="pun">(*</span><span class="pln">o</span><span class="pun">)</span><span class="pln">

t </span><span class="pun">=</span><span class="pln"> getint</span><span class="pun">()</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">t</span><span class="pun">):</span><span class="pln">
	solve</span><span class="pun">()</span></code></pre></div></div><h4><a href="https://codeforces.com/contest/2085/problem/C" title="Codeforces Round 1011 (Div. 2)">2085C - Сервал и формула</a></h4> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>The formula <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-255"><span class="MJXp-mo" id="MJXp-Span-256" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">x</span><span class="MJXp-mo" id="MJXp-Span-258" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">k</span><span class="MJXp-mo" id="MJXp-Span-260" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-261" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-262" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263">y</span><span class="MJXp-mo" id="MJXp-Span-264" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">k</span><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-267" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-268" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269">x</span><span class="MJXp-mo" id="MJXp-Span-270" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">k</span><span class="MJXp-mo" id="MJXp-Span-272" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-273" style="margin-left: 0.267em; margin-right: 0.267em;">⊕</span><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">y</span><span class="MJXp-mo" id="MJXp-Span-276" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">k</span><span class="MJXp-mo" id="MJXp-Span-278" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-31">(x+k) + (y+k) = (x+k) \oplus (y+k)</script> is equivalent to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-279"><span class="MJXp-mo" id="MJXp-Span-280" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">x</span><span class="MJXp-mo" id="MJXp-Span-282" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">k</span><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-285"><span class="MJXp-mi" id="MJXp-Span-286">&amp;</span></span><span class="MJXp-mo" id="MJXp-Span-287" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">y</span><span class="MJXp-mo" id="MJXp-Span-289" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">k</span><span class="MJXp-mo" id="MJXp-Span-291" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-292" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-293">0</span></span></span><script type="math/tex" id="MathJax-Element-32">(x+k) \mathbin{\&} (y+k) = 0</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-294"><span class="MJXp-mi" id="MJXp-Span-295">&amp;</span></span></span><script type="math/tex" id="MathJax-Element-33">\&</script> denotes the bitwise AND operation.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Note that a power of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-296"><span class="MJXp-mn" id="MJXp-Span-297">2</span></span></span><script type="math/tex" id="MathJax-Element-34">2</script> shares no common bits with any positive integer less than it.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>It can be shown that such an non-negative integer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-298"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">k</span></span></span><script type="math/tex" id="MathJax-Element-35">k</script> does not exist when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-300"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">x</span><span class="MJXp-mo" id="MJXp-Span-302" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">y</span></span></span><script type="math/tex" id="MathJax-Element-36">x=y</script>.</p><p>When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-304"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">x</span><span class="MJXp-mo" id="MJXp-Span-306" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">y</span></span></span><script type="math/tex" id="MathJax-Element-37">x\neq y</script>, one can show that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-316"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">k</span><span class="MJXp-mo" id="MJXp-Span-318" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-319"><span class="MJXp-mn" id="MJXp-Span-320" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-321" style="vertical-align: 0.5em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-322" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-323" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-324" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">x</span><span class="MJXp-mo" id="MJXp-Span-326" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">y</span><span class="MJXp-mo" id="MJXp-Span-328" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-38">k = 2^n - \max(x, y)</script> is a possible answer, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-329"><span class="MJXp-msubsup" id="MJXp-Span-330"><span class="MJXp-mn" id="MJXp-Span-331" style="margin-right: 0.05em;">2</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-332" style="vertical-align: 0.5em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-39">2^n</script> is a power of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-333"><span class="MJXp-mn" id="MJXp-Span-334">2</span></span></span><script type="math/tex" id="MathJax-Element-40">2</script> that is sufficiently large.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (Python)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="pln">getint </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">(</span><span class="pln">input</span><span class="pun">())</span><span class="pln">
getints </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">lambda</span><span class="pun">:</span><span class="pln"> map</span><span class="pun">(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> input</span><span class="pun">().</span><span class="pln">split</span><span class="pun">())</span><span class="pln">

</span><span class="kwd">def</span><span class="pln"> solve</span><span class="pun">():</span><span class="pln">
	x</span><span class="pun">,</span><span class="pln"> y </span><span class="pun">=</span><span class="pln"> getints</span><span class="pun">()</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> x </span><span class="pun">==</span><span class="pln"> y</span><span class="pun">:</span><span class="pln">
		</span><span class="kwd">print</span><span class="pun">(-</span><span class="lit">1</span><span class="pun">)</span><span class="pln">
	</span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
		</span><span class="kwd">print</span><span class="pun">(</span><span class="lit">2</span><span class="pln"> </span><span class="pun">**</span><span class="pln"> </span><span class="lit">48</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> max</span><span class="pun">(</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">))</span><span class="pln">

t </span><span class="pun">=</span><span class="pln"> getint</span><span class="pun">()</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> _ </span><span class="kwd">in</span><span class="pln"> range</span><span class="pun">(</span><span class="pln">t</span><span class="pun">):</span><span class="pln">
	solve</span><span class="pun">()</span></code></pre></div></div><h4><a href="https://codeforces.com/contest/2085/problem/D" title="Codeforces Round 1011 (Div. 2)">2085D - Сервал и суши-ресторан</a></h4> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Do not go for DP.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>How many plates of sushi can be taken?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>What are the constraints on the time of taking plates of sushi?</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Note that the last <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-335"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">i</span></span></span><script type="math/tex" id="MathJax-Element-41">i</script>-th time taking a plate of sushi should be no later than the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-337"><span class="MJXp-mo" id="MJXp-Span-338" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339">n</span><span class="MJXp-mo" id="MJXp-Span-340" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341">i</span><span class="MJXp-mo" id="MJXp-Span-342" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-343" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344">k</span><span class="MJXp-mo" id="MJXp-Span-345" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-346">1</span><span class="MJXp-mo" id="MJXp-Span-347" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-348" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-349">1</span><span class="MJXp-mo" id="MJXp-Span-350" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-42">(n - i\cdot(k+1) + 1)</script>-th minute. This constraint limits the time that a taking action can be performed. Therefore, we enumerate the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-351"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">n</span></span></span><script type="math/tex" id="MathJax-Element-43">n</script> minutes in chronological order, and greedily take the untaken plates delivered before with the greatest <em>deliciousness</em> when we reach a constraint, i.e., the current minute is the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-353"><span class="MJXp-mo" id="MJXp-Span-354" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">n</span><span class="MJXp-mo" id="MJXp-Span-356" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357">i</span><span class="MJXp-mo" id="MJXp-Span-358" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mo" id="MJXp-Span-359" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360">k</span><span class="MJXp-mo" id="MJXp-Span-361" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-362">1</span><span class="MJXp-mo" id="MJXp-Span-363" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-364" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-365">1</span><span class="MJXp-mo" id="MJXp-Span-366" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-44">(n - i\cdot(k+1) + 1)</script>-th minute for a certain <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-367"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368">i</span></span></span><script type="math/tex" id="MathJax-Element-45">i</script>. The <em>deliciousnesses</em> of the untaken plates can be maintained by a heap. The total complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-369"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">O</span><span class="MJXp-mo" id="MJXp-Span-371" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">n</span><span class="MJXp-mi" id="MJXp-Span-373">log</span><span class="MJXp-mo" id="MJXp-Span-374" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375">n</span><span class="MJXp-mo" id="MJXp-Span-376" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-46">O(n \log n)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstdio&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;queue&gt;</span><span class="pln">

</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2e5</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">5</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">k</span><span class="pun">);</span><span class="pln">
	ans </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	priority_queue </span><span class="str">&lt;int&gt;</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
		q</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="pln">d</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">n </span><span class="pun">-</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			ans </span><span class="pun">+=</span><span class="pln"> q</span><span class="pun">.</span><span class="pln">top</span><span class="pun">();</span><span class="pln">
			q</span><span class="pun">.</span><span class="pln">pop</span><span class="pun">();</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	printf</span><span class="pun">(</span><span class="str">"%lld\n"</span><span class="pun">,</span><span class="pln"> ans</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">t</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln">
		solve</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><h4><a href="https://codeforces.com/contest/2085/problem/E" title="Codeforces Round 1011 (Div. 2)">2085E - Сервал и модуль</a></h4> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>What happens when an integer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-377"><span class="MJXp-msubsup" id="MJXp-Span-378"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-380" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-47">a_i</script> mods <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-381"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382">k</span></span></span><script type="math/tex" id="MathJax-Element-48">k</script>?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Note that the difference between <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-383"><span class="MJXp-msubsup" id="MJXp-Span-384"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-386" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-49">a_i</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-387"><span class="MJXp-msubsup" id="MJXp-Span-388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-390" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-50">b_i</script> is a multiple of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-391"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392">k</span></span></span><script type="math/tex" id="MathJax-Element-51">k</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>The same holds for the difference between the sum of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-393"><span class="MJXp-msubsup" id="MJXp-Span-394"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-396" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-52">a_i</script> and the sum of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-397"><span class="MJXp-msubsup" id="MJXp-Span-398"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-400" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-53">b_i</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 4</b><div class="spoiler-content" style="display: block;"><p>Notice that <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">d</span><span class="MJXp-mo" id="MJXp-Span-403" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404">n</span><span class="MJXp-mo" id="MJXp-Span-405" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-406" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mn" id="MJXp-Span-407">2304</span></span></span><script type="math/tex" id="MathJax-Element-54">d(n) \leq 2304</script> holds for all <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">n</span><span class="MJXp-mo" id="MJXp-Span-410" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-msubsup" id="MJXp-Span-411"><span class="MJXp-mn" id="MJXp-Span-412" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-413" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-414">10</span></span></span></span></span><script type="math/tex" id="MathJax-Element-55">n \leq 10^{10}</script>, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416">d</span><span class="MJXp-mo" id="MJXp-Span-417" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">n</span><span class="MJXp-mo" id="MJXp-Span-419" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-56">d(n)</script> denotes the number of divisors of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-420"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421">n</span></span></span><script type="math/tex" id="MathJax-Element-57">n</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Note that if such a magic number <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-422"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">k</span></span></span><script type="math/tex" id="MathJax-Element-58">k</script> exists, it will be a divisor of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-424"><span class="MJXp-mi" id="MJXp-Span-425">Δ</span><span class="MJXp-mo" id="MJXp-Span-426" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-427" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-msubsup" id="MJXp-Span-428"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-430" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-431" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mo" id="MJXp-Span-432" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-msubsup" id="MJXp-Span-433"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-434" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-435" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-59">\Delta = \sum a_i - \sum b_i</script> when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-436"><span class="MJXp-mi" id="MJXp-Span-437">Δ</span><span class="MJXp-mo" id="MJXp-Span-438" style="margin-left: 0.333em; margin-right: 0.333em;">≠</span><span class="MJXp-mn" id="MJXp-Span-439">0</span></span></span><script type="math/tex" id="MathJax-Element-60">\Delta \neq 0</script>, or it can be any integer greater than all the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-440"><span class="MJXp-msubsup" id="MJXp-Span-441"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-443" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-61">a_i</script>. Thus, we can check all the divisors of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-444"><span class="MJXp-mi" id="MJXp-Span-445">Δ</span></span></span><script type="math/tex" id="MathJax-Element-62">\Delta</script>, resulting in a solution of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447">O</span><span class="MJXp-mrow" id="MJXp-Span-448"><span class="MJXp-mo" id="MJXp-Span-449" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">(</span></span><span class="MJXp-mo" id="MJXp-Span-450" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-mo" id="MJXp-Span-451" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">n</span><span class="MJXp-mo" id="MJXp-Span-453" style="margin-left: 0.267em; margin-right: 0.267em;">⋅</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">d</span><span class="MJXp-mo" id="MJXp-Span-455" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-456" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-msubsup" id="MJXp-Span-457"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-459" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-460" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-461" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msqrt" id="MJXp-Span-462"><span class="MJXp-surd"><span class="MJXp-right MJXp-scale9" style="font-size: 169%; margin-top: 0.083em; margin-left: -0.055em;">√</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.084em solid;"></span><span class="MJXp-box"><span class="MJXp-mo" id="MJXp-Span-463" style="margin-left: 0.111em; margin-right: 0.167em;">∑</span><span class="MJXp-msubsup" id="MJXp-Span-464"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-465" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-466" style="vertical-align: -0.4em;">i</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-467" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-468" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.244em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.978em; margin-left: -0.05em;">)</span></span></span></span></span><script type="math/tex" id="MathJax-Element-63">O\left(\sum (n \cdot d(\sum a_i) + \sqrt{\sum a_i})\right)</script> time, where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-469"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470">d</span><span class="MJXp-mo" id="MJXp-Span-471" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-472">n</span><span class="MJXp-mo" id="MJXp-Span-473" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-64">d(n)</script> denotes the number of divisors of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-474"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">n</span></span></span><script type="math/tex" id="MathJax-Element-65">n</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstdio&gt;</span><span class="pln">

</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e4</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">5</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> C </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e6</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">5</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln"> b</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> cnt</span><span class="pun">[</span><span class="pln">C</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> s</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">bool</span><span class="pln"> check</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
		cnt</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> k</span><span class="pun">]++;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(--</span><span class="pln">cnt</span><span class="pun">[</span><span class="pln">b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			cnt</span><span class="pun">[</span><span class="pln">b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
				cnt</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> k</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">);</span><span class="pln">
	s </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
		s </span><span class="pun">+=</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
		s </span><span class="pun">-=</span><span class="pln"> b</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln"> check</span><span class="pun">(</span><span class="lit">0xc0ffee</span><span class="pun">)</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> </span><span class="lit">0xc0ffee</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> </span><span class="lit">1ll</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">*</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> s</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">%</span><span class="pln"> i </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">check</span><span class="pun">(</span><span class="pln">i</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
				printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln"> i</span><span class="pun">);</span><span class="pln">
				</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">&lt;</span><span class="pln"> C </span><span class="pun">&amp;&amp;</span><span class="pln"> check</span><span class="pun">(</span><span class="pln">s </span><span class="pun">/</span><span class="pln"> i</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
				printf</span><span class="pun">(</span><span class="str">"%d\n"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pun">)(</span><span class="pln">s </span><span class="pun">/</span><span class="pln"> i</span><span class="pun">));</span><span class="pln">
				</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
	printf</span><span class="pun">(</span><span class="str">"-1\n"</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">t</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">t</span><span class="pun">--)</span><span class="pln">
		solve</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><h4><a href="https://codeforces.com/contest/2085/problem/F1" title="Codeforces Round 1011 (Div. 2)">2085F1 - Сервал и цветной массив (простая версия)</a></h4> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Consider the integers in the <em>colorful</em> subarray after swapping.</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>How to gather these integers together, forming a <em>colorful</em> subarray, with the minimum number of swaps?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 3</b><div class="spoiler-content" style="display: block;"><p>Consider the middle one among all the the elements in the <em>colorful</em> subarray.</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Consider the elements in the <em>colorful</em> subarray after swapping. The first observation is as follows.</p><p><strong>Observation.</strong> Mark the elements in the <em>colorful</em> subarray. Before swapping, to make these marked elements continuous, gathering them toward the middle one among them minimizes the number of swaps.</p><p><strong>Proof.</strong> It is not optimal to swap two marked elements. Thus, the leftmost <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-476"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477">x</span></span></span><script type="math/tex" id="MathJax-Element-66">x</script> elements will move to their right, and the rightmost <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-478"><span class="MJXp-mo" id="MJXp-Span-479" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">k</span><span class="MJXp-mo" id="MJXp-Span-481" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482">x</span><span class="MJXp-mo" id="MJXp-Span-483" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-67">(k-x)</script> elements will move to their left. They will meet at some point between the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-484"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485">x</span></span></span><script type="math/tex" id="MathJax-Element-68">x</script>-th element and the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-486"><span class="MJXp-mo" id="MJXp-Span-487" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488">x</span><span class="MJXp-mo" id="MJXp-Span-489" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-490">1</span><span class="MJXp-mo" id="MJXp-Span-491" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-69">(x+1)</script>-th element. If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-492"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-493">x</span><span class="MJXp-mo" id="MJXp-Span-494" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mrow" id="MJXp-Span-495"><span class="MJXp-mfrac" id="MJXp-Span-496" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497">k</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-498">2</span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-70">x < {k\over 2}</script>, adjusting the meeting point to its right reduces <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-499"><span class="MJXp-mo" id="MJXp-Span-500" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-501">k</span><span class="MJXp-mo" id="MJXp-Span-502" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">x</span><span class="MJXp-mo" id="MJXp-Span-504" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-505" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506">x</span><span class="MJXp-mo" id="MJXp-Span-507" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-508">0</span></span></span><script type="math/tex" id="MathJax-Element-71">(k-x)-x > 0</script> swaps. If <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510">x</span><span class="MJXp-mo" id="MJXp-Span-511" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mrow" id="MJXp-Span-512"><span class="MJXp-mfrac" id="MJXp-Span-513" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">k</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-515">2</span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-72">x > {k\over 2}</script>, we can adjust it to its left and reduce the number of swaps similarly. Therefore, one can show that setting the meeting point to the middle of them is optimal through adjustments. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-516"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517">◻</span></span></span><script type="math/tex" id="MathJax-Element-73">\square</script></p><p>From the observation we can also conclude that, the minimum number of swaps required to make the marked elements continuous is the difference between the sum of the distances from each marked element to the middle position before swapping and that sum after swapping, if the marked elements are swapped toward the middle position. Notice that the latter sum is a fixed constant only related to <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-518"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519">k</span></span></span><script type="math/tex" id="MathJax-Element-74">k</script>.</p><p>Focusing on the middle position of the <em>colorful</em> subarray, we enumerate all the positions in the array as possible middle positions. For each possible middle position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-520"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521">p</span></span></span><script type="math/tex" id="MathJax-Element-75">p</script>, to form the <em>colorful</em> subarray whose middle position is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-523">p</span></span></span><script type="math/tex" id="MathJax-Element-76">p</script>, we should choose <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-524"><span class="MJXp-mrow" id="MJXp-Span-525"><span class="MJXp-mfrac" id="MJXp-Span-526" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527">k</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-528">2</span></span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-77">{k\over 2}</script> distinct integers from its left and the other <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-529"><span class="MJXp-mfrac" id="MJXp-Span-530" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">k</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-532">2</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-78">k\over 2</script> from its right. The rounding of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-533"><span class="MJXp-mfrac" id="MJXp-Span-534" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">k</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-536">2</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-79">k\over 2</script> will not affect the correctness as long as the sum of the rounded numbers is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-537"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">k</span></span></span><script type="math/tex" id="MathJax-Element-80">k</script>.</p><p>For each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-539"><span class="MJXp-mn" id="MJXp-Span-540">1</span><span class="MJXp-mo" id="MJXp-Span-541" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-542">i</span><span class="MJXp-mo" id="MJXp-Span-543" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544">k</span></span></span><script type="math/tex" id="MathJax-Element-81">1\leq i\leq k</script>, we should determine whether <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546">i</span></span></span><script type="math/tex" id="MathJax-Element-82">i</script> should be chosen from the left side of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-547"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-548">p</span></span></span><script type="math/tex" id="MathJax-Element-83">p</script> or the right side of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-549"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-550">p</span></span></span><script type="math/tex" id="MathJax-Element-84">p</script>. Let the distance from <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-551"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">p</span></span></span><script type="math/tex" id="MathJax-Element-85">p</script> to the rightmost integer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-553"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">i</span></span></span><script type="math/tex" id="MathJax-Element-86">i</script> on its left be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-555"><span class="MJXp-msubsup" id="MJXp-Span-556"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-558" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-87">l_i</script>, and the distance for the right side be <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-559"><span class="MJXp-msubsup" id="MJXp-Span-560"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-561" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-562" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-88">r_i</script>. We should choose either <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-563"><span class="MJXp-msubsup" id="MJXp-Span-564"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-566" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-89">l_i</script> or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-567"><span class="MJXp-msubsup" id="MJXp-Span-568"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-570" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-90">r_i</script> for each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-571"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572">i</span></span></span><script type="math/tex" id="MathJax-Element-91">i</script> under the constraint that both the number of chosen <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-573"><span class="MJXp-msubsup" id="MJXp-Span-574"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-576" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-92">l_i</script> and that of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-577"><span class="MJXp-msubsup" id="MJXp-Span-578"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-579" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-580" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-93">r_i</script> are <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-581"><span class="MJXp-mfrac" id="MJXp-Span-582" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583">k</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-584">2</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-94">k\over 2</script>, minimizing the sum of the distances we choose. This can be done by first forcing to choose all the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-585"><span class="MJXp-msubsup" id="MJXp-Span-586"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-588" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-95">l_i</script>, and then choosing the smallest <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-589"><span class="MJXp-mfrac" id="MJXp-Span-590" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-591">k</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-592">2</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-96">k\over 2</script> elements of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-593"><span class="MJXp-mo" id="MJXp-Span-594" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-595"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-596" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-597" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-598" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-599"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-601" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-602" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-97">(r_i-l_i)</script> greedily.</p><p>In implementation, when enumerating the middle position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-603"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-604">p</span></span></span><script type="math/tex" id="MathJax-Element-98">p</script>, both <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-605"><span class="MJXp-msubsup" id="MJXp-Span-606"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-608" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-99">l_i</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-609"><span class="MJXp-msubsup" id="MJXp-Span-610"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-611" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-612" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-100">r_i</script> can be simply calculated in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-613"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-614">O</span><span class="MJXp-mo" id="MJXp-Span-615" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-616">n</span><span class="MJXp-mo" id="MJXp-Span-617" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-101">O(n)</script> time, and then sort <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-618"><span class="MJXp-mo" id="MJXp-Span-619" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-620"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-622" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-623" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-624"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-626" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-627" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-102">(r_i - l_i)</script> in <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-628"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-629">O</span><span class="MJXp-mo" id="MJXp-Span-630" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631">n</span><span class="MJXp-mi" id="MJXp-Span-632">log</span><span class="MJXp-mo" id="MJXp-Span-633" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-634">n</span><span class="MJXp-mo" id="MJXp-Span-635" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-103">O(n\log n)</script> time. The total complexity is <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-636"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637">O</span><span class="MJXp-mo" id="MJXp-Span-638" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-639"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-641" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi" id="MJXp-Span-642">log</span><span class="MJXp-mo" id="MJXp-Span-643" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644">n</span><span class="MJXp-mo" id="MJXp-Span-645" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-104">O(n^2\log n)</script>.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstdio&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;algorithm&gt;</span><span class="pln">

</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3005</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> oo </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e18</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln"> l</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln"> r</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">k</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
	ans </span><span class="pun">=</span><span class="pln"> oo</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;=</span><span class="pln"> k</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln">
			l</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> n </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">--)</span><span class="pln">
			l</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">l</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]],</span><span class="pln"> i </span><span class="pun">-</span><span class="pln"> j</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln">
			r</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">r</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]],</span><span class="pln"> j </span><span class="pun">-</span><span class="pln"> i</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> s </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;=</span><span class="pln"> k</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			s </span><span class="pun">+=</span><span class="pln"> l</span><span class="pun">[</span><span class="pln">j</span><span class="pun">];</span><span class="pln">
			d</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">[</span><span class="pln">j</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> l</span><span class="pun">[</span><span class="pln">j</span><span class="pun">];</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		sort</span><span class="pun">(</span><span class="pln">d </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> d </span><span class="pun">+</span><span class="pln"> k </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
		</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln">
			s </span><span class="pun">+=</span><span class="pln"> d</span><span class="pun">[</span><span class="pln">j</span><span class="pun">];</span><span class="pln">
		ans </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">,</span><span class="pln"> s</span><span class="pun">);</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> k</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
		ans </span><span class="pun">-=</span><span class="pln"> abs</span><span class="pun">(</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">);</span><span class="pln">
	printf</span><span class="pun">(</span><span class="str">"%lld\n"</span><span class="pun">,</span><span class="pln"> ans</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">T</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln">
		solve</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div><h4><a href="https://codeforces.com/contest/2085/problem/F2" title="Codeforces Round 1011 (Div. 2)">2085F2 - Сервал и цветной массив (сложная версия)</a></h4> <div class="spoiler"><b class="spoiler-title">Hint 1</b><div class="spoiler-content" style="display: block;"><p>Is it possible to simplify the constraints?</p></div></div> <div class="spoiler"><b class="spoiler-title">Hint 2</b><div class="spoiler-content" style="display: block;"><p>Is it possible to remove the constraint that exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-646"><span class="MJXp-mfrac" id="MJXp-Span-647" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">k</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-649">2</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-105">k\over 2</script> elements should be chosen from both sides of the enumerated position?</p></div></div> <div class="spoiler"><b class="spoiler-title">Solution</b><div class="spoiler-content" style="display: block;"><p>Optimizing the solution of F1 using (possibly, heavy) data structures results in a <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-650"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651">O</span><span class="MJXp-mo" id="MJXp-Span-652" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653">n</span><span class="MJXp-mi" id="MJXp-Span-654">log</span><span class="MJXp-mo" id="MJXp-Span-655" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-656">n</span><span class="MJXp-mo" id="MJXp-Span-657" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-106">O(n\log n)</script> solution.</p><p>Here we introduce a linear approach for F2 came up by <a class="rated-user user-red" href="https://codeforces.com/profile/Error_Yuan" title="Гроссмейстер Error_Yuan">Error_Yuan</a>. In fact, the following proposition holds.</p><p><strong>Proposition.</strong> The answer obtained is still correct without the constraint that exactly <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-658"><span class="MJXp-mfrac" id="MJXp-Span-659" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660">k</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-661">2</span></span></span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-107">k\over 2</script> elements should be chosen from both sides of the enumerated position.</p><p>Without the constraint, when enumerating the position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-662"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663">p</span></span></span><script type="math/tex" id="MathJax-Element-108">p</script>, we can directly choose the smaller one between <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-664"><span class="MJXp-msubsup" id="MJXp-Span-665"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-666" style="margin-right: 0.05em;">l</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-667" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-109">l_i</script> and <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-668"><span class="MJXp-msubsup" id="MJXp-Span-669"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-671" style="vertical-align: -0.4em;">i</span></span></span></span><script type="math/tex" id="MathJax-Element-110">r_i</script> for each <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-672"><span class="MJXp-mn" id="MJXp-Span-673">1</span><span class="MJXp-mo" id="MJXp-Span-674" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">i</span><span class="MJXp-mo" id="MJXp-Span-676" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677">k</span></span></span><script type="math/tex" id="MathJax-Element-111">1\leq i\leq k</script>.</p><p><strong>Proof.</strong> On the one hand, notice that the distance sum will not be smaller when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-678"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-679">p</span></span></span><script type="math/tex" id="MathJax-Element-112">p</script> is not the middle position among the chosen elements. On the other hand, consider the <em>colorful</em> subarray that produces the optimal answer, and mark the elements in it first. When <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-680"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681">p</span></span></span><script type="math/tex" id="MathJax-Element-113">p</script> enumerates to the middle position of the marked elements before swapping, the minimal distance sum without the constraint is no greater than that under the constraint. Therefore, all the considered candidates are no less than the real answer, and the real answer can be reached, completing the proof. <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-682"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683">◻</span></span></span><script type="math/tex" id="MathJax-Element-114">\square</script></p><p>In implementation, we consider the contribution to each position <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-684"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685">p</span></span></span><script type="math/tex" id="MathJax-Element-115">p</script> for each integer <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-686"><span class="MJXp-mn" id="MJXp-Span-687">1</span><span class="MJXp-mo" id="MJXp-Span-688" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-689">i</span><span class="MJXp-mo" id="MJXp-Span-690" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691">k</span></span></span><script type="math/tex" id="MathJax-Element-116">1\leq i\leq k</script>. For a certain <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-692"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-693">i</span></span></span><script type="math/tex" id="MathJax-Element-117">i</script>, it can be shown that the delta of the contribution will be one of <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-694"><span class="MJXp-mo" id="MJXp-Span-695" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mn" id="MJXp-Span-696">1</span></span></span><script type="math/tex" id="MathJax-Element-118">-1</script>, <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-697"><span class="MJXp-mn" id="MJXp-Span-698">0</span></span></span><script type="math/tex" id="MathJax-Element-119">0</script>, or <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-699"><span class="MJXp-mo" id="MJXp-Span-700" style="margin-left: 0em; margin-right: 0.111em;">+</span><span class="MJXp-mn" id="MJXp-Span-701">1</span></span></span><script type="math/tex" id="MathJax-Element-120">+1</script> when <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-702"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">p</span></span></span><script type="math/tex" id="MathJax-Element-121">p</script> moves to an adjacent position. The delta of the contribution remains unchanged for most positions, and only changes either at the position where <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-704"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-705">i</span></span></span><script type="math/tex" id="MathJax-Element-122">i</script> placed, or at the midpoint between two adjacent <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-706"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-707">i</span></span></span><script type="math/tex" id="MathJax-Element-123">i</script>. By pre-calculating the changes of contribution deltas over all the <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-708"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709">i</span></span></span><script type="math/tex" id="MathJax-Element-124">i</script> and performing the prefix sum on the array twice, we can obtain the distance sums, resulting in an <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-710"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711">O</span><span class="MJXp-mo" id="MJXp-Span-712" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-713">n</span><span class="MJXp-mo" id="MJXp-Span-714" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-125">O(n)</script> solution.</p></div></div> <div class="spoiler"><b class="spoiler-title">Code (C++)</b><div class="spoiler-content" style="display: block;"><pre><code class="prettyprint prettyprinted" style=""><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;cstdio&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;algorithm&gt;</span><span class="pln">

</span><span class="kwd">using</span><span class="pln"> </span><span class="kwd">namespace</span><span class="pln"> std</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> N </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4e5</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">5</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> oo </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1e18</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> n</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> a</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> </span><span class="kwd">last</span><span class="pun">[</span><span class="pln">N</span><span class="pun">],</span><span class="pln"> dd</span><span class="pun">[</span><span class="pln">N</span><span class="pun">];</span><span class="pln">
</span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> s</span><span class="pun">,</span><span class="pln"> d</span><span class="pun">,</span><span class="pln"> ans</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> solve</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">n</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">k</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
		</span><span class="kwd">last</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> dd</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	s </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
		</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="kwd">last</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]])</span><span class="pln">
			s </span><span class="pun">+=</span><span class="pln"> i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
			</span><span class="kwd">int</span><span class="pln"> pre </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">last</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]];</span><span class="pln">
			</span><span class="kwd">int</span><span class="pln"> mid </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pre </span><span class="pun">+</span><span class="pln"> i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
			</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">pre </span><span class="pun">+</span><span class="pln"> i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
				dd</span><span class="pun">[</span><span class="pln">mid</span><span class="pun">]--;</span><span class="pln">
				dd</span><span class="pun">[</span><span class="pln">mid </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]--;</span><span class="pln">
			</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln">
				dd</span><span class="pun">[</span><span class="pln">mid</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
		</span><span class="pun">}</span><span class="pln">
		dd</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
		</span><span class="kwd">last</span><span class="pun">[</span><span class="pln">a</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	ans </span><span class="pun">=</span><span class="pln"> oo</span><span class="pun">;</span><span class="pln">
	d </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="pln">k</span><span class="pun">;</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> n</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
		ans </span><span class="pun">=</span><span class="pln"> min</span><span class="pun">(</span><span class="pln">ans</span><span class="pun">,</span><span class="pln"> s</span><span class="pun">);</span><span class="pln">
		d </span><span class="pun">+=</span><span class="pln"> dd</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
		s </span><span class="pun">+=</span><span class="pln"> d</span><span class="pun">;</span><span class="pln">
	</span><span class="pun">}</span><span class="pln">
	</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> k</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
		ans </span><span class="pun">-=</span><span class="pln"> abs</span><span class="pun">(</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">);</span><span class="pln">
	printf</span><span class="pun">(</span><span class="str">"%lld\n"</span><span class="pun">,</span><span class="pln"> ans</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
	</span><span class="kwd">int</span><span class="pln"> T</span><span class="pun">;</span><span class="pln">
	scanf</span><span class="pun">(</span><span class="str">"%d"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">T</span><span class="pun">);</span><span class="pln">
	</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">T</span><span class="pun">--)</span><span class="pln">
		solve</span><span class="pun">();</span><span class="pln">
	</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></code></pre></div></div></div>

    </div>


        <div style="font-size: 1.1rem;line-height: 1.1rem;padding-bottom: 0.5em;">
            <img src="https://codeforces.com//codeforces.com/codeforces.org/s/52448/images/icons/paperclip-16x16.png" style="vertical-align: middle;"> <span style="padding: 0 0.35em;">Tutorial of <a href="https://codeforces.com/contest/2085" class="notice" style="text-decoration: none;">Codeforces Round 1011 (Div. 2)</a> </span>
        </div>
        
            

  <script>
    // Make all spoilers toggleable
    document.querySelectorAll('.spoiler-title').forEach(title => {
      title.addEventListener('click', function() {
        const spoiler = this.closest('.spoiler');
        spoiler.classList.toggle('open');
      });
    });
    
    // Open all spoilers by default for easier reading
    document.querySelectorAll('.spoiler').forEach(spoiler => {
      spoiler.classList.add('open');
    });
  </script>
</body>
</html>